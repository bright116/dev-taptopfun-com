var cc = cc || {};
(cc._tmp = cc._tmp || {}), (cc._LogInfos = {});
var _p = window;
_p.gl,
	_p.WebGLRenderingContext,
	_p.DeviceOrientationEvent,
	_p.DeviceMotionEvent,
	_p.AudioContext,
	_p.AudioContext || _p.webkitAudioContext,
	_p.mozAudioContext,
	(_p = Object.prototype),
	_p._super,
	_p.ctor,
	(_p = null),
	(cc.ORIENTATION_PORTRAIT = 0),
	(cc.ORIENTATION_PORTRAIT_UPSIDE_DOWN = 1),
	(cc.ORIENTATION_LANDSCAPE_LEFT = 2),
	(cc.ORIENTATION_LANDSCAPE_RIGHT = 3),
	(cc._drawingUtil = null),
	(cc._renderContext = null),
	(cc._supportRender = !1),
	(cc._canvas = null),
	(cc.container = null),
	(cc._gameDiv = null),
	(cc.newElement = function (t) {
		return document.createElement(t);
	}),
	(cc.each = function (t, e, i) {
		if (t)
			if (t instanceof Array) {
				for (var n = 0, r = t.length; n < r; n++)
					if (!1 === e.call(i, t[n], n)) return;
			} else for (var o in t) if (!1 === e.call(i, t[o], o)) return;
	}),
	(cc.extend = function (i) {
		var t =
			2 <= arguments.length
				? Array.prototype.slice.call(arguments, 1)
				: [];
		return (
			cc.each(t, function (t) {
				for (var e in t) t.hasOwnProperty(e) && (i[e] = t[e]);
			}),
			i
		);
	}),
	(cc.isFunction = function (t) {
		return 'function' == typeof t;
	}),
	(cc.isNumber = function (t) {
		return (
			'number' == typeof t ||
			'[object Number]' === Object.prototype.toString.call(t)
		);
	}),
	(cc.isString = function (t) {
		return (
			'string' == typeof t ||
			'[object String]' === Object.prototype.toString.call(t)
		);
	}),
	(cc.isArray = function (t) {
		return (
			Array.isArray(t) ||
			('object' == typeof t &&
				'[object Array]' === Object.prototype.toString.call(t))
		);
	}),
	(cc.isUndefined = function (t) {
		return void 0 === t;
	}),
	(cc.isObject = function (t) {
		return (
			'object' == typeof t &&
			'[object Object]' === Object.prototype.toString.call(t)
		);
	}),
	(cc.isCrossOrigin = function (t) {
		if (!t) return cc.log('invalid URL'), !1;
		var e = t.indexOf('://');
		if (-1 === e) return !1;
		e = t.indexOf('/', e + 3);
		return (-1 === e ? t : t.substring(0, e)) !== location.origin;
	}),
	(cc.AsyncPool = function (t, e, i, n, r) {
		var o = this;
		(o._srcObj = t),
			(o._limit = e),
			(o._pool = []),
			(o._iterator = i),
			(o._iteratorTarget = r),
			(o._onEnd = n),
			(o._onEndTarget = r),
			(o._results = t instanceof Array ? [] : {}),
			(o._errors = t instanceof Array ? [] : {}),
			cc.each(t, function (t, e) {
				o._pool.push({ index: e, value: t });
			}),
			(o.size = o._pool.length),
			(o.finishedSize = 0),
			(o._workingSize = 0),
			(o._limit = o._limit || o.size),
			(o.onIterator = function (t, e) {
				(o._iterator = t), (o._iteratorTarget = e);
			}),
			(o.onEnd = function (t, e) {
				(o._onEnd = t), (o._onEndTarget = e);
			}),
			(o._handleItem = function () {
				var t,
					e,
					i,
					n = this;
				0 === n._pool.length ||
					n._workingSize >= n._limit ||
					((e = (t = n._pool.shift()).value),
					(i = t.index),
					n._workingSize++,
					n._iterator.call(
						n._iteratorTarget,
						e,
						i,
						function (t, e) {
							n.finishedSize++,
								n._workingSize--,
								t
									? (n._errors[this.index] = t)
									: (n._results[this.index] = e),
								n.finishedSize !== n.size
									? n._handleItem()
									: n._onEnd &&
									  ((e =
											0 === n._errors.length
												? null
												: n._errors),
									  n._onEnd.call(
											n._onEndTarget,
											e,
											n._results
									  ));
						}.bind(t),
						n
					));
			}),
			(o.flow = function () {
				var t = this;
				if (0 !== t._pool.length)
					for (var e = 0; e < t._limit; e++) t._handleItem();
				else t._onEnd && t._onEnd.call(t._onEndTarget, null, []);
			});
	}),
	(cc.async = {
		series: function (t, e, n) {
			e = new cc.AsyncPool(
				t,
				1,
				function (t, e, i) {
					t.call(n, i);
				},
				e,
				n
			);
			return e.flow(), e;
		},
		parallel: function (t, e, n) {
			e = new cc.AsyncPool(
				t,
				0,
				function (t, e, i) {
					t.call(n, i);
				},
				e,
				n
			);
			return e.flow(), e;
		},
		waterfall: function (n, e, r) {
			var o = [],
				s = [null],
				t = new cc.AsyncPool(
					n,
					1,
					function (t, e, i) {
						o.push(function (t) {
							(o = Array.prototype.slice.call(arguments, 1)),
								n.length - 1 === e && (s = s.concat(o)),
								i.apply(null, arguments);
						}),
							t.apply(r, o);
					},
					function (t) {
						if (e) return t ? e.call(r, t) : void e.apply(r, s);
					}
				);
			return t.flow(), t;
		},
		map: function (t, e, i, n) {
			var r = e;
			'object' == typeof e &&
				((i = e.cb), (n = e.iteratorTarget), (r = e.iterator));
			n = new cc.AsyncPool(t, 0, r, i, n);
			return n.flow(), n;
		},
		mapLimit: function (t, e, i, n, r) {
			r = new cc.AsyncPool(t, e, i, n, r);
			return r.flow(), r;
		},
	}),
	(cc.path = {
		normalizeRE: /[^\.\/]+\/\.\.\//,
		join: function () {
			for (var t = arguments.length, e = '', i = 0; i < t; i++)
				e = (e + ('' === e ? '' : '/') + arguments[i]).replace(
					/(\/|\\\\)$/,
					''
				);
			return e;
		},
		extname: function (t) {
			t = /(\.[^\.\/\?\\]*)(\?.*)?$/.exec(t);
			return t ? t[1] : null;
		},
		mainFileName: function (t) {
			if (t) {
				var e = t.lastIndexOf('.');
				if (-1 !== e) return t.substring(0, e);
			}
			return t;
		},
		basename: function (t, e) {
			var i = t.indexOf('?');
			0 < i && (t = t.substring(0, i));
			i = /(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(t.replace(/(\/|\\\\)$/, ''));
			if (!i) return null;
			i = i[2];
			return e &&
				t.substring(t.length - e.length).toLowerCase() ===
					e.toLowerCase()
				? i.substring(0, i.length - e.length)
				: i;
		},
		dirname: function (t) {
			return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/, '$2');
		},
		changeExtname: function (t, e) {
			e = e || '';
			var i = t.indexOf('?'),
				n = '';
			return (
				0 < i && ((n = t.substring(i)), (t = t.substring(0, i))),
				(i = t.lastIndexOf('.')) < 0
					? t + e + n
					: t.substring(0, i) + e + n
			);
		},
		changeBasename: function (t, e, i) {
			if (0 === e.indexOf('.')) return this.changeExtname(t, e);
			var n = t.indexOf('?'),
				r = '',
				i = i ? this.extname(t) : '';
			return (
				0 < n && ((r = t.substring(n)), (t = t.substring(0, n))),
				(n = (n = t.lastIndexOf('/')) <= 0 ? 0 : n + 1),
				t.substring(0, n) + e + i + r
			);
		},
		_normalize: function (t) {
			for (
				var e = (t = String(t));
				(t = (e = t).replace(this.normalizeRE, '')),
					e.length !== t.length;

			);
			return t;
		},
	}),
	(cc.loader = (function () {
		var c = {},
			a = {},
			r = {},
			o = {},
			u = {},
			_ = new RegExp(
				'^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))|(?:localhost))(?::\\d{2,5})?(?:/\\S*)?$',
				'i'
			);
		return {
			resPath: '',
			audioPath: '',
			cache: {},
			getXMLHttpRequest: function () {
				return window.XMLHttpRequest
					? new window.XMLHttpRequest()
					: new ActiveXObject('MSXML2.XMLHTTP');
			},
			_getArgs4Js: function (t) {
				var e = t[0],
					i = t[1],
					n = t[2],
					r = ['', null, null];
				if (1 === t.length) r[1] = e instanceof Array ? e : [e];
				else if (2 === t.length)
					'function' == typeof i
						? ((r[1] = e instanceof Array ? e : [e]), (r[2] = i))
						: ((r[0] = e || ''),
						  (r[1] = i instanceof Array ? i : [i]));
				else {
					if (3 !== t.length)
						throw new Error('arguments error to load js!');
					(r[0] = e || ''),
						(r[1] = i instanceof Array ? i : [i]),
						(r[2] = n);
				}
				return r;
			},
			isLoading: function (t) {
				return void 0 !== u[t];
			},
			loadJs: function (t, e, i) {
				var n = this,
					r = n._getArgs4Js(arguments),
					o = r[0],
					s = r[1],
					r = r[2];
				-1 < navigator.userAgent.indexOf('Trident/5')
					? n._loadJs4Dependency(o, s, 0, r)
					: cc.async.map(
							s,
							function (t, e, i) {
								t = cc.path.join(o, t);
								if (c[t]) return i(null);
								n._createScript(t, !1, i);
							},
							r
					  );
			},
			loadJsWithImg: function (t, e, i) {
				var n = this._loadJsImg(),
					r = this._getArgs4Js(arguments);
				this.loadJs(r[0], r[1], function (t) {
					if (t) throw new Error(t);
					n.parentNode.removeChild(n), r[2] && r[2]();
				});
			},
			_createScript: function (t, e, i) {
				var n = document,
					r = document.createElement('script');
				(r.async = e),
					(c[t] = !0),
					cc.game.config.noCache && 'string' == typeof t
						? this._noCacheRex.test(t)
							? (r.src = t + '&_t=' + +new Date())
							: (r.src = t + '?_t=' + +new Date())
						: (r.src = t),
					r.addEventListener(
						'load',
						function () {
							r.parentNode.removeChild(r),
								this.removeEventListener(
									'load',
									arguments.callee,
									!1
								),
								i();
						},
						!1
					),
					r.addEventListener(
						'error',
						function () {
							r.parentNode.removeChild(r),
								i('Load ' + t + ' failed!');
						},
						!1
					),
					n.body.appendChild(r);
			},
			_loadJs4Dependency: function (e, i, n, r) {
				var o;
				n >= i.length
					? r && r()
					: (o = this)._createScript(
							cc.path.join(e, i[n]),
							!1,
							function (t) {
								return t
									? r(t)
									: void o._loadJs4Dependency(e, i, n + 1, r);
							}
					  );
			},
			_loadJsImg: function () {
				var t,
					e = document,
					i = e.getElementById('cocos2d_loadJsImg');
				return (
					i ||
						((i = document.createElement('img')),
						cc._loadingImage && (i.src = cc._loadingImage),
						((t = e.getElementById(
							cc.game.config.id
						)).style.backgroundColor = 'transparent'),
						t.parentNode.appendChild(i),
						(e = (e = getComputedStyle
							? getComputedStyle(t)
							: t.currentStyle) || {
							width: t.width,
							height: t.height,
						}),
						(i.style.left =
							t.offsetLeft +
							(parseFloat(e.width) - i.width) / 2 +
							'px'),
						(i.style.top =
							t.offsetTop +
							(parseFloat(e.height) - i.height) / 2 +
							'px'),
						(i.style.position = 'absolute')),
					i
				);
			},
			loadTxt: function (t, i) {
				var e, n;
				cc._isNodeJs
					? require('fs').readFile(t, function (t, e) {
							t ? i(t) : i(null, e.toString());
					  })
					: ((e = this.getXMLHttpRequest()),
					  (n = 'load ' + t + ' failed!'),
					  e.open('GET', t, !0),
					  /msie/i.test(navigator.userAgent) &&
					  !/opera/i.test(navigator.userAgent)
							? (e.setRequestHeader('Accept-Charset', 'utf-8'),
							  (e.onreadystatechange = function () {
									4 === e.readyState &&
										(200 === e.status
											? i(null, e.responseText)
											: i(
													{
														status: e.status,
														errorMessage: n,
													},
													null
											  ));
							  }))
							: (e.overrideMimeType &&
									e.overrideMimeType(
										'text/plain; charset=utf-8'
									),
							  (e.onload = function () {
									4 === e.readyState &&
										(200 === e.status
											? i(null, e.responseText)
											: i(
													{
														status: e.status,
														errorMessage: n,
													},
													null
											  ));
							  }),
							  (e.onerror = function () {
									i(
										{ status: e.status, errorMessage: n },
										null
									);
							  })),
					  e.send(null));
			},
			_loadTxtSync: function (t) {
				if (cc._isNodeJs)
					return require('fs').readFileSync(t).toString();
				var e = this.getXMLHttpRequest();
				return (
					e.open('GET', t, !1),
					/msie/i.test(navigator.userAgent) &&
					!/opera/i.test(navigator.userAgent)
						? e.setRequestHeader('Accept-Charset', 'utf-8')
						: e.overrideMimeType &&
						  e.overrideMimeType('text/plain; charset=utf-8'),
					e.send(null),
					4 === !e.readyState || 200 !== e.status
						? null
						: e.responseText
				);
			},
			loadCsb: function (t, e) {
				var i = new XMLHttpRequest(),
					n = 'load ' + t + ' failed!';
				i.open('GET', t, !0),
					(i.responseType = 'arraybuffer'),
					(i.onload = function () {
						var t = i.response;
						t && (window.msg = t),
							4 === i.readyState &&
								(200 === i.status
									? e(null, i.response)
									: e(
											{
												status: i.status,
												errorMessage: n,
											},
											null
									  ));
					}),
					(i.onerror = function () {
						e({ status: i.status, errorMessage: n }, null);
					}),
					i.send(null);
			},
			loadJson: function (n, r) {
				this.loadTxt(n, function (t, e) {
					if (t) r(t);
					else {
						try {
							var i = JSON.parse(e);
						} catch (t) {
							throw new Error(
								'parse json [' + n + '] failed : ' + t
							);
						}
						r(null, i);
					}
				});
			},
			_checkIsImageURL: function (t) {
				return (
					null != /(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(t)
				);
			},
			loadImg: function (r, t, o) {
				var s = { isCrossOrigin: !0 };
				void 0 !== o
					? (s.isCrossOrigin = (
							void 0 === t.isCrossOrigin ? s : t
					  ).isCrossOrigin)
					: void 0 !== t && (o = t);
				var c = this.getRes(r);
				if (c) return o && o(null, c), c;
				t = u[r];
				if (t) return t.callbacks.push(o), t.img;
				(c = new Image()),
					s.isCrossOrigin &&
						'file://' !== location.origin &&
						(c.crossOrigin = 'Anonymous');
				var a = function () {
						this.removeEventListener('load', a, !1),
							this.removeEventListener('error', h, !1),
							_.test(r) || (cc.loader.cache[r] = c);
						var t = u[r];
						if (t) {
							for (
								var e = t.callbacks, i = 0;
								i < e.length;
								++i
							) {
								var n = e[i];
								n && n(null, c);
							}
							(t.img = null), delete u[r];
						}
					},
					l = this,
					h = function () {
						if (
							(this.removeEventListener('error', h, !1),
							c.crossOrigin &&
								'anonymous' === c.crossOrigin.toLowerCase())
						)
							(s.isCrossOrigin = !1),
								l.release(r),
								cc.loader.loadImg(r, s, o);
						else {
							var t = u[r];
							if (t) {
								for (
									var e = t.callbacks, i = 0;
									i < e.length;
									++i
								) {
									var n = e[i];
									n && n('load image failed');
								}
								(t.img = null), delete u[r];
							}
						}
					};
				return (
					(u[r] = { img: c, callbacks: o ? [o] : [] }),
					c.addEventListener('load', a),
					c.addEventListener('error', h),
					(c.src = r),
					c
				);
			},
			_loadResIterator: function (t, e, i) {
				var n = this,
					r = null,
					o = t.type;
				o
					? ((o = '.' + o.toLowerCase()), (r = t.src || t.name + o))
					: ((r = t), (o = cc.path.extname(r)));
				var s = n.getRes(r);
				if (s) return i(null, s);
				var c = null;
				if ((o && (c = a[o.toLowerCase()]), !c))
					return cc.error('loader for [' + o + '] not exists!'), i();
				s = r;
				_.test(r) ||
					((o = c.getBasePath ? c.getBasePath() : n.resPath),
					(s = n.getUrl(o, r))),
					cc.game.config.noCache &&
						'string' == typeof s &&
						(n._noCacheRex.test(s)
							? (s += '&_t=' + +new Date())
							: (s += '?_t=' + +new Date())),
					c.load(s, r, t, function (t, e) {
						t
							? (cc.log(t),
							  (n.cache[r] = null),
							  delete n.cache[r],
							  i({ status: 520, errorMessage: t }, null))
							: ((n.cache[r] = e), i(null, e));
					});
			},
			_noCacheRex: /\?/,
			getUrl: function (t, e) {
				var i,
					n = cc.path;
				if (
					(void 0 !== t &&
						void 0 === e &&
						((e = t),
						(i = (i = n.extname(e)) ? i.toLowerCase() : ''),
						(t =
							(i = a[i]) && i.getBasePath
								? i.getBasePath()
								: this.resPath)),
					(e = cc.path.join(t || '', e)).match(
						/[\/(\\\\)]lang[\/(\\\\)]/i
					))
				) {
					if (r[e]) return r[e];
					n = n.extname(e) || '';
					e = r[e] =
						e.substring(0, e.length - n.length) +
						'_' +
						cc.sys.language +
						n;
				}
				return e;
			},
			load: function (t, r, e) {
				var o = this,
					i = arguments.length;
				if (0 === i) throw new Error('arguments error!');
				3 === i
					? 'function' == typeof r &&
					  (r =
							'function' == typeof e
								? { trigger: r, cb: e }
								: { cb: r, cbTarget: e })
					: 2 === i
					? 'function' == typeof r && (r = { cb: r })
					: 1 === i && (r = {}),
					t instanceof Array || (t = [t]);
				i = new cc.AsyncPool(
					t,
					0,
					function (t, e, i, n) {
						o._loadResIterator(t, e, function (t) {
							var e = Array.prototype.slice.call(arguments, 1);
							r.trigger &&
								r.trigger.call(
									r.triggerTarget,
									e[0],
									n.size,
									n.finishedSize
								),
								i(t, e[0]);
						});
					},
					r.cb,
					r.cbTarget
				);
				return i.flow(), i;
			},
			_handleAliases: function (t, e) {
				var i,
					n = [];
				for (i in t) {
					var r = t[i];
					(o[i] = r), n.push(r);
				}
				this.load(n, e);
			},
			loadAliases: function (t, i) {
				var n = this,
					e = n.getRes(t);
				e
					? n._handleAliases(e.filenames, i)
					: n.load(t, function (t, e) {
							n._handleAliases(e[0].filenames, i);
					  });
			},
			register: function (t, e) {
				if (t && e) {
					if ('string' == typeof t)
						return (a[t.trim().toLowerCase()] = e);
					for (var i = 0, n = t.length; i < n; i++)
						a['.' + t[i].trim().toLowerCase()] = e;
				}
			},
			getRes: function (t) {
				return this.cache[t] || this.cache[o[t]];
			},
			_getAliase: function (t) {
				return o[t];
			},
			release: function (t) {
				var e = this.cache,
					i = u[t];
				i && ((i.img = null), delete u[t]),
					delete e[t],
					delete e[o[t]],
					delete o[t];
			},
			releaseAll: function () {
				var t,
					e = this.cache;
				for (t in e) delete e[t];
				for (t in o) delete o[t];
			},
		};
	})()),
	(cc.formatStr = function () {
		var t = arguments,
			e = t.length;
		if (e < 1) return '';
		var i = t[0],
			n = !0;
		'object' == typeof i && (n = !1);
		for (var r = 1; r < e; ++r) {
			var o = t[r];
			if (n)
				for (;;) {
					if ('number' == typeof o && i.match(/(%d)|(%s)/)) {
						i = i.replace(/(%d)|(%s)/, o);
						break;
					}
					i.match(/%s/)
						? (i = i.replace(/%s/, o))
						: (i += '    ' + o);
					break;
				}
			else i += '    ' + o;
		}
		return i;
	}),
	(function () {
		var m = document.createElement('canvas'),
			g = document.createElement('canvas');
		(cc.create3DContext = function (t, e) {
			for (
				var i = [
						'webgl',
						'experimental-webgl',
						'webkit-3d',
						'moz-webgl',
					],
					n = null,
					r = 0;
				r < i.length;
				++r
			) {
				try {
					n = t.getContext(i[r], e);
				} catch (t) {}
				if (n) break;
			}
			return n;
		}),
			(function () {
				cc.sys = {};
				var e = cc.sys;
				(e.LANGUAGE_ENGLISH = 'en'),
					(e.LANGUAGE_CHINESE = 'zh'),
					(e.LANGUAGE_FRENCH = 'fr'),
					(e.LANGUAGE_ITALIAN = 'it'),
					(e.LANGUAGE_GERMAN = 'de'),
					(e.LANGUAGE_SPANISH = 'es'),
					(e.LANGUAGE_DUTCH = 'du'),
					(e.LANGUAGE_RUSSIAN = 'ru'),
					(e.LANGUAGE_KOREAN = 'ko'),
					(e.LANGUAGE_JAPANESE = 'ja'),
					(e.LANGUAGE_HUNGARIAN = 'hu'),
					(e.LANGUAGE_PORTUGUESE = 'pt'),
					(e.LANGUAGE_ARABIC = 'ar'),
					(e.LANGUAGE_NORWEGIAN = 'no'),
					(e.LANGUAGE_POLISH = 'pl'),
					(e.LANGUAGE_UNKNOWN = 'unkonwn'),
					(e.OS_IOS = 'iOS'),
					(e.OS_ANDROID = 'Android'),
					(e.OS_WINDOWS = 'Windows'),
					(e.OS_MARMALADE = 'Marmalade'),
					(e.OS_LINUX = 'Linux'),
					(e.OS_BADA = 'Bada'),
					(e.OS_BLACKBERRY = 'Blackberry'),
					(e.OS_OSX = 'OS X'),
					(e.OS_WP8 = 'WP8'),
					(e.OS_WINRT = 'WINRT'),
					(e.OS_UNKNOWN = 'Unknown'),
					(e.UNKNOWN = -1),
					(e.WIN32 = 0),
					(e.LINUX = 1),
					(e.MACOS = 2),
					(e.ANDROID = 3),
					(e.IPHONE = 4),
					(e.IPAD = 5),
					(e.BLACKBERRY = 6),
					(e.NACL = 7),
					(e.EMSCRIPTEN = 8),
					(e.TIZEN = 9),
					(e.WINRT = 10),
					(e.WP8 = 11),
					(e.MOBILE_BROWSER = 100),
					(e.DESKTOP_BROWSER = 101),
					(e.BROWSER_TYPE_WECHAT = 'wechat'),
					(e.BROWSER_TYPE_ANDROID = 'androidbrowser'),
					(e.BROWSER_TYPE_IE = 'ie'),
					(e.BROWSER_TYPE_QQ = 'qqbrowser'),
					(e.BROWSER_TYPE_MOBILE_QQ = 'mqqbrowser'),
					(e.BROWSER_TYPE_UC = 'ucbrowser'),
					(e.BROWSER_TYPE_360 = '360browser'),
					(e.BROWSER_TYPE_BAIDU_APP = 'baiduboxapp'),
					(e.BROWSER_TYPE_BAIDU = 'baidubrowser'),
					(e.BROWSER_TYPE_MAXTHON = 'maxthon'),
					(e.BROWSER_TYPE_OPERA = 'opera'),
					(e.BROWSER_TYPE_OUPENG = 'oupeng'),
					(e.BROWSER_TYPE_MIUI = 'miuibrowser'),
					(e.BROWSER_TYPE_FIREFOX = 'firefox'),
					(e.BROWSER_TYPE_SAFARI = 'safari'),
					(e.BROWSER_TYPE_CHROME = 'chrome'),
					(e.BROWSER_TYPE_LIEBAO = 'liebao'),
					(e.BROWSER_TYPE_QZONE = 'qzone'),
					(e.BROWSER_TYPE_SOUGOU = 'sogou'),
					(e.BROWSER_TYPE_UNKNOWN = 'unknown'),
					(e.isNative = !1);
				var t = window,
					i = t.navigator,
					n = document,
					r = n.documentElement,
					o = i.userAgent.toLowerCase();
				(e.isMobile =
					-1 !== o.indexOf('mobile') || -1 !== o.indexOf('android')),
					(e.platform = e.isMobile
						? e.MOBILE_BROWSER
						: e.DESKTOP_BROWSER);
				var s = i.language;
				(s = (s = s || i.browserLanguage)
					? s.split('-')[0]
					: e.LANGUAGE_ENGLISH),
					(e.language = s);
				var c = !1,
					a = !1,
					l = '',
					h = 0;
				(s =
					/android (\d+(?:\.\d+)+)/i.exec(o) ||
					/android (\d+(?:\.\d+)+)/i.exec(i.platform)) &&
					((c = !0), (l = s[1] || ''), (h = parseInt(l) || 0)),
					(s = /(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(o)) &&
						((a = !0), (l = s[2] || ''), (h = parseInt(l) || 0)),
					(s = e.OS_UNKNOWN),
					-1 !== i.appVersion.indexOf('Win')
						? (s = e.OS_WINDOWS)
						: a
						? (s = e.OS_IOS)
						: -1 !== i.appVersion.indexOf('Mac')
						? (s = e.OS_OSX)
						: -1 !== i.appVersion.indexOf('X11') &&
						  -1 === i.appVersion.indexOf('Linux')
						? (s = e.OS_UNIX)
						: c
						? (s = e.OS_ANDROID)
						: -1 !== i.appVersion.indexOf('Linux') &&
						  (s = e.OS_LINUX),
					(e.os = s),
					(e.osVersion = l),
					(e.osMainVersion = h),
					(e.browserType = e.BROWSER_TYPE_UNKNOWN),
					'micromessenger' ===
					(l = (l =
						(l =
							/mqqbrowser|sogou|qzone|liebao|micromessenger|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i.exec(
								o
							)) ||
						/qqbrowser|chrome|safari|firefox|opr|oupeng|opera/i.exec(
							o
						))
						? l[0]
						: e.BROWSER_TYPE_UNKNOWN)
						? (l = e.BROWSER_TYPE_WECHAT)
						: 'safari' === l && o.match(/android.*applewebkit/)
						? (l = e.BROWSER_TYPE_ANDROID)
						: 'trident' === l
						? (l = e.BROWSER_TYPE_IE)
						: '360 aphone' === l
						? (l = e.BROWSER_TYPE_360)
						: 'mxbrowser' === l
						? (l = e.BROWSER_TYPE_MAXTHON)
						: 'opr' === l && (l = e.BROWSER_TYPE_OPERA),
					(e.browserType = l),
					(e.browserVersion = ''),
					(h =
						(h = o.match(
							/(micromessenger|qq|mx|maxthon|baidu|sogou)(mobile)?(browser)?\/?([\d.]+)/i
						)) ||
						o.match(
							/(msie |rv:|firefox|chrome|ucbrowser|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i
						)),
					(e.browserVersion = h ? h[4] : ''),
					(l =
						window.innerWidth ||
						document.documentElement.clientWidth),
					(o =
						window.innerHeight ||
						document.documentElement.clientHeight),
					(h = window.devicePixelRatio || 1),
					(e.windowPixelResolution = { width: h * l, height: h * o }),
					(e._checkWebGLRenderMode = function () {
						if (cc._renderType !== cc.game.RENDER_TYPE_WEBGL)
							throw new Error(
								'This feature supports WebGL render mode only.'
							);
					}),
					(e._supportCanvasNewBlendModes = (function () {
						var t = m;
						(t.width = 1), (t.height = 1);
						var e = t.getContext('2d');
						(e.fillStyle = '#000'),
							e.fillRect(0, 0, 1, 1),
							(e.globalCompositeOperation = 'multiply');
						var i = g;
						(i.width = 1), (i.height = 1);
						t = i.getContext('2d');
						return (
							(t.fillStyle = '#fff'),
							t.fillRect(0, 0, 1, 1),
							e.drawImage(i, 0, 0, 1, 1),
							0 === e.getImageData(0, 0, 1, 1).data[0]
						);
					})()),
					cc.sys.isMobile &&
						(((o = document.createElement('style')).type =
							'text/css'),
						document.body.appendChild(o),
						(o.textContent =
							'body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}'));
				try {
					var u = (e.localStorage = t.localStorage);
					u.setItem('storage', ''),
						u.removeItem('storage'),
						(u = null);
				} catch (t) {
					var _ = function () {
						cc.warn(
							"Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option"
						);
					};
					e.localStorage = {
						getItem: _,
						setItem: _,
						removeItem: _,
						clear: _,
					};
				}
				var _ = !!m.getContext('2d'),
					d = !1;
				if (t.WebGLRenderingContext) {
					var p = document.createElement('CANVAS');
					try {
						if (
							(cc.create3DContext(p, { stencil: !0 }) && (d = !0),
							d && e.os === e.OS_ANDROID)
						) {
							var f = parseFloat(e.browserVersion);
							switch (e.browserType) {
								case e.BROWSER_TYPE_MOBILE_QQ:
								case e.BROWSER_TYPE_BAIDU:
								case e.BROWSER_TYPE_BAIDU_APP:
									d = 6.2 <= f;
									break;
								case e.BROWSER_TYPE_CHROME:
									d = 30 <= f;
									break;
								case e.BROWSER_TYPE_ANDROID:
									e.osMainVersion &&
										5 <= e.osMainVersion &&
										(d = !0);
									break;
								case e.BROWSER_TYPE_UNKNOWN:
								case e.BROWSER_TYPE_360:
								case e.BROWSER_TYPE_MIUI:
								case e.BROWSER_TYPE_UC:
									d = !1;
							}
						}
					} catch (t) {}
					p = null;
				}
				(_ = e.capabilities = { canvas: _, opengl: d }),
					(void 0 === r.ontouchstart &&
						void 0 === n.ontouchstart &&
						!i.msPointerEnabled) ||
						(_.touches = !0),
					void 0 !== r.onmouseup && (_.mouse = !0),
					void 0 !== r.onkeyup && (_.keyboard = !0),
					(t.DeviceMotionEvent || t.DeviceOrientationEvent) &&
						(_.accelerometer = !0),
					(e.garbageCollect = function () {}),
					(e.dumpRoot = function () {}),
					(e.restartVM = function () {}),
					(e.cleanScript = function (t) {}),
					(e.isObjectValid = function (t) {
						return !!t;
					}),
					(e.dump = function () {
						var t = this,
							e = '';
						(e += 'isMobile : ' + t.isMobile + '\r\n'),
							(e += 'language : ' + t.language + '\r\n'),
							(e += 'browserType : ' + t.browserType + '\r\n'),
							(e +=
								'browserVersion : ' +
								t.browserVersion +
								'\r\n'),
							(e +=
								'capabilities : ' +
								JSON.stringify(t.capabilities) +
								'\r\n'),
							(e += 'os : ' + t.os + '\r\n'),
							(e += 'osVersion : ' + t.osVersion + '\r\n'),
							(e += 'platform : ' + t.platform + '\r\n'),
							(e +=
								'Using ' +
								(cc._renderType === cc.game.RENDER_TYPE_WEBGL
									? 'WEBGL'
									: 'CANVAS') +
								' renderer.\r\n'),
							cc.log(e);
					}),
					(e.openURL = function (t) {
						window.open(t);
					});
			})(),
			(g = m = null),
			(cc.log = cc.warn = cc.error = cc.assert = function () {});
		var u = {},
			s = !1,
			c = null;
		function h(t) {
			cc._initDebugSetting &&
				cc._initDebugSetting(t[cc.game.CONFIG_KEY.debugMode]),
				(cc._engineLoaded = !0),
				cc.log(cc.ENGINE_VERSION),
				c && c();
		}
		function a(a) {
			var t = cc.game.CONFIG_KEY,
				l = a[t.engineDir],
				e = cc.loader;
			cc.Class
				? h(a)
				: ((t = cc.path.join(l, 'moduleConfig.json')),
				  e.loadJson(t, function (t, e) {
						if (t) throw new Error(t);
						var i = a.modules || [],
							n = e.module,
							r = [];
						cc.sys.capabilities.opengl &&
						i.indexOf('base4webgl') < 0
							? i.splice(0, 0, 'base4webgl')
							: i.indexOf('core') < 0 && i.splice(0, 0, 'core');
						for (var o = 0, s = i.length; o < s; o++) {
							var c = (function t(e, i, n) {
								if (u[i]) return null;
								n = n || '';
								var r = [],
									o = e[i];
								if (!o)
									throw new Error(
										'can not find module [' + i + ']'
									);
								for (
									var s = cc.path, c = 0, a = o.length;
									c < a;
									c++
								) {
									var l,
										h = o[c];
									u[h] ||
										((l = s.extname(h))
											? '.js' === l.toLowerCase() &&
											  r.push(s.join(n, h))
											: (l = t(e, h, n)) &&
											  (r = r.concat(l)),
										(u[h] = 1));
								}
								return r;
							})(n, i[o], l);
							c && (r = r.concat(c));
						}
						cc.loader.loadJsWithImg(r, function (t) {
							if (t) throw t;
							h(a);
						});
				  }));
		}
		function l() {
			this.removeEventListener('load', l, !1), a(cc.game.config);
		}
		(cc._engineLoaded = !1),
			(cc.initEngine = function (t, e) {
				var i, n, r, o;
				s
					? ((i = c),
					  (c = function () {
							i && i(), e && e();
					  }))
					: ((c = e),
					  !cc.game.config && t
							? (cc.game.config = t)
							: cc.game.config || cc.game._loadConfig(),
					  (t = cc.game.config),
					  (n = t),
					  (r = cc.game.CONFIG_KEY),
					  (o = parseInt(n[r.renderMode]) || 0),
					  (isNaN(o) || 2 < o || o < 0) && (n[r.renderMode] = 0),
					  (cc._renderType = cc.game.RENDER_TYPE_CANVAS),
					  (cc._supportRender = !1),
					  0 === o
							? cc.sys.capabilities.opengl
								? ((cc._renderType = cc.game.RENDER_TYPE_WEBGL),
								  (cc._supportRender = !0))
								: cc.sys.capabilities.canvas &&
								  ((cc._renderType =
										cc.game.RENDER_TYPE_CANVAS),
								  (cc._supportRender = !0))
							: 1 === o && cc.sys.capabilities.canvas
							? ((cc._renderType = cc.game.RENDER_TYPE_CANVAS),
							  (cc._supportRender = !0))
							: 2 === o &&
							  cc.sys.capabilities.opengl &&
							  ((cc._renderType = cc.game.RENDER_TYPE_WEBGL),
							  (cc._supportRender = !0)),
					  document.body
							? a(t)
							: cc._addEventListener(window, 'load', l, !1),
					  (s = !0));
			});
	})(),
	(cc.game = {
		DEBUG_MODE_NONE: 0,
		DEBUG_MODE_INFO: 1,
		DEBUG_MODE_WARN: 2,
		DEBUG_MODE_ERROR: 3,
		DEBUG_MODE_INFO_FOR_WEB_PAGE: 4,
		DEBUG_MODE_WARN_FOR_WEB_PAGE: 5,
		DEBUG_MODE_ERROR_FOR_WEB_PAGE: 6,
		EVENT_HIDE: 'game_on_hide',
		EVENT_SHOW: 'game_on_show',
		EVENT_RESIZE: 'game_on_resize',
		EVENT_RENDERER_INITED: 'renderer_inited',
		RENDER_TYPE_CANVAS: 0,
		RENDER_TYPE_WEBGL: 1,
		RENDER_TYPE_OPENGL: 2,
		_eventHide: null,
		_eventShow: null,
		CONFIG_KEY: {
			width: 'width',
			height: 'height',
			engineDir: 'engineDir',
			modules: 'modules',
			debugMode: 'debugMode',
			showFPS: 'showFPS',
			frameRate: 'frameRate',
			id: 'id',
			renderMode: 'renderMode',
			jsList: 'jsList',
		},
		_paused: !0,
		_prepareCalled: !1,
		_prepared: !1,
		_rendererInitialized: !1,
		_renderContext: null,
		_intervalId: null,
		_lastTime: null,
		_frameTime: null,
		frame: null,
		container: null,
		canvas: null,
		config: null,
		onStart: null,
		onStop: null,
		setFrameRate: function (t) {
			var e = this;
			(e.config[e.CONFIG_KEY.frameRate] = t),
				e._intervalId && window.cancelAnimationFrame(e._intervalId),
				(e._paused = !0),
				e._setAnimFrame(),
				e._runMainLoop();
		},
		step: function () {
			cc.director.mainLoop();
		},
		pause: function () {
			this._paused ||
				((this._paused = !0),
				cc.audioEngine &&
					(cc.audioEngine.stopAllEffects(),
					cc.audioEngine.pauseMusic()),
				this._intervalId &&
					window.cancelAnimationFrame(this._intervalId),
				(this._intervalId = 0));
		},
		resume: function () {
			this._paused &&
				((this._paused = !1),
				cc.audioEngine &&
					(cc.audioEngine.resumeAllEffects(),
					1 == comman.isMusicEnable &&
						1 == comman.isMusicLevelEnable &&
						cc.audioEngine.resumeMusic()),
				this._runMainLoop());
		},
		isPaused: function () {
			return this._paused;
		},
		restart: function () {
			cc.director.popToSceneStackLevel(0),
				cc.audioEngine && cc.audioEngine.end(),
				cc.game.onStart();
		},
		end: function () {
			close();
		},
		prepare: function (e) {
			var i = this,
				t = i.config,
				n = i.CONFIG_KEY;
			this._loadConfig(),
				this._prepared
					? e && e()
					: this._prepareCalled ||
					  (cc._engineLoaded
							? ((this._prepareCalled = !0),
							  this._initRenderer(t[n.width], t[n.height]),
							  (cc.view = cc.EGLView._getInstance()),
							  (cc.director = cc.Director._getInstance()),
							  cc.director.setOpenGLView &&
									cc.director.setOpenGLView(cc.view),
							  (cc.winSize = cc.director.getWinSize()),
							  this._initEvents(),
							  this._setAnimFrame(),
							  this._runMainLoop(),
							  (n = t[n.jsList])
									? cc.loader.loadJsWithImg(n, function (t) {
											if (t) throw new Error(t);
											(i._prepared = !0), e && e();
									  })
									: e && e())
							: cc.initEngine(this.config, function () {
									i.prepare(e);
							  }));
		},
		run: function (t, e) {
			'function' == typeof t
				? (cc.game.onStart = t)
				: (t &&
						('string' == typeof t
							? (cc.game.config || this._loadConfig(),
							  (cc.game.config[cc.game.CONFIG_KEY.id] = t))
							: (cc.game.config = t)),
				  'function' == typeof e && (cc.game.onStart = e)),
				this.prepare(cc.game.onStart && cc.game.onStart.bind(cc.game));
		},
		_setAnimFrame: function () {
			(this._lastTime = new Date()),
				(this._frameTime =
					1e3 / cc.game.config[cc.game.CONFIG_KEY.frameRate]),
				(cc.sys.os === cc.sys.OS_IOS &&
					cc.sys.browserType === cc.sys.BROWSER_TYPE_WECHAT) ||
				60 !== cc.game.config[cc.game.CONFIG_KEY.frameRate]
					? ((window.requestAnimFrame = this._stTime),
					  (window.cancelAnimationFrame = this._ctTime))
					: ((window.requestAnimFrame =
							window.requestAnimationFrame ||
							window.webkitRequestAnimationFrame ||
							window.mozRequestAnimationFrame ||
							window.oRequestAnimationFrame ||
							window.msRequestAnimationFrame ||
							this._stTime),
					  (window.cancelAnimationFrame =
							window.cancelAnimationFrame ||
							window.cancelRequestAnimationFrame ||
							window.msCancelRequestAnimationFrame ||
							window.mozCancelRequestAnimationFrame ||
							window.oCancelRequestAnimationFrame ||
							window.webkitCancelRequestAnimationFrame ||
							window.msCancelAnimationFrame ||
							window.mozCancelAnimationFrame ||
							window.webkitCancelAnimationFrame ||
							window.oCancelAnimationFrame ||
							this._ctTime));
		},
		_stTime: function (t) {
			var e = new Date().getTime(),
				i = Math.max(0, cc.game._frameTime - (e - cc.game._lastTime)),
				n = window.setTimeout(function () {
					t();
				}, i);
			return (cc.game._lastTime = e + i), n;
		},
		_ctTime: function (t) {
			window.clearTimeout(t);
		},
		_runMainLoop: function () {
			var t,
				e = this,
				i = e.config,
				n = e.CONFIG_KEY,
				r = cc.director;
			r.setDisplayStats(i[n.showFPS]),
				(t = function () {
					e._paused ||
						(r.mainLoop(),
						e._intervalId &&
							window.cancelAnimationFrame(e._intervalId),
						(e._intervalId = window.requestAnimFrame(t)));
				}),
				window.requestAnimFrame(t),
				(e._paused = !1);
		},
		_loadConfig: function () {
			if (this.config) this._initConfig(this.config);
			else if (document.ccConfig) this._initConfig(document.ccConfig);
			else {
				var t = {};
				try {
					for (
						var e,
							i,
							n = document.getElementsByTagName('script'),
							r = 0;
						r < n.length;
						r++
					) {
						var o = n[r].getAttribute('cocos');
						if ('' === o || o) break;
					}
					r < n.length &&
						((e = n[r].src) &&
							((i = /(.*)\//.exec(e)[0]),
							(cc.loader.resPath = i),
							(e = cc.path.join(i, 'project.json'))),
						(e = cc.loader._loadTxtSync(e))),
						(e = e || cc.loader._loadTxtSync('project.json')),
						(t = JSON.parse(e));
				} catch (t) {
					cc.log('Failed to read or parse project.json');
				}
				this._initConfig(t);
			}
		},
		_initConfig: function (t) {
			var e = this.CONFIG_KEY,
				i = t[e.modules];
			(t[e.showFPS] = void 0 === t[e.showFPS] || t[e.showFPS]),
				(t[e.engineDir] = t[e.engineDir] || 'frameworks/cocos2d-html5'),
				null == t[e.debugMode] && (t[e.debugMode] = 0),
				(t[e.frameRate] = t[e.frameRate] || 60),
				null == t[e.renderMode] && (t[e.renderMode] = 0),
				null == t[e.registerSystemEvent] &&
					(t[e.registerSystemEvent] = !0),
				i && i.indexOf('core') < 0 && i.splice(0, 0, 'core'),
				i && (t[e.modules] = i),
				(this.config = t);
		},
		_initRenderer: function (t, e) {
			if (!this._rendererInitialized) {
				if (!cc._supportRender)
					throw new Error(
						"The renderer doesn't support the renderMode " +
							this.config[this.CONFIG_KEY.renderMode]
					);
				var i,
					n,
					r = this.config[cc.game.CONFIG_KEY.id],
					o = window,
					r = cc.$(r) || cc.$('#' + r);
				'CANVAS' === r.tagName
					? ((t = t || r.width),
					  (e = e || r.height),
					  (this.canvas = cc._canvas = i = r),
					  (this.container =
							cc.container =
							n =
								document.createElement('DIV')),
					  i.parentNode && i.parentNode.insertBefore(n, i))
					: ('DIV' !== r.tagName &&
							cc.log(
								'Warning: target element is not a DIV or CANVAS'
							),
					  (t = t || r.clientWidth),
					  (e = e || r.clientHeight),
					  (this.canvas =
							cc._canvas =
							i =
								document.createElement('CANVAS')),
					  (this.container =
							cc.container =
							n =
								document.createElement('DIV')),
					  r.appendChild(n)),
					n.setAttribute('id', 'Cocos2dGameContainer'),
					n.appendChild(i),
					(this.frame =
						n.parentNode === document.body
							? document.documentElement
							: n.parentNode),
					i.addClass('gameCanvas'),
					i.setAttribute('width', t || 480),
					i.setAttribute('height', e || 320),
					i.setAttribute('tabindex', 99),
					cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
						(this._renderContext =
							cc._renderContext =
							cc.webglContext =
								cc.create3DContext(i, {
									stencil: !0,
									antialias: !cc.sys.isMobile,
									alpha: !1,
								})),
					this._renderContext
						? ((cc.renderer = cc.rendererWebGL),
						  (o.gl = this._renderContext),
						  cc.renderer.init(),
						  cc.shaderCache._init(),
						  (cc._drawingUtil = new cc.DrawingPrimitiveWebGL(
								this._renderContext
						  )),
						  cc.textureCache._initializingRenderer(),
						  (cc.glExt = {}),
						  (cc.glExt.instanced_arrays = o.gl.getExtension(
								'ANGLE_instanced_arrays'
						  )),
						  (cc.glExt.element_uint = o.gl.getExtension(
								'OES_element_index_uint'
						  )))
						: ((cc._renderType = cc.game.RENDER_TYPE_CANVAS),
						  (cc.renderer = cc.rendererCanvas),
						  (this._renderContext = cc._renderContext =
								new cc.CanvasContextWrapper(
									i.getContext('2d')
								)),
						  (cc._drawingUtil = cc.DrawingPrimitiveCanvas
								? new cc.DrawingPrimitiveCanvas(
										this._renderContext
								  )
								: null)),
					(cc._gameDiv = n),
					(cc.game.canvas.oncontextmenu = function () {
						if (!cc._isContextMenuEnable) return !1;
					}),
					this.dispatchEvent(this.EVENT_RENDERER_INITED, !0),
					(this._rendererInitialized = !0);
			}
		},
		_initEvents: function () {
			var t,
				e,
				i = window;
			(this._eventHide =
				this._eventHide || new cc.EventCustom(this.EVENT_HIDE)),
				this._eventHide.setUserData(this),
				(this._eventShow =
					this._eventShow || new cc.EventCustom(this.EVENT_SHOW)),
				this._eventShow.setUserData(this),
				this.config[this.CONFIG_KEY.registerSystemEvent] &&
					cc.inputManager.registerSystemEvent(this.canvas),
				cc.isUndefined(document.hidden)
					? cc.isUndefined(document.mozHidden)
						? cc.isUndefined(document.msHidden)
							? cc.isUndefined(document.webkitHidden) ||
							  ((t = 'webkitHidden'),
							  (e = 'webkitvisibilitychange'))
							: ((t = 'msHidden'), (e = 'msvisibilitychange'))
						: ((t = 'mozHidden'), (e = 'mozvisibilitychange'))
					: ((t = 'hidden'), (e = 'visibilitychange'));
			function n() {
				cc.eventManager &&
					cc.game._eventHide &&
					cc.eventManager.dispatchEvent(cc.game._eventHide);
			}
			function r() {
				cc.eventManager &&
					cc.game._eventShow &&
					cc.eventManager.dispatchEvent(cc.game._eventShow);
			}
			t
				? document.addEventListener(
						e,
						function () {
							(document[t] ? n : r)();
						},
						!1
				  )
				: (i.addEventListener('blur', n, !1),
				  i.addEventListener('focus', r, !1)),
				-1 < navigator.userAgent.indexOf('MicroMessenger') &&
					(i.onfocus = function () {
						r();
					}),
				'onpageshow' in window &&
					'onpagehide' in window &&
					(i.addEventListener('pagehide', n, !1),
					i.addEventListener('pageshow', r, !1)),
				cc.eventManager.addCustomListener(
					cc.game.EVENT_HIDE,
					function () {
						cc.game.pause(),
							(comman.isGameRunningEnable = !1),
							comman.muteSound(),
							comman.pauseGame();
					}
				),
				cc.eventManager.addCustomListener(
					cc.game.EVENT_SHOW,
					function () {
						cc.game.resume(),
							(comman.isGameRunningEnable = !0),
							comman.resumeGame(),
							comman.restoreSound();
					}
				);
		},
	}),
	(Function.prototype.bind =
		Function.prototype.bind ||
		function (t) {
			if (!cc.isFunction(this))
				throw new TypeError(
					'Function.prototype.bind - what is trying to be bound is not callable'
				);
			function e() {}
			function i() {
				return r.apply(
					this instanceof e && t ? this : t,
					n.concat(Array.prototype.slice.call(arguments))
				);
			}
			var n = Array.prototype.slice.call(arguments, 1),
				r = this;
			return (e.prototype = this.prototype), (i.prototype = new e()), i;
		}),
	(cc._urlRegExp = new RegExp(
		'^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))|(?:localhost))(?::\\d{2,5})?(?:/\\S*)?$',
		'i'
	)),
	(cc.SimplePool = function () {
		this._pool = [];
	}),
	(cc.SimplePool.prototype = {
		constructor: cc.SimplePool,
		size: function () {
			return this._pool.length;
		},
		put: function (t) {
			t && -1 === this._pool.indexOf(t) && this._pool.unshift(t);
		},
		get: function () {
			var t = this._pool.length - 1;
			if (t < 0) return null;
			var e = this._pool[t];
			return (this._pool.length = t), e;
		},
		find: function (t, e) {
			for (
				var i, n = this._pool, r = n.length - 1, o = n.length;
				0 <= o;
				--o
			)
				if (t(o, (i = n[o]))) return (n[o] = n[r]), (n.length = r), i;
			if (e) {
				e = e();
				if (0 <= e) return (n[e] = n[r]), (n.length = r), i;
			}
			return null;
		},
	}),
	(cc.EventHelper = function () {}),
	(cc.EventHelper.prototype = {
		constructor: cc.EventHelper,
		apply: function (t) {
			(t.addEventListener = cc.EventHelper.prototype.addEventListener),
				(t.hasEventListener =
					cc.EventHelper.prototype.hasEventListener),
				(t.removeEventListener =
					cc.EventHelper.prototype.removeEventListener),
				(t.dispatchEvent = cc.EventHelper.prototype.dispatchEvent);
		},
		addEventListener: function (t, e, i) {
			var n;
			'load' === t && this._textureLoaded
				? setTimeout(function () {
						e.call(i);
				  }, 0)
				: (void 0 === this._listeners && (this._listeners = {}),
				  void 0 === (n = this._listeners)[t] && (n[t] = []),
				  this.hasEventListener(t, e, i) ||
						n[t].push({ callback: e, eventTarget: i }));
		},
		hasEventListener: function (t, e, i) {
			if (void 0 === this._listeners) return !1;
			var n = this._listeners;
			if (void 0 !== n[t])
				for (var r = 0, o = n.length; r < o; r++) {
					var s = n[r];
					if (s.callback === e && s.eventTarget === i) return !0;
				}
			return !1;
		},
		removeEventListener: function (t, e, i) {
			if (void 0 !== this._listeners) {
				var n = this._listeners[t];
				if (void 0 !== n)
					for (var r = 0; r < n.length; ) {
						var o = n[r];
						o.eventTarget === i && o.callback === e
							? n.splice(r, 1)
							: r++;
					}
			}
		},
		removeEventTarget: function (t, e, i) {
			if (void 0 !== this._listeners) {
				var n = this._listeners[t];
				if (void 0 !== n)
					for (var r = 0; r < n.length; )
						n[r].eventTarget === i ? n.splice(r, 1) : r++;
			}
		},
		dispatchEvent: function (t, e) {
			if (void 0 !== this._listeners) {
				null == e && (e = !0);
				var i = this._listeners[t];
				if (void 0 !== i) {
					for (var n = [], r = i.length, o = 0; o < r; o++)
						n[o] = i[o];
					for (o = 0; o < r; o++)
						n[o].callback.call(n[o].eventTarget, this);
					e && (i.length = 0);
				}
			}
		},
	}),
	cc.EventHelper.prototype.apply(cc.game);
var cc = cc || {},
	IEBinaryToArray_ByteStr_Script,
	myVBScript;
(cc._loadingImage =
	'data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7'),
	(cc._fpsImage =
		'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfcAgcQLxxUBNp/AAAQZ0lEQVR42u2be3QVVZbGv1N17829eRLyIKAEOiISEtPhJTJAYuyBDmhWjAEx4iAGBhxA4wABbVAMWUAeykMCM+HRTcBRWkNH2l5moS0LCCrQTkYeQWBQSCAIgYRXEpKbW/XNH5zS4noR7faPEeu31l0h4dSpvc+t/Z199jkFWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY/H9D/MR9qfKnLj/00U71aqfJn9+HCkCR/Wk36ddsgyJ/1wF4fkDfqqm9/gPsUeTnVr6a2xlQfnxdI7zs0W7irzD17Ytb2WT7EeNv/r4ox1O3Quf2QP2pgt9utwfout4FQE8AVBSlnaRmfvAURQkg2RlAbwB9AThlW5L0GaiKojhJhgOIBqDa7XaPrusdPtr5kQwF0BVAAoBIABRCKDd5aFUhRDAAw57eAOwAhKIoupft3zoqhB1AqLwuHIBut9uFt02qqvqRDJR2dAEQJj/BAOjn56dqmma+xiaECAEQAWAggLsB6A6HQ2iaZggBhBAqgEAAnQB0kzaEmT4hAITT6VQ8Ho/HJAKKECJQtr8LwD1y/A1/vcdfEUIEyfZ9AcQbYvZ942Px88L2UwlJR0dH0EMPPbRj5syZPUeNGrXR7Xb/641xIwJ1XY9NSUlZm52dfW+XLl1w8uRJzJ8//+OGhoYJqqqe1TSt1Wsm9NN1PSIqKmr12rVrR5WUlHy1bdu2AQCumWc3IYRD1/UwVVXnFRQUTIuNjUVzczN2797dWFJSkq8oymZd15sAGAEnFEUJ1nX9nzIzM1dnZmZGh4SE4OTJk5g5c+Zf29vbp9pstrMej6fVOyhIhgAYU1hY+B+hoaGoqKg4XVlZea+XTULTNFdCQsLGiRMnPuR2u3UhBOV9eeDAAWXTpk095DUe6WsoyRE5OTlr0tLSAux2O/bs2cO5c+e+pijKUpIXSHaQVAGkvPLKK++6XK4OksJLCFlXV2cvKSlJBFAjhU+x2WwhHo9nUHp6+urMzMy7wsLCUF9fjxdffPHjxsbGiTab7WuPx9NiEutOuq4PyMjI+M+srKyYqKgoHD58GDNmzNjq8XhyVFU9b/q+LH7hBAEYu3PnTlZVVRFAGgCX6f/tAHoOHDjwa0p27txp/JO9e/f+QM7cipw9nfL3kQBKt2zZQpJ87rnn6mQmoHilw2EACs+cOUOSrK+vZ1NTE0nyo48+IoBpxswoBcMJ4Ndjx471kOTFixe5d+9ekqTH42H//v13A4jyzpAURfEH0H/OnDnthu1z5sw558MmFUCPWbNmnaMP3nrrLZoyDmP8Hl68eDFJ8siRI9/Yc+zYMQKYKdtAztrTrl27xptRXV1NAKMAOAyBBBA/Y8aMdpLs6Ojgxx9//E37+++//29yvFXppwvAwMcee8xjtDHsuXLlCqOjo//ia3wsfpkoALqFhoZuIckJEyackimm3dQmEMDUmpoakmRISMhhAHOHDx/eQJIbN24kgKEyMAHAFRMTs2XXrl1saWkhSZ0kp0+ffhrAr3wEW/S8efOukORLL72kA1gKYMPWrVtJkk899dRJAHeYrgsEsIQkjx8/TgDvAPjd448/3kaSb7zxBmUa7vC6z53BwcFbSHL9+vU6Sc6aNes8gF5ewWAH0PfVV18lSQL4DMBGIcQ6AKtcLleBFC2jXtFt8ODBe0iyoqKCAJYByC8qKmJDQwOzsrK+MAmqo1OnTveHhoa+GRkZ+XZkZOSWiIiIvzgcjk9mzpypkWRmZuZpmbYbGV4AgPnNzc1sa2sjgN0A5iQmJtaSZHl5OQHcb/K3s81mW0uSTU1NBFAFYFbfvn1Pk+Tbb79NAA8IIVzW42/hByA+Pz/fLR/2ZXIda05NI/z9/TeR5J49ewhgqlxTrtI0jY2NjQQw3zTLuWJiYjaUlJToS5Ys6fjkk080kwDEeAmADcA9GzZsIElGRUW9CyAWwLApU6Y0kOSKFSsog9QICGdERMTGsrIyZmVlEcC9AB4IDw/fTpLbtm0jgN94CUAnAJmVlZVcs2aNZ/LkyRdJcvbs2b4EwAkgZfPmzTxw4AABFAN4BkC6vFeUSewcAO5duXIlSTIhIaEawGMAxgKYAmAGgCS73e5vrKVk/yGythANYEhCQsIhkly+fDkBpKqqGmL6DgIALDKN/3yZpVWQZGVlJQE8aPI3KiMjo5okV61aRQAjAPQBMPfIkSN0u90EUCBtsPiFEwpgbn19PdetW2fM5N4zQ9ekpKQqkty0aRMBpMjiWM6JEydIkoqirJUFJ6iq6pAPVy8A6cZMehMBUACEuVyuFwG8HBwcPEIWx367ZMkSjSQXLVrUJouTRorrkAHdA8BdQogsAOsKCwtJkmPGjDkvMw2bDDo/ADEjRoz4XylyFbm5uY0mAbjLyyZ/AOOrq6tZVlbWsWDBgo69e/eyoqKCgwcPPg4gSQaoIRbp27dvN7KF+tLSUr28vJwFBQXtMpvpYRIM7+wrAkDeqVOnePbsWQIoNKfzpiXPg8uXLydJJicnNwF4f+nSpW6STEtLq5fjYwhk1wkTJtSQ5Ouvv04AqTKj+N2xY8dIkgEBAW/Ie1v8wncRegwZMmQvSfbr12+3Ua33WqPfOWbMmP0kWVpaSgCDZAqcfejQIWNZsEGKgvnh9gfQb9myZd8nAEJVVZtMkUNk8CcNHTq0liR1XWdYWNhmH1mJIme80OnTp18x1rp5eXkEsNJms92Fb7e/IgEsvHz5Mp999tkmAI/l5uZeMC0B7vEqqAYAyL106RJJsra2lpWVld+sucePH38ZQG+5NncBeOrgwYMkqbe3t/Po0aOsra011wAWyl0H7x0JJ4DE+fPnu0kyPT29DsDdUrBuyNKEEAkAdpw/f/6GeoEM8GUmfwEgPCIiopwkGxsbabPZPgOw6L777vvm4p49e26VGYjFLxUhhD+ApLKyMp44ccIoVnXybgbgzkcfffRzklyzZg0BDJYCMMmoCwQFBXkLgLGWvvcWAgBToSsKwNPTp09vMR7UuLi4rwH0lgU8c/Db5ezbeeTIkRWzZ8++aMxu+fn5BPCADBwHgP4LFy701NXVEUAJgAnPP/98kyxMNgHo53A4zH77BQQETMvPz7+Um5vbBuAlAFMSExPPmdbVL0qh8Acw8fDhw5SCchVAEYAVb775JknyhRdeaJYztHfxMwLAaqNwCGC2FArv8x0hAHKNLGPKlCme5OTk/Zs3bzb7O0wKiiG8KXl5ed8IxenTp0mSR48e1UmyW7duWywBuD2xyQcgFECgoih+8H1gyJgZV5Lkyy+/3CbTRIePtl2HDBmyw1QBHyGDdXZdXR1JUghRKkXBjOMHCoBdpr0L3nvvPZLkF198wejo6O0A4lVVDTb74HQ6AwD8Wq7Jh8rgGgDgQ13XjVR8qaxJuADMbmlpYXl5uV5UVNRWUFDgfv/993Vj/ZydnU1c37eHXML4S3viAcQqitJD2l104cIFY8lTKsXSBWBMVVWVcd9yed2A1NTUQ6Zl00CvLMMOoHdubm6zFIlWOf5+PsY/Kj09vdrU11QAwwGsv3jxIk21m2DZr10I0RXAuAcffPBgaWkpV69eTYfDcdiwUxY0w6xw+flX8L1xApjevXv3lREREaW6rofB93aPDUDQpEmTMgHgtddeqwBwEd/utZvpqK6uPgEAcXFxkA94NwB9unfvjrNnz4LklwDcf08iIqv66Zs2bXrl4YcfxooVKxAbG7uqrq5uAYA2TdOEqqpGYIi2tjbl6aeffu/YsWPv5uTk7JaC1wHg4Pnz542MwoVvTx+21dbWYvjw4WLixIl+2dnZ9lGjRgmSTE1NRUpKCkwFTGiaxtTU1OXTpk3707Bhw/6g67pDipnT4biuj7qut+Lbk3Vf1tTUXI9qu91Pjq1QFEUBgJaWFgBo8yGOQ8eNGxcAAOvXr/8QwBUfYygAKL169eoCABcuXACAWtn2hOGv0+kMNO1KiPDw8F4A4rZv3/7R1KlTR0+bNu1ht9u9r1+/fqitrQXJgwDarRC6/QjPzs4+QJIffPCB9/aQmSAA43ft2mW0e1QGoi8CAPyLsZccExNTC2BlRkbGRdOyYJCP2csBIN6UAZzCd7cBbQCijYp/dXU1ExMTz6SmptaMHj36f9LS0vYlJCRsl6mxIWSdu3fv/g5J7t+/nwC2AShMTk6+SJKff/45AWRLYbD7+fndAeDf5BJnLoCCyZMnt5JkdnZ2C4B/F0KEm1Pu+Pj4rST55ZdfEsBWAK+mpaVdMo3raDn7KwDuSEpK+m+S3LBhAwG8DuCtHTt2UBbpjgC408vvcFVV15HkuXPnjMp+p5uMf0RcXNyHJNnQ0EBVVfcCWBQXF3fG+Jv0yxABPwB5LS0tRmFxN4BlTzzxxGWSXLx4sS5F3GGFy+1Hp5SUlJq6ujoWFxdTpsZ2H+0iIyMj/0iSWVlZX5mr5jfJFroPGzasxlhTnjp1iiTZ3NxMl8tlrCd9pfa9SkpKSJI5OTmnZOageLUZZqxvfVFWVkZcPwdgNwnSCKPqb17jkmR8fPzfZMDZ5CRsFBmNI7h95s2b1yhT7/MAYmStwCx4vy0uLqa3v5qmEcCfvSr1QQAeXb16NY3Cm3HQ55133iGAp+SxZTNhKSkpfzUddkrFjYevzAQCeGjp0qXfsYckY2NjTwD4leGDLCL2HTdunNtoY+zWSHFcIHdsFCtcfuZ1vO9Eqs3m7/F47sb1k2qX/f3997W2tl7BjWfpBYDOzzzzzIVJkyZh0KBBCwEsB3AJvl9AETabLcDj8dwRFRW1ctasWb8JCgpSzp07d62wsPC/Wltb8xRFadR1/ZqPXYbgAQMGbI2Pjw/+6quv9ldVVT0r01ezuPRJSUn5Y9euXXVd11WzDaqq6kePHm3+7LPPRgO4KlNuxWazhXo8nuTk5OSXMjIyEl0uFxoaGtqKior+dPXq1VdUVT0jj7r68ieoT58+vx8yZMjdx48fP1JVVTVF9m20VW02WyfZf97YsWPjXS4X6urqWvPy8jYCWCyEuEDS8FdVFKWzruv//OSTTy5OTk7uqWkaPv3007qysrJ8RVH+LI8ym8/rB3Tu3HnRI488knLo0KG2ffv2ZQI4C98vP6mqqoZqmpaclpa2cOTIkX39/f3R0NDQUVxc/G5TU9PLqqrWa5rWLH1QVFUN0TStX1JSUvH48eP7BwYG4uDBg1cKCgpeBbBe2u+2Qug2EwD5N5sMPuNtMe8XP4TT6Qxoa2sbIGeXvUKIK7d4IISiKC5d1wPljOfA9bPwzYqiXNV13dd6Uqiq6qdpml2mpe02m63d4/G4vcTF5fF47LJf71nJA6BZVVW3pmntuPHlmAD5wk6Q9NnbHp9vHaqq6tA0zU/64PZhk1FfCZB9G/23ALiqKEqzD39tpvbGUqoFwFUhRLP3yzpCCDtJpxyXDulfG27+pqRR3DXsUWVd4Yq0x/taVQjhIhksC8L+ABpM9ljBf5sKwI8pIBr75L5E4vvu+UNeG/a+hv+AL7yFH8qPtOfHjtOP6V/Bja8D6z/B2Nys/1u9Xv33tLf4GfF/LC4GCJwByWIAAAAASUVORK5CYII='),
	(cc._loaderImage =
		'data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAlAAD/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4MDBEMDY2QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4MDBEMDY1QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU2RTk0OEM4OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU2RTk0OEM5OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQADQkJCQoJDQoKDRMMCwwTFhENDREWGhUVFhUVGhkUFhUVFhQZGR0fIB8dGScnKionJzk4ODg5QEBAQEBAQEBAQAEODAwOEA4RDw8RFA4RDhQVERISERUfFRUXFRUfKB0ZGRkZHSgjJiAgICYjLCwoKCwsNzc1NzdAQEBAQEBAQEBA/8AAEQgAyACgAwEiAAIRAQMRAf/EALAAAAEFAQEAAAAAAAAAAAAAAAQAAgMFBgcBAQEAAwEBAAAAAAAAAAAAAAAAAQMEAgUQAAIBAgIEBwoLBgQGAwAAAAECAwAEEQUhMRIGQVFxsTITFGGBwdEiQlKSMzWRoeFicqKyI1NzFYJjJDQWB9KjVCbxwkNkJWXik3QRAAIBAgMFBQcDBQEAAAAAAAABAhEDIRIEMUFRcTJhwVIUBZGhsSJyEzOB0ULhYpIjUxX/2gAMAwEAAhEDEQA/AMJSpUqAVKlXuFAeUq9wpUB5XuFe4V6ooDzZHDox0CnGMinzwl7Z8NajaHeoO3vmTBZBtp9YUIqTEV5ROxHKnWRnaU8VRMhFBUjpV7hSoSeUq9pUB5Sr2lhQHlKvcK8oBV7hSFSRrtaKAZs07YNPM1pG2xJIAw1jSeandry/8X4m8VCKkWwaWwam7Xl/4v1W8VLtmX/i/VbxUoKkWwakSM407tmX/i/VbxUmzGwjQsjdY41IARie/U0IbZO0kNtCXnOCkEBeFu4KI3Bs7DNb27ya+jDx3kJeEnpJJEcQVbWDsk17u5urd591ucZkWhym2Vnd9RkCDEpFxDRpbw0bunu5mlp2De2FMLYXOD2wB2xbOeraUcYGJ72mlSUiqzzdzMd3Z3mixltA2yzcK/NlHM1DQyRXce1HocdNOEfJXZ88y9ZojOqhiBszIRiHQ8Y4cK5TvHuzLljHNMqxNoDjLFraHHnjPxcNCGVbxEUzYNTx5jZSxhpW6qTzlwJ+DCvO2Zf+L9VvFSgqyHYNLYNTdssPxfibxUu15f8Ai/VPiqCakOwa82DU/a8v/F+JvFTDdWPBL8R8VKCvYRYV5UzoMAy6QdIIqI0B4KJtxiRQwou16QoGUkntH5Tz0RbZbmF2hktraSVBo2lUkY8tDye0flPPXTslVUyiyVRsjqUOA4yMT8dW2ram2m6UVTNq9S7EIyUVJydMTn/6DnP+im9Wl+g5z/opvVrpteEhQWY4AaSTwAVf5WPiZh/9S5/zj7zltzlmYWkfWXNvJDGTgGcYDHirR7i7mSbwXParsFMrgb7w6jKw/wCmnc9I14kF3vpvCljbMyWMOJL4aEiB8qU/ObUK7HYWVrl1pFZWiCOCBQqKOLjPGTrNZZqKbUXVHq2nNwTuJRk1VpbgXN8s7Rk5ym0UQQzhIG2NAjhxHWbI+gCBVjBBFbwxwQqEiiUJGg1BVGAFe7dV28WYLYZFmF2Th1UD7JGjymGyn1iK5OyzIBGB1HgrLZhamzumQAGJwSqnSCh1q3GOCodxt4cxurdcpzuN4cyhiWaF5Bg09udUmnWw1H/jV9nFuJ7Quo+8h8peThFA+047vduyMtk7fYqTl07YFdfUufMPzT5p71UdtlmYXaGS2t3mQHAsgxANdadYJopLe4QS2867EsZ4QfCNYrCFbjdDPmgkYyWFxgVf04ifJf6ScNdRUW1XBb6FU5TjF5EpSSrGu/s5lN+g5z/opvVpfoOc/wCim9WtdHnatvObJXDW7xLGhB8nrPaY9/HCr+tEdPCVaSeDoYLnqF63lzW4/PFSW3ecxbI84VSzWUwUaSdg0DXXK5nvAipnd6qgKvWnQO7pri9ZUEmm3Vl2j1kr8pRlFRyquBNZjGxQ/S56Y1S2fu9OVueon11Szahoou06QoQUXadIVCD2FJJ7R+U89dMydv8Axdn+TH9muZye0flPPXQstlK5Tbka1gUjlC1q0vVLkeb6r+O3Tx9xcY1nt8c0NrZCyiOE1108NYjGv1joo7Js1jzKyScYLIvkzL6LDwHXVJksH9Sb49dKNq0tj1jA6uriOCL+02FWX7iVtZX1/AzaHTyeoauKn2MX9W79zebiZCuR5MjSrhfXuEtwTrUeZH+yNfdrRNcxI6IzhXlJEak6WIGJ2Rw4ChWnChndtlVBLMdQA0k1gbXNMzzDfDLs6mjaPKppJbWwJ1bOwwxw43OnHh71YT3DpfWUJmFlb5jHHDdeXBHIsrRea5TSqvxqG04cNN62vetoCS4tre5mgnkGE9q+3DKOkuI2WX6LDQRRHWDh1UCtwj7QRg2wdl8Djgw1qe7XvW0BQ3kfZ7mSLgU+T9E6RVbnuVrnWVSWqj+Lt8ZbRuHEdKPkYVcZ2MJY5fSGyeVar45+rkWQHAqccalPE5km1htWK5nK4Wnt5FuUBUwOMG4nGkA/BXUrW4S6torlOjMgcd/xVn7rLo7zKs0uEjCNeSvdwoBhgsZxX1l2j36k3Lu+uyprdj5Vs5A+i/lD48a0aaVJOPi7jB6lbzWozpjB48pf1NDXNN4vfl7+Z4BXS65pvF78vfzPAK71XTHmZ/S/yT+jvJ7L3fHytz1E+upbL+Qj5W56jfXWRnsIYKLtekKEFGWvSFQgyjk9o/Keet3YthlMP/5x9msJJ7R+U89biyb/AMXEv7gD6tadL1T+kwepRrC39ZkLDMbiwMvUHRPG0bjlGg8ore/23sxBldxfMPLupNhT8yL/AORNZbdzJ484scytxgLqJY5LZj6Q2sV5G1Vud1mjjyG0ij0NEGSZToKyhjtqw4waztuiXA3qKTbSxltfGhbZlE95ZtZqxVbgiOZhrER9ph3Svk9+pJILZ4Y4DGBFCUMKjRsGPobPFhUfW0NJmljE2xJcIrcI2vFUEln1lRXd6lrazXT9GCNpD+yNqoI7mOVduNw6nzlOIoPOUa6yye1XXcbMR5GdQ3xY0BSbj31/FcTQZirJ+q431q7anbHCTZ72Bw7lbPrKBMcBWNNgbMBBh+bsjBdni0VJ1lARZs6yWiupxCuMDy6KpS2IwOo6DTr3Mre3e5tZZVUM4ZBjqOOJoWO4jkXajcOOMHGgDISvWIrdAkKR80+TzVl908bPPL3LzxOuHdifxVfiTAg92qI/w+/8gGgSyN/mR7XPVlp0lF/3L3mbVKtu5Hjbk/8AHE2Fc03i9+Xv5ngFdKNc13i9+Xv5ngFaNV0x5nn+l/kn9HeEWXu+PlbnqJ9dS2Xu9OVueon11kZ7CGCjLXpCgxRlr0hUIPYUcntH5Tz1s8vb+Bt1/dqPirGSe0flPPWusG/g4Py15q06XqlyMWvVYQ+ruI9xJOqzO9hOto/sP8tbGOFIrmWeM7IuMDMnAXXQJOUjQeOsJk0nY96ip0CYunrjaHx1t+srPJUbXBm2LrFPikwTOb+T+VhbZxGMrDXp83x1QSy2tucJpUjPETp+Cn5/ftaRvKvtp3Kx48HG3erHMzOxZiWZtLMdJNQSbbL71Vk6yynViOkqnEEfOWtPbXi3EQkGg6mXiNckjeSJxJGxR10qw0GtxuxmvbImD4CZMFlA4fRfv0BqesqqzTMZNMEDbIHtHH2QeCiZJSqMQdOGiue53mz3czQwsRbIcNHnkec3c4qAMuriz68gTIToxwOOnlp0MjxMJYW741Gs3RVldtbygE/dMcHX/moDaxTiWNZB53B3arb8/wC+4SOF4sf/AKxU9kcBsfOGHfoUHtG/RbzY5Die5HHhXdvavqiZ9Q8Jdlq4/gbKua7xe/L38zwCuhpf2Uk/Zo50kmwJKIdogDjw1VzzeL35e/meAVp1LTgqY4nn+mRauzqmqwrjzCLL3fHytz1E+upLL+Qj5W56jfXWRnroYKLtekKEFF2vSFQg9hSSe0flPPWosm/hIfoLzVl5PaPynnrRWb/w0X0F5q06XqlyM2sVYx5gmbFre/t71NY2T+0h8VbSO5SWNJUOKSAMp7jDGspmMPaLRlXS6eWve1/FRO7WYdbZm1Y/eW/R7qHxHRXGojlm3ulid6aVbaW+OALvgCLq2Hm9WxHKWqjhj6xsK1e8dm15l4niG1LZkswGsxtrPeOmsvayBJA1VItlWjptLuTdPMo7LtjRDq9naK4+WF9IrUW7BaHOljGqVHB7w2hzVoZt87d8vaNYSLl02CcRsDEbJbj71Uu7UBkvJ7/D7q2QoDxySaAO8MTXdxRVMpRp5XZOWdF/ms7R5XdyKfKWJsO/5PhrG5XlNxmEywW6bTnTxAAcJNbGSMXkM1pjgbiNo1PziPJ+Os7u7m/6ReM00ZOgxSpqYYHT3wRXMKN4ll9zUG4bQfNshu8sZVuEA2hirA4qe/VOwwrVbzbww5mI44UKRRYkbWG0S3JWctbd7u5WFfOOLHiUdJqmaipfLsIsObhWe001lMkMVvJNjhghIALMcBxCs7fxXQmkupx1bXDswGPlaTidVaEyKNXkoo4eBV+Sq7L7Vs9zcBgeyQ4GQ/MB1crmoim2orezqcowTuSeEY48jQ7oZX2PLzdyLhNd6RjrEY6I7+uspvH78vfzPAK6UAAAFGAGgAcArmu8Xvy9/M8ArTfio24RW5nnaG67uou3H/KPuqT2X8hHytz1G+upLL3enK3PUb66ys9RDBRdr0hQgou06QqEGUkntH5Tz1e238vF9BeaqKT2j8p56vbb+Xi+gvNWjTdUuRn1XTHmTh8KrJTJlt8t1CPIY44cGnpJVjTJYkmjaN9Ib4u7V923njTethRauZJV3PaW1rfLIiXEDYg6R4VYc9CXW7thfOZbKdbGZtLW8uPVY/u3GrkNUkM9zlcxUjbhfWOA90cRq4gv4LhdqN+VToNYWmnRm9NNVWNTyHc6VWBv8wt4YeHqm6xyPmroq1Z7WGFLSxTq7WLSuPSdjrkfumq5yHXDUeA92oO2SKpVumNAaoJLMXH3myp0rpJ4uKhc3tbDM5BMri1zAj79j7KTiY8TcdBpcsith0286o+sPCagEX9Pzg4zXUCp6QYse8oouCG3tk6m1BYv05W6T+IdyolxbHDAAa2OgDlNCz3ryN2WxBd5PJMg1t81eId2ukqnLlTBbfcuY+9uJLiRcvtPvHdsHK+cfRHcHDWsyawjyy0WBcDI3lTP6TeIcFV+S5OmXx9bJg1048o8Cj0V8Jq2DVu09nL80up7OxHi+oal3P8AXB/IsZS8T/YOV65zvCcc7vfzPAK3ivWCz445zeH954BXOr6I8yfSfyz+jvCLP3fHytz1G+upLP3fHytz1E+usbPaQ0UXadIUIKLtekKhB7Ckk9o/Keer22/l4/oLzVRSe0flPPV7b/y8X0F5q0abqlyM+q6Y8yQsBTDMor1o8aiaE1pbluMqS3sbLLHIhSRQyngqukhaJ9uBjo+H5aOa3ao2t34qouRlLajTalGP8v0IY8ylXQ+PKPFU/bYXOLPge6CKia0LaxTOxHu1Q7cuBd9yPEJ7TbjXKO8CajbMIF6CNIeNvJHjqIWJ7tSpYkalqVblwIdyG+RGXur0hXYJFxal+Dhq5y3slkv3Y2pD0pTr+QUClpJRUdo9XW4OLrTHtM16cZLLWkeC7y4jvlNEpcRtw1Ux27Ci448NZrTFy3nn3IQWxlgGrDZ3pza7/M8ArZo+ArF5171uvp+CqdV0R5l/psUrs2vB3hdl7vTlbnqJ9dS2Xu+PlbnqJ9dY2eshooq16QoQUXa9IVCD2FLJ7RuU89WNtmUSQqkgYMgw0accKrpPaPynnrZWG4Vi+VWmY5tnMWXG+XrIYnA0rhj0mdcTgdNdwnKDqjmduM1SRR/qlr8/4KX6pa8T/BVzDuLZXudRZblmbxXcPUNPc3KqCIwrbOzgrHEnHjoyD+3eSXkht7DeKG4umDGOJVUklfouThXfmbnZ7Cvy1vt9pmv1W1+d8FL9VteJvgq5yrcOGfLmzHN80iyyETPbptAEFo2ZG8pmUa1OFNn3Ky6W/sbDKM5hv5bx2WTZA+7RF2y52WOPJTzE+z2Dy1vt9pT/AKpacTerS/U7Tib1a04/t7kDXPY03jhN0W6sQ7K7W3q2dnrMccaDy/8At80kuZfqWYxWNtlcvUPPhiGYhWDeUy7IwYU8xPs9g8tb7faUn6pacTerTxm9oOBvVq3v9z927aynuId44LiWKNnjhAXF2UYhRg516qpsryjLr21665zFLSTaK9U2GOA87SwqY37knRU+BzOzags0s1Oyr+BKM6sxwP6tSDPLMen6vy0rvdm3Sxlu7K/S7WDDrFUDUTxgnTU826eXW7KlxmqQuwDBXUKcD+1Xee/wXuKX5XDGWLapSVcOyhEM/seJ/V+WnjeGx4pPV+Wkm6kKZlFay3Jlt7iFpYZY8ASVK6DjtDDA0f8A0Tl340/1f8Ndx8xJVWXB0KbktFFpNzdVXAC/qOwA0CQni2flrO3Vwbm5lnI2TKxbDirX/wBE5d+NcfV/wVR7xZPa5U9utvI8nWhmbbw0YEAYYAVxfhfy5rlKR4Fulu6X7mW1mzT8S4Yis/5CPlbnqJ9dSWfu9OVueon11mZvQ2i7XpChKKtekKhBlNJ7R+U89bDfGTb3a3ZX0Lcj6kdY+T2j8p560288m1kWQr6MJ+ylSAr+2cnV5renjs3H1loX+3j9XvbbtxLN9lqW4UnV5jdnjtXHxihtyZNjeSBu5J9k1BJe7xy7W5CJ/wCzuD/mTVTf2+fq97LJuLrPsNRueS7W6aJ/38x+vLVXuY+xvHaNxbf2GoCezf8A36j/APsSf8w1sLnqczTefJluYoLm5uo5F61sBshItP1cNFYe1f8A3ir/APfE/wCZUe9bB94r5jwuPsrQFhmG4l/Z2M17HdW90tuu3IkTHaCjWdIw0VVZdks9/C06yJFEp2dp+E1bbqybGTZ8vpQD7L1XRv8A7blT96Oda7tpNuuNE37Cq9KSisjyuUoxrStKllHbLlWTXsMs8chuSuwEPDqwoLe5y+YRE/gLzmqRekvKKtd4327yM/ulHxmrHJStySWVRyrjxKI2XC/CTlnlPPKTpTdFbP0L1bgrf5Lp0G3dPhQHwV0S1lzBsns3sESR8Crh9WAJGjSOKuU3E+zdZQ3oJh8IArdZXFDmOTpHa3i2+YrI2KtKy4ricBsBuHHgFXSo440+Wa2qqxjvM9uMoy+WvzWpLCWWWE28HxL6e43ojgkeSCBY1Ri5BGIUDT51cl3vm276BBqSEH4WbxV0tlkyXJcxTMb+OW6uY9mGHrCzDQwwAbTp2uKuTZ9N1uYsfRRR8WPhrm419mSSjRyiqxVK7y23B/ftuTm2oSdJyzNVw3BFn7vTlbnqF9dS2fu9OVueon11lZuQ2iLdsGFD05H2dNQGV0ntG5Tz1dWm9N1b2kVq8EVwsI2UaQaQOKhmitZGLOmk68DhSFvY+gfWNSAg7z3Qvo7yKCKIohiaNR5LKxx8qpxvjcqS0VpbxvwOAcRQPZ7D0G9Y0uz2HoH1jUCpLY7zXlpbm3eKO5QuzjrBqZji3x17PvNcyT288VvDBJbMWUovS2hslW7mFQ9nsPQPrGl2ew9A+saCod/WNxtbYsrfb17WBxx5ddD2281xC88klvDcSXEnWuzrqOGGC9zRUPZ7D0G9Y0uzWHoH1jQVCLreq6ntZbaO3it1mGy7RjTs1X2mYy20ZiCq8ZOODcdEdmsPQb1jS7PYegfWNdJuLqnQiSUlRqpFLmryxtH1Ma7Qw2gNNPOdSt0oI27p007s9h6B9Y0uz2HoH1jXX3Z+I4+1b8IJdX89xLHKQFMXQUahpxoiPN5P+onfU+A0/s9h6DesaXZ7D0D6xpG7OLbUtu0StW5JJx2bBsmbtiSiEk+cxoCWWSaVpZOk2vDVo0VYdnsPQb1jSNvZcCH1jSd2c+p1XAmFqEOmOPEfaH+BQd1ueo211IzrgFUYKNAAqI1WztCpUqVCRUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoD/9k='),
	(cc.loader.loadBinary = function (t, e) {
		var i = this,
			n = this.getXMLHttpRequest(),
			r = 'load ' + t + ' failed!';
		n.open('GET', t, !0),
			cc.loader.loadBinary._IEFilter
				? (n.setRequestHeader('Accept-Charset', 'x-user-defined'),
				  (n.onreadystatechange = function () {
						var t;
						4 === n.readyState && 200 === n.status
							? ((t = cc._convertResponseBodyToText(
									n.responseBody
							  )),
							  e(null, i._str2Uint8Array(t)))
							: e(r);
				  }))
				: (n.overrideMimeType &&
						n.overrideMimeType(
							'text/plain; charset=x-user-defined'
						),
				  (n.onload = function () {
						4 === n.readyState && 200 === n.status
							? e(null, i._str2Uint8Array(n.responseText))
							: e(r);
				  })),
			n.send(null);
	}),
	(cc.loader.loadBinary._IEFilter =
		/msie/i.test(navigator.userAgent) &&
		!/opera/i.test(navigator.userAgent) &&
		window.IEBinaryToArray_ByteStr &&
		window.IEBinaryToArray_ByteStr_Last),
	(cc.loader._str2Uint8Array = function (t) {
		if (!t) return null;
		for (var e = new Uint8Array(t.length), i = 0; i < t.length; i++)
			e[i] = 255 & t.charCodeAt(i);
		return e;
	}),
	(cc.loader.loadBinarySync = function (t) {
		var e = this.getXMLHttpRequest(),
			i = 'load ' + t + ' failed!';
		e.open('GET', t, !1);
		var n = null;
		if (cc.loader.loadBinary._IEFilter) {
			if (
				(e.setRequestHeader('Accept-Charset', 'x-user-defined'),
				e.send(null),
				200 !== e.status)
			)
				return cc.log(i), null;
			t = cc._convertResponseBodyToText(e.responseBody);
			t && (n = this._str2Uint8Array(t));
		} else {
			if (
				(e.overrideMimeType &&
					e.overrideMimeType('text/plain; charset=x-user-defined'),
				e.send(null),
				200 !== e.status)
			)
				return cc.log(i), null;
			n = this._str2Uint8Array(e.responseText);
		}
		return n;
	}),
	(window.Uint8Array = window.Uint8Array || window.Array),
	cc.loader.loadBinary._IEFilter &&
		((IEBinaryToArray_ByteStr_Script =
			'\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n'),
		(myVBScript = document.createElement('script')),
		(myVBScript.type = 'text/vbscript'),
		(myVBScript.textContent = IEBinaryToArray_ByteStr_Script),
		document.body.appendChild(myVBScript),
		(cc._convertResponseBodyToText = function (t) {
			for (var e = {}, i = 0; i < 256; i++)
				for (var n = 0; n < 256; n++)
					e[String.fromCharCode(i + 256 * n)] =
						String.fromCharCode(i) + String.fromCharCode(n);
			var r = IEBinaryToArray_ByteStr(t),
				t = IEBinaryToArray_ByteStr_Last(t);
			return (
				r.replace(/[\s\S]/g, function (t) {
					return e[t];
				}) + t
			);
		}));
var cc = cc || {},
	ClassManager = {
		id: 0 | (998 * Math.random()),
		instanceId: 0 | (998 * Math.random()),
		getNewID: function () {
			return this.id++;
		},
		getNewInstanceId: function () {
			return this.instanceId++;
		},
	};
switch (
	(!(function () {
		var g = /\b_super\b/;
		(cc.Class = function () {}),
			(cc.Class.extend = function (t) {
				var r = this.prototype,
					i = Object.create(r),
					e = ClassManager.getNewID();
				ClassManager[e] = r;
				var n = { writable: !0, enumerable: !1, configurable: !0 };
				function o() {
					(this.__instanceId = ClassManager.getNewInstanceId()),
						this.ctor && this.ctor.apply(this, arguments);
				}
				(i.__instanceId = null),
					(o.id = e),
					(n.value = e),
					Object.defineProperty(i, '__pid', n),
					(o.prototype = i),
					(n.value = o),
					Object.defineProperty(o.prototype, 'constructor', n),
					this.__getters__ &&
						(o.__getters__ = cc.clone(this.__getters__)),
					this.__setters__ &&
						(o.__setters__ = cc.clone(this.__setters__));
				for (var s = 0, c = arguments.length; s < c; ++s) {
					var a,
						l = arguments[s];
					for (a in l) {
						var h,
							u,
							_,
							d = 'function' == typeof l[a],
							p = 'function' == typeof r[a],
							f = g.test(l[a]);
						if (
							(d && p && f
								? ((n.value = (function (i, n) {
										return function () {
											var t = this._super;
											this._super = r[i];
											var e = n.apply(this, arguments);
											return (this._super = t), e;
										};
								  })(a, l[a])),
								  Object.defineProperty(i, a, n))
								: d
								? ((n.value = l[a]),
								  Object.defineProperty(i, a, n))
								: (i[a] = l[a]),
							d)
						) {
							if (this.__getters__ && this.__getters__[a]) {
								for (var m in ((_ = this.__getters__[a]),
								this.__setters__))
									if (this.__setters__[m] === _) {
										u = m;
										break;
									}
								cc.defineGetterSetter(
									i,
									_,
									l[a],
									l[u] || i[u],
									a,
									u
								);
							}
							if (this.__setters__ && this.__setters__[a]) {
								for (var m in ((_ = this.__setters__[a]),
								this.__getters__))
									if (this.__getters__[m] === _) {
										h = m;
										break;
									}
								cc.defineGetterSetter(
									i,
									_,
									l[h] || i[h],
									l[a],
									h,
									a
								);
							}
						}
					}
				}
				return (
					(o.extend = cc.Class.extend),
					(o.implement = function (t) {
						for (var e in t) i[e] = t[e];
					}),
					o
				);
			});
	})(),
	(cc.defineGetterSetter = function (t, e, i, n, r, o) {
		if (t.__defineGetter__)
			i && t.__defineGetter__(e, i), n && t.__defineSetter__(e, n);
		else {
			if (!Object.defineProperty)
				throw new Error('browser does not support getters');
			var s = { enumerable: !1, configurable: !0 };
			i && (s.get = i), n && (s.set = n), Object.defineProperty(t, e, s);
		}
		if (!r && !o)
			for (
				var c = null != i,
					a = null != n,
					l = Object.getOwnPropertyNames(t),
					h = 0;
				h < l.length;
				h++
			) {
				var u = l[h];
				if (
					(t.__lookupGetter__
						? !t.__lookupGetter__(u)
						: !Object.getOwnPropertyDescriptor(t, u)) &&
					'function' == typeof t[u]
				) {
					var _ = t[u];
					if (c && _ === i && ((r = u), !a || o)) break;
					if (a && _ === n && ((o = u), !c || r)) break;
				}
			}
		s = t.constructor;
		r && (s.__getters__ || (s.__getters__ = {}), (s.__getters__[r] = e)),
			o &&
				(s.__setters__ || (s.__setters__ = {}), (s.__setters__[o] = e));
	}),
	(cc.clone = function (t) {
		var e,
			i = t.constructor ? new t.constructor() : {};
		for (e in t) {
			var n = t[e];
			'object' != typeof n ||
			!n ||
			n instanceof cc.Node ||
			n instanceof HTMLElement
				? (i[e] = n)
				: (i[e] = cc.clone(n));
		}
		return i;
	}),
	(cc.inject = function (t, e) {
		for (var i in t) e[i] = t[i];
	}),
	(cc.Point = function (t, e) {
		(this.x = t || 0), (this.y = e || 0);
	}),
	(cc.p = function (t, e) {
		return void 0 === t
			? { x: 0, y: 0 }
			: void 0 === e
			? { x: t.x, y: t.y }
			: { x: t, y: e };
	}),
	(cc.pointEqualToPoint = function (t, e) {
		return t && e && t.x === e.x && t.y === e.y;
	}),
	(cc.Size = function (t, e) {
		(this.width = t || 0), (this.height = e || 0);
	}),
	(cc.size = function (t, e) {
		return void 0 === t
			? { width: 0, height: 0 }
			: void 0 === e
			? { width: t.width, height: t.height }
			: { width: t, height: e };
	}),
	(cc.sizeEqualToSize = function (t, e) {
		return t && e && t.width === e.width && t.height === e.height;
	}),
	(cc.Rect = function (t, e, i, n) {
		(this.x = t || 0),
			(this.y = e || 0),
			(this.width = i || 0),
			(this.height = n || 0);
	}),
	(cc.rect = function (t, e, i, n) {
		return void 0 === t
			? { x: 0, y: 0, width: 0, height: 0 }
			: void 0 === e
			? { x: t.x, y: t.y, width: t.width, height: t.height }
			: { x: t, y: e, width: i, height: n };
	}),
	(cc.rectEqualToRect = function (t, e) {
		return (
			t &&
			e &&
			t.x === e.x &&
			t.y === e.y &&
			t.width === e.width &&
			t.height === e.height
		);
	}),
	(cc._rectEqualToZero = function (t) {
		return t && 0 === t.x && 0 === t.y && 0 === t.width && 0 === t.height;
	}),
	(cc.rectContainsRect = function (t, e) {
		return (
			!(!t || !e) &&
			!(
				t.x >= e.x ||
				t.y >= e.y ||
				t.x + t.width <= e.x + e.width ||
				t.y + t.height <= e.y + e.height
			)
		);
	}),
	(cc.rectGetMaxX = function (t) {
		return t.x + t.width;
	}),
	(cc.rectGetMidX = function (t) {
		return t.x + t.width / 2;
	}),
	(cc.rectGetMinX = function (t) {
		return t.x;
	}),
	(cc.rectGetMaxY = function (t) {
		return t.y + t.height;
	}),
	(cc.rectGetMidY = function (t) {
		return t.y + t.height / 2;
	}),
	(cc.rectGetMinY = function (t) {
		return t.y;
	}),
	(cc.rectContainsPoint = function (t, e) {
		return (
			e.x >= cc.rectGetMinX(t) &&
			e.x <= cc.rectGetMaxX(t) &&
			e.y >= cc.rectGetMinY(t) &&
			e.y <= cc.rectGetMaxY(t)
		);
	}),
	(cc.rectIntersectsRect = function (t, e) {
		var i = t.x + t.width,
			n = t.y + t.height,
			r = e.x + e.width,
			o = e.y + e.height;
		return !(i < e.x || r < t.x || n < e.y || o < t.y);
	}),
	(cc.rectOverlapsRect = function (t, e) {
		return !(
			t.x + t.width < e.x ||
			e.x + e.width < t.x ||
			t.y + t.height < e.y ||
			e.y + e.height < t.y
		);
	}),
	(cc.rectUnion = function (t, e) {
		var i = cc.rect(0, 0, 0, 0);
		return (
			(i.x = Math.min(t.x, e.x)),
			(i.y = Math.min(t.y, e.y)),
			(i.width = Math.max(t.x + t.width, e.x + e.width) - i.x),
			(i.height = Math.max(t.y + t.height, e.y + e.height) - i.y),
			i
		);
	}),
	(cc.rectIntersection = function (t, e) {
		var i = cc.rect(
			Math.max(cc.rectGetMinX(t), cc.rectGetMinX(e)),
			Math.max(cc.rectGetMinY(t), cc.rectGetMinY(e)),
			0,
			0
		);
		return (
			(i.width =
				Math.min(cc.rectGetMaxX(t), cc.rectGetMaxX(e)) -
				cc.rectGetMinX(i)),
			(i.height =
				Math.min(cc.rectGetMaxY(t), cc.rectGetMaxY(e)) -
				cc.rectGetMinY(i)),
			i
		);
	}),
	(cc.SAXParser = cc.Class.extend({
		_parser: null,
		_isSupportDOMParser: null,
		ctor: function () {
			window.DOMParser
				? ((this._isSupportDOMParser = !0),
				  (this._parser = new DOMParser()))
				: (this._isSupportDOMParser = !1);
		},
		parse: function (t) {
			return this._parseXML(t);
		},
		_parseXML: function (t) {
			var e;
			return (
				this._isSupportDOMParser
					? (e = this._parser.parseFromString(t, 'text/xml'))
					: (((e = new ActiveXObject('Microsoft.XMLDOM')).async =
							'false'),
					  e.loadXML(t)),
				e
			);
		},
	})),
	(cc.PlistParser = cc.SAXParser.extend({
		parse: function (t) {
			var e = this._parseXML(t).documentElement;
			if ('plist' !== e.tagName) return cc.warn('Not a plist file!'), {};
			for (
				var i = null, n = 0, r = e.childNodes.length;
				n < r && 1 !== (i = e.childNodes[n]).nodeType;
				n++
			);
			return this._parseNode(i);
		},
		_parseNode: function (t) {
			var e = null,
				i = t.tagName;
			if ('dict' === i) e = this._parseDict(t);
			else if ('array' === i) e = this._parseArray(t);
			else if ('string' === i)
				if (1 === t.childNodes.length) e = t.firstChild.nodeValue;
				else {
					e = '';
					for (var n = 0; n < t.childNodes.length; n++)
						e += t.childNodes[n].nodeValue;
				}
			else
				'false' === i
					? (e = !1)
					: 'true' === i
					? (e = !0)
					: 'real' === i
					? (e = parseFloat(t.firstChild.nodeValue))
					: 'integer' === i &&
					  (e = parseInt(t.firstChild.nodeValue, 10));
			return e;
		},
		_parseArray: function (t) {
			for (var e = [], i = 0, n = t.childNodes.length; i < n; i++) {
				var r = t.childNodes[i];
				1 === r.nodeType && e.push(this._parseNode(r));
			}
			return e;
		},
		_parseDict: function (t) {
			for (
				var e = {}, i = null, n = 0, r = t.childNodes.length;
				n < r;
				n++
			) {
				var o = t.childNodes[n];
				1 === o.nodeType &&
					('key' === o.tagName
						? (i = o.firstChild.nodeValue)
						: (e[i] = this._parseNode(o)));
			}
			return e;
		},
	})),
	(cc.saxParser = new cc.SAXParser()),
	(cc.plistParser = new cc.PlistParser()),
	(cc._txtLoader = {
		load: function (t, e, i, n) {
			cc.loader.loadTxt(t, n);
		},
	}),
	cc.loader.register(['txt', 'xml', 'vsh', 'fsh', 'atlas'], cc._txtLoader),
	(cc._jsonLoader = {
		load: function (t, e, i, n) {
			cc.loader.loadJson(t, n);
		},
	}),
	cc.loader.register(['json', 'ExportJson'], cc._jsonLoader),
	(cc._jsLoader = {
		load: function (t, e, i, n) {
			cc.loader.loadJs(t, n);
		},
	}),
	cc.loader.register(['js'], cc._jsLoader),
	(cc._imgLoader = {
		load: function (t, i, e, n) {
			var r = cc.loader.isLoading(t)
				? n
				: function (t, e) {
						if (t) return n(t);
						(cc.loader.cache[i] = e),
							cc.textureCache.handleLoadedTexture(i),
							n(null, e);
				  };
			cc.loader.loadImg(t, r);
		},
	}),
	cc.loader.register(
		['png', 'jpg', 'bmp', 'jpeg', 'gif', 'ico', 'tiff', 'webp'],
		cc._imgLoader
	),
	(cc._serverImgLoader = {
		load: function (t, e, i, n) {
			cc._imgLoader.load(i.src, e, i, n);
		},
	}),
	cc.loader.register(['serverImg'], cc._serverImgLoader),
	(cc._plistLoader = {
		load: function (t, e, i, n) {
			cc.loader.loadTxt(t, function (t, e) {
				return t ? n(t) : void n(null, cc.plistParser.parse(e));
			});
		},
	}),
	cc.loader.register(['plist'], cc._plistLoader),
	(cc._fontLoader = {
		TYPE: {
			'.eot': 'embedded-opentype',
			'.ttf': 'truetype',
			'.ttc': 'truetype',
			'.woff': 'woff',
			'.svg': 'svg',
		},
		_loadFont: function (t, e, i) {
			var n = document,
				r = cc.path,
				o = this.TYPE,
				s = document.createElement('style');
			(s.type = 'text/css'), n.body.appendChild(s);
			var c = '';
			if (
				(isNaN(+t)
					? (c += '@font-face { font-family:' + t + '; src:')
					: (c += "@font-face { font-family:'" + t + "'; src:"),
				e instanceof Array)
			)
				for (var a = 0, l = e.length; a < l; a++) {
					var h = e[a];
					(i = r.extname(h).toLowerCase()),
						(c += "url('" + e[a] + "') format('" + o[i] + "')"),
						(c += a === l - 1 ? ';' : ',');
				}
			else
				c +=
					"url('" +
					e +
					"') format('" +
					o[(i = i.toLowerCase())] +
					"');";
			s.textContent += c + '}';
			var u = document.createElement('div'),
				s = u.style;
			(s.fontFamily = t),
				(u.innerHTML = '.'),
				(s.position = 'absolute'),
				(s.left = '-100px'),
				(s.top = '-100px'),
				n.body.appendChild(u);
		},
		load: function (t, e, i, n) {
			var r = i.type,
				o = i.name,
				s = i.srcs;
			cc.isString(i)
				? ((r = cc.path.extname(i)),
				  (o = cc.path.basename(i, r)),
				  this._loadFont(o, i, r))
				: this._loadFont(o, s),
				document.fonts
					? document.fonts.load('1em ' + o).then(
							function () {
								n(null, !0);
							},
							function (t) {
								n(t);
							}
					  )
					: n(null, !0);
		},
	}),
	cc.loader.register(
		['font', 'eot', 'ttf', 'woff', 'svg', 'ttc'],
		cc._fontLoader
	),
	(cc._binaryLoader = {
		load: function (t, e, i, n) {
			cc.loader.loadBinary(t, n);
		},
	}),
	(cc._csbLoader = {
		load: function (t, e, i, n) {
			cc.loader.loadCsb(t, n);
		},
	}),
	cc.loader.register(['csb'], cc._csbLoader),
	(window.CocosEngine = cc.ENGINE_VERSION = 'Cocos2d-JS v3.13'),
	(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL = 0),
	(cc.DIRECTOR_STATS_POSITION = cc.p(0, 0)),
	(cc.DIRECTOR_FPS_INTERVAL = 0.5),
	(cc.COCOSNODE_RENDER_SUBPIXEL = 1),
	(cc.SPRITEBATCHNODE_RENDER_SUBPIXEL = 1),
	(cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA = 1),
	(cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP = 0),
	(cc.TEXTURE_ATLAS_USE_VAO = 0),
	(cc.TEXTURE_NPOT_SUPPORT = 0),
	(cc.RETINA_DISPLAY_SUPPORT = 1),
	(cc.RETINA_DISPLAY_FILENAME_SUFFIX = '-hd'),
	(cc.USE_LA88_LABELS = 1),
	(cc.SPRITE_DEBUG_DRAW = 0),
	(cc.SPRITEBATCHNODE_DEBUG_DRAW = 0),
	(cc.LABELBMFONT_DEBUG_DRAW = 0),
	(cc.LABELATLAS_DEBUG_DRAW = 0),
	(cc.IS_RETINA_DISPLAY_SUPPORTED = 1),
	(cc.DEFAULT_ENGINE = cc.ENGINE_VERSION + '-canvas'),
	(cc.ENABLE_STACKABLE_ACTIONS = 1),
	(cc.ENABLE_GL_STATE_CACHE = 1),
	(cc.$ = function (t) {
		var e = this === cc ? document : this,
			t = t instanceof HTMLElement ? t : e.querySelector(t);
		return (
			t &&
				((t.find = t.find || cc.$),
				(t.hasClass =
					t.hasClass ||
					function (t) {
						return this.className.match(
							new RegExp('(\\s|^)' + t + '(\\s|$)')
						);
					}),
				(t.addClass =
					t.addClass ||
					function (t) {
						return (
							this.hasClass(t) ||
								(this.className && (this.className += ' '),
								(this.className += t)),
							this
						);
					}),
				(t.removeClass =
					t.removeClass ||
					function (t) {
						return (
							this.hasClass(t) &&
								(this.className = this.className.replace(
									t,
									''
								)),
							this
						);
					}),
				(t.remove =
					t.remove ||
					function () {
						return (
							this.parentNode &&
								this.parentNode.removeChild(this),
							this
						);
					}),
				(t.appendTo =
					t.appendTo ||
					function (t) {
						return t.appendChild(this), this;
					}),
				(t.prependTo =
					t.prependTo ||
					function (t) {
						return (
							t.childNodes[0]
								? t.insertBefore(this, t.childNodes[0])
								: t.appendChild(this),
							this
						);
					}),
				(t.transforms =
					t.transforms ||
					function () {
						return (
							(this.style[cc.$.trans] =
								cc.$.translate(this.position) +
								cc.$.rotate(this.rotation) +
								cc.$.scale(this.scale) +
								cc.$.skew(this.skew)),
							this
						);
					}),
				(t.position = t.position || { x: 0, y: 0 }),
				(t.rotation = t.rotation || 0),
				(t.scale = t.scale || { x: 1, y: 1 }),
				(t.skew = t.skew || { x: 0, y: 0 }),
				(t.translates = function (t, e) {
					return (
						(this.position.x = t),
						(this.position.y = e),
						this.transforms(),
						this
					);
				}),
				(t.rotate = function (t) {
					return (this.rotation = t), this.transforms(), this;
				}),
				(t.resize = function (t, e) {
					return (
						(this.scale.x = t),
						(this.scale.y = e),
						this.transforms(),
						this
					);
				}),
				(t.setSkew = function (t, e) {
					return (
						(this.skew.x = t),
						(this.skew.y = e),
						this.transforms(),
						this
					);
				})),
			t
		);
	}),
	cc.sys.browserType)
) {
	case cc.sys.BROWSER_TYPE_FIREFOX:
		(cc.$.pfx = 'Moz'), (cc.$.hd = !0);
		break;
	case cc.sys.BROWSER_TYPE_CHROME:
	case cc.sys.BROWSER_TYPE_SAFARI:
		(cc.$.pfx = 'webkit'), (cc.$.hd = !0);
		break;
	case cc.sys.BROWSER_TYPE_OPERA:
		(cc.$.pfx = 'O'), (cc.$.hd = !1);
		break;
	case cc.sys.BROWSER_TYPE_IE:
		(cc.$.pfx = 'ms'), (cc.$.hd = !1);
		break;
	default:
		(cc.$.pfx = 'webkit'), (cc.$.hd = !0);
}
(cc.$.trans = cc.$.pfx + 'Transform'),
	(cc.$.translate = cc.$.hd
		? function (t) {
				return 'translate3d(' + t.x + 'px, ' + t.y + 'px, 0) ';
		  }
		: function (t) {
				return 'translate(' + t.x + 'px, ' + t.y + 'px) ';
		  }),
	(cc.$.rotate = cc.$.hd
		? function (t) {
				return 'rotateZ(' + t + 'deg) ';
		  }
		: function (t) {
				return 'rotate(' + t + 'deg) ';
		  }),
	(cc.$.scale = function (t) {
		return 'scale(' + t.x + ', ' + t.y + ') ';
	}),
	(cc.$.skew = function (t) {
		return 'skewX(' + -t.x + 'deg) skewY(' + t.y + 'deg)';
	}),
	(cc.$new = function (t) {
		return cc.$(document.createElement(t));
	}),
	(cc.$.findpos = function (t) {
		for (
			var e = 0, i = 0;
			(e += t.offsetLeft), (i += t.offsetTop), (t = t.offsetParent);

		);
		return { x: e, y: i };
	}),
	(cc.INVALID_INDEX = -1),
	(cc.PI = Math.PI),
	(cc.FLT_MAX = parseFloat('3.402823466e+38F')),
	(cc.FLT_MIN = parseFloat('1.175494351e-38F')),
	(cc.RAD = cc.PI / 180),
	(cc.DEG = 180 / cc.PI),
	(cc.UINT_MAX = 4294967295),
	(cc.swap = function (t, e, i) {
		var n;
		!cc.isObject(i) || cc.isUndefined(i.x) || cc.isUndefined(i.y)
			? cc.log(cc._LogInfos.swap)
			: ((n = i[t]), (i[t] = i[e]), (i[e] = n));
	}),
	(cc.lerp = function (t, e, i) {
		return t + (e - t) * i;
	}),
	(cc.rand = function () {
		return 16777215 * Math.random();
	}),
	(cc.randomMinus1To1 = function () {
		return 2 * (Math.random() - 0.5);
	}),
	(cc.random0To1 = Math.random),
	(cc.degreesToRadians = function (t) {
		return t * cc.RAD;
	}),
	(cc.radiansToDegrees = function (t) {
		return t * cc.DEG;
	}),
	(cc.radiansToDegress = function (t) {
		return cc.log(cc._LogInfos.radiansToDegress), t * cc.DEG;
	}),
	(cc.REPEAT_FOREVER = Number.MAX_VALUE - 1),
	(cc.nodeDrawSetup = function (t) {
		t._shaderProgram &&
			(t._shaderProgram.use(),
			t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4());
	}),
	(cc.enableDefaultGLStates = function () {}),
	(cc.disableDefaultGLStates = function () {}),
	(cc.incrementGLDraws = function (t) {
		cc.g_NumberOfDraws += t;
	}),
	(cc.FLT_EPSILON = 1.192092896e-7),
	(cc.contentScaleFactor = cc.IS_RETINA_DISPLAY_SUPPORTED
		? function () {
				return cc.director.getContentScaleFactor();
		  }
		: function () {
				return 1;
		  }),
	(cc.pointPointsToPixels = function (t) {
		var e = cc.contentScaleFactor();
		return cc.p(t.x * e, t.y * e);
	}),
	(cc.pointPixelsToPoints = function (t) {
		var e = cc.contentScaleFactor();
		return cc.p(t.x / e, t.y / e);
	}),
	(cc._pointPixelsToPointsOut = function (t, e) {
		var i = cc.contentScaleFactor();
		(e.x = t.x / i), (e.y = t.y / i);
	}),
	(cc.sizePointsToPixels = function (t) {
		var e = cc.contentScaleFactor();
		return cc.size(t.width * e, t.height * e);
	}),
	(cc.sizePixelsToPoints = function (t) {
		var e = cc.contentScaleFactor();
		return cc.size(t.width / e, t.height / e);
	}),
	(cc._sizePixelsToPointsOut = function (t, e) {
		var i = cc.contentScaleFactor();
		(e.width = t.width / i), (e.height = t.height / i);
	}),
	(cc.rectPixelsToPoints = cc.IS_RETINA_DISPLAY_SUPPORTED
		? function (t) {
				var e = cc.contentScaleFactor();
				return cc.rect(t.x / e, t.y / e, t.width / e, t.height / e);
		  }
		: function (t) {
				return t;
		  }),
	(cc.rectPointsToPixels = cc.IS_RETINA_DISPLAY_SUPPORTED
		? function (t) {
				var e = cc.contentScaleFactor();
				return cc.rect(t.x * e, t.y * e, t.width * e, t.height * e);
		  }
		: function (t) {
				return t;
		  }),
	(cc.ONE = 1),
	(cc.ZERO = 0),
	(cc.SRC_ALPHA = 770),
	(cc.SRC_ALPHA_SATURATE = 776),
	(cc.SRC_COLOR = 768),
	(cc.DST_ALPHA = 772),
	(cc.DST_COLOR = 774),
	(cc.ONE_MINUS_SRC_ALPHA = 771),
	(cc.ONE_MINUS_SRC_COLOR = 769),
	(cc.ONE_MINUS_DST_ALPHA = 773),
	(cc.ONE_MINUS_DST_COLOR = 775),
	(cc.ONE_MINUS_CONSTANT_ALPHA = 32772),
	(cc.ONE_MINUS_CONSTANT_COLOR = 32770),
	(cc.LINEAR = 9729),
	(cc.REPEAT = 10497),
	(cc.CLAMP_TO_EDGE = 33071),
	(cc.MIRRORED_REPEAT = 33648),
	(cc.BLEND_SRC = cc.SRC_ALPHA),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA &&
			(cc.BLEND_SRC = cc.ONE);
	}),
	(cc.BLEND_DST = cc.ONE_MINUS_SRC_ALPHA),
	(cc.checkGLErrorDebug = function () {
		var t;
		cc.renderMode !== cc.game.RENDER_TYPE_WEBGL ||
			((t = cc._renderContext.getError()) &&
				cc.log(cc._LogInfos.checkGLErrorDebug, t));
	}),
	(cc.ORIENTATION_PORTRAIT = 1),
	(cc.ORIENTATION_LANDSCAPE = 2),
	(cc.ORIENTATION_AUTO = 3),
	(cc.VERTEX_ATTRIB_FLAG_NONE = 0),
	(cc.VERTEX_ATTRIB_FLAG_POSITION = 1),
	(cc.VERTEX_ATTRIB_FLAG_COLOR = 2),
	(cc.VERTEX_ATTRIB_FLAG_TEX_COORDS = 4),
	(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX =
		cc.VERTEX_ATTRIB_FLAG_POSITION |
		cc.VERTEX_ATTRIB_FLAG_COLOR |
		cc.VERTEX_ATTRIB_FLAG_TEX_COORDS),
	(cc.GL_ALL = 0),
	(cc.VERTEX_ATTRIB_POSITION = 0),
	(cc.VERTEX_ATTRIB_COLOR = 1),
	(cc.VERTEX_ATTRIB_TEX_COORDS = 2),
	(cc.VERTEX_ATTRIB_MAX = 7),
	(cc.UNIFORM_PMATRIX = 0),
	(cc.UNIFORM_MVMATRIX = 1),
	(cc.UNIFORM_MVPMATRIX = 2),
	(cc.UNIFORM_TIME = 3),
	(cc.UNIFORM_SINTIME = 4),
	(cc.UNIFORM_COSTIME = 5),
	(cc.UNIFORM_RANDOM01 = 6),
	(cc.UNIFORM_SAMPLER = 7),
	(cc.UNIFORM_MAX = 8),
	(cc.SHADER_POSITION_TEXTURECOLOR = 'ShaderPositionTextureColor'),
	(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR =
		'ShaderSpritePositionTextureColor'),
	(cc.SHADER_POSITION_TEXTURECOLORALPHATEST =
		'ShaderPositionTextureColorAlphaTest'),
	(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST =
		'ShaderSpritePositionTextureColorAlphaTest'),
	(cc.SHADER_POSITION_COLOR = 'ShaderPositionColor'),
	(cc.SHADER_SPRITE_POSITION_COLOR = 'ShaderSpritePositionColor'),
	(cc.SHADER_POSITION_TEXTURE = 'ShaderPositionTexture'),
	(cc.SHADER_POSITION_TEXTURE_UCOLOR = 'ShaderPositionTexture_uColor'),
	(cc.SHADER_POSITION_TEXTUREA8COLOR = 'ShaderPositionTextureA8Color'),
	(cc.SHADER_POSITION_UCOLOR = 'ShaderPosition_uColor'),
	(cc.SHADER_POSITION_LENGTHTEXTURECOLOR =
		'ShaderPositionLengthTextureColor'),
	(cc.UNIFORM_PMATRIX_S = 'CC_PMatrix'),
	(cc.UNIFORM_MVMATRIX_S = 'CC_MVMatrix'),
	(cc.UNIFORM_MVPMATRIX_S = 'CC_MVPMatrix'),
	(cc.UNIFORM_TIME_S = 'CC_Time'),
	(cc.UNIFORM_SINTIME_S = 'CC_SinTime'),
	(cc.UNIFORM_COSTIME_S = 'CC_CosTime'),
	(cc.UNIFORM_RANDOM01_S = 'CC_Random01'),
	(cc.UNIFORM_SAMPLER_S = 'CC_Texture0'),
	(cc.UNIFORM_ALPHA_TEST_VALUE_S = 'CC_alpha_value'),
	(cc.ATTRIBUTE_NAME_COLOR = 'a_color'),
	(cc.ATTRIBUTE_NAME_POSITION = 'a_position'),
	(cc.ATTRIBUTE_NAME_TEX_COORD = 'a_texCoord'),
	(cc.ATTRIBUTE_NAME_MVMAT = 'a_mvMatrix'),
	(cc.ITEM_SIZE = 32),
	(cc.CURRENT_ITEM = 3233828865),
	(cc.ZOOM_ACTION_TAG = 3233828866),
	(cc.NORMAL_TAG = 8801),
	(cc.SELECTED_TAG = 8802),
	(cc.DISABLE_TAG = 8803),
	(cc.arrayVerifyType = function (t, e) {
		if (t && 0 < t.length)
			for (var i = 0; i < t.length; i++)
				if (!(t[i] instanceof e))
					return cc.log('element type is wrong!'), !1;
		return !0;
	}),
	(cc.arrayRemoveObject = function (t, e) {
		for (var i = 0, n = t.length; i < n; i++)
			if (t[i] === e) {
				t.splice(i, 1);
				break;
			}
	}),
	(cc.arrayRemoveArray = function (t, e) {
		for (var i = 0, n = e.length; i < n; i++) cc.arrayRemoveObject(t, e[i]);
	}),
	(cc.arrayAppendObjectsToIndex = function (t, e, i) {
		return t.splice.apply(t, [i, 0].concat(e)), t;
	}),
	(cc.copyArray = function (t) {
		for (var e = t.length, i = new Array(e), n = 0; n < e; n += 1)
			i[n] = t[n];
		return i;
	}),
	(cc._tmp.PrototypeColor = function () {
		var t = cc.color;
		(t._getWhite = function () {
			return t(255, 255, 255);
		}),
			(t._getYellow = function () {
				return t(255, 255, 0);
			}),
			(t._getBlue = function () {
				return t(0, 0, 255);
			}),
			(t._getGreen = function () {
				return t(0, 255, 0);
			}),
			(t._getRed = function () {
				return t(255, 0, 0);
			}),
			(t._getMagenta = function () {
				return t(255, 0, 255);
			}),
			(t._getBlack = function () {
				return t(0, 0, 0);
			}),
			(t._getOrange = function () {
				return t(255, 127, 0);
			}),
			(t._getGray = function () {
				return t(166, 166, 166);
			}),
			t.WHITE,
			cc.defineGetterSetter(t, 'WHITE', t._getWhite),
			t.YELLOW,
			cc.defineGetterSetter(t, 'YELLOW', t._getYellow),
			t.BLUE,
			cc.defineGetterSetter(t, 'BLUE', t._getBlue),
			t.GREEN,
			cc.defineGetterSetter(t, 'GREEN', t._getGreen),
			t.RED,
			cc.defineGetterSetter(t, 'RED', t._getRed),
			t.MAGENTA,
			cc.defineGetterSetter(t, 'MAGENTA', t._getMagenta),
			t.BLACK,
			cc.defineGetterSetter(t, 'BLACK', t._getBlack),
			t.ORANGE,
			cc.defineGetterSetter(t, 'ORANGE', t._getOrange),
			t.GRAY,
			cc.defineGetterSetter(t, 'GRAY', t._getGray),
			(cc.BlendFunc._disable = function () {
				return new cc.BlendFunc(cc.ONE, cc.ZERO);
			}),
			(cc.BlendFunc._alphaPremultiplied = function () {
				return new cc.BlendFunc(cc.ONE, cc.ONE_MINUS_SRC_ALPHA);
			}),
			(cc.BlendFunc._alphaNonPremultiplied = function () {
				return new cc.BlendFunc(cc.SRC_ALPHA, cc.ONE_MINUS_SRC_ALPHA);
			}),
			(cc.BlendFunc._additive = function () {
				return new cc.BlendFunc(cc.SRC_ALPHA, cc.ONE);
			}),
			cc.BlendFunc.DISABLE,
			cc.defineGetterSetter(
				cc.BlendFunc,
				'DISABLE',
				cc.BlendFunc._disable
			),
			cc.BlendFunc.ALPHA_PREMULTIPLIED,
			cc.defineGetterSetter(
				cc.BlendFunc,
				'ALPHA_PREMULTIPLIED',
				cc.BlendFunc._alphaPremultiplied
			),
			cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,
			cc.defineGetterSetter(
				cc.BlendFunc,
				'ALPHA_NON_PREMULTIPLIED',
				cc.BlendFunc._alphaNonPremultiplied
			),
			cc.BlendFunc.ADDITIVE,
			cc.defineGetterSetter(
				cc.BlendFunc,
				'ADDITIVE',
				cc.BlendFunc._additive
			);
	});
var cc = cc || {};
(cc._tmp = cc._tmp || {}),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		var t;
		cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			((cc.color = function (t, e, i, n, r, o) {
				if (void 0 === t) return new cc.Color(0, 0, 0, 255, r, o);
				if (cc.isString(t)) {
					var s = cc.hexToColor(t);
					return new cc.Color(s.r, s.g, s.b, s.a);
				}
				return cc.isObject(t)
					? new cc.Color(t.r, t.g, t.b, t.a, t.arrayBuffer, t.offset)
					: new cc.Color(t, e, i, n, r, o);
			}),
			(cc.Color = function (t, e, i, n, r, o) {
				(this._arrayBuffer =
					r || new ArrayBuffer(cc.Color.BYTES_PER_ELEMENT)),
					(this._offset = o || 0);
				(r = this._arrayBuffer), (o = this._offset);
				(this._view = new Uint8Array(r, o, 4)),
					(this._view[0] = t || 0),
					(this._view[1] = e || 0),
					(this._view[2] = i || 0),
					(this._view[3] = null == n ? 255 : n),
					void 0 === n && (this.a_undefined = !0);
			}),
			(cc.Color.BYTES_PER_ELEMENT = 4),
			((t = cc.Color.prototype)._getR = function () {
				return this._view[0];
			}),
			(t._setR = function (t) {
				this._view[0] = t < 0 ? 0 : t;
			}),
			(t._getG = function () {
				return this._view[1];
			}),
			(t._setG = function (t) {
				this._view[1] = t < 0 ? 0 : t;
			}),
			(t._getB = function () {
				return this._view[2];
			}),
			(t._setB = function (t) {
				this._view[2] = t < 0 ? 0 : t;
			}),
			(t._getA = function () {
				return this._view[3];
			}),
			(t._setA = function (t) {
				this._view[3] = t < 0 ? 0 : t;
			}),
			t.r,
			cc.defineGetterSetter(t, 'r', t._getR, t._setR),
			t.g,
			cc.defineGetterSetter(t, 'g', t._getG, t._setG),
			t.b,
			cc.defineGetterSetter(t, 'b', t._getB, t._setB),
			t.a,
			cc.defineGetterSetter(t, 'a', t._getA, t._setA),
			cc.assert(
				cc.isFunction(cc._tmp.PrototypeColor),
				cc._LogInfos.MissingFile,
				'CCTypesPropertyDefine.js'
			),
			cc._tmp.PrototypeColor(),
			delete cc._tmp.PrototypeColor);
	}),
	(cc.Color = function (t, e, i, n) {
		(this.r = t || 0),
			(this.g = e || 0),
			(this.b = i || 0),
			(this.a = null == n ? 255 : n);
	}),
	(cc.color = function (t, e, i, n) {
		return void 0 === t
			? { r: 0, g: 0, b: 0, a: 255 }
			: cc.isString(t)
			? cc.hexToColor(t)
			: cc.isObject(t)
			? { r: t.r, g: t.g, b: t.b, a: null == t.a ? 255 : t.a }
			: { r: t, g: e, b: i, a: null == n ? 255 : n };
	}),
	(cc.colorEqual = function (t, e) {
		return t.r === e.r && t.g === e.g && t.b === e.b;
	}),
	(cc.Acceleration = function (t, e, i, n) {
		(this.x = t || 0),
			(this.y = e || 0),
			(this.z = i || 0),
			(this.timestamp = n || 0);
	}),
	(cc.Vertex2F = function (t, e, i, n) {
		(this._arrayBuffer =
			i || new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT)),
			(this._offset = n || 0),
			(this._view = new Float32Array(this._arrayBuffer, this._offset, 2)),
			(this._view[0] = t || 0),
			(this._view[1] = e || 0);
	}),
	(cc.Vertex2F.BYTES_PER_ELEMENT = 8),
	(_p = cc.Vertex2F.prototype),
	(_p._getX = function () {
		return this._view[0];
	}),
	(_p._setX = function (t) {
		this._view[0] = t;
	}),
	(_p._getY = function () {
		return this._view[1];
	}),
	(_p._setY = function (t) {
		this._view[1] = t;
	}),
	_p.x,
	cc.defineGetterSetter(_p, 'x', _p._getX, _p._setX),
	_p.y,
	cc.defineGetterSetter(_p, 'y', _p._getY, _p._setY),
	(cc.Vertex3F = function (t, e, i, n, r) {
		(this._arrayBuffer =
			n || new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT)),
			(this._offset = r || 0);
		(n = this._arrayBuffer), (r = this._offset);
		(this._view = new Float32Array(n, r, 3)),
			(this._view[0] = t || 0),
			(this._view[1] = e || 0),
			(this._view[2] = i || 0);
	}),
	(cc.Vertex3F.BYTES_PER_ELEMENT = 12),
	(_p = cc.Vertex3F.prototype),
	(_p._getX = function () {
		return this._view[0];
	}),
	(_p._setX = function (t) {
		this._view[0] = t;
	}),
	(_p._getY = function () {
		return this._view[1];
	}),
	(_p._setY = function (t) {
		this._view[1] = t;
	}),
	(_p._getZ = function () {
		return this._view[2];
	}),
	(_p._setZ = function (t) {
		this._view[2] = t;
	}),
	_p.x,
	cc.defineGetterSetter(_p, 'x', _p._getX, _p._setX),
	_p.y,
	cc.defineGetterSetter(_p, 'y', _p._getY, _p._setY),
	_p.z,
	cc.defineGetterSetter(_p, 'z', _p._getZ, _p._setZ),
	(cc.Tex2F = function (t, e, i, n) {
		(this._arrayBuffer = i || new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT)),
			(this._offset = n || 0),
			(this._view = new Float32Array(this._arrayBuffer, this._offset, 2)),
			(this._view[0] = t || 0),
			(this._view[1] = e || 0);
	}),
	(cc.Tex2F.BYTES_PER_ELEMENT = 8),
	(_p = cc.Tex2F.prototype),
	(_p._getU = function () {
		return this._view[0];
	}),
	(_p._setU = function (t) {
		this._view[0] = t;
	}),
	(_p._getV = function () {
		return this._view[1];
	}),
	(_p._setV = function (t) {
		this._view[1] = t;
	}),
	_p.u,
	cc.defineGetterSetter(_p, 'u', _p._getU, _p._setU),
	_p.v,
	cc.defineGetterSetter(_p, 'v', _p._getV, _p._setV),
	(cc.Quad2 = function (t, e, i, n, r, o) {
		(this._arrayBuffer = r || new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT)),
			(this._offset = o || 0);
		var s = this._arrayBuffer,
			r = this._offset,
			o = cc.Vertex2F.BYTES_PER_ELEMENT;
		(this._tl = t
			? new cc.Vertex2F(t.x, t.y, s, r)
			: new cc.Vertex2F(0, 0, s, r)),
			(r += o),
			(this._tr = e
				? new cc.Vertex2F(e.x, e.y, s, r)
				: new cc.Vertex2F(0, 0, s, r)),
			(r += o),
			(this._bl = i
				? new cc.Vertex2F(i.x, i.y, s, r)
				: new cc.Vertex2F(0, 0, s, r)),
			(r += o),
			(this._br = n
				? new cc.Vertex2F(n.x, n.y, s, r)
				: new cc.Vertex2F(0, 0, s, r));
	}),
	(cc.Quad2.BYTES_PER_ELEMENT = 32),
	(_p = cc.Quad2.prototype),
	(_p._getTL = function () {
		return this._tl;
	}),
	(_p._setTL = function (t) {
		(this._tl._view[0] = t.x), (this._tl._view[1] = t.y);
	}),
	(_p._getTR = function () {
		return this._tr;
	}),
	(_p._setTR = function (t) {
		(this._tr._view[0] = t.x), (this._tr._view[1] = t.y);
	}),
	(_p._getBL = function () {
		return this._bl;
	}),
	(_p._setBL = function (t) {
		(this._bl._view[0] = t.x), (this._bl._view[1] = t.y);
	}),
	(_p._getBR = function () {
		return this._br;
	}),
	(_p._setBR = function (t) {
		(this._br._view[0] = t.x), (this._br._view[1] = t.y);
	}),
	_p.tl,
	cc.defineGetterSetter(_p, 'tl', _p._getTL, _p._setTL),
	_p.tr,
	cc.defineGetterSetter(_p, 'tr', _p._getTR, _p._setTR),
	_p.bl,
	cc.defineGetterSetter(_p, 'bl', _p._getBL, _p._setBL),
	_p.br,
	cc.defineGetterSetter(_p, 'br', _p._getBR, _p._setBR),
	(cc.Quad3 = function (t, e, i, n, r, o) {
		(this._arrayBuffer = r || new ArrayBuffer(cc.Quad3.BYTES_PER_ELEMENT)),
			(this._offset = o || 0);
		var s = this._arrayBuffer,
			r = this._offset,
			o = cc.Vertex3F.BYTES_PER_ELEMENT;
		(this.bl = t
			? new cc.Vertex3F(t.x, t.y, t.z, s, r)
			: new cc.Vertex3F(0, 0, 0, s, r)),
			(r += o),
			(this.br = e
				? new cc.Vertex3F(e.x, e.y, e.z, s, r)
				: new cc.Vertex3F(0, 0, 0, s, r)),
			(r += o),
			(this.tl = i
				? new cc.Vertex3F(i.x, i.y, i.z, s, r)
				: new cc.Vertex3F(0, 0, 0, s, r)),
			(r += o),
			(this.tr = n
				? new cc.Vertex3F(n.x, n.y, n.z, s, r)
				: new cc.Vertex3F(0, 0, 0, s, r));
	}),
	(cc.Quad3.BYTES_PER_ELEMENT = 48),
	(cc.V3F_C4B_T2F = function (t, e, i, n, r) {
		(this._arrayBuffer =
			n || new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT)),
			(this._offset = r || 0);
		(n = this._arrayBuffer), (r = this._offset);
		(this._vertices = t
			? new cc.Vertex3F(t.x, t.y, t.z, n, r)
			: new cc.Vertex3F(0, 0, 0, n, r)),
			(r += cc.Vertex3F.BYTES_PER_ELEMENT),
			(this._colors = e
				? new cc.Color(e.r, e.g, e.b, e.a, n, r)
				: new cc.Color(0, 0, 0, 0, n, r)),
			(r += cc.Color.BYTES_PER_ELEMENT),
			(this._texCoords = i
				? new cc.Tex2F(i.u, i.v, n, r)
				: new cc.Tex2F(0, 0, n, r));
	}),
	(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT = 24),
	(_p = cc.V3F_C4B_T2F.prototype),
	(_p._getVertices = function () {
		return this._vertices;
	}),
	(_p._setVertices = function (t) {
		var e = this._vertices;
		(e._view[0] = t.x), (e._view[1] = t.y), (e._view[2] = t.z);
	}),
	(_p._getColor = function () {
		return this._colors;
	}),
	(_p._setColor = function (t) {
		var e = this._colors;
		(e._view[0] = t.r),
			(e._view[1] = t.g),
			(e._view[2] = t.b),
			(e._view[3] = t.a);
	}),
	(_p._getTexCoords = function () {
		return this._texCoords;
	}),
	(_p._setTexCoords = function (t) {
		(this._texCoords._view[0] = t.u), (this._texCoords._view[1] = t.v);
	}),
	_p.vertices,
	cc.defineGetterSetter(_p, 'vertices', _p._getVertices, _p._setVertices),
	_p.colors,
	cc.defineGetterSetter(_p, 'colors', _p._getColor, _p._setColor),
	_p.texCoords,
	cc.defineGetterSetter(_p, 'texCoords', _p._getTexCoords, _p._setTexCoords),
	(cc.V3F_C4B_T2F_Quad = function (t, e, i, n, r, o) {
		(this._arrayBuffer =
			r || new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)),
			(this._offset = o || 0);
		var s = this._arrayBuffer,
			r = this._offset,
			o = cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;
		(this._tl = t
			? new cc.V3F_C4B_T2F(t.vertices, t.colors, t.texCoords, s, r)
			: new cc.V3F_C4B_T2F(null, null, null, s, r)),
			(r += o),
			(this._bl = e
				? new cc.V3F_C4B_T2F(e.vertices, e.colors, e.texCoords, s, r)
				: new cc.V3F_C4B_T2F(null, null, null, s, r)),
			(r += o),
			(this._tr = i
				? new cc.V3F_C4B_T2F(i.vertices, i.colors, i.texCoords, s, r)
				: new cc.V3F_C4B_T2F(null, null, null, s, r)),
			(r += o),
			(this._br = n
				? new cc.V3F_C4B_T2F(n.vertices, n.colors, n.texCoords, s, r)
				: new cc.V3F_C4B_T2F(null, null, null, s, r));
	}),
	(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT = 96),
	(_p = cc.V3F_C4B_T2F_Quad.prototype),
	(_p._getTL = function () {
		return this._tl;
	}),
	(_p._setTL = function (t) {
		var e = this._tl;
		(e.vertices = t.vertices),
			(e.colors = t.colors),
			(e.texCoords = t.texCoords);
	}),
	(_p._getBL = function () {
		return this._bl;
	}),
	(_p._setBL = function (t) {
		var e = this._bl;
		(e.vertices = t.vertices),
			(e.colors = t.colors),
			(e.texCoords = t.texCoords);
	}),
	(_p._getTR = function () {
		return this._tr;
	}),
	(_p._setTR = function (t) {
		var e = this._tr;
		(e.vertices = t.vertices),
			(e.colors = t.colors),
			(e.texCoords = t.texCoords);
	}),
	(_p._getBR = function () {
		return this._br;
	}),
	(_p._setBR = function (t) {
		var e = this._br;
		(e.vertices = t.vertices),
			(e.colors = t.colors),
			(e.texCoords = t.texCoords);
	}),
	(_p._getArrayBuffer = function () {
		return this._arrayBuffer;
	}),
	_p.tl,
	cc.defineGetterSetter(_p, 'tl', _p._getTL, _p._setTL),
	_p.tr,
	cc.defineGetterSetter(_p, 'tr', _p._getTR, _p._setTR),
	_p.bl,
	cc.defineGetterSetter(_p, 'bl', _p._getBL, _p._setBL),
	_p.br,
	cc.defineGetterSetter(_p, 'br', _p._getBR, _p._setBR),
	_p.arrayBuffer,
	cc.defineGetterSetter(_p, 'arrayBuffer', _p._getArrayBuffer, null),
	(cc.V3F_C4B_T2F_QuadZero = function () {
		return new cc.V3F_C4B_T2F_Quad();
	}),
	(cc.V3F_C4B_T2F_QuadCopy = function (t) {
		if (!t) return cc.V3F_C4B_T2F_QuadZero();
		var e = t.tl,
			i = t.bl,
			n = t.tr,
			t = t.br;
		return {
			tl: {
				vertices: { x: e.vertices.x, y: e.vertices.y, z: e.vertices.z },
				colors: {
					r: e.colors.r,
					g: e.colors.g,
					b: e.colors.b,
					a: e.colors.a,
				},
				texCoords: { u: e.texCoords.u, v: e.texCoords.v },
			},
			bl: {
				vertices: { x: i.vertices.x, y: i.vertices.y, z: i.vertices.z },
				colors: {
					r: i.colors.r,
					g: i.colors.g,
					b: i.colors.b,
					a: i.colors.a,
				},
				texCoords: { u: i.texCoords.u, v: i.texCoords.v },
			},
			tr: {
				vertices: { x: n.vertices.x, y: n.vertices.y, z: n.vertices.z },
				colors: {
					r: n.colors.r,
					g: n.colors.g,
					b: n.colors.b,
					a: n.colors.a,
				},
				texCoords: { u: n.texCoords.u, v: n.texCoords.v },
			},
			br: {
				vertices: { x: t.vertices.x, y: t.vertices.y, z: t.vertices.z },
				colors: {
					r: t.colors.r,
					g: t.colors.g,
					b: t.colors.b,
					a: t.colors.a,
				},
				texCoords: { u: t.texCoords.u, v: t.texCoords.v },
			},
		};
	}),
	(cc.V3F_C4B_T2F_QuadsCopy = function (t) {
		if (!t) return [];
		for (var e = [], i = 0; i < t.length; i++)
			e.push(cc.V3F_C4B_T2F_QuadCopy(t[i]));
		return e;
	}),
	(cc.V2F_C4B_T2F = function (t, e, i, n, r) {
		(this._arrayBuffer =
			n || new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT)),
			(this._offset = r || 0);
		(n = this._arrayBuffer), (r = this._offset);
		(this._vertices = t
			? new cc.Vertex2F(t.x, t.y, n, r)
			: new cc.Vertex2F(0, 0, n, r)),
			(r += cc.Vertex2F.BYTES_PER_ELEMENT),
			(this._colors = e
				? cc.color(e.r, e.g, e.b, e.a, n, r)
				: cc.color(0, 0, 0, 0, n, r)),
			(r += cc.Color.BYTES_PER_ELEMENT),
			(this._texCoords = i
				? new cc.Tex2F(i.u, i.v, n, r)
				: new cc.Tex2F(0, 0, n, r));
	}),
	(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT = 20),
	(_p = cc.V2F_C4B_T2F.prototype),
	(_p._getVertices = function () {
		return this._vertices;
	}),
	(_p._setVertices = function (t) {
		(this._vertices._view[0] = t.x), (this._vertices._view[1] = t.y);
	}),
	(_p._getColor = function () {
		return this._colors;
	}),
	(_p._setColor = function (t) {
		var e = this._colors;
		(e._view[0] = t.r),
			(e._view[1] = t.g),
			(e._view[2] = t.b),
			(e._view[3] = t.a);
	}),
	(_p._getTexCoords = function () {
		return this._texCoords;
	}),
	(_p._setTexCoords = function (t) {
		(this._texCoords._view[0] = t.u), (this._texCoords._view[1] = t.v);
	}),
	_p.vertices,
	cc.defineGetterSetter(_p, 'vertices', _p._getVertices, _p._setVertices),
	_p.colors,
	cc.defineGetterSetter(_p, 'colors', _p._getColor, _p._setColor),
	_p.texCoords,
	cc.defineGetterSetter(_p, 'texCoords', _p._getTexCoords, _p._setTexCoords),
	(cc.V2F_C4B_T2F_Triangle = function (t, e, i, n, r) {
		(this._arrayBuffer =
			n || new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT)),
			(this._offset = r || 0);
		var o = this._arrayBuffer,
			n = this._offset,
			r = cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;
		(this._a = t
			? new cc.V2F_C4B_T2F(t.vertices, t.colors, t.texCoords, o, n)
			: new cc.V2F_C4B_T2F(null, null, null, o, n)),
			(n += r),
			(this._b = e
				? new cc.V2F_C4B_T2F(e.vertices, e.colors, e.texCoords, o, n)
				: new cc.V2F_C4B_T2F(null, null, null, o, n)),
			(n += r),
			(this._c = i
				? new cc.V2F_C4B_T2F(i.vertices, i.colors, i.texCoords, o, n)
				: new cc.V2F_C4B_T2F(null, null, null, o, n));
	}),
	(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT = 60),
	(_p = cc.V2F_C4B_T2F_Triangle.prototype),
	(_p._getA = function () {
		return this._a;
	}),
	(_p._setA = function (t) {
		var e = this._a;
		(e.vertices = t.vertices),
			(e.colors = t.colors),
			(e.texCoords = t.texCoords);
	}),
	(_p._getB = function () {
		return this._b;
	}),
	(_p._setB = function (t) {
		var e = this._b;
		(e.vertices = t.vertices),
			(e.colors = t.colors),
			(e.texCoords = t.texCoords);
	}),
	(_p._getC = function () {
		return this._c;
	}),
	(_p._setC = function (t) {
		var e = this._c;
		(e.vertices = t.vertices),
			(e.colors = t.colors),
			(e.texCoords = t.texCoords);
	}),
	_p.a,
	cc.defineGetterSetter(_p, 'a', _p._getA, _p._setA),
	_p.b,
	cc.defineGetterSetter(_p, 'b', _p._getB, _p._setB),
	_p.c,
	cc.defineGetterSetter(_p, 'c', _p._getC, _p._setC),
	(cc.vertex2 = function (t, e) {
		return new cc.Vertex2F(t, e);
	}),
	(cc.vertex3 = function (t, e, i) {
		return new cc.Vertex3F(t, e, i);
	}),
	(cc.tex2 = function (t, e) {
		return new cc.Tex2F(t, e);
	}),
	(cc.BlendFunc = function (t, e) {
		(this.src = t), (this.dst = e);
	}),
	(cc.blendFuncDisable = function () {
		return new cc.BlendFunc(cc.ONE, cc.ZERO);
	}),
	(cc.hexToColor = function (t) {
		t = t.replace(/^#?/, '0x');
		var e = parseInt(t),
			i = e >> 16,
			t = (e >> 8) % 256,
			e = e % 256;
		return cc.color(i, t, e);
	}),
	(cc.colorToHex = function (t) {
		var e = t.r.toString(16),
			i = t.g.toString(16),
			n = t.b.toString(16);
		return (
			'#' +
			(t.r < 16 ? '0' + e : e) +
			(t.g < 16 ? '0' + i : i) +
			(t.b < 16 ? '0' + n : n)
		);
	}),
	(cc.TEXT_ALIGNMENT_LEFT = 0),
	(cc.TEXT_ALIGNMENT_CENTER = 1),
	(cc.TEXT_ALIGNMENT_RIGHT = 2),
	(cc.VERTICAL_TEXT_ALIGNMENT_TOP = 0),
	(cc.VERTICAL_TEXT_ALIGNMENT_CENTER = 1),
	(cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM = 2),
	(cc._Dictionary = cc.Class.extend({
		_keyMapTb: null,
		_valueMapTb: null,
		__currId: 0,
		ctor: function () {
			(this._keyMapTb = {}),
				(this._valueMapTb = {}),
				(this.__currId = 2 << (0 | (10 * Math.random())));
		},
		__getKey: function () {
			return this.__currId++, 'key_' + this.__currId;
		},
		setObject: function (t, e) {
			var i;
			null != e &&
				((i = this.__getKey()),
				(this._keyMapTb[i] = e),
				(this._valueMapTb[i] = t));
		},
		objectForKey: function (t) {
			if (null == t) return null;
			var e,
				i = this._keyMapTb;
			for (e in i) if (i[e] === t) return this._valueMapTb[e];
			return null;
		},
		valueForKey: function (t) {
			return this.objectForKey(t);
		},
		removeObjectForKey: function (t) {
			if (null != t) {
				var e,
					i = this._keyMapTb;
				for (e in i)
					if (i[e] === t)
						return delete this._valueMapTb[e], void delete i[e];
			}
		},
		removeObjectsForKeys: function (t) {
			if (null != t)
				for (var e = 0; e < t.length; e++)
					this.removeObjectForKey(t[e]);
		},
		allKeys: function () {
			var t,
				e = [],
				i = this._keyMapTb;
			for (t in i) e.push(i[t]);
			return e;
		},
		removeAllObjects: function () {
			(this._keyMapTb = {}), (this._valueMapTb = {});
		},
		count: function () {
			return this.allKeys().length;
		},
	})),
	(cc.FontDefinition = function (t) {
		var e = this;
		if (
			((e.fontName = 'Arial'),
			(e.fontSize = 12),
			(e.textAlign = cc.TEXT_ALIGNMENT_CENTER),
			(e.verticalAlign = cc.VERTICAL_TEXT_ALIGNMENT_TOP),
			(e.fillStyle = cc.color(255, 255, 255, 255)),
			(e.boundingWidth = 0),
			(e.boundingHeight = 0),
			(e.strokeEnabled = !1),
			(e.strokeStyle = cc.color(255, 255, 255, 255)),
			(e.lineWidth = 1),
			(e.lineHeight = 'normal'),
			(e.fontStyle = 'normal'),
			(e.fontWeight = 'normal'),
			(e.shadowEnabled = !1),
			(e.shadowOffsetX = 0),
			(e.shadowOffsetY = 0),
			(e.shadowBlur = 0),
			(e.shadowOpacity = 1),
			t && t instanceof Object)
		)
			for (var i in t) e[i] = t[i];
	}),
	(cc.FontDefinition.prototype._getCanvasFontStr = function () {
		var t = this.lineHeight.charAt
			? this.lineHeight
			: this.lineHeight + 'px';
		return (
			this.fontStyle +
			' ' +
			this.fontWeight +
			' ' +
			this.fontSize +
			'px/' +
			t +
			" '" +
			this.fontName +
			"'"
		);
	}),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		cc._renderType === cc.game.RENDER_TYPE_CANVAS &&
			(cc.assert(
				cc.isFunction(cc._tmp.PrototypeColor),
				cc._LogInfos.MissingFile,
				'CCTypesPropertyDefine.js'
			),
			cc._tmp.PrototypeColor(),
			delete cc._tmp.PrototypeColor);
	}),
	(cc.Touches = []),
	(cc.TouchesIntergerDict = {}),
	(cc.DENSITYDPI_DEVICE = 'device-dpi'),
	(cc.DENSITYDPI_HIGH = 'high-dpi'),
	(cc.DENSITYDPI_MEDIUM = 'medium-dpi'),
	(cc.DENSITYDPI_LOW = 'low-dpi');
var __BrowserGetter = {
	init: function () {
		this.html = document.getElementsByTagName('html')[0];
	},
	availWidth: function (t) {
		return t && t !== this.html ? t.clientWidth : window.innerWidth;
	},
	availHeight: function (t) {
		return t && t !== this.html ? t.clientHeight : window.innerHeight;
	},
	meta: { width: 'device-width' },
	adaptationType: cc.sys.browserType,
};
switch (
	(-1 < window.navigator.userAgent.indexOf('OS 8_1_') &&
		(__BrowserGetter.adaptationType = cc.sys.BROWSER_TYPE_MIUI),
	cc.sys.os === cc.sys.OS_IOS &&
		(__BrowserGetter.adaptationType = cc.sys.BROWSER_TYPE_SAFARI),
	__BrowserGetter.adaptationType)
) {
	case cc.sys.BROWSER_TYPE_SAFARI:
		(__BrowserGetter.meta['minimal-ui'] = 'true'),
			(__BrowserGetter.availWidth = function (t) {
				return t.clientWidth;
			}),
			(__BrowserGetter.availHeight = function (t) {
				return t.clientHeight;
			});
		break;
	case cc.sys.BROWSER_TYPE_CHROME:
		__BrowserGetter.__defineGetter__('target-densitydpi', function () {
			return cc.view._targetDensityDPI;
		});
	case cc.sys.BROWSER_TYPE_SOUGOU:
	case cc.sys.BROWSER_TYPE_UC:
		(__BrowserGetter.availWidth = function (t) {
			return t.clientWidth;
		}),
			(__BrowserGetter.availHeight = function (t) {
				return t.clientHeight;
			});
		break;
	case cc.sys.BROWSER_TYPE_MIUI:
		__BrowserGetter.init = function (t) {
			var e;
			t.__resizeWithBrowserSize ||
				((e = function () {
					t.setDesignResolutionSize(
						t._designResolutionSize.width,
						t._designResolutionSize.height,
						t._resolutionPolicy
					),
						window.removeEventListener('resize', e, !1);
				}),
				window.addEventListener('resize', e, !1));
		};
}
var _scissorRect = cc.rect();
(cc.EGLView = cc.Class.extend({
	_delegate: null,
	_frameSize: null,
	_designResolutionSize: null,
	_originalDesignResolutionSize: null,
	_viewPortRect: null,
	_visibleRect: null,
	_retinaEnabled: !1,
	_autoFullScreen: !1,
	_devicePixelRatio: 1,
	_viewName: '',
	_resizeCallback: null,
	_scaleX: 1,
	_originalScaleX: 1,
	_scaleY: 1,
	_originalScaleY: 1,
	_isRotated: !1,
	_orientation: 3,
	_resolutionPolicy: null,
	_rpExactFit: null,
	_rpShowAll: null,
	_rpNoBorder: null,
	_rpFixedHeight: null,
	_rpFixedWidth: null,
	_initialized: !1,
	_contentTranslateLeftTop: null,
	_frame: null,
	_frameZoomFactor: 1,
	__resizeWithBrowserSize: !1,
	_isAdjustViewPort: !0,
	_targetDensityDPI: null,
	ctor: function () {
		var t = this,
			e = document,
			i = cc.ContainerStrategy,
			n = cc.ContentStrategy;
		__BrowserGetter.init(this),
			(t._frame =
				cc.container.parentNode === e.body
					? e.documentElement
					: cc.container.parentNode),
			(t._frameSize = cc.size(0, 0)),
			t._initFrameSize();
		var r = cc._canvas.width,
			e = cc._canvas.height;
		(t._designResolutionSize = cc.size(r, e)),
			(t._originalDesignResolutionSize = cc.size(r, e)),
			(t._viewPortRect = cc.rect(0, 0, r, e)),
			(t._visibleRect = cc.rect(0, 0, r, e)),
			(t._contentTranslateLeftTop = { left: 0, top: 0 }),
			(t._viewName = 'Cocos2dHTML5');
		e = cc.sys;
		t.enableRetina(e.os === e.OS_IOS || e.os === e.OS_OSX),
			cc.visibleRect && cc.visibleRect.init(t._visibleRect),
			(t._rpExactFit = new cc.ResolutionPolicy(
				i.EQUAL_TO_FRAME,
				n.EXACT_FIT
			)),
			(t._rpShowAll = new cc.ResolutionPolicy(
				i.PROPORTION_TO_FRAME,
				n.SHOW_ALL
			)),
			(t._rpNoBorder = new cc.ResolutionPolicy(
				i.EQUAL_TO_FRAME,
				n.NO_BORDER
			)),
			(t._rpFixedHeight = new cc.ResolutionPolicy(
				i.EQUAL_TO_FRAME,
				n.FIXED_HEIGHT
			)),
			(t._rpFixedWidth = new cc.ResolutionPolicy(
				i.EQUAL_TO_FRAME,
				n.FIXED_WIDTH
			)),
			(t._targetDensityDPI = cc.DENSITYDPI_HIGH);
	},
	_resizeEvent: function () {
		var t = this.setDesignResolutionSize ? this : cc.view,
			e = t._frameSize.width,
			i = t._frameSize.height,
			n = t._isRotated;
		t._initFrameSize(),
			(t._isRotated === n &&
				t._frameSize.width === e &&
				t._frameSize.height === i) ||
				(t._resizeCallback && t._resizeCallback.call(),
				(e = t._originalDesignResolutionSize.width),
				(i = t._originalDesignResolutionSize.height),
				0 < e && t.setDesignResolutionSize(e, i, t._resolutionPolicy));
	},
	setTargetDensityDPI: function (t) {
		(this._targetDensityDPI = t), this._adjustViewportMeta();
	},
	getTargetDensityDPI: function () {
		return this._targetDensityDPI;
	},
	resizeWithBrowserSize: function (t) {
		t
			? this.__resizeWithBrowserSize ||
			  ((this.__resizeWithBrowserSize = !0),
			  window.addEventListener('resize', this._resizeEvent),
			  window.addEventListener('orientationchange', this._resizeEvent))
			: this.__resizeWithBrowserSize &&
			  ((this.__resizeWithBrowserSize = !1),
			  window.removeEventListener('resize', this._resizeEvent),
			  window.removeEventListener(
					'orientationchange',
					this._resizeEvent
			  ));
	},
	setResizeCallback: function (t) {
		(!cc.isFunction(t) && null != t) || (this._resizeCallback = t);
	},
	setOrientation: function (t) {
		(t &= cc.ORIENTATION_AUTO) && (this._orientation = t);
	},
	_initFrameSize: function () {
		var t = this._frameSize,
			e = __BrowserGetter.availWidth(this._frame),
			i = __BrowserGetter.availHeight(this._frame),
			n = i <= e;
		!cc.sys.isMobile ||
		(n && this._orientation & cc.ORIENTATION_LANDSCAPE) ||
		(!n && this._orientation & cc.ORIENTATION_PORTRAIT)
			? ((t.width = e),
			  (t.height = i),
			  (cc.container.style['-webkit-transform'] = 'rotate(0deg)'),
			  (cc.container.style.transform = 'rotate(0deg)'),
			  (this._isRotated = !1))
			: ((t.width = i),
			  (t.height = e),
			  (cc.container.style['-webkit-transform'] = 'rotate(90deg)'),
			  (cc.container.style.transform = 'rotate(90deg)'),
			  (cc.container.style['-webkit-transform-origin'] = '0px 0px 0px'),
			  (cc.container.style.transformOrigin = '0px 0px 0px'),
			  (this._isRotated = !0));
	},
	_adjustSizeKeepCanvasSize: function () {
		var t = this._originalDesignResolutionSize.width,
			e = this._originalDesignResolutionSize.height;
		0 < t && this.setDesignResolutionSize(t, e, this._resolutionPolicy);
	},
	_setViewportMeta: function (t, e) {
		var i = document.getElementById('cocosMetaElement');
		i && e && document.head.removeChild(i);
		var n,
			r,
			o = document.getElementsByName('viewport'),
			o = o ? o[0] : null,
			s = o ? o.content : '';
		for (n in (((i = i || document.createElement('meta')).id =
			'cocosMetaElement'),
		(i.name = 'viewport'),
		(i.content = ''),
		t))
			-1 == s.indexOf(n)
				? (s += ',' + n + '=' + t[n])
				: e &&
				  ((r = new RegExp(n + 's*=s*[^,]+')),
				  s.replace(r, n + '=' + t[n]));
		/^,/.test(s) && (s = s.substr(1)),
			(i.content = s),
			o && (o.content = s),
			document.head.appendChild(i);
	},
	_adjustViewportMeta: function () {
		this._isAdjustViewPort &&
			(this._setViewportMeta(__BrowserGetter.meta, !1),
			(this._isAdjustViewPort = !1));
	},
	_setScaleXYForRenderTexture: function () {
		var t = cc.contentScaleFactor();
		(this._scaleX = t), (this._scaleY = t);
	},
	_resetScale: function () {
		(this._scaleX = this._originalScaleX),
			(this._scaleY = this._originalScaleY);
	},
	_adjustSizeToBrowser: function () {},
	initialize: function () {
		this._initialized = !0;
	},
	adjustViewPort: function (t) {
		this._isAdjustViewPort = t;
	},
	enableRetina: function (t) {
		this._retinaEnabled = !!t;
	},
	isRetinaEnabled: function () {
		return this._retinaEnabled;
	},
	enableAutoFullScreen: function (t) {
		t &&
		t !== this._autoFullScreen &&
		cc.sys.isMobile &&
		this._frame === document.documentElement
			? ((this._autoFullScreen = 0),
			  cc.screen.autoFullScreen(this._frame))
			: (this._autoFullScreen = 1);
	},
	isAutoFullScreenEnabled: function () {
		return this._autoFullScreen;
	},
	end: function () {},
	isOpenGLReady: function () {
		return cc.game.canvas && cc._renderContext;
	},
	setFrameZoomFactor: function (t) {
		(this._frameZoomFactor = t),
			this.centerWindow(),
			cc.director.setProjection(cc.director.getProjection());
	},
	swapBuffers: function () {},
	setIMEKeyboardState: function (t) {},
	setContentTranslateLeftTop: function (t, e) {
		this._contentTranslateLeftTop = { left: t, top: e };
	},
	getContentTranslateLeftTop: function () {
		return this._contentTranslateLeftTop;
	},
	getCanvasSize: function () {
		return cc.size(cc._canvas.width, cc._canvas.height);
	},
	getFrameSize: function () {
		return cc.size(this._frameSize.width, this._frameSize.height);
	},
	setFrameSize: function (t, e) {
		(this._frameSize.width = t),
			(this._frameSize.height = e),
			(this._frame.style.width = t + 'px'),
			(this._frame.style.height = e + 'px'),
			this._resizeEvent(),
			cc.director.setProjection(cc.director.getProjection());
	},
	centerWindow: function () {},
	getVisibleSize: function () {
		return cc.size(this._visibleRect.width, this._visibleRect.height);
	},
	getVisibleSizeInPixel: function () {
		return cc.size(
			this._visibleRect.width * this._scaleX,
			this._visibleRect.height * this._scaleY
		);
	},
	getVisibleOrigin: function () {
		return cc.p(this._visibleRect.x, this._visibleRect.y);
	},
	getVisibleOriginInPixel: function () {
		return cc.p(
			this._visibleRect.x * this._scaleX,
			this._visibleRect.y * this._scaleY
		);
	},
	canSetContentScaleFactor: function () {
		return !0;
	},
	getResolutionPolicy: function () {
		return this._resolutionPolicy;
	},
	setResolutionPolicy: function (t) {
		var e,
			i = this;
		t instanceof cc.ResolutionPolicy
			? (i._resolutionPolicy = t)
			: (t === (e = cc.ResolutionPolicy).EXACT_FIT &&
					(i._resolutionPolicy = i._rpExactFit),
			  t === e.SHOW_ALL && (i._resolutionPolicy = i._rpShowAll),
			  t === e.NO_BORDER && (i._resolutionPolicy = i._rpNoBorder),
			  t === e.FIXED_HEIGHT && (i._resolutionPolicy = i._rpFixedHeight),
			  t === e.FIXED_WIDTH && (i._resolutionPolicy = i._rpFixedWidth));
	},
	setDesignResolutionSize: function (t, e, i) {
		var n;
		0 < t || 0 < e
			? (this.setResolutionPolicy(i),
			  (i = this._resolutionPolicy)
					? (i.preApply(this),
					  cc.sys.isMobile && this._adjustViewportMeta(),
					  this._initFrameSize(),
					  (this._originalDesignResolutionSize.width =
							this._designResolutionSize.width =
								t),
					  (this._originalDesignResolutionSize.height =
							this._designResolutionSize.height =
								e),
					  (t = i.apply(this, this._designResolutionSize)).scale &&
							2 === t.scale.length &&
							((this._scaleX = t.scale[0]),
							(this._scaleY = t.scale[1])),
					  t.viewport &&
							((n = this._viewPortRect),
							(e = this._visibleRect),
							(t = t.viewport),
							(n.x = t.x),
							(n.y = t.y),
							(n.width = t.width),
							(n.height = t.height),
							(e.x = -n.x / this._scaleX),
							(e.y = -n.y / this._scaleY),
							(e.width = cc._canvas.width / this._scaleX),
							(e.height = cc._canvas.height / this._scaleY),
							cc._renderContext.setOffset &&
								cc._renderContext.setOffset(n.x, -n.y)),
					  ((n = cc.director)._winSizeInPoints.width =
							this._designResolutionSize.width),
					  (n._winSizeInPoints.height =
							this._designResolutionSize.height),
					  i.postApply(this),
					  (cc.winSize.width = n._winSizeInPoints.width),
					  (cc.winSize.height = n._winSizeInPoints.height),
					  cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
							n.setGLDefaultValues(),
					  (this._originalScaleX = this._scaleX),
					  (this._originalScaleY = this._scaleY),
					  cc.DOM && cc.DOM._resetEGLViewDiv(),
					  cc.visibleRect && cc.visibleRect.init(this._visibleRect))
					: cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2))
			: cc.log(cc._LogInfos.EGLView_setDesignResolutionSize);
	},
	getDesignResolutionSize: function () {
		return cc.size(
			this._designResolutionSize.width,
			this._designResolutionSize.height
		);
	},
	setRealPixelResolution: function (t, e, i) {
		this._setViewportMeta(
			{ width: t, 'target-densitydpi': cc.DENSITYDPI_DEVICE },
			!0
		),
			(document.body.style.width = t + 'px'),
			(document.body.style.left = '0px'),
			(document.body.style.top = '0px'),
			this.setDesignResolutionSize(t, e, i);
	},
	setViewPortInPoints: function (t, e, i, n) {
		var r = this._frameZoomFactor,
			o = this._scaleX,
			s = this._scaleY;
		cc._renderContext.viewport(
			t * o * r + this._viewPortRect.x * r,
			e * s * r + this._viewPortRect.y * r,
			i * o * r,
			n * s * r
		);
	},
	setScissorInPoints: function (t, e, i, n) {
		var r = this._frameZoomFactor,
			o = this._scaleX,
			s = this._scaleY;
		(_scissorRect.x = t),
			(_scissorRect.y = e),
			(_scissorRect.width = i),
			(_scissorRect.height = n),
			cc._renderContext.scissor(
				t * o * r + this._viewPortRect.x * r,
				e * s * r + this._viewPortRect.y * r,
				i * o * r,
				n * s * r
			);
	},
	isScissorEnabled: function () {
		return cc._renderContext.isEnabled(gl.SCISSOR_TEST);
	},
	getScissorRect: function () {
		return cc.rect(_scissorRect);
	},
	setViewName: function (t) {
		null != t && 0 < t.length && (this._viewName = t);
	},
	getViewName: function () {
		return this._viewName;
	},
	getViewPortRect: function () {
		return this._viewPortRect;
	},
	getScaleX: function () {
		return this._scaleX;
	},
	getScaleY: function () {
		return this._scaleY;
	},
	getDevicePixelRatio: function () {
		return this._devicePixelRatio;
	},
	convertToLocationInView: function (t, e, i) {
		(t = this._devicePixelRatio * (t - i.left)),
			(e = this._devicePixelRatio * (i.top + i.height - e));
		return this._isRotated
			? { x: this._viewPortRect.width - e, y: t }
			: { x: t, y: e };
	},
	_convertMouseToLocationInView: function (t, e) {
		var i = this._viewPortRect;
		(t.x = (this._devicePixelRatio * (t.x - e.left) - i.x) / this._scaleX),
			(t.y =
				(this._devicePixelRatio * (e.top + e.height - t.y) - i.y) /
				this._scaleY);
	},
	_convertPointWithScale: function (t) {
		var e = this._viewPortRect;
		(t.x = (t.x - e.x) / this._scaleX), (t.y = (t.y - e.y) / this._scaleY);
	},
	_convertTouchesWithScale: function (t) {
		for (
			var e,
				i,
				n = this._viewPortRect,
				r = this._scaleX,
				o = this._scaleY,
				s = 0;
			s < t.length;
			s++
		)
			(e = (i = t[s])._point),
				(i = i._prevPoint),
				(e.x = (e.x - n.x) / r),
				(e.y = (e.y - n.y) / o),
				(i.x = (i.x - n.x) / r),
				(i.y = (i.y - n.y) / o);
	},
})),
	(cc.EGLView._getInstance = function () {
		return (
			this._instance ||
				((this._instance = this._instance || new cc.EGLView()),
				this._instance.initialize()),
			this._instance
		);
	}),
	(cc.ContainerStrategy = cc.Class.extend({
		preApply: function (t) {},
		apply: function (t, e) {},
		postApply: function (t) {},
		_setupContainer: function (t, e, i) {
			var n = cc.game.canvas,
				r = cc.game.container;
			(r.style.width = n.style.width = e + 'px'),
				(r.style.height = n.style.height = i + 'px');
			r = t._devicePixelRatio = 1;
			t.isRetinaEnabled() &&
				(r = t._devicePixelRatio =
					Math.min(2, window.devicePixelRatio || 1)),
				(n.width = e * r),
				(n.height = i * r),
				cc._renderContext.resetCache && cc._renderContext.resetCache();
		},
		_fixContainer: function () {
			document.body.insertBefore(cc.container, document.body.firstChild);
			var t = document.body.style;
			(t.width = window.innerWidth + 'px'),
				(t.height = window.innerHeight + 'px'),
				(t.overflow = 'hidden');
			t = cc.container.style;
			(t.position = 'fixed'),
				(t.left = t.top = '0px'),
				(document.body.scrollTop = 0);
		},
	})),
	(cc.ContentStrategy = cc.Class.extend({
		_result: { scale: [1, 1], viewport: null },
		_buildResult: function (t, e, i, n, r, o) {
			Math.abs(t - i) < 2 && (i = t), Math.abs(e - n) < 2 && (n = e);
			n = cc.rect(Math.round((t - i) / 2), Math.round((e - n) / 2), i, n);
			return (
				cc._renderType,
				cc.game.RENDER_TYPE_CANVAS,
				(this._result.scale = [r, o]),
				(this._result.viewport = n),
				this._result
			);
		},
		preApply: function (t) {},
		apply: function (t, e) {
			return { scale: [1, 1] };
		},
		postApply: function (t) {},
	})),
	(function () {
		var t = cc.ContainerStrategy.extend({
				apply: function (t) {
					var e = t._frameSize.height,
						i = cc.container.style;
					this._setupContainer(
						t,
						t._frameSize.width,
						t._frameSize.height
					),
						t._isRotated
							? (i.marginLeft = e + 'px')
							: (i.margin = '0px');
				},
			}),
			e = cc.ContainerStrategy.extend({
				apply: function (t, e) {
					var i = t._frameSize.width,
						n = t._frameSize.height,
						r = cc.container.style,
						o = e.width,
						s = e.height,
						c = i / o,
						e = n / s,
						c = c < e ? ((a = i), s * c) : ((a = o * e), n),
						o = Math.round((i - a) / 2),
						e = Math.round((n - c) / 2),
						a = i - 2 * o;
					(c = n - 2 * e),
						this._setupContainer(t, a, c),
						t._isRotated
							? (r.marginLeft = n + 'px')
							: (r.margin = '0px'),
						(r.paddingLeft = o + 'px'),
						(r.paddingRight = o + 'px'),
						(r.paddingTop = e + 'px'),
						(r.paddingBottom = e + 'px');
				},
			}),
			i =
				(t.extend({
					preApply: function (t) {
						this._super(t), (t._frame = document.documentElement);
					},
					apply: function (t) {
						this._super(t), this._fixContainer();
					},
				}),
				e.extend({
					preApply: function (t) {
						this._super(t), (t._frame = document.documentElement);
					},
					apply: function (t, e) {
						this._super(t, e), this._fixContainer();
					},
				}),
				cc.ContainerStrategy.extend({
					apply: function (t) {
						this._setupContainer(
							t,
							cc._canvas.width,
							cc._canvas.height
						);
					},
				}));
		(cc.ContainerStrategy.EQUAL_TO_FRAME = new t()),
			(cc.ContainerStrategy.PROPORTION_TO_FRAME = new e()),
			(cc.ContainerStrategy.ORIGINAL_CONTAINER = new i());
		var n = cc.ContentStrategy.extend({
				apply: function (t, e) {
					var i = cc._canvas.width,
						n = cc._canvas.height,
						r = i / e.width,
						e = n / e.height;
					return this._buildResult(i, n, i, n, r, e);
				},
			}),
			r = cc.ContentStrategy.extend({
				apply: function (t, e) {
					var i,
						n = cc._canvas.width,
						r = cc._canvas.height,
						o = e.width,
						s = e.height,
						c = n / o,
						a = r / s,
						e = 0,
						a =
							c < a
								? ((i = n), s * (e = c))
								: ((i = o * (e = a)), r);
					return this._buildResult(n, r, i, a, e, e);
				},
			}),
			t = cc.ContentStrategy.extend({
				apply: function (t, e) {
					var i,
						n,
						r = cc._canvas.width,
						o = cc._canvas.height,
						s = e.width,
						c = e.height,
						a = r / s,
						e = o / c,
						a =
							a < e
								? ((n = s * (i = e)), o)
								: ((n = r), c * (i = a));
					return this._buildResult(r, o, n, a, i, i);
				},
			}),
			e = cc.ContentStrategy.extend({
				apply: function (t, e) {
					var i = cc._canvas.width,
						n = cc._canvas.height,
						e = n / e.height;
					return this._buildResult(i, n, i, n, e, e);
				},
				postApply: function (t) {
					cc.director._winSizeInPoints = t.getVisibleSize();
				},
			}),
			i = cc.ContentStrategy.extend({
				apply: function (t, e) {
					var i = cc._canvas.width,
						n = cc._canvas.height,
						e = i / e.width;
					return this._buildResult(i, n, i, n, e, e);
				},
				postApply: function (t) {
					cc.director._winSizeInPoints = t.getVisibleSize();
				},
			});
		(cc.ContentStrategy.EXACT_FIT = new n()),
			(cc.ContentStrategy.SHOW_ALL = new r()),
			(cc.ContentStrategy.NO_BORDER = new t()),
			(cc.ContentStrategy.FIXED_HEIGHT = new e()),
			(cc.ContentStrategy.FIXED_WIDTH = new i());
	})(),
	(cc.ResolutionPolicy = cc.Class.extend({
		_containerStrategy: null,
		_contentStrategy: null,
		ctor: function (t, e) {
			this.setContainerStrategy(t), this.setContentStrategy(e);
		},
		preApply: function (t) {
			this._containerStrategy.preApply(t),
				this._contentStrategy.preApply(t);
		},
		apply: function (t, e) {
			return (
				this._containerStrategy.apply(t, e),
				this._contentStrategy.apply(t, e)
			);
		},
		postApply: function (t) {
			this._containerStrategy.postApply(t),
				this._contentStrategy.postApply(t);
		},
		setContainerStrategy: function (t) {
			t instanceof cc.ContainerStrategy && (this._containerStrategy = t);
		},
		setContentStrategy: function (t) {
			t instanceof cc.ContentStrategy && (this._contentStrategy = t);
		},
	})),
	(cc.ResolutionPolicy.EXACT_FIT = 0),
	(cc.ResolutionPolicy.NO_BORDER = 1),
	(cc.ResolutionPolicy.SHOW_ALL = 2),
	(cc.ResolutionPolicy.FIXED_HEIGHT = 3),
	(cc.ResolutionPolicy.FIXED_WIDTH = 4),
	(cc.ResolutionPolicy.UNKNOWN = 5),
	(cc.screen = {
		_supportsFullScreen: !1,
		_preOnFullScreenChange: null,
		_touchEvent: '',
		_fn: null,
		_fnMap: [
			[
				'requestFullscreen',
				'exitFullscreen',
				'fullscreenchange',
				'fullscreenEnabled',
				'fullscreenElement',
			],
			[
				'requestFullScreen',
				'exitFullScreen',
				'fullScreenchange',
				'fullScreenEnabled',
				'fullScreenElement',
			],
			[
				'webkitRequestFullScreen',
				'webkitCancelFullScreen',
				'webkitfullscreenchange',
				'webkitIsFullScreen',
				'webkitCurrentFullScreenElement',
			],
			[
				'mozRequestFullScreen',
				'mozCancelFullScreen',
				'mozfullscreenchange',
				'mozFullScreen',
				'mozFullScreenElement',
			],
			[
				'msRequestFullscreen',
				'msExitFullscreen',
				'MSFullscreenChange',
				'msFullscreenEnabled',
				'msFullscreenElement',
			],
		],
		init: function () {
			this._fn = {};
			var t,
				e,
				i = this._fnMap,
				n = 0;
			for (l = i.length; n < l; n++)
				if ((t = i[n]) && t[1] in document) {
					for (n = 0, e = t.length; n < e; n++)
						this._fn[i[0][n]] = t[n];
					break;
				}
			(this._supportsFullScreen = void 0 !== this._fn.requestFullscreen),
				(this._touchEvent =
					'ontouchstart' in window ? 'touchstart' : 'mousedown');
		},
		fullScreen: function () {
			return (
				!!this._supportsFullScreen &&
				void 0 !== document[this._fn.fullscreenElement] &&
				null !== document[this._fn.fullscreenElement]
			);
		},
		requestFullScreen: function (t, e) {
			var i;
			if (this._supportsFullScreen)
				return (
					(t = t || document.documentElement),
					e &&
						((i = this._fn.fullscreenchange),
						this._preOnFullScreenChange &&
							document.removeEventListener(
								i,
								this._preOnFullScreenChange
							),
						(this._preOnFullScreenChange = e),
						document.addEventListener(i, e, !1)),
					t[this._fn.requestFullscreen]()
				);
		},
		exitFullScreen: function () {
			return (
				!this._supportsFullScreen || document[this._fn.exitFullscreen]()
			);
		},
		autoFullScreen: function (e, i) {
			e = e || document.body;
			var n = cc.game.canvas || e,
				r = this;
			this.requestFullScreen(e, i),
				n.addEventListener(this._touchEvent, function t() {
					n.removeEventListener(r._touchEvent, t),
						r.requestFullScreen(e, i);
				});
		},
	}),
	cc.screen.init(),
	(cc.visibleRect = {
		topLeft: cc.p(0, 0),
		topRight: cc.p(0, 0),
		top: cc.p(0, 0),
		bottomLeft: cc.p(0, 0),
		bottomRight: cc.p(0, 0),
		bottom: cc.p(0, 0),
		center: cc.p(0, 0),
		left: cc.p(0, 0),
		right: cc.p(0, 0),
		width: 0,
		height: 0,
		init: function (t) {
			var e = (this.width = t.width),
				i = (this.height = t.height),
				n = t.x,
				r = t.y,
				o = r + i,
				t = n + e;
			(this.topLeft.x = n),
				(this.topLeft.y = o),
				(this.topRight.x = t),
				(this.topRight.y = o),
				(this.top.x = n + e / 2),
				(this.top.y = o),
				(this.bottomLeft.x = n),
				(this.bottomLeft.y = r),
				(this.bottomRight.x = t),
				(this.bottomRight.y = r),
				(this.bottom.x = n + e / 2),
				(this.bottom.y = r),
				(this.center.x = n + e / 2),
				(this.center.y = r + i / 2),
				(this.left.x = n),
				(this.left.y = r + i / 2),
				(this.right.x = t),
				(this.right.y = r + i / 2);
		},
	}),
	(cc.UIInterfaceOrientationLandscapeLeft = -90),
	(cc.UIInterfaceOrientationLandscapeRight = 90),
	(cc.UIInterfaceOrientationPortraitUpsideDown = 180),
	(cc.UIInterfaceOrientationPortrait = 0),
	(cc.inputManager = {
		_mousePressed: !1,
		_isRegisterEvent: !1,
		_preTouchPoint: cc.p(0, 0),
		_prevMousePoint: cc.p(0, 0),
		_preTouchPool: [],
		_preTouchPoolPointer: 0,
		_touches: [],
		_touchesIntegerDict: {},
		_indexBitsUsed: 0,
		_maxTouches: 5,
		_accelEnabled: !1,
		_accelInterval: 1 / 30,
		_accelMinus: 1,
		_accelCurTime: 0,
		_acceleration: null,
		_accelDeviceEvent: null,
		_getUnUsedIndex: function () {
			for (
				var t = this._indexBitsUsed, e = 0;
				e < this._maxTouches;
				e++
			) {
				if (!(1 & t)) return (this._indexBitsUsed |= 1 << e), e;
				t >>= 1;
			}
			return -1;
		},
		_removeUsedIndexBit: function (t) {
			t < 0 ||
				t >= this._maxTouches ||
				((t = ~(t = 1 << t)), (this._indexBitsUsed &= t));
		},
		_glView: null,
		handleTouchesBegin: function (t) {
			for (
				var e,
					i,
					n,
					r,
					o,
					s = [],
					c = this._touchesIntegerDict,
					a = 0,
					l = t.length;
				a < l;
				a++
			)
				null == c[(r = (n = t[a]).getID())] &&
					(-1 !== (i = this._getUnUsedIndex())
						? ((e = this._touches[i] =
								new cc.Touch(
									n._point.x,
									n._point.y,
									n.getID()
								))._setPrevPoint(n._prevPoint),
						  (c[r] = i),
						  s.push(e))
						: cc.log(
								cc._LogInfos.inputManager_handleTouchesBegin,
								i
						  ));
			0 < s.length &&
				(this._glView._convertTouchesWithScale(s),
				((o = new cc.EventTouch(s))._eventCode =
					cc.EventTouch.EventCode.BEGAN),
				cc.eventManager.dispatchEvent(o));
		},
		handleTouchesMove: function (t) {
			for (
				var e, i, n, r = [], o = this._touches, s = 0, c = t.length;
				s < c;
				s++
			)
				(i = (e = t[s]).getID()),
					null != (i = this._touchesIntegerDict[i]) &&
						o[i] &&
						(o[i]._setPoint(e._point),
						o[i]._setPrevPoint(e._prevPoint),
						r.push(o[i]));
			0 < r.length &&
				(this._glView._convertTouchesWithScale(r),
				((n = new cc.EventTouch(r))._eventCode =
					cc.EventTouch.EventCode.MOVED),
				cc.eventManager.dispatchEvent(n));
		},
		handleTouchesEnd: function (t) {
			t = this.getSetOfTouchesEndOrCancel(t);
			0 < t.length &&
				(this._glView._convertTouchesWithScale(t),
				((t = new cc.EventTouch(t))._eventCode =
					cc.EventTouch.EventCode.ENDED),
				cc.eventManager.dispatchEvent(t));
		},
		handleTouchesCancel: function (t) {
			t = this.getSetOfTouchesEndOrCancel(t);
			0 < t.length &&
				(this._glView._convertTouchesWithScale(t),
				((t = new cc.EventTouch(t))._eventCode =
					cc.EventTouch.EventCode.CANCELLED),
				cc.eventManager.dispatchEvent(t));
		},
		getSetOfTouchesEndOrCancel: function (t) {
			for (
				var e,
					i,
					n,
					r = [],
					o = this._touches,
					s = this._touchesIntegerDict,
					c = 0,
					a = t.length;
				c < a;
				c++
			)
				null != (i = s[(n = (e = t[c]).getID())]) &&
					o[i] &&
					(o[i]._setPoint(e._point),
					o[i]._setPrevPoint(e._prevPoint),
					r.push(o[i]),
					this._removeUsedIndexBit(i),
					delete s[n]);
			return r;
		},
		getHTMLElementPosition: function (t) {
			var e = document.documentElement,
				i = window,
				n = null;
			return {
				left:
					(n = cc.isFunction(t.getBoundingClientRect)
						? t.getBoundingClientRect()
						: {
								left: 0,
								top: 0,
								width: parseInt(t.style.width),
								height: parseInt(t.style.height),
						  }).left +
					i.pageXOffset -
					e.clientLeft,
				top: n.top + i.pageYOffset - e.clientTop,
				width: n.width,
				height: n.height,
			};
		},
		getPreTouch: function (t) {
			for (
				var e = null,
					i = this._preTouchPool,
					n = t.getID(),
					r = i.length - 1;
				0 <= r;
				r--
			)
				if (i[r].getID() === n) {
					e = i[r];
					break;
				}
			return (e = e || t);
		},
		setPreTouch: function (t) {
			for (
				var e = !1,
					i = this._preTouchPool,
					n = t.getID(),
					r = i.length - 1;
				0 <= r;
				r--
			)
				if (i[r].getID() === n) {
					(i[r] = t), (e = !0);
					break;
				}
			e ||
				(i.length <= 50
					? i.push(t)
					: ((i[this._preTouchPoolPointer] = t),
					  (this._preTouchPoolPointer =
							(this._preTouchPoolPointer + 1) % 50)));
		},
		getTouchByXY: function (t, e, i) {
			var n = this._preTouchPoint,
				e = this._glView.convertToLocationInView(t, e, i),
				i = new cc.Touch(e.x, e.y);
			return i._setPrevPoint(n.x, n.y), (n.x = e.x), (n.y = e.y), i;
		},
		getMouseEvent: function (t, e, i) {
			var n = this._prevMousePoint;
			this._glView._convertMouseToLocationInView(t, e);
			i = new cc.EventMouse(i);
			return (
				i.setLocation(t.x, t.y),
				i._setPrevCursor(n.x, n.y),
				(n.x = t.x),
				(n.y = t.y),
				i
			);
		},
		getPointByEvent: function (t, e) {
			return null != t.pageX
				? { x: t.pageX, y: t.pageY }
				: ((e.left -= document.body.scrollLeft),
				  (e.top -= document.body.scrollTop),
				  { x: t.clientX, y: t.clientY });
		},
		getTouchesByEvent: function (t, e) {
			for (
				var i,
					n,
					r,
					o = [],
					s = this._glView,
					c = this._preTouchPoint,
					a = t.changedTouches.length,
					l = 0;
				l < a;
				l++
			)
				(r = t.changedTouches[l]) &&
					((n =
						cc.sys.BROWSER_TYPE_FIREFOX === cc.sys.browserType
							? s.convertToLocationInView(r.pageX, r.pageY, e)
							: s.convertToLocationInView(
									r.clientX,
									r.clientY,
									e
							  )),
					null != r.identifier
						? ((i = new cc.Touch(n.x, n.y, r.identifier)),
						  (r = this.getPreTouch(i).getLocation()),
						  i._setPrevPoint(r.x, r.y),
						  this.setPreTouch(i))
						: (i = new cc.Touch(n.x, n.y))._setPrevPoint(c.x, c.y),
					(c.x = n.x),
					(c.y = n.y),
					o.push(i));
			return o;
		},
		registerSystemEvent: function (n) {
			if (!this._isRegisterEvent) {
				this._glView = cc.view;
				var r = this,
					t = 'mouse' in cc.sys.capabilities,
					e = 'touches' in cc.sys.capabilities,
					o = !1;
				if (
					(cc.sys.isMobile && (o = !0),
					t &&
						(window.addEventListener(
							'mousedown',
							function () {
								r._mousePressed = !0;
							},
							!1
						),
						window.addEventListener(
							'mouseup',
							function (t) {
								var e, i;
								o ||
									((e = r._mousePressed),
									(r._mousePressed = !1),
									e &&
										((i = r.getHTMLElementPosition(n)),
										(e = r.getPointByEvent(t, i)),
										cc.rectContainsPoint(
											new cc.Rect(
												i.left,
												i.top,
												i.width,
												i.height
											),
											e
										) ||
											(r.handleTouchesEnd([
												r.getTouchByXY(e.x, e.y, i),
											]),
											(i = r.getMouseEvent(
												e,
												i,
												cc.EventMouse.UP
											)).setButton(t.button),
											cc.eventManager.dispatchEvent(i))));
							},
							!1
						),
						n.addEventListener(
							'mousedown',
							function (t) {
								var e, i;
								o ||
									((r._mousePressed = !0),
									(i = r.getHTMLElementPosition(n)),
									(e = r.getPointByEvent(t, i)),
									r.handleTouchesBegin([
										r.getTouchByXY(e.x, e.y, i),
									]),
									(i = r.getMouseEvent(
										e,
										i,
										cc.EventMouse.DOWN
									)).setButton(t.button),
									cc.eventManager.dispatchEvent(i),
									t.stopPropagation(),
									t.preventDefault(),
									n.focus());
							},
							!1
						),
						n.addEventListener(
							'mouseup',
							function (t) {
								var e, i;
								o ||
									((r._mousePressed = !1),
									(i = r.getHTMLElementPosition(n)),
									(e = r.getPointByEvent(t, i)),
									r.handleTouchesEnd([
										r.getTouchByXY(e.x, e.y, i),
									]),
									(i = r.getMouseEvent(
										e,
										i,
										cc.EventMouse.UP
									)).setButton(t.button),
									cc.eventManager.dispatchEvent(i),
									t.stopPropagation(),
									t.preventDefault());
							},
							!1
						),
						n.addEventListener(
							'mousemove',
							function (t) {
								var e, i;
								o ||
									((i = r.getHTMLElementPosition(n)),
									(e = r.getPointByEvent(t, i)),
									r.handleTouchesMove([
										r.getTouchByXY(e.x, e.y, i),
									]),
									(i = r.getMouseEvent(
										e,
										i,
										cc.EventMouse.MOVE
									)),
									r._mousePressed
										? i.setButton(t.button)
										: i.setButton(null),
									cc.eventManager.dispatchEvent(i),
									t.stopPropagation(),
									t.preventDefault());
							},
							!1
						),
						n.addEventListener(
							'mousewheel',
							function (t) {
								var e = r.getHTMLElementPosition(n),
									i = r.getPointByEvent(t, e),
									e = r.getMouseEvent(
										i,
										e,
										cc.EventMouse.SCROLL
									);
								e.setButton(t.button),
									e.setScrollData(0, t.wheelDelta),
									cc.eventManager.dispatchEvent(e),
									t.stopPropagation(),
									t.preventDefault();
							},
							!1
						),
						n.addEventListener(
							'DOMMouseScroll',
							function (t) {
								var e = r.getHTMLElementPosition(n),
									i = r.getPointByEvent(t, e),
									e = r.getMouseEvent(
										i,
										e,
										cc.EventMouse.SCROLL
									);
								e.setButton(t.button),
									e.setScrollData(0, -120 * t.detail),
									cc.eventManager.dispatchEvent(e),
									t.stopPropagation(),
									t.preventDefault();
							},
							!1
						)),
					window.navigator.msPointerEnabled)
				) {
					var s,
						i = {
							MSPointerDown: r.handleTouchesBegin,
							MSPointerMove: r.handleTouchesMove,
							MSPointerUp: r.handleTouchesEnd,
							MSPointerCancel: r.handleTouchesCancel,
						};
					for (s in i)
						!(function (i) {
							n.addEventListener(
								s,
								function (t) {
									var e = r.getHTMLElementPosition(n);
									(e.left -=
										document.documentElement.scrollLeft),
										(e.top -=
											document.documentElement.scrollTop),
										i.call(r, [
											r.getTouchByXY(
												t.clientX,
												t.clientY,
												e
											),
										]),
										t.stopPropagation();
								},
								!1
							);
						})(i[s]);
				}
				e &&
					(n.addEventListener(
						'touchstart',
						function (t) {
							var e;
							t.changedTouches &&
								(((e = r.getHTMLElementPosition(n)).left -=
									document.body.scrollLeft),
								(e.top -= document.body.scrollTop),
								r.handleTouchesBegin(r.getTouchesByEvent(t, e)),
								t.stopPropagation(),
								t.preventDefault(),
								n.focus());
						},
						!1
					),
					n.addEventListener(
						'touchmove',
						function (t) {
							var e;
							t.changedTouches &&
								(((e = r.getHTMLElementPosition(n)).left -=
									document.body.scrollLeft),
								(e.top -= document.body.scrollTop),
								r.handleTouchesMove(r.getTouchesByEvent(t, e)),
								t.stopPropagation(),
								t.preventDefault());
						},
						!1
					),
					n.addEventListener(
						'touchend',
						function (t) {
							var e;
							t.changedTouches &&
								(((e = r.getHTMLElementPosition(n)).left -=
									document.body.scrollLeft),
								(e.top -= document.body.scrollTop),
								r.handleTouchesEnd(r.getTouchesByEvent(t, e)),
								t.stopPropagation(),
								t.preventDefault());
						},
						!1
					),
					n.addEventListener(
						'touchcancel',
						function (t) {
							var e;
							t.changedTouches &&
								(((e = r.getHTMLElementPosition(n)).left -=
									document.body.scrollLeft),
								(e.top -= document.body.scrollTop),
								r.handleTouchesCancel(
									r.getTouchesByEvent(t, e)
								),
								t.stopPropagation(),
								t.preventDefault());
						},
						!1
					)),
					this._registerKeyboardEvent(),
					this._registerAccelerometerEvent(),
					(this._isRegisterEvent = !0);
			}
		},
		_registerKeyboardEvent: function () {},
		_registerAccelerometerEvent: function () {},
		update: function (t) {
			this._accelCurTime > this._accelInterval &&
				((this._accelCurTime -= this._accelInterval),
				cc.eventManager.dispatchEvent(
					new cc.EventAcceleration(this._acceleration)
				)),
				(this._accelCurTime += t);
		},
	}),
	(cc.AffineTransform = function (t, e, i, n, r, o) {
		(this.a = t),
			(this.b = e),
			(this.c = i),
			(this.d = n),
			(this.tx = r),
			(this.ty = o);
	}),
	(cc.affineTransformMake = function (t, e, i, n, r, o) {
		return { a: t, b: e, c: i, d: n, tx: r, ty: o };
	}),
	(cc.pointApplyAffineTransform = function (t, e, i) {
		var n,
			e = void 0 === i ? ((i = e), (n = t.x), t.y) : ((n = t), e);
		return { x: i.a * n + i.c * e + i.tx, y: i.b * n + i.d * e + i.ty };
	}),
	(cc._pointApplyAffineTransform = function (t, e, i) {
		return cc.pointApplyAffineTransform(t, e, i);
	}),
	(cc.sizeApplyAffineTransform = function (t, e) {
		return {
			width: e.a * t.width + e.c * t.height,
			height: e.b * t.width + e.d * t.height,
		};
	}),
	(cc.affineTransformMakeIdentity = function () {
		return { a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 };
	}),
	(cc.affineTransformIdentity = function () {
		return { a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 };
	}),
	(cc.rectApplyAffineTransform = function (t, e) {
		var i = cc.rectGetMinY(t),
			n = cc.rectGetMinX(t),
			r = cc.rectGetMaxX(t),
			o = cc.rectGetMaxY(t),
			s = cc.pointApplyAffineTransform(n, i, e),
			t = cc.pointApplyAffineTransform(r, i, e),
			i = cc.pointApplyAffineTransform(n, o, e),
			n = cc.pointApplyAffineTransform(r, o, e),
			r = Math.min(s.x, t.x, i.x, n.x),
			o = Math.max(s.x, t.x, i.x, n.x),
			e = Math.min(s.y, t.y, i.y, n.y),
			n = Math.max(s.y, t.y, i.y, n.y);
		return cc.rect(r, e, o - r, n - e);
	}),
	(cc._rectApplyAffineTransformIn = function (t, e) {
		var i = cc.rectGetMinY(t),
			n = cc.rectGetMinX(t),
			r = cc.rectGetMaxX(t),
			o = cc.rectGetMaxY(t),
			s = cc.pointApplyAffineTransform(n, i, e),
			c = cc.pointApplyAffineTransform(r, i, e),
			i = cc.pointApplyAffineTransform(n, o, e),
			n = cc.pointApplyAffineTransform(r, o, e),
			r = Math.min(s.x, c.x, i.x, n.x),
			o = Math.max(s.x, c.x, i.x, n.x),
			e = Math.min(s.y, c.y, i.y, n.y),
			n = Math.max(s.y, c.y, i.y, n.y);
		return (t.x = r), (t.y = e), (t.width = o - r), (t.height = n - e), t;
	}),
	(cc.affineTransformTranslate = function (t, e, i) {
		return {
			a: t.a,
			b: t.b,
			c: t.c,
			d: t.d,
			tx: t.tx + t.a * e + t.c * i,
			ty: t.ty + t.b * e + t.d * i,
		};
	}),
	(cc.affineTransformScale = function (t, e, i) {
		return {
			a: t.a * e,
			b: t.b * e,
			c: t.c * i,
			d: t.d * i,
			tx: t.tx,
			ty: t.ty,
		};
	}),
	(cc.affineTransformRotate = function (t, e) {
		var i = Math.sin(e),
			e = Math.cos(e);
		return {
			a: t.a * e + t.c * i,
			b: t.b * e + t.d * i,
			c: t.c * e - t.a * i,
			d: t.d * e - t.b * i,
			tx: t.tx,
			ty: t.ty,
		};
	}),
	(cc.affineTransformConcat = function (t, e) {
		return {
			a: t.a * e.a + t.b * e.c,
			b: t.a * e.b + t.b * e.d,
			c: t.c * e.a + t.d * e.c,
			d: t.c * e.b + t.d * e.d,
			tx: t.tx * e.a + t.ty * e.c + e.tx,
			ty: t.tx * e.b + t.ty * e.d + e.ty,
		};
	}),
	(cc.affineTransformConcatIn = function (t, e) {
		var i = t.a,
			n = t.b,
			r = t.c,
			o = t.d,
			s = t.tx,
			c = t.ty;
		return (
			(t.a = i * e.a + n * e.c),
			(t.b = i * e.b + n * e.d),
			(t.c = r * e.a + o * e.c),
			(t.d = r * e.b + o * e.d),
			(t.tx = s * e.a + c * e.c + e.tx),
			(t.ty = s * e.b + c * e.d + e.ty),
			t
		);
	}),
	(cc.affineTransformEqualToTransform = function (t, e) {
		return (
			t.a === e.a &&
			t.b === e.b &&
			t.c === e.c &&
			t.d === e.d &&
			t.tx === e.tx &&
			t.ty === e.ty
		);
	}),
	(cc.affineTransformInvert = function (t) {
		var e = 1 / (t.a * t.d - t.b * t.c);
		return {
			a: e * t.d,
			b: -e * t.b,
			c: -e * t.c,
			d: e * t.a,
			tx: e * (t.c * t.ty - t.d * t.tx),
			ty: e * (t.b * t.tx - t.a * t.ty),
		};
	}),
	(cc.POINT_EPSILON = parseFloat('1.192092896e-07F')),
	(cc.pNeg = function (t) {
		return cc.p(-t.x, -t.y);
	}),
	(cc.pAdd = function (t, e) {
		return cc.p(t.x + e.x, t.y + e.y);
	}),
	(cc.pSub = function (t, e) {
		return cc.p(t.x - e.x, t.y - e.y);
	}),
	(cc.pMult = function (t, e) {
		return cc.p(t.x * e, t.y * e);
	}),
	(cc.pMidpoint = function (t, e) {
		return cc.pMult(cc.pAdd(t, e), 0.5);
	}),
	(cc.pDot = function (t, e) {
		return t.x * e.x + t.y * e.y;
	}),
	(cc.pCross = function (t, e) {
		return t.x * e.y - t.y * e.x;
	}),
	(cc.pPerp = function (t) {
		return cc.p(-t.y, t.x);
	}),
	(cc.pRPerp = function (t) {
		return cc.p(t.y, -t.x);
	}),
	(cc.pProject = function (t, e) {
		return cc.pMult(e, cc.pDot(t, e) / cc.pDot(e, e));
	}),
	(cc.pRotate = function (t, e) {
		return cc.p(t.x * e.x - t.y * e.y, t.x * e.y + t.y * e.x);
	}),
	(cc.pUnrotate = function (t, e) {
		return cc.p(t.x * e.x + t.y * e.y, t.y * e.x - t.x * e.y);
	}),
	(cc.pLengthSQ = function (t) {
		return cc.pDot(t, t);
	}),
	(cc.pDistanceSQ = function (t, e) {
		return cc.pLengthSQ(cc.pSub(t, e));
	}),
	(cc.pLength = function (t) {
		return Math.sqrt(cc.pLengthSQ(t));
	}),
	(cc.pDistance = function (t, e) {
		return cc.pLength(cc.pSub(t, e));
	}),
	(cc.pNormalize = function (t) {
		var e = cc.pLength(t);
		return 0 === e ? cc.p(t) : cc.pMult(t, 1 / e);
	}),
	(cc.pForAngle = function (t) {
		return cc.p(Math.cos(t), Math.sin(t));
	}),
	(cc.pToAngle = function (t) {
		return Math.atan2(t.y, t.x);
	}),
	(cc.clampf = function (t, e, i) {
		var n;
		return i < e && ((n = e), (e = i), (i = n)), t < e ? e : t < i ? t : i;
	}),
	(cc.pClamp = function (t, e, i) {
		return cc.p(cc.clampf(t.x, e.x, i.x), cc.clampf(t.y, e.y, i.y));
	}),
	(cc.pFromSize = function (t) {
		return cc.p(t.width, t.height);
	}),
	(cc.pCompOp = function (t, e) {
		return cc.p(e(t.x), e(t.y));
	}),
	(cc.pLerp = function (t, e, i) {
		return cc.pAdd(cc.pMult(t, 1 - i), cc.pMult(e, i));
	}),
	(cc.pFuzzyEqual = function (t, e, i) {
		return (
			t.x - i <= e.x && e.x <= t.x + i && t.y - i <= e.y && e.y <= t.y + i
		);
	}),
	(cc.pCompMult = function (t, e) {
		return cc.p(t.x * e.x, t.y * e.y);
	}),
	(cc.pAngleSigned = function (t, e) {
		(t = cc.pNormalize(t)),
			(e = cc.pNormalize(e)),
			(e = Math.atan2(t.x * e.y - t.y * e.x, cc.pDot(t, e)));
		return Math.abs(e) < cc.POINT_EPSILON ? 0 : e;
	}),
	(cc.pAngle = function (t, e) {
		e = Math.acos(cc.pDot(cc.pNormalize(t), cc.pNormalize(e)));
		return Math.abs(e) < cc.POINT_EPSILON ? 0 : e;
	}),
	(cc.pRotateByAngle = function (t, e, i) {
		var n = cc.pSub(t, e),
			r = Math.cos(i),
			t = Math.sin(i),
			i = n.x;
		return (n.x = i * r - n.y * t + e.x), (n.y = i * t + n.y * r + e.y), n;
	}),
	(cc.pLineIntersect = function (t, e, i, n, r) {
		if ((t.x === e.x && t.y === e.y) || (i.x === n.x && i.y === n.y))
			return !1;
		var o = e.x - t.x,
			s = e.y - t.y,
			c = n.x - i.x,
			e = n.y - i.y,
			n = t.x - i.x,
			t = t.y - i.y,
			i = e * o - c * s;
		return (
			(r.x = c * t - e * n),
			(r.y = o * t - s * n),
			0 == i
				? 0 === r.x || 0 === r.y
				: ((r.x = r.x / i), (r.y = r.y / i), !0)
		);
	}),
	(cc.pSegmentIntersect = function (t, e, i, n) {
		var r = cc.p(0, 0);
		return !!(
			cc.pLineIntersect(t, e, i, n, r) &&
			0 <= r.x &&
			r.x <= 1 &&
			0 <= r.y &&
			r.y <= 1
		);
	}),
	(cc.pIntersectPoint = function (t, e, i, n) {
		var r = cc.p(0, 0);
		if (cc.pLineIntersect(t, e, i, n, r)) {
			n = cc.p(0, 0);
			return (
				(n.x = t.x + r.x * (e.x - t.x)),
				(n.y = t.y + r.x * (e.y - t.y)),
				n
			);
		}
		return cc.p(0, 0);
	}),
	(cc.pSameAs = function (t, e) {
		return null != t && null != e && t.x === e.x && t.y === e.y;
	}),
	(cc.pZeroIn = function (t) {
		(t.x = 0), (t.y = 0);
	}),
	(cc.pIn = function (t, e) {
		(t.x = e.x), (t.y = e.y);
	}),
	(cc.pMultIn = function (t, e) {
		(t.x *= e), (t.y *= e);
	}),
	(cc.pSubIn = function (t, e) {
		(t.x -= e.x), (t.y -= e.y);
	}),
	(cc.pAddIn = function (t, e) {
		(t.x += e.x), (t.y += e.y);
	}),
	(cc.pNormalizeIn = function (t) {
		cc.pMultIn(t, 1 / Math.sqrt(t.x * t.x + t.y * t.y));
	}),
	(cc.Touch = cc.Class.extend({
		_point: null,
		_prevPoint: null,
		_id: 0,
		_startPointCaptured: !1,
		_startPoint: null,
		ctor: function (t, e, i) {
			this.setTouchInfo(i, t, e);
		},
		getLocation: function () {
			return { x: this._point.x, y: this._point.y };
		},
		getLocationX: function () {
			return this._point.x;
		},
		getLocationY: function () {
			return this._point.y;
		},
		getPreviousLocation: function () {
			return { x: this._prevPoint.x, y: this._prevPoint.y };
		},
		getStartLocation: function () {
			return { x: this._startPoint.x, y: this._startPoint.y };
		},
		getDelta: function () {
			return cc.pSub(this._point, this._prevPoint);
		},
		getLocationInView: function () {
			return { x: this._point.x, y: this._point.y };
		},
		getPreviousLocationInView: function () {
			return { x: this._prevPoint.x, y: this._prevPoint.y };
		},
		getStartLocationInView: function () {
			return { x: this._startPoint.x, y: this._startPoint.y };
		},
		getID: function () {
			return this._id;
		},
		getId: function () {
			return (
				cc.log('getId is deprecated. Please use getID instead.'),
				this._id
			);
		},
		setTouchInfo: function (t, e, i) {
			(this._prevPoint = this._point),
				(this._point = cc.p(e || 0, i || 0)),
				(this._id = t),
				this._startPointCaptured ||
					((this._startPoint = cc.p(this._point)),
					cc.view._convertPointWithScale(this._startPoint),
					(this._startPointCaptured = !0));
		},
		_setPoint: function (t, e) {
			void 0 === e
				? ((this._point.x = t.x), (this._point.y = t.y))
				: ((this._point.x = t), (this._point.y = e));
		},
		_setPrevPoint: function (t, e) {
			this._prevPoint =
				void 0 === e ? cc.p(t.x, t.y) : cc.p(t || 0, e || 0);
		},
	})),
	(cc.Event = cc.Class.extend({
		_type: 0,
		_isStopped: !1,
		_currentTarget: null,
		_setCurrentTarget: function (t) {
			this._currentTarget = t;
		},
		ctor: function (t) {
			this._type = t;
		},
		getType: function () {
			return this._type;
		},
		stopPropagation: function () {
			this._isStopped = !0;
		},
		isStopped: function () {
			return this._isStopped;
		},
		getCurrentTarget: function () {
			return this._currentTarget;
		},
	})),
	(cc.Event.TOUCH = 0),
	(cc.Event.KEYBOARD = 1),
	(cc.Event.ACCELERATION = 2),
	(cc.Event.MOUSE = 3),
	(cc.Event.FOCUS = 4),
	(cc.Event.CUSTOM = 6),
	(cc.EventCustom = cc.Event.extend({
		_eventName: null,
		_userData: null,
		ctor: function (t) {
			cc.Event.prototype.ctor.call(this, cc.Event.CUSTOM),
				(this._eventName = t);
		},
		setUserData: function (t) {
			this._userData = t;
		},
		getUserData: function () {
			return this._userData;
		},
		getEventName: function () {
			return this._eventName;
		},
	})),
	(cc.EventMouse = cc.Event.extend({
		_eventType: 0,
		_button: 0,
		_x: 0,
		_y: 0,
		_prevX: 0,
		_prevY: 0,
		_scrollX: 0,
		_scrollY: 0,
		ctor: function (t) {
			cc.Event.prototype.ctor.call(this, cc.Event.MOUSE),
				(this._eventType = t);
		},
		setScrollData: function (t, e) {
			(this._scrollX = t), (this._scrollY = e);
		},
		getScrollX: function () {
			return this._scrollX;
		},
		getScrollY: function () {
			return this._scrollY;
		},
		setLocation: function (t, e) {
			(this._x = t), (this._y = e);
		},
		getLocation: function () {
			return { x: this._x, y: this._y };
		},
		getLocationInView: function () {
			return {
				x: this._x,
				y: cc.view._designResolutionSize.height - this._y,
			};
		},
		_setPrevCursor: function (t, e) {
			(this._prevX = t), (this._prevY = e);
		},
		getDelta: function () {
			return { x: this._x - this._prevX, y: this._y - this._prevY };
		},
		getDeltaX: function () {
			return this._x - this._prevX;
		},
		getDeltaY: function () {
			return this._y - this._prevY;
		},
		setButton: function (t) {
			this._button = t;
		},
		getButton: function () {
			return this._button;
		},
		getLocationX: function () {
			return this._x;
		},
		getLocationY: function () {
			return this._y;
		},
	})),
	(cc.EventMouse.NONE = 0),
	(cc.EventMouse.DOWN = 1),
	(cc.EventMouse.UP = 2),
	(cc.EventMouse.MOVE = 3),
	(cc.EventMouse.SCROLL = 4),
	(cc.EventMouse.BUTTON_LEFT = 0),
	(cc.EventMouse.BUTTON_RIGHT = 2),
	(cc.EventMouse.BUTTON_MIDDLE = 1),
	(cc.EventMouse.BUTTON_4 = 3),
	(cc.EventMouse.BUTTON_5 = 4),
	(cc.EventMouse.BUTTON_6 = 5),
	(cc.EventMouse.BUTTON_7 = 6),
	(cc.EventMouse.BUTTON_8 = 7),
	(cc.EventTouch = cc.Event.extend({
		_eventCode: 0,
		_touches: null,
		ctor: function (t) {
			cc.Event.prototype.ctor.call(this, cc.Event.TOUCH),
				(this._touches = t || []);
		},
		getEventCode: function () {
			return this._eventCode;
		},
		getTouches: function () {
			return this._touches;
		},
		_setEventCode: function (t) {
			this._eventCode = t;
		},
		_setTouches: function (t) {
			this._touches = t;
		},
	})),
	(cc.EventTouch.MAX_TOUCHES = 5),
	(cc.EventTouch.EventCode = { BEGAN: 0, MOVED: 1, ENDED: 2, CANCELLED: 3 }),
	(cc.EventFocus = cc.Event.extend({
		_widgetGetFocus: null,
		_widgetLoseFocus: null,
		ctor: function (t, e) {
			cc.Event.prototype.ctor.call(this, cc.Event.FOCUS),
				(this._widgetGetFocus = e),
				(this._widgetLoseFocus = t);
		},
	})),
	(cc.EventListener = cc.Class.extend({
		_onEvent: null,
		_type: 0,
		_listenerID: null,
		_registered: !1,
		_fixedPriority: 0,
		_node: null,
		_paused: !0,
		_isEnabled: !0,
		ctor: function (t, e, i) {
			(this._onEvent = i),
				(this._type = t || 0),
				(this._listenerID = e || '');
		},
		_setPaused: function (t) {
			this._paused = t;
		},
		_isPaused: function () {
			return this._paused;
		},
		_setRegistered: function (t) {
			this._registered = t;
		},
		_isRegistered: function () {
			return this._registered;
		},
		_getType: function () {
			return this._type;
		},
		_getListenerID: function () {
			return this._listenerID;
		},
		_setFixedPriority: function (t) {
			this._fixedPriority = t;
		},
		_getFixedPriority: function () {
			return this._fixedPriority;
		},
		_setSceneGraphPriority: function (t) {
			this._node = t;
		},
		_getSceneGraphPriority: function () {
			return this._node;
		},
		checkAvailable: function () {
			return null !== this._onEvent;
		},
		clone: function () {
			return null;
		},
		setEnabled: function (t) {
			this._isEnabled = t;
		},
		isEnabled: function () {
			return this._isEnabled;
		},
		retain: function () {},
		release: function () {},
	})),
	(cc.EventListener.UNKNOWN = 0),
	(cc.EventListener.TOUCH_ONE_BY_ONE = 1),
	(cc.EventListener.TOUCH_ALL_AT_ONCE = 2),
	(cc.EventListener.KEYBOARD = 3),
	(cc.EventListener.MOUSE = 4),
	(cc.EventListener.ACCELERATION = 6),
	(cc.EventListener.FOCUS = 7),
	(cc.EventListener.CUSTOM = 8),
	(cc._EventListenerCustom = cc.EventListener.extend({
		_onCustomEvent: null,
		ctor: function (t, e) {
			this._onCustomEvent = e;
			var i = this;
			cc.EventListener.prototype.ctor.call(
				this,
				cc.EventListener.CUSTOM,
				t,
				function (t) {
					null !== i._onCustomEvent && i._onCustomEvent(t);
				}
			);
		},
		checkAvailable: function () {
			return (
				cc.EventListener.prototype.checkAvailable.call(this) &&
				null !== this._onCustomEvent
			);
		},
		clone: function () {
			return new cc._EventListenerCustom(
				this._listenerID,
				this._onCustomEvent
			);
		},
	})),
	(cc._EventListenerCustom.create = function (t, e) {
		return new cc._EventListenerCustom(t, e);
	}),
	(cc._EventListenerMouse = cc.EventListener.extend({
		onMouseDown: null,
		onMouseUp: null,
		onMouseMove: null,
		onMouseScroll: null,
		ctor: function () {
			var i = this;
			cc.EventListener.prototype.ctor.call(
				this,
				cc.EventListener.MOUSE,
				cc._EventListenerMouse.LISTENER_ID,
				function (t) {
					var e = cc.EventMouse;
					switch (t._eventType) {
						case e.DOWN:
							i.onMouseDown && i.onMouseDown(t);
							break;
						case e.UP:
							i.onMouseUp && i.onMouseUp(t);
							break;
						case e.MOVE:
							i.onMouseMove && i.onMouseMove(t);
							break;
						case e.SCROLL:
							i.onMouseScroll && i.onMouseScroll(t);
					}
				}
			);
		},
		clone: function () {
			var t = new cc._EventListenerMouse();
			return (
				(t.onMouseDown = this.onMouseDown),
				(t.onMouseUp = this.onMouseUp),
				(t.onMouseMove = this.onMouseMove),
				(t.onMouseScroll = this.onMouseScroll),
				t
			);
		},
		checkAvailable: function () {
			return !0;
		},
	})),
	(cc._EventListenerMouse.LISTENER_ID = '__cc_mouse'),
	(cc._EventListenerMouse.create = function () {
		return new cc._EventListenerMouse();
	}),
	(cc._EventListenerTouchOneByOne = cc.EventListener.extend({
		_claimedTouches: null,
		swallowTouches: !1,
		onTouchBegan: null,
		onTouchMoved: null,
		onTouchEnded: null,
		onTouchCancelled: null,
		ctor: function () {
			cc.EventListener.prototype.ctor.call(
				this,
				cc.EventListener.TOUCH_ONE_BY_ONE,
				cc._EventListenerTouchOneByOne.LISTENER_ID,
				null
			),
				(this._claimedTouches = []);
		},
		setSwallowTouches: function (t) {
			this.swallowTouches = t;
		},
		isSwallowTouches: function () {
			return this.swallowTouches;
		},
		clone: function () {
			var t = new cc._EventListenerTouchOneByOne();
			return (
				(t.onTouchBegan = this.onTouchBegan),
				(t.onTouchMoved = this.onTouchMoved),
				(t.onTouchEnded = this.onTouchEnded),
				(t.onTouchCancelled = this.onTouchCancelled),
				(t.swallowTouches = this.swallowTouches),
				t
			);
		},
		checkAvailable: function () {
			return (
				!!this.onTouchBegan ||
				(cc.log(
					cc._LogInfos._EventListenerTouchOneByOne_checkAvailable
				),
				!1)
			);
		},
	})),
	(cc._EventListenerTouchOneByOne.LISTENER_ID = '__cc_touch_one_by_one'),
	(cc._EventListenerTouchOneByOne.create = function () {
		return new cc._EventListenerTouchOneByOne();
	}),
	(cc._EventListenerTouchAllAtOnce = cc.EventListener.extend({
		onTouchesBegan: null,
		onTouchesMoved: null,
		onTouchesEnded: null,
		onTouchesCancelled: null,
		ctor: function () {
			cc.EventListener.prototype.ctor.call(
				this,
				cc.EventListener.TOUCH_ALL_AT_ONCE,
				cc._EventListenerTouchAllAtOnce.LISTENER_ID,
				null
			);
		},
		clone: function () {
			var t = new cc._EventListenerTouchAllAtOnce();
			return (
				(t.onTouchesBegan = this.onTouchesBegan),
				(t.onTouchesMoved = this.onTouchesMoved),
				(t.onTouchesEnded = this.onTouchesEnded),
				(t.onTouchesCancelled = this.onTouchesCancelled),
				t
			);
		},
		checkAvailable: function () {
			return (
				null !== this.onTouchesBegan ||
				null !== this.onTouchesMoved ||
				null !== this.onTouchesEnded ||
				null !== this.onTouchesCancelled ||
				(cc.log(
					cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable
				),
				!1)
			);
		},
	})),
	(cc._EventListenerTouchAllAtOnce.LISTENER_ID = '__cc_touch_all_at_once'),
	(cc._EventListenerTouchAllAtOnce.create = function () {
		return new cc._EventListenerTouchAllAtOnce();
	}),
	(cc.EventListener.create = function (t) {
		cc.assert(t && t.event, cc._LogInfos.EventListener_create);
		var e = t.event;
		delete t.event;
		var i,
			n = null;
		for (i in (e === cc.EventListener.TOUCH_ONE_BY_ONE
			? (n = new cc._EventListenerTouchOneByOne())
			: e === cc.EventListener.TOUCH_ALL_AT_ONCE
			? (n = new cc._EventListenerTouchAllAtOnce())
			: e === cc.EventListener.MOUSE
			? (n = new cc._EventListenerMouse())
			: e === cc.EventListener.CUSTOM
			? ((n = new cc._EventListenerCustom(t.eventName, t.callback)),
			  delete t.eventName,
			  delete t.callback)
			: e === cc.EventListener.KEYBOARD
			? (n = new cc._EventListenerKeyboard())
			: e === cc.EventListener.ACCELERATION
			? ((n = new cc._EventListenerAcceleration(t.callback)),
			  delete t.callback)
			: e === cc.EventListener.FOCUS &&
			  (n = new cc._EventListenerFocus()),
		t))
			n[i] = t[i];
		return n;
	}),
	(cc._EventListenerFocus = cc.EventListener.extend({
		clone: function () {
			var t = new cc._EventListenerFocus();
			return (t.onFocusChanged = this.onFocusChanged), t;
		},
		checkAvailable: function () {
			return (
				!!this.onFocusChanged ||
				(cc.log('Invalid EventListenerFocus!'), !1)
			);
		},
		onFocusChanged: null,
		ctor: function () {
			cc.EventListener.prototype.ctor.call(
				this,
				cc.EventListener.FOCUS,
				cc._EventListenerFocus.LISTENER_ID,
				function (t) {
					this.onFocusChanged &&
						this.onFocusChanged(
							t._widgetLoseFocus,
							t._widgetGetFocus
						);
				}
			);
		},
	})),
	(cc._EventListenerFocus.LISTENER_ID = '__cc_focus_event'),
	(cc._EventListenerVector = cc.Class.extend({
		_fixedListeners: null,
		_sceneGraphListeners: null,
		gt0Index: 0,
		ctor: function () {
			(this._fixedListeners = []), (this._sceneGraphListeners = []);
		},
		size: function () {
			return (
				this._fixedListeners.length + this._sceneGraphListeners.length
			);
		},
		empty: function () {
			return (
				0 === this._fixedListeners.length &&
				0 === this._sceneGraphListeners.length
			);
		},
		push: function (t) {
			(0 === t._getFixedPriority()
				? this._sceneGraphListeners
				: this._fixedListeners
			).push(t);
		},
		clearSceneGraphListeners: function () {
			this._sceneGraphListeners.length = 0;
		},
		clearFixedListeners: function () {
			this._fixedListeners.length = 0;
		},
		clear: function () {
			(this._sceneGraphListeners.length = 0),
				(this._fixedListeners.length = 0);
		},
		getFixedPriorityListeners: function () {
			return this._fixedListeners;
		},
		getSceneGraphPriorityListeners: function () {
			return this._sceneGraphListeners;
		},
	})),
	(cc.__getListenerID = function (t) {
		var e = cc.Event,
			i = t.getType();
		return i === e.ACCELERATION
			? cc._EventListenerAcceleration.LISTENER_ID
			: i === e.CUSTOM
			? t.getEventName()
			: i === e.KEYBOARD
			? cc._EventListenerKeyboard.LISTENER_ID
			: i === e.MOUSE
			? cc._EventListenerMouse.LISTENER_ID
			: i === e.FOCUS
			? cc._EventListenerFocus.LISTENER_ID
			: (i === e.TOUCH && cc.log(cc._LogInfos.__getListenerID), '');
	}),
	(cc.eventManager = {
		DIRTY_NONE: 0,
		DIRTY_FIXED_PRIORITY: 1,
		DIRTY_SCENE_GRAPH_PRIORITY: 2,
		DIRTY_ALL: 3,
		_listenersMap: {},
		_priorityDirtyFlagMap: {},
		_nodeListenersMap: {},
		_nodePriorityMap: {},
		_globalZOrderNodeMap: {},
		_toAddedListeners: [],
		_toRemovedListeners: [],
		_dirtyNodes: [],
		_inDispatch: 0,
		_isEnabled: !1,
		_nodePriorityIndex: 0,
		_internalCustomListenerIDs: [cc.game.EVENT_HIDE, cc.game.EVENT_SHOW],
		_setDirtyForNode: function (t) {
			null != this._nodeListenersMap[t.__instanceId] &&
				this._dirtyNodes.push(t);
			for (var e = t.getChildren(), i = 0, n = e.length; i < n; i++)
				this._setDirtyForNode(e[i]);
		},
		pauseTarget: function (t, e) {
			var i = this._nodeListenersMap[t.__instanceId];
			if (i) for (r = 0, o = i.length; r < o; r++) i[r]._setPaused(!0);
			if (!0 === e)
				for (var n = t.getChildren(), r = 0, o = n.length; r < o; r++)
					this.pauseTarget(n[r], !0);
		},
		resumeTarget: function (t, e) {
			var i = this._nodeListenersMap[t.__instanceId];
			if (i) for (r = 0, o = i.length; r < o; r++) i[r]._setPaused(!1);
			if ((this._setDirtyForNode(t), !0 === e))
				for (var n = t.getChildren(), r = 0, o = n.length; r < o; r++)
					this.resumeTarget(n[r], !0);
		},
		_addListener: function (t) {
			0 === this._inDispatch
				? this._forceAddEventListener(t)
				: this._toAddedListeners.push(t);
		},
		_forceAddEventListener: function (t) {
			var e = t._getListenerID(),
				i = this._listenersMap[e];
			i ||
				((i = new cc._EventListenerVector()),
				(this._listenersMap[e] = i)),
				i.push(t),
				0 === t._getFixedPriority()
					? (this._setDirty(e, this.DIRTY_SCENE_GRAPH_PRIORITY),
					  null === (i = t._getSceneGraphPriority()) &&
							cc.log(
								cc._LogInfos.eventManager__forceAddEventListener
							),
					  this._associateNodeAndEventListener(i, t),
					  i.isRunning() && this.resumeTarget(i))
					: this._setDirty(e, this.DIRTY_FIXED_PRIORITY);
		},
		_getListeners: function (t) {
			return this._listenersMap[t];
		},
		_updateDirtyFlagForSceneGraph: function () {
			if (0 !== this._dirtyNodes.length) {
				for (
					var t,
						e,
						i = this._dirtyNodes,
						n = this._nodeListenersMap,
						r = 0,
						o = i.length;
					r < o;
					r++
				)
					if ((t = n[i[r].__instanceId]))
						for (var s = 0, c = t.length; s < c; s++)
							(e = t[s]) &&
								this._setDirty(
									e._getListenerID(),
									this.DIRTY_SCENE_GRAPH_PRIORITY
								);
				this._dirtyNodes.length = 0;
			}
		},
		_removeAllListenersInVector: function (t) {
			if (t)
				for (var e, i = 0; i < t.length; )
					(e = t[i])._setRegistered(!1),
						null != e._getSceneGraphPriority() &&
							(this._dissociateNodeAndEventListener(
								e._getSceneGraphPriority(),
								e
							),
							e._setSceneGraphPriority(null)),
						0 === this._inDispatch
							? cc.arrayRemoveObject(t, e)
							: ++i;
		},
		_removeListenersForListenerID: function (t) {
			var e,
				i,
				n = this._listenersMap[t];
			n &&
				((e = n.getFixedPriorityListeners()),
				(i = n.getSceneGraphPriorityListeners()),
				this._removeAllListenersInVector(i),
				this._removeAllListenersInVector(e),
				delete this._priorityDirtyFlagMap[t],
				this._inDispatch || (n.clear(), delete this._listenersMap[t]));
			for (var r, o = this._toAddedListeners, s = 0; s < o.length; )
				(r = o[s]) && r._getListenerID() === t
					? cc.arrayRemoveObject(o, r)
					: ++s;
		},
		_sortEventListeners: function (t) {
			var e = this.DIRTY_NONE,
				i = this._priorityDirtyFlagMap;
			i[t] && (e = i[t]),
				e !== this.DIRTY_NONE &&
					((i[t] = this.DIRTY_NONE),
					e & this.DIRTY_FIXED_PRIORITY &&
						this._sortListenersOfFixedPriority(t),
					e & this.DIRTY_SCENE_GRAPH_PRIORITY &&
						((e = cc.director.getRunningScene())
							? this._sortListenersOfSceneGraphPriority(t, e)
							: (i[t] = this.DIRTY_SCENE_GRAPH_PRIORITY)));
		},
		_sortListenersOfSceneGraphPriority: function (t, e) {
			var i = this._getListeners(t);
			!i ||
				((t = i.getSceneGraphPriorityListeners()) &&
					0 !== t.length &&
					((this._nodePriorityIndex = 0),
					(this._nodePriorityMap = {}),
					this._visitTarget(e, !0),
					i
						.getSceneGraphPriorityListeners()
						.sort(
							this._sortEventListenersOfSceneGraphPriorityDes
						)));
		},
		_sortEventListenersOfSceneGraphPriorityDes: function (t, e) {
			var i = cc.eventManager._nodePriorityMap,
				n = t._getSceneGraphPriority(),
				r = e._getSceneGraphPriority();
			return e && r && i[r.__instanceId]
				? t && n && i[n.__instanceId]
					? i[e._getSceneGraphPriority().__instanceId] -
					  i[t._getSceneGraphPriority().__instanceId]
					: 1
				: -1;
		},
		_sortListenersOfFixedPriority: function (t) {
			t = this._listenersMap[t];
			if (t) {
				var e = t.getFixedPriorityListeners();
				if (e && 0 !== e.length) {
					e.sort(this._sortListenersOfFixedPriorityAsc);
					for (
						var i = 0, n = e.length;
						i < n && !(0 <= e[i]._getFixedPriority());

					)
						++i;
					t.gt0Index = i;
				}
			}
		},
		_sortListenersOfFixedPriorityAsc: function (t, e) {
			return t._getFixedPriority() - e._getFixedPriority();
		},
		_onUpdateListeners: function (t) {
			t = this._listenersMap[t];
			if (t) {
				var e,
					i,
					n,
					r = t.getFixedPriorityListeners(),
					o = t.getSceneGraphPriorityListeners(),
					s = this._toRemovedListeners;
				if (o)
					for (e = 0; e < o.length; )
						(i = o[e])._isRegistered()
							? ++e
							: (cc.arrayRemoveObject(o, i),
							  -1 !== (n = s.indexOf(i)) && s.splice(n, 1));
				if (r)
					for (e = 0; e < r.length; )
						(i = r[e])._isRegistered()
							? ++e
							: (cc.arrayRemoveObject(r, i),
							  -1 !== (n = s.indexOf(i)) && s.splice(n, 1));
				o && 0 === o.length && t.clearSceneGraphListeners(),
					r && 0 === r.length && t.clearFixedListeners();
			}
		},
		_updateListeners: function (t) {
			var e = this._inDispatch;
			if (
				(cc.assert(0 < e, cc._LogInfos.EventManager__updateListeners),
				!(1 < e))
			) {
				t.getType() === cc.Event.TOUCH
					? (this._onUpdateListeners(
							cc._EventListenerTouchOneByOne.LISTENER_ID
					  ),
					  this._onUpdateListeners(
							cc._EventListenerTouchAllAtOnce.LISTENER_ID
					  ))
					: this._onUpdateListeners(cc.__getListenerID(t)),
					cc.assert(
						1 === e,
						cc._LogInfos.EventManager__updateListeners_2
					);
				var i,
					n = this._listenersMap,
					r = this._priorityDirtyFlagMap;
				for (i in n) n[i].empty() && (delete r[i], delete n[i]);
				var o = this._toAddedListeners;
				if (0 !== o.length) {
					for (var s = 0, c = o.length; s < c; s++)
						this._forceAddEventListener(o[s]);
					this._toAddedListeners.length = 0;
				}
				0 !== this._toRemovedListeners.length &&
					this._cleanToRemovedListeners();
			}
		},
		_cleanToRemovedListeners: function () {
			for (var t = this._toRemovedListeners, e = 0; e < t.length; e++) {
				var i,
					n,
					r = t[e],
					o = this._listenersMap[r._getListenerID()];
				o &&
					((n = o.getFixedPriorityListeners()),
					(o = o.getSceneGraphPriorityListeners()) &&
						-1 !== (i = o.indexOf(r)) &&
						o.splice(i, 1),
					n && -1 !== (i = n.indexOf(r)) && n.splice(i, 1));
			}
			t.length = 0;
		},
		_onTouchEventCallback: function (t, e) {
			if (!t._isRegistered) return !1;
			var i = e.event,
				n = e.selTouch;
			i._setCurrentTarget(t._node);
			var r,
				o = !1,
				s = i.getEventCode(),
				c = cc.EventTouch.EventCode;
			return (
				s === c.BEGAN
					? t.onTouchBegan &&
					  (o = t.onTouchBegan(n, i)) &&
					  t._registered &&
					  t._claimedTouches.push(n)
					: 0 < t._claimedTouches.length &&
					  -1 !== (r = t._claimedTouches.indexOf(n)) &&
					  ((o = !0),
					  s === c.MOVED && t.onTouchMoved
							? t.onTouchMoved(n, i)
							: s === c.ENDED
							? (t.onTouchEnded && t.onTouchEnded(n, i),
							  t._registered && t._claimedTouches.splice(r, 1))
							: s === c.CANCELLED &&
							  (t.onTouchCancelled && t.onTouchCancelled(n, i),
							  t._registered && t._claimedTouches.splice(r, 1))),
				i.isStopped()
					? (cc.eventManager._updateListeners(i), !0)
					: !!(o && t._registered && t.swallowTouches) &&
					  (e.needsMutableSet && e.touches.splice(n, 1), !0)
			);
		},
		_dispatchTouchEvent: function (t) {
			this._sortEventListeners(
				cc._EventListenerTouchOneByOne.LISTENER_ID
			),
				this._sortEventListeners(
					cc._EventListenerTouchAllAtOnce.LISTENER_ID
				);
			var e = this._getListeners(
					cc._EventListenerTouchOneByOne.LISTENER_ID
				),
				i = this._getListeners(
					cc._EventListenerTouchAllAtOnce.LISTENER_ID
				);
			if (null !== e || null !== i) {
				var n = t.getTouches(),
					r = cc.copyArray(n),
					o = {
						event: t,
						needsMutableSet: e && i,
						touches: r,
						selTouch: null,
					};
				if (e)
					for (var s = 0; s < n.length; s++)
						if (
							((o.selTouch = n[s]),
							this._dispatchEventToListeners(
								e,
								this._onTouchEventCallback,
								o
							),
							t.isStopped())
						)
							return;
				(i &&
					0 < r.length &&
					(this._dispatchEventToListeners(
						i,
						this._onTouchesEventCallback,
						{ event: t, touches: r }
					),
					t.isStopped())) ||
					this._updateListeners(t);
			}
		},
		_onTouchesEventCallback: function (t, e) {
			if (!t._registered) return !1;
			var i = cc.EventTouch.EventCode,
				n = e.event,
				r = e.touches,
				e = n.getEventCode();
			return (
				n._setCurrentTarget(t._node),
				e === i.BEGAN && t.onTouchesBegan
					? t.onTouchesBegan(r, n)
					: e === i.MOVED && t.onTouchesMoved
					? t.onTouchesMoved(r, n)
					: e === i.ENDED && t.onTouchesEnded
					? t.onTouchesEnded(r, n)
					: e === i.CANCELLED &&
					  t.onTouchesCancelled &&
					  t.onTouchesCancelled(r, n),
				!!n.isStopped() && (cc.eventManager._updateListeners(n), !0)
			);
		},
		_associateNodeAndEventListener: function (t, e) {
			var i = this._nodeListenersMap[t.__instanceId];
			i || ((i = []), (this._nodeListenersMap[t.__instanceId] = i)),
				i.push(e);
		},
		_dissociateNodeAndEventListener: function (t, e) {
			var i = this._nodeListenersMap[t.__instanceId];
			i &&
				(cc.arrayRemoveObject(i, e),
				0 === i.length &&
					delete this._nodeListenersMap[t.__instanceId]);
		},
		_dispatchEventToListeners: function (t, e, i) {
			var n,
				r,
				o = !1,
				s = t.getFixedPriorityListeners(),
				c = t.getSceneGraphPriorityListeners(),
				a = 0;
			if (s && 0 !== s.length)
				for (; a < t.gt0Index; ++a)
					if (
						(r = s[a]).isEnabled() &&
						!r._isPaused() &&
						r._isRegistered() &&
						e(r, i)
					) {
						o = !0;
						break;
					}
			if (c && !o)
				for (n = 0; n < c.length; n++)
					if (
						(r = c[n]).isEnabled() &&
						!r._isPaused() &&
						r._isRegistered() &&
						e(r, i)
					) {
						o = !0;
						break;
					}
			if (s && !o)
				for (; a < s.length; ++a)
					if (
						(r = s[a]).isEnabled() &&
						!r._isPaused() &&
						r._isRegistered() &&
						e(r, i)
					) {
						o = !0;
						break;
					}
		},
		_setDirty: function (t, e) {
			var i = this._priorityDirtyFlagMap;
			null == i[t] ? (i[t] = e) : (i[t] = e | i[t]);
		},
		_visitTarget: function (t, e) {
			var i,
				n = t.getChildren(),
				r = 0,
				o = n.length,
				s = this._globalZOrderNodeMap,
				c = this._nodeListenersMap;
			if (0 < o) {
				for (; r < o && (i = n[r]) && i.getLocalZOrder() < 0; r++)
					this._visitTarget(i, !1);
				for (
					null != c[t.__instanceId] &&
					(s[t.getGlobalZOrder()] || (s[t.getGlobalZOrder()] = []),
					s[t.getGlobalZOrder()].push(t.__instanceId));
					r < o;
					r++
				)
					(i = n[r]) && this._visitTarget(i, !1);
			} else
				null != c[t.__instanceId] &&
					(s[t.getGlobalZOrder()] || (s[t.getGlobalZOrder()] = []),
					s[t.getGlobalZOrder()].push(t.__instanceId));
			if (e) {
				var a,
					l = [];
				for (a in s) l.push(a);
				l.sort(this._sortNumberAsc);
				for (
					var h, u, _ = l.length, d = this._nodePriorityMap, r = 0;
					r < _;
					r++
				)
					for (h = s[l[r]], u = 0; u < h.length; u++)
						d[h[u]] = ++this._nodePriorityIndex;
				this._globalZOrderNodeMap = {};
			}
		},
		_sortNumberAsc: function (t, e) {
			return t - e;
		},
		addListener: function (t, e) {
			if (
				(cc.assert(t && e, cc._LogInfos.eventManager_addListener_2),
				t instanceof cc.EventListener)
			) {
				if (t._isRegistered())
					return void cc.log(cc._LogInfos.eventManager_addListener_4);
			} else
				cc.assert(
					!cc.isNumber(e),
					cc._LogInfos.eventManager_addListener_3
				),
					(t = cc.EventListener.create(t));
			if (t.checkAvailable()) {
				if (cc.isNumber(e)) {
					if (0 === e)
						return void cc.log(
							cc._LogInfos.eventManager_addListener
						);
					t._setSceneGraphPriority(null),
						t._setFixedPriority(e),
						t._setRegistered(!0),
						t._setPaused(!1),
						this._addListener(t);
				} else
					t._setSceneGraphPriority(e),
						t._setFixedPriority(0),
						t._setRegistered(!0),
						this._addListener(t);
				return t;
			}
		},
		addCustomListener: function (t, e) {
			e = new cc._EventListenerCustom(t, e);
			return this.addListener(e, 1), e;
		},
		removeListener: function (t) {
			if (null != t) {
				var e,
					i = this._listenersMap;
				for (e in i) {
					var n,
						r = i[e],
						o = r.getFixedPriorityListeners(),
						s = r.getSceneGraphPriorityListeners();
					if (
						((n = this._removeListenerInVector(s, t))
							? this._setDirty(
									t._getListenerID(),
									this.DIRTY_SCENE_GRAPH_PRIORITY
							  )
							: (n = this._removeListenerInVector(o, t)) &&
							  this._setDirty(
									t._getListenerID(),
									this.DIRTY_FIXED_PRIORITY
							  ),
						r.empty() &&
							(delete this._priorityDirtyFlagMap[
								t._getListenerID()
							],
							delete i[e]),
						n)
					)
						break;
				}
				if (!n)
					for (
						var c = this._toAddedListeners, a = 0, l = c.length;
						a < l;
						a++
					) {
						var h = c[a];
						if (h === t) {
							cc.arrayRemoveObject(c, h), h._setRegistered(!1);
							break;
						}
					}
			}
		},
		_removeListenerInCallback: function (t, e) {
			if (null == t) return !1;
			for (var i = 0, n = t.length; i < n; i++) {
				var r = t[i];
				if (r._onCustomEvent === e || r._onEvent === e)
					return (
						r._setRegistered(!1),
						null != r._getSceneGraphPriority() &&
							(this._dissociateNodeAndEventListener(
								r._getSceneGraphPriority(),
								r
							),
							r._setSceneGraphPriority(null)),
						0 === this._inDispatch && cc.arrayRemoveObject(t, r),
						!0
					);
			}
			return !1;
		},
		_removeListenerInVector: function (t, e) {
			if (null == t) return !1;
			for (var i = 0, n = t.length; i < n; i++) {
				var r = t[i];
				if (r === e)
					return (
						r._setRegistered(!1),
						null != r._getSceneGraphPriority() &&
							(this._dissociateNodeAndEventListener(
								r._getSceneGraphPriority(),
								r
							),
							r._setSceneGraphPriority(null)),
						0 === this._inDispatch
							? cc.arrayRemoveObject(t, r)
							: this._toRemovedListeners.push(r),
						!0
					);
			}
			return !1;
		},
		removeListeners: function (t, e) {
			var i = this;
			if (t instanceof cc.Node) {
				delete i._nodePriorityMap[t.__instanceId],
					cc.arrayRemoveObject(i._dirtyNodes, t);
				var n = i._nodeListenersMap[t.__instanceId];
				if (n) {
					for (var r = cc.copyArray(n), o = 0; o < r.length; o++)
						i.removeListener(r[o]);
					r.length = 0;
				}
				var s = i._toAddedListeners;
				for (o = 0; o < s.length; ) {
					var c = s[o];
					c._getSceneGraphPriority() === t
						? (c._setSceneGraphPriority(null),
						  c._setRegistered(!1),
						  s.splice(o, 1))
						: ++o;
				}
				if (!0 === e) {
					var a,
						l = t.getChildren();
					for (o = 0, a = l.length; o < a; o++)
						i.removeListeners(l[o], !0);
				}
			} else
				t === cc.EventListener.TOUCH_ONE_BY_ONE
					? i._removeListenersForListenerID(
							cc._EventListenerTouchOneByOne.LISTENER_ID
					  )
					: t === cc.EventListener.TOUCH_ALL_AT_ONCE
					? i._removeListenersForListenerID(
							cc._EventListenerTouchAllAtOnce.LISTENER_ID
					  )
					: t === cc.EventListener.MOUSE
					? i._removeListenersForListenerID(
							cc._EventListenerMouse.LISTENER_ID
					  )
					: t === cc.EventListener.ACCELERATION
					? i._removeListenersForListenerID(
							cc._EventListenerAcceleration.LISTENER_ID
					  )
					: t === cc.EventListener.KEYBOARD
					? i._removeListenersForListenerID(
							cc._EventListenerKeyboard.LISTENER_ID
					  )
					: cc.log(cc._LogInfos.eventManager_removeListeners);
		},
		removeCustomListeners: function (t) {
			this._removeListenersForListenerID(t);
		},
		removeAllListeners: function () {
			var t,
				e = this._listenersMap,
				i = this._internalCustomListenerIDs;
			for (t in e)
				-1 === i.indexOf(t) && this._removeListenersForListenerID(t);
		},
		setPriority: function (t, e) {
			if (null != t) {
				var i,
					n = this._listenersMap;
				for (i in n) {
					var r = n[i].getFixedPriorityListeners();
					if (r)
						if (-1 !== r.indexOf(t))
							return (
								null != t._getSceneGraphPriority() &&
									cc.log(
										cc._LogInfos.eventManager_setPriority
									),
								void (
									t._getFixedPriority() !== e &&
									(t._setFixedPriority(e),
									this._setDirty(
										t._getListenerID(),
										this.DIRTY_FIXED_PRIORITY
									))
								)
							);
				}
			}
		},
		setEnabled: function (t) {
			this._isEnabled = t;
		},
		isEnabled: function () {
			return this._isEnabled;
		},
		dispatchEvent: function (t) {
			if (this._isEnabled) {
				if (
					(this._updateDirtyFlagForSceneGraph(),
					this._inDispatch++,
					!t || !t.getType)
				)
					throw new Error('event is undefined');
				if (t.getType() === cc.Event.TOUCH)
					return this._dispatchTouchEvent(t), void this._inDispatch--;
				var e = cc.__getListenerID(t);
				this._sortEventListeners(e);
				e = this._listenersMap[e];
				null != e &&
					this._dispatchEventToListeners(
						e,
						this._onListenerCallback,
						t
					),
					this._updateListeners(t),
					this._inDispatch--;
			}
		},
		_onListenerCallback: function (t, e) {
			return (
				e._setCurrentTarget(t._getSceneGraphPriority()),
				t._onEvent(e),
				e.isStopped()
			);
		},
		dispatchCustomEvent: function (t, e) {
			t = new cc.EventCustom(t);
			t.setUserData(e), this.dispatchEvent(t);
		},
	}),
	(cc._tmp.PrototypeCCNode = function () {
		var t = cc.Node.prototype;
		cc.defineGetterSetter(t, 'x', t.getPositionX, t.setPositionX),
			cc.defineGetterSetter(t, 'y', t.getPositionY, t.setPositionY),
			t.width,
			cc.defineGetterSetter(t, 'width', t._getWidth, t._setWidth),
			t.height,
			cc.defineGetterSetter(t, 'height', t._getHeight, t._setHeight),
			t.anchorX,
			cc.defineGetterSetter(t, 'anchorX', t._getAnchorX, t._setAnchorX),
			t.anchorY,
			cc.defineGetterSetter(t, 'anchorY', t._getAnchorY, t._setAnchorY),
			t.skewX,
			cc.defineGetterSetter(t, 'skewX', t.getSkewX, t.setSkewX),
			t.skewY,
			cc.defineGetterSetter(t, 'skewY', t.getSkewY, t.setSkewY),
			t.zIndex,
			cc.defineGetterSetter(
				t,
				'zIndex',
				t.getLocalZOrder,
				t.setLocalZOrder
			),
			t.vertexZ,
			cc.defineGetterSetter(t, 'vertexZ', t.getVertexZ, t.setVertexZ),
			t.rotation,
			cc.defineGetterSetter(t, 'rotation', t.getRotation, t.setRotation),
			t.rotationX,
			cc.defineGetterSetter(
				t,
				'rotationX',
				t.getRotationX,
				t.setRotationX
			),
			t.rotationY,
			cc.defineGetterSetter(
				t,
				'rotationY',
				t.getRotationY,
				t.setRotationY
			),
			t.scale,
			cc.defineGetterSetter(t, 'scale', t.getScale, t.setScale),
			t.scaleX,
			cc.defineGetterSetter(t, 'scaleX', t.getScaleX, t.setScaleX),
			t.scaleY,
			cc.defineGetterSetter(t, 'scaleY', t.getScaleY, t.setScaleY),
			t.children,
			cc.defineGetterSetter(t, 'children', t.getChildren),
			t.childrenCount,
			cc.defineGetterSetter(t, 'childrenCount', t.getChildrenCount),
			t.parent,
			cc.defineGetterSetter(t, 'parent', t.getParent, t.setParent),
			t.visible,
			cc.defineGetterSetter(t, 'visible', t.isVisible, t.setVisible),
			t.running,
			cc.defineGetterSetter(t, 'running', t.isRunning),
			t.ignoreAnchor,
			cc.defineGetterSetter(
				t,
				'ignoreAnchor',
				t.isIgnoreAnchorPointForPosition,
				t.ignoreAnchorPointForPosition
			),
			t.tag,
			t.userData,
			t.userObject,
			t.arrivalOrder,
			t.actionManager,
			cc.defineGetterSetter(
				t,
				'actionManager',
				t.getActionManager,
				t.setActionManager
			),
			t.scheduler,
			cc.defineGetterSetter(
				t,
				'scheduler',
				t.getScheduler,
				t.setScheduler
			),
			t.shaderProgram,
			cc.defineGetterSetter(
				t,
				'shaderProgram',
				t.getShaderProgram,
				t.setShaderProgram
			),
			t.opacity,
			cc.defineGetterSetter(t, 'opacity', t.getOpacity, t.setOpacity),
			t.opacityModifyRGB,
			cc.defineGetterSetter(t, 'opacityModifyRGB', t.isOpacityModifyRGB),
			t.cascadeOpacity,
			cc.defineGetterSetter(
				t,
				'cascadeOpacity',
				t.isCascadeOpacityEnabled,
				t.setCascadeOpacityEnabled
			),
			t.color,
			cc.defineGetterSetter(t, 'color', t.getColor, t.setColor),
			t.cascadeColor,
			cc.defineGetterSetter(
				t,
				'cascadeColor',
				t.isCascadeColorEnabled,
				t.setCascadeColorEnabled
			);
	}),
	(cc.NODE_TAG_INVALID = -1),
	(cc.s_globalOrderOfArrival = 1),
	(cc.Node = cc.Class.extend({
		_localZOrder: 0,
		_globalZOrder: 0,
		_vertexZ: 0,
		_customZ: NaN,
		_rotationX: 0,
		_rotationY: 0,
		_scaleX: 1,
		_scaleY: 1,
		_position: null,
		_normalizedPosition: null,
		_usingNormalizedPosition: !1,
		_normalizedPositionDirty: !1,
		_skewX: 0,
		_skewY: 0,
		_children: null,
		_visible: !0,
		_anchorPoint: null,
		_contentSize: null,
		_running: !1,
		_parent: null,
		_ignoreAnchorPointForPosition: !1,
		tag: cc.NODE_TAG_INVALID,
		userData: null,
		userObject: null,
		_reorderChildDirty: !1,
		_shaderProgram: null,
		arrivalOrder: 0,
		_actionManager: null,
		_scheduler: null,
		_eventDispatcher: null,
		_additionalTransformDirty: !1,
		_additionalTransform: null,
		_componentContainer: null,
		_isTransitionFinished: !1,
		_className: 'Node',
		_showNode: !1,
		_name: '',
		_realOpacity: 255,
		_realColor: null,
		_cascadeColorEnabled: !1,
		_cascadeOpacityEnabled: !1,
		_renderCmd: null,
		ctor: function () {
			this._initNode(), this._initRendererCmd();
		},
		_initNode: function () {
			var t = this;
			(t._anchorPoint = cc.p(0, 0)),
				(t._contentSize = cc.size(0, 0)),
				(t._position = cc.p(0, 0)),
				(t._normalizedPosition = cc.p(0, 0)),
				(t._children = []);
			var e = cc.director;
			(t._actionManager = e.getActionManager()),
				(t._scheduler = e.getScheduler()),
				(t._additionalTransform = cc.affineTransformMakeIdentity()),
				cc.ComponentContainer &&
					(t._componentContainer = new cc.ComponentContainer(t)),
				(this._realOpacity = 255),
				(this._realColor = cc.color(255, 255, 255, 255)),
				(this._cascadeColorEnabled = !1),
				(this._cascadeOpacityEnabled = !1);
		},
		init: function () {
			return !0;
		},
		_arrayMakeObjectsPerformSelector: function (t, e) {
			if (t && 0 !== t.length) {
				var i,
					n,
					r = t.length,
					o = cc.Node._stateCallbackType;
				switch (e) {
					case o.onEnter:
						for (i = 0; i < r; i++) (n = t[i]) && n.onEnter();
						break;
					case o.onExit:
						for (i = 0; i < r; i++) (n = t[i]) && n.onExit();
						break;
					case o.onEnterTransitionDidFinish:
						for (i = 0; i < r; i++)
							(n = t[i]) && n.onEnterTransitionDidFinish();
						break;
					case o.cleanup:
						for (i = 0; i < r; i++) (n = t[i]) && n.cleanup();
						break;
					case o.updateTransform:
						for (i = 0; i < r; i++)
							(n = t[i]) && n.updateTransform();
						break;
					case o.onExitTransitionDidStart:
						for (i = 0; i < r; i++)
							(n = t[i]) && n.onExitTransitionDidStart();
						break;
					case o.sortAllChildren:
						for (i = 0; i < r; i++)
							(n = t[i]) && n.sortAllChildren();
						break;
					default:
						cc.assert(
							0,
							cc._LogInfos.Node__arrayMakeObjectsPerformSelector
						);
				}
			}
		},
		attr: function (t) {
			for (var e in t) this[e] = t[e];
		},
		getSkewX: function () {
			return this._skewX;
		},
		setSkewX: function (t) {
			(this._skewX = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getSkewY: function () {
			return this._skewY;
		},
		setSkewY: function (t) {
			(this._skewY = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		setLocalZOrder: function (t) {
			(this._localZOrder = t),
				this._parent && this._parent.reorderChild(this, t),
				cc.eventManager._setDirtyForNode(this);
		},
		_setLocalZOrder: function (t) {
			this._localZOrder = t;
		},
		getLocalZOrder: function () {
			return this._localZOrder;
		},
		getZOrder: function () {
			return cc.log(cc._LogInfos.Node_getZOrder), this.getLocalZOrder();
		},
		setZOrder: function (t) {
			cc.log(cc._LogInfos.Node_setZOrder), this.setLocalZOrder(t);
		},
		setGlobalZOrder: function (t) {
			this._globalZOrder !== t &&
				((this._globalZOrder = t),
				cc.eventManager._setDirtyForNode(this));
		},
		getGlobalZOrder: function () {
			return this._globalZOrder;
		},
		getVertexZ: function () {
			return this._vertexZ;
		},
		setVertexZ: function (t) {
			this._customZ = this._vertexZ = t;
		},
		getRotation: function () {
			return (
				this._rotationX !== this._rotationY &&
					cc.log(cc._LogInfos.Node_getRotation),
				this._rotationX
			);
		},
		setRotation: function (t) {
			(this._rotationX = this._rotationY = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getRotationX: function () {
			return this._rotationX;
		},
		setRotationX: function (t) {
			(this._rotationX = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getRotationY: function () {
			return this._rotationY;
		},
		setRotationY: function (t) {
			(this._rotationY = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getScale: function () {
			return (
				this._scaleX !== this._scaleY &&
					cc.log(cc._LogInfos.Node_getScale),
				this._scaleX
			);
		},
		setScale: function (t, e) {
			(this._scaleX = t),
				(this._scaleY = e || 0 === e ? e : t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getScaleX: function () {
			return this._scaleX;
		},
		setScaleX: function (t) {
			(this._scaleX = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getScaleY: function () {
			return this._scaleY;
		},
		setScaleY: function (t) {
			(this._scaleY = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		setPosition: function (t, e) {
			var i = this._position;
			if (void 0 === e) {
				if (i.x === t.x && i.y === t.y) return;
				(i.x = t.x), (i.y = t.y);
			} else {
				if (i.x === t && i.y === e) return;
				(i.x = t), (i.y = e);
			}
			(this._usingNormalizedPosition = !1),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		setNormalizedPosition: function (t, e) {
			var i = this._normalizedPosition;
			void 0 === e ? ((i.x = t.x), (i.y = t.y)) : ((i.x = t), (i.y = e)),
				(this._normalizedPositionDirty = this._usingNormalizedPosition =
					!0),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getPosition: function () {
			return cc.p(this._position);
		},
		getNormalizedPosition: function () {
			return cc.p(this._normalizedPosition);
		},
		getPositionX: function () {
			return this._position.x;
		},
		setPositionX: function (t) {
			(this._position.x = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getPositionY: function () {
			return this._position.y;
		},
		setPositionY: function (t) {
			(this._position.y = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getChildrenCount: function () {
			return this._children.length;
		},
		getChildren: function () {
			return this._children;
		},
		isVisible: function () {
			return this._visible;
		},
		setVisible: function (t) {
			this._visible !== t &&
				((this._visible = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				),
				(cc.renderer.childrenOrderDirty = !0));
		},
		getAnchorPoint: function () {
			return cc.p(this._anchorPoint);
		},
		setAnchorPoint: function (t, e) {
			var i = this._anchorPoint;
			if (void 0 === e) {
				if (t.x === i.x && t.y === i.y) return;
				(i.x = t.x), (i.y = t.y);
			} else {
				if (t === i.x && e === i.y) return;
				(i.x = t), (i.y = e);
			}
			this._renderCmd._updateAnchorPointInPoint();
		},
		_getAnchorX: function () {
			return this._anchorPoint.x;
		},
		_setAnchorX: function (t) {
			this._anchorPoint.x !== t &&
				((this._anchorPoint.x = t),
				this._renderCmd._updateAnchorPointInPoint());
		},
		_getAnchorY: function () {
			return this._anchorPoint.y;
		},
		_setAnchorY: function (t) {
			this._anchorPoint.y !== t &&
				((this._anchorPoint.y = t),
				this._renderCmd._updateAnchorPointInPoint());
		},
		getAnchorPointInPoints: function () {
			return this._renderCmd.getAnchorPointInPoints();
		},
		_getWidth: function () {
			return this._contentSize.width;
		},
		_setWidth: function (t) {
			(this._contentSize.width = t),
				this._renderCmd._updateAnchorPointInPoint();
		},
		_getHeight: function () {
			return this._contentSize.height;
		},
		_setHeight: function (t) {
			(this._contentSize.height = t),
				this._renderCmd._updateAnchorPointInPoint();
		},
		getContentSize: function () {
			return cc.size(this._contentSize);
		},
		setContentSize: function (t, e) {
			var i = this._contentSize;
			if (void 0 === e) {
				if (t.width === i.width && t.height === i.height) return;
				(i.width = t.width), (i.height = t.height);
			} else {
				if (t === i.width && e === i.height) return;
				(i.width = t), (i.height = e);
			}
			this._renderCmd._updateAnchorPointInPoint();
		},
		isRunning: function () {
			return this._running;
		},
		getParent: function () {
			return this._parent;
		},
		setParent: function (t) {
			(this._parent = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		isIgnoreAnchorPointForPosition: function () {
			return this._ignoreAnchorPointForPosition;
		},
		ignoreAnchorPointForPosition: function (t) {
			t !== this._ignoreAnchorPointForPosition &&
				((this._ignoreAnchorPointForPosition = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				));
		},
		getTag: function () {
			return this.tag;
		},
		setTag: function (t) {
			this.tag = t;
		},
		setName: function (t) {
			this._name = t;
		},
		getName: function () {
			return this._name;
		},
		getUserData: function () {
			return this.userData;
		},
		setUserData: function (t) {
			this.userData = t;
		},
		getUserObject: function () {
			return this.userObject;
		},
		setUserObject: function (t) {
			this.userObject !== t && (this.userObject = t);
		},
		getOrderOfArrival: function () {
			return this.arrivalOrder;
		},
		setOrderOfArrival: function (t) {
			this.arrivalOrder = t;
		},
		getActionManager: function () {
			return (
				this._actionManager ||
					(this._actionManager = cc.director.getActionManager()),
				this._actionManager
			);
		},
		setActionManager: function (t) {
			this._actionManager !== t &&
				(this.stopAllActions(), (this._actionManager = t));
		},
		getScheduler: function () {
			return (
				this._scheduler ||
					(this._scheduler = cc.director.getScheduler()),
				this._scheduler
			);
		},
		setScheduler: function (t) {
			this._scheduler !== t &&
				(this.unscheduleAllCallbacks(), (this._scheduler = t));
		},
		boundingBox: function () {
			return cc.log(cc._LogInfos.Node_boundingBox), this.getBoundingBox();
		},
		getBoundingBox: function () {
			var t = cc.rect(
				0,
				0,
				this._contentSize.width,
				this._contentSize.height
			);
			return cc._rectApplyAffineTransformIn(
				t,
				this.getNodeToParentTransform()
			);
		},
		cleanup: function () {
			this.stopAllActions(),
				this.unscheduleAllCallbacks(),
				cc.eventManager.removeListeners(this),
				this._arrayMakeObjectsPerformSelector(
					this._children,
					cc.Node._stateCallbackType.cleanup
				);
		},
		getChildByTag: function (t) {
			var e = this._children;
			if (null !== e)
				for (var i = 0; i < e.length; i++) {
					var n = e[i];
					if (n && n.tag === t) return n;
				}
			return null;
		},
		getChildByName: function (t) {
			if (!t) return cc.log('Invalid name'), null;
			for (var e = this._children, i = 0, n = e.length; i < n; i++)
				if (e[i]._name === t) return e[i];
			return null;
		},
		addChild: function (t, e, i) {
			e = void 0 === e ? t._localZOrder : e;
			var n,
				r = !1;
			cc.isUndefined(i)
				? ((i = void 0), (n = t._name))
				: cc.isString(i)
				? ((n = i), (i = void 0))
				: cc.isNumber(i) && ((r = !0), (n = '')),
				cc.assert(t, cc._LogInfos.Node_addChild_3),
				cc.assert(
					null === t._parent,
					"child already added. It can't be added again"
				),
				this._addChildHelper(t, e, i, n, r);
		},
		_addChildHelper: function (t, e, i, n, r) {
			this._children || (this._children = []),
				this._insertChild(t, e),
				r ? t.setTag(i) : t.setName(n),
				t.setParent(this),
				t.setOrderOfArrival(cc.s_globalOrderOfArrival++),
				this._running &&
					(t.onEnter(),
					this._isTransitionFinished &&
						t.onEnterTransitionDidFinish()),
				t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),
				this._cascadeColorEnabled &&
					t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),
				this._cascadeOpacityEnabled &&
					t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);
		},
		removeFromParent: function (t) {
			this._parent &&
				(void 0 === t && (t = !0), this._parent.removeChild(this, t));
		},
		removeFromParentAndCleanup: function (t) {
			cc.log(cc._LogInfos.Node_removeFromParentAndCleanup),
				this.removeFromParent(t);
		},
		removeChild: function (t, e) {
			0 !== this._children.length &&
				(void 0 === e && (e = !0),
				-1 < this._children.indexOf(t) && this._detachChild(t, e),
				(cc.renderer.childrenOrderDirty = !0));
		},
		removeChildByTag: function (t, e) {
			t === cc.NODE_TAG_INVALID &&
				cc.log(cc._LogInfos.Node_removeChildByTag);
			var i = this.getChildByTag(t);
			i
				? this.removeChild(i, e)
				: cc.log(cc._LogInfos.Node_removeChildByTag_2, t);
		},
		removeAllChildrenWithCleanup: function (t) {
			this.removeAllChildren(t);
		},
		removeAllChildren: function (t) {
			var e = this._children;
			if (null !== e) {
				void 0 === t && (t = !0);
				for (var i = 0; i < e.length; i++) {
					var n = e[i];
					n &&
						(this._running &&
							(n.onExitTransitionDidStart(), n.onExit()),
						t && n.cleanup(),
						(n.parent = null),
						n._renderCmd.detachFromParent());
				}
				(this._children.length = 0),
					(cc.renderer.childrenOrderDirty = !0);
			}
		},
		_detachChild: function (t, e) {
			this._running && (t.onExitTransitionDidStart(), t.onExit()),
				e && t.cleanup(),
				(t.parent = null),
				t._renderCmd.detachFromParent(),
				cc.arrayRemoveObject(this._children, t);
		},
		_insertChild: function (t, e) {
			(cc.renderer.childrenOrderDirty = this._reorderChildDirty = !0),
				this._children.push(t),
				t._setLocalZOrder(e);
		},
		setNodeDirty: function () {
			this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
		},
		reorderChild: function (t, e) {
			cc.assert(t, cc._LogInfos.Node_reorderChild),
				(cc.renderer.childrenOrderDirty = this._reorderChildDirty = !0),
				(t.arrivalOrder = cc.s_globalOrderOfArrival),
				cc.s_globalOrderOfArrival++,
				t._setLocalZOrder(e),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.orderDirty);
		},
		sortAllChildren: function () {
			if (this._reorderChildDirty) {
				for (
					var t, e, i = this._children, n = i.length, r = 1;
					r < n;
					r++
				) {
					for (e = i[r], t = r - 1; 0 <= t; ) {
						if (e._localZOrder < i[t]._localZOrder) i[t + 1] = i[t];
						else {
							if (
								!(
									e._localZOrder === i[t]._localZOrder &&
									e.arrivalOrder < i[t].arrivalOrder
								)
							)
								break;
							i[t + 1] = i[t];
						}
						t--;
					}
					i[t + 1] = e;
				}
				this._reorderChildDirty = !1;
			}
		},
		draw: function (t) {},
		transformAncestors: function () {
			null !== this._parent &&
				(this._parent.transformAncestors(), this._parent.transform());
		},
		onEnter: function () {
			(this._isTransitionFinished = !1),
				(this._running = !0),
				this._arrayMakeObjectsPerformSelector(
					this._children,
					cc.Node._stateCallbackType.onEnter
				),
				this.resume();
		},
		onEnterTransitionDidFinish: function () {
			(this._isTransitionFinished = !0),
				this._arrayMakeObjectsPerformSelector(
					this._children,
					cc.Node._stateCallbackType.onEnterTransitionDidFinish
				);
		},
		onExitTransitionDidStart: function () {
			this._arrayMakeObjectsPerformSelector(
				this._children,
				cc.Node._stateCallbackType.onExitTransitionDidStart
			);
		},
		onExit: function () {
			(this._running = !1),
				this.pause(),
				this._arrayMakeObjectsPerformSelector(
					this._children,
					cc.Node._stateCallbackType.onExit
				),
				this.removeAllComponents();
		},
		runAction: function (t) {
			return (
				cc.assert(t, cc._LogInfos.Node_runAction),
				this.actionManager.addAction(t, this, !this._running),
				t
			);
		},
		stopAllActions: function () {
			this.actionManager &&
				this.actionManager.removeAllActionsFromTarget(this);
		},
		stopAction: function (t) {
			this.actionManager.removeAction(t);
		},
		stopActionByTag: function (t) {
			t !== cc.ACTION_TAG_INVALID
				? this.actionManager.removeActionByTag(t, this)
				: cc.log(cc._LogInfos.Node_stopActionByTag);
		},
		getActionByTag: function (t) {
			return t === cc.ACTION_TAG_INVALID
				? (cc.log(cc._LogInfos.Node_getActionByTag), null)
				: this.actionManager.getActionByTag(t, this);
		},
		getNumberOfRunningActions: function () {
			return this.actionManager.numberOfRunningActionsInTarget(this);
		},
		scheduleUpdate: function () {
			this.scheduleUpdateWithPriority(0);
		},
		scheduleUpdateWithPriority: function (t) {
			this.scheduler.scheduleUpdate(this, t, !this._running);
		},
		unscheduleUpdate: function () {
			this.scheduler.unscheduleUpdate(this);
		},
		schedule: function (t, e, i, n, r) {
			var o = arguments.length;
			'function' == typeof t
				? 1 === o
					? ((e = 0),
					  (i = cc.REPEAT_FOREVER),
					  (n = 0),
					  (r = this.__instanceId))
					: 2 === o
					? 'number' == typeof e
						? ((i = cc.REPEAT_FOREVER),
						  (n = 0),
						  (r = this.__instanceId))
						: ((r = e), (e = 0), (i = cc.REPEAT_FOREVER), (n = 0))
					: 3 === o
					? ('string' == typeof i
							? ((r = i), (i = cc.REPEAT_FOREVER))
							: (r = this.__instanceId),
					  (n = 0))
					: 4 === o && (r = this.__instanceId)
				: 1 === o
				? ((e = 0), (i = cc.REPEAT_FOREVER), (n = 0))
				: 2 === o && ((i = cc.REPEAT_FOREVER), (n = 0)),
				cc.assert(t, cc._LogInfos.Node_schedule),
				cc.assert(0 <= e, cc._LogInfos.Node_schedule_2),
				(e = e || 0),
				(i = null == i ? cc.REPEAT_FOREVER : i),
				(n = n || 0),
				this.scheduler.schedule(t, this, e, i, n, !this._running, r);
		},
		scheduleOnce: function (t, e, i) {
			void 0 === i && (i = this.__instanceId),
				this.schedule(t, 0, 0, e, i);
		},
		unschedule: function (t) {
			t && this.scheduler.unschedule(t, this);
		},
		unscheduleAllCallbacks: function () {
			this.scheduler.unscheduleAllForTarget(this);
		},
		resumeSchedulerAndActions: function () {
			cc.log(cc._LogInfos.Node_resumeSchedulerAndActions), this.resume();
		},
		resume: function () {
			this.scheduler.resumeTarget(this),
				this.actionManager && this.actionManager.resumeTarget(this),
				cc.eventManager.resumeTarget(this);
		},
		pauseSchedulerAndActions: function () {
			cc.log(cc._LogInfos.Node_pauseSchedulerAndActions), this.pause();
		},
		pause: function () {
			this.scheduler.pauseTarget(this),
				this.actionManager && this.actionManager.pauseTarget(this),
				cc.eventManager.pauseTarget(this);
		},
		setAdditionalTransform: function (t) {
			if (void 0 === t) return (this._additionalTransformDirty = !1);
			(this._additionalTransform = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				),
				(this._additionalTransformDirty = !0);
		},
		getParentToNodeTransform: function () {
			return this._renderCmd.getParentToNodeTransform();
		},
		parentToNodeTransform: function () {
			return this.getParentToNodeTransform();
		},
		getNodeToWorldTransform: function () {
			for (
				var t = this.getNodeToParentTransform(), e = this._parent;
				null !== e;
				e = e.parent
			)
				t = cc.affineTransformConcat(t, e.getNodeToParentTransform());
			return t;
		},
		nodeToWorldTransform: function () {
			return this.getNodeToWorldTransform();
		},
		getWorldToNodeTransform: function () {
			return cc.affineTransformInvert(this.getNodeToWorldTransform());
		},
		worldToNodeTransform: function () {
			return this.getWorldToNodeTransform();
		},
		convertToNodeSpace: function (t) {
			return cc.pointApplyAffineTransform(
				t,
				this.getWorldToNodeTransform()
			);
		},
		convertToWorldSpace: function (t) {
			return (
				(t = t || cc.p(0, 0)),
				cc.pointApplyAffineTransform(t, this.getNodeToWorldTransform())
			);
		},
		convertToNodeSpaceAR: function (t) {
			return cc.pSub(
				this.convertToNodeSpace(t),
				this._renderCmd.getAnchorPointInPoints()
			);
		},
		convertToWorldSpaceAR: function (t) {
			t = t || cc.p(0, 0);
			t = cc.pAdd(t, this._renderCmd.getAnchorPointInPoints());
			return this.convertToWorldSpace(t);
		},
		_convertToWindowSpace: function (t) {
			t = this.convertToWorldSpace(t);
			return cc.director.convertToUI(t);
		},
		convertTouchToNodeSpace: function (t) {
			t = t.getLocation();
			return this.convertToNodeSpace(t);
		},
		convertTouchToNodeSpaceAR: function (t) {
			t = cc.director.convertToGL(t.getLocation());
			return this.convertToNodeSpaceAR(t);
		},
		update: function (t) {
			this._componentContainer &&
				!this._componentContainer.isEmpty() &&
				this._componentContainer.visit(t);
		},
		updateTransform: function () {
			this._arrayMakeObjectsPerformSelector(
				this._children,
				cc.Node._stateCallbackType.updateTransform
			);
		},
		retain: function () {},
		release: function () {},
		getComponent: function (t) {
			return this._componentContainer
				? this._componentContainer.getComponent(t)
				: null;
		},
		addComponent: function (t) {
			this._componentContainer && this._componentContainer.add(t);
		},
		removeComponent: function (t) {
			return (
				!!this._componentContainer && this._componentContainer.remove(t)
			);
		},
		removeAllComponents: function () {
			this._componentContainer && this._componentContainer.removeAll();
		},
		grid: null,
		visit: function (t) {
			this._renderCmd.visit(t);
		},
		transform: function (t, e) {
			this._renderCmd.transform(t, e);
		},
		nodeToParentTransform: function () {
			return this.getNodeToParentTransform();
		},
		getNodeToParentTransform: function (t) {
			var e = this._renderCmd.getNodeToParentTransform();
			if (t) {
				for (
					var i = {
							a: e.a,
							b: e.b,
							c: e.c,
							d: e.d,
							tx: e.tx,
							ty: e.ty,
						},
						n = this._parent;
					null != n && n != t;
					n = n.getParent()
				)
					cc.affineTransformConcatIn(i, n.getNodeToParentTransform());
				return i;
			}
			return e;
		},
		getNodeToParentAffineTransform: function (t) {
			return this.getNodeToParentTransform(t);
		},
		getCamera: function () {
			return null;
		},
		getGrid: function () {
			return this.grid;
		},
		setGrid: function (t) {
			this.grid = t;
		},
		getShaderProgram: function () {
			return this._renderCmd.getShaderProgram();
		},
		setShaderProgram: function (t) {
			this._renderCmd.setShaderProgram(t);
		},
		getGLServerState: function () {
			return 0;
		},
		setGLServerState: function (t) {},
		getBoundingBoxToWorld: function () {
			var t = cc.rect(
					0,
					0,
					this._contentSize.width,
					this._contentSize.height
				),
				e = this.getNodeToWorldTransform(),
				t = cc.rectApplyAffineTransform(t, e);
			if (!this._children) return t;
			for (var i = this._children, n = 0; n < i.length; n++) {
				var r = i[n];
				r &&
					r._visible &&
					(r = r._getBoundingBoxToCurrentNode(e)) &&
					(t = cc.rectUnion(t, r));
			}
			return t;
		},
		_getBoundingBoxToCurrentNode: function (t) {
			var e = cc.rect(
					0,
					0,
					this._contentSize.width,
					this._contentSize.height
				),
				i =
					void 0 === t
						? this.getNodeToParentTransform()
						: cc.affineTransformConcat(
								this.getNodeToParentTransform(),
								t
						  ),
				e = cc.rectApplyAffineTransform(e, i);
			if (!this._children) return e;
			for (var n = this._children, r = 0; r < n.length; r++) {
				var o = n[r];
				o &&
					o._visible &&
					(o = o._getBoundingBoxToCurrentNode(i)) &&
					(e = cc.rectUnion(e, o));
			}
			return e;
		},
		getOpacity: function () {
			return this._realOpacity;
		},
		getDisplayedOpacity: function () {
			return this._renderCmd.getDisplayedOpacity();
		},
		setOpacity: function (t) {
			(this._realOpacity = t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);
		},
		updateDisplayedOpacity: function (t) {
			this._renderCmd._updateDisplayOpacity(t);
		},
		isCascadeOpacityEnabled: function () {
			return this._cascadeOpacityEnabled;
		},
		setCascadeOpacityEnabled: function (t) {
			this._cascadeOpacityEnabled !== t &&
				((this._cascadeOpacityEnabled = t),
				this._renderCmd.setCascadeOpacityEnabledDirty());
		},
		getColor: function () {
			var t = this._realColor;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		getDisplayedColor: function () {
			return this._renderCmd.getDisplayedColor();
		},
		setColor: function (t) {
			var e = this._realColor;
			(e.r = t.r),
				(e.g = t.g),
				(e.b = t.b),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);
		},
		updateDisplayedColor: function (t) {
			this._renderCmd._updateDisplayColor(t);
		},
		isCascadeColorEnabled: function () {
			return this._cascadeColorEnabled;
		},
		setCascadeColorEnabled: function (t) {
			this._cascadeColorEnabled !== t &&
				((this._cascadeColorEnabled = t),
				this._renderCmd.setCascadeColorEnabledDirty());
		},
		setOpacityModifyRGB: function (t) {},
		isOpacityModifyRGB: function () {
			return !1;
		},
		_initRendererCmd: function () {
			this._renderCmd = cc.renderer.getRenderCmd(this);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.Node.CanvasRenderCmd
					: cc.Node.WebGLRenderCmd
			)(this);
		},
		enumerateChildren: function (t, e) {
			cc.assert(t && 0 != t.length, 'Invalid name'),
				cc.assert(null != e, 'Invalid callback function');
			var i = t.length,
				n = 0,
				r = i,
				o = !1;
			2 < i && '/' === t[0] && '/' === t[1] && ((o = !0), (r -= n = 2));
			var s = !1;
			3 < i &&
				'/' === t[i - 3] &&
				'.' === t[i - 2] &&
				'.' === t[i - 1] &&
				((s = !0), (r -= 3));
			r = t.substr(n, r);
			s && (r = '[[:alnum:]]+/' + r),
				o
					? this.doEnumerateRecursive(this, r, e)
					: this.doEnumerate(r, e);
		},
		doEnumerateRecursive: function (t, e, i) {
			if (t.doEnumerate(e, i)) 0;
			else
				for (
					var n, r = t.getChildren(), o = r.length, s = 0;
					s < o;
					s++
				)
					if (((n = r[s]), this.doEnumerateRecursive(n, e, i))) {
						0;
						break;
					}
		},
		doEnumerate: function (t, e) {
			var i = t.indexOf('/'),
				n = t,
				r = !1;
			-1 !== i && ((n = t.substr(0, i)), (r = !0));
			for (
				var o, s = !1, c = this._children, a = c.length, l = 0;
				l < a;
				l++
			)
				if (-1 !== (o = c[l])._name.indexOf(n))
					if (r) {
						if ((s = o.doEnumerate(t, e))) break;
					} else if (e(o)) {
						s = !0;
						break;
					}
			return s;
		},
	})),
	(cc.Node.create = function () {
		return new cc.Node();
	}),
	(cc.Node._stateCallbackType = {
		onEnter: 1,
		onExit: 2,
		cleanup: 3,
		onEnterTransitionDidFinish: 4,
		updateTransform: 5,
		onExitTransitionDidStart: 6,
		sortAllChildren: 7,
	}),
	cc.assert(
		cc.isFunction(cc._tmp.PrototypeCCNode),
		cc._LogInfos.MissingFile,
		'BaseNodesPropertyDefine.js'
	),
	cc._tmp.PrototypeCCNode(),
	delete cc._tmp.PrototypeCCNode,
	(cc.CustomRenderCmd = function (t, e) {
		(this._needDraw = !0),
			(this._target = t),
			(this._callback = e),
			(this.rendering = function (t, e, i) {
				this._callback && this._callback.call(this._target, t, e, i);
			}),
			(this.needDraw = function () {
				return this._needDraw;
			});
	}),
	(cc.Node._dirtyFlags = {
		transformDirty: 1,
		visibleDirty: 2,
		colorDirty: 4,
		opacityDirty: 8,
		cacheDirty: 16,
		orderDirty: 32,
		textDirty: 64,
		gradientDirty: 128,
		textureDirty: 256,
		contentDirty: 512,
		COUNT: 10,
		all: 1023,
	}),
	(cc.Node.RenderCmd = function (t) {
		(this._dirtyFlag = 1),
			(this._savedDirtyFlag = !0),
			(this._node = t),
			(this._needDraw = !1),
			(this._anchorPointInPoints = new cc.Point(0, 0)),
			(this._transform = { a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 }),
			(this._worldTransform = { a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 }),
			(this._inverse = { a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 }),
			(this._displayedOpacity = 255),
			(this._displayedColor = cc.color(255, 255, 255, 255)),
			(this._cascadeColorEnabledDirty = !1),
			(this._cascadeOpacityEnabledDirty = !1),
			(this._curLevel = -1);
	}),
	(cc.Node.RenderCmd.prototype = {
		constructor: cc.Node.RenderCmd,
		needDraw: function () {
			return this._needDraw;
		},
		getAnchorPointInPoints: function () {
			return cc.p(this._anchorPointInPoints);
		},
		getDisplayedColor: function () {
			var t = this._displayedColor;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		getDisplayedOpacity: function () {
			return this._displayedOpacity;
		},
		setCascadeColorEnabledDirty: function () {
			(this._cascadeColorEnabledDirty = !0),
				this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);
		},
		setCascadeOpacityEnabledDirty: function () {
			(this._cascadeOpacityEnabledDirty = !0),
				this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);
		},
		getParentToNodeTransform: function () {
			return (
				this._dirtyFlag & cc.Node._dirtyFlags.transformDirty &&
					(this._inverse = cc.affineTransformInvert(
						this.getNodeToParentTransform()
					)),
				this._inverse
			);
		},
		detachFromParent: function () {},
		_updateAnchorPointInPoint: function () {
			var t = this._anchorPointInPoints,
				e = this._node._contentSize,
				i = this._node._anchorPoint;
			(t.x = e.width * i.x),
				(t.y = e.height * i.y),
				this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
		},
		setDirtyFlag: function (t) {
			0 === this._dirtyFlag && 0 !== t && cc.renderer.pushDirtyNode(this),
				(this._dirtyFlag |= t);
		},
		getParentRenderCmd: function () {
			return this._node &&
				this._node._parent &&
				this._node._parent._renderCmd
				? this._node._parent._renderCmd
				: null;
		},
		transform: function (t, e) {
			var i = this._node,
				n = t ? t._worldTransform : null,
				r = this._transform,
				o = this._worldTransform;
			i._usingNormalizedPosition &&
				i._parent &&
				((f = i._parent._contentSize),
				(i._position.x = i._normalizedPosition.x * f.width),
				(i._position.y = i._normalizedPosition.y * f.height),
				(i._normalizedPositionDirty = !1));
			var s,
				c = i._rotationX || i._rotationY,
				a = i._skewX || i._skewY,
				l = i._scaleX,
				h = i._scaleY,
				u = this._anchorPointInPoints.x,
				_ = this._anchorPointInPoints.y,
				d = 1,
				p = 0,
				t = 0,
				f = 1;
			if (
				(c || a
					? ((r.tx = i._position.x),
					  (r.ty = i._position.y),
					  c &&
							((c = 0.017453292519943295 * i._rotationX),
							(t = Math.sin(c)),
							(f = Math.cos(c)),
							(p =
								i._rotationY === i._rotationX
									? ((d = f), -t)
									: ((s =
											0.017453292519943295 *
											i._rotationY),
									  (d = Math.cos(s)),
									  -Math.sin(s)))),
					  (r.a = d *= l),
					  (r.b = p *= l),
					  (r.c = t *= h),
					  (r.d = f *= h),
					  a &&
							((s = Math.tan((i._skewX * Math.PI) / 180)) ===
								1 / 0 && (s = 99999999),
							(a = Math.tan((i._skewY * Math.PI) / 180)) ===
								1 / 0 && (a = 99999999),
							(r.a = d + t * a),
							(r.b = p + f * a),
							(r.c = t + d * s),
							(r.d = f + p * s)),
					  (u || _) &&
							((r.tx -= r.a * u + r.c * _),
							(r.ty -= r.b * u + r.d * _),
							i._ignoreAnchorPointForPosition &&
								((r.tx += u), (r.ty += _))),
					  n
							? ((o.a = r.a * n.a + r.b * n.c),
							  (o.b = r.a * n.b + r.b * n.d),
							  (o.c = r.c * n.a + r.d * n.c),
							  (o.d = r.c * n.b + r.d * n.d),
							  (o.tx = n.a * r.tx + n.c * r.ty + n.tx),
							  (o.ty = n.d * r.ty + n.ty + n.b * r.tx))
							: ((o.a = r.a),
							  (o.b = r.b),
							  (o.c = r.c),
							  (o.d = r.d),
							  (o.tx = r.tx),
							  (o.ty = r.ty)))
					: ((r.a = l),
					  (r.b = 0),
					  (r.c = 0),
					  (r.d = h),
					  (r.tx = i._position.x),
					  (r.ty = i._position.y),
					  (u || _) &&
							((r.tx -= r.a * u),
							(r.ty -= r.d * _),
							i._ignoreAnchorPointForPosition &&
								((r.tx += u), (r.ty += _))),
					  n
							? ((o.a = r.a * n.a + r.b * n.c),
							  (o.b = r.a * n.b + r.b * n.d),
							  (o.c = r.c * n.a + r.d * n.c),
							  (o.d = r.c * n.b + r.d * n.d),
							  (o.tx = r.tx * n.a + r.ty * n.c + n.tx),
							  (o.ty = r.tx * n.b + r.ty * n.d + n.ty))
							: ((o.a = r.a),
							  (o.b = r.b),
							  (o.c = r.c),
							  (o.d = r.d),
							  (o.tx = r.tx),
							  (o.ty = r.ty))),
				i._additionalTransformDirty &&
					(this._transform = cc.affineTransformConcat(
						r,
						i._additionalTransform
					)),
				this._updateCurrentRegions && this._updateCurrentRegions(),
				this._notifyRegionStatus &&
					this._notifyRegionStatus(
						cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble
					),
				e)
			) {
				var m,
					g,
					y = this._node._children;
				if (!y || 0 === y.length) return;
				for (m = 0, g = y.length; m < g; m++)
					y[m]._renderCmd.transform(this, e);
			}
			this._cacheDirty = !0;
		},
		getNodeToParentTransform: function () {
			return (
				this._dirtyFlag & cc.Node._dirtyFlags.transformDirty &&
					this.transform(),
				this._transform
			);
		},
		visit: function (t) {
			var e = this._node,
				i = cc.renderer;
			e._visible &&
				((t = t || this.getParentRenderCmd()) &&
					(this._curLevel = t._curLevel + 1),
				isNaN(e._customZ) &&
					((e._vertexZ = i.assignedZ),
					(i.assignedZ += i.assignedZStep)),
				this._syncStatus(t),
				this.visitChildren());
		},
		_updateDisplayColor: function (t) {
			var e,
				i,
				n = this._node,
				r = this._displayedColor,
				o = n._realColor;
			if (
				(this._notifyRegionStatus &&
					this._notifyRegionStatus(
						cc.Node.CanvasRenderCmd.RegionStatus.Dirty
					),
				this._cascadeColorEnabledDirty && !n._cascadeColorEnabled)
			) {
				(r.r = o.r), (r.g = o.g), (r.b = o.b);
				for (
					var s,
						c = new cc.Color(255, 255, 255, 255),
						a = 0,
						l = (s = n._children).length;
					a < l;
					a++
				)
					(e = s[a]) &&
						e._renderCmd &&
						e._renderCmd._updateDisplayColor(c);
				this._cascadeColorEnabledDirty = !1;
			} else if (
				(void 0 === t &&
					(t =
						(i = n._parent) && i._cascadeColorEnabled
							? i.getDisplayedColor()
							: cc.color.WHITE),
				(r.r = 0 | ((o.r * t.r) / 255)),
				(r.g = 0 | ((o.g * t.g) / 255)),
				(r.b = 0 | ((o.b * t.b) / 255)),
				n._cascadeColorEnabled)
			)
				for (a = 0, l = (s = n._children).length; a < l; a++)
					(e = s[a]) &&
						e._renderCmd &&
						(e._renderCmd._updateDisplayColor(r),
						e._renderCmd._updateColor());
			this._dirtyFlag =
				(this._dirtyFlag & cc.Node._dirtyFlags.colorDirty) ^
				this._dirtyFlag;
		},
		_updateDisplayOpacity: function (t) {
			var e,
				i,
				n,
				r,
				o,
				s = this._node;
			if (
				(this._notifyRegionStatus &&
					this._notifyRegionStatus(
						cc.Node.CanvasRenderCmd.RegionStatus.Dirty
					),
				this._cascadeOpacityEnabledDirty && !s._cascadeOpacityEnabled)
			) {
				for (
					this._displayedOpacity = s._realOpacity,
						e = 0,
						i = (n = s._children).length;
					e < i;
					e++
				)
					(r = n[e]) &&
						r._renderCmd &&
						r._renderCmd._updateDisplayOpacity(255);
				this._cascadeOpacityEnabledDirty = !1;
			} else if (
				(void 0 === t &&
					((t = 255),
					(o = s._parent) &&
						o._cascadeOpacityEnabled &&
						(t = o.getDisplayedOpacity())),
				(this._displayedOpacity = (s._realOpacity * t) / 255),
				s._cascadeOpacityEnabled)
			)
				for (e = 0, i = (n = s._children).length; e < i; e++)
					(r = n[e]) &&
						r._renderCmd &&
						(r._renderCmd._updateDisplayOpacity(
							this._displayedOpacity
						),
						r._renderCmd._updateColor());
			this._dirtyFlag =
				(this._dirtyFlag & cc.Node._dirtyFlags.opacityDirty) ^
				this._dirtyFlag;
		},
		_syncDisplayColor: function (t) {
			var e = this._node,
				i = this._displayedColor,
				n = e._realColor;
			void 0 === t &&
				(t =
					(e = e._parent) && e._cascadeColorEnabled
						? e.getDisplayedColor()
						: cc.color.WHITE),
				(i.r = 0 | ((n.r * t.r) / 255)),
				(i.g = 0 | ((n.g * t.g) / 255)),
				(i.b = 0 | ((n.b * t.b) / 255));
		},
		_syncDisplayOpacity: function (t) {
			var e,
				i = this._node;
			void 0 === t &&
				((t = 255),
				(e = i._parent) &&
					e._cascadeOpacityEnabled &&
					(t = e.getDisplayedOpacity())),
				(this._displayedOpacity = (i._realOpacity * t) / 255);
		},
		_updateColor: function () {},
		updateStatus: function () {
			var t = cc.Node._dirtyFlags,
				e = this._dirtyFlag,
				i = e & t.colorDirty,
				n = e & t.opacityDirty;
			(this._savedDirtyFlag = this._savedDirtyFlag || e),
				i && this._updateDisplayColor(),
				n && this._updateDisplayOpacity(),
				(i || n) && this._updateColor(),
				e & t.transformDirty &&
					(this.transform(this.getParentRenderCmd(), !0),
					(this._dirtyFlag =
						(this._dirtyFlag & t.transformDirty) ^
						this._dirtyFlag)),
				e & t.orderDirty &&
					(this._dirtyFlag =
						(this._dirtyFlag & t.orderDirty) ^ this._dirtyFlag);
		},
		_syncStatus: function (t) {
			var e = cc.Node._dirtyFlags,
				i = this._dirtyFlag,
				n = null;
			t
				? ((n = t._node),
				  (this._savedDirtyFlag =
						this._savedDirtyFlag || t._savedDirtyFlag || i))
				: (this._savedDirtyFlag = this._savedDirtyFlag || i),
				n &&
					n._cascadeColorEnabled &&
					t._dirtyFlag & e.colorDirty &&
					(i |= e.colorDirty),
				n &&
					n._cascadeOpacityEnabled &&
					t._dirtyFlag & e.opacityDirty &&
					(i |= e.opacityDirty),
				t && t._dirtyFlag & e.transformDirty && (i |= e.transformDirty);
			var r = i & e.colorDirty,
				n = i & e.opacityDirty;
			(this._dirtyFlag = i),
				r && this._syncDisplayColor(),
				n && this._syncDisplayOpacity(),
				(r || n) && this._updateColor(),
				i & e.transformDirty && this.transform(t),
				i & e.orderDirty &&
					(this._dirtyFlag =
						(this._dirtyFlag & e.orderDirty) ^ this._dirtyFlag);
		},
		visitChildren: function () {
			var t,
				e,
				i = cc.renderer,
				n = this._node,
				r = n._children,
				o = r.length;
			if (0 < o) {
				for (
					n.sortAllChildren(), t = 0;
					t < o && (e = r[t])._localZOrder < 0;
					t++
				)
					e._renderCmd.visit(this);
				for (i.pushRenderCommand(this); t < o; t++)
					r[t]._renderCmd.visit(this);
			} else i.pushRenderCommand(this);
			this._dirtyFlag = 0;
		},
	}),
	(cc.Node.RenderCmd.prototype.originVisit =
		cc.Node.RenderCmd.prototype.visit),
	(cc.Node.RenderCmd.prototype.originTransform =
		cc.Node.RenderCmd.prototype.transform),
	(function () {
		(cc.Node.CanvasRenderCmd = function (t) {
			cc.Node.RenderCmd.call(this, t),
				(this._cachedParent = null),
				(this._cacheDirty = !1),
				(this._currentRegion = new cc.Region()),
				(this._oldRegion = new cc.Region()),
				(this._regionFlag = 0),
				(this._canUseDirtyRegion = !1);
		}),
			(cc.Node.CanvasRenderCmd.RegionStatus = {
				NotDirty: 0,
				Dirty: 1,
				DirtyDouble: 2,
			});
		var t = (cc.Node.CanvasRenderCmd.prototype = Object.create(
			cc.Node.RenderCmd.prototype
		));
		(t.constructor = cc.Node.CanvasRenderCmd),
			(t._notifyRegionStatus = function (t) {
				this._needDraw &&
					this._regionFlag < t &&
					(this._regionFlag = t);
			});
		var e = new cc.Rect();
		(t.getLocalBB = function () {
			var t = this._node;
			return (
				(e.x = e.y = 0),
				(e.width = t._contentSize.width),
				(e.height = t._contentSize.height),
				e
			);
		}),
			(t._updateCurrentRegions = function () {
				var t = this._currentRegion;
				(this._currentRegion = this._oldRegion),
					(this._oldRegion = t),
					cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble !==
						this._regionFlag ||
						this._currentRegion.isEmpty() ||
						this._oldRegion.union(this._currentRegion),
					this._currentRegion.updateRegion(
						this.getLocalBB(),
						this._worldTransform
					);
			}),
			(t.setDirtyFlag = function (t, e) {
				cc.Node.RenderCmd.prototype.setDirtyFlag.call(this, t, e),
					this._setCacheDirty(e),
					this._cachedParent &&
						this._cachedParent.setDirtyFlag(t, !0);
			}),
			(t._setCacheDirty = function () {
				var t;
				!1 === this._cacheDirty &&
					((this._cacheDirty = !0),
					(t = this._cachedParent) &&
						t !== this &&
						t._setNodeDirtyForCache &&
						t._setNodeDirtyForCache());
			}),
			(t._setCachedParent = function (t) {
				if (this._cachedParent !== t) {
					this._cachedParent = t;
					for (
						var e = this._node._children, i = 0, n = e.length;
						i < n;
						i++
					)
						e[i]._renderCmd._setCachedParent(t);
				}
			}),
			(t.detachFromParent = function () {
				this._cachedParent = null;
				for (
					var t, e = this._node._children, i = 0, n = e.length;
					i < n;
					i++
				)
					(t = e[i]) &&
						t._renderCmd &&
						t._renderCmd.detachFromParent();
			}),
			(t.setShaderProgram = function (t) {}),
			(t.getShaderProgram = function () {
				return null;
			}),
			(cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc =
				function (t) {
					return t
						? (t.src === cc.SRC_ALPHA && t.dst === cc.ONE) ||
						  (t.src === cc.ONE && t.dst === cc.ONE)
							? 'lighter'
							: t.src === cc.ZERO && t.dst === cc.SRC_ALPHA
							? 'destination-in'
							: t.src === cc.ZERO &&
							  t.dst === cc.ONE_MINUS_SRC_ALPHA
							? 'destination-out'
							: 'source-over'
						: 'source-over';
				});
	})(),
	(cc._tmp.PrototypeTexture2D = function () {
		var t = cc.Texture2D;
		(t.PVRImagesHavePremultipliedAlpha = function (t) {
			cc.PVRHaveAlphaPremultiplied_ = t;
		}),
			(t.PIXEL_FORMAT_RGBA8888 = 2),
			(t.PIXEL_FORMAT_RGB888 = 3),
			(t.PIXEL_FORMAT_RGB565 = 4),
			(t.PIXEL_FORMAT_A8 = 5),
			(t.PIXEL_FORMAT_I8 = 6),
			(t.PIXEL_FORMAT_AI88 = 7),
			(t.PIXEL_FORMAT_RGBA4444 = 8),
			(t.PIXEL_FORMAT_RGB5A1 = 7),
			(t.PIXEL_FORMAT_PVRTC4 = 9),
			(t.PIXEL_FORMAT_PVRTC2 = 10),
			(t.PIXEL_FORMAT_DEFAULT = t.PIXEL_FORMAT_RGBA8888),
			(t.defaultPixelFormat = t.PIXEL_FORMAT_DEFAULT);
		var e = (cc.Texture2D._M = {});
		(e[t.PIXEL_FORMAT_RGBA8888] = 'RGBA8888'),
			(e[t.PIXEL_FORMAT_RGB888] = 'RGB888'),
			(e[t.PIXEL_FORMAT_RGB565] = 'RGB565'),
			(e[t.PIXEL_FORMAT_A8] = 'A8'),
			(e[t.PIXEL_FORMAT_I8] = 'I8'),
			(e[t.PIXEL_FORMAT_AI88] = 'AI88'),
			(e[t.PIXEL_FORMAT_RGBA4444] = 'RGBA4444'),
			(e[t.PIXEL_FORMAT_RGB5A1] = 'RGB5A1'),
			(e[t.PIXEL_FORMAT_PVRTC4] = 'PVRTC4'),
			(e[t.PIXEL_FORMAT_PVRTC2] = 'PVRTC2');
		e = cc.Texture2D._B = {};
		(e[t.PIXEL_FORMAT_RGBA8888] = 32),
			(e[t.PIXEL_FORMAT_RGB888] = 24),
			(e[t.PIXEL_FORMAT_RGB565] = 16),
			(e[t.PIXEL_FORMAT_A8] = 8),
			(e[t.PIXEL_FORMAT_I8] = 8),
			(e[t.PIXEL_FORMAT_AI88] = 16),
			(e[t.PIXEL_FORMAT_RGBA4444] = 16),
			(e[t.PIXEL_FORMAT_RGB5A1] = 16),
			(e[t.PIXEL_FORMAT_PVRTC4] = 4),
			(e[t.PIXEL_FORMAT_PVRTC2] = 3);
		t = cc.Texture2D.prototype;
		t.name,
			cc.defineGetterSetter(t, 'name', t.getName),
			t.pixelFormat,
			cc.defineGetterSetter(t, 'pixelFormat', t.getPixelFormat),
			t.pixelsWidth,
			cc.defineGetterSetter(t, 'pixelsWidth', t.getPixelsWide),
			t.pixelsHeight,
			cc.defineGetterSetter(t, 'pixelsHeight', t.getPixelsHigh),
			t.width,
			cc.defineGetterSetter(t, 'width', t._getWidth),
			t.height,
			cc.defineGetterSetter(t, 'height', t._getHeight);
	}),
	(cc._tmp.PrototypeTextureAtlas = function () {
		var t = cc.TextureAtlas.prototype;
		t.totalQuads,
			cc.defineGetterSetter(t, 'totalQuads', t.getTotalQuads),
			t.capacity,
			cc.defineGetterSetter(t, 'capacity', t.getCapacity),
			t.quads,
			cc.defineGetterSetter(t, 'quads', t.getQuads, t.setQuads);
	}),
	(cc._tmp.WebGLTexture2D = function () {
		cc.Texture2D = cc.Class.extend({
			_pVRHaveAlphaPremultiplied: !0,
			_pixelFormat: null,
			_pixelsWide: 0,
			_pixelsHigh: 0,
			_name: '',
			_contentSize: null,
			maxS: 0,
			maxT: 0,
			_hasPremultipliedAlpha: !1,
			_hasMipmaps: !1,
			shaderProgram: null,
			_textureLoaded: !1,
			_htmlElementObj: null,
			_webTextureObj: null,
			url: null,
			ctor: function () {
				(this._contentSize = cc.size(0, 0)),
					(this._pixelFormat = cc.Texture2D.defaultPixelFormat);
			},
			releaseTexture: function () {
				this._webTextureObj &&
					cc._renderContext.deleteTexture(this._webTextureObj),
					cc.loader.release(this.url);
			},
			getPixelFormat: function () {
				return this._pixelFormat;
			},
			getPixelsWide: function () {
				return this._pixelsWide;
			},
			getPixelsHigh: function () {
				return this._pixelsHigh;
			},
			getName: function () {
				return this._webTextureObj;
			},
			getContentSize: function () {
				return cc.size(
					this._contentSize.width / cc.contentScaleFactor(),
					this._contentSize.height / cc.contentScaleFactor()
				);
			},
			_getWidth: function () {
				return this._contentSize.width / cc.contentScaleFactor();
			},
			_getHeight: function () {
				return this._contentSize.height / cc.contentScaleFactor();
			},
			getContentSizeInPixels: function () {
				return this._contentSize;
			},
			getMaxS: function () {
				return this.maxS;
			},
			setMaxS: function (t) {
				this.maxS = t;
			},
			getMaxT: function () {
				return this.maxT;
			},
			setMaxT: function (t) {
				this.maxT = t;
			},
			getShaderProgram: function () {
				return this.shaderProgram;
			},
			setShaderProgram: function (t) {
				this.shaderProgram = t;
			},
			hasPremultipliedAlpha: function () {
				return this._hasPremultipliedAlpha;
			},
			hasMipmaps: function () {
				return this._hasMipmaps;
			},
			description: function () {
				var t = this;
				return (
					'<cc.Texture2D | Name = ' +
					t._name +
					' | Dimensions = ' +
					t._pixelsWide +
					' x ' +
					t._pixelsHigh +
					' | Coordinates = (' +
					t.maxS +
					', ' +
					t.maxT +
					')>'
				);
			},
			releaseData: function (t) {
				0;
			},
			keepData: function (t, e) {
				return t;
			},
			initWithData: function (t, e, i, n, r) {
				var o = this,
					s = cc.Texture2D,
					c = cc._renderContext,
					a = c.RGBA,
					l = c.UNSIGNED_BYTE,
					h = (i * cc.Texture2D._B[e]) / 8;
				switch (
					(h % 8 == 0
						? c.pixelStorei(c.UNPACK_ALIGNMENT, 8)
						: h % 4 == 0
						? c.pixelStorei(c.UNPACK_ALIGNMENT, 4)
						: h % 2 == 0
						? c.pixelStorei(c.UNPACK_ALIGNMENT, 2)
						: c.pixelStorei(c.UNPACK_ALIGNMENT, 1),
					(o._webTextureObj = c.createTexture()),
					cc.glBindTexture2D(o),
					c.texParameteri(
						c.TEXTURE_2D,
						c.TEXTURE_MIN_FILTER,
						c.LINEAR
					),
					c.texParameteri(
						c.TEXTURE_2D,
						c.TEXTURE_MAG_FILTER,
						c.LINEAR
					),
					c.texParameteri(
						c.TEXTURE_2D,
						c.TEXTURE_WRAP_S,
						c.CLAMP_TO_EDGE
					),
					c.texParameteri(
						c.TEXTURE_2D,
						c.TEXTURE_WRAP_T,
						c.CLAMP_TO_EDGE
					),
					e)
				) {
					case s.PIXEL_FORMAT_RGBA8888:
						a = c.RGBA;
						break;
					case s.PIXEL_FORMAT_RGB888:
						a = c.RGB;
						break;
					case s.PIXEL_FORMAT_RGBA4444:
						l = c.UNSIGNED_SHORT_4_4_4_4;
						break;
					case s.PIXEL_FORMAT_RGB5A1:
						l = c.UNSIGNED_SHORT_5_5_5_1;
						break;
					case s.PIXEL_FORMAT_RGB565:
						l = c.UNSIGNED_SHORT_5_6_5;
						break;
					case s.PIXEL_FORMAT_AI88:
						a = c.LUMINANCE_ALPHA;
						break;
					case s.PIXEL_FORMAT_A8:
						a = c.ALPHA;
						break;
					case s.PIXEL_FORMAT_I8:
						a = c.LUMINANCE;
						break;
					default:
						cc.assert(0, cc._LogInfos.Texture2D_initWithData);
				}
				return (
					c.texImage2D(c.TEXTURE_2D, 0, a, i, n, 0, a, l, t),
					(o._contentSize.width = r.width),
					(o._contentSize.height = r.height),
					(o._pixelsWide = i),
					(o._pixelsHigh = n),
					(o._pixelFormat = e),
					(o.maxS = r.width / i),
					(o.maxT = r.height / n),
					(o._hasPremultipliedAlpha = !1),
					(o._hasMipmaps = !1),
					(o.shaderProgram = cc.shaderCache.programForKey(
						cc.SHADER_POSITION_TEXTURE
					)),
					(o._textureLoaded = !0)
				);
			},
			drawAtPoint: function (t) {
				var e = this,
					i = [0, e.maxT, e.maxS, e.maxT, 0, 0, e.maxS, 0],
					n = cc._renderContext,
					r = e._pixelsWide * e.maxS,
					o = e._pixelsHigh * e.maxT,
					t = [
						t.x,
						t.y,
						0,
						r + t.x,
						t.y,
						0,
						t.x,
						o + t.y,
						0,
						r + t.x,
						o + t.y,
						0,
					];
				e._shaderProgram.use(),
					e._shaderProgram.setUniformsForBuiltins(),
					cc.glBindTexture2D(e),
					n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
					n.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
					n.vertexAttribPointer(
						cc.VERTEX_ATTRIB_POSITION,
						2,
						n.FLOAT,
						!1,
						0,
						t
					),
					n.vertexAttribPointer(
						cc.VERTEX_ATTRIB_TEX_COORDS,
						2,
						n.FLOAT,
						!1,
						0,
						i
					),
					n.drawArrays(n.TRIANGLE_STRIP, 0, 4);
			},
			drawInRect: function (t) {
				var e = this,
					i = [0, e.maxT, e.maxS, e.maxT, 0, 0, e.maxS, 0],
					t = [
						t.x,
						t.y,
						t.x + t.width,
						t.y,
						t.x,
						t.y + t.height,
						t.x + t.width,
						t.y + t.height,
					];
				e._shaderProgram.use(),
					e._shaderProgram.setUniformsForBuiltins(),
					cc.glBindTexture2D(e);
				e = cc._renderContext;
				e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_POSITION,
						2,
						e.FLOAT,
						!1,
						0,
						t
					),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_TEX_COORDS,
						2,
						e.FLOAT,
						!1,
						0,
						i
					),
					e.drawArrays(e.TRIANGLE_STRIP, 0, 4);
			},
			initWithImage: function (t) {
				if (null == t)
					return cc.log(cc._LogInfos.Texture2D_initWithImage), !1;
				var e = t.getWidth(),
					i = t.getHeight(),
					n = cc.configuration.getMaxTextureSize();
				return n < e || n < i
					? (cc.log(
							cc._LogInfos.Texture2D_initWithImage_2,
							e,
							i,
							n,
							n
					  ),
					  !1)
					: ((this._textureLoaded = !0),
					  this._initPremultipliedATextureWithImage(t, e, i));
			},
			initWithElement: function (t) {
				t &&
					((this._webTextureObj = cc._renderContext.createTexture()),
					(this._htmlElementObj = t),
					(this._textureLoaded = !0),
					(this._hasPremultipliedAlpha = !0));
			},
			getHtmlElementObj: function () {
				return this._htmlElementObj;
			},
			isLoaded: function () {
				return this._textureLoaded;
			},
			handleLoadedTexture: function (t) {
				var e,
					i = this;
				if (
					((t = void 0 !== t ? t : i._hasPremultipliedAlpha),
					cc.game._rendererInitialized)
				) {
					if (!i._htmlElementObj) {
						var n = cc.loader.getRes(i.url);
						if (!n) return;
						i.initWithElement(n);
					}
					i._htmlElementObj.width &&
						i._htmlElementObj.height &&
						((e = cc._renderContext),
						cc.glBindTexture2D(i),
						e.pixelStorei(e.UNPACK_ALIGNMENT, 4),
						t && e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1),
						e.texImage2D(
							e.TEXTURE_2D,
							0,
							e.RGBA,
							e.RGBA,
							e.UNSIGNED_BYTE,
							i._htmlElementObj
						),
						e.texParameteri(
							e.TEXTURE_2D,
							e.TEXTURE_MIN_FILTER,
							e.LINEAR
						),
						e.texParameteri(
							e.TEXTURE_2D,
							e.TEXTURE_MAG_FILTER,
							e.LINEAR
						),
						e.texParameteri(
							e.TEXTURE_2D,
							e.TEXTURE_WRAP_S,
							e.CLAMP_TO_EDGE
						),
						e.texParameteri(
							e.TEXTURE_2D,
							e.TEXTURE_WRAP_T,
							e.CLAMP_TO_EDGE
						),
						(i.shaderProgram = cc.shaderCache.programForKey(
							cc.SHADER_POSITION_TEXTURE
						)),
						cc.glBindTexture2D(null),
						t && e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0),
						(n = i._htmlElementObj.width),
						(e = i._htmlElementObj.height),
						(i._pixelsWide = i._contentSize.width = n),
						(i._pixelsHigh = i._contentSize.height = e),
						(i._pixelFormat = cc.Texture2D.PIXEL_FORMAT_RGBA8888),
						(i.maxS = 1),
						(i.maxT = 1),
						(i._hasPremultipliedAlpha = t),
						(i._hasMipmaps = !1),
						i.dispatchEvent('load'));
				}
			},
			initWithString: function (t, e, i, n, r, o) {
				return cc.log(cc._LogInfos.Texture2D_initWithString), null;
			},
			initWithETCFile: function (t) {
				return cc.log(cc._LogInfos.Texture2D_initWithETCFile_2), !1;
			},
			initWithPVRFile: function (t) {
				return cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2), !1;
			},
			initWithPVRTCData: function (t, e, i, n, r, o) {
				return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2), !1;
			},
			setTexParameters: function (t, e, i, n) {
				var r = this,
					o = cc._renderContext;
				void 0 !== e &&
					(t = { minFilter: t, magFilter: e, wrapS: i, wrapT: n }),
					cc.assert(
						(r._pixelsWide === cc.NextPOT(r._pixelsWide) &&
							r._pixelsHigh === cc.NextPOT(r._pixelsHigh)) ||
							(t.wrapS === o.CLAMP_TO_EDGE &&
								t.wrapT === o.CLAMP_TO_EDGE),
						'WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures'
					),
					cc.glBindTexture2D(r),
					o.texParameteri(
						o.TEXTURE_2D,
						o.TEXTURE_MIN_FILTER,
						t.minFilter
					),
					o.texParameteri(
						o.TEXTURE_2D,
						o.TEXTURE_MAG_FILTER,
						t.magFilter
					),
					o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_S, t.wrapS),
					o.texParameteri(o.TEXTURE_2D, o.TEXTURE_WRAP_T, t.wrapT);
			},
			setAntiAliasTexParameters: function () {
				var t = cc._renderContext;
				cc.glBindTexture2D(this),
					this._hasMipmaps
						? t.texParameteri(
								t.TEXTURE_2D,
								t.TEXTURE_MIN_FILTER,
								t.LINEAR_MIPMAP_NEAREST
						  )
						: t.texParameteri(
								t.TEXTURE_2D,
								t.TEXTURE_MIN_FILTER,
								t.LINEAR
						  ),
					t.texParameteri(
						t.TEXTURE_2D,
						t.TEXTURE_MAG_FILTER,
						t.LINEAR
					);
			},
			setAliasTexParameters: function () {
				var t = cc._renderContext;
				cc.glBindTexture2D(this),
					this._hasMipmaps
						? t.texParameteri(
								t.TEXTURE_2D,
								t.TEXTURE_MIN_FILTER,
								t.NEAREST_MIPMAP_NEAREST
						  )
						: t.texParameteri(
								t.TEXTURE_2D,
								t.TEXTURE_MIN_FILTER,
								t.NEAREST
						  ),
					t.texParameteri(
						t.TEXTURE_2D,
						t.TEXTURE_MAG_FILTER,
						t.NEAREST
					);
			},
			generateMipmap: function () {
				var t = this;
				cc.assert(
					t._pixelsWide === cc.NextPOT(t._pixelsWide) &&
						t._pixelsHigh === cc.NextPOT(t._pixelsHigh),
					'Mimpap texture only works in POT textures'
				),
					cc.glBindTexture2D(t),
					cc._renderContext.generateMipmap(
						cc._renderContext.TEXTURE_2D
					),
					(t._hasMipmaps = !0);
			},
			stringForFormat: function () {
				return cc.Texture2D._M[this._pixelFormat];
			},
			bitsPerPixelForFormat: function (t) {
				t = t || this._pixelFormat;
				var e = cc.Texture2D._B[t];
				return null != e
					? e
					: (cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat, t),
					  -1);
			},
			_initPremultipliedATextureWithImage: function (t, e, i) {
				var n,
					r,
					o = cc.Texture2D,
					s = t.getData(),
					c = null,
					a = t.hasAlpha(),
					l = cc.size(t.getWidth(), t.getHeight()),
					h = o.defaultPixelFormat,
					u = t.getBitsPerComponent();
				a ||
					(h =
						8 <= u
							? o.PIXEL_FORMAT_RGB888
							: (cc.log(
									cc._LogInfos
										.Texture2D__initPremultipliedATextureWithImage
							  ),
							  o.PIXEL_FORMAT_RGB565));
				var _ = e * i;
				if (h === o.PIXEL_FORMAT_RGB565)
					if (a)
						for (
							s = new Uint16Array(e * i), c = t.getData(), r = 0;
							r < _;
							++r
						)
							s[r] =
								((((c[r] >> 0) & 255) >> 3) << 11) |
								((((c[r] >> 8) & 255) >> 2) << 5) |
								((((c[r] >> 16) & 255) >> 3) << 0);
					else
						for (
							s = new Uint16Array(e * i), n = t.getData(), r = 0;
							r < _;
							++r
						)
							s[r] =
								(((255 & n[r]) >> 3) << 11) |
								(((255 & n[r]) >> 2) << 5) |
								(((255 & n[r]) >> 3) << 0);
				else if (h === o.PIXEL_FORMAT_RGBA4444)
					for (
						s = new Uint16Array(e * i), c = t.getData(), r = 0;
						r < _;
						++r
					)
						s[r] =
							((((c[r] >> 0) & 255) >> 4) << 12) |
							((((c[r] >> 8) & 255) >> 4) << 8) |
							((((c[r] >> 16) & 255) >> 4) << 4) |
							((((c[r] >> 24) & 255) >> 4) << 0);
				else if (h === o.PIXEL_FORMAT_RGB5A1)
					for (
						s = new Uint16Array(e * i), c = t.getData(), r = 0;
						r < _;
						++r
					)
						s[r] =
							((((c[r] >> 0) & 255) >> 3) << 11) |
							((((c[r] >> 8) & 255) >> 3) << 6) |
							((((c[r] >> 16) & 255) >> 3) << 1) |
							((((c[r] >> 24) & 255) >> 7) << 0);
				else if (h === o.PIXEL_FORMAT_A8)
					for (
						s = new Uint8Array(e * i), c = t.getData(), r = 0;
						r < _;
						++r
					)
						s[r] = (c >> 24) & 255;
				if (a && h === o.PIXEL_FORMAT_RGB888)
					for (
						c = t.getData(), s = new Uint8Array(e * i * 3), r = 0;
						r < _;
						++r
					)
						(s[3 * r] = (c >> 0) & 255),
							(s[3 * r + 1] = (c >> 8) & 255),
							(s[3 * r + 2] = (c >> 16) & 255);
				return (
					this.initWithData(s, h, e, i, l),
					s != t.getData() && (s = null),
					(this._hasPremultipliedAlpha = t.isPremultipliedAlpha()),
					!0
				);
			},
			addLoadedEventListener: function (t, e) {
				this.addEventListener('load', t, e);
			},
			removeLoadedEventListener: function (t) {
				this.removeEventTarget('load', t);
			},
		});
	}),
	(cc._tmp.WebGLTextureAtlas = function () {
		var t = cc.TextureAtlas.prototype;
		(t._setupVBO = function () {
			var t = cc._renderContext;
			(this._buffersVBO[0] = t.createBuffer()),
				(this._buffersVBO[1] = t.createBuffer()),
				(this._quadsWebBuffer = t.createBuffer()),
				this._mapBuffers();
		}),
			(t._mapBuffers = function () {
				var t = cc._renderContext;
				t.bindBuffer(t.ARRAY_BUFFER, this._quadsWebBuffer),
					t.bufferData(
						t.ARRAY_BUFFER,
						this._quadsArrayBuffer,
						t.DYNAMIC_DRAW
					),
					t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this._buffersVBO[1]),
					t.bufferData(
						t.ELEMENT_ARRAY_BUFFER,
						this._indices,
						t.STATIC_DRAW
					);
			}),
			(t.drawNumberOfQuads = function (t, e) {
				var i,
					n = this;
				(e = e || 0),
					0 !== t &&
						n.texture &&
						n.texture.isLoaded() &&
						((i = cc._renderContext),
						cc.glBindTexture2D(n.texture),
						i.bindBuffer(i.ARRAY_BUFFER, n._quadsWebBuffer),
						n.dirty &&
							(i.bufferData(
								i.ARRAY_BUFFER,
								n._quadsArrayBuffer,
								i.DYNAMIC_DRAW
							),
							(n.dirty = !1)),
						i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
						i.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
						i.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
						i.vertexAttribPointer(
							cc.VERTEX_ATTRIB_POSITION,
							3,
							i.FLOAT,
							!1,
							24,
							0
						),
						i.vertexAttribPointer(
							cc.VERTEX_ATTRIB_COLOR,
							4,
							i.UNSIGNED_BYTE,
							!0,
							24,
							12
						),
						i.vertexAttribPointer(
							cc.VERTEX_ATTRIB_TEX_COORDS,
							2,
							i.FLOAT,
							!1,
							24,
							16
						),
						i.bindBuffer(i.ELEMENT_ARRAY_BUFFER, n._buffersVBO[1]),
						cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP
							? i.drawElements(
									i.TRIANGLE_STRIP,
									6 * t,
									i.UNSIGNED_SHORT,
									6 * e * n._indices.BYTES_PER_ELEMENT
							  )
							: i.drawElements(
									i.TRIANGLES,
									6 * t,
									i.UNSIGNED_SHORT,
									6 * e * n._indices.BYTES_PER_ELEMENT
							  ),
						cc.g_NumberOfDraws++);
			});
	}),
	(cc._tmp.WebGLTextureCache = function () {
		var t = cc.textureCache;
		(t.handleLoadedTexture = function (t) {
			var e,
				i = this._textures;
			cc.game._rendererInitialized || (i = this._loadedTexturesBefore),
				(e = i[t]) || ((e = i[t] = new cc.Texture2D()).url = t),
				'.png' === cc.path.extname(t)
					? e.handleLoadedTexture(!0)
					: e.handleLoadedTexture();
		}),
			(t.addImage = function (i, n, r) {
				cc.assert(i, cc._LogInfos.Texture2D_addImage_2);
				var o = this._textures;
				cc.game._rendererInitialized ||
					(o = this._loadedTexturesBefore);
				var t = o[i] || o[cc.loader._getAliase(i)];
				if (t)
					return (
						t.isLoaded()
							? n && n.call(r, t)
							: t.addEventListener(
									'load',
									function () {
										n && n.call(r, t);
									},
									r
							  ),
						t
					);
				(t = o[i] = new cc.Texture2D()).url = i;
				var e = cc.loader.getBasePath
					? cc.loader.getBasePath()
					: cc.loader.resPath;
				return (
					cc.loader.loadImg(
						cc.path.join(e || '', i),
						function (t, e) {
							if (t) return n && n.call(r, t);
							cc.loader.cache[i] || (cc.loader.cache[i] = e),
								cc.textureCache.handleLoadedTexture(i);
							e = o[i];
							n && n.call(r, e);
						}
					),
					t
				);
			}),
			(t.addImageAsync = t.addImage),
			(t = null);
	}),
	(cc.ALIGN_CENTER = 51),
	(cc.ALIGN_TOP = 19),
	(cc.ALIGN_TOP_RIGHT = 18),
	(cc.ALIGN_RIGHT = 50),
	(cc.ALIGN_BOTTOM_RIGHT = 34),
	(cc.ALIGN_BOTTOM = 35),
	(cc.ALIGN_BOTTOM_LEFT = 33),
	(cc.ALIGN_LEFT = 49),
	(cc.ALIGN_TOP_LEFT = 17),
	(cc.PVRHaveAlphaPremultiplied_ = !1),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		var t, e;
		cc._renderType === cc.game.RENDER_TYPE_CANVAS
			? ((t = {
					_contentSize: null,
					_textureLoaded: !1,
					_htmlElementObj: null,
					url: null,
					_pattern: null,
					ctor: function () {
						(this._contentSize = cc.size(0, 0)),
							(this._textureLoaded = !1),
							(this._htmlElementObj = null),
							(this._pattern = '');
					},
					getPixelsWide: function () {
						return this._contentSize.width;
					},
					getPixelsHigh: function () {
						return this._contentSize.height;
					},
					getContentSize: function () {
						var t = cc.contentScaleFactor();
						return cc.size(
							this._contentSize.width / t,
							this._contentSize.height / t
						);
					},
					_getWidth: function () {
						return (
							this._contentSize.width / cc.contentScaleFactor()
						);
					},
					_getHeight: function () {
						return (
							this._contentSize.height / cc.contentScaleFactor()
						);
					},
					getContentSizeInPixels: function () {
						return this._contentSize;
					},
					initWithElement: function (t) {
						t &&
							((this._htmlElementObj = t),
							(this._contentSize.width = t.width),
							(this._contentSize.height = t.height),
							(this._textureLoaded = !0));
					},
					getHtmlElementObj: function () {
						return this._htmlElementObj;
					},
					isLoaded: function () {
						return this._textureLoaded;
					},
					handleLoadedTexture: function () {
						var t = this;
						if (!t._textureLoaded) {
							if (!t._htmlElementObj) {
								var e = cc.loader.getRes(t.url);
								if (!e) return;
								t.initWithElement(e);
							}
							e = t._htmlElementObj;
							(t._contentSize.width = e.width),
								(t._contentSize.height = e.height),
								t.dispatchEvent('load');
						}
					},
					description: function () {
						return (
							'<cc.Texture2D | width = ' +
							this._contentSize.width +
							' height ' +
							this._contentSize.height +
							'>'
						);
					},
					initWithData: function (t, e, i, n, r) {
						return !1;
					},
					initWithImage: function (t) {
						return !1;
					},
					initWithString: function (t, e, i, n, r, o) {
						return !1;
					},
					releaseTexture: function () {
						cc.loader.release(this.url);
					},
					getName: function () {
						return null;
					},
					getMaxS: function () {
						return 1;
					},
					setMaxS: function (t) {},
					getMaxT: function () {
						return 1;
					},
					setMaxT: function (t) {},
					getPixelFormat: function () {
						return null;
					},
					getShaderProgram: function () {
						return null;
					},
					setShaderProgram: function (t) {},
					hasPremultipliedAlpha: function () {
						return !1;
					},
					hasMipmaps: function () {
						return !1;
					},
					releaseData: function (t) {
						0;
					},
					keepData: function (t, e) {
						return t;
					},
					drawAtPoint: function (t) {},
					drawInRect: function (t) {},
					initWithETCFile: function (t) {
						return (
							cc.log(cc._LogInfos.Texture2D_initWithETCFile), !1
						);
					},
					initWithPVRFile: function (t) {
						return (
							cc.log(cc._LogInfos.Texture2D_initWithPVRFile), !1
						);
					},
					initWithPVRTCData: function (t, e, i, n, r, o) {
						return (
							cc.log(cc._LogInfos.Texture2D_initWithPVRTCData), !1
						);
					},
					setTexParameters: function (t, e, i, n) {
						void 0 !== e &&
							(t = {
								minFilter: t,
								magFilter: e,
								wrapS: i,
								wrapT: n,
							}),
							t.wrapS !== cc.REPEAT || t.wrapT !== cc.REPEAT
								? t.wrapS !== cc.REPEAT
									? t.wrapT !== cc.REPEAT
										? (this._pattern = '')
										: (this._pattern = 'repeat-y')
									: (this._pattern = 'repeat-x')
								: (this._pattern = 'repeat');
					},
					setAntiAliasTexParameters: function () {},
					setAliasTexParameters: function () {},
					generateMipmap: function () {},
					stringForFormat: function () {
						return '';
					},
					bitsPerPixelForFormat: function (t) {
						return -1;
					},
					addLoadedEventListener: function (t, e) {
						this.addEventListener('load', t, e);
					},
					removeLoadedEventListener: function (t) {
						this.removeEventTarget('load', t);
					},
					_generateColorTexture: function () {},
					_generateTextureCacheForColor: function () {
						if (this.channelCache) return this.channelCache;
						var t = [
							document.createElement('canvas'),
							document.createElement('canvas'),
							document.createElement('canvas'),
							document.createElement('canvas'),
						];
						return (
							e(this._htmlElementObj, t), (this.channelCache = t)
						);
					},
					_grayElementObj: null,
					_backupElement: null,
					_isGray: !1,
					_switchToGray: function (t) {
						this._textureLoaded &&
							this._isGray !== t &&
							((this._isGray = t),
							this._isGray
								? ((this._backupElement = this._htmlElementObj),
								  this._grayElementObj ||
										(this._grayElementObj =
											cc.Texture2D._generateGrayTexture(
												this._htmlElementObj
											)),
								  (this._htmlElementObj = this._grayElementObj))
								: null !== this._backupElement &&
								  (this._htmlElementObj = this._backupElement));
					},
			  }),
			  (e = function (t, e) {
					var i = t.width,
						n = t.height;
					(e[0].width = i),
						(e[0].height = n),
						(e[1].width = i),
						(e[1].height = n),
						(e[2].width = i),
						(e[2].height = n),
						(e[3].width = i),
						(e[3].height = n);
					var r = e[3].getContext('2d');
					r.drawImage(t, 0, 0);
					for (
						var o, s = r.getImageData(0, 0, i, n).data, c = 0;
						c < 4;
						c++
					) {
						for (
							var a = (o = e[c].getContext('2d')).getImageData(
									0,
									0,
									i,
									n
								),
								l = a.data,
								h = 0;
							h < s.length;
							h += 4
						)
							(l[h] = 0 === c ? s[h] : 0),
								(l[h + 1] = 1 === c ? s[h + 1] : 0),
								(l[h + 2] = 2 === c ? s[h + 2] : 0),
								(l[h + 3] = s[h + 3]);
						o.putImageData(a, 0, 0);
					}
					t.onload = null;
			  }),
			  cc.sys._supportCanvasNewBlendModes
					? (t._generateColorTexture = function (t, e, i, n, r) {
							var o = !1;
							r
								? (o = !0)
								: (r = document.createElement('canvas'));
							var s = this._htmlElementObj;
							(n = n || cc.rect(0, 0, s.width, s.height)),
								(r.width = n.width),
								(r.height = n.height);
							var c = r.getContext('2d');
							if (
								((c.globalCompositeOperation = 'source-over'),
								(c.fillStyle =
									'rgb(' +
									(0 | t) +
									',' +
									(0 | e) +
									',' +
									(0 | i) +
									')'),
								c.fillRect(0, 0, n.width, n.height),
								(c.globalCompositeOperation = 'multiply'),
								c.drawImage(
									s,
									n.x,
									n.y,
									n.width,
									n.height,
									0,
									0,
									n.width,
									n.height
								),
								(c.globalCompositeOperation =
									'destination-atop'),
								c.drawImage(
									s,
									n.x,
									n.y,
									n.width,
									n.height,
									0,
									0,
									n.width,
									n.height
								),
								o)
							)
								return r;
							o = new cc.Texture2D();
							return (
								o.initWithElement(r), o.handleLoadedTexture(), o
							);
					  })
					: (t._generateColorTexture = function (t, e, i, n, r) {
							var o = !1;
							r
								? (o = !0)
								: (r = document.createElement('canvas'));
							var s = this._htmlElementObj,
								c = (n = n || cc.rect(0, 0, s.width, s.height))
									.x,
								a = n.y,
								l = n.width,
								h = n.height;
							if (l && h) {
								(r.width = l), (r.height = h);
								(s = r.getContext('2d')),
									(n =
										cc.textureCache.getTextureColors(this));
								if (
									((s.globalCompositeOperation = 'lighter'),
									s.drawImage(n[3], c, a, l, h, 0, 0, l, h),
									0 < t &&
										((s.globalAlpha = t / 255),
										s.drawImage(
											n[0],
											c,
											a,
											l,
											h,
											0,
											0,
											l,
											h
										)),
									0 < e &&
										((s.globalAlpha = e / 255),
										s.drawImage(
											n[1],
											c,
											a,
											l,
											h,
											0,
											0,
											l,
											h
										)),
									0 < i &&
										((s.globalAlpha = i / 255),
										s.drawImage(
											n[2],
											c,
											a,
											l,
											h,
											0,
											0,
											l,
											h
										)),
									o)
								)
									return r;
								o = new cc.Texture2D();
								return (
									o.initWithElement(r),
									o.handleLoadedTexture(),
									o
								);
							}
					  }),
			  (cc.Texture2D = cc.Class.extend(t)),
			  (cc.Texture2D._generateGrayTexture = function (t, e, i) {
					if (null === t) return null;
					(i = i || document.createElement('canvas')),
						(e = e || cc.rect(0, 0, t.width, t.height)),
						(i.width = e.width),
						(i.height = e.height);
					var n = i.getContext('2d');
					n.drawImage(
						t,
						e.x,
						e.y,
						e.width,
						e.height,
						0,
						0,
						e.width,
						e.height
					);
					for (
						var e = n.getImageData(0, 0, e.width, e.height),
							r = e.data,
							o = 0,
							s = r.length;
						o < s;
						o += 4
					)
						r[o] =
							r[o + 1] =
							r[o + 2] =
								0.34 * r[o] + 0.5 * r[o + 1] + 0.16 * r[o + 2];
					return n.putImageData(e, 0, 0), i;
			  }))
			: cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			  (cc.assert(
					cc.isFunction(cc._tmp.WebGLTexture2D),
					cc._LogInfos.MissingFile,
					'TexturesWebGL.js'
			  ),
			  cc._tmp.WebGLTexture2D(),
			  delete cc._tmp.WebGLTexture2D),
			cc.EventHelper.prototype.apply(cc.Texture2D.prototype),
			cc.assert(
				cc.isFunction(cc._tmp.PrototypeTexture2D),
				cc._LogInfos.MissingFile,
				'TexturesPropertyDefine.js'
			),
			cc._tmp.PrototypeTexture2D(),
			delete cc._tmp.PrototypeTexture2D;
	}),
	(cc.textureCache = {
		_textures: {},
		_textureColorsCache: {},
		_textureKeySeq: 0 | (1e3 * Math.random()),
		_loadedTexturesBefore: {},
		_initializingRenderer: function () {
			var t,
				e = this._loadedTexturesBefore,
				i = this._textures;
			for (t in e) {
				var n = e[t];
				n.handleLoadedTexture(), (i[t] = n);
			}
			this._loadedTexturesBefore = {};
		},
		addPVRTCImage: function (t) {
			cc.log(cc._LogInfos.textureCache_addPVRTCImage);
		},
		addETCImage: function (t) {
			cc.log(cc._LogInfos.textureCache_addETCImage);
		},
		description: function () {
			return (
				'<TextureCache | Number of textures = ' +
				this._textures.length +
				'>'
			);
		},
		textureForKey: function (t) {
			return (
				cc.log(cc._LogInfos.textureCache_textureForKey),
				this.getTextureForKey(t)
			);
		},
		getTextureForKey: function (t) {
			return this._textures[t] || this._textures[cc.loader._getAliase(t)];
		},
		getKeyByTexture: function (t) {
			for (var e in this._textures) if (this._textures[e] === t) return e;
			return null;
		},
		_generalTextureKey: function (t) {
			return '_textureKey_' + t;
		},
		getTextureColors: function (t) {
			var e = t._htmlElementObj,
				i =
					(i = this.getKeyByTexture(e)) ||
					(e instanceof HTMLImageElement
						? e.src
						: this._generalTextureKey(t.__instanceId));
			return (
				this._textureColorsCache[i] ||
					(this._textureColorsCache[i] =
						t._generateTextureCacheForColor()),
				this._textureColorsCache[i]
			);
		},
		addPVRImage: function (t) {
			cc.log(cc._LogInfos.textureCache_addPVRImage);
		},
		removeAllTextures: function () {
			var t,
				e = this._textures;
			for (t in e) e[t] && e[t].releaseTexture();
			this._textures = {};
		},
		removeTexture: function (t) {
			if (t) {
				var e,
					i = this._textures;
				for (e in i) i[e] === t && (i[e].releaseTexture(), delete i[e]);
			}
		},
		removeTextureForKey: function (t) {
			null != t && this._textures[t] && delete this._textures[t];
		},
		cacheImage: function (t, e) {
			var i;
			e instanceof cc.Texture2D
				? (this._textures[t] = e)
				: ((i = new cc.Texture2D()).initWithElement(e),
				  i.handleLoadedTexture(),
				  (this._textures[t] = i));
		},
		addUIImage: function (t, e) {
			if (
				(cc.assert(t, cc._LogInfos.textureCache_addUIImage_2),
				e && this._textures[e])
			)
				return this._textures[e];
			var i = new cc.Texture2D();
			return (
				i.initWithImage(t),
				null != e
					? (this._textures[e] = i)
					: cc.log(cc._LogInfos.textureCache_addUIImage),
				i
			);
		},
		dumpCachedTextureInfo: function () {
			var t,
				e = 0,
				i = 0,
				n = this._textures;
			for (t in n) {
				var r = n[t];
				e++,
					r.getHtmlElementObj() instanceof HTMLImageElement
						? cc.log(
								cc._LogInfos.textureCache_dumpCachedTextureInfo,
								t,
								r.getHtmlElementObj().src,
								r.pixelsWidth,
								r.pixelsHeight
						  )
						: cc.log(
								cc._LogInfos
									.textureCache_dumpCachedTextureInfo_2,
								t,
								r.pixelsWidth,
								r.pixelsHeight
						  ),
					(i += r.pixelsWidth * r.pixelsHeight * 4);
			}
			var o = this._textureColorsCache;
			for (t in o) {
				var s,
					c = o[t];
				for (s in c) {
					var a = c[s];
					e++,
						cc.log(
							cc._LogInfos.textureCache_dumpCachedTextureInfo_2,
							t,
							a.width,
							a.height
						),
						(i += a.width * a.height * 4);
				}
			}
			cc.log(
				cc._LogInfos.textureCache_dumpCachedTextureInfo_3,
				e,
				i / 1024,
				(i / 1048576).toFixed(2)
			);
		},
		_clear: function () {
			(this._textures = {}),
				(this._textureColorsCache = {}),
				(this._textureKeySeq = 0 | (1e3 * Math.random())),
				(this._loadedTexturesBefore = {});
		},
	}),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		var t;
		cc._renderType === cc.game.RENDER_TYPE_CANVAS
			? (((t = cc.textureCache).handleLoadedTexture = function (t) {
					var e = this._textures,
						i = e[t];
					i || ((i = e[t] = new cc.Texture2D()).url = t),
						i.handleLoadedTexture();
			  }),
			  (t.addImage = function (i, n, r) {
					cc.assert(i, cc._LogInfos.Texture2D_addImage);
					var o = this._textures,
						t = o[i] || o[cc.loader._getAliase(i)];
					if (t)
						return (
							t.isLoaded()
								? n && n.call(r, t)
								: t.addEventListener(
										'load',
										function () {
											n && n.call(r, t);
										},
										r
								  ),
							t
						);
					(t = o[i] = new cc.Texture2D()).url = i;
					var e = cc.loader.getBasePath
						? cc.loader.getBasePath()
						: cc.loader.resPath;
					return (
						cc.loader.loadImg(
							cc.path.join(e || '', i),
							function (t, e) {
								if (t) return n && n.call(r, t);
								cc.loader.cache[i] || (cc.loader.cache[i] = e),
									cc.textureCache.handleLoadedTexture(i);
								e = o[i];
								n && n.call(r, e);
							}
						),
						t
					);
			  }),
			  (t.addImageAsync = t.addImage),
			  (t = null))
			: cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			  (cc.assert(
					cc.isFunction(cc._tmp.WebGLTextureCache),
					cc._LogInfos.MissingFile,
					'TexturesWebGL.js'
			  ),
			  cc._tmp.WebGLTextureCache(),
			  delete cc._tmp.WebGLTextureCache);
	}),
	(cc.Scene = cc.Node.extend({
		_className: 'Scene',
		ctor: function () {
			cc.Node.prototype.ctor.call(this),
				(this._ignoreAnchorPointForPosition = !0),
				this.setAnchorPoint(0.5, 0.5),
				this.setContentSize(cc.director.getWinSize());
		},
	})),
	(cc.Scene.create = function () {
		return new cc.Scene();
	}),
	(cc.LoaderScene = cc.Scene.extend({
		_interval: null,
		_label: null,
		_className: 'LoaderScene',
		cb: null,
		target: null,
		init: function () {
			var i = this,
				n = 200,
				t = (i._bgLayer = new cc.LayerColor(cc.color(32, 32, 32, 255)));
			i.addChild(t, 0);
			var e = 24,
				r = -n / 2 + 100;
			cc._loaderImage &&
				(cc.loader.loadImg(
					cc._loaderImage,
					{ isCrossOrigin: !1 },
					function (t, e) {
						e.width,
							(n = e.height),
							i._initStage(e, cc.visibleRect.center);
					}
				),
				(e = 14),
				(r = -n / 2 - 10));
			e = i._label = new cc.LabelTTF('Loading... 0%', 'Arial', e);
			return (
				e.setPosition(cc.pAdd(cc.visibleRect.center, cc.p(0, r))),
				e.setColor(cc.color(180, 180, 180)),
				t.addChild(this._label, 10),
				!0
			);
		},
		_initStage: function (t, e) {
			var i = (this._texture2d = new cc.Texture2D());
			i.initWithElement(t), i.handleLoadedTexture();
			i = this._logo = new cc.Sprite(i);
			i.setScale(cc.contentScaleFactor()),
				(i.x = e.x),
				(i.y = e.y),
				this._bgLayer.addChild(i, 10);
		},
		onEnter: function () {
			cc.Node.prototype.onEnter.call(this),
				this.schedule(this._startLoading, 0.3);
		},
		onExit: function () {
			cc.Node.prototype.onExit.call(this);
			this._label.setString('Loading... 0%');
		},
		initWithResources: function (t, e, i) {
			cc.isString(t) && (t = [t]),
				(this.resources = t || []),
				(this.cb = e),
				(this.target = i);
		},
		_startLoading: function () {
			var n = this;
			n.unschedule(n._startLoading);
			var t = n.resources;
			cc.loader.load(
				t,
				function (t, e, i) {
					(e = ((i / e) * 100) | 0), (e = Math.min(e, 100));
					n._label.setString('Loading... ' + e + '%');
				},
				function () {
					n.cb && n.cb.call(n.target);
				}
			);
		},
		_updateTransform: function () {
			this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),
				this._bgLayer._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				),
				this._label._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				),
				this._logo._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
	})),
	(cc.LoaderScene.preload = function (t, e, i) {
		var n = cc;
		return (
			n.loaderScene ||
				((n.loaderScene = new cc.LoaderScene()),
				n.loaderScene.init(),
				cc.eventManager.addCustomListener(
					cc.Director.EVENT_PROJECTION_CHANGED,
					function () {
						n.loaderScene._updateTransform();
					}
				)),
			n.loaderScene.initWithResources(t, e, i),
			cc.director.runScene(n.loaderScene),
			n.loaderScene
		);
	}),
	(cc.Layer = cc.Node.extend({
		_className: 'Layer',
		ctor: function () {
			cc.Node.prototype.ctor.call(this),
				(this._ignoreAnchorPointForPosition = !0),
				this.setAnchorPoint(0.5, 0.5),
				this.setContentSize(cc.winSize);
		},
		init: function () {
			var t = this;
			return (
				(t._ignoreAnchorPointForPosition = !0),
				t.setAnchorPoint(0.5, 0.5),
				t.setContentSize(cc.winSize),
				(t._cascadeColorEnabled = !1),
				!(t._cascadeOpacityEnabled = !1)
			);
		},
		bake: function () {
			this._renderCmd.bake();
		},
		unbake: function () {
			this._renderCmd.unbake();
		},
		isBaked: function () {
			return this._renderCmd._isBaked;
		},
		addChild: function (t, e, i) {
			cc.Node.prototype.addChild.call(this, t, e, i),
				this._renderCmd._bakeForAddChild(t);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.Layer.CanvasRenderCmd
					: cc.Layer.WebGLRenderCmd
			)(this);
		},
	})),
	(cc.Layer.create = function () {
		return new cc.Layer();
	}),
	(cc.LayerColor = cc.Layer.extend({
		_blendFunc: null,
		_className: 'LayerColor',
		getBlendFunc: function () {
			return this._blendFunc;
		},
		changeWidthAndHeight: function (t, e) {
			(this.width = t), (this.height = e);
		},
		changeWidth: function (t) {
			this.width = t;
		},
		changeHeight: function (t) {
			this.height = t;
		},
		setOpacityModifyRGB: function (t) {},
		isOpacityModifyRGB: function () {
			return !1;
		},
		ctor: function (t, e, i) {
			cc.Layer.prototype.ctor.call(this),
				(this._blendFunc = cc.BlendFunc._alphaNonPremultiplied()),
				cc.LayerColor.prototype.init.call(this, t, e, i);
		},
		init: function (t, e, i) {
			var n = cc.director.getWinSize();
			(t = t || cc.color(0, 0, 0, 255)),
				(e = void 0 === e ? n.width : e),
				(i = void 0 === i ? n.height : i);
			n = this._realColor;
			return (
				(n.r = t.r),
				(n.g = t.g),
				(n.b = t.b),
				(this._realOpacity = t.a),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.colorDirty |
						cc.Node._dirtyFlags.opacityDirty
				),
				cc.LayerColor.prototype.setContentSize.call(this, e, i),
				!0
			);
		},
		setBlendFunc: function (t, e) {
			var i = this._blendFunc;
			void 0 === e
				? ((i.src = t.src), (i.dst = t.dst))
				: ((i.src = t), (i.dst = e)),
				this._renderCmd.updateBlendFunc(i);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.LayerColor.CanvasRenderCmd
					: cc.LayerColor.WebGLRenderCmd
			)(this);
		},
	})),
	(cc.LayerColor.create = function (t, e, i) {
		return new cc.LayerColor(t, e, i);
	}),
	(function () {
		var t = cc.LayerColor.prototype;
		cc.defineGetterSetter(t, 'width', t._getWidth, t._setWidth),
			cc.defineGetterSetter(t, 'height', t._getHeight, t._setHeight);
	})(),
	(cc.LayerGradient = cc.LayerColor.extend({
		_endColor: null,
		_startOpacity: 255,
		_endOpacity: 255,
		_alongVector: null,
		_compressedInterpolation: !1,
		_className: 'LayerGradient',
		_colorStops: [],
		ctor: function (t, e, i, n) {
			cc.LayerColor.prototype.ctor.call(this),
				(this._endColor = cc.color(0, 0, 0, 255)),
				(this._alongVector = cc.p(0, -1)),
				(this._startOpacity = 255),
				(this._endOpacity = 255),
				n && n instanceof Array
					? ((this._colorStops = n).splice(0, 0, {
							p: 0,
							color: t || cc.color.BLACK,
					  }),
					  n.push({ p: 1, color: e || cc.color.BLACK }))
					: (this._colorStops = [
							{ p: 0, color: t || cc.color.BLACK },
							{ p: 1, color: e || cc.color.BLACK },
					  ]),
				cc.LayerGradient.prototype.init.call(this, t, e, i, n);
		},
		init: function (t, e, i, n) {
			(t = t || cc.color(0, 0, 0, 255)),
				(e = e || cc.color(0, 0, 0, 255)),
				(i = i || cc.p(0, -1));
			var r = this,
				o = r._endColor;
			return (
				(r._startOpacity = t.a),
				(o.r = e.r),
				(o.g = e.g),
				(o.b = e.b),
				(r._endOpacity = e.a),
				(r._alongVector = i),
				(r._compressedInterpolation = !0),
				cc.LayerColor.prototype.init.call(
					r,
					cc.color(t.r, t.g, t.b, 255)
				),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.colorDirty |
						cc.Node._dirtyFlags.opacityDirty |
						cc.Node._dirtyFlags.gradientDirty
				),
				!0
			);
		},
		setContentSize: function (t, e) {
			cc.LayerColor.prototype.setContentSize.call(this, t, e),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);
		},
		_setWidth: function (t) {
			cc.LayerColor.prototype._setWidth.call(this, t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);
		},
		_setHeight: function (t) {
			cc.LayerColor.prototype._setHeight.call(this, t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);
		},
		getStartColor: function () {
			return cc.color(this._realColor);
		},
		setStartColor: function (t) {
			this.color = t;
			var e = this._colorStops;
			e &&
				0 < e.length &&
				(((e = e[0].color).r = t.r), (e.g = t.g), (e.b = t.b));
		},
		setEndColor: function (t) {
			var e = this._endColor;
			(e.r = t.r), (e.g = t.g), (e.b = t.b);
			e = this._colorStops;
			e &&
				0 < e.length &&
				(((e = e[e.length - 1].color).r = t.r),
				(e.g = t.g),
				(e.b = t.b)),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);
		},
		getEndColor: function () {
			return cc.color(this._endColor);
		},
		setStartOpacity: function (t) {
			this._startOpacity = t;
			var e = this._colorStops;
			e && 0 < e.length && (e[0].color.a = t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);
		},
		getStartOpacity: function () {
			return this._startOpacity;
		},
		setEndOpacity: function (t) {
			this._endOpacity = t;
			var e = this._colorStops;
			e && 0 < e.length && (e[e.length - 1].color.a = t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);
		},
		getEndOpacity: function () {
			return this._endOpacity;
		},
		setVector: function (t) {
			(this._alongVector.x = t.x),
				(this._alongVector.y = t.y),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);
		},
		getVector: function () {
			return cc.p(this._alongVector.x, this._alongVector.y);
		},
		isCompressedInterpolation: function () {
			return this._compressedInterpolation;
		},
		setCompressedInterpolation: function (t) {
			(this._compressedInterpolation = t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty);
		},
		getColorStops: function () {
			return this._colorStops;
		},
		setColorStops: function (t) {
			(this._colorStops = t),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.colorDirty |
						cc.Node._dirtyFlags.opacityDirty |
						cc.Node._dirtyFlags.gradientDirty
				);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.LayerGradient.CanvasRenderCmd
					: cc.LayerGradient.WebGLRenderCmd
			)(this);
		},
	})),
	(cc.LayerGradient.create = function (t, e, i, n) {
		return new cc.LayerGradient(t, e, i, n);
	}),
	(function () {
		var t = cc.LayerGradient.prototype;
		t.startColor,
			cc.defineGetterSetter(
				t,
				'startColor',
				t.getStartColor,
				t.setStartColor
			),
			t.endColor,
			cc.defineGetterSetter(t, 'endColor', t.getEndColor, t.setEndColor),
			t.startOpacity,
			cc.defineGetterSetter(
				t,
				'startOpacity',
				t.getStartOpacity,
				t.setStartOpacity
			),
			t.endOpacity,
			cc.defineGetterSetter(
				t,
				'endOpacity',
				t.getEndOpacity,
				t.setEndOpacity
			),
			t.vector,
			cc.defineGetterSetter(t, 'vector', t.getVector, t.setVector),
			t.colorStops,
			cc.defineGetterSetter(
				t,
				'colorStops',
				t.getColorStops,
				t.setColorStops
			);
	})(),
	(cc.LayerMultiplex = cc.Layer.extend({
		_enabledLayer: 0,
		_layers: null,
		_className: 'LayerMultiplex',
		ctor: function (t) {
			cc.Layer.prototype.ctor.call(this),
				t instanceof Array
					? cc.LayerMultiplex.prototype.initWithLayers.call(this, t)
					: cc.LayerMultiplex.prototype.initWithLayers.call(
							this,
							Array.prototype.slice.call(arguments)
					  );
		},
		initWithLayers: function (t) {
			return (
				0 < t.length &&
					null == t[t.length - 1] &&
					cc.log(cc._LogInfos.LayerMultiplex_initWithLayers),
				(this._layers = t),
				(this._enabledLayer = 0),
				this.addChild(this._layers[this._enabledLayer]),
				!0
			);
		},
		switchTo: function (t) {
			t >= this._layers.length
				? cc.log(cc._LogInfos.LayerMultiplex_switchTo)
				: (this.removeChild(this._layers[this._enabledLayer], !0),
				  (this._enabledLayer = t),
				  this.addChild(this._layers[t]));
		},
		switchToAndReleaseMe: function (t) {
			t >= this._layers.length
				? cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe)
				: (this.removeChild(this._layers[this._enabledLayer], !0),
				  (this._layers[this._enabledLayer] = null),
				  (this._enabledLayer = t),
				  this.addChild(this._layers[t]));
		},
		addLayer: function (t) {
			t
				? this._layers.push(t)
				: cc.log(cc._LogInfos.LayerMultiplex_addLayer);
		},
	})),
	(cc.LayerMultiplex.create = function () {
		return new cc.LayerMultiplex(Array.prototype.slice.call(arguments));
	}),
	(function () {
		cc.Layer.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._isBaked = !1),
				(this._bakeSprite = null),
				(this._canUseDirtyRegion = !0),
				(this._updateCache = 2);
		};
		var t = (cc.Layer.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.Layer.CanvasRenderCmd),
			(t._setCacheDirty = function (t) {
				t && 0 === this._updateCache && (this._updateCache = 2),
					!1 === this._cacheDirty &&
						((this._cacheDirty = !0),
						(t = this._cachedParent) &&
							t !== this &&
							t._setNodeDirtyForCache &&
							t._setNodeDirtyForCache());
			}),
			(t.updateStatus = function () {
				var t = cc.Node._dirtyFlags,
					e = this._dirtyFlag;
				e & t.orderDirty &&
					((this._cacheDirty = !0),
					0 === this._updateCache && (this._updateCache = 2),
					(this._dirtyFlag = (e & t.orderDirty) ^ e)),
					cc.Node.RenderCmd.prototype.updateStatus.call(this);
			}),
			(t._syncStatus = function (t) {
				var e = cc.Node._dirtyFlags,
					i = this._dirtyFlag;
				i & e.orderDirty &&
					((this._cacheDirty = !0),
					0 === this._updateCache && (this._updateCache = 2),
					(this._dirtyFlag = (i & e.orderDirty) ^ i)),
					cc.Node.RenderCmd.prototype._syncStatus.call(this, t);
			}),
			(t.transform = function (t, e) {
				var i = this._worldTransform,
					n = i.a,
					r = i.b,
					o = i.c,
					s = i.d;
				i.tx, i.ty;
				cc.Node.CanvasRenderCmd.prototype.transform.call(this, t, e),
					(i.a === n && i.b === r && i.c === o && i.d === s) ||
						0 !== this._updateCache ||
						(this._updateCache = 2);
			}),
			(t.bake = function () {
				if (!this._isBaked) {
					(this._needDraw = !0),
						(cc.renderer.childrenOrderDirty = !0),
						(this._isBaked = this._cacheDirty = !0),
						0 === this._updateCache && (this._updateCache = 2);
					for (
						var t = this._node._children, e = 0, i = t.length;
						e < i;
						e++
					)
						t[e]._renderCmd._setCachedParent(this);
					this._bakeSprite ||
						((this._bakeSprite = new cc.BakeSprite()),
						this._bakeSprite.setAnchorPoint(0, 0));
				}
			}),
			(t.unbake = function () {
				if (this._isBaked) {
					(cc.renderer.childrenOrderDirty = !0),
						(this._needDraw = !1),
						(this._isBaked = !1),
						(this._cacheDirty = !0),
						0 === this._updateCache && (this._updateCache = 2);
					for (
						var t = this._node._children, e = 0, i = t.length;
						e < i;
						e++
					)
						t[e]._renderCmd._setCachedParent(null);
				}
			}),
			(t.isBaked = function () {
				return this._isBaked;
			}),
			(t.rendering = function () {
				if (this._cacheDirty) {
					var t = this._node,
						e = t._children,
						i = this._bakeSprite;
					this.transform(this.getParentRenderCmd(), !0);
					var n = this._getBoundingBoxForBake();
					(n.width = 0 | (n.width + 0.5)),
						(n.height = 0 | (n.height + 0.5));
					var r = i.getCacheContext(),
						o = r.getContext();
					if ((i.setPosition(n.x, n.y), 0 < this._updateCache)) {
						i.resetCanvasSize(n.width, n.height),
							r.setOffset(
								0 - n.x,
								o.canvas.height - n.height + n.y
							),
							t.sortAllChildren(),
							cc.renderer._turnToCacheMode(this.__instanceId);
						for (var s = 0, c = e.length; s < c; s++)
							e[s].visit(this);
						cc.renderer._renderingToCacheCanvas(
							r,
							this.__instanceId
						),
							i.transform(),
							this._updateCache--;
					}
					this._cacheDirty = !1;
				}
			}),
			(t.visit = function (t) {
				var e, i;
				this._isBaked
					? ((i = (e = this._node)._children.length),
					  e._visible &&
							0 !== i &&
							(this._syncStatus(t),
							cc.renderer.pushRenderCommand(this),
							this._bakeSprite.visit(this),
							(this._dirtyFlag = 0)))
					: this.originVisit(t);
			}),
			(t._bakeForAddChild = function (t) {
				t._parent === this._node &&
					this._isBaked &&
					t._renderCmd._setCachedParent(this);
			}),
			(t._getBoundingBoxForBake = function () {
				var t = null,
					e = this._node;
				if (!e._children || 0 === e._children.length)
					return cc.rect(0, 0, 10, 10);
				for (
					var i = e.getNodeToWorldTransform(),
						n = e._children,
						r = 0,
						o = n.length;
					r < o;
					r++
				) {
					var s,
						c = n[r];
					c &&
						c._visible &&
						(t
							? (s = c._getBoundingBoxToCurrentNode(i)) &&
							  (t = cc.rectUnion(t, s))
							: (t = c._getBoundingBoxToCurrentNode(i)));
				}
				return t;
			});
	})(),
	(function () {
		cc.LayerColor.CanvasRenderCmd = function (t) {
			cc.Layer.CanvasRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._blendFuncStr = 'source-over'),
				(this._bakeRenderCmd = new cc.CustomRenderCmd(
					this,
					this._bakeRendering
				));
		};
		var t = (cc.LayerColor.CanvasRenderCmd.prototype = Object.create(
			cc.Layer.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.LayerColor.CanvasRenderCmd),
			(t.unbake = function () {
				cc.Layer.CanvasRenderCmd.prototype.unbake.call(this),
					(this._needDraw = !0);
			}),
			(t.rendering = function (t, e, i) {
				var n = t || cc._renderContext,
					r = n.getContext(),
					o = this._node,
					s = this._displayedColor,
					c = this._displayedOpacity / 255,
					t = o._contentSize.width,
					o = o._contentSize.height;
				0 != c &&
					(n.setCompositeOperation(this._blendFuncStr),
					n.setGlobalAlpha(c),
					n.setFillStyle(
						'rgba(' +
							(0 | s.r) +
							',' +
							(0 | s.g) +
							',' +
							(0 | s.b) +
							', 1)'
					),
					n.setTransform(this._worldTransform, e, i),
					r.fillRect(0, 0, t, -o),
					cc.g_NumberOfDraws++);
			}),
			(t.updateBlendFunc = function (t) {
				this._blendFuncStr =
					cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(
						t
					);
			}),
			(t._updateSquareVertices =
				t._updateSquareVerticesWidth =
				t._updateSquareVerticesHeight =
					function () {}),
			(t._bakeRendering = function () {
				if (this._cacheDirty) {
					var t,
						e = this._node,
						i = this._bakeSprite,
						n = e._children,
						r = n.length;
					this.transform(this.getParentRenderCmd(), !0);
					var o = this._getBoundingBoxForBake();
					(o.width = 0 | (o.width + 0.5)),
						(o.height = 0 | (o.height + 0.5));
					var s,
						c = i.getCacheContext(),
						a = c.getContext();
					if ((i.setPosition(o.x, o.y), 0 < this._updateCache)) {
						if (
							((a.fillStyle = c._currentFillStyle),
							i.resetCanvasSize(o.width, o.height),
							c.setOffset(
								0 - o.x,
								a.canvas.height - o.height + o.y
							),
							cc.renderer._turnToCacheMode(this.__instanceId),
							0 < r)
						) {
							for (
								e.sortAllChildren(), t = 0;
								t < r && (s = n[t])._localZOrder < 0;
								t++
							)
								s._renderCmd.visit(this);
							for (
								cc.renderer.pushRenderCommand(this);
								t < r;
								t++
							)
								n[t]._renderCmd.visit(this);
						} else cc.renderer.pushRenderCommand(this);
						cc.renderer._renderingToCacheCanvas(
							c,
							this.__instanceId
						),
							i.transform(),
							this._updateCache--;
					}
					this._cacheDirty = !1;
				}
			}),
			(t.visit = function (t) {
				this._isBaked
					? this._node._visible &&
					  (this._syncStatus(t),
					  cc.renderer.pushRenderCommand(this._bakeRenderCmd),
					  this._bakeSprite._renderCmd.setDirtyFlag(
							cc.Node._dirtyFlags.transformDirty
					  ),
					  this._bakeSprite.visit(this),
					  (this._dirtyFlag = 0))
					: this.originVisit();
			}),
			(t._getBoundingBoxForBake = function () {
				var t = this._node,
					e = cc.rect(
						0,
						0,
						t._contentSize.width,
						t._contentSize.height
					),
					i = t.getNodeToWorldTransform();
				if (
					((e = cc.rectApplyAffineTransform(
						e,
						t.getNodeToWorldTransform()
					)),
					!t._children || 0 === t._children.length)
				)
					return e;
				for (var n = t._children, r = 0; r < n.length; r++) {
					var o = n[r];
					o &&
						o._visible &&
						((o = o._getBoundingBoxToCurrentNode(i)),
						(e = cc.rectUnion(e, o)));
				}
				return e;
			});
	})(),
	(function () {
		cc.LayerGradient.CanvasRenderCmd = function (t) {
			cc.LayerColor.CanvasRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._startPoint = cc.p(0, 0)),
				(this._endPoint = cc.p(0, 0)),
				(this._startStopStr = null),
				(this._endStopStr = null);
		};
		var t = (cc.LayerGradient.CanvasRenderCmd.prototype = Object.create(
			cc.LayerColor.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.LayerGradient.CanvasRenderCmd),
			(t.rendering = function (t, e, i) {
				var n = t || cc._renderContext,
					r = n.getContext(),
					o = this._node,
					s = this._displayedOpacity / 255;
				if (0 != s) {
					var c = o._contentSize.width,
						t = o._contentSize.height;
					n.setCompositeOperation(this._blendFuncStr),
						n.setGlobalAlpha(s);
					var a = r.createLinearGradient(
						this._startPoint.x,
						this._startPoint.y,
						this._endPoint.x,
						this._endPoint.y
					);
					if (o._colorStops)
						for (var l = 0; l < o._colorStops.length; l++) {
							var h = o._colorStops[l];
							a.addColorStop(h.p, this._colorStopsStr[l]);
						}
					else
						a.addColorStop(0, this._startStopStr),
							a.addColorStop(1, this._endStopStr);
					n.setFillStyle(a),
						n.setTransform(this._worldTransform, e, i),
						r.fillRect(0, 0, c, -t),
						cc.g_NumberOfDraws++;
				}
			}),
			(t.updateStatus = function () {
				var t = cc.Node._dirtyFlags,
					e = this._dirtyFlag;
				e & t.gradientDirty &&
					((this._dirtyFlag |= t.colorDirty),
					(this._dirtyFlag = (e & t.gradientDirty) ^ e)),
					cc.Node.RenderCmd.prototype.updateStatus.call(this);
			}),
			(t._syncStatus = function (t) {
				var e = cc.Node._dirtyFlags,
					i = this._dirtyFlag;
				i & e.gradientDirty &&
					((this._dirtyFlag |= e.colorDirty),
					(this._dirtyFlag = (i & e.gradientDirty) ^ i)),
					cc.Node.RenderCmd.prototype._syncStatus.call(this, t);
			}),
			(t._updateColor = function () {
				var t = this._node,
					e = t._contentSize,
					i = 0.5 * e.width,
					n = 0.5 * e.height,
					r = cc.pAngleSigned(cc.p(0, -1), t._alongVector),
					e = cc.pRotateByAngle(cc.p(0, -1), cc.p(0, 0), r),
					r = Math.min(Math.abs(1 / e.x), Math.abs(1 / e.y));
				(this._startPoint.x = i * (-e.x * r) + i),
					(this._startPoint.y = n * (e.y * r) - n),
					(this._endPoint.x = i * (e.x * r) + i),
					(this._endPoint.y = n * (-e.y * r) - n);
				(i = this._displayedColor),
					(e = t._endColor),
					(r = t._startOpacity / 255),
					(n = t._endOpacity / 255);
				if (
					((this._startStopStr =
						'rgba(' +
						Math.round(i.r) +
						',' +
						Math.round(i.g) +
						',' +
						Math.round(i.b) +
						',' +
						r.toFixed(4) +
						')'),
					(this._endStopStr =
						'rgba(' +
						Math.round(e.r) +
						',' +
						Math.round(e.g) +
						',' +
						Math.round(e.b) +
						',' +
						n.toFixed(4) +
						')'),
					t._colorStops)
				) {
					(this._startOpacity = 0),
						(this._endOpacity = 0),
						(this._colorStopsStr = []);
					for (var o = 0; o < t._colorStops.length; o++) {
						var s = t._colorStops[o].color,
							c = null == s.a ? 1 : s.a / 255;
						this._colorStopsStr.push(
							'rgba(' +
								Math.round(s.r) +
								',' +
								Math.round(s.g) +
								',' +
								Math.round(s.b) +
								',' +
								c.toFixed(4) +
								')'
						);
					}
				}
			});
	})(),
	(cc._tmp.PrototypeSprite = function () {
		var t = cc.Sprite.prototype;
		cc.defineGetterSetter(
			t,
			'opacityModifyRGB',
			t.isOpacityModifyRGB,
			t.setOpacityModifyRGB
		),
			cc.defineGetterSetter(t, 'opacity', t.getOpacity, t.setOpacity),
			cc.defineGetterSetter(t, 'color', t.getColor, t.setColor),
			t.dirty,
			t.flippedX,
			cc.defineGetterSetter(t, 'flippedX', t.isFlippedX, t.setFlippedX),
			t.flippedY,
			cc.defineGetterSetter(t, 'flippedY', t.isFlippedY, t.setFlippedY),
			t.offsetX,
			cc.defineGetterSetter(t, 'offsetX', t._getOffsetX),
			t.offsetY,
			cc.defineGetterSetter(t, 'offsetY', t._getOffsetY),
			t.atlasIndex,
			t.texture,
			cc.defineGetterSetter(t, 'texture', t.getTexture, t.setTexture),
			t.textureRectRotated,
			cc.defineGetterSetter(
				t,
				'textureRectRotated',
				t.isTextureRectRotated
			),
			t.textureAtlas,
			t.batchNode,
			cc.defineGetterSetter(
				t,
				'batchNode',
				t.getBatchNode,
				t.setBatchNode
			),
			t.quad,
			cc.defineGetterSetter(t, 'quad', t.getQuad);
	}),
	(cc.Sprite = cc.Node.extend({
		dirty: !1,
		atlasIndex: 0,
		textureAtlas: null,
		_batchNode: null,
		_recursiveDirty: null,
		_hasChildren: null,
		_shouldBeHidden: !1,
		_transformToBatch: null,
		_blendFunc: null,
		_texture: null,
		_rect: null,
		_rectRotated: !1,
		_offsetPosition: null,
		_unflippedOffsetPositionFromCenter: null,
		_opacityModifyRGB: !1,
		_flippedX: !1,
		_flippedY: !1,
		_textureLoaded: !1,
		_className: 'Sprite',
		ctor: function (t, e, i) {
			var n = this;
			cc.Node.prototype.ctor.call(n),
				this.setAnchorPoint(0.5, 0.5),
				(n._loader = new cc.Sprite.LoadManager()),
				(n._shouldBeHidden = !1),
				(n._offsetPosition = cc.p(0, 0)),
				(n._unflippedOffsetPositionFromCenter = cc.p(0, 0)),
				(n._blendFunc = { src: cc.BLEND_SRC, dst: cc.BLEND_DST }),
				(n._rect = cc.rect(0, 0, 0, 0)),
				n._softInit(t, e, i);
		},
		textureLoaded: function () {
			return this._textureLoaded;
		},
		addLoadedEventListener: function (t, e) {
			this.addEventListener('load', t, e);
		},
		isDirty: function () {
			return this.dirty;
		},
		setDirty: function (t) {
			this.dirty = t;
		},
		isTextureRectRotated: function () {
			return this._rectRotated;
		},
		getAtlasIndex: function () {
			return this.atlasIndex;
		},
		setAtlasIndex: function (t) {
			this.atlasIndex = t;
		},
		getTextureRect: function () {
			return cc.rect(this._rect);
		},
		getTextureAtlas: function () {
			return this.textureAtlas;
		},
		setTextureAtlas: function (t) {
			this.textureAtlas = t;
		},
		getOffsetPosition: function () {
			return cc.p(this._offsetPosition);
		},
		_getOffsetX: function () {
			return this._offsetPosition.x;
		},
		_getOffsetY: function () {
			return this._offsetPosition.y;
		},
		getBlendFunc: function () {
			return this._blendFunc;
		},
		initWithSpriteFrame: function (t) {
			return (
				cc.assert(t, cc._LogInfos.Sprite_initWithSpriteFrame),
				this.setSpriteFrame(t)
			);
		},
		initWithSpriteFrameName: function (t) {
			cc.assert(t, cc._LogInfos.Sprite_initWithSpriteFrameName);
			var e = cc.spriteFrameCache.getSpriteFrame(t);
			return (
				cc.assert(e, t + cc._LogInfos.Sprite_initWithSpriteFrameName1),
				this.initWithSpriteFrame(e)
			);
		},
		useBatchNode: function (t) {
			(this.textureAtlas = t.getTextureAtlas()), (this._batchNode = t);
		},
		setVertexRect: function (t) {
			var e = this._rect;
			(e.x = t.x),
				(e.y = t.y),
				(e.width = t.width),
				(e.height = t.height),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		sortAllChildren: function () {
			var t;
			this._reorderChildDirty &&
				((t = this._children),
				cc.Node.prototype.sortAllChildren.call(this),
				this._batchNode &&
					this._arrayMakeObjectsPerformSelector(
						t,
						cc.Node._stateCallbackType.sortAllChildren
					),
				(this._reorderChildDirty = !1));
		},
		reorderChild: function (t, e) {
			cc.assert(t, cc._LogInfos.Sprite_reorderChild_2),
				-1 !== this._children.indexOf(t)
					? e !== t.zIndex &&
					  (this._batchNode &&
							!this._reorderChildDirty &&
							(this._setReorderChildDirtyRecursively(),
							this._batchNode.reorderBatch(!0)),
					  cc.Node.prototype.reorderChild.call(this, t, e))
					: cc.log(cc._LogInfos.Sprite_reorderChild);
		},
		removeChild: function (t, e) {
			this._batchNode && this._batchNode.removeSpriteFromAtlas(t),
				cc.Node.prototype.removeChild.call(this, t, e);
		},
		setVisible: function (t) {
			cc.Node.prototype.setVisible.call(this, t),
				this._renderCmd.setDirtyRecursively(!0);
		},
		removeAllChildren: function (t) {
			var e = this._children,
				i = this._batchNode;
			if (i && null != e)
				for (var n = 0, r = e.length; n < r; n++)
					i.removeSpriteFromAtlas(e[n]);
			cc.Node.prototype.removeAllChildren.call(this, t),
				(this._hasChildren = !1);
		},
		ignoreAnchorPointForPosition: function (t) {
			this._batchNode
				? cc.log(cc._LogInfos.Sprite_ignoreAnchorPointForPosition)
				: cc.Node.prototype.ignoreAnchorPointForPosition.call(this, t);
		},
		setFlippedX: function (t) {
			this._flippedX !== t &&
				((this._flippedX = t),
				this.setTextureRect(
					this._rect,
					this._rectRotated,
					this._contentSize
				),
				this.setNodeDirty(!0));
		},
		setFlippedY: function (t) {
			this._flippedY !== t &&
				((this._flippedY = t),
				this.setTextureRect(
					this._rect,
					this._rectRotated,
					this._contentSize
				),
				this.setNodeDirty(!0));
		},
		isFlippedX: function () {
			return this._flippedX;
		},
		isFlippedY: function () {
			return this._flippedY;
		},
		setOpacityModifyRGB: function (t) {
			this._opacityModifyRGB !== t &&
				((this._opacityModifyRGB = t),
				this._renderCmd._setColorDirty());
		},
		isOpacityModifyRGB: function () {
			return this._opacityModifyRGB;
		},
		setDisplayFrameWithAnimationName: function (t, e) {
			cc.assert(
				t,
				cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3
			);
			t = cc.animationCache.getAnimation(t);
			t
				? (e = t.getFrames()[e])
					? this.setSpriteFrame(e.getSpriteFrame())
					: cc.log(
							cc._LogInfos
								.Sprite_setDisplayFrameWithAnimationName_2
					  )
				: cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName);
		},
		getBatchNode: function () {
			return this._batchNode;
		},
		_setReorderChildDirtyRecursively: function () {
			if (!this._reorderChildDirty) {
				this._reorderChildDirty = !0;
				for (var t = this._parent; t && t !== this._batchNode; )
					t._setReorderChildDirtyRecursively(), (t = t.parent);
			}
		},
		getTexture: function () {
			return this._texture;
		},
		_softInit: function (t, e, i) {
			var n;
			void 0 === t
				? cc.Sprite.prototype.init.call(this)
				: cc.isString(t)
				? '#' === t[0]
					? ((n = t.substr(1, t.length - 1)),
					  (n = cc.spriteFrameCache.getSpriteFrame(n))
							? this.initWithSpriteFrame(n)
							: cc.log('%s does not exist', t))
					: cc.Sprite.prototype.init.call(this, t, e)
				: 'object' == typeof t &&
				  (t instanceof cc.Texture2D
						? this.initWithTexture(t, e, i)
						: t instanceof cc.SpriteFrame
						? this.initWithSpriteFrame(t)
						: (t instanceof HTMLImageElement ||
								t instanceof HTMLCanvasElement) &&
						  ((i = new cc.Texture2D()).initWithElement(t),
						  i.handleLoadedTexture(),
						  this.initWithTexture(i)));
		},
		getQuad: function () {
			return null;
		},
		setBlendFunc: function (t, e) {
			var i = this._blendFunc;
			void 0 === e
				? ((i.src = t.src), (i.dst = t.dst))
				: ((i.src = t), (i.dst = e)),
				this._renderCmd.updateBlendFunc(i);
		},
		init: function () {
			var t = this;
			return 0 < arguments.length
				? t.initWithFile(arguments[0], arguments[1])
				: (cc.Node.prototype.init.call(t),
				  (t.dirty = t._recursiveDirty = !1),
				  (t._blendFunc.src = cc.BLEND_SRC),
				  (t._blendFunc.dst = cc.BLEND_DST),
				  (t.texture = null),
				  (t._flippedX = t._flippedY = !1),
				  (t.anchorX = 0.5),
				  (t.anchorY = 0.5),
				  (t._offsetPosition.x = 0),
				  (t._offsetPosition.y = 0),
				  (t._hasChildren = !1),
				  t.setTextureRect(cc.rect(0, 0, 0, 0), !1, cc.size(0, 0)),
				  !0);
		},
		initWithFile: function (t, e) {
			cc.assert(t, cc._LogInfos.Sprite_initWithFile);
			var i,
				n = cc.textureCache.getTextureForKey(t);
			return (n = n || cc.textureCache.addImage(t)).isLoaded()
				? (e ||
						((i = n.getContentSize()),
						(e = cc.rect(0, 0, i.width, i.height))),
				  this.initWithTexture(n, e))
				: (this._loader.clear(),
				  this._loader.once(
						n,
						function () {
							this.initWithFile(t, e), this.dispatchEvent('load');
						},
						this
				  ),
				  !1);
		},
		initWithTexture: function (t, e, i, n) {
			var r = this;
			return (
				cc.assert(
					0 !== arguments.length,
					cc._LogInfos.CCSpriteBatchNode_initWithTexture
				),
				this._loader.clear(),
				(r._textureLoaded = t.isLoaded()),
				r._textureLoaded
					? ((i = i || !1),
					  (t = this._renderCmd._handleTextureForRotatedTexture(
							t,
							e,
							i,
							n
					  )),
					  !!cc.Node.prototype.init.call(r) &&
							((r._batchNode = null),
							(r._recursiveDirty = !1),
							(r.dirty = !1),
							(r._opacityModifyRGB = !0),
							(r._blendFunc.src = cc.BLEND_SRC),
							(r._blendFunc.dst = cc.BLEND_DST),
							(r._flippedX = r._flippedY = !1),
							(r._offsetPosition.x = 0),
							(r._offsetPosition.y = 0),
							(r._hasChildren = !1),
							(r._rectRotated = i),
							e &&
								((r._rect.x = e.x),
								(r._rect.y = e.y),
								(r._rect.width = e.width),
								(r._rect.height = e.height)),
							(e = e || cc.rect(0, 0, t.width, t.height)),
							this._renderCmd._checkTextureBoundary(t, e, i),
							r.setTexture(t),
							r.setTextureRect(e, i),
							r.setBatchNode(null),
							!0))
					: (this._loader.once(
							t,
							function () {
								this.initWithTexture(t, e, i, n),
									this.dispatchEvent('load');
							},
							this
					  ),
					  !1)
			);
		},
		setTextureRect: function (t, e, i, n) {
			var r = this;
			(r._rectRotated = e || !1),
				r.setContentSize(i || t),
				r.setVertexRect(t),
				r._renderCmd._setTextureCoords(t, n);
			(i = r._unflippedOffsetPositionFromCenter.x),
				(t = r._unflippedOffsetPositionFromCenter.y);
			r._flippedX && (i = -i), r._flippedY && (t = -t);
			n = r._rect;
			(r._offsetPosition.x = i + (r._contentSize.width - n.width) / 2),
				(r._offsetPosition.y =
					t + (r._contentSize.height - n.height) / 2);
		},
		addChild: function (t, e, i) {
			cc.assert(t, cc._LogInfos.CCSpriteBatchNode_addChild_2),
				null == e && (e = t._localZOrder),
				null == i && (i = t.tag),
				this._renderCmd._setBatchNodeForAddChild(t) &&
					(cc.Node.prototype.addChild.call(this, t, e, i),
					(this._hasChildren = !0));
		},
		setSpriteFrame: function (t) {
			var e = this;
			cc.isString(t) &&
				((t = cc.spriteFrameCache.getSpriteFrame(t)),
				cc.assert(t, cc._LogInfos.Sprite_setSpriteFrame)),
				this._loader.clear(),
				this.setNodeDirty(!0);
			var i = t.getTexture();
			if (
				((e._textureLoaded = t.textureLoaded()),
				this._loader.clear(),
				!e._textureLoaded)
			)
				return (
					this._loader.once(
						i,
						function () {
							this.setSpriteFrame(t), this.dispatchEvent('load');
						},
						this
					),
					!1
				);
			var n = t.getOffset();
			(e._unflippedOffsetPositionFromCenter.x = n.x),
				(e._unflippedOffsetPositionFromCenter.y = n.y),
				i !== e._texture &&
					(this._renderCmd._setTexture(i), e.setColor(e._realColor)),
				e.setTextureRect(
					t.getRect(),
					t.isRotated(),
					t.getOriginalSize()
				);
		},
		setDisplayFrame: function (t) {
			cc.log(cc._LogInfos.Sprite_setDisplayFrame), this.setSpriteFrame(t);
		},
		isFrameDisplayed: function (t) {
			return this._renderCmd.isFrameDisplayed(t);
		},
		displayFrame: function () {
			return this.getSpriteFrame();
		},
		getSpriteFrame: function () {
			return new cc.SpriteFrame(
				this._texture,
				cc.rectPointsToPixels(this._rect),
				this._rectRotated,
				cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),
				cc.sizePointsToPixels(this._contentSize)
			);
		},
		setBatchNode: function (t) {
			var e = this;
			(e._batchNode = t),
				e._batchNode
					? ((e._transformToBatch = cc.affineTransformIdentity()),
					  (e.textureAtlas = e._batchNode.getTextureAtlas()))
					: ((e.atlasIndex = cc.Sprite.INDEX_NOT_INITIALIZED),
					  (e.textureAtlas = null),
					  (e._recursiveDirty = !1),
					  (e.dirty = !1));
		},
		setTexture: function (t) {
			if (!t) return this._renderCmd._setTexture(null);
			var e = cc.isString(t);
			if (
				(e && (t = cc.textureCache.addImage(t)),
				this._loader.clear(),
				!t._textureLoaded)
			)
				return (
					this._loader.once(
						t,
						function () {
							this.setTexture(t), this.dispatchEvent('load');
						},
						this
					),
					!1
				);
			this._renderCmd._setTexture(t),
				e && this._changeRectWithTexture(t),
				this.setColor(this._realColor),
				(this._textureLoaded = !0);
		},
		_changeRectWithTexture: function (t) {
			(t = t._contentSize), (t = cc.rect(0, 0, t.width, t.height));
			this.setTextureRect(t);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.Sprite.CanvasRenderCmd
					: cc.Sprite.WebGLRenderCmd
			)(this);
		},
	})),
	(cc.Sprite.create = function (t, e, i) {
		return new cc.Sprite(t, e, i);
	}),
	(cc.Sprite.createWithTexture = cc.Sprite.create),
	(cc.Sprite.createWithSpriteFrameName = cc.Sprite.create),
	(cc.Sprite.createWithSpriteFrame = cc.Sprite.create),
	(cc.Sprite.INDEX_NOT_INITIALIZED = -1),
	cc.EventHelper.prototype.apply(cc.Sprite.prototype),
	cc.assert(
		cc.isFunction(cc._tmp.PrototypeSprite),
		cc._LogInfos.MissingFile,
		'SpritesPropertyDefine.js'
	),
	cc._tmp.PrototypeSprite(),
	delete cc._tmp.PrototypeSprite,
	(function () {
		var t = (cc.Sprite.LoadManager = function () {
			this.list = [];
		});
		(t.prototype.add = function (t, e, i) {
			t &&
				t.addEventListener &&
				(t.addEventListener('load', e, i),
				this.list.push({ source: t, listener: e, target: i }));
		}),
			(t.prototype.once = function (e, i, n) {
				var r;
				e &&
					e.addEventListener &&
					((r = function (t) {
						e.removeEventListener('load', r, n), i.call(n, t);
					}),
					e.addEventListener('load', r, n),
					this.list.push({ source: e, listener: r, target: n }));
			}),
			(t.prototype.clear = function () {
				for (; 0 < this.list.length; ) {
					var t = this.list.pop();
					t.source.removeEventListener('load', t.listener, t.target);
				}
			});
	})(),
	(function () {
		cc.Sprite.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._textureCoord = {
					renderX: 0,
					renderY: 0,
					x: 0,
					y: 0,
					width: 0,
					height: 0,
					validRect: !1,
				}),
				(this._blendFuncStr = 'source-over'),
				(this._colorized = !1),
				(this._canUseDirtyRegion = !0),
				(this._textureToRender = null);
		};
		var t = (cc.Sprite.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.Sprite.CanvasRenderCmd),
			(t.setDirtyRecursively = function (t) {}),
			(t._setTexture = function (t) {
				var e = this._node;
				e._texture !== t &&
					((e._textureLoaded = !!t && t._textureLoaded),
					(e._texture = t),
					this._updateColor());
			}),
			(t._setColorDirty = function () {
				this.setDirtyFlag(
					cc.Node._dirtyFlags.colorDirty |
						cc.Node._dirtyFlags.opacityDirty
				);
			}),
			(t.isFrameDisplayed = function (t) {
				var e = this._node;
				return (
					t.getTexture() === e._texture &&
					cc.rectEqualToRect(t.getRect(), e._rect)
				);
			}),
			(t.updateBlendFunc = function (t) {
				this._blendFuncStr =
					cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(
						t
					);
			}),
			(t._setBatchNodeForAddChild = function (t) {
				return !0;
			}),
			(t._handleTextureForRotatedTexture = function (t, e, i, n) {
				return (
					i &&
						t.isLoaded() &&
						((i = t.getHtmlElementObj()),
						(i = cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(
							i,
							e,
							n
						)),
						(n = new cc.Texture2D()).initWithElement(i),
						n.handleLoadedTexture(),
						(t = n),
						(e.x = e.y = 0),
						(this._node._rect = cc.rect(0, 0, e.width, e.height))),
					t
				);
			}),
			(t._checkTextureBoundary = function (t, e, i) {
				var n;
				t &&
					t.url &&
					((n = e.x + e.width),
					(e = e.y + e.height),
					n > t.width && cc.error(cc._LogInfos.RectWidth, t.url),
					e > t.height && cc.error(cc._LogInfos.RectHeight, t.url));
			}),
			(t.rendering = function (t, e, i) {
				var n,
					r,
					o,
					s,
					c,
					a,
					l,
					h,
					u,
					_ = this._node,
					d = this._textureCoord,
					p = this._displayedOpacity / 255,
					f = this._textureToRender || _._texture;
				(!f || (0 !== d.width && 0 !== d.height && f._textureLoaded)) &&
					0 != p &&
					((r = (n = t || cc._renderContext).getContext()),
					(l = _._offsetPosition.x),
					(o = _._rect.height),
					(u = _._rect.width),
					(h = -_._offsetPosition.y - o),
					n.setTransform(this._worldTransform, e, i),
					n.setCompositeOperation(this._blendFuncStr),
					n.setGlobalAlpha(p),
					(_._flippedX || _._flippedY) && n.save(),
					_._flippedX && ((l = -l - u), r.scale(-1, 1)),
					_._flippedY && ((h = _._offsetPosition.y), r.scale(1, -1)),
					(c = this._colorized
						? (s = 0)
						: ((s = d.renderX), d.renderY)),
					(a = d.width),
					(t = d.height),
					(p = l),
					(l = h),
					(h = u),
					(u = o),
					f && f._htmlElementObj
						? ((o = f._htmlElementObj),
						  '' !== f._pattern
								? (n.setFillStyle(
										r.createPattern(o, f._pattern)
								  ),
								  r.fillRect(p, l, h, u))
								: r.drawImage(o, s, c, a, t, p, l, h, u))
						: ((u = _._contentSize),
						  d.validRect &&
								((d = this._displayedColor),
								n.setFillStyle(
									'rgba(' +
										d.r +
										',' +
										d.g +
										',' +
										d.b +
										',1)'
								),
								r.fillRect(p, l, u.width * e, u.height * i))),
					(_._flippedX || _._flippedY) && n.restore(),
					cc.g_NumberOfDraws++);
			}),
			(t._updateColor = function () {
				var t = this._node._texture,
					e = this._textureCoord,
					i = this._displayedColor;
				t &&
					(255 !== i.r || 255 !== i.g || 255 !== i.b
						? ((this._textureToRender = t._generateColorTexture(
								i.r,
								i.g,
								i.b,
								e
						  )),
						  (this._colorized = !0))
						: t &&
						  ((this._textureToRender = t),
						  (this._colorized = !1)));
			}),
			(t._textureLoadedCallback = function (t) {
				var e,
					i,
					n = this;
				n._textureLoaded ||
					((n._textureLoaded = !0),
					(i = n._rect),
					(e = this._renderCmd),
					i
						? cc._rectEqualToZero(i) &&
						  ((i.width = t.width), (i.height = t.height))
						: (i = cc.rect(0, 0, t.width, t.height)),
					(n.texture = t),
					n.setTextureRect(i, n._rectRotated),
					(255 === (i = e._displayedColor).r &&
						255 === i.g &&
						255 === i.b) ||
						e._updateColor(),
					n.setBatchNode(n._batchNode),
					n.dispatchEvent('load'));
			}),
			(t._setTextureCoords = function (t, e) {
				void 0 === e && (e = !0);
				var i = this._textureCoord,
					e = e ? cc.contentScaleFactor() : 1;
				(i.renderX = i.x = 0 | (t.x * e)),
					(i.renderY = i.y = 0 | (t.y * e)),
					(i.width = 0 | (t.width * e)),
					(i.height = 0 | (t.height * e)),
					(i.validRect = !(
						0 === i.width ||
						0 === i.height ||
						i.x < 0 ||
						i.y < 0
					));
			}),
			(cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas = function (
				t,
				e,
				i
			) {
				if (!t) return null;
				if (!e) return t;
				i = null == i || i;
				var n = document.createElement('canvas');
				(n.width = e.width), (n.height = e.height);
				var r = n.getContext('2d');
				return (
					r.translate(n.width / 2, n.height / 2),
					i
						? r.rotate(-1.5707963267948966)
						: r.rotate(1.5707963267948966),
					r.drawImage(
						t,
						e.x,
						e.y,
						e.height,
						e.width,
						-e.height / 2,
						-e.width / 2,
						e.height,
						e.width
					),
					n
				);
			});
	})(),
	(cc.BakeSprite = cc.Sprite.extend({
		_cacheCanvas: null,
		_cacheContext: null,
		ctor: function () {
			cc.Sprite.prototype.ctor.call(this);
			var t = document.createElement('canvas');
			(t.width = t.height = 10),
				(this._cacheCanvas = t),
				(this._cacheContext = new cc.CanvasContextWrapper(
					t.getContext('2d')
				));
			var e = new cc.Texture2D();
			e.initWithElement(t), e.handleLoadedTexture(), this.setTexture(e);
		},
		getCacheContext: function () {
			return this._cacheContext;
		},
		getCacheCanvas: function () {
			return this._cacheCanvas;
		},
		resetCanvasSize: function (t, e) {
			var i = this._cacheCanvas,
				n = this._cacheContext,
				r = n._context.strokeStyle,
				o = n._context.fillStyle;
			void 0 === e && ((e = t.height), (t = t.width)),
				(i.width = t),
				(i.height = e),
				r !== n._context.strokeStyle && (n._context.strokeStyle = r),
				o !== n._context.fillStyle && (n._context.fillStyle = o),
				this.getTexture().handleLoadedTexture(),
				this.setTextureRect(cc.rect(0, 0, t, e), !1, null, !1);
		},
	})),
	(cc.AnimationFrame = cc.Class.extend({
		_spriteFrame: null,
		_delayPerUnit: 0,
		_userInfo: null,
		ctor: function (t, e, i) {
			(this._spriteFrame = t || null),
				(this._delayPerUnit = e || 0),
				(this._userInfo = i || null);
		},
		clone: function () {
			var t = new cc.AnimationFrame();
			return (
				t.initWithSpriteFrame(
					this._spriteFrame.clone(),
					this._delayPerUnit,
					this._userInfo
				),
				t
			);
		},
		copyWithZone: function (t) {
			return cc.clone(this);
		},
		copy: function (t) {
			var e = new cc.AnimationFrame();
			return (
				e.initWithSpriteFrame(
					this._spriteFrame.clone(),
					this._delayPerUnit,
					this._userInfo
				),
				e
			);
		},
		initWithSpriteFrame: function (t, e, i) {
			return (
				(this._spriteFrame = t),
				(this._delayPerUnit = e),
				(this._userInfo = i),
				!0
			);
		},
		getSpriteFrame: function () {
			return this._spriteFrame;
		},
		setSpriteFrame: function (t) {
			this._spriteFrame = t;
		},
		getDelayUnits: function () {
			return this._delayPerUnit;
		},
		setDelayUnits: function (t) {
			this._delayPerUnit = t;
		},
		getUserInfo: function () {
			return this._userInfo;
		},
		setUserInfo: function (t) {
			this._userInfo = t;
		},
	})),
	(cc.AnimationFrame.create = function (t, e, i) {
		return new cc.AnimationFrame(t, e, i);
	}),
	(cc.Animation = cc.Class.extend({
		_frames: null,
		_loops: 0,
		_restoreOriginalFrame: !1,
		_duration: 0,
		_delayPerUnit: 0,
		_totalDelayUnits: 0,
		ctor: function (t, e, i) {
			var n;
			(this._frames = []),
				void 0 === t
					? this.initWithSpriteFrames(null, 0)
					: (n = t[0]) &&
					  (n instanceof cc.SpriteFrame
							? this.initWithSpriteFrames(t, e, i)
							: n instanceof cc.AnimationFrame &&
							  this.initWithAnimationFrames(t, e, i));
		},
		getFrames: function () {
			return this._frames;
		},
		setFrames: function (t) {
			this._frames = t;
		},
		addSpriteFrame: function (t) {
			var e = new cc.AnimationFrame();
			e.initWithSpriteFrame(t, 1, null),
				this._frames.push(e),
				this._totalDelayUnits++;
		},
		addSpriteFrameWithFile: function (t) {
			var e = cc.textureCache.addImage(t),
				t = cc.rect(0, 0, 0, 0);
			(t.width = e.width), (t.height = e.height);
			t = new cc.SpriteFrame(e, t);
			this.addSpriteFrame(t);
		},
		addSpriteFrameWithTexture: function (t, e) {
			e = new cc.SpriteFrame(t, e);
			this.addSpriteFrame(e);
		},
		initWithAnimationFrames: function (t, e, i) {
			cc.arrayVerifyType(t, cc.AnimationFrame),
				(this._delayPerUnit = e),
				(this._loops = void 0 === i ? 1 : i),
				(this._totalDelayUnits = 0);
			for (var n = this._frames, r = (n.length = 0); r < t.length; r++) {
				var o = t[r];
				n.push(o), (this._totalDelayUnits += o.getDelayUnits());
			}
			return !0;
		},
		clone: function () {
			var t = new cc.Animation();
			return (
				t.initWithAnimationFrames(
					this._copyFrames(),
					this._delayPerUnit,
					this._loops
				),
				t.setRestoreOriginalFrame(this._restoreOriginalFrame),
				t
			);
		},
		copyWithZone: function (t) {
			var e = new cc.Animation();
			return (
				e.initWithAnimationFrames(
					this._copyFrames(),
					this._delayPerUnit,
					this._loops
				),
				e.setRestoreOriginalFrame(this._restoreOriginalFrame),
				e
			);
		},
		_copyFrames: function () {
			for (var t = [], e = 0; e < this._frames.length; e++)
				t.push(this._frames[e].clone());
			return t;
		},
		copy: function (t) {
			return this.copyWithZone(null);
		},
		getLoops: function () {
			return this._loops;
		},
		setLoops: function (t) {
			this._loops = t;
		},
		setRestoreOriginalFrame: function (t) {
			this._restoreOriginalFrame = t;
		},
		getRestoreOriginalFrame: function () {
			return this._restoreOriginalFrame;
		},
		getDuration: function () {
			return this._totalDelayUnits * this._delayPerUnit;
		},
		getDelayPerUnit: function () {
			return this._delayPerUnit;
		},
		setDelayPerUnit: function (t) {
			this._delayPerUnit = t;
		},
		getTotalDelayUnits: function () {
			return this._totalDelayUnits;
		},
		initWithSpriteFrames: function (t, e, i) {
			cc.arrayVerifyType(t, cc.SpriteFrame),
				(this._loops = void 0 === i ? 1 : i),
				(this._delayPerUnit = e || 0),
				(this._totalDelayUnits = 0);
			var n = this._frames;
			if (((n.length = 0), t)) {
				for (var r = 0; r < t.length; r++) {
					var o = t[r],
						s = new cc.AnimationFrame();
					s.initWithSpriteFrame(o, 1, null), n.push(s);
				}
				this._totalDelayUnits += t.length;
			}
			return !0;
		},
		retain: function () {},
		release: function () {},
	})),
	(cc.Animation.create = function (t, e, i) {
		return new cc.Animation(t, e, i);
	}),
	(cc.Animation.createWithAnimationFrames = cc.Animation.create),
	(cc.animationCache = {
		_animations: {},
		addAnimation: function (t, e) {
			this._animations[e] = t;
		},
		removeAnimation: function (t) {
			t && this._animations[t] && delete this._animations[t];
		},
		getAnimation: function (t) {
			return this._animations[t] || null;
		},
		_addAnimationsWithDictionary: function (t, e) {
			var i = t.animations;
			if (i) {
				var n = 1,
					t = t.properties;
				if (t) {
					n = null != t.format ? parseInt(t.format) : n;
					for (
						var r = t.spritesheets,
							o = cc.spriteFrameCache,
							s = cc.path,
							c = 0;
						c < r.length;
						c++
					)
						o.addSpriteFrames(s.changeBasename(e, r[c]));
				}
				switch (n) {
					case 1:
						this._parseVersion1(i);
						break;
					case 2:
						this._parseVersion2(i);
						break;
					default:
						cc.log(
							cc._LogInfos
								.animationCache__addAnimationsWithDictionary_2
						);
				}
			} else
				cc.log(
					cc._LogInfos.animationCache__addAnimationsWithDictionary
				);
		},
		addAnimations: function (t) {
			cc.assert(t, cc._LogInfos.animationCache_addAnimations_2);
			var e = cc.loader.getRes(t);
			e
				? this._addAnimationsWithDictionary(e, t)
				: cc.log(cc._LogInfos.animationCache_addAnimations);
		},
		_parseVersion1: function (t) {
			var e,
				i = cc.spriteFrameCache;
			for (e in t) {
				var n = t[e],
					r = n.frames,
					o = parseFloat(n.delay) || 0;
				if (r) {
					for (var s = [], c = 0; c < r.length; c++) {
						var a,
							l = i.getSpriteFrame(r[c]);
						l
							? ((a =
									new cc.AnimationFrame()).initWithSpriteFrame(
									l,
									1,
									null
							  ),
							  s.push(a))
							: cc.log(
									cc._LogInfos
										.animationCache__parseVersion1_2,
									e,
									r[c]
							  );
					}
					0 !== s.length
						? (s.length !== r.length &&
								cc.log(
									cc._LogInfos
										.animationCache__parseVersion1_4,
									e
								),
						  (n = new cc.Animation(s, o, 1)),
						  cc.animationCache.addAnimation(n, e))
						: cc.log(
								cc._LogInfos.animationCache__parseVersion1_3,
								e
						  );
				} else cc.log(cc._LogInfos.animationCache__parseVersion1, e);
			}
		},
		_parseVersion2: function (t) {
			var e,
				i = cc.spriteFrameCache;
			for (e in t) {
				var n = t[e],
					r = n.loop,
					o = parseInt(n.loops),
					s = r ? cc.REPEAT_FOREVER : isNaN(o) ? 1 : o,
					r = !(
						!n.restoreOriginalFrame || 1 != n.restoreOriginalFrame
					),
					c = n.frames;
				if (c) {
					for (var a = [], l = 0; l < c.length; l++) {
						var h,
							u,
							_ = c[l],
							d = _.spriteframe,
							p = i.getSpriteFrame(d);
						p
							? ((h = parseFloat(_.delayUnits) || 0),
							  (u = _.notification),
							  (_ = new cc.AnimationFrame()).initWithSpriteFrame(
									p,
									h,
									u
							  ),
							  a.push(_))
							: cc.log(
									cc._LogInfos
										.animationCache__parseVersion2_2,
									e,
									d
							  );
					}
					(o = parseFloat(n.delayPerUnit) || 0),
						(n = new cc.Animation());
					n.initWithAnimationFrames(a, o, s),
						n.setRestoreOriginalFrame(r),
						cc.animationCache.addAnimation(n, e);
				} else cc.log(cc._LogInfos.animationCache__parseVersion2, e);
			}
		},
		_clear: function () {
			this._animations = {};
		},
	}),
	(cc.SpriteFrame = cc.Class.extend({
		_offset: null,
		_originalSize: null,
		_rectInPixels: null,
		_rotated: !1,
		_rect: null,
		_offsetInPixels: null,
		_originalSizeInPixels: null,
		_texture: null,
		_textureFilename: '',
		_textureLoaded: !1,
		ctor: function (t, e, i, n, r) {
			(this._offset = cc.p(0, 0)),
				(this._offsetInPixels = cc.p(0, 0)),
				(this._originalSize = cc.size(0, 0)),
				(this._rotated = !1),
				(this._originalSizeInPixels = cc.size(0, 0)),
				(this._textureFilename = ''),
				(this._texture = null),
				(this._textureLoaded = !1),
				void 0 !== t &&
					void 0 !== e &&
					(void 0 === i || void 0 === n || void 0 === r
						? this.initWithTexture(t, e)
						: this.initWithTexture(t, e, i, n, r));
		},
		textureLoaded: function () {
			return this._textureLoaded;
		},
		addLoadedEventListener: function (t, e) {
			this.addEventListener('load', t, e);
		},
		getRectInPixels: function () {
			var t = this._rectInPixels;
			return cc.rect(t.x, t.y, t.width, t.height);
		},
		setRectInPixels: function (t) {
			this._rectInPixels || (this._rectInPixels = cc.rect(0, 0, 0, 0)),
				(this._rectInPixels.x = t.x),
				(this._rectInPixels.y = t.y),
				(this._rectInPixels.width = t.width),
				(this._rectInPixels.height = t.height),
				(this._rect = cc.rectPixelsToPoints(t));
		},
		isRotated: function () {
			return this._rotated;
		},
		setRotated: function (t) {
			this._rotated = t;
		},
		getRect: function () {
			var t = this._rect;
			return cc.rect(t.x, t.y, t.width, t.height);
		},
		setRect: function (t) {
			this._rect || (this._rect = cc.rect(0, 0, 0, 0)),
				(this._rect.x = t.x),
				(this._rect.y = t.y),
				(this._rect.width = t.width),
				(this._rect.height = t.height),
				(this._rectInPixels = cc.rectPointsToPixels(this._rect));
		},
		getOffsetInPixels: function () {
			return cc.p(this._offsetInPixels);
		},
		setOffsetInPixels: function (t) {
			(this._offsetInPixels.x = t.x),
				(this._offsetInPixels.y = t.y),
				cc._pointPixelsToPointsOut(this._offsetInPixels, this._offset);
		},
		getOriginalSizeInPixels: function () {
			return cc.size(this._originalSizeInPixels);
		},
		setOriginalSizeInPixels: function (t) {
			(this._originalSizeInPixels.width = t.width),
				(this._originalSizeInPixels.height = t.height);
		},
		getOriginalSize: function () {
			return cc.size(this._originalSize);
		},
		setOriginalSize: function (t) {
			(this._originalSize.width = t.width),
				(this._originalSize.height = t.height);
		},
		getTexture: function () {
			if (this._texture) return this._texture;
			if ('' === this._textureFilename) return null;
			var t = cc.textureCache.addImage(this._textureFilename);
			return t && (this._textureLoaded = t.isLoaded()), t;
		},
		setTexture: function (t) {
			var e;
			this._texture !== t &&
				((e = t.isLoaded()),
				(this._textureLoaded = e),
				(this._texture = t),
				e ||
					t.addEventListener(
						'load',
						function (t) {
							var e;
							(this._textureLoaded = !0),
								this._rotated &&
									cc._renderType ===
										cc.game.RENDER_TYPE_CANVAS &&
									((e = t.getHtmlElementObj()),
									(e =
										cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(
											e,
											this.getRect()
										)),
									(i = new cc.Texture2D()).initWithElement(e),
									i.handleLoadedTexture(),
									this.setTexture(i),
									(i = this.getRect()),
									this.setRect(
										cc.rect(0, 0, i.width, i.height)
									));
							var i = this._rect;
							0 === i.width &&
								0 === i.height &&
								((i = t.width),
								(t = t.height),
								(this._rect.width = i),
								(this._rect.height = t),
								(this._rectInPixels = cc.rectPointsToPixels(
									this._rect
								)),
								(this._originalSizeInPixels.width =
									this._rectInPixels.width),
								(this._originalSizeInPixels.height =
									this._rectInPixels.height),
								(this._originalSize.width = i),
								(this._originalSize.height = t)),
								this.dispatchEvent('load');
						},
						this
					));
		},
		getOffset: function () {
			return cc.p(this._offset);
		},
		setOffset: function (t) {
			(this._offset.x = t.x), (this._offset.y = t.y);
		},
		clone: function () {
			var t = new cc.SpriteFrame();
			return (
				t.initWithTexture(
					this._textureFilename,
					this._rectInPixels,
					this._rotated,
					this._offsetInPixels,
					this._originalSizeInPixels
				),
				t.setTexture(this._texture),
				t
			);
		},
		copyWithZone: function () {
			var t = new cc.SpriteFrame();
			return (
				t.initWithTexture(
					this._textureFilename,
					this._rectInPixels,
					this._rotated,
					this._offsetInPixels,
					this._originalSizeInPixels
				),
				t.setTexture(this._texture),
				t
			);
		},
		copy: function () {
			return this.copyWithZone();
		},
		initWithTexture: function (t, e, i, n, r) {
			var o, s;
			return (
				2 === arguments.length && (e = cc.rectPointsToPixels(e)),
				(n = n || cc.p(0, 0)),
				(r = r || e),
				(i = i || !1),
				cc.isString(t)
					? ((this._texture = null), (this._textureFilename = t))
					: t instanceof cc.Texture2D && this.setTexture(t),
				(t = this.getTexture()),
				(this._rectInPixels = e),
				(this._rect = cc.rectPixelsToPoints(e)),
				t &&
					t.url &&
					t.isLoaded() &&
					((s = i
						? ((o = e.x + e.height), e.y + e.width)
						: ((o = e.x + e.width), e.y + e.height)),
					o > t.getPixelsWide() &&
						cc.error(cc._LogInfos.RectWidth, t.url),
					s > t.getPixelsHigh() &&
						cc.error(cc._LogInfos.RectHeight, t.url)),
				(this._offsetInPixels.x = n.x),
				(this._offsetInPixels.y = n.y),
				cc._pointPixelsToPointsOut(n, this._offset),
				(this._originalSizeInPixels.width = r.width),
				(this._originalSizeInPixels.height = r.height),
				cc._sizePixelsToPointsOut(r, this._originalSize),
				(this._rotated = i),
				!0
			);
		},
	})),
	cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype),
	(cc.SpriteFrame.create = function (t, e, i, n, r) {
		return new cc.SpriteFrame(t, e, i, n, r);
	}),
	(cc.SpriteFrame.createWithTexture = cc.SpriteFrame.create),
	(cc.SpriteFrame._frameWithTextureForCanvas = function (t, e, i, n, r) {
		var o = new cc.SpriteFrame();
		return (
			(o._texture = t),
			(o._rectInPixels = e),
			(o._rect = cc.rectPixelsToPoints(e)),
			(o._offsetInPixels.x = n.x),
			(o._offsetInPixels.y = n.y),
			cc._pointPixelsToPointsOut(o._offsetInPixels, o._offset),
			(o._originalSizeInPixels.width = r.width),
			(o._originalSizeInPixels.height = r.height),
			cc._sizePixelsToPointsOut(o._originalSizeInPixels, o._originalSize),
			(o._rotated = i),
			o
		);
	}),
	(cc.spriteFrameCache = {
		_CCNS_REG1:
			/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,
		_CCNS_REG2:
			/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,
		_spriteFrames: {},
		_spriteFramesAliases: {},
		_frameConfigCache: {},
		_rectFromString: function (t) {
			t = this._CCNS_REG2.exec(t);
			return t
				? cc.rect(
						parseFloat(t[1]),
						parseFloat(t[2]),
						parseFloat(t[3]),
						parseFloat(t[4])
				  )
				: cc.rect(0, 0, 0, 0);
		},
		_pointFromString: function (t) {
			t = this._CCNS_REG1.exec(t);
			return t ? cc.p(parseFloat(t[1]), parseFloat(t[2])) : cc.p(0, 0);
		},
		_sizeFromString: function (t) {
			t = this._CCNS_REG1.exec(t);
			return t
				? cc.size(parseFloat(t[1]), parseFloat(t[2]))
				: cc.size(0, 0);
		},
		_getFrameConfig: function (t) {
			var e = cc.loader.getRes(t);
			return (
				cc.assert(
					e,
					cc._LogInfos.spriteFrameCache__getFrameConfig_2,
					t
				),
				cc.loader.release(t),
				e._inited
					? (this._frameConfigCache[t] = e)
					: ((this._frameConfigCache[t] = this._parseFrameConfig(e)),
					  this._frameConfigCache[t])
			);
		},
		_getFrameConfigByJsonObject: function (t, e) {
			return (
				cc.assert(
					e,
					cc._LogInfos.spriteFrameCache__getFrameConfig_2,
					t
				),
				(this._frameConfigCache[t] = this._parseFrameConfig(e)),
				this._frameConfigCache[t]
			);
		},
		_parseFrameConfig: function (t) {
			var e = t.frames,
				i = t.metadata || t.meta,
				n = {},
				r = {},
				o = 0;
			for (u in (i &&
				((o = (t = i.format).length <= 1 ? parseInt(t) : t),
				(r.image = i.textureFileName || i.textureFileName || i.image)),
			e)) {
				var s,
					c,
					a,
					l,
					h,
					u,
					_ = e[u];
				_ &&
					((s = {}),
					0 == o
						? ((s.rect = cc.rect(_.x, _.y, _.width, _.height)),
						  (s.rotated = !1),
						  (s.offset = cc.p(_.offsetX, _.offsetY)),
						  (c = _.originalWidth),
						  (a = _.originalHeight),
						  (c && a) ||
								cc.log(
									cc._LogInfos
										.spriteFrameCache__getFrameConfig
								),
						  (c = Math.abs(c)),
						  (a = Math.abs(a)),
						  (s.size = cc.size(c, a)))
						: 1 == o || 2 == o
						? ((s.rect = this._rectFromString(_.frame)),
						  (s.rotated = _.rotated || !1),
						  (s.offset = this._pointFromString(_.offset)),
						  (s.size = this._sizeFromString(_.sourceSize)))
						: 3 == o
						? ((l = this._sizeFromString(_.spriteSize)),
						  (h = this._rectFromString(_.textureRect)),
						  l && (h = cc.rect(h.x, h.y, l.width, l.height)),
						  (s.rect = h),
						  (s.rotated = _.textureRotated || !1),
						  (s.offset = this._pointFromString(_.spriteOffset)),
						  (s.size = this._sizeFromString(_.spriteSourceSize)),
						  (s.aliases = _.aliases))
						: ((l = _.frame),
						  (h = _.sourceSize),
						  (u = _.filename || u),
						  (s.rect = cc.rect(l.x, l.y, l.w, l.h)),
						  (s.rotated = _.rotated || !1),
						  (s.offset = cc.p(0, 0)),
						  (s.size = cc.size(h.w, h.h))),
					(n[u] = s));
			}
			return { _inited: !0, frames: n, meta: r };
		},
		_addSpriteFramesByObject: function (t, e, i) {
			cc.assert(t, cc._LogInfos.spriteFrameCache_addSpriteFrames_2),
				e &&
					e.frames &&
					((e =
						this._frameConfigCache[t] ||
						this._getFrameConfigByJsonObject(t, e)),
					this._createSpriteFrames(t, e, i));
		},
		_createSpriteFrames: function (t, e, i) {
			var n = e.frames,
				e = e.meta;
			i
				? i instanceof cc.Texture2D ||
				  (cc.isString(i)
						? (i = cc.textureCache.addImage(i))
						: cc.assert(
								0,
								cc._LogInfos.spriteFrameCache_addSpriteFrames_3
						  ))
				: ((e = cc.path.changeBasename(t, e.image || '.png')),
				  (i = cc.textureCache.addImage(e)));
			var r,
				o = this._spriteFramesAliases,
				s = this._spriteFrames;
			for (r in n) {
				var c = n[r],
					a = s[r];
				if (!a) {
					a = new cc.SpriteFrame(
						i,
						c.rect,
						c.rotated,
						c.offset,
						c.size
					);
					var l,
						h = c.aliases;
					if (h)
						for (var u = 0, _ = h.length; u < _; u++) {
							var d = h[u];
							o[d] &&
								cc.log(
									cc._LogInfos
										.spriteFrameCache_addSpriteFrames,
									d
								),
								(o[d] = r);
						}
					cc._renderType === cc.game.RENDER_TYPE_CANVAS &&
						a.isRotated() &&
						a.getTexture().isLoaded() &&
						((l = a.getTexture().getHtmlElementObj()),
						(l = cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(
							l,
							a.getRectInPixels()
						)),
						(c = new cc.Texture2D()).initWithElement(l),
						c.handleLoadedTexture(),
						a.setTexture(c),
						(c = a._rect),
						a.setRect(cc.rect(0, 0, c.width, c.height))),
						(s[r] = a);
				}
			}
		},
		addSpriteFrames: function (t, e) {
			cc.assert(t, cc._LogInfos.spriteFrameCache_addSpriteFrames_2);
			var i = this._frameConfigCache[t] || cc.loader.getRes(t);
			i &&
				i.frames &&
				((i = this._frameConfigCache[t] || this._getFrameConfig(t)),
				this._createSpriteFrames(t, i, e));
		},
		_checkConflict: function (t) {
			for (var e in t.frames)
				this._spriteFrames[e] &&
					cc.log(cc._LogInfos.spriteFrameCache__checkConflict, e);
		},
		addSpriteFrame: function (t, e) {
			this._spriteFrames[e] = t;
		},
		removeSpriteFrames: function () {
			(this._spriteFrames = {}), (this._spriteFramesAliases = {});
		},
		removeSpriteFrameByName: function (t) {
			t &&
				(this._spriteFramesAliases[t] &&
					delete this._spriteFramesAliases[t],
				this._spriteFrames[t] && delete this._spriteFrames[t]);
		},
		removeSpriteFramesFromFile: function (t) {
			var e,
				i = this._spriteFrames,
				n = this._spriteFramesAliases,
				t = this._frameConfigCache[t];
			if (t)
				for (e in t.frames)
					if (i[e])
						for (var r in (delete i[e], n))
							n[r] === e && delete n[r];
		},
		removeSpriteFramesFromTexture: function (t) {
			var e,
				i = this._spriteFrames,
				n = this._spriteFramesAliases;
			for (e in i) {
				var r = i[e];
				if (r && r.getTexture() === t)
					for (var o in (delete i[e], n)) n[o] === e && delete n[o];
			}
		},
		getSpriteFrame: function (t) {
			var e,
				i = this._spriteFrames[t];
			return (
				i ||
					((e = this._spriteFramesAliases[t]) &&
						((i = this._spriteFrames[e.toString()]) ||
							delete this._spriteFramesAliases[t])),
				i
			);
		},
		_clear: function () {
			(this._spriteFrames = {}),
				(this._spriteFramesAliases = {}),
				(this._frameConfigCache = {});
		},
	}),
	(cc.g_NumberOfDraws = 0),
	(cc.Director = cc.Class.extend({
		_landscape: !1,
		_nextDeltaTimeZero: !1,
		_paused: !1,
		_purgeDirectorInNextLoop: !1,
		_sendCleanupToScene: !1,
		_animationInterval: 0,
		_oldAnimationInterval: 0,
		_projection: 0,
		_contentScaleFactor: 1,
		_deltaTime: 0,
		_winSizeInPoints: null,
		_lastUpdate: null,
		_nextScene: null,
		_notificationNode: null,
		_openGLView: null,
		_scenesStack: null,
		_projectionDelegate: null,
		_runningScene: null,
		_totalFrames: 0,
		_secondsPerFrame: 0,
		_dirtyRegion: null,
		_scheduler: null,
		_actionManager: null,
		_eventProjectionChanged: null,
		_eventAfterUpdate: null,
		_eventAfterVisit: null,
		_eventAfterDraw: null,
		ctor: function () {
			var t = this;
			(t._lastUpdate = Date.now()),
				cc.eventManager.addCustomListener(
					cc.game.EVENT_SHOW,
					function () {
						t._lastUpdate = Date.now();
					}
				);
		},
		init: function () {
			return (
				(this._oldAnimationInterval = this._animationInterval =
					1 / cc.defaultFPS),
				(this._scenesStack = []),
				(this._projection = cc.Director.PROJECTION_DEFAULT),
				(this._projectionDelegate = null),
				(this._totalFrames = 0),
				(this._lastUpdate = Date.now()),
				(this._paused = !1),
				(this._purgeDirectorInNextLoop = !1),
				(this._winSizeInPoints = cc.size(0, 0)),
				(this._openGLView = null),
				(this._contentScaleFactor = 1),
				(this._scheduler = new cc.Scheduler()),
				cc.ActionManager
					? ((this._actionManager = new cc.ActionManager()),
					  this._scheduler.scheduleUpdate(
							this._actionManager,
							cc.Scheduler.PRIORITY_SYSTEM,
							!1
					  ))
					: (this._actionManager = null),
				(this._eventAfterUpdate = new cc.EventCustom(
					cc.Director.EVENT_AFTER_UPDATE
				)),
				this._eventAfterUpdate.setUserData(this),
				(this._eventAfterVisit = new cc.EventCustom(
					cc.Director.EVENT_AFTER_VISIT
				)),
				this._eventAfterVisit.setUserData(this),
				(this._eventAfterDraw = new cc.EventCustom(
					cc.Director.EVENT_AFTER_DRAW
				)),
				this._eventAfterDraw.setUserData(this),
				(this._eventProjectionChanged = new cc.EventCustom(
					cc.Director.EVENT_PROJECTION_CHANGED
				)),
				this._eventProjectionChanged.setUserData(this),
				!0
			);
		},
		calculateDeltaTime: function () {
			var t = Date.now();
			this._nextDeltaTimeZero
				? ((this._deltaTime = 0), (this._nextDeltaTimeZero = !1))
				: (this._deltaTime = (t - this._lastUpdate) / 1e3),
				0 < cc.game.config[cc.game.CONFIG_KEY.debugMode] &&
					0.2 < this._deltaTime &&
					(this._deltaTime = 1 / 60),
				(this._lastUpdate = t);
		},
		convertToGL: function (t) {
			var e = document.documentElement,
				i = cc.view,
				n = element.getBoundingClientRect();
			(n.left += window.pageXOffset - e.clientLeft),
				(n.top += window.pageYOffset - e.clientTop);
			(e = i._devicePixelRatio * (t.x - n.left)),
				(t = i._devicePixelRatio * (n.top + n.height - t.y));
			return i._isRotated
				? { x: i._viewPortRect.width - t, y: e }
				: { x: e, y: t };
		},
		convertToUI: function (t) {
			var e = document.documentElement,
				i = cc.view,
				n = element.getBoundingClientRect();
			(n.left += window.pageXOffset - e.clientLeft),
				(n.top += window.pageYOffset - e.clientTop);
			e = { x: 0, y: 0 };
			return (
				i._isRotated
					? ((e.x = n.left + t.y / i._devicePixelRatio),
					  (e.y =
							n.top +
							n.height -
							(i._viewPortRect.width - t.x) /
								i._devicePixelRatio))
					: ((e.x = n.left + t.x / i._devicePixelRatio),
					  (e.y = n.top + n.height - t.y / i._devicePixelRatio)),
				e
			);
		},
		drawScene: function () {
			var t = cc.renderer;
			this.calculateDeltaTime(),
				this._paused ||
					(this._scheduler.update(this._deltaTime),
					cc.eventManager.dispatchEvent(this._eventAfterUpdate)),
				this._nextScene && this.setNextScene(),
				this._beforeVisitScene && this._beforeVisitScene(),
				this._runningScene &&
					(t.childrenOrderDirty
						? (cc.renderer.clearRenderCommands(),
						  (cc.renderer.assignedZ = 0),
						  (this._runningScene._renderCmd._curLevel = 0),
						  this._runningScene.visit(),
						  t.resetFlag())
						: t.transformDirty() && t.transform()),
				t.clear(),
				this._notificationNode && this._notificationNode.visit(),
				cc.eventManager.dispatchEvent(this._eventAfterVisit),
				(cc.g_NumberOfDraws = 0),
				this._afterVisitScene && this._afterVisitScene(),
				t.rendering(cc._renderContext),
				this._totalFrames++,
				cc.eventManager.dispatchEvent(this._eventAfterDraw),
				this._calculateMPF();
		},
		_beforeVisitScene: null,
		_afterVisitScene: null,
		end: function () {
			this._purgeDirectorInNextLoop = !0;
		},
		getContentScaleFactor: function () {
			return this._contentScaleFactor;
		},
		getNotificationNode: function () {
			return this._notificationNode;
		},
		getWinSize: function () {
			return cc.size(this._winSizeInPoints);
		},
		getWinSizeInPixels: function () {
			return cc.size(
				this._winSizeInPoints.width * this._contentScaleFactor,
				this._winSizeInPoints.height * this._contentScaleFactor
			);
		},
		getVisibleSize: null,
		getVisibleOrigin: null,
		getZEye: null,
		pause: function () {
			this._paused ||
				((this._oldAnimationInterval = this._animationInterval),
				this.setAnimationInterval(0.25),
				(this._paused = !0));
		},
		popScene: function () {
			cc.assert(this._runningScene, cc._LogInfos.Director_popScene),
				this._scenesStack.pop();
			var t = this._scenesStack.length;
			0 === t
				? this.end()
				: ((this._sendCleanupToScene = !0),
				  (this._nextScene = this._scenesStack[t - 1]));
		},
		purgeCachedData: function () {
			cc.animationCache._clear(),
				cc.spriteFrameCache._clear(),
				cc.textureCache._clear();
		},
		purgeDirector: function () {
			this.getScheduler().unscheduleAll(),
				cc.eventManager && cc.eventManager.setEnabled(!1),
				this._runningScene &&
					(this._runningScene.onExitTransitionDidStart(),
					this._runningScene.onExit(),
					this._runningScene.cleanup()),
				(this._runningScene = null),
				(this._nextScene = null),
				(this._scenesStack.length = 0),
				this.stopAnimation(),
				this.purgeCachedData(),
				cc.checkGLErrorDebug();
		},
		pushScene: function (t) {
			cc.assert(t, cc._LogInfos.Director_pushScene),
				(this._sendCleanupToScene = !1),
				this._scenesStack.push(t),
				(this._nextScene = t);
		},
		runScene: function (t) {
			var e;
			cc.assert(t, cc._LogInfos.Director_pushScene),
				this._runningScene
					? (0 === (e = this._scenesStack.length)
							? ((this._sendCleanupToScene = !0),
							  (this._scenesStack[e] = t))
							: ((this._sendCleanupToScene = !0),
							  (this._scenesStack[e - 1] = t)),
					  (this._nextScene = t))
					: (this.pushScene(t), this.startAnimation());
		},
		resume: function () {
			this._paused &&
				(this.setAnimationInterval(this._oldAnimationInterval),
				(this._lastUpdate = Date.now()),
				this._lastUpdate || cc.log(cc._LogInfos.Director_resume),
				(this._paused = !1),
				(this._deltaTime = 0));
		},
		setContentScaleFactor: function (t) {
			t !== this._contentScaleFactor && (this._contentScaleFactor = t);
		},
		setDepthTest: null,
		setClearColor: null,
		setDefaultValues: function () {},
		setNextDeltaTimeZero: function (t) {
			this._nextDeltaTimeZero = t;
		},
		setNextScene: function () {
			var t = !1,
				e = !1;
			cc.TransitionScene &&
				((t =
					!!this._runningScene &&
					this._runningScene instanceof cc.TransitionScene),
				(e =
					!!this._nextScene &&
					this._nextScene instanceof cc.TransitionScene)),
				e ||
					((e = this._runningScene) &&
						(e.onExitTransitionDidStart(), e.onExit()),
					this._sendCleanupToScene && e && e.cleanup()),
				(this._runningScene = this._nextScene),
				(cc.renderer.childrenOrderDirty = !0),
				(this._nextScene = null),
				t ||
					null === this._runningScene ||
					(this._runningScene.onEnter(),
					this._runningScene.onEnterTransitionDidFinish());
		},
		setNotificationNode: function (t) {
			(cc.renderer.childrenOrderDirty = !0),
				this._notificationNode &&
					(this._notificationNode.onExitTransitionDidStart(),
					this._notificationNode.onExit(),
					this._notificationNode.cleanup()),
				(this._notificationNode = t) &&
					(this._notificationNode.onEnter(),
					this._notificationNode.onEnterTransitionDidFinish());
		},
		getDelegate: function () {
			return this._projectionDelegate;
		},
		setDelegate: function (t) {
			this._projectionDelegate = t;
		},
		setOpenGLView: null,
		setProjection: null,
		setViewport: null,
		getOpenGLView: null,
		getProjection: null,
		setAlphaBlending: null,
		isSendCleanupToScene: function () {
			return this._sendCleanupToScene;
		},
		getRunningScene: function () {
			return this._runningScene;
		},
		getAnimationInterval: function () {
			return this._animationInterval;
		},
		isDisplayStats: function () {
			return !!cc.profiler && cc.profiler.isShowingStats();
		},
		setDisplayStats: function (t) {
			cc.profiler &&
				(t ? cc.profiler.showStats() : cc.profiler.hideStats());
		},
		getSecondsPerFrame: function () {
			return this._secondsPerFrame;
		},
		isNextDeltaTimeZero: function () {
			return this._nextDeltaTimeZero;
		},
		isPaused: function () {
			return this._paused;
		},
		getTotalFrames: function () {
			return this._totalFrames;
		},
		popToRootScene: function () {
			this.popToSceneStackLevel(1);
		},
		popToSceneStackLevel: function (t) {
			cc.assert(
				this._runningScene,
				cc._LogInfos.Director_popToSceneStackLevel_2
			);
			var e = this._scenesStack,
				i = e.length;
			if (0 !== t) {
				if (!(i <= t)) {
					for (; t < i; ) {
						var n = e.pop();
						n.running && (n.onExitTransitionDidStart(), n.onExit()),
							n.cleanup(),
							i--;
					}
					(this._nextScene = e[e.length - 1]),
						(this._sendCleanupToScene = !0);
				}
			} else this.end();
		},
		getScheduler: function () {
			return this._scheduler;
		},
		setScheduler: function (t) {
			this._scheduler !== t && (this._scheduler = t);
		},
		getActionManager: function () {
			return this._actionManager;
		},
		setActionManager: function (t) {
			this._actionManager !== t && (this._actionManager = t);
		},
		getDeltaTime: function () {
			return this._deltaTime;
		},
		_calculateMPF: function () {
			var t = Date.now();
			this._secondsPerFrame = (t - this._lastUpdate) / 1e3;
		},
	})),
	(cc.Director.EVENT_PROJECTION_CHANGED = 'director_projection_changed'),
	(cc.Director.EVENT_AFTER_UPDATE = 'director_after_update'),
	(cc.Director.EVENT_AFTER_VISIT = 'director_after_visit'),
	(cc.Director.EVENT_AFTER_DRAW = 'director_after_draw'),
	(cc.DisplayLinkDirector = cc.Director.extend({
		invalid: !1,
		startAnimation: function () {
			(this._nextDeltaTimeZero = !0), (this.invalid = !1);
		},
		mainLoop: function () {
			this._purgeDirectorInNextLoop
				? ((this._purgeDirectorInNextLoop = !1), this.purgeDirector())
				: this.invalid || this.drawScene();
		},
		stopAnimation: function () {
			this.invalid = !0;
		},
		setAnimationInterval: function (t) {
			(this._animationInterval = t),
				this.invalid || (this.stopAnimation(), this.startAnimation());
		},
	})),
	(cc.Director.sharedDirector = null),
	(cc.Director.firstUseDirector = !0),
	(cc.Director._getInstance = function () {
		return (
			cc.Director.firstUseDirector &&
				((cc.Director.firstUseDirector = !1),
				(cc.Director.sharedDirector = new cc.DisplayLinkDirector()),
				cc.Director.sharedDirector.init()),
			cc.Director.sharedDirector
		);
	}),
	(cc.defaultFPS = 60),
	(cc.Director.PROJECTION_2D = 0),
	(cc.Director.PROJECTION_3D = 1),
	(cc.Director.PROJECTION_CUSTOM = 3),
	(cc.Director.PROJECTION_DEFAULT = cc.Director.PROJECTION_2D),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		var t;
		cc._renderType === cc.game.RENDER_TYPE_CANVAS
			? (((t = cc.Director.prototype).getProjection = function (t) {
					return this._projection;
			  }),
			  (t.setProjection = function (t) {
					(this._projection = t),
						cc.eventManager.dispatchEvent(
							this._eventProjectionChanged
						);
			  }),
			  (t.setDepthTest = function () {}),
			  (t.setClearColor = function (t) {
					(cc.renderer._clearColor = t),
						(cc.renderer._clearFillStyle =
							'rgb(' + t.r + ',' + t.g + ',' + t.b + ')');
			  }),
			  (t.setOpenGLView = function (t) {
					(this._winSizeInPoints.width = cc._canvas.width),
						(this._winSizeInPoints.height = cc._canvas.height),
						(this._openGLView = t || cc.view),
						cc.eventManager && cc.eventManager.setEnabled(!0);
			  }),
			  (t.getVisibleSize = function () {
					return this.getWinSize();
			  }),
			  (t.getVisibleOrigin = function () {
					return cc.p(0, 0);
			  }))
			: ((cc.Director._fpsImage = new Image()),
			  cc.Director._fpsImage.addEventListener('load', function () {
					cc.Director._fpsImageLoaded = !0;
			  }),
			  cc._fpsImage && (cc.Director._fpsImage.src = cc._fpsImage));
	}),
	(cc.PRIORITY_NON_SYSTEM = cc.PRIORITY_SYSTEM + 1),
	(cc.ListEntry = function (t, e, i, n, r, o, s) {
		(this.prev = t),
			(this.next = e),
			(this.callback = i),
			(this.target = n),
			(this.priority = r),
			(this.paused = o),
			(this.markedForDeletion = s);
	}),
	(cc.HashUpdateEntry = function (t, e, i, n, r) {
		(this.list = t),
			(this.entry = e),
			(this.target = i),
			(this.callback = n),
			(this.hh = r);
	}),
	(cc.HashTimerEntry = cc.hashSelectorEntry =
		function (t, e, i, n, r, o, s) {
			var c = this;
			(c.timers = t),
				(c.target = e),
				(c.timerIndex = i),
				(c.currentTimer = n),
				(c.currentTimerSalvaged = r),
				(c.paused = o),
				(c.hh = s);
		}),
	(cc.Timer = cc.Class.extend({
		_scheduler: null,
		_elapsed: 0,
		_runForever: !1,
		_useDelay: !1,
		_timesExecuted: 0,
		_repeat: 0,
		_delay: 0,
		_interval: 0,
		getInterval: function () {
			return this._interval;
		},
		setInterval: function (t) {
			this._interval = t;
		},
		setupTimerWithInterval: function (t, e, i) {
			(this._elapsed = -1),
				(this._interval = t),
				(this._delay = i),
				(this._useDelay = 0 < this._delay),
				(this._repeat = e),
				(this._runForever = this._repeat === cc.REPEAT_FOREVER);
		},
		trigger: function () {
			return 0;
		},
		cancel: function () {
			return 0;
		},
		ctor: function () {
			(this._scheduler = null),
				(this._elapsed = -1),
				(this._runForever = !1),
				(this._useDelay = !1),
				(this._timesExecuted = 0),
				(this._repeat = 0),
				(this._delay = 0),
				(this._interval = 0);
		},
		update: function (t) {
			-1 === this._elapsed
				? ((this._elapsed = 0), (this._timesExecuted = 0))
				: ((this._elapsed += t),
				  this._runForever && !this._useDelay
						? this._elapsed >= this._interval &&
						  (this.trigger(), (this._elapsed = 0))
						: (this._useDelay
								? this._elapsed >= this._delay &&
								  (this.trigger(),
								  (this._elapsed -= this._delay),
								  (this._timesExecuted += 1),
								  (this._useDelay = !1))
								: this._elapsed >= this._interval &&
								  (this.trigger(),
								  (this._elapsed = 0),
								  (this._timesExecuted += 1)),
						  !this._runForever &&
								this._timesExecuted > this._repeat &&
								this.cancel()));
		},
	})),
	(cc.TimerTargetSelector = cc.Timer.extend({
		_target: null,
		_selector: null,
		ctor: function () {
			(this._target = null), (this._selector = null);
		},
		initWithSelector: function (t, e, i, n, r, o) {
			return (
				(this._scheduler = t),
				(this._target = i),
				(this._selector = e),
				this.setupTimerWithInterval(n, r, o),
				!0
			);
		},
		getSelector: function () {
			return this._selector;
		},
		trigger: function () {
			this._target &&
				this._selector &&
				this._target.call(this._selector, this._elapsed);
		},
		cancel: function () {
			this._scheduler.unschedule(this._selector, this._target);
		},
	})),
	(cc.TimerTargetCallback = cc.Timer.extend({
		_target: null,
		_callback: null,
		_key: null,
		ctor: function () {
			(this._target = null), (this._callback = null);
		},
		initWithCallback: function (t, e, i, n, r, o, s) {
			return (
				(this._scheduler = t),
				(this._target = i),
				(this._callback = e),
				(this._key = n),
				this.setupTimerWithInterval(r, o, s),
				!0
			);
		},
		getCallback: function () {
			return this._callback;
		},
		getKey: function () {
			return this._key;
		},
		trigger: function () {
			this._callback && this._callback.call(this._target, this._elapsed);
		},
		cancel: function () {
			this._scheduler.unschedule(this._callback, this._target);
		},
	})),
	(cc.Scheduler = cc.Class.extend({
		_timeScale: 1,
		_updatesNegList: null,
		_updates0List: null,
		_updatesPosList: null,
		_hashForTimers: null,
		_arrayForTimers: null,
		_hashForUpdates: null,
		_currentTarget: null,
		_currentTargetSalvaged: !1,
		_updateHashLocked: !1,
		ctor: function () {
			(this._timeScale = 1),
				(this._updatesNegList = []),
				(this._updates0List = []),
				(this._updatesPosList = []),
				(this._hashForUpdates = {}),
				(this._hashForTimers = {}),
				(this._currentTarget = null),
				(this._currentTargetSalvaged = !1),
				(this._updateHashLocked = !1),
				(this._arrayForTimers = []);
		},
		_schedulePerFrame: function (t, e, i, n) {
			var r = this._hashForUpdates[e.__instanceId];
			if (r && r.entry) {
				if (r.entry.priority === i)
					return (
						(r.entry.markedForDeletion = !1),
						void (r.entry.paused = n)
					);
				if (this._updateHashLocked)
					return (
						cc.log(
							'warning: you CANNOT change update priority in scheduled function'
						),
						(r.entry.markedForDeletion = !1),
						void (r.entry.paused = n)
					);
				this.unscheduleUpdate(e);
			}
			0 === i
				? this._appendIn(this._updates0List, t, e, n)
				: i < 0
				? this._priorityIn(this._updatesNegList, t, e, i, n)
				: this._priorityIn(this._updatesPosList, t, e, i, n);
		},
		_removeHashElement: function (t) {
			delete this._hashForTimers[t.target.__instanceId],
				cc.arrayRemoveObject(this._arrayForTimers, t),
				(t.Timer = null),
				(t.target = null),
				(t = null);
		},
		_removeUpdateFromHash: function (t) {
			t = this._hashForUpdates[t.target.__instanceId];
			t &&
				(cc.arrayRemoveObject(t.list, t.entry),
				delete this._hashForUpdates[t.target.__instanceId],
				(t.entry = null),
				(t.target = null));
		},
		_priorityIn: function (t, e, i, n, r) {
			r = new cc.ListEntry(null, null, e, i, n, r, !1);
			if (t) {
				for (var o = t.length - 1, s = 0; s <= o; s++)
					if (n < t[s].priority) {
						o = s;
						break;
					}
				t.splice(s, 0, r);
			} else (t = []).push(r);
			return (
				(this._hashForUpdates[i.__instanceId] = new cc.HashUpdateEntry(
					t,
					r,
					i,
					null
				)),
				t
			);
		},
		_appendIn: function (t, e, i, n) {
			n = new cc.ListEntry(null, null, e, i, 0, n, !1);
			t.push(n),
				(this._hashForUpdates[i.__instanceId] = new cc.HashUpdateEntry(
					t,
					n,
					i,
					null,
					null
				));
		},
		setTimeScale: function (t) {
			this._timeScale = t;
		},
		getTimeScale: function () {
			return this._timeScale;
		},
		update: function (t) {
			var e, i, n;
			for (
				this._updateHashLocked = !0,
					1 !== this._timeScale && (t *= this._timeScale),
					s = 0,
					i = (e = this._updatesNegList).length;
				s < i;
				s++
			)
				(n = e[s]).paused || n.markedForDeletion || n.callback(t);
			for (s = 0, i = (e = this._updates0List).length; s < i; s++)
				(n = e[s]).paused || n.markedForDeletion || n.callback(t);
			for (s = 0, i = (e = this._updatesPosList).length; s < i; s++)
				(n = e[s]).paused || n.markedForDeletion || n.callback(t);
			for (var r, o = this._arrayForTimers, s = 0; s < o.length; s++) {
				if (
					((r = o[s]),
					(this._currentTarget = r),
					(this._currentTargetSalvaged = !1),
					!r.paused)
				)
					for (
						r.timerIndex = 0;
						r.timerIndex < r.timers.length;
						++r.timerIndex
					)
						(r.currentTimer = r.timers[r.timerIndex]),
							(r.currentTimerSalvaged = !1),
							r.currentTimer.update(t),
							(r.currentTimer = null);
				this._currentTargetSalvaged &&
					0 === this._currentTarget.timers.length &&
					this._removeHashElement(this._currentTarget);
			}
			for (s = 0, e = this._updatesNegList; s < e.length; )
				(n = e[s]).markedForDeletion
					? this._removeUpdateFromHash(n)
					: s++;
			for (s = 0, e = this._updates0List; s < e.length; )
				(n = e[s]).markedForDeletion
					? this._removeUpdateFromHash(n)
					: s++;
			for (s = 0, e = this._updatesPosList; s < e.length; )
				(n = e[s]).markedForDeletion
					? this._removeUpdateFromHash(n)
					: s++;
			(this._updateHashLocked = !1), (this._currentTarget = null);
		},
		scheduleCallbackForTarget: function (t, e, i, n, r, o) {
			this.schedule(e, t, i, n, r, o, t.__instanceId + '');
		},
		schedule: function (t, e, i, n, r, o, s) {
			var c,
				a = !1;
			'function' != typeof t && ((c = t), (a = !0)),
				!1 === a
					? (4 !== arguments.length && 5 !== arguments.length) ||
					  ((s = r), (o = n), (r = 0), (n = cc.REPEAT_FOREVER))
					: 4 === arguments.length &&
					  ((o = n), (n = cc.REPEAT_FOREVER), (r = 0)),
				void 0 === s && (s = e.__instanceId + ''),
				cc.assert(
					e,
					cc._LogInfos.Scheduler_scheduleCallbackForTarget_3
				);
			var l,
				h,
				u = this._hashForTimers[e.__instanceId];
			if (
				(u
					? cc.assert(u.paused === o, '')
					: ((u = new cc.HashTimerEntry(
							null,
							e,
							0,
							null,
							null,
							o,
							null
					  )),
					  this._arrayForTimers.push(u),
					  (this._hashForTimers[e.__instanceId] = u)),
				null == u.timers)
			)
				u.timers = [];
			else if (!1 === a) {
				for (h = 0; h < u.timers.length; h++)
					if (t === (l = u.timers[h])._callback)
						return (
							cc.log(
								cc._LogInfos
									.Scheduler_scheduleCallbackForTarget,
								l.getInterval().toFixed(4),
								i.toFixed(4)
							),
							void (l._interval = i)
						);
			} else
				for (h = 0; h < u.timers.length; ++h)
					if ((l = u.timers[h]) && c === l.getSelector())
						return (
							cc.log(
								'CCScheduler#scheduleSelector. Selector already scheduled. Updating interval from: %.4f to %.4f',
								l.getInterval(),
								i
							),
							void l.setInterval(i)
						);
			!1 === a
				? (l = new cc.TimerTargetCallback()).initWithCallback(
						this,
						t,
						e,
						s,
						i,
						n,
						r
				  )
				: (l = new cc.TimerTargetSelector()).initWithSelector(
						this,
						c,
						e,
						i,
						n,
						r
				  ),
				u.timers.push(l);
		},
		scheduleUpdate: function (e, t, i) {
			this._schedulePerFrame(
				function (t) {
					e.update(t);
				},
				e,
				t,
				i
			);
		},
		_getUnscheduleMark: function (t, e) {
			switch (typeof t) {
				case 'number':
				case 'string':
					return t === e.getKey();
				case 'function':
					return t === e._callback;
				default:
					return t === e.getSelector();
			}
		},
		unschedule: function (t, e) {
			if (e && t) {
				var i = this._hashForTimers[e.__instanceId];
				if (i)
					for (var n = i.timers, r = 0, o = n.length; r < o; r++) {
						var s = n[r];
						if (this._getUnscheduleMark(t, s))
							return (
								s !== i.currentTimer ||
									i.currentTimerSalvaged ||
									(i.currentTimerSalvaged = !0),
								n.splice(r, 1),
								i.timerIndex >= r && i.timerIndex--,
								void (
									0 === n.length &&
									(this._currentTarget === i
										? (this._currentTargetSalvaged = !0)
										: this._removeHashElement(i))
								)
							);
					}
			}
		},
		unscheduleUpdate: function (t) {
			null == t ||
				((t = this._hashForUpdates[t.__instanceId]) &&
					(this._updateHashLocked
						? (t.entry.markedForDeletion = !0)
						: this._removeUpdateFromHash(t.entry)));
		},
		unscheduleAllForTarget: function (t) {
			var e;
			null != t &&
				((e = this._hashForTimers[t.__instanceId]) &&
					(-1 < e.timers.indexOf(e.currentTimer) &&
						!e.currentTimerSalvaged &&
						(e.currentTimerSalvaged = !0),
					(e.timers.length = 0),
					this._currentTarget === e
						? (this._currentTargetSalvaged = !0)
						: this._removeHashElement(e)),
				this.unscheduleUpdate(t));
		},
		unscheduleAll: function () {
			this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);
		},
		unscheduleAllWithMinPriority: function (t) {
			for (
				var e, i, n = this._arrayForTimers, r = n.length - 1;
				0 <= r;
				r--
			)
				(e = n[r]), this.unscheduleAllForTarget(e.target);
			var o = 0;
			if (t < 0)
				for (r = 0; r < this._updatesNegList.length; )
					(o = this._updatesNegList.length),
						(i = this._updatesNegList[r]) &&
							i.priority >= t &&
							this.unscheduleUpdate(i.target),
						o == this._updatesNegList.length && r++;
			if (t <= 0)
				for (r = 0; r < this._updates0List.length; )
					(o = this._updates0List.length),
						(i = this._updates0List[r]) &&
							this.unscheduleUpdate(i.target),
						o == this._updates0List.length && r++;
			for (r = 0; r < this._updatesPosList.length; )
				(o = this._updatesPosList.length),
					(i = this._updatesPosList[r]) &&
						i.priority >= t &&
						this.unscheduleUpdate(i.target),
					o == this._updatesPosList.length && r++;
		},
		isScheduled: function (t, e) {
			cc.assert(t, 'Argument key must not be empty'),
				cc.assert(e, 'Argument target must be non-nullptr');
			e = this._hashForUpdates[e.__instanceId];
			if (!e) return !1;
			if (null == e.timers) return !1;
			for (var i = e.timers, n = 0; n < i.length; ++n)
				if (t === i[n].getKey()) return !0;
			return !1;
		},
		pauseAllTargets: function () {
			return this.pauseAllTargetsWithMinPriority(
				cc.Scheduler.PRIORITY_SYSTEM
			);
		},
		pauseAllTargetsWithMinPriority: function (t) {
			for (
				var e, i, n = [], r = this._arrayForTimers, o = 0, s = r.length;
				o < s;
				o++
			)
				(e = r[o]) && ((e.paused = !0), n.push(e.target));
			if (t < 0)
				for (o = 0; o < this._updatesNegList.length; o++)
					(i = this._updatesNegList[o]) &&
						i.priority >= t &&
						((i.paused = !0), n.push(i.target));
			if (t <= 0)
				for (o = 0; o < this._updates0List.length; o++)
					(i = this._updates0List[o]) &&
						((i.paused = !0), n.push(i.target));
			for (o = 0; o < this._updatesPosList.length; o++)
				(i = this._updatesPosList[o]) &&
					i.priority >= t &&
					((i.paused = !0), n.push(i.target));
			return n;
		},
		resumeTargets: function (t) {
			if (t) for (var e = 0; e < t.length; e++) this.resumeTarget(t[e]);
		},
		pauseTarget: function (t) {
			cc.assert(t, cc._LogInfos.Scheduler_pauseTarget);
			var e = this._hashForTimers[t.__instanceId];
			e && (e.paused = !0);
			t = this._hashForUpdates[t.__instanceId];
			t && (t.entry.paused = !0);
		},
		resumeTarget: function (t) {
			cc.assert(t, cc._LogInfos.Scheduler_resumeTarget);
			var e = this._hashForTimers[t.__instanceId];
			e && (e.paused = !1);
			t = this._hashForUpdates[t.__instanceId];
			t && (t.entry.paused = !1);
		},
		isTargetPaused: function (t) {
			cc.assert(t, cc._LogInfos.Scheduler_isTargetPaused);
			var e = this._hashForTimers[t.__instanceId];
			if (e) return e.paused;
			t = this._hashForUpdates[t.__instanceId];
			return !!t && t.entry.paused;
		},
		scheduleUpdateForTarget: function (t, e, i) {
			this.scheduleUpdate(t, e, i);
		},
		unscheduleCallbackForTarget: function (t, e) {
			this.unschedule(e, t);
		},
		unscheduleUpdateForTarget: function (t) {
			this.unscheduleUpdate(t);
		},
		unscheduleAllCallbacksForTarget: function (t) {
			this.unschedule(t.__instanceId + '', t);
		},
		unscheduleAllCallbacks: function () {
			this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);
		},
		unscheduleAllCallbacksWithMinPriority: function (t) {
			this.unscheduleAllWithMinPriority(t);
		},
	})),
	(cc.Scheduler.PRIORITY_SYSTEM = -2147483648),
	(cc._tmp.PrototypeLabelTTF = function () {
		var t = cc.LabelTTF.prototype;
		cc.defineGetterSetter(t, 'color', t.getColor, t.setColor),
			cc.defineGetterSetter(t, 'opacity', t.getOpacity, t.setOpacity),
			t.string,
			cc.defineGetterSetter(t, 'string', t.getString, t.setString),
			t.textAlign,
			cc.defineGetterSetter(
				t,
				'textAlign',
				t.getHorizontalAlignment,
				t.setHorizontalAlignment
			),
			t.verticalAlign,
			cc.defineGetterSetter(
				t,
				'verticalAlign',
				t.getVerticalAlignment,
				t.setVerticalAlignment
			),
			t.fontSize,
			cc.defineGetterSetter(t, 'fontSize', t.getFontSize, t.setFontSize),
			t.fontName,
			cc.defineGetterSetter(t, 'fontName', t.getFontName, t.setFontName),
			t.font,
			cc.defineGetterSetter(t, 'font', t._getFont, t._setFont),
			t.boundingSize,
			t.boundingWidth,
			cc.defineGetterSetter(
				t,
				'boundingWidth',
				t._getBoundingWidth,
				t._setBoundingWidth
			),
			t.boundingHeight,
			cc.defineGetterSetter(
				t,
				'boundingHeight',
				t._getBoundingHeight,
				t._setBoundingHeight
			),
			t.fillStyle,
			cc.defineGetterSetter(
				t,
				'fillStyle',
				t._getFillStyle,
				t.setFontFillColor
			),
			t.strokeStyle,
			cc.defineGetterSetter(
				t,
				'strokeStyle',
				t._getStrokeStyle,
				t._setStrokeStyle
			),
			t.lineWidth,
			cc.defineGetterSetter(
				t,
				'lineWidth',
				t._getLineWidth,
				t._setLineWidth
			),
			t.shadowOffset,
			t.shadowOffsetX,
			cc.defineGetterSetter(
				t,
				'shadowOffsetX',
				t._getShadowOffsetX,
				t._setShadowOffsetX
			),
			t.shadowOffsetY,
			cc.defineGetterSetter(
				t,
				'shadowOffsetY',
				t._getShadowOffsetY,
				t._setShadowOffsetY
			),
			t.shadowOpacity,
			cc.defineGetterSetter(
				t,
				'shadowOpacity',
				t._getShadowOpacity,
				t._setShadowOpacity
			),
			t.shadowBlur,
			cc.defineGetterSetter(
				t,
				'shadowBlur',
				t._getShadowBlur,
				t._setShadowBlur
			);
	}),
	(cc.LabelTTF = cc.Sprite.extend({
		_dimensions: null,
		_hAlignment: cc.TEXT_ALIGNMENT_CENTER,
		_vAlignment: cc.VERTICAL_TEXT_ALIGNMENT_TOP,
		_fontName: null,
		_fontSize: 0,
		_string: '',
		_originalText: null,
		_onCacheCanvasMode: !0,
		_shadowEnabled: !1,
		_shadowOffset: null,
		_shadowOpacity: 0,
		_shadowBlur: 0,
		_shadowColor: null,
		_strokeEnabled: !1,
		_strokeColor: null,
		_strokeSize: 0,
		_textFillColor: null,
		_strokeShadowOffsetX: 0,
		_strokeShadowOffsetY: 0,
		_needUpdateTexture: !1,
		_lineWidths: null,
		_className: 'LabelTTF',
		_fontStyle: 'normal',
		_fontWeight: 'normal',
		_lineHeight: 'normal',
		initWithString: function (t, e, i, n, r, o) {
			t = t ? t + '' : '';
			return (
				(i = i || 16),
				(n = n || cc.size(0, 0)),
				(r = r || cc.TEXT_ALIGNMENT_LEFT),
				(o = o || cc.VERTICAL_TEXT_ALIGNMENT_TOP),
				(this._opacityModifyRGB = !1),
				(this._dimensions = cc.size(n.width, n.height)),
				(this._fontName = e || 'Arial'),
				(this._hAlignment = r),
				(this._vAlignment = o),
				(this._fontSize = i),
				this._renderCmd._setFontStyle(
					this._fontName,
					i,
					this._fontStyle,
					this._fontWeight
				),
				(this.string = t),
				this._renderCmd._setColorsString(),
				this._renderCmd._updateTexture(),
				this._setUpdateTextureDirty(),
				(this._scaleX = this._scaleY =
					1 / cc.view.getDevicePixelRatio()),
				!0
			);
		},
		_setUpdateTextureDirty: function () {
			(this._needUpdateTexture = !0),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty);
		},
		ctor: function (t, e, i, n, r, o) {
			cc.Sprite.prototype.ctor.call(this),
				(this._dimensions = cc.size(0, 0)),
				(this._hAlignment = cc.TEXT_ALIGNMENT_LEFT),
				(this._vAlignment = cc.VERTICAL_TEXT_ALIGNMENT_TOP),
				(this._opacityModifyRGB = !1),
				(this._fontName = 'Arial'),
				(this._shadowEnabled = !1),
				(this._shadowOffset = cc.p(0, 0)),
				(this._shadowOpacity = 0),
				(this._shadowBlur = 0),
				(this._strokeEnabled = !1),
				(this._strokeColor = cc.color(255, 255, 255, 255)),
				(this._strokeSize = 0),
				(this._textFillColor = cc.color(255, 255, 255, 255)),
				(this._strokeShadowOffsetX = 0),
				(this._strokeShadowOffsetY = 0),
				(this._needUpdateTexture = !1),
				(this._lineWidths = []),
				this._renderCmd._setColorsString(),
				(this._textureLoaded = !0),
				e && e instanceof cc.FontDefinition
					? this.initWithStringAndTextDefinition(t, e)
					: cc.LabelTTF.prototype.initWithString.call(
							this,
							t,
							e,
							i,
							n,
							r,
							o
					  );
		},
		init: function () {
			return this.initWithString(' ', this._fontName, this._fontSize);
		},
		description: function () {
			return (
				'<cc.LabelTTF | FontName =' +
				this._fontName +
				' FontSize = ' +
				this._fontSize.toFixed(1) +
				'>'
			);
		},
		getLineHeight: function () {
			return (
				(this._lineHeight &&
					!this._lineHeight.charAt &&
					this._lineHeight) ||
				this._renderCmd._getFontClientHeight()
			);
		},
		setLineHeight: function (t) {
			this._lineHeight = t;
		},
		getString: function () {
			return this._string;
		},
		getHorizontalAlignment: function () {
			return this._hAlignment;
		},
		getVerticalAlignment: function () {
			return this._vAlignment;
		},
		getDimensions: function () {
			return cc.size(this._dimensions);
		},
		getFontSize: function () {
			return this._fontSize;
		},
		getFontName: function () {
			return this._fontName;
		},
		initWithStringAndTextDefinition: function (t, e) {
			return this._updateWithTextDefinition(e, !1), (this.string = t), !0;
		},
		setTextDefinition: function (t) {
			t && this._updateWithTextDefinition(t, !0);
		},
		getTextDefinition: function () {
			return this._prepareTextDefinition(!1);
		},
		enableShadow: function (t, e, i, n) {
			null != t.r && null != t.g && null != t.b && null != t.a
				? this._enableShadow(t, e, i)
				: this._enableShadowNoneColor(t, e, i, n);
		},
		_enableShadowNoneColor: function (t, e, i, n) {
			(i = i || 0.5),
				!1 === this._shadowEnabled && (this._shadowEnabled = !0);
			var r = this._shadowOffset;
			((r && r.x !== t) || r._y !== e) && ((r.x = t), (r.y = e)),
				this._shadowOpacity !== i && (this._shadowOpacity = i),
				this._renderCmd._setColorsString(),
				this._shadowBlur !== n && (this._shadowBlur = n),
				this._setUpdateTextureDirty();
		},
		_enableShadow: function (t, e, i) {
			var n;
			this._shadowColor ||
				(this._shadowColor = cc.color(255, 255, 255, 128)),
				(this._shadowColor.r = t.r),
				(this._shadowColor.g = t.g),
				(this._shadowColor.b = t.b),
				(n = e.width || e.x || 0),
				(e = e.height || e.y || 0),
				(t = null != t.a ? t.a / 255 : 0.5),
				this._enableShadowNoneColor(n, e, t, i);
		},
		_getShadowOffsetX: function () {
			return this._shadowOffset.x;
		},
		_setShadowOffsetX: function (t) {
			!1 === this._shadowEnabled && (this._shadowEnabled = !0),
				this._shadowOffset.x !== t &&
					((this._shadowOffset.x = t), this._setUpdateTextureDirty());
		},
		_getShadowOffsetY: function () {
			return this._shadowOffset._y;
		},
		_setShadowOffsetY: function (t) {
			!1 === this._shadowEnabled && (this._shadowEnabled = !0),
				this._shadowOffset._y !== t &&
					((this._shadowOffset._y = t),
					this._setUpdateTextureDirty());
		},
		_getShadowOffset: function () {
			return cc.p(this._shadowOffset.x, this._shadowOffset.y);
		},
		_setShadowOffset: function (t) {
			!1 === this._shadowEnabled && (this._shadowEnabled = !0),
				(this._shadowOffset.x === t.x &&
					this._shadowOffset.y === t.y) ||
					((this._shadowOffset.x = t.x),
					(this._shadowOffset.y = t.y),
					this._setUpdateTextureDirty());
		},
		_getShadowOpacity: function () {
			return this._shadowOpacity;
		},
		_setShadowOpacity: function (t) {
			!1 === this._shadowEnabled && (this._shadowEnabled = !0),
				this._shadowOpacity !== t &&
					((this._shadowOpacity = t),
					this._renderCmd._setColorsString(),
					this._setUpdateTextureDirty());
		},
		_getShadowBlur: function () {
			return this._shadowBlur;
		},
		_setShadowBlur: function (t) {
			!1 === this._shadowEnabled && (this._shadowEnabled = !0),
				this._shadowBlur !== t &&
					((this._shadowBlur = t), this._setUpdateTextureDirty());
		},
		disableShadow: function () {
			this._shadowEnabled &&
				((this._shadowEnabled = !1), this._setUpdateTextureDirty());
		},
		enableStroke: function (t, e) {
			!1 === this._strokeEnabled && (this._strokeEnabled = !0);
			var i = this._strokeColor;
			(i.r === t.r && i.g === t.g && i.b === t.b) ||
				((i.r = t.r),
				(i.g = t.g),
				(i.b = t.b),
				this._renderCmd._setColorsString()),
				this._strokeSize !== e && (this._strokeSize = e || 0),
				this._setUpdateTextureDirty();
		},
		_getStrokeStyle: function () {
			return this._strokeColor;
		},
		_setStrokeStyle: function (t) {
			!1 === this._strokeEnabled && (this._strokeEnabled = !0);
			var e = this._strokeColor;
			(e.r === t.r && e.g === t.g && e.b === t.b) ||
				((e.r = t.r),
				(e.g = t.g),
				(e.b = t.b),
				this._renderCmd._setColorsString(),
				this._setUpdateTextureDirty());
		},
		_getLineWidth: function () {
			return this._strokeSize;
		},
		_setLineWidth: function (t) {
			!1 === this._strokeEnabled && (this._strokeEnabled = !0),
				this._strokeSize !== t &&
					((this._strokeSize = t || 0),
					this._setUpdateTextureDirty());
		},
		disableStroke: function () {
			this._strokeEnabled &&
				((this._strokeEnabled = !1), this._setUpdateTextureDirty());
		},
		setFontFillColor: function (t) {
			var e = this._textFillColor;
			(e.r === t.r && e.g === t.g && e.b === t.b) ||
				((e.r = t.r),
				(e.g = t.g),
				(e.b = t.b),
				this._renderCmd._setColorsString(),
				(this._needUpdateTexture = !0));
		},
		_getFillStyle: function () {
			return this._textFillColor;
		},
		_updateWithTextDefinition: function (t, e) {
			t.fontDimensions
				? ((this._dimensions.width = t.boundingWidth),
				  (this._dimensions.height = t.boundingHeight))
				: ((this._dimensions.width = 0), (this._dimensions.height = 0)),
				(this._hAlignment = t.textAlign),
				(this._vAlignment = t.verticalAlign),
				(this._fontName = t.fontName),
				(this._fontSize = t.fontSize || 12),
				t.lineHeight
					? (this._lineHeight = t.lineHeight)
					: (this._lineHeight = this._fontSize),
				this._renderCmd._setFontStyle(t),
				t.shadowEnabled &&
					this.enableShadow(
						t.shadowOffsetX,
						t.shadowOffsetY,
						t.shadowOpacity,
						t.shadowBlur
					),
				t.strokeEnabled &&
					this.enableStroke(t.strokeStyle, t.lineWidth),
				this.setFontFillColor(t.fillStyle),
				e && this._renderCmd._updateTexture();
			e = cc.Node._dirtyFlags;
			this._renderCmd.setDirtyFlag(
				e.colorDirty | e.opacityDirty | e.textDirty
			);
		},
		_prepareTextDefinition: function (t) {
			var e,
				i = new cc.FontDefinition();
			t
				? ((i.fontSize = this._fontSize),
				  (i.boundingWidth =
						cc.contentScaleFactor() * this._dimensions.width),
				  (i.boundingHeight =
						cc.contentScaleFactor() * this._dimensions.height))
				: ((i.fontSize = this._fontSize),
				  (i.boundingWidth = this._dimensions.width),
				  (i.boundingHeight = this._dimensions.height)),
				(i.fontName = this._fontName),
				(i.textAlign = this._hAlignment),
				(i.verticalAlign = this._vAlignment),
				this._strokeEnabled
					? ((i.strokeEnabled = !0),
					  (e = this._strokeColor),
					  (i.strokeStyle = cc.color(e.r, e.g, e.b)),
					  (i.lineWidth = this._strokeSize))
					: (i.strokeEnabled = !1),
				this._shadowEnabled
					? ((i.shadowEnabled = !0),
					  (i.shadowBlur = this._shadowBlur),
					  (i.shadowOpacity = this._shadowOpacity),
					  (i.shadowOffsetX =
							(t ? cc.contentScaleFactor() : 1) *
							this._shadowOffset.x),
					  (i.shadowOffsetY =
							(t ? cc.contentScaleFactor() : 1) *
							this._shadowOffset.y))
					: (i._shadowEnabled = !1);
			t = this._textFillColor;
			return (i.fillStyle = cc.color(t.r, t.g, t.b)), i;
		},
		getScale: function () {
			return (
				this._scaleX !== this._scaleY &&
					cc.log(cc._LogInfos.Node_getScale),
				this._scaleX * cc.view.getDevicePixelRatio()
			);
		},
		setScale: function (t, e) {
			(this._scaleX = t / cc.view.getDevicePixelRatio()),
				(this._scaleY =
					(e || 0 === e ? e : t) / cc.view.getDevicePixelRatio()),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getScaleX: function () {
			return this._scaleX * cc.view.getDevicePixelRatio();
		},
		setScaleX: function (t) {
			(this._scaleX = t / cc.view.getDevicePixelRatio()),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getScaleY: function () {
			return this._scaleY * cc.view.getDevicePixelRatio();
		},
		setScaleY: function (t) {
			(this._scaleY = t / cc.view.getDevicePixelRatio()),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		setString: function (t) {
			(t = String(t)),
				this._originalText !== t &&
					((this._originalText = t + ''),
					this._updateString(),
					this._setUpdateTextureDirty(),
					this._renderCmd.setDirtyFlag(
						cc.Node._dirtyFlags.transformDirty
					));
		},
		_updateString: function () {
			(this._string && '' !== this._string) ||
				this._string === this._originalText ||
				(cc.renderer.childrenOrderDirty = !0),
				(this._string = this._originalText);
		},
		setHorizontalAlignment: function (t) {
			t !== this._hAlignment &&
				((this._hAlignment = t), this._setUpdateTextureDirty());
		},
		setVerticalAlignment: function (t) {
			t !== this._vAlignment &&
				((this._vAlignment = t), this._setUpdateTextureDirty());
		},
		setDimensions: function (t, e) {
			var i;
			void 0 === e ? ((i = t.width), (e = t.height)) : (i = t),
				(i === this._dimensions.width &&
					e === this._dimensions.height) ||
					((this._dimensions.width = i),
					(this._dimensions.height = e),
					this._updateString(),
					this._setUpdateTextureDirty());
		},
		_getBoundingWidth: function () {
			return this._dimensions.width;
		},
		_setBoundingWidth: function (t) {
			t !== this._dimensions.width &&
				((this._dimensions.width = t),
				this._updateString(),
				this._setUpdateTextureDirty());
		},
		_getBoundingHeight: function () {
			return this._dimensions.height;
		},
		_setBoundingHeight: function (t) {
			t !== this._dimensions.height &&
				((this._dimensions.height = t),
				this._updateString(),
				this._setUpdateTextureDirty());
		},
		setFontSize: function (t) {
			this._fontSize !== t &&
				((this._fontSize = t),
				this._renderCmd._setFontStyle(
					this._fontName,
					this._fontSize,
					this._fontStyle,
					this._fontWeight
				),
				this._setUpdateTextureDirty());
		},
		setFontName: function (t) {
			this._fontName &&
				this._fontName !== t &&
				((this._fontName = t),
				this._renderCmd._setFontStyle(
					this._fontName,
					this._fontSize,
					this._fontStyle,
					this._fontWeight
				),
				this._setUpdateTextureDirty());
		},
		_getFont: function () {
			return this._renderCmd._getFontStyle();
		},
		_setFont: function (t) {
			t = cc.LabelTTF._fontStyleRE.exec(t);
			t &&
				((this._fontSize = parseInt(t[1])),
				(this._fontName = t[2]),
				this._renderCmd._setFontStyle(
					this._fontName,
					this._fontSize,
					this._fontStyle,
					this._fontWeight
				),
				this._setUpdateTextureDirty());
		},
		getContentSize: function () {
			return (
				this._needUpdateTexture && this._renderCmd._updateTTF(),
				cc.size(this._contentSize)
			);
		},
		_getWidth: function () {
			return (
				this._needUpdateTexture && this._renderCmd._updateTTF(),
				this._contentSize.width
			);
		},
		_getHeight: function () {
			return (
				this._needUpdateTexture && this._renderCmd._updateTTF(),
				this._contentSize.height
			);
		},
		setTextureRect: function (t, e, i) {
			cc.Sprite.prototype.setTextureRect.call(this, t, e, i, !1);
		},
		setDrawMode: function (t) {
			this._onCacheCanvasMode = t;
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? cc.LabelTTF.WebGLRenderCmd
					: this._onCacheCanvasMode
					? cc.LabelTTF.CacheCanvasRenderCmd
					: cc.LabelTTF.CanvasRenderCmd
			)(this);
		},
		_setFontStyle: function (t) {
			this._fontStyle !== t &&
				((this._fontStyle = t),
				this._renderCmd._setFontStyle(
					this._fontName,
					this._fontSize,
					this._fontStyle,
					this._fontWeight
				),
				this._setUpdateTextureDirty());
		},
		_getFontStyle: function () {
			return this._fontStyle;
		},
		_setFontWeight: function (t) {
			this._fontWeight !== t &&
				((this._fontWeight = t),
				this._renderCmd._setFontStyle(
					this._fontName,
					this._fontSize,
					this._fontStyle,
					this._fontWeight
				),
				this._setUpdateTextureDirty());
		},
		_getFontWeight: function () {
			return this._fontWeight;
		},
	})),
	cc.assert(
		cc.isFunction(cc._tmp.PrototypeLabelTTF),
		cc._LogInfos.MissingFile,
		'LabelTTFPropertyDefine.js'
	),
	cc._tmp.PrototypeLabelTTF(),
	delete cc._tmp.PrototypeLabelTTF,
	(cc.LabelTTF._fontStyleRE = /^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/),
	(cc.LabelTTF.create = function (t, e, i, n, r, o) {
		return new cc.LabelTTF(t, e, i, n, r, o);
	}),
	(cc.LabelTTF.createWithFontDefinition = cc.LabelTTF.create),
	(cc.LabelTTF.__labelHeightDiv = document.createElement('div')),
	(cc.LabelTTF.__labelHeightDiv.style.fontFamily = 'Arial'),
	(cc.LabelTTF.__labelHeightDiv.style.position = 'absolute'),
	(cc.LabelTTF.__labelHeightDiv.style.left = '-100px'),
	(cc.LabelTTF.__labelHeightDiv.style.top = '-100px'),
	(cc.LabelTTF.__labelHeightDiv.style.lineHeight = 'normal'),
	document.body
		? document.body.appendChild(cc.LabelTTF.__labelHeightDiv)
		: window.addEventListener(
				'load',
				function () {
					this.removeEventListener('load', arguments.callee, !1),
						document.body.appendChild(cc.LabelTTF.__labelHeightDiv);
				},
				!1
		  ),
	(cc.LabelTTF.__getFontHeightByDiv = function (t, e) {
		var i = cc.LabelTTF.__labelHeightDiv;
		if (t instanceof cc.FontDefinition) {
			var n,
				r = t;
			if (0 < (n = cc.LabelTTF.__fontHeightCache[r._getCanvasFontStr()]))
				return n;
			(i.innerHTML = 'ajghl~!'),
				(i.style.fontFamily = r.fontName),
				(i.style.fontSize = r.fontSize + 'px'),
				(i.style.fontStyle = r.fontStyle),
				(i.style.fontWeight = r.fontWeight),
				(n = i.clientHeight),
				(cc.LabelTTF.__fontHeightCache[r._getCanvasFontStr()] = n),
				(i.innerHTML = '');
		} else {
			if (0 < (n = cc.LabelTTF.__fontHeightCache[t + '.' + e])) return n;
			(i.innerHTML = 'ajghl~!'),
				(i.style.fontFamily = t),
				(i.style.fontSize = e + 'px'),
				(n = i.clientHeight),
				(cc.LabelTTF.__fontHeightCache[t + '.' + e] = n),
				(i.innerHTML = '');
		}
		return n;
	}),
	(cc.LabelTTF.__fontHeightCache = {}),
	(cc.LabelTTF._textAlign = ['left', 'center', 'right']),
	(cc.LabelTTF._textBaseline = ['top', 'middle', 'bottom']),
	(cc.LabelTTF.wrapInspection = !0),
	(cc.LabelTTF._wordRex = /([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôû]+|\S)/),
	(cc.LabelTTF._symbolRex = /^[!,.:;}\]%\?>、‘“》？。，！]/),
	(cc.LabelTTF._lastWordRex = /([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôû]+|\S)$/),
	(cc.LabelTTF._lastEnglish = /[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôû]+$/),
	(cc.LabelTTF._firsrEnglish = /^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôû]/),
	(function () {
		cc.LabelTTF.RenderCmd = function () {
			(this._fontClientHeight = 18),
				(this._fontStyleStr = ''),
				(this._shadowColorStr = 'rgba(128, 128, 128, 0.5)'),
				(this._strokeColorStr = ''),
				(this._fillColorStr = 'rgba(255,255,255,1)'),
				(this._labelCanvas = null),
				(this._labelContext = null),
				(this._lineWidths = []),
				(this._strings = []),
				(this._isMultiLine = !1),
				(this._status = []),
				(this._renderingIndex = 0),
				(this._texRect = cc.rect()),
				(this._canUseDirtyRegion = !0);
		};
		var t = cc.LabelTTF.RenderCmd.prototype;
		(t.constructor = cc.LabelTTF.RenderCmd),
			(t._setFontStyle = function (t, e, i, n) {
				var r;
				t instanceof cc.FontDefinition
					? ((this._fontStyleStr = t._getCanvasFontStr()),
					  (this._fontClientHeight =
							cc.LabelTTF.__getFontHeightByDiv(t)))
					: ((r = e * cc.view.getDevicePixelRatio()),
					  (this._fontStyleStr =
							i + ' ' + n + ' ' + r + "px '" + t + "'"),
					  (this._fontClientHeight =
							cc.LabelTTF.__getFontHeightByDiv(t, e)));
			}),
			(t._getFontStyle = function () {
				return this._fontStyleStr;
			}),
			(t._getFontClientHeight = function () {
				return this._fontClientHeight;
			}),
			(t._updateColor = function () {
				this._setColorsString(), this._updateTexture();
			}),
			(t._setColorsString = function () {
				var t = this._displayedColor,
					e = this._node,
					i = e._shadowColor || this._displayedColor,
					n = e._strokeColor,
					r = e._textFillColor,
					o = t.r / 255,
					s = t.g / 255,
					t = t.b / 255;
				(this._shadowColorStr =
					'rgba(' +
					(0 | (o * i.r)) +
					',' +
					(0 | (s * i.g)) +
					',' +
					(0 | (t * i.b)) +
					',' +
					e._shadowOpacity +
					')'),
					(this._fillColorStr =
						'rgba(' +
						(0 | (o * r.r)) +
						',' +
						(0 | (s * r.g)) +
						',' +
						(0 | (t * r.b)) +
						', 1)'),
					(this._strokeColorStr =
						'rgba(' +
						(0 | (o * n.r)) +
						',' +
						(0 | (s * n.g)) +
						',' +
						(0 | (t * n.b)) +
						', 1)');
			});
		var i = new cc.Rect();
		(t.getLocalBB = function () {
			var t = this._node;
			i.x = i.y = 0;
			var e = cc.view.getDevicePixelRatio();
			return (
				(i.width = t._getWidth() * e),
				(i.height = t._getHeight() * e),
				i
			);
		}),
			(t._updateTTF = function () {
				var t,
					e,
					i = this._node,
					n = cc.view.getDevicePixelRatio(),
					r = i._dimensions.width * n,
					o = this._lineWidths;
				if (
					((o.length = 0),
					(this._isMultiLine = !1),
					this._measureConfig(),
					0 != r)
				)
					for (
						this._strings = i._string.split('\n'), t = 0;
						t < this._strings.length;
						t++
					)
						this._checkWarp(this._strings, t, r);
				else
					for (
						this._strings = i._string.split('\n'),
							t = 0,
							e = this._strings.length;
						t < e;
						t++
					)
						o.push(this._measure(this._strings[t]));
				1 < this._strings.length && (this._isMultiLine = !0);
				var s,
					c = 0,
					a = 0;
				i._strokeEnabled && (c = a = 2 * i._strokeSize),
					i._shadowEnabled &&
						((l = i._shadowOffset),
						(c += 2 * Math.abs(l.x)),
						(a += 2 * Math.abs(l.y))),
					(s =
						0 == r
							? this._isMultiLine
								? cc.size(
										Math.ceil(Math.max.apply(Math, o) + c),
										Math.ceil(
											this._fontClientHeight *
												n *
												this._strings.length +
												a
										)
								  )
								: cc.size(
										Math.ceil(this._measure(i._string) + c),
										Math.ceil(
											this._fontClientHeight * n + a
										)
								  )
							: 0 === i._dimensions.height
							? this._isMultiLine
								? cc.size(
										Math.ceil(r + c),
										Math.ceil(
											i.getLineHeight() *
												n *
												this._strings.length +
												a
										)
								  )
								: cc.size(
										Math.ceil(r + c),
										Math.ceil(i.getLineHeight() * n + a)
								  )
							: cc.size(
									Math.ceil(r + c),
									Math.ceil(i._dimensions.height * n + a)
							  )),
					'normal' !== i._getFontStyle() &&
						(s.width = Math.ceil(s.width + 0.3 * i._fontSize)),
					0 === this._strings.length
						? ((this._texRect.width = 1),
						  (this._texRect.height = s.height || 1))
						: ((this._texRect.width = s.width),
						  (this._texRect.height = s.height));
				var l = s.width / n,
					n = s.height / n;
				i.setContentSize(l, n),
					(i._strokeShadowOffsetX = c),
					(i._strokeShadowOffsetY = a);
				i = i._anchorPoint;
				(this._anchorPointInPoints.x = 0.5 * c + (s.width - c) * i.x),
					(this._anchorPointInPoints.y =
						0.5 * a + (s.height - a) * i.y);
			}),
			(t._saveStatus = function () {
				var t = this._node,
					e = cc.view.getDevicePixelRatio(),
					i = t._strokeShadowOffsetX,
					n = t._strokeShadowOffsetY,
					r = t._contentSize.height * e - n,
					o = t._vAlignment,
					s = t._hAlignment,
					c = 0.5 * i,
					a = r + 0.5 * n,
					n = 0,
					l = 0,
					h = [],
					i = t._contentSize.width * e - i,
					u = t.getLineHeight() * e,
					_ = (u - this._fontClientHeight * e) / 2;
				if (
					(s === cc.TEXT_ALIGNMENT_RIGHT
						? (n += i)
						: s === cc.TEXT_ALIGNMENT_CENTER
						? (n += i / 2)
						: (n += 0),
					this._isMultiLine)
				) {
					var d = this._strings.length;
					o === cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM
						? (l = u - 2 * _ + r - u * d)
						: o === cc.VERTICAL_TEXT_ALIGNMENT_CENTER &&
						  (l = (u - 2 * _) / 2 + (r - u * d) / 2);
					for (var p = 0; p < d; p++) {
						var f = u * p + _ - r + l;
						h.push(f);
					}
				} else
					o === cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM ||
						(o === cc.VERTICAL_TEXT_ALIGNMENT_TOP
							? (l -= r)
							: (l -= 0.5 * r)),
						h.push(l);
				n = {
					contextTransform: cc.p(c, a),
					xOffset: n,
					OffsetYArray: h,
				};
				this._status.push(n);
			}),
			(t._drawTTFInCanvas = function (t) {
				var e, i;
				t &&
					((i = this._status.pop()),
					t.setTransform(
						1,
						0,
						0,
						1,
						i.contextTransform.x,
						i.contextTransform.y
					),
					(e = i.xOffset),
					(i = i.OffsetYArray),
					this.drawLabels(t, e, i));
			}),
			(t._checkWarp = function (t, e, i) {
				var n = t[e],
					r = this._measure(n);
				if (i < r && 1 < n.length) {
					for (
						var o,
							s,
							c = (n.length * (i / r)) | 0,
							a = n.substr(c),
							l = r - this._measure(a),
							h = 0,
							u = 0;
						i < l && u++ < 100;

					)
						(c *= i / l),
							(c |= 0),
							(a = n.substr(c)),
							(l = r - this._measure(a));
					for (u = 0; l < i && u++ < 100; )
						a &&
							((h = (o = cc.LabelTTF._wordRex.exec(a))
								? o[0].length
								: 1),
							(s = a)),
							(c += h),
							(a = n.substr(c)),
							(l = r - this._measure(a));
					0 === (c -= h) && ((c = 1), (s = s.substr(1)));
					var _,
						d = n.substr(0, c);
					cc.LabelTTF.wrapInspection &&
						cc.LabelTTF._symbolRex.test(s || a) &&
						(0 ===
							(c -= (_ = cc.LabelTTF._lastWordRex.exec(d))
								? _[0].length
								: 0) && (c = 1),
						(s = n.substr(c)),
						(d = n.substr(0, c))),
						cc.LabelTTF._firsrEnglish.test(s) &&
							(_ = cc.LabelTTF._lastEnglish.exec(d)) &&
							d !== _[0] &&
							((c -= _[0].length),
							(s = n.substr(c)),
							(d = n.substr(0, c))),
						(t[e] = s || a),
						t.splice(e, 0, d);
				}
			}),
			(t.updateStatus = function () {
				var t = cc.Node._dirtyFlags;
				this._dirtyFlag & t.textDirty && this._updateTexture(),
					cc.Node.RenderCmd.prototype.updateStatus.call(this),
					this._dirtyFlag & t.transformDirty &&
						(this.transform(this.getParentRenderCmd(), !0),
						(this._dirtyFlag =
							(this._dirtyFlag &
								cc.Node._dirtyFlags.transformDirty) ^
							this._dirtyFlag));
			}),
			(t._syncStatus = function (t) {
				var e = cc.Node._dirtyFlags,
					i = this._dirtyFlag;
				i & e.textDirty && this._updateTexture(),
					cc.Node.RenderCmd.prototype._syncStatus.call(this, t),
					(cc._renderType === cc.game.RENDER_TYPE_WEBGL ||
						i & e.transformDirty) &&
						this.transform(t);
			}),
			(t.drawLabels = function (t, e, i) {
				var n = this._node;
				n._shadowEnabled &&
					((s = n._shadowOffset),
					(t.shadowColor = this._shadowColorStr),
					(t.shadowOffsetX = s.x),
					(t.shadowOffsetY = -s.y),
					(t.shadowBlur = n._shadowBlur));
				var r = n._hAlignment,
					o = n._vAlignment,
					s = n._strokeSize;
				t.font !== this._fontStyleStr && (t.font = this._fontStyleStr),
					(t.fillStyle = this._fillColorStr);
				var c = n._strokeEnabled;
				c &&
					((t.lineWidth = 2 * s),
					(t.strokeStyle = this._strokeColorStr)),
					(t.textBaseline = cc.LabelTTF._textBaseline[o]),
					(t.textAlign = cc.LabelTTF._textAlign[r]);
				for (var a = this._strings.length, l = 0; l < a; l++) {
					var h = this._strings[l];
					c && t.strokeText(h, e, i[l]), t.fillText(h, e, i[l]);
				}
				cc.g_NumberOfDraws++;
			});
	})(),
	(function () {
		(cc.LabelTTF.CacheRenderCmd = function (t) {
			cc.LabelTTF.RenderCmd.call(this, t);
			t = this._labelCanvas = document.createElement('canvas');
			(t.width = 1),
				(t.height = 1),
				(this._labelContext = t.getContext('2d')),
				(this._texRect = cc.rect());
		}),
			(cc.LabelTTF.CacheRenderCmd.prototype = Object.create(
				cc.LabelTTF.RenderCmd.prototype
			)),
			cc.inject(
				cc.LabelTTF.RenderCmd.prototype,
				cc.LabelTTF.CacheRenderCmd.prototype
			);
		var t = cc.LabelTTF.CacheRenderCmd.prototype;
		(t.constructor = cc.LabelTTF.CacheRenderCmd),
			(t._updateTexture = function () {
				this._dirtyFlag =
					(this._dirtyFlag & cc.Node._dirtyFlags.textDirty) ^
					this._dirtyFlag;
				var t = this._node;
				this._updateTTF();
				var e = this._texRect.width,
					i = this._texRect.height,
					n = this._labelContext,
					r = this._labelCanvas;
				if (
					(t._texture ||
						((o = new cc.Texture2D()).initWithElement(
							this._labelCanvas
						),
						t.setTexture(o)),
					0 === t._string.length)
				)
					return (
						(r.width = e),
						(r.height = i),
						t._texture && t._texture.handleLoadedTexture(),
						t.setTextureRect(this._texRect),
						!0
					);
				n.font = this._fontStyleStr;
				var o = r.width === e && r.height === i;
				return (
					(r.width = this._texRect.width),
					(r.height = this._texRect.height),
					o && n.clearRect(0, 0, e, i),
					this._saveStatus(),
					this._drawTTFInCanvas(n),
					t._texture && t._texture.handleLoadedTexture(),
					t.setTextureRect(this._texRect),
					!0
				);
			}),
			(t._measureConfig = function () {
				this._labelContext.font = this._fontStyleStr;
			}),
			(t._measure = function (t) {
				return this._labelContext.measureText(t).width;
			});
	})(),
	(function () {
		cc.LabelTTF.CacheCanvasRenderCmd = function (t) {
			cc.Sprite.CanvasRenderCmd.call(this, t),
				cc.LabelTTF.CacheRenderCmd.call(this);
		};
		var t = (cc.LabelTTF.CacheCanvasRenderCmd.prototype = Object.create(
			cc.Sprite.CanvasRenderCmd.prototype
		));
		cc.inject(cc.LabelTTF.CacheRenderCmd.prototype, t),
			(t.constructor = cc.LabelTTF.CacheCanvasRenderCmd);
	})(),
	(function () {
		(cc.LabelTTF.CanvasRenderCmd = function (t) {
			cc.Sprite.CanvasRenderCmd.call(this, t),
				cc.LabelTTF.RenderCmd.call(this);
		}),
			(cc.LabelTTF.CanvasRenderCmd.prototype = Object.create(
				cc.Sprite.CanvasRenderCmd.prototype
			)),
			cc.inject(
				cc.LabelTTF.RenderCmd.prototype,
				cc.LabelTTF.CanvasRenderCmd.prototype
			);
		var t = cc.LabelTTF.CanvasRenderCmd.prototype;
		(t.constructor = cc.LabelTTF.CanvasRenderCmd),
			(t._measureConfig = function () {}),
			(t._measure = function (t) {
				var e = cc._renderContext.getContext();
				return (e.font = this._fontStyleStr), e.measureText(t).width;
			}),
			(t._updateTexture = function () {
				this._dirtyFlag =
					(this._dirtyFlag & cc.Node._dirtyFlags.textDirty) ^
					this._dirtyFlag;
				var t = this._node;
				cc.view.getDevicePixelRatio();
				return (
					this._updateTTF(),
					0 === t._string.length || this._saveStatus(),
					t.setTextureRect(this._texRect),
					!0
				);
			}),
			(t.rendering = function (t) {
				var e = cc.view.getScaleX(),
					i = cc.view.getScaleY(),
					n = t || cc._renderContext,
					r = n.getContext();
				if (r) {
					var o = this._node;
					if ((n.computeRealOffsetY(), !(this._status.length <= 0))) {
						var s =
								this._renderingIndex >= this._status.length
									? this._renderingIndex - this._status.length
									: this._renderingIndex,
							c = this._status[s];
						this._renderingIndex = s + 1;
						var t = o._rect.height,
							s = o._offsetPosition.x,
							a = -o._offsetPosition.y - t,
							t = this._displayedOpacity / 255;
						n.setTransform(this._worldTransform, e, i),
							n.setCompositeOperation(this._blendFuncStr),
							n.setGlobalAlpha(t),
							n.save(),
							o._flippedX &&
								((s = -s - o._rect.width), r.scale(-1, 1)),
							o._flippedY &&
								((a = o._offsetPosition.y), r.scale(1, -1));
						for (
							var e = c.xOffset + c.contextTransform.x + s * e,
								l = [],
								h = this._strings.length,
								u = 0;
							u < h;
							u++
						)
							l.push(
								c.OffsetYArray[u] + c.contextTransform.y + a * i
							);
						this.drawLabels(r, e, l), n.restore();
					}
				}
			});
	})();
var cc = cc || {};
(cc._tmp = cc._tmp || {}),
	(cc.associateWithNative = function (t, e) {}),
	(cc.KEY = {
		none: 0,
		back: 6,
		menu: 18,
		backspace: 8,
		tab: 9,
		enter: 13,
		shift: 16,
		ctrl: 17,
		alt: 18,
		pause: 19,
		capslock: 20,
		escape: 27,
		space: 32,
		pageup: 33,
		pagedown: 34,
		end: 35,
		home: 36,
		left: 37,
		up: 38,
		right: 39,
		down: 40,
		select: 41,
		insert: 45,
		Delete: 46,
		0: 48,
		1: 49,
		2: 50,
		3: 51,
		4: 52,
		5: 53,
		6: 54,
		7: 55,
		8: 56,
		9: 57,
		a: 65,
		b: 66,
		c: 67,
		d: 68,
		e: 69,
		f: 70,
		g: 71,
		h: 72,
		i: 73,
		j: 74,
		k: 75,
		l: 76,
		m: 77,
		n: 78,
		o: 79,
		p: 80,
		q: 81,
		r: 82,
		s: 83,
		t: 84,
		u: 85,
		v: 86,
		w: 87,
		x: 88,
		y: 89,
		z: 90,
		num0: 96,
		num1: 97,
		num2: 98,
		num3: 99,
		num4: 100,
		num5: 101,
		num6: 102,
		num7: 103,
		num8: 104,
		num9: 105,
		'*': 106,
		'+': 107,
		'-': 109,
		numdel: 110,
		'/': 111,
		f1: 112,
		f2: 113,
		f3: 114,
		f4: 115,
		f5: 116,
		f6: 117,
		f7: 118,
		f8: 119,
		f9: 120,
		f10: 121,
		f11: 122,
		f12: 123,
		numlock: 144,
		scrolllock: 145,
		';': 186,
		semicolon: 186,
		equal: 187,
		'=': 187,
		',': 188,
		comma: 188,
		dash: 189,
		'.': 190,
		period: 190,
		forwardslash: 191,
		grave: 192,
		'[': 219,
		openbracket: 219,
		backslash: 220,
		']': 221,
		closebracket: 221,
		quote: 222,
		dpadLeft: 1e3,
		dpadRight: 1001,
		dpadUp: 1003,
		dpadDown: 1004,
		dpadCenter: 1005,
	}),
	(cc.FMT_JPG = 0),
	(cc.FMT_PNG = 1),
	(cc.FMT_TIFF = 2),
	(cc.FMT_RAWDATA = 3),
	(cc.FMT_WEBP = 4),
	(cc.FMT_UNKNOWN = 5),
	(cc.getImageFormatByData = function (t) {
		return 8 < t.length &&
			137 === t[0] &&
			80 === t[1] &&
			78 === t[2] &&
			71 === t[3] &&
			13 === t[4] &&
			10 === t[5] &&
			26 === t[6] &&
			10 === t[7]
			? cc.FMT_PNG
			: 2 < t.length &&
			  ((73 === t[0] && 73 === t[1]) ||
					(77 === t[0] && 77 === t[1]) ||
					(255 === t[0] && 216 === t[1]))
			? cc.FMT_TIFF
			: cc.FMT_UNKNOWN;
	}),
	(cc.inherits = function (t, e) {
		function i() {}
		(i.prototype = e.prototype),
			(t.superClass_ = e.prototype),
			(t.prototype = new i()),
			(t.prototype.constructor = t);
	}),
	(cc.base = function (t, e, i) {
		var n = arguments.callee.caller;
		if (n.superClass_)
			return (
				(ret = n.superClass_.constructor.apply(
					t,
					Array.prototype.slice.call(arguments, 1)
				)),
				ret
			);
		for (
			var r = Array.prototype.slice.call(arguments, 2),
				o = !1,
				s = t.constructor;
			s;
			s = s.superClass_ && s.superClass_.constructor
		)
			if (s.prototype[e] === n) o = !0;
			else if (o) return s.prototype[e].apply(t, r);
		if (t[e] === n) return t.constructor.prototype[e].apply(t, r);
		throw Error(
			'cc.base called from a method of one name to a method of a different name'
		);
	});
var GlobalVertexBuffer = (function () {
	function t(t) {
		(this.gl = t),
			(this.vertexBuffer = t.createBuffer()),
			(this.size = 888),
			(this.byteLength = 3552 * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),
			(this.data = new ArrayBuffer(this.byteLength)),
			(this.dataArray = new Float32Array(this.data)),
			t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer),
			t.bufferData(t.ARRAY_BUFFER, this.dataArray, t.DYNAMIC_DRAW),
			(this._dirty = !1),
			(this._spaces = { 0: this.byteLength });
	}
	return (
		(t.prototype = {
			constructor: t,
			allocBuffer: function (t, e) {
				var i = this._spaces[t];
				return (
					!!(i && e <= i) &&
					(delete this._spaces[t],
					e < i && ((t = t + e), (this._spaces[t] = i - e)),
					!0)
				);
			},
			requestBuffer: function (t) {
				var e, i;
				for (e in this._spaces)
					if (
						((i = parseInt(e)),
						t <= this._spaces[e] && this.allocBuffer(i, t))
					)
						return { buffer: this, offset: i, size: t };
				return null;
			},
			freeBuffer: function (t, e) {
				var i,
					n,
					r,
					o = this._spaces;
				for (n in o) {
					if (t < (i = parseInt(n))) break;
					if (i + o[n] >= t) {
						(e = e + t - i), (t = i);
						break;
					}
				}
				(r = t + e),
					this._spaces[r] &&
						((e += this._spaces[r]), delete this._spaces[r]),
					(this._spaces[t] = e);
			},
			setDirty: function () {
				this._dirty = !0;
			},
			update: function () {
				this._dirty &&
					(this.gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer),
					this.gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.dataArray),
					(this._dirty = !1));
			},
			destroy: function () {
				this.gl.deleteBuffer(this.vertexBuffer),
					(this.data = null),
					(this.positions = null),
					(this.colors = null),
					(this.texCoords = null),
					(this.vertexBuffer = null);
			},
		}),
		t
	);
})();
(cc.rendererCanvas = {
	childrenOrderDirty: !0,
	assignedZ: 0,
	assignedZStep: 1e-4,
	_transformNodePool: [],
	_renderCmds: [],
	_isCacheToCanvasOn: !1,
	_cacheToCanvasCmds: {},
	_cacheInstanceIds: [],
	_currentID: 0,
	_clearColor: cc.color(),
	_clearFillStyle: 'rgb(0, 0, 0)',
	_dirtyRegion: null,
	_allNeedDraw: !0,
	_enableDirtyRegion: !1,
	_debugDirtyRegion: !1,
	_canUseDirtyRegion: !1,
	_dirtyRegionCountThreshold: 10,
	getRenderCmd: function (t) {
		return t._createRenderCmd();
	},
	enableDirtyRegion: function (t) {
		this._enableDirtyRegion = t;
	},
	isDirtyRegionEnabled: function () {
		return this._enableDirtyRegion;
	},
	setDirtyRegionCountThreshold: function (t) {
		this._dirtyRegionCountThreshold = t;
	},
	_collectDirtyRegion: function () {
		for (
			var t = this._renderCmds,
				e = this._dirtyRegion,
				i = 0,
				n = !0,
				r = cc.Node.CanvasRenderCmd.RegionStatus,
				o = 0,
				s = t.length;
			o < s;
			o++
		) {
			var c = t[o],
				a = c._regionFlag,
				l = c._oldRegion,
				h = c._currentRegion;
			a > r.NotDirty &&
				(++i > this._dirtyRegionCountThreshold && (n = !1),
				n &&
					(h.isEmpty() || e.addRegion(h),
					c._regionFlag > r.Dirty && (l.isEmpty() || e.addRegion(l))),
				(c._regionFlag = r.NotDirty));
		}
		return n;
	},
	_beginDrawDirtyRegion: function (t) {
		var e = t.getContext(),
			i = this._dirtyRegion.getDirtyRegions();
		e.save();
		var n = t._scaleX,
			r = t._scaleY;
		t.setTransform({ a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 }, n, r),
			e.beginPath();
		for (var o = 0, s = i.length; o < s; ++o) {
			var c = i[o];
			e.rect(c._minX, -c._maxY, c._width, c._height);
		}
		e.clip();
	},
	_endDrawDirtyRegion: function (t) {
		t.restore();
	},
	_debugDrawDirtyRegion: function (t) {
		if (this._debugDirtyRegion) {
			var e = t.getContext(),
				i = this._dirtyRegion.getDirtyRegions(),
				n = t._scaleX,
				r = t._scaleY;
			t.setTransform({ a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 }, n, r),
				e.beginPath();
			for (var o = 0, s = i.length; o < s; ++o) {
				var c = i[o];
				e.rect(c._minX, -c._maxY, c._width, c._height);
			}
			r = e.fillStyle;
			(e.fillStyle = 'green'), e.fill(), (e.fillStyle = r);
		}
	},
	rendering: function (t) {
		var e = (this._dirtyRegion = this._dirtyRegion || new cc.DirtyRegion()),
			i = cc._canvas,
			n = t || cc._renderContext,
			r = n.getContext(),
			o = cc.view.getScaleX(),
			s = cc.view.getScaleY();
		n.setViewScale(o, s), n.computeRealOffsetY();
		var c,
			a,
			l = this._dirtyRegion.getDirtyRegions(),
			h = this._renderCmds,
			u =
				this._allNeedDraw ||
				!this._enableDirtyRegion ||
				!this._canUseDirtyRegion,
			t = !0;
		for (
			u || (t = this._collectDirtyRegion()),
				(u = u || !t) || this._beginDrawDirtyRegion(n),
				r.setTransform(1, 0, 0, 1, 0, 0),
				r.clearRect(0, 0, i.width, i.height),
				(0 === this._clearColor.r &&
					0 === this._clearColor.g &&
					0 === this._clearColor.b) ||
					(n.setFillStyle(this._clearFillStyle),
					n.setGlobalAlpha(this._clearColor.a),
					r.fillRect(0, 0, i.width, i.height)),
				c = 0,
				a = h.length;
			c < a;
			c++
		) {
			var _ = h[c],
				d = !1,
				p = _._currentRegion;
			if (!p || u) d = !0;
			else
				for (var f = 0, m = l.length; f < m; ++f)
					if (l[f].intersects(p)) {
						d = !0;
						break;
					}
			d && _.rendering(n, o, s);
		}
		u || (this._debugDrawDirtyRegion(n), this._endDrawDirtyRegion(r)),
			e.clear(),
			(this._allNeedDraw = !1);
	},
	_renderingToCacheCanvas: function (t, e, i, n) {
		t || cc.log('The context of RenderTexture is invalid.'),
			(i = cc.isUndefined(i) ? 1 : i),
			(n = cc.isUndefined(n) ? 1 : n),
			(e = e || this._currentID);
		var r,
			o,
			s = this._cacheToCanvasCmds[e];
		for (t.computeRealOffsetY(), r = 0, o = s.length; r < o; r++)
			s[r].rendering(t, i, n);
		this._removeCache(e);
		e = this._cacheInstanceIds;
		0 === e.length
			? (this._isCacheToCanvasOn = !1)
			: (this._currentID = e[e.length - 1]);
	},
	_turnToCacheMode: function (t) {
		(this._isCacheToCanvasOn = !0),
			(t = t || 0),
			(this._cacheToCanvasCmds[t] = []),
			-1 === this._cacheInstanceIds.indexOf(t) &&
				this._cacheInstanceIds.push(t),
			(this._currentID = t);
	},
	_turnToNormalMode: function () {
		this._isCacheToCanvasOn = !1;
	},
	_removeCache: function (t) {
		t = t || this._currentID;
		var e = this._cacheToCanvasCmds[t];
		e && ((e.length = 0), delete this._cacheToCanvasCmds[t]);
		e = this._cacheInstanceIds;
		cc.arrayRemoveObject(e, t);
	},
	resetFlag: function () {
		(this.childrenOrderDirty = !1), (this._transformNodePool.length = 0);
	},
	transform: function () {
		var t = this._transformNodePool;
		t.sort(this._sortNodeByLevelAsc);
		for (var e = 0, i = t.length; e < i; e++)
			0 !== t[e]._dirtyFlag && t[e].updateStatus();
		t.length = 0;
	},
	transformDirty: function () {
		return 0 < this._transformNodePool.length;
	},
	_sortNodeByLevelAsc: function (t, e) {
		return t._curLevel - e._curLevel;
	},
	pushDirtyNode: function (t) {
		this._transformNodePool.push(t);
	},
	clear: function () {},
	clearRenderCommands: function () {
		(this._renderCmds.length = 0),
			(this._cacheInstanceIds.length = 0),
			(this._isCacheToCanvasOn = !1),
			(this._allNeedDraw = !0),
			(this._canUseDirtyRegion = !0);
	},
	pushRenderCommand: function (t) {
		var e;
		t.needDraw() &&
			(t._canUseDirtyRegion || (this._canUseDirtyRegion = !1),
			this._isCacheToCanvasOn
				? ((e = this._currentID),
				  -1 === (e = this._cacheToCanvasCmds[e]).indexOf(t) &&
						e.push(t))
				: -1 === this._renderCmds.indexOf(t) &&
				  this._renderCmds.push(t));
	},
}),
	(function () {
		cc.CanvasContextWrapper = function (t) {
			(this._context = t),
				(this._saveCount = 0),
				(this._currentAlpha = t.globalAlpha),
				(this._currentCompositeOperation = t.globalCompositeOperation),
				(this._currentFillStyle = t.fillStyle),
				(this._currentStrokeStyle = t.strokeStyle),
				(this._offsetX = 0),
				(this._offsetY = 0),
				(this._realOffsetY = this.height),
				(this._armatureMode = 0);
		};
		var t = cc.CanvasContextWrapper.prototype;
		(t.resetCache = function () {
			var t = this._context;
			(this._currentAlpha = t.globalAlpha),
				(this._currentCompositeOperation = t.globalCompositeOperation),
				(this._currentFillStyle = t.fillStyle),
				(this._currentStrokeStyle = t.strokeStyle),
				(this._realOffsetY =
					this._context.canvas.height + this._offsetY);
		}),
			(t.setOffset = function (t, e) {
				(this._offsetX = t),
					(this._offsetY = e),
					(this._realOffsetY =
						this._context.canvas.height + this._offsetY);
			}),
			(t.computeRealOffsetY = function () {
				this._realOffsetY = this._context.canvas.height + this._offsetY;
			}),
			(t.setViewScale = function (t, e) {
				(this._scaleX = t), (this._scaleY = e);
			}),
			(t.getContext = function () {
				return this._context;
			}),
			(t.save = function () {
				this._context.save(), this._saveCount++;
			}),
			(t.restore = function () {
				this._context.restore(), this._saveCount--;
			}),
			(t.setGlobalAlpha = function (t) {
				0 < this._saveCount
					? (this._context.globalAlpha = t)
					: this._currentAlpha !== t &&
					  ((this._currentAlpha = t),
					  (this._context.globalAlpha = t));
			}),
			(t.setCompositeOperation = function (t) {
				0 < this._saveCount
					? (this._context.globalCompositeOperation = t)
					: this._currentCompositeOperation !== t &&
					  ((this._currentCompositeOperation = t),
					  (this._context.globalCompositeOperation = t));
			}),
			(t.setFillStyle = function (t) {
				0 < this._saveCount
					? (this._context.fillStyle = t)
					: this._currentFillStyle !== t &&
					  ((this._currentFillStyle = t),
					  (this._context.fillStyle = t));
			}),
			(t.setStrokeStyle = function (t) {
				0 < this._saveCount
					? (this._context.strokeStyle = t)
					: this._currentStrokeStyle !== t &&
					  ((this._currentStrokeStyle = t),
					  (this._context.strokeStyle = t));
			}),
			(t.setTransform = function (t, e, i) {
				0 < this._armatureMode
					? (this.restore(),
					  this.save(),
					  this._context.transform(
							t.a * e,
							-t.b * i,
							-t.c * e,
							t.d * i,
							t.tx * e,
							-t.ty * i
					  ))
					: this._context.setTransform(
							t.a * e,
							-t.b * i,
							-t.c * e,
							t.d * i,
							this._offsetX + t.tx * e,
							this._realOffsetY - t.ty * i
					  );
			}),
			(t._switchToArmatureMode = function (t, e, i, n) {
				t
					? (this._armatureMode++,
					  this._context.setTransform(
							e.a,
							e.c,
							e.b,
							e.d,
							this._offsetX + e.tx * i,
							this._realOffsetY - e.ty * n
					  ),
					  this.save())
					: (this._armatureMode--, this.restore());
			});
	})();
var Region = function () {
		(this._minX = 0),
			(this._minY = 0),
			(this._maxX = 0),
			(this._maxY = 0),
			(this._width = 0),
			(this._height = 0),
			(this._area = 0);
	},
	regionProto = Region.prototype,
	regionPool = [];
function regionCreate() {
	return regionPool.pop() || new Region();
}
function regionRelease(t) {
	regionPool.push(t);
}
function unionArea(t, e) {
	var i = (t._minX < e._minX ? t : e)._minX,
		n = (t._minY < e._minY ? t : e)._minY;
	return (
		((t._maxX > e._maxX ? t : e)._maxX - i) *
		((t._maxY > e._maxY ? t : e)._maxY - n)
	);
}
(regionProto.setTo = function (t, e, i, n) {
	return (
		(this._minX = t),
		(this._minY = e),
		(this._maxX = i),
		(this._maxY = n),
		this.updateArea(),
		this
	);
}),
	(regionProto.intValues = function () {
		(this._minX = Math.floor(this._minX)),
			(this._minY = Math.floor(this._minY)),
			(this._maxX = Math.ceil(this._maxX)),
			(this._maxY = Math.ceil(this._maxY)),
			this.updateArea();
	}),
	(regionProto.updateArea = function () {
		(this._width = this._maxX - this._minX),
			(this._height = this._maxY - this._minY),
			(this._area = this._width * this._height);
	}),
	(regionProto.union = function (t) {
		this._width <= 0 || this._height <= 0
			? this.setTo(t._minX, t._minY, t._maxX, t._maxY)
			: (this._minX > t._minX && (this._minX = t._minX),
			  this._minY > t._minY && (this._minY = t._minY),
			  this._maxX < t._maxX && (this._maxX = t._maxX),
			  this._maxY < t._maxY && (this._maxY = t._maxY),
			  this.updateArea());
	}),
	(regionProto.setEmpty = function () {
		(this._minX = 0),
			(this._minY = 0),
			(this._maxX = 0),
			(this._maxY = 0),
			(this._width = 0),
			(this._height = 0),
			(this._area = 0);
	}),
	(regionProto.isEmpty = function () {
		return this._width <= 0 || this._height <= 0;
	}),
	(regionProto.intersects = function (t) {
		if (
			this._width <= 0 ||
			this._height <= 0 ||
			t._width <= 0 ||
			t._height <= 0
		)
			return !1;
		var e = (this._minX > t._minX ? this : t)._minX,
			i = (this._maxX < t._maxX ? this : t)._maxX;
		return (
			!(i < e) &&
			(this._minY > t._minY ? this : t)._minY <=
				(this._maxY < t._maxY ? this : t)._maxY
		);
	}),
	(regionProto.updateRegion = function (t, e) {
		var i, n, r, o, s, c, a, l, h, u, _, d, p, f, m;
		0 != t.width && 0 != t.height
			? ((i = e.a),
			  (n = e.b),
			  (r = e.c),
			  (o = e.d),
			  (d = e.tx),
			  (p = e.ty),
			  (s = t.x),
			  (_ = t.y),
			  (c = s + t.width),
			  (a = _ + t.height),
			  (m =
					1 == i && 0 == n && 0 == r && 1 == o
						? ((l = s + d - 1),
						  (h = _ + p - 1),
						  (u = c + d + 1),
						  a + p + 1)
						: ((f = 0),
						  (e = i * c + r * _ + d) < (t = i * s + r * _ + d) &&
								((f = t), (t = e), (e = f)),
						  (m = i * s + r * a + d) < (d = i * c + r * a + d) &&
								((f = d), (d = m), (m = f)),
						  (l = (t < d ? t : d) - 1),
						  (u = (m < e ? e : m) + 1),
						  (e = n * c + o * _ + p) < (_ = n * s + o * _ + p) &&
								((f = _), (_ = e), (e = f)),
						  (m = n * s + o * a + p) < (p = n * c + o * a + p) &&
								((f = p), (p = m), (m = f)),
						  (h = (_ < p ? _ : p) - 1),
						  (m < e ? e : m) + 1)),
			  (this._minX = l),
			  (this._minY = h),
			  (this._maxX = u),
			  (this._maxY = m),
			  (this._width = u - l),
			  (this._height = m - h),
			  (this._area = this._width * this._height))
			: this.setEmpty();
	});
var DirtyRegion = function () {
		(this.dirtyList = []),
			(this.hasClipRect = !1),
			(this.clipWidth = 0),
			(this.clipHeight = 0),
			(this.clipArea = 0),
			(this.clipRectChanged = !1);
	},
	dirtyRegionProto = DirtyRegion.prototype;
(dirtyRegionProto.setClipRect = function (t, e) {
	(this.hasClipRect = !0),
		(this.clipRectChanged = !0),
		(this.clipWidth = Math.ceil(t)),
		(this.clipHeight = Math.ceil(e)),
		(this.clipArea = this.clipWidth * this.clipHeight);
}),
	(dirtyRegionProto.addRegion = function (t) {
		var e = t._minX,
			i = t._minY,
			n = t._maxX,
			r = t._maxY;
		if (
			(this.hasClipRect &&
				(e < 0 && (e = 0),
				i < 0 && (i = 0),
				n > this.clipWidth && (n = this.clipWidth),
				r > this.clipHeight && (r = this.clipHeight)),
			n <= e || r <= i)
		)
			return !1;
		if (this.clipRectChanged) return !0;
		var o = this.dirtyList,
			t = regionCreate();
		return o.push(t.setTo(e, i, n, r)), this.mergeDirtyList(o), !0;
	}),
	(dirtyRegionProto.clear = function () {
		for (var t = this.dirtyList, e = t.length, i = 0; i < e; i++)
			regionRelease(t[i]);
		t.length = 0;
	}),
	(dirtyRegionProto.getDirtyRegions = function () {
		var t = this.dirtyList;
		if (this.clipRectChanged) {
			(this.clipRectChanged = !1), this.clear();
			var e = regionCreate();
			t.push(e.setTo(0, 0, this.clipWidth, this.clipHeight));
		} else for (; this.mergeDirtyList(t); );
		var i = this.dirtyList.length;
		if (0 < i) for (var n = 0; n < i; n++) this.dirtyList[n].intValues();
		return this.dirtyList;
	}),
	(dirtyRegionProto.mergeDirtyList = function (t) {
		var e = t.length;
		if (e < 2) return !1;
		for (
			var i = this.hasClipRect,
				n = 3 < e ? Number.POSITIVE_INFINITY : 0,
				r = 0,
				o = 0,
				s = 0,
				c = 0;
			c < e - 1;
			c++
		) {
			var a = t[c];
			i && (s += a.area);
			for (var l = c + 1; l < e; l++) {
				var h = t[l],
					h = unionArea(a, h) - a.area - h.area;
				h < n && ((r = c), (o = l), (n = h));
			}
		}
		if (
			(i && 0.95 < s / this.clipArea && (this.clipRectChanged = !0),
			r == o)
		)
			return !1;
		var u = t[o];
		return t[r].union(u), regionRelease(u), t.splice(o, 1), !0;
	}),
	(cc.Region = Region),
	(cc.DirtyRegion = DirtyRegion),
	(cc.profiler = (function () {
		var t = !1,
			e = !1,
			i = 0,
			n = 0,
			r = 0,
			o = 0,
			s = null,
			c = document.createElement('div'),
			a = document.createElement('div'),
			l = document.createElement('div'),
			h = document.createElement('div'),
			u = 10,
			_ = [0, 10, 20, 30],
			d = [0, 0, 0, 0],
			p = 3,
			f = 0,
			m = 0;
		(h.id = 'fps'),
			(h.style.position = 'absolute'),
			(h.style.padding = '3px'),
			(h.style.textAlign = 'left'),
			(h.style.backgroundColor = 'rgb(0, 0, 34)'),
			(h.style.bottom = cc.DIRECTOR_STATS_POSITION.y + '0px'),
			(h.style.left = cc.DIRECTOR_STATS_POSITION.x + 'px'),
			(h.style.width = '45px'),
			(h.style.height = '60px');
		for (var g = [l, a, c], y = 0; y < 3; ++y) {
			var T = g[y].style;
			(T.color = 'rgb(0, 255, 255)'),
				(T.font = 'bold 12px Helvetica, Arial'),
				(T.lineHeight = '20px'),
				(T.width = '100%'),
				h.appendChild(g[y]);
		}
		function S() {
			(r = cc.director.getSecondsPerFrame()),
				i++,
				(o += cc.director.getDeltaTime()) > cc.DIRECTOR_FPS_INTERVAL &&
					((n = i / o),
					(o = i = 0),
					C.onFrameRateChange &&
						(function (t) {
							var e = _.length - 1,
								i = e,
								n = 0;
							for (f++, m += t; 0 <= i; i--)
								if (_[i] <= t) {
									d[i]++;
									break;
								}
							if (u <= f) {
								for (n = m / u, i = e; 0 < i; i--)
									if (0.6 <= d[i] / u && _[i] <= n) {
										i != p &&
											((p = i),
											C.onFrameRateChange &&
												C.onFrameRateChange(
													n.toFixed(2)
												));
										break;
									}
								for (
									_changeCount = 0, m = f = 0, i = e;
									0 < i;
									i--
								)
									d[i] = 0;
							}
						})(n),
					t &&
						((a.innerText = r.toFixed(3)),
						(c.innerText = n.toFixed(1)),
						(l.innerText = (0 | cc.g_NumberOfDraws).toString())));
		}
		var C = {
			onFrameRateChange: null,
			getSecondsPerFrame: function () {
				return r;
			},
			getFrameRate: function () {
				return n;
			},
			setProfileDuration: function (t) {
				!isNaN(t) && 0 < t && (u = t / cc.DIRECTOR_FPS_INTERVAL);
			},
			resumeProfiling: function () {
				cc.eventManager.addListener(s, 1);
			},
			stopProfiling: function () {
				cc.eventManager.removeListener(s);
			},
			isShowingStats: function () {
				return t;
			},
			showStats: function () {
				e || this.init(),
					null === h.parentElement && cc.container.appendChild(h),
					(t = !0);
			},
			hideStats: function () {
				(t = !1),
					h.parentElement === cc.container &&
						cc.container.removeChild(h);
			},
			init: function () {
				e ||
					((s = cc.eventManager.addCustomListener(
						cc.Director.EVENT_AFTER_VISIT,
						S
					)),
					(e = !0));
			},
		};
		return C;
	})()),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		var t, n;
		cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			((cc.DirectorDelegate = cc.Class.extend({
				updateProjection: function () {},
			})),
			(t = cc.Director.prototype),
			(n = function (t) {
				if (t && t._renderCmd) {
					t._renderCmd.setDirtyFlag(
						cc.Node._dirtyFlags.transformDirty
					);
					for (var e = t._children, i = 0; i < e.length; i++) n(e[i]);
				}
			}),
			cc.eventManager.addCustomListener(
				cc.Director.EVENT_PROJECTION_CHANGED,
				function () {
					cc.director;
					for (
						var t = cc.director._scenesStack, e = 0;
						e < t.length;
						e++
					)
						n(t[e]);
				}
			),
			(t.setProjection = function (t) {
				var e = this,
					i = e._winSizeInPoints;
				e.setViewport();
				var n = e._openGLView,
					r = n._viewPortRect.x / n._scaleX,
					o = n._viewPortRect.y / n._scaleY;
				switch (t) {
					case cc.Director.PROJECTION_2D:
						cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),
							cc.kmGLLoadIdentity();
						var s = cc.math.Matrix4.createOrthographicProjection(
							0,
							i.width,
							0,
							i.height,
							-1024,
							1024
						);
						cc.kmGLMultMatrix(s),
							cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),
							cc.kmGLLoadIdentity();
						break;
					case cc.Director.PROJECTION_3D:
						var c = e.getZEye(),
							a = new cc.math.Matrix4(),
							l = new cc.math.Matrix4();
						cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),
							cc.kmGLLoadIdentity(),
							(a = cc.math.Matrix4.createPerspectiveProjection(
								60,
								i.width / i.height,
								0.1,
								2 * c
							)),
							cc.kmGLMultMatrix(a),
							cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),
							cc.kmGLLoadIdentity();
						(s = new cc.math.Vec3(
							-r + i.width / 2,
							-o + i.height / 2,
							c
						)),
							(a = new cc.math.Vec3(
								-r + i.width / 2,
								-o + i.height / 2,
								0
							)),
							(c = new cc.math.Vec3(0, 1, 0));
						l.lookAt(s, a, c), cc.kmGLMultMatrix(l);
						break;
					case cc.Director.PROJECTION_CUSTOM:
						e._projectionDelegate &&
							e._projectionDelegate.updateProjection();
						break;
					default:
						cc.log(cc._LogInfos.Director_setProjection);
				}
				(e._projection = t),
					cc.eventManager.dispatchEvent(e._eventProjectionChanged),
					cc.setProjectionMatrixDirty(),
					(cc.renderer.childrenOrderDirty = !0);
			}),
			(t.setDepthTest = function (t) {
				cc.renderer.setDepthTest(t);
			}),
			(t.setClearColor = function (t) {
				cc.renderer._clearColor = t;
			}),
			(t.setOpenGLView = function (t) {
				(this._winSizeInPoints.width = cc._canvas.width),
					(this._winSizeInPoints.height = cc._canvas.height),
					(this._openGLView = t || cc.view);
				t = cc.configuration;
				t.gatherGPUInfo(),
					t.dumpInfo(),
					this.setGLDefaultValues(),
					cc.eventManager && cc.eventManager.setEnabled(!0);
			}),
			(t._clear = function () {
				var t = cc._renderContext;
				t.clear(t.COLOR_BUFFER_BIT | t.DEPTH_BUFFER_BIT);
			}),
			(t.getVisibleSize = function () {
				return this._openGLView.getVisibleSize();
			}),
			(t.getVisibleOrigin = function () {
				return this._openGLView.getVisibleOrigin();
			}),
			(t.getZEye = function () {
				return this._winSizeInPoints.height / 1.1566;
			}),
			(t.setViewport = function () {
				var t,
					e = this._openGLView;
				e &&
					((t = this._winSizeInPoints),
					e.setViewPortInPoints(
						-e._viewPortRect.x / e._scaleX,
						-e._viewPortRect.y / e._scaleY,
						t.width,
						t.height
					));
			}),
			(t.getOpenGLView = function () {
				return this._openGLView;
			}),
			(t.getProjection = function () {
				return this._projection;
			}),
			(t.setAlphaBlending = function (t) {
				t
					? cc.glBlendFunc(cc.BLEND_SRC, cc.BLEND_DST)
					: cc.glBlendFunc(
							cc._renderContext.ONE,
							cc._renderContext.ZERO
					  );
			}),
			(t.setGLDefaultValues = function () {
				this.setAlphaBlending(!0),
					this.setProjection(this._projection),
					cc._renderContext.clearColor(0, 0, 0, 0);
			}));
	}),
	(cc.configuration = {
		ERROR: 0,
		STRING: 1,
		INT: 2,
		DOUBLE: 3,
		BOOLEAN: 4,
		_maxTextureSize: 0,
		_maxModelviewStackDepth: 0,
		_supportsPVRTC: !1,
		_supportsNPOT: !1,
		_supportsBGRA8888: !1,
		_supportsDiscardFramebuffer: !1,
		_supportsShareableVAO: !1,
		_maxSamplesAllowed: 0,
		_maxTextureUnits: 0,
		_GlExtensions: '',
		_valueDict: {},
		_inited: !1,
		_init: function () {
			var t = this._valueDict;
			(t['cocos2d.x.version'] = cc.ENGINE_VERSION),
				(t['cocos2d.x.compiled_with_profiler'] = !1),
				(t['cocos2d.x.compiled_with_gl_state_cache'] =
					cc.ENABLE_GL_STATE_CACHE),
				(this._inited = !0);
		},
		getMaxTextureSize: function () {
			return this._maxTextureSize;
		},
		getMaxModelviewStackDepth: function () {
			return this._maxModelviewStackDepth;
		},
		getMaxTextureUnits: function () {
			return this._maxTextureUnits;
		},
		supportsNPOT: function () {
			return this._supportsNPOT;
		},
		supportsPVRTC: function () {
			return this._supportsPVRTC;
		},
		supportsETC: function () {
			return !1;
		},
		supportsS3TC: function () {
			return !1;
		},
		supportsATITC: function () {
			return !1;
		},
		supportsBGRA8888: function () {
			return this._supportsBGRA8888;
		},
		supportsDiscardFramebuffer: function () {
			return this._supportsDiscardFramebuffer;
		},
		supportsShareableVAO: function () {
			return this._supportsShareableVAO;
		},
		checkForGLExtension: function (t) {
			return -1 < this._GlExtensions.indexOf(t);
		},
		getValue: function (t, e) {
			this._inited || this._init();
			var i = this._valueDict;
			return i[t] || e;
		},
		setValue: function (t, e) {
			this._valueDict[t] = e;
		},
		dumpInfo: function () {
			0 === cc.ENABLE_GL_STATE_CACHE &&
				(cc.log(''),
				cc.log(cc._LogInfos.configuration_dumpInfo),
				cc.log(''));
		},
		gatherGPUInfo: function () {
			if (cc._renderType !== cc.game.RENDER_TYPE_CANVAS) {
				this._inited || this._init();
				var t = cc._renderContext,
					e = this._valueDict;
				(e['gl.vendor'] = t.getParameter(t.VENDOR)),
					(e['gl.renderer'] = t.getParameter(t.RENDERER)),
					(e['gl.version'] = t.getParameter(t.VERSION)),
					(this._GlExtensions = '');
				for (
					var i = t.getSupportedExtensions(), n = 0;
					n < i.length;
					n++
				)
					this._GlExtensions += i[n] + ' ';
				(this._maxTextureSize = t.getParameter(t.MAX_TEXTURE_SIZE)),
					(e['gl.max_texture_size'] = this._maxTextureSize),
					(this._maxTextureUnits = t.getParameter(
						t.MAX_COMBINED_TEXTURE_IMAGE_UNITS
					)),
					(e['gl.max_texture_units'] = this._maxTextureUnits),
					(this._supportsPVRTC = this.checkForGLExtension(
						'GL_IMG_texture_compression_pvrtc'
					)),
					(e['gl.supports_PVRTC'] = this._supportsPVRTC),
					(this._supportsNPOT = !1),
					(e['gl.supports_NPOT'] = this._supportsNPOT),
					(this._supportsBGRA8888 = this.checkForGLExtension(
						'GL_IMG_texture_format_BGRA888'
					)),
					(e['gl.supports_BGRA8888'] = this._supportsBGRA8888),
					(this._supportsDiscardFramebuffer =
						this.checkForGLExtension('GL_EXT_discard_framebuffer')),
					(e['gl.supports_discard_framebuffer'] =
						this._supportsDiscardFramebuffer),
					(this._supportsShareableVAO = this.checkForGLExtension(
						'vertex_array_object'
					)),
					(e['gl.supports_vertex_array_object'] =
						this._supportsShareableVAO),
					cc.checkGLErrorDebug();
			}
		},
		loadConfigFile: function (t) {
			this._inited || this._init();
			var e = cc.loader.getRes(t);
			if (!e) throw new Error('Please load the resource first : ' + t);
			cc.assert(e, cc._LogInfos.configuration_loadConfigFile_2, t);
			var i = e.data;
			if (i) for (var n in i) this._valueDict[n] = i[n];
			else cc.log(cc._LogInfos.configuration_loadConfigFile, t);
		},
	}),
	(cc.rendererWebGL = (function () {
		var c = { texture: null, blendSrc: null, blendDst: null, shader: null },
			s = null,
			a = null,
			l = 0,
			h = 0,
			u = 6,
			_ = null,
			d = null,
			p = null;
		function i(t) {
			var e = cc._renderContext;
			if (s) {
				e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, s);
				for (
					var i = new Uint16Array(6 * t), n = 0, r = 0, o = 6 * t;
					r < o;
					r += 6
				)
					(i[r] = n + 0),
						(i[r + 1] = n + 1),
						(i[r + 2] = n + 2),
						(i[r + 3] = n + 1),
						(i[r + 4] = n + 2),
						(i[r + 5] = n + 3),
						(n += 4);
				e.bufferData(e.ELEMENT_ARRAY_BUFFER, i, e.STATIC_DRAW);
			}
			a &&
				((_ = new ArrayBuffer(4 * (4 * t * u))),
				(d = new Float32Array(_)),
				(p = new Uint32Array(_)),
				e.bindBuffer(e.ARRAY_BUFFER, a),
				e.bufferData(e.ARRAY_BUFFER, d, e.DYNAMIC_DRAW)),
				(l = 4 * t);
		}
		return {
			mat4Identity: null,
			childrenOrderDirty: !0,
			assignedZ: 0,
			assignedZStep: 0.01,
			_transformNodePool: [],
			_renderCmds: [],
			_isCacheToBufferOn: !1,
			_cacheToBufferCmds: {},
			_cacheInstanceIds: [],
			_currentID: 0,
			_clearColor: cc.color(),
			init: function () {
				var t,
					e = cc._renderContext;
				e.disable(e.CULL_FACE),
					e.disable(e.DEPTH_TEST),
					(this.mat4Identity = new cc.math.Matrix4()),
					this.mat4Identity.identity(),
					(t = 2e3),
					(e = cc._renderContext),
					null === s &&
						((a = e.createBuffer()), (s = e.createBuffer())),
					i(t),
					cc.sys.os,
					cc.sys.OS_IOS;
			},
			getVertexSize: function () {
				return l;
			},
			getRenderCmd: function (t) {
				return t._createRenderCmd();
			},
			_turnToCacheMode: function (t) {
				(this._isCacheToBufferOn = !0),
					(t = t || 0),
					this._cacheToBufferCmds[t]
						? (this._cacheToBufferCmds[t].length = 0)
						: (this._cacheToBufferCmds[t] = []),
					-1 === this._cacheInstanceIds.indexOf(t) &&
						this._cacheInstanceIds.push(t),
					(this._currentID = t);
			},
			_turnToNormalMode: function () {
				this._isCacheToBufferOn = !1;
			},
			_removeCache: function (t) {
				t = t || this._currentID;
				var e = this._cacheToBufferCmds[t];
				e && ((e.length = 0), delete this._cacheToBufferCmds[t]);
				e = this._cacheInstanceIds;
				cc.arrayRemoveObject(e, t);
			},
			_renderingToBuffer: function (t) {
				t = t || this._currentID;
				var e = this._cacheToBufferCmds[t],
					i = cc._renderContext;
				this.rendering(i, e), this._removeCache(t);
				t = this._cacheInstanceIds;
				0 === t.length
					? (this._isCacheToBufferOn = !1)
					: (this._currentID = t[t.length - 1]);
			},
			resetFlag: function () {
				this.childrenOrderDirty && (this.childrenOrderDirty = !1),
					(this._transformNodePool.length = 0);
			},
			transform: function () {
				var t,
					e,
					i = this._transformNodePool;
				for (
					i.sort(this._sortNodeByLevelAsc), t = 0, e = i.length;
					t < e;
					t++
				)
					i[t].updateStatus();
				i.length = 0;
			},
			transformDirty: function () {
				return 0 < this._transformNodePool.length;
			},
			_sortNodeByLevelAsc: function (t, e) {
				return t._curLevel - e._curLevel;
			},
			pushDirtyNode: function (t) {
				this._transformNodePool.push(t);
			},
			clearRenderCommands: function () {
				this._renderCmds.length = 0;
			},
			clear: function () {
				var t = cc._renderContext;
				t.clearColor(
					this._clearColor.r,
					this._clearColor.g,
					this._clearColor.b,
					this._clearColor.a
				),
					t.clear(t.COLOR_BUFFER_BIT | t.DEPTH_BUFFER_BIT);
			},
			setDepthTest: function (t) {
				var e = cc._renderContext;
				t
					? (e.clearDepth(1),
					  e.enable(e.DEPTH_TEST),
					  e.depthFunc(e.LEQUAL))
					: e.disable(e.DEPTH_TEST);
			},
			pushRenderCommand: function (t) {
				var e;
				t.needDraw() &&
					(this._isCacheToBufferOn
						? ((e = this._currentID),
						  -1 === (e = this._cacheToBufferCmds[e]).indexOf(t) &&
								e.push(t))
						: -1 === this._renderCmds.indexOf(t) &&
						  this._renderCmds.push(t));
			},
			_increaseBatchingSize: function (t) {
				h += t;
			},
			_uploadBufferData: function (t) {
				l <= h && this._batchRendering();
				var e = t._node._texture,
					i = t._node._blendFunc.src,
					n = t._node._blendFunc.dst,
					r = t._shaderProgram;
				(c.texture === e &&
					c.blendSrc === i &&
					c.blendDst === n &&
					c.shader === r) ||
					(this._batchRendering(),
					(c.texture = e),
					(c.blendSrc = i),
					(c.blendDst = n),
					(c.shader = r));
				t = t.uploadData(d, p, h * u);
				0 < t && (h += t);
			},
			_batchRendering: function () {
				var t, e, i, n;
				0 !== h &&
					c.texture &&
					((t = cc._renderContext),
					(n = c.texture),
					(i = c.shader),
					(e = h / 4),
					i && (i.use(), i._updateProjectionUniform()),
					cc.glBlendFunc(c.blendSrc, c.blendDst),
					cc.glBindTexture2DN(0, n),
					(i = !t.bindBuffer(t.ARRAY_BUFFER, a)),
					0.5 * l < h
						? t.bufferData(t.ARRAY_BUFFER, d, t.DYNAMIC_DRAW)
						: ((n = d.subarray(0, h * u)),
						  t.bufferData(t.ARRAY_BUFFER, n, t.DYNAMIC_DRAW)),
					i &&
						(t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
						t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
						t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
						t.vertexAttribPointer(
							cc.VERTEX_ATTRIB_POSITION,
							3,
							t.FLOAT,
							!1,
							24,
							0
						),
						t.vertexAttribPointer(
							cc.VERTEX_ATTRIB_COLOR,
							4,
							t.UNSIGNED_BYTE,
							!0,
							24,
							12
						),
						t.vertexAttribPointer(
							cc.VERTEX_ATTRIB_TEX_COORDS,
							2,
							t.FLOAT,
							!1,
							24,
							16
						)),
					t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, s),
					t.drawElements(t.TRIANGLES, 6 * e, t.UNSIGNED_SHORT, 0),
					cc.g_NumberOfDraws++,
					(h = 0));
			},
			rendering: function (t, e) {
				var i,
					n,
					r,
					o = e || this._renderCmds,
					s = t || cc._renderContext;
				for (
					s.bindBuffer(gl.ARRAY_BUFFER, null), i = 0, n = o.length;
					i < n;
					++i
				)
					(r = o[i]).uploadData
						? this._uploadBufferData(r)
						: (0 < h && this._batchRendering(), r.rendering(s));
				this._batchRendering(), (c.texture = null);
			},
		};
	})()),
	(function () {
		cc.Node.WebGLRenderCmd = function (t) {
			cc.Node.RenderCmd.call(this, t), (this._shaderProgram = null);
		};
		var t = (cc.Node.WebGLRenderCmd.prototype = Object.create(
			cc.Node.RenderCmd.prototype
		));
		(t.constructor = cc.Node.WebGLRenderCmd),
			(t._updateColor = function () {}),
			(t.setShaderProgram = function (t) {
				this._shaderProgram = t;
			}),
			(t.getShaderProgram = function () {
				return this._shaderProgram;
			});
	})(),
	(function () {
		cc.Layer.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t);
		};
		var t = (cc.Layer.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.Layer.WebGLRenderCmd),
			(t.bake = function () {}),
			(t.unbake = function () {}),
			(t._bakeForAddChild = function () {});
	})(),
	(function () {
		cc.LayerColor.WebGLRenderCmd = function (t) {
			cc.Layer.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._matrix = new cc.math.Matrix4()),
				this._matrix.identity();
			(this._squareVerticesAB = new ArrayBuffer(48)),
				(this._squareColorsAB = new ArrayBuffer(16));
			var e = this._squareVerticesAB,
				i = this._squareColorsAB,
				n = cc.Vertex3F.BYTES_PER_ELEMENT,
				t = cc.Color.BYTES_PER_ELEMENT;
			(this._squareVertices = [
				new cc.Vertex3F(0, 0, 0, e, 0),
				new cc.Vertex3F(0, 0, 0, e, n),
				new cc.Vertex3F(0, 0, 0, e, 2 * n),
				new cc.Vertex3F(0, 0, 0, e, 3 * n),
			]),
				(this._squareColors = [
					cc.color(0, 0, 0, 255, i, 0),
					cc.color(0, 0, 0, 255, i, t),
					cc.color(0, 0, 0, 255, i, 2 * t),
					cc.color(0, 0, 0, 255, i, 3 * t),
				]),
				(this._verticesFloat32Buffer =
					cc._renderContext.createBuffer()),
				(this._colorsUint8Buffer = cc._renderContext.createBuffer()),
				(this._shaderProgram = cc.shaderCache.programForKey(
					cc.SHADER_POSITION_COLOR
				));
		};
		var t = (cc.LayerColor.WebGLRenderCmd.prototype = Object.create(
			cc.Layer.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.LayerColor.WebGLRenderCmd),
			(t.rendering = function (t) {
				var e = t || cc._renderContext,
					i = this._node,
					t = this._worldTransform;
				(this._matrix.mat[0] = t.a),
					(this._matrix.mat[4] = t.c),
					(this._matrix.mat[12] = t.tx),
					(this._matrix.mat[1] = t.b),
					(this._matrix.mat[5] = t.d),
					(this._matrix.mat[13] = t.ty),
					this._shaderProgram.use(),
					this._shaderProgram._setUniformForMVPMatrixWithMat4(
						this._matrix
					),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
					cc.glBlendFunc(i._blendFunc.src, i._blendFunc.dst),
					e.bindBuffer(e.ARRAY_BUFFER, this._verticesFloat32Buffer),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_POSITION,
						3,
						e.FLOAT,
						!1,
						0,
						0
					),
					e.bindBuffer(e.ARRAY_BUFFER, this._colorsUint8Buffer),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_COLOR,
						4,
						e.UNSIGNED_BYTE,
						!0,
						0,
						0
					),
					e.drawArrays(
						e.TRIANGLE_STRIP,
						0,
						this._squareVertices.length
					);
			}),
			(t.transform = function (t, e) {
				this.originTransform(t, e);
				var i = this._node,
					n = i._contentSize.width,
					t = i._contentSize.height,
					e = this._squareVertices;
				(e[1].x = n),
					(e[2].y = t),
					(e[3].x = n),
					(e[3].y = t),
					(e[0].z = e[1].z = e[2].z = e[3].z = i._vertexZ),
					this._bindLayerVerticesBufferData();
			}),
			(t._updateColor = function () {
				for (
					var t = this._displayedColor,
						e = this._displayedOpacity,
						i = this._squareColors,
						n = 0;
					n < 4;
					n++
				)
					(i[n].r = t.r),
						(i[n].g = t.g),
						(i[n].b = t.b),
						(i[n].a = e);
				this._bindLayerColorsBufferData();
			}),
			(t._bindLayerVerticesBufferData = function () {
				var t = cc._renderContext;
				t.bindBuffer(t.ARRAY_BUFFER, this._verticesFloat32Buffer),
					t.bufferData(
						t.ARRAY_BUFFER,
						this._squareVerticesAB,
						t.DYNAMIC_DRAW
					);
			}),
			(t._bindLayerColorsBufferData = function () {
				var t = cc._renderContext;
				t.bindBuffer(t.ARRAY_BUFFER, this._colorsUint8Buffer),
					t.bufferData(
						t.ARRAY_BUFFER,
						this._squareColorsAB,
						t.STATIC_DRAW
					);
			}),
			(t.updateBlendFunc = function (t) {});
	})(),
	(function () {
		cc.LayerGradient.WebGLRenderCmd = function (t) {
			cc.LayerColor.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._clipRect = new cc.Rect()),
				(this._clippingRectDirty = !1);
		};
		var t = (cc.LayerGradient.WebGLRenderCmd.prototype = Object.create(
			cc.LayerColor.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.LayerGradient.WebGLRenderCmd),
			(t.updateStatus = function () {
				var t = cc.Node._dirtyFlags,
					e = this._dirtyFlag;
				e & t.gradientDirty &&
					((this._dirtyFlag |= t.colorDirty),
					this._updateVertex(),
					(this._dirtyFlag = (e & t.gradientDirty) ^ e)),
					cc.Node.RenderCmd.prototype.updateStatus.call(this);
			}),
			(t._syncStatus = function (t) {
				var e = cc.Node._dirtyFlags,
					i = this._dirtyFlag;
				i & e.gradientDirty &&
					((this._dirtyFlag |= e.colorDirty),
					this._updateVertex(),
					(this._dirtyFlag = (i & e.gradientDirty) ^ i)),
					cc.Node.RenderCmd.prototype._syncStatus.call(this, t);
			}),
			(t.transform = function (t, e) {
				this.originTransform(t, e), this._updateVertex();
			}),
			(t._updateVertex = function () {
				var t = this._node,
					e = t._colorStops;
				if (e && !(e.length < 2)) {
					this._clippingRectDirty = !0;
					var i = e.length,
						n = 2 * i,
						r = t._contentSize,
						o = this._squareVertices;
					if (o.length < n) {
						(this._squareVerticesAB = new ArrayBuffer(12 * n)),
							(o.length = 0);
						for (
							var s = this._squareVerticesAB,
								c = cc.Vertex3F.BYTES_PER_ELEMENT,
								a = 0;
							a < n;
							a++
						)
							o.push(new cc.Vertex3F(0, 0, 0, s, c * a));
					}
					var l =
							Math.PI +
							cc.pAngleSigned(cc.p(0, -1), t._alongVector),
						h = cc.p(r.width / 2, r.height / 2),
						u = Math.round(cc.radiansToDegrees(l)),
						_ = cc.affineTransformMake(1, 0, 0, 1, h.x, h.y),
						_ = cc.affineTransformRotate(_, l),
						d =
							u < 90
								? ((p = cc.p(-h.x, h.y)), cc.p(h.x, h.y))
								: u < 180
								? ((p = cc.p(h.x, h.y)), cc.p(h.x, -h.y))
								: u < 270
								? ((p = cc.p(h.x, -h.y)), cc.p(-h.x, -h.y))
								: ((p = cc.p(-h.x, -h.y)), cc.p(-h.x, h.y)),
						u = Math.sin(l),
						l = Math.cos(l),
						p = Math.abs((p.x * l - p.y * u) / h.x),
						l = Math.abs((d.x * u + d.y * l) / h.y);
					for (
						_ = cc.affineTransformScale(_, p, l), a = 0;
						a < i;
						a++
					) {
						var f = e[a].p * r.height,
							m = cc.pointApplyAffineTransform(-h.x, f - h.y, _);
						(o[2 * a].x = m.x),
							(o[2 * a].y = m.y),
							(o[2 * a].z = t._vertexZ);
						f = cc.pointApplyAffineTransform(
							r.width - h.x,
							f - h.y,
							_
						);
						(o[2 * a + 1].x = f.x),
							(o[2 * a + 1].y = f.y),
							(o[2 * a + 1].z = t._vertexZ);
					}
					this._bindLayerVerticesBufferData();
				}
			}),
			(t._updateColor = function () {
				var t = this._node._colorStops;
				if (t && !(t.length < 2)) {
					var e = t.length,
						n = this._squareColors,
						r = 2 * e;
					if (n.length < r) {
						(this._squareColorsAB = new ArrayBuffer(4 * r)),
							(n.length = 0);
						var o = this._squareColorsAB,
							s = cc.Color.BYTES_PER_ELEMENT;
						for (i = 0; i < r; i++)
							n.push(cc.color(0, 0, 0, 255, o, s * i));
					}
					var c = this._displayedOpacity / 255;
					for (i = 0; i < e; i++) {
						var a = t[i].color,
							l = n[2 * i],
							h = n[2 * i + 1];
						(l.r = a.r),
							(l.g = a.g),
							(l.b = a.b),
							(l.a = a.a * c),
							(h.r = a.r),
							(h.g = a.g),
							(h.b = a.b),
							(h.a = a.a * c);
					}
					this._bindLayerColorsBufferData();
				}
			}),
			(t.rendering = function (t) {
				var e = t || cc._renderContext,
					i = this._node,
					t = this._getClippingRect();
				e.enable(e.SCISSOR_TEST),
					cc.view.setScissorInPoints(t.x, t.y, t.width, t.height);
				t = this._worldTransform;
				(this._matrix.mat[0] = t.a),
					(this._matrix.mat[4] = t.c),
					(this._matrix.mat[12] = t.tx),
					(this._matrix.mat[1] = t.b),
					(this._matrix.mat[5] = t.d),
					(this._matrix.mat[13] = t.ty),
					this._shaderProgram.use(),
					this._shaderProgram._setUniformForMVPMatrixWithMat4(
						this._matrix
					),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
					cc.glBlendFunc(i._blendFunc.src, i._blendFunc.dst),
					e.bindBuffer(e.ARRAY_BUFFER, this._verticesFloat32Buffer),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_POSITION,
						3,
						e.FLOAT,
						!1,
						0,
						0
					),
					e.bindBuffer(e.ARRAY_BUFFER, this._colorsUint8Buffer),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_COLOR,
						4,
						e.UNSIGNED_BYTE,
						!0,
						0,
						0
					),
					e.drawArrays(
						e.TRIANGLE_STRIP,
						0,
						this._squareVertices.length
					),
					e.disable(e.SCISSOR_TEST);
			}),
			(t._getClippingRect = function () {
				var t, e;
				return (
					this._clippingRectDirty &&
						((e = this._node),
						(t = cc.rect(
							0,
							0,
							e._contentSize.width,
							e._contentSize.height
						)),
						(e = e.getNodeToWorldTransform()),
						(this._clipRect = cc._rectApplyAffineTransformIn(
							t,
							e
						))),
					this._clipRect
				);
			});
	})(),
	(function () {
		cc.Sprite.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._vertices = [
					{ x: 0, y: 0, u: 0, v: 0 },
					{ x: 0, y: 0, u: 0, v: 0 },
					{ x: 0, y: 0, u: 0, v: 0 },
					{ x: 0, y: 0, u: 0, v: 0 },
				]),
				(this._color = new Uint32Array(1)),
				(this._dirty = !1),
				(this._recursiveDirty = !1),
				(this._shaderProgram = cc.shaderCache.programForKey(
					cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST
				));
		};
		var t = (cc.Sprite.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.Sprite.WebGLRenderCmd),
			(t.updateBlendFunc = function (t) {}),
			(t.setDirtyFlag = function (t) {
				cc.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this, t),
					(this._dirty = !0);
			}),
			(t.setDirtyRecursively = function (t) {
				(this._recursiveDirty = t), (this._dirty = t);
				for (
					var e,
						i = this._node._children,
						n = i ? i.length : 0,
						r = 0;
					r < n;
					r++
				)
					(e = i[r]) instanceof cc.Sprite &&
						e._renderCmd.setDirtyRecursively(t);
			}),
			(t._setBatchNodeForAddChild = function (t) {
				var e = this._node;
				if (e._batchNode) {
					if (!(t instanceof cc.Sprite))
						return cc.log(cc._LogInfos.Sprite_addChild), !1;
					t.texture._webTextureObj !==
						e.textureAtlas.texture._webTextureObj &&
						cc.log(cc._LogInfos.Sprite_addChild_2),
						e._batchNode.appendChild(t),
						e._reorderChildDirty ||
							e._setReorderChildDirtyRecursively();
				}
				return !0;
			}),
			(t._handleTextureForRotatedTexture = function (t) {
				return t;
			}),
			(t.isFrameDisplayed = function (t) {
				var e = this._node;
				return (
					cc.rectEqualToRect(t.getRect(), e._rect) &&
					t.getTexture().getName() === e._texture.getName() &&
					cc.pointEqualToPoint(
						t.getOffset(),
						e._unflippedOffsetPositionFromCenter
					)
				);
			}),
			(t._textureLoadedCallback = function (t) {
				var e;
				this._textureLoaded ||
					((this._textureLoaded = !0),
					(e = this._rect)
						? cc._rectEqualToZero(e) &&
						  ((e.width = t.width), (e.height = t.height))
						: (e = cc.rect(0, 0, t.width, t.height)),
					(this.texture = t),
					this.setTextureRect(e, this._rectRotated),
					this.setBatchNode(this._batchNode),
					this.dispatchEvent('load'),
					(cc.renderer.childrenOrderDirty = !0));
			}),
			(t._setTextureCoords = function (t, e) {
				void 0 === e && (e = !0), e && (t = cc.rectPointsToPixels(t));
				var i,
					n,
					r,
					o,
					s,
					c = this._node,
					a = c._batchNode ? c.textureAtlas.texture : c._texture,
					l = this._vertices;
				a &&
					((e = a.pixelsWidth),
					(a = a.pixelsHeight),
					c._rectRotated
						? ((o = cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL
								? ((n =
										(i = (2 * t.x + 1) / (2 * e)) +
										(2 * t.height - 2) / (2 * e)),
								  (r = (2 * t.y + 1) / (2 * a)) +
										(2 * t.width - 2) / (2 * a))
								: ((i = t.x / e),
								  (n = (t.x + t.height) / e),
								  (r = t.y / a),
								  (t.y + t.width) / a)),
						  c._flippedX && ((s = r), (r = o), (o = s)),
						  c._flippedY && ((s = i), (i = n), (n = s)),
						  (l[0].u = n),
						  (l[0].v = r),
						  (l[1].u = i),
						  (l[1].v = r),
						  (l[2].u = n),
						  (l[2].v = o),
						  (l[3].u = i))
						: ((o = cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL
								? ((n =
										(i = (2 * t.x + 1) / (2 * e)) +
										(2 * t.width - 2) / (2 * e)),
								  (r = (2 * t.y + 1) / (2 * a)) +
										(2 * t.height - 2) / (2 * a))
								: ((i = t.x / e),
								  (n = (t.x + t.width) / e),
								  (r = t.y / a),
								  (t.y + t.height) / a)),
						  c._flippedX && ((s = i), (i = n), (n = s)),
						  c._flippedY && ((s = r), (r = o), (o = s)),
						  (l[0].u = i),
						  (l[0].v = r),
						  (l[1].u = i),
						  (l[1].v = o),
						  (l[2].u = n),
						  (l[2].v = r),
						  (l[3].u = n)),
					(l[3].v = o));
			}),
			(t._setColorDirty = function () {}),
			(t._updateBlendFunc = function () {
				var t, e;
				this._batchNode
					? cc.log(cc._LogInfos.Sprite__updateBlendFunc)
					: ((e = (t = this._node)._blendFunc),
					  t._texture && t._texture.hasPremultipliedAlpha()
							? (e.src === cc.SRC_ALPHA &&
									e.dst === cc.BLEND_DST &&
									(e.src = cc.ONE),
							  (t.opacityModifyRGB = !0))
							: (e.src === cc.ONE &&
									e.dst === cc.BLEND_DST &&
									(e.src = cc.SRC_ALPHA),
							  (t.opacityModifyRGB = !1)));
			}),
			(t._setTexture = function (t) {
				var e = this._node;
				e._batchNode
					? e._batchNode.texture !== t &&
					  cc.log(cc._LogInfos.Sprite_setTexture)
					: e._texture !== t &&
					  ((e._textureLoaded = !!t && t._textureLoaded),
					  (e._texture = t),
					  this._updateBlendFunc(),
					  e._textureLoaded &&
							(cc.renderer.childrenOrderDirty = !0));
			}),
			(t._checkTextureBoundary = function (t, e, i) {
				var n;
				t &&
					t.url &&
					((e = i
						? ((n = e.x + e.height), e.y + e.width)
						: ((n = e.x + e.width), e.y + e.height)),
					n > t.width && cc.error(cc._LogInfos.RectWidth, t.url),
					e > t.height && cc.error(cc._LogInfos.RectHeight, t.url));
			}),
			(t.transform = function (t, e) {
				this.originTransform(t, e);
				var i = this._node,
					n = i._offsetPosition.x,
					r = n + i._rect.width,
					o = i._offsetPosition.y,
					t = o + i._rect.height,
					e = this._worldTransform,
					i = this._vertices;
				(i[0].x = n * e.a + t * e.c + e.tx),
					(i[0].y = n * e.b + t * e.d + e.ty),
					(i[1].x = n * e.a + o * e.c + e.tx),
					(i[1].y = n * e.b + o * e.d + e.ty),
					(i[2].x = r * e.a + t * e.c + e.tx),
					(i[2].y = r * e.b + t * e.d + e.ty),
					(i[3].x = r * e.a + o * e.c + e.tx),
					(i[3].y = r * e.b + o * e.d + e.ty);
			}),
			(t.needDraw = function () {
				var t = this._node._texture;
				return this._needDraw && t;
			}),
			(t.uploadData = function (t, e, i) {
				var n = this._node,
					r = n._texture;
				if (
					!(
						r &&
						r._textureLoaded &&
						n._rect.width &&
						n._rect.height &&
						this._displayedOpacity
					)
				)
					return !1;
				var o = this._displayedOpacity,
					s = this._displayedColor.r,
					c = this._displayedColor.g,
					a = this._displayedColor.b;
				n._opacityModifyRGB && ((s *= r = o / 255), (c *= r), (a *= r)),
					(this._color[0] = (o << 24) | (a << 16) | (c << 8) | s);
				for (
					var l,
						h = n._vertexZ,
						u = this._vertices,
						_ = u.length,
						d = i,
						p = 0;
					p < _;
					++p
				)
					(l = u[p]),
						(t[d] = l.x),
						(t[d + 1] = l.y),
						(t[d + 2] = h),
						(e[d + 3] = this._color[0]),
						(t[d + 4] = l.u),
						(t[d + 5] = l.v),
						(d += 6);
				return _;
			});
	})(),
	(function () {
		cc.LabelTTF.WebGLRenderCmd = function (t) {
			cc.Sprite.WebGLRenderCmd.call(this, t),
				cc.LabelTTF.CacheRenderCmd.call(this);
		};
		var t = (cc.LabelTTF.WebGLRenderCmd.prototype = Object.create(
			cc.Sprite.WebGLRenderCmd.prototype
		));
		cc.inject(cc.LabelTTF.CacheRenderCmd.prototype, t),
			(t.constructor = cc.LabelTTF.WebGLRenderCmd),
			(t._updateColor = function () {});
	})(),
	(cc.DrawingPrimitiveWebGL = cc.Class.extend({
		_renderContext: null,
		_initialized: !1,
		_shader: null,
		_colorLocation: 'u_color',
		_colorArray: null,
		_pointSizeLocation: 'u_pointSize',
		_pointSize: -1,
		ctor: function (t) {
			if (
				(null == t && (t = cc._renderContext),
				!t instanceof WebGLRenderingContext)
			)
				throw new Error(
					"Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext"
				);
			(this._renderContext = t),
				(this._colorArray = new Float32Array([1, 1, 1, 1]));
		},
		lazy_init: function () {
			this._initialized ||
				((this._shader = cc.shaderCache.programForKey(
					cc.SHADER_POSITION_UCOLOR
				)),
				this._shader._addUniformLocation(this._colorLocation),
				this._shader._addUniformLocation(this._pointSizeLocation),
				(this._initialized = !0));
		},
		drawInit: function () {
			this._initialized = !1;
		},
		drawPoint: function (t) {
			this.lazy_init();
			var e = this._renderContext;
			this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				),
				this._shader.setUniformLocationWith1f(
					this._pointSizeLocation,
					this._pointSize
				);
			var i = e.createBuffer();
			e.bindBuffer(e.ARRAY_BUFFER, i),
				e.bufferData(
					e.ARRAY_BUFFER,
					new Float32Array([t.x, t.y]),
					e.STATIC_DRAW
				),
				e.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					e.FLOAT,
					!1,
					0,
					0
				),
				e.drawArrays(e.POINTS, 0, 1),
				e.deleteBuffer(i),
				cc.incrementGLDraws(1);
		},
		drawPoints: function (t, e) {
			var i, n;
			t &&
				0 !== t.length &&
				(this.lazy_init(),
				(i = this._renderContext),
				this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				),
				this._shader.setUniformLocationWith1f(
					this._pointSizeLocation,
					this._pointSize
				),
				(n = i.createBuffer()),
				i.bindBuffer(i.ARRAY_BUFFER, n),
				i.bufferData(
					i.ARRAY_BUFFER,
					this._pointsToTypeArray(t),
					i.STATIC_DRAW
				),
				i.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					i.FLOAT,
					!1,
					0,
					0
				),
				i.drawArrays(i.POINTS, 0, t.length),
				i.deleteBuffer(n),
				cc.incrementGLDraws(1));
		},
		_pointsToTypeArray: function (t) {
			for (
				var e = new Float32Array(2 * t.length), i = 0;
				i < t.length;
				i++
			)
				(e[2 * i] = t[i].x), (e[2 * i + 1] = t[i].y);
			return e;
		},
		drawLine: function (t, e) {
			this.lazy_init();
			var i = this._renderContext;
			this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				);
			var n = i.createBuffer();
			i.bindBuffer(i.ARRAY_BUFFER, n),
				i.bufferData(
					i.ARRAY_BUFFER,
					this._pointsToTypeArray([t, e]),
					i.STATIC_DRAW
				),
				i.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					i.FLOAT,
					!1,
					0,
					0
				),
				i.drawArrays(i.LINES, 0, 2),
				i.deleteBuffer(n),
				cc.incrementGLDraws(1);
		},
		drawRect: function (t, e) {
			this.drawLine(cc.p(t.x, t.y), cc.p(e.x, t.y)),
				this.drawLine(cc.p(e.x, t.y), cc.p(e.x, e.y)),
				this.drawLine(cc.p(e.x, e.y), cc.p(t.x, e.y)),
				this.drawLine(cc.p(t.x, e.y), cc.p(t.x, t.y));
		},
		drawSolidRect: function (t, e, i) {
			e = [t, cc.p(e.x, t.y), e, cc.p(t.x, e.y)];
			this.drawSolidPoly(e, 4, i);
		},
		drawPoly: function (t, e, i) {
			this.lazy_init();
			var n = this._renderContext;
			this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				);
			var r = n.createBuffer();
			n.bindBuffer(n.ARRAY_BUFFER, r),
				n.bufferData(
					n.ARRAY_BUFFER,
					this._pointsToTypeArray(t),
					n.STATIC_DRAW
				),
				n.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					n.FLOAT,
					!1,
					0,
					0
				),
				i
					? n.drawArrays(n.LINE_LOOP, 0, t.length)
					: n.drawArrays(n.LINE_STRIP, 0, t.length),
				n.deleteBuffer(r),
				cc.incrementGLDraws(1);
		},
		drawSolidPoly: function (t, e, i) {
			this.lazy_init(), i && this.setDrawColor(i.r, i.g, i.b, i.a);
			var n = this._renderContext;
			this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				);
			i = n.createBuffer();
			n.bindBuffer(n.ARRAY_BUFFER, i),
				n.bufferData(
					n.ARRAY_BUFFER,
					this._pointsToTypeArray(t),
					n.STATIC_DRAW
				),
				n.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					n.FLOAT,
					!1,
					0,
					0
				),
				n.drawArrays(n.TRIANGLE_FAN, 0, t.length),
				n.deleteBuffer(i),
				cc.incrementGLDraws(1);
		},
		drawCircle: function (t, e, i, n, r) {
			this.lazy_init();
			var o = 1;
			r && o++;
			var s = (2 * Math.PI) / n,
				c = new Float32Array(2 * (n + 2));
			if (c) {
				for (var a = 0; a <= n; a++) {
					var l = a * s,
						h = e * Math.cos(l + i) + t.x,
						l = e * Math.sin(l + i) + t.y;
					(c[2 * a] = h), (c[2 * a + 1] = l);
				}
				(c[2 * (n + 1)] = t.x), (c[2 * (n + 1) + 1] = t.y);
				var u = this._renderContext;
				this._shader.use(),
					this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
					u.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
					this._shader.setUniformLocationWith4fv(
						this._colorLocation,
						this._colorArray
					);
				r = u.createBuffer();
				u.bindBuffer(u.ARRAY_BUFFER, r),
					u.bufferData(u.ARRAY_BUFFER, c, u.STATIC_DRAW),
					u.vertexAttribPointer(
						cc.VERTEX_ATTRIB_POSITION,
						2,
						u.FLOAT,
						!1,
						0,
						0
					),
					u.drawArrays(u.LINE_STRIP, 0, n + o),
					u.deleteBuffer(r),
					cc.incrementGLDraws(1);
			}
		},
		drawQuadBezier: function (t, e, i, n) {
			this.lazy_init();
			for (
				var r = new Float32Array(2 * (n + 1)), o = 0, s = 0;
				s < n;
				s++
			)
				(r[2 * s] =
					Math.pow(1 - o, 2) * t.x +
					2 * (1 - o) * o * e.x +
					o * o * i.x),
					(r[2 * s + 1] =
						Math.pow(1 - o, 2) * t.y +
						2 * (1 - o) * o * e.y +
						o * o * i.y),
					(o += 1 / n);
			(r[2 * n] = i.x), (r[2 * n + 1] = i.y);
			var c = this._renderContext;
			this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				c.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				);
			var a = c.createBuffer();
			c.bindBuffer(c.ARRAY_BUFFER, a),
				c.bufferData(c.ARRAY_BUFFER, r, c.STATIC_DRAW),
				c.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					c.FLOAT,
					!1,
					0,
					0
				),
				c.drawArrays(c.LINE_STRIP, 0, n + 1),
				c.deleteBuffer(a),
				cc.incrementGLDraws(1);
		},
		drawCubicBezier: function (t, e, i, n, r) {
			this.lazy_init();
			for (
				var o = new Float32Array(2 * (r + 1)), s = 0, c = 0;
				c < r;
				c++
			)
				(o[2 * c] =
					Math.pow(1 - s, 3) * t.x +
					3 * Math.pow(1 - s, 2) * s * e.x +
					3 * (1 - s) * s * s * i.x +
					s * s * s * n.x),
					(o[2 * c + 1] =
						Math.pow(1 - s, 3) * t.y +
						3 * Math.pow(1 - s, 2) * s * e.y +
						3 * (1 - s) * s * s * i.y +
						s * s * s * n.y),
					(s += 1 / r);
			(o[2 * r] = n.x), (o[2 * r + 1] = n.y);
			var a = this._renderContext;
			this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				);
			var l = a.createBuffer();
			a.bindBuffer(a.ARRAY_BUFFER, l),
				a.bufferData(a.ARRAY_BUFFER, o, a.STATIC_DRAW),
				a.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					a.FLOAT,
					!1,
					0,
					0
				),
				a.drawArrays(a.LINE_STRIP, 0, r + 1),
				a.deleteBuffer(l),
				cc.incrementGLDraws(1);
		},
		drawCatmullRom: function (t, e) {
			this.drawCardinalSpline(t, 0.5, e);
		},
		drawCardinalSpline: function (t, e, i) {
			this.lazy_init();
			for (
				var n,
					r = new Float32Array(2 * (i + 1)),
					o = 1 / t.length,
					s = 0;
				s < i + 1;
				s++
			) {
				var c = s / i,
					c =
						1 == c
							? ((n = t.length - 1), 1)
							: (c - o * (n = 0 | (c / o))) / o,
					c = cc.cardinalSplineAt(
						cc.getControlPointAt(t, n - 1),
						cc.getControlPointAt(t, n),
						cc.getControlPointAt(t, n + 1),
						cc.getControlPointAt(t, n + 2),
						e,
						c
					);
				(r[2 * s] = c.x), (r[2 * s + 1] = c.y);
			}
			var a = this._renderContext;
			this._shader.use(),
				this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),
				a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				this._shader.setUniformLocationWith4fv(
					this._colorLocation,
					this._colorArray
				);
			var l = a.createBuffer();
			a.bindBuffer(a.ARRAY_BUFFER, l),
				a.bufferData(a.ARRAY_BUFFER, r, a.STATIC_DRAW),
				a.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					a.FLOAT,
					!1,
					0,
					0
				),
				a.drawArrays(a.LINE_STRIP, 0, i + 1),
				a.deleteBuffer(l),
				cc.incrementGLDraws(1);
		},
		setDrawColor: function (t, e, i, n) {
			(this._colorArray[0] = t / 255),
				(this._colorArray[1] = e / 255),
				(this._colorArray[2] = i / 255),
				(this._colorArray[3] = n / 255);
		},
		setPointSize: function (t) {
			this._pointSize = t * cc.contentScaleFactor();
		},
		setLineWidth: function (t) {
			this._renderContext.lineWidth && this._renderContext.lineWidth(t);
		},
	}));
var _p = cc.inputManager;
(_p.setAccelerometerEnabled = function (t) {
	this._accelEnabled !== t &&
		((this._accelEnabled = t),
		(t = cc.director.getScheduler()),
		this._accelEnabled,
		(this._accelCurTime = 0),
		t.scheduleUpdate(this));
}),
	(_p.setAccelerometerInterval = function (t) {
		this._accelInterval !== t && (this._accelInterval = t);
	}),
	(_p._registerKeyboardEvent = function () {
		cc._canvas.addEventListener(
			'keydown',
			function (t) {
				cc.eventManager.dispatchEvent(
					new cc.EventKeyboard(t.keyCode, !0)
				),
					t.stopPropagation(),
					t.preventDefault();
			},
			!1
		),
			cc._canvas.addEventListener(
				'keyup',
				function (t) {
					cc.eventManager.dispatchEvent(
						new cc.EventKeyboard(t.keyCode, !1)
					),
						t.stopPropagation(),
						t.preventDefault();
				},
				!1
			);
	}),
	(_p._registerAccelerometerEvent = function () {
		var t = window;
		(this._acceleration = new cc.Acceleration()),
			(this._accelDeviceEvent =
				t.DeviceMotionEvent || t.DeviceOrientationEvent),
			cc.sys.browserType === cc.sys.BROWSER_TYPE_MOBILE_QQ &&
				(this._accelDeviceEvent = window.DeviceOrientationEvent);
		var e =
				this._accelDeviceEvent === t.DeviceMotionEvent
					? 'devicemotion'
					: 'deviceorientation',
			i = navigator.userAgent;
		(/Android/.test(i) ||
			(/Adr/.test(i) && cc.sys.browserType === cc.BROWSER_TYPE_UC)) &&
			(this._minus = -1),
			t.addEventListener(e, this.didAccelerate.bind(this), !1);
	}),
	(_p.didAccelerate = function (t) {
		var e,
			i,
			n,
			r,
			o = window;
		this._accelEnabled &&
			((e = this._acceleration),
			(r =
				this._accelDeviceEvent === window.DeviceMotionEvent
					? ((r = t.accelerationIncludingGravity),
					  (i = this._accelMinus * r.x * 0.1),
					  (n = this._accelMinus * r.y * 0.1),
					  0.1 * r.z)
					: ((i = (t.gamma / 90) * 0.981),
					  (n = (-t.beta / 90) * 0.981),
					  (t.alpha / 90) * 0.981)),
			(e.x = i),
			(e.y = n),
			(e.z = r),
			(e.timestamp = t.timeStamp || Date.now()),
			(t = e.x),
			o.orientation === cc.UIInterfaceOrientationLandscapeRight
				? ((e.x = -e.y), (e.y = t))
				: o.orientation === cc.UIInterfaceOrientationLandscapeLeft
				? ((e.x = e.y), (e.y = -t))
				: o.orientation ===
						cc.UIInterfaceOrientationPortraitUpsideDown &&
				  ((e.x = -e.x), (e.y = -e.y)));
	}),
	delete _p,
	(cc.vertexLineToPolygon = function (t, e, i, n, r) {
		if (!((r += n) <= 1)) {
			var o;
			e *= 0.5;
			for (var s = r - 1, c = n; c < r; c++) {
				o = 2 * c;
				var a,
					l,
					h,
					u,
					_,
					d = cc.p(t[2 * c], t[2 * c + 1]);
				(_ =
					0 === c
						? cc.pPerp(
								cc.pNormalize(
									cc.pSub(
										d,
										cc.p(t[2 * (c + 1)], t[2 * (c + 1) + 1])
									)
								)
						  )
						: c === s
						? cc.pPerp(
								cc.pNormalize(
									cc.pSub(
										cc.p(
											t[2 * (c - 1)],
											t[2 * (c - 1) + 1]
										),
										d
									)
								)
						  )
						: ((_ = cc.p(t[2 * (c - 1)], t[2 * (c - 1) + 1])),
						  (a = cc.p(t[2 * (c + 1)], t[2 * (c + 1) + 1])),
						  (l = cc.pNormalize(cc.pSub(a, d))),
						  (h = cc.pNormalize(cc.pSub(_, d))),
						  (u = Math.acos(cc.pDot(l, h))) <
						  cc.degreesToRadians(70)
								? cc.pPerp(cc.pNormalize(cc.pMidpoint(l, h)))
								: u < cc.degreesToRadians(170)
								? cc.pNormalize(cc.pMidpoint(l, h))
								: cc.pPerp(cc.pNormalize(cc.pSub(a, _))))),
					(_ = cc.pMult(_, e)),
					(i[2 * o] = d.x + _.x),
					(i[2 * o + 1] = d.y + _.y),
					(i[2 * (o + 1)] = d.x - _.x),
					(i[2 * (o + 1) + 1] = d.y - _.y);
			}
			for (c = n = 0 === n ? 0 : n - 1; c < s; c++) {
				var p = (o = 2 * c) + 2,
					f = cc.vertex2(i[2 * o], i[2 * o + 1]),
					m = cc.vertex2(i[2 * (o + 1)], i[2 * (o + 1) + 1]),
					g = cc.vertex2(i[2 * p], i[2 * p]),
					y = cc.vertex2(i[2 * (p + 1)], i[2 * (p + 1) + 1]),
					m = !cc.vertexLineIntersect(
						f.x,
						f.y,
						y.x,
						y.y,
						m.x,
						m.y,
						g.x,
						g.y
					);
				m.isSuccess ||
					((m.value < 0 || 1 < m.value) && (m.isSuccess = !0)),
					m.isSuccess &&
						((i[2 * p] = y.x),
						(i[2 * p + 1] = y.y),
						(i[2 * (p + 1)] = g.x),
						(i[2 * (p + 1) + 1] = g.y));
			}
		}
	}),
	(cc.vertexLineIntersect = function (t, e, i, n, r, o, s, c) {
		return (t === i && e === n) || (r === s && o === c)
			? { isSuccess: !1, value: 0 }
			: ((n -= e),
			  (o -= e),
			  (s -= t),
			  (c -= e),
			  (n =
					(r -= t) * (t = (i -= t) / (e = Math.sqrt(i * i + n * n))) +
					o * (i = n / e)),
			  (o = o * t - r * i),
			  (r = n),
			  (n = s * t + c * i),
			  o === (c = c * t - s * i)
					? { isSuccess: !1, value: 0 }
					: {
							isSuccess: !0,
							value: ((s = n) + ((r - s) * c) / (c - o)) / e,
					  });
	}),
	(cc.vertexListIsClockwise = function (t) {
		for (var e = 0, i = t.length; e < i; e++) {
			var n = t[e],
				r = t[(e + 1) % i],
				o = t[(e + 2) % i];
			if (0 < cc.pCross(cc.pSub(r, n), cc.pSub(o, r))) return !1;
		}
		return !0;
	}),
	(cc.CGAffineToGL = function (t, e) {
		(e[2] = e[3] = e[6] = e[7] = e[8] = e[9] = e[11] = e[14] = 0),
			(e[10] = e[15] = 1),
			(e[0] = t.a),
			(e[4] = t.c),
			(e[12] = t.tx),
			(e[1] = t.b),
			(e[5] = t.d),
			(e[13] = t.ty);
	}),
	(cc.GLToCGAffine = function (t, e) {
		(e.a = t[0]),
			(e.c = t[4]),
			(e.tx = t[12]),
			(e.b = t[1]),
			(e.d = t[5]),
			(e.ty = t[13]);
	}),
	(cc.EventAcceleration = cc.Event.extend({
		_acc: null,
		ctor: function (t) {
			cc.Event.prototype.ctor.call(this, cc.Event.ACCELERATION),
				(this._acc = t);
		},
	})),
	(cc.EventKeyboard = cc.Event.extend({
		_keyCode: 0,
		_isPressed: !1,
		ctor: function (t, e) {
			cc.Event.prototype.ctor.call(this, cc.Event.KEYBOARD),
				(this._keyCode = t),
				(this._isPressed = e);
		},
	})),
	(cc._EventListenerAcceleration = cc.EventListener.extend({
		_onAccelerationEvent: null,
		ctor: function (t) {
			this._onAccelerationEvent = t;
			var e = this;
			cc.EventListener.prototype.ctor.call(
				this,
				cc.EventListener.ACCELERATION,
				cc._EventListenerAcceleration.LISTENER_ID,
				function (t) {
					e._onAccelerationEvent(t._acc, t);
				}
			);
		},
		checkAvailable: function () {
			return (
				cc.assert(
					this._onAccelerationEvent,
					cc._LogInfos._EventListenerAcceleration_checkAvailable
				),
				!0
			);
		},
		clone: function () {
			return new cc._EventListenerAcceleration(this._onAccelerationEvent);
		},
	})),
	(cc._EventListenerAcceleration.LISTENER_ID = '__cc_acceleration'),
	(cc._EventListenerAcceleration.create = function (t) {
		return new cc._EventListenerAcceleration(t);
	}),
	(cc._EventListenerKeyboard = cc.EventListener.extend({
		onKeyPressed: null,
		onKeyReleased: null,
		ctor: function () {
			var e = this;
			cc.EventListener.prototype.ctor.call(
				this,
				cc.EventListener.KEYBOARD,
				cc._EventListenerKeyboard.LISTENER_ID,
				function (t) {
					t._isPressed
						? e.onKeyPressed && e.onKeyPressed(t._keyCode, t)
						: e.onKeyReleased && e.onKeyReleased(t._keyCode, t);
				}
			);
		},
		clone: function () {
			var t = new cc._EventListenerKeyboard();
			return (
				(t.onKeyPressed = this.onKeyPressed),
				(t.onKeyReleased = this.onKeyReleased),
				t
			);
		},
		checkAvailable: function () {
			return (
				null !== this.onKeyPressed ||
				null !== this.onKeyReleased ||
				(cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable), !1)
			);
		},
	})),
	(cc._EventListenerKeyboard.LISTENER_ID = '__cc_keyboard'),
	(cc._EventListenerKeyboard.create = function () {
		return new cc._EventListenerKeyboard();
	}),
	(cc.AtlasNode = cc.Node.extend({
		textureAtlas: null,
		quadsToDraw: 0,
		_itemsPerRow: 0,
		_itemsPerColumn: 0,
		_itemWidth: 0,
		_itemHeight: 0,
		_opacityModifyRGB: !1,
		_blendFunc: null,
		_ignoreContentScaleFactor: !1,
		_className: 'AtlasNode',
		_texture: null,
		_textureForCanvas: null,
		ctor: function (t, e, i, n) {
			cc.Node.prototype.ctor.call(this),
				(this._blendFunc = { src: cc.BLEND_SRC, dst: cc.BLEND_DST }),
				(this._ignoreContentScaleFactor = !1),
				void 0 !== n && this.initWithTileFile(t, e, i, n);
		},
		_createRenderCmd: function () {
			cc._renderType === cc.game.RENDER_TYPE_CANVAS
				? (this._renderCmd = new cc.AtlasNode.CanvasRenderCmd(this))
				: (this._renderCmd = new cc.AtlasNode.WebGLRenderCmd(this));
		},
		updateAtlasValues: function () {
			cc.log(cc._LogInfos.AtlasNode_updateAtlasValues);
		},
		getColor: function () {
			return this._opacityModifyRGB
				? this._renderCmd._colorUnmodified
				: cc.Node.prototype.getColor.call(this);
		},
		setOpacityModifyRGB: function (t) {
			var e = this.color;
			(this._opacityModifyRGB = t), this.setColor(e);
		},
		isOpacityModifyRGB: function () {
			return this._opacityModifyRGB;
		},
		getBlendFunc: function () {
			return this._blendFunc;
		},
		setBlendFunc: function (t, e) {
			this._blendFunc = void 0 === e ? t : { src: t, dst: e };
		},
		setTextureAtlas: function (t) {
			this.textureAtlas = t;
		},
		getTextureAtlas: function () {
			return this.textureAtlas;
		},
		getQuadsToDraw: function () {
			return this.quadsToDraw;
		},
		setQuadsToDraw: function (t) {
			this.quadsToDraw = t;
		},
		initWithTileFile: function (t, e, i, n) {
			if (!t)
				throw new Error(
					'cc.AtlasNode.initWithTileFile(): title should not be null'
				);
			t = cc.textureCache.addImage(t);
			return this.initWithTexture(t, e, i, n);
		},
		initWithTexture: function (t, e, i, n) {
			return this._renderCmd.initWithTexture(t, e, i, n);
		},
		setColor: function (t) {
			this._renderCmd.setColor(t);
		},
		setOpacity: function (t) {
			this._renderCmd.setOpacity(t);
		},
		getTexture: function () {
			return this._texture;
		},
		setTexture: function (t) {
			this._texture = t;
		},
		_setIgnoreContentScaleFactor: function (t) {
			this._ignoreContentScaleFactor = t;
		},
	}));
var _p = cc.AtlasNode.prototype;
cc.defineGetterSetter(_p, 'opacity', _p.getOpacity, _p.setOpacity),
	cc.defineGetterSetter(_p, 'color', _p.getColor, _p.setColor),
	_p.texture,
	cc.defineGetterSetter(_p, 'texture', _p.getTexture, _p.setTexture),
	_p.textureAtlas,
	_p.quadsToDraw,
	cc.EventHelper.prototype.apply(_p),
	(cc.AtlasNode.create = function (t, e, i, n) {
		return new cc.AtlasNode(t, e, i, n);
	}),
	(function () {
		cc.AtlasNode.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._needDraw = !1),
				(this._colorUnmodified = cc.color.WHITE),
				(this._textureToRender = null);
		};
		var t = (cc.AtlasNode.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.AtlasNode.CanvasRenderCmd),
			(t.initWithTexture = function (t, e, i, n) {
				var r = this._node;
				return (
					(r._itemWidth = e),
					(r._itemHeight = i),
					(r._opacityModifyRGB = !0),
					(r._texture = t),
					r._texture
						? ((this._textureToRender = t),
						  this._calculateMaxItems(),
						  (r.quadsToDraw = n),
						  !0)
						: (cc.log(cc._LogInfos.AtlasNode__initWithTexture), !1)
				);
			}),
			(t.setColor = function (t) {
				var e = this._node._realColor;
				(e.r === t.r && e.g === t.g && e.b === t.b) ||
					((this._colorUnmodified = t), this._changeTextureColor());
			}),
			(t._changeTextureColor = function () {
				var t = this._node._texture,
					e = this._colorUnmodified,
					i = t.getHtmlElementObj(),
					i = cc.rect(0, 0, i.width, i.height);
				t === this._textureToRender
					? (this._textureToRender = t._generateColorTexture(
							e.r,
							e.g,
							e.b,
							i
					  ))
					: t._generateColorTexture(
							e.r,
							e.g,
							e.b,
							i,
							this._textureToRender.getHtmlElementObj()
					  );
			}),
			(t.setOpacity = function (t) {
				var e = this._node;
				cc.Node.prototype.setOpacity.call(e, t);
			}),
			(t._calculateMaxItems = function () {
				var t = this._node,
					e = t._texture.getContentSize();
				(t._itemsPerColumn = 0 | (e.height / t._itemHeight)),
					(t._itemsPerRow = 0 | (e.width / t._itemWidth));
			});
	})(),
	(cc.TextureAtlas = cc.Class.extend({
		dirty: !1,
		texture: null,
		_indices: null,
		_buffersVBO: null,
		_capacity: 0,
		_quads: null,
		_quadsArrayBuffer: null,
		_quadsWebBuffer: null,
		_quadsReader: null,
		ctor: function (t, e) {
			(this._buffersVBO = []),
				cc.isString(t)
					? this.initWithFile(t, e)
					: t instanceof cc.Texture2D && this.initWithTexture(t, e);
		},
		getTotalQuads: function () {
			return this._totalQuads;
		},
		getCapacity: function () {
			return this._capacity;
		},
		getTexture: function () {
			return this.texture;
		},
		setTexture: function (t) {
			this.texture = t;
		},
		setDirty: function (t) {
			this.dirty = t;
		},
		isDirty: function () {
			return this.dirty;
		},
		getQuads: function () {
			return this._quads;
		},
		setQuads: function (t) {
			this._quads = t;
		},
		_copyQuadsToTextureAtlas: function (t, e) {
			if (t)
				for (var i = 0; i < t.length; i++)
					this._setQuadToArray(t[i], e + i);
		},
		_setQuadToArray: function (t, e) {
			var i = this._quads;
			i[e]
				? ((i[e].bl = t.bl),
				  (i[e].br = t.br),
				  (i[e].tl = t.tl),
				  (i[e].tr = t.tr))
				: (i[e] = new cc.V3F_C4B_T2F_Quad(
						t.tl,
						t.bl,
						t.tr,
						t.br,
						this._quadsArrayBuffer,
						e * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT
				  ));
		},
		description: function () {
			return '<cc.TextureAtlas | totalQuads =' + this._totalQuads + '>';
		},
		_setupIndices: function () {
			if (0 !== this._capacity)
				for (
					var t = this._indices, e = this._capacity, i = 0;
					i < e;
					i++
				)
					cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP
						? ((t[6 * i + 0] = 4 * i + 0),
						  (t[6 * i + 1] = 4 * i + 0),
						  (t[6 * i + 2] = 4 * i + 2),
						  (t[6 * i + 3] = 4 * i + 1),
						  (t[6 * i + 4] = 4 * i + 3),
						  (t[6 * i + 5] = 4 * i + 3))
						: ((t[6 * i + 0] = 4 * i + 0),
						  (t[6 * i + 1] = 4 * i + 1),
						  (t[6 * i + 2] = 4 * i + 2),
						  (t[6 * i + 3] = 4 * i + 3),
						  (t[6 * i + 4] = 4 * i + 2),
						  (t[6 * i + 5] = 4 * i + 1));
		},
		_setupVBO: function () {
			var t = cc._renderContext;
			(this._buffersVBO[0] = t.createBuffer()),
				(this._buffersVBO[1] = t.createBuffer()),
				(this._quadsWebBuffer = t.createBuffer()),
				this._mapBuffers();
		},
		_mapBuffers: function () {
			var t = cc._renderContext;
			t.bindBuffer(t.ARRAY_BUFFER, this._quadsWebBuffer),
				t.bufferData(
					t.ARRAY_BUFFER,
					this._quadsArrayBuffer,
					t.DYNAMIC_DRAW
				),
				t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this._buffersVBO[1]),
				t.bufferData(
					t.ELEMENT_ARRAY_BUFFER,
					this._indices,
					t.STATIC_DRAW
				);
		},
		initWithFile: function (t, e) {
			var i = cc.textureCache.addImage(t);
			return i
				? this.initWithTexture(i, e)
				: (cc.log(cc._LogInfos.TextureAtlas_initWithFile, t), !1);
		},
		initWithTexture: function (t, e) {
			cc.assert(t, cc._LogInfos.TextureAtlas_initWithTexture),
				(e |= 0),
				(this._capacity = e),
				(this._totalQuads = 0),
				(this.texture = t),
				(this._quads = []),
				(this._indices = new Uint16Array(6 * e));
			var i = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
			if (
				((this._quadsArrayBuffer = new ArrayBuffer(i * e)),
				(this._quadsReader = new Uint8Array(this._quadsArrayBuffer)),
				(!this._quads || !this._indices) && 0 < e)
			)
				return !1;
			for (var n = this._quads, r = 0; r < e; r++)
				n[r] = new cc.V3F_C4B_T2F_Quad(
					null,
					null,
					null,
					null,
					this._quadsArrayBuffer,
					r * i
				);
			return this._setupIndices(), this._setupVBO(), (this.dirty = !0);
		},
		updateQuad: function (t, e) {
			cc.assert(t, cc._LogInfos.TextureAtlas_updateQuad),
				cc.assert(
					0 <= e && e < this._capacity,
					cc._LogInfos.TextureAtlas_updateQuad_2
				),
				(this._totalQuads = Math.max(e + 1, this._totalQuads)),
				this._setQuadToArray(t, e),
				(this.dirty = !0);
		},
		insertQuad: function (t, e) {
			var i, n, r;
			cc.assert(
				e < this._capacity,
				cc._LogInfos.TextureAtlas_insertQuad_2
			),
				this._totalQuads++,
				this._totalQuads > this._capacity
					? cc.log(cc._LogInfos.TextureAtlas_insertQuad)
					: ((n = e * (i = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)),
					  (r = (this._totalQuads - 1 - e) * i),
					  (this._quads[this._totalQuads - 1] =
							new cc.V3F_C4B_T2F_Quad(
								null,
								null,
								null,
								null,
								this._quadsArrayBuffer,
								(this._totalQuads - 1) * i
							)),
					  this._quadsReader.set(
							this._quadsReader.subarray(n, n + r),
							n + i
					  ),
					  this._setQuadToArray(t, e),
					  (this.dirty = !0));
		},
		insertQuads: function (t, e, i) {
			(i = i || t.length),
				cc.assert(
					e + i <= this._capacity,
					cc._LogInfos.TextureAtlas_insertQuads
				);
			var n = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
			if (((this._totalQuads += i), this._totalQuads > this._capacity))
				cc.log(cc._LogInfos.TextureAtlas_insertQuad);
			else {
				for (
					var r = e * n,
						o = (this._totalQuads - 1 - e - i) * n,
						s = this._totalQuads - 1 - i,
						c = 0;
					c < i;
					c++
				)
					this._quads[s + c] = new cc.V3F_C4B_T2F_Quad(
						null,
						null,
						null,
						null,
						this._quadsArrayBuffer,
						(this._totalQuads - 1) * n
					);
				for (
					this._quadsReader.set(
						this._quadsReader.subarray(r, r + o),
						r + n * i
					),
						c = 0;
					c < i;
					c++
				)
					this._setQuadToArray(t[c], e + c);
				this.dirty = !0;
			}
		},
		insertQuadFromIndex: function (t, e) {
			var i, n, r, o, s;
			t !== e &&
				(cc.assert(
					0 <= e || e < this._totalQuads,
					cc._LogInfos.TextureAtlas_insertQuadFromIndex
				),
				cc.assert(
					0 <= t || t < this._totalQuads,
					cc._LogInfos.TextureAtlas_insertQuadFromIndex_2
				),
				(i = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),
				(r = (n = this._quadsReader).subarray(t * i, i)),
				e < t
					? ((o = e * i),
					  (s = (t - e) * i),
					  n.set(n.subarray(o, o + s), o + i),
					  n.set(r, o))
					: ((o = (t + 1) * i),
					  (s = (e - t) * i),
					  n.set(n.subarray(o, o + s), o - i),
					  n.set(r, e * i)),
				(this.dirty = !0));
		},
		removeQuadAtIndex: function (t) {
			cc.assert(
				t < this._totalQuads,
				cc._LogInfos.TextureAtlas_removeQuadAtIndex
			);
			var e,
				i = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
			this._totalQuads--,
				(this._quads.length = this._totalQuads),
				t !== this._totalQuads &&
					((e = (t + 1) * i),
					(t = (this._totalQuads - t) * i),
					this._quadsReader.set(
						this._quadsReader.subarray(e, e + t),
						e - i
					)),
				(this.dirty = !0);
		},
		removeQuadsAtIndex: function (t, e) {
			var i, n;
			cc.assert(
				t + e <= this._totalQuads,
				cc._LogInfos.TextureAtlas_removeQuadsAtIndex
			),
				(this._totalQuads -= e),
				t !== this._totalQuads &&
					((i =
						(t + e) * (n = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)),
					(e = (this._totalQuads - t) * n),
					(n = t * n),
					this._quadsReader.set(
						this._quadsReader.subarray(i, i + e),
						n
					)),
				(this.dirty = !0);
		},
		removeAllQuads: function () {
			(this._quads.length = 0), (this._totalQuads = 0);
		},
		_setDirty: function (t) {
			this.dirty = t;
		},
		resizeCapacity: function (t) {
			if (t === this._capacity) return !0;
			var e = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
				i = this._capacity;
			(this._totalQuads = Math.min(this._totalQuads, t)),
				(this._capacity = 0 | t);
			var n = this._capacity,
				r = this._totalQuads;
			if (null === this._quads)
				for (
					this._quads = [],
						this._quadsArrayBuffer = new ArrayBuffer(e * n),
						this._quadsReader = new Uint8Array(
							this._quadsArrayBuffer
						),
						l = 0;
					l < n;
					l++
				)
					this._quads = new cc.V3F_C4B_T2F_Quad(
						null,
						null,
						null,
						null,
						this._quadsArrayBuffer,
						l * e
					);
			else {
				var o = this._quads;
				if (i < n) {
					for (c = [], a = new ArrayBuffer(e * n), l = 0; l < r; l++)
						c[l] = new cc.V3F_C4B_T2F_Quad(
							o[l].tl,
							o[l].bl,
							o[l].tr,
							o[l].br,
							a,
							l * e
						);
					for (; l < n; l++)
						c[l] = new cc.V3F_C4B_T2F_Quad(
							null,
							null,
							null,
							null,
							a,
							l * e
						);
					(this._quadsReader = new Uint8Array(a)),
						(this._quads = c),
						(this._quadsArrayBuffer = a);
				} else {
					for (
						var s = Math.max(r, n),
							c = [],
							a = new ArrayBuffer(e * n),
							l = 0;
						l < s;
						l++
					)
						c[l] = new cc.V3F_C4B_T2F_Quad(
							o[l].tl,
							o[l].bl,
							o[l].tr,
							o[l].br,
							a,
							l * e
						);
					(this._quadsReader = new Uint8Array(a)),
						(this._quads = c),
						(this._quadsArrayBuffer = a);
				}
			}
			return (
				null === this._indices
					? (this._indices = new Uint16Array(6 * n))
					: i < n
					? ((i = new Uint16Array(6 * n)).set(this._indices, 0),
					  (this._indices = i))
					: (this._indices = this._indices.subarray(0, 6 * n)),
				this._setupIndices(),
				this._mapBuffers(),
				(this.dirty = !0)
			);
		},
		increaseTotalQuadsWith: function (t) {
			this._totalQuads += t;
		},
		moveQuadsFromIndex: function (t, e, i) {
			if (void 0 === i) {
				if (
					((i = e),
					(e = this._totalQuads - t),
					cc.assert(
						i + (this._totalQuads - t) <= this._capacity,
						cc._LogInfos.TextureAtlas_moveQuadsFromIndex
					),
					0 === e)
				)
					return;
			} else if (
				(cc.assert(
					i + e <= this._totalQuads,
					cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2
				),
				cc.assert(
					t < this._totalQuads,
					cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3
				),
				t === i)
			)
				return;
			var n,
				r,
				o = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
				s = t * o,
				c = e * o,
				a = this._quadsReader,
				l = a.subarray(s, s + c),
				h = i * o;
			i < t
				? ((n = (t - i) * o),
				  (r = i * o),
				  a.set(a.subarray(r, r + n), r + c))
				: ((n = (i - t) * o),
				  (r = (t + e) * o),
				  a.set(a.subarray(r, r + n), s)),
				a.set(l, h),
				(this.dirty = !0);
		},
		fillWithEmptyQuadsFromIndex: function (t, e) {
			for (
				var i = e * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
					n = new Uint8Array(
						this._quadsArrayBuffer,
						t * cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
						i
					),
					r = 0;
				r < i;
				r++
			)
				n[r] = 0;
		},
		drawQuads: function () {
			this.drawNumberOfQuads(this._totalQuads, 0);
		},
		_releaseBuffer: function () {
			var t = cc._renderContext;
			this._buffersVBO &&
				(this._buffersVBO[0] && t.deleteBuffer(this._buffersVBO[0]),
				this._buffersVBO[1] && t.deleteBuffer(this._buffersVBO[1])),
				this._quadsWebBuffer && t.deleteBuffer(this._quadsWebBuffer);
		},
	}));
var _p = cc.TextureAtlas.prototype;
_p.totalQuads,
	cc.defineGetterSetter(_p, 'totalQuads', _p.getTotalQuads),
	_p.capacity,
	cc.defineGetterSetter(_p, 'capacity', _p.getCapacity),
	_p.quads,
	cc.defineGetterSetter(_p, 'quads', _p.getQuads, _p.setQuads),
	(cc.TextureAtlas.create = function (t, e) {
		return new cc.TextureAtlas(t, e);
	}),
	(cc.TextureAtlas.createWithTexture = cc.TextureAtlas.create),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			(cc.assert(
				cc.isFunction(cc._tmp.WebGLTextureAtlas),
				cc._LogInfos.MissingFile,
				'TexturesWebGL.js'
			),
			cc._tmp.WebGLTextureAtlas(),
			delete cc._tmp.WebGLTextureAtlas);
	}),
	cc.assert(
		cc.isFunction(cc._tmp.PrototypeTextureAtlas),
		cc._LogInfos.MissingFile,
		'TexturesPropertyDefine.js'
	),
	cc._tmp.PrototypeTextureAtlas(),
	delete cc._tmp.PrototypeTextureAtlas,
	(cc.PI2 = 2 * Math.PI),
	(cc.DrawingPrimitiveCanvas = cc.Class.extend({
		_cacheArray: [],
		_renderContext: null,
		ctor: function (t) {
			this._renderContext = t;
		},
		drawPoint: function (t, e) {
			e = e || 1;
			var i = cc.view.getScaleX(),
				n = cc.view.getScaleY(),
				t = cc.p(t.x * i, t.y * n),
				n = this._renderContext.getContext();
			n.beginPath(),
				n.arc(t.x, -t.y, e * i, 0, 2 * Math.PI, !1),
				n.closePath(),
				n.fill();
		},
		drawPoints: function (t, e, i) {
			if (null != t) {
				i = i || 1;
				var n = this._renderContext.getContext(),
					r = cc.view.getScaleX(),
					o = cc.view.getScaleY();
				n.beginPath();
				for (var s = 0, c = t.length; s < c; s++)
					n.arc(t[s].x * r, -t[s].y * o, i * r, 0, 2 * Math.PI, !1);
				n.closePath(), n.fill();
			}
		},
		drawLine: function (t, e) {
			var i = this._renderContext.getContext();
			cc.view.getScaleX(), cc.view.getScaleY();
			i.beginPath(),
				i.moveTo(t.x, -t.y),
				i.lineTo(e.x, -e.y),
				i.closePath(),
				i.stroke();
		},
		drawRect: function (t, e) {
			this.drawLine(cc.p(t.x, t.y), cc.p(e.x, t.y)),
				this.drawLine(cc.p(e.x, t.y), cc.p(e.x, e.y)),
				this.drawLine(cc.p(e.x, e.y), cc.p(t.x, e.y)),
				this.drawLine(cc.p(t.x, e.y), cc.p(t.x, t.y));
		},
		drawSolidRect: function (t, e, i) {
			e = [t, cc.p(e.x, t.y), e, cc.p(t.x, e.y)];
			this.drawSolidPoly(e, 4, i);
		},
		drawPoly: function (t, e, i, n) {
			if (((n = n || !1), null != t)) {
				if (t.length < 3)
					throw new Error("Polygon's point must greater than 2");
				var r = t[0],
					o = this._renderContext.getContext();
				cc.view.getScaleX(), cc.view.getScaleY();
				o.beginPath(), o.moveTo(r.x, -r.y);
				for (var s = 1, c = t.length; s < c; s++)
					o.lineTo(t[s].x, -t[s].y);
				i && o.closePath(), n ? o.fill() : o.stroke();
			}
		},
		drawSolidPoly: function (t, e, i) {
			this.setDrawColor(i.r, i.g, i.b, i.a), this.drawPoly(t, e, !0, !0);
		},
		drawCircle: function (t, e, i, n, r) {
			r = r || !1;
			var o = this._renderContext.getContext();
			cc.view.getScaleX(), cc.view.getScaleY();
			o.beginPath();
			var s = i - 2 * Math.PI;
			o.arc(0 | t.x, 0 | -t.y, e, -i, -s, !1),
				r && o.lineTo(0 | t.x, 0 | -t.y),
				o.stroke();
		},
		drawQuadBezier: function (t, e, i, n) {
			for (
				var r = this._cacheArray, o = (r.length = 0), s = 0;
				s < n;
				s++
			) {
				var c =
						Math.pow(1 - o, 2) * t.x +
						2 * (1 - o) * o * e.x +
						o * o * i.x,
					a =
						Math.pow(1 - o, 2) * t.y +
						2 * (1 - o) * o * e.y +
						o * o * i.y;
				r.push(cc.p(c, a)), (o += 1 / n);
			}
			r.push(cc.p(i.x, i.y)), this.drawPoly(r, n + 1, !1, !1);
		},
		drawCubicBezier: function (t, e, i, n, r) {
			for (
				var o = this._cacheArray, s = (o.length = 0), c = 0;
				c < r;
				c++
			) {
				var a =
						Math.pow(1 - s, 3) * t.x +
						3 * Math.pow(1 - s, 2) * s * e.x +
						3 * (1 - s) * s * s * i.x +
						s * s * s * n.x,
					l =
						Math.pow(1 - s, 3) * t.y +
						3 * Math.pow(1 - s, 2) * s * e.y +
						3 * (1 - s) * s * s * i.y +
						s * s * s * n.y;
				o.push(cc.p(a, l)), (s += 1 / r);
			}
			o.push(cc.p(n.x, n.y)), this.drawPoly(o, r + 1, !1, !1);
		},
		drawCatmullRom: function (t, e) {
			this.drawCardinalSpline(t, 0.5, e);
		},
		drawCardinalSpline: function (t, e, i) {
			cc._renderContext.setStrokeStyle('rgba(255,255,255,1)');
			var n,
				r = this._cacheArray;
			r.length = 0;
			for (var o = 1 / t.length, s = 0; s < i + 1; s++) {
				var c = s / i,
					c =
						1 == c
							? ((n = t.length - 1), 1)
							: (c - o * (n = 0 | (c / o))) / o,
					c = cc.CardinalSplineAt(
						cc.getControlPointAt(t, n - 1),
						cc.getControlPointAt(t, +n),
						cc.getControlPointAt(t, n + 1),
						cc.getControlPointAt(t, n + 2),
						e,
						c
					);
				r.push(c);
			}
			this.drawPoly(r, i + 1, !1, !1);
		},
		drawImage: function (t, e, i, n, r) {
			var o = arguments.length,
				s = this._renderContext.getContext();
			switch (o) {
				case 2:
					var c = t.height;
					s.drawImage(t, e.x, -(e.y + c));
					break;
				case 3:
					s.drawImage(t, e.x, -(e.y + i.height), i.width, i.height);
					break;
				case 5:
					s.drawImage(
						t,
						e.x,
						e.y,
						i.width,
						i.height,
						n.x,
						-(n.y + r.height),
						r.width,
						r.height
					);
					break;
				default:
					throw new Error('Argument must be non-nil');
			}
		},
		drawStar: function (t, e, i) {
			var n = t || this._renderContext,
				r = n.getContext(),
				o = 'rgba(' + (0 | i.r) + ',' + (0 | i.g) + ',' + (0 | i.b);
			n.setFillStyle(o + ',1)');
			t = e / 10;
			r.beginPath(),
				r.moveTo(-e, e),
				r.lineTo(0, t),
				r.lineTo(e, e),
				r.lineTo(t, 0),
				r.lineTo(e, -e),
				r.lineTo(0, -t),
				r.lineTo(-e, -e),
				r.lineTo(-t, 0),
				r.lineTo(-e, e),
				r.closePath(),
				r.fill();
			i = r.createRadialGradient(0, 0, t, 0, 0, e);
			i.addColorStop(0, o + ', 1)'),
				i.addColorStop(0.3, o + ', 0.8)'),
				i.addColorStop(1, o + ', 0.0)'),
				n.setFillStyle(i),
				r.beginPath();
			i = cc.PI2;
			r.arc(0, 0, e - t, 0, i, !1), r.closePath(), r.fill();
		},
		drawColorBall: function (t, e, i) {
			var n = t || this._renderContext,
				r = n.getContext();
			e *= cc.view.getScaleX();
			(t = 'rgba(' + (0 | i.r) + ',' + (0 | i.g) + ',' + (0 | i.b)),
				(i = e / 10),
				(i = r.createRadialGradient(0, 0, i, 0, 0, e));
			i.addColorStop(0, t + ', 1)'),
				i.addColorStop(0.3, t + ', 0.8)'),
				i.addColorStop(0.6, t + ', 0.4)'),
				i.addColorStop(1, t + ', 0.0)'),
				n.setFillStyle(i),
				r.beginPath();
			i = cc.PI2;
			r.arc(0, 0, e, 0, i, !1), r.closePath(), r.fill();
		},
		fillText: function (t, e, i) {
			this._renderContext.getContext().fillText(t, e, -i);
		},
		setDrawColor: function (t, e, i, n) {
			this._renderContext.setFillStyle(
				'rgba(' + t + ',' + e + ',' + i + ',' + n / 255 + ')'
			),
				this._renderContext.setStrokeStyle(
					'rgba(' + t + ',' + e + ',' + i + ',' + n / 255 + ')'
				);
		},
		setPointSize: function (t) {},
		setLineWidth: function (t) {
			this._renderContext.getContext().lineWidth =
				t * cc.view.getScaleX();
		},
	})),
	(function () {
		cc.AtlasNode.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._textureAtlas = null),
				(this._colorUnmodified = cc.color.WHITE),
				(this._colorF32Array = null),
				(this._uniformColor = null),
				(this._matrix = new cc.math.Matrix4()),
				this._matrix.identity(),
				(this._shaderProgram = cc.shaderCache.programForKey(
					cc.SHADER_POSITION_TEXTURE_UCOLOR
				)),
				(this._uniformColor = cc._renderContext.getUniformLocation(
					this._shaderProgram.getProgram(),
					'u_color'
				));
		};
		var t = (cc.AtlasNode.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.AtlasNode.WebGLRenderCmd),
			(t._updateBlendFunc = function () {
				var t = this._node;
				this._textureAtlas.texture.hasPremultipliedAlpha() ||
					((t._blendFunc.src = cc.SRC_ALPHA),
					(t._blendFunc.dst = cc.ONE_MINUS_SRC_ALPHA));
			}),
			(t._updateOpacityModifyRGB = function () {
				this._node._opacityModifyRGB =
					this._textureAtlas.texture.hasPremultipliedAlpha();
			}),
			(t.rendering = function (t) {
				var e = t || cc._renderContext,
					i = this._node,
					t = this._worldTransform;
				(this._matrix.mat[0] = t.a),
					(this._matrix.mat[4] = t.c),
					(this._matrix.mat[12] = t.tx),
					(this._matrix.mat[1] = t.b),
					(this._matrix.mat[5] = t.d),
					(this._matrix.mat[13] = t.ty),
					this._shaderProgram.use(),
					this._shaderProgram._setUniformForMVPMatrixWithMat4(
						this._matrix
					),
					cc.glBlendFunc(i._blendFunc.src, i._blendFunc.dst),
					this._uniformColor &&
						this._colorF32Array &&
						(e.uniform4fv(this._uniformColor, this._colorF32Array),
						this._textureAtlas.drawNumberOfQuads(i.quadsToDraw, 0));
			}),
			(t.initWithTexture = function (t, e, i, n) {
				var r = this._node;
				(r._itemWidth = e),
					(r._itemHeight = i),
					(this._colorUnmodified = cc.color.WHITE),
					(r._opacityModifyRGB = !0),
					(r._blendFunc.src = cc.BLEND_SRC),
					(r._blendFunc.dst = cc.BLEND_DST);
				i = r._realColor;
				return (
					(this._colorF32Array = new Float32Array([
						i.r / 255,
						i.g / 255,
						i.b / 255,
						r._realOpacity / 255,
					])),
					(this._textureAtlas = new cc.TextureAtlas()),
					this._textureAtlas.initWithTexture(t, n),
					this._textureAtlas
						? (this._updateBlendFunc(),
						  this._updateOpacityModifyRGB(),
						  this._calculateMaxItems(),
						  (r.quadsToDraw = n),
						  !0)
						: (cc.log(cc._LogInfos.AtlasNode__initWithTexture), !1)
				);
			}),
			(t.setColor = function (t) {
				var e = cc.color(t.r, t.g, t.b),
					i = this._node;
				this._colorUnmodified = t;
				t = this._displayedOpacity;
				i._opacityModifyRGB &&
					((e.r = (e.r * t) / 255),
					(e.g = (e.g * t) / 255),
					(e.b = (e.b * t) / 255)),
					cc.Node.prototype.setColor.call(i, e);
			}),
			(t.setOpacity = function (t) {
				var e = this._node;
				cc.Node.prototype.setOpacity.call(e, t),
					e._opacityModifyRGB && (e.color = this._colorUnmodified);
			}),
			(t._updateColor = function () {
				var t;
				this._colorF32Array &&
					((t = this._displayedColor),
					(this._colorF32Array[0] = t.r / 255),
					(this._colorF32Array[1] = t.g / 255),
					(this._colorF32Array[2] = t.b / 255),
					(this._colorF32Array[3] = this._displayedOpacity / 255));
			}),
			(t.getTexture = function () {
				return this._textureAtlas.texture;
			}),
			(t.setTexture = function (t) {
				(this._textureAtlas.texture = t),
					this._updateBlendFunc(),
					this._updateOpacityModifyRGB();
			}),
			(t._calculateMaxItems = function () {
				var t = this._node,
					e = this._textureAtlas.texture,
					i = e.getContentSize();
				t._ignoreContentScaleFactor && (i = e.getContentSizeInPixels()),
					(t._itemsPerColumn = 0 | (i.height / t._itemHeight)),
					(t._itemsPerRow = 0 | (i.width / t._itemWidth));
			});
	})(),
	(cc._LogInfos = {
		ActionManager_addAction:
			'cc.ActionManager.addAction(): action must be non-null',
		ActionManager_removeAction: 'cocos2d: removeAction: Target not found',
		ActionManager_removeActionByTag:
			'cc.ActionManager.removeActionByTag(): an invalid tag',
		ActionManager_removeActionByTag_2:
			'cc.ActionManager.removeActionByTag(): target must be non-null',
		ActionManager_getActionByTag:
			'cc.ActionManager.getActionByTag(): an invalid tag',
		ActionManager_getActionByTag_2:
			'cocos2d : getActionByTag(tag = %s): Action not found',
		configuration_dumpInfo:
			'cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)',
		configuration_loadConfigFile:
			"Expected 'data' dict, but not found. Config file: %s",
		configuration_loadConfigFile_2: 'Please load the resource first : %s',
		Director_resume: 'cocos2d: Director: Error in gettimeofday',
		Director_setProjection: 'cocos2d: Director: unrecognized projection',
		Director_popToSceneStackLevel:
			'cocos2d: Director: unrecognized projection',
		Director_popToSceneStackLevel_2:
			'cocos2d: Director: Error in gettimeofday',
		Director_popScene: 'running scene should not null',
		Director_pushScene: 'the scene should not null',
		arrayVerifyType: 'element type is wrong!',
		Scheduler_scheduleCallbackForTarget:
			'CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s',
		Scheduler_scheduleCallbackForTarget_2:
			'cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.',
		Scheduler_scheduleCallbackForTarget_3:
			'cc.scheduler.scheduleCallbackForTarget(): target should be non-null.',
		Scheduler_pauseTarget:
			'cc.Scheduler.pauseTarget():target should be non-null',
		Scheduler_resumeTarget:
			'cc.Scheduler.resumeTarget():target should be non-null',
		Scheduler_isTargetPaused:
			'cc.Scheduler.isTargetPaused():target should be non-null',
		Node_getZOrder:
			'getZOrder is deprecated. Please use getLocalZOrder instead.',
		Node_setZOrder:
			'setZOrder is deprecated. Please use setLocalZOrder instead.',
		Node_getRotation:
			"RotationX != RotationY. Don't know which one to return",
		Node_getScale: "ScaleX != ScaleY. Don't know which one to return",
		Node_addChild: "An Node can't be added as a child of itself.",
		Node_addChild_2: "child already added. It can't be added again",
		Node_addChild_3: 'child must be non-null',
		Node_removeFromParentAndCleanup:
			'removeFromParentAndCleanup is deprecated. Use removeFromParent instead',
		Node_boundingBox:
			'boundingBox is deprecated. Use getBoundingBox instead',
		Node_removeChildByTag: 'argument tag is an invalid tag',
		Node_removeChildByTag_2:
			'cocos2d: removeChildByTag(tag = %s): child not found!',
		Node_removeAllChildrenWithCleanup:
			'removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead',
		Node_stopActionByTag:
			'cc.Node.stopActionBy(): argument tag an invalid tag',
		Node_getActionByTag:
			'cc.Node.getActionByTag(): argument tag is an invalid tag',
		Node_resumeSchedulerAndActions:
			'resumeSchedulerAndActions is deprecated, please use resume instead.',
		Node_pauseSchedulerAndActions:
			'pauseSchedulerAndActions is deprecated, please use pause instead.',
		Node__arrayMakeObjectsPerformSelector: 'Unknown callback function',
		Node_reorderChild: 'child must be non-null',
		Node_runAction: 'cc.Node.runAction(): action must be non-null',
		Node_schedule: 'callback function must be non-null',
		Node_schedule_2: 'interval must be positive',
		Node_initWithTexture:
			'cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.',
		AtlasNode_updateAtlasValues:
			'cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses',
		AtlasNode_initWithTileFile: '',
		AtlasNode__initWithTexture:
			'cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.',
		_EventListenerKeyboard_checkAvailable:
			'cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!',
		_EventListenerTouchOneByOne_checkAvailable:
			'cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!',
		_EventListenerTouchAllAtOnce_checkAvailable:
			'cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!',
		_EventListenerAcceleration_checkAvailable:
			'cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil',
		EventListener_create: 'Invalid parameter.',
		__getListenerID: "Don't call this method if the event is for touch.",
		eventManager__forceAddEventListener: 'Invalid scene graph priority!',
		eventManager_addListener:
			"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",
		eventManager_removeListeners: 'Invalid listener type!',
		eventManager_setPriority:
			"Can't set fixed priority with scene graph based listener.",
		eventManager_addListener_2: 'Invalid parameters.',
		eventManager_addListener_3:
			'listener must be a cc.EventListener object when adding a fixed priority listener',
		eventManager_addListener_4:
			"The listener has been registered, please don't register it again.",
		LayerMultiplex_initWithLayers:
			'parameters should not be ending with null in Javascript',
		LayerMultiplex_switchTo:
			'Invalid index in MultiplexLayer switchTo message',
		LayerMultiplex_switchToAndReleaseMe:
			'Invalid index in MultiplexLayer switchTo message',
		LayerMultiplex_addLayer:
			'cc.Layer.addLayer(): layer should be non-null',
		EGLView_setDesignResolutionSize: 'Resolution not valid',
		EGLView_setDesignResolutionSize_2: 'should set resolutionPolicy',
		inputManager_handleTouchesBegin:
			'The touches is more than MAX_TOUCHES, nUnusedIndex = %s',
		swap: 'cc.swap is being modified from original macro, please check usage',
		checkGLErrorDebug: 'WebGL error %s',
		animationCache__addAnimationsWithDictionary:
			'cocos2d: cc.AnimationCache: No animations were found in provided dictionary.',
		animationCache__addAnimationsWithDictionary_2:
			'cc.AnimationCache. Invalid animation format',
		animationCache_addAnimations:
			'cc.AnimationCache.addAnimations(): File could not be found',
		animationCache__parseVersion1:
			"cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",
		animationCache__parseVersion1_2:
			"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",
		animationCache__parseVersion1_3:
			"cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",
		animationCache__parseVersion1_4:
			"cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",
		animationCache__parseVersion2:
			"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",
		animationCache__parseVersion2_2:
			"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",
		animationCache_addAnimations_2:
			'cc.AnimationCache.addAnimations(): Invalid texture file name',
		Sprite_reorderChild:
			'cc.Sprite.reorderChild(): this child is not in children list',
		Sprite_ignoreAnchorPointForPosition:
			'cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode',
		Sprite_setDisplayFrameWithAnimationName:
			'cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found',
		Sprite_setDisplayFrameWithAnimationName_2:
			'cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index',
		Sprite_setDisplayFrame:
			'setDisplayFrame is deprecated, please use setSpriteFrame instead.',
		Sprite__updateBlendFunc:
			"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",
		Sprite_initWithSpriteFrame:
			'cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null',
		Sprite_initWithSpriteFrameName:
			'cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null',
		Sprite_initWithSpriteFrameName1: ' is null, please check.',
		Sprite_initWithFile:
			'cc.Sprite.initWithFile(): filename should be non-null',
		Sprite_setDisplayFrameWithAnimationName_3:
			'cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null',
		Sprite_reorderChild_2:
			'cc.Sprite.reorderChild(): child should be non-null',
		Sprite_addChild:
			'cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode',
		Sprite_addChild_2:
			'cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode',
		Sprite_addChild_3: 'cc.Sprite.addChild(): child should be non-null',
		Sprite_setTexture:
			'cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode',
		Sprite_updateQuadFromSprite:
			'cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children',
		Sprite_insertQuadFromSprite:
			'cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children',
		Sprite_addChild_4:
			'cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children',
		Sprite_addChild_5:
			'cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture',
		Sprite_initWithTexture:
			'Sprite.initWithTexture(): Argument must be non-nil ',
		Sprite_setSpriteFrame: 'Invalid spriteFrameName',
		Sprite_setTexture_2:
			'Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.',
		Sprite_updateQuadFromSprite_2:
			'cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null',
		Sprite_insertQuadFromSprite_2:
			'cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null',
		SpriteBatchNode_addSpriteWithoutQuad:
			'cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children',
		SpriteBatchNode_increaseAtlasCapacity:
			'cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.',
		SpriteBatchNode_increaseAtlasCapacity_2:
			'cocos2d: WARNING: Not enough memory to resize the atlas',
		SpriteBatchNode_reorderChild:
			"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",
		SpriteBatchNode_removeChild:
			'cc.SpriteBatchNode.addChild(): sprite batch node should contain the child',
		SpriteBatchNode_addSpriteWithoutQuad_2:
			'cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null',
		SpriteBatchNode_reorderChild_2:
			'cc.SpriteBatchNode.addChild(): child should be non-null',
		spriteFrameCache__getFrameConfig:
			"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",
		spriteFrameCache_addSpriteFrames:
			'cocos2d: WARNING: an alias with name %s already exists',
		spriteFrameCache__checkConflict:
			'cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit',
		spriteFrameCache_getSpriteFrame:
			'cocos2d: cc.SpriteFrameCahce: Frame %s not found',
		spriteFrameCache__getFrameConfig_2:
			'Please load the resource first : %s',
		spriteFrameCache_addSpriteFrames_2:
			'cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null',
		spriteFrameCache_addSpriteFrames_3: 'Argument must be non-nil',
		CCSpriteBatchNode_updateQuadFromSprite:
			'cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children',
		CCSpriteBatchNode_insertQuadFromSprite:
			'cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children',
		CCSpriteBatchNode_addChild:
			'cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children',
		CCSpriteBatchNode_initWithTexture:
			'Sprite.initWithTexture(): Argument must be non-nil ',
		CCSpriteBatchNode_addChild_2:
			'cc.Sprite.addChild(): child should be non-null',
		CCSpriteBatchNode_setSpriteFrame: 'Invalid spriteFrameName',
		CCSpriteBatchNode_setTexture:
			'Invalid argument: cc.Sprite texture setter expects a CCTexture2D.',
		CCSpriteBatchNode_updateQuadFromSprite_2:
			'cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null',
		CCSpriteBatchNode_insertQuadFromSprite_2:
			'cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null',
		CCSpriteBatchNode_addChild_3:
			'cc.SpriteBatchNode.addChild(): child should be non-null',
		TextureAtlas_initWithFile: 'cocos2d: Could not open file: %s',
		TextureAtlas_insertQuad:
			'cc.TextureAtlas.insertQuad(): invalid totalQuads',
		TextureAtlas_initWithTexture:
			'cc.TextureAtlas.initWithTexture():texture should be non-null',
		TextureAtlas_updateQuad:
			'cc.TextureAtlas.updateQuad(): quad should be non-null',
		TextureAtlas_updateQuad_2:
			'cc.TextureAtlas.updateQuad(): Invalid index',
		TextureAtlas_insertQuad_2:
			'cc.TextureAtlas.insertQuad(): Invalid index',
		TextureAtlas_insertQuads:
			'cc.TextureAtlas.insertQuad(): Invalid index + amount',
		TextureAtlas_insertQuadFromIndex:
			'cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex',
		TextureAtlas_insertQuadFromIndex_2:
			'cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex',
		TextureAtlas_removeQuadAtIndex:
			'cc.TextureAtlas.removeQuadAtIndex(): Invalid index',
		TextureAtlas_removeQuadsAtIndex:
			'cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds',
		TextureAtlas_moveQuadsFromIndex:
			'cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds',
		TextureAtlas_moveQuadsFromIndex_2:
			'cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex',
		TextureAtlas_moveQuadsFromIndex_3:
			'cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex',
		textureCache_addPVRTCImage:
			'TextureCache:addPVRTCImage does not support on HTML5',
		textureCache_addETCImage:
			'TextureCache:addPVRTCImage does not support on HTML5',
		textureCache_textureForKey:
			'textureForKey is deprecated. Please use getTextureForKey instead.',
		textureCache_addPVRImage: 'addPVRImage does not support on HTML5',
		textureCache_addUIImage:
			"cocos2d: Couldn't add UIImage in TextureCache",
		textureCache_dumpCachedTextureInfo: "cocos2d: '%s' id=%s %s x %s",
		textureCache_dumpCachedTextureInfo_2:
			"cocos2d: '%s' id= HTMLCanvasElement %s x %s",
		textureCache_dumpCachedTextureInfo_3:
			'cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)',
		textureCache_addUIImage_2:
			'cc.Texture.addUIImage(): image should be non-null',
		Texture2D_initWithETCFile: 'initWithETCFile does not support on HTML5',
		Texture2D_initWithPVRFile: 'initWithPVRFile does not support on HTML5',
		Texture2D_initWithPVRTCData:
			'initWithPVRTCData does not support on HTML5',
		Texture2D_addImage: 'cc.Texture.addImage(): path should be non-null',
		Texture2D_initWithImage:
			"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",
		Texture2D_initWithImage_2:
			'cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s',
		Texture2D_initWithString:
			"initWithString isn't supported on cocos2d-html5",
		Texture2D_initWithETCFile_2:
			'initWithETCFile does not support on HTML5',
		Texture2D_initWithPVRFile_2:
			'initWithPVRFile does not support on HTML5',
		Texture2D_initWithPVRTCData_2:
			'initWithPVRTCData does not support on HTML5',
		Texture2D_bitsPerPixelForFormat:
			"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",
		Texture2D__initPremultipliedATextureWithImage:
			'cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha',
		Texture2D_addImage_2: 'cc.Texture.addImage(): path should be non-null',
		Texture2D_initWithData: 'NSInternalInconsistencyException',
		MissingFile: 'Missing file: %s',
		radiansToDegress:
			'cc.radiansToDegress() should be called cc.radiansToDegrees()',
		RectWidth: 'Rect width exceeds maximum margin: %s',
		RectHeight: 'Rect height exceeds maximum margin: %s',
		EventManager__updateListeners:
			'If program goes here, there should be event in dispatch.',
		EventManager__updateListeners_2: '_inDispatch should be 1 here.',
	}),
	(cc._logToWebPage = function (t) {
		var e, i, n, r;
		cc._canvas &&
			((e = cc._logList),
			(r = document),
			e ||
				((n = (i = r.createElement('Div')).style),
				i.setAttribute('id', 'logInfoDiv'),
				cc._canvas.parentNode.appendChild(i),
				i.setAttribute('width', '200'),
				i.setAttribute('height', cc._canvas.height),
				(n.zIndex = '99999'),
				(n.position = 'absolute'),
				(n.top = '0'),
				(n.left = '0'),
				(r = (e = cc._logList = r.createElement('textarea')).style),
				e.setAttribute('rows', '20'),
				e.setAttribute('cols', '30'),
				e.setAttribute('disabled', !0),
				i.appendChild(e),
				(r.backgroundColor = 'transparent'),
				(r.borderBottom = '1px solid #cccccc'),
				(r.borderRightWidth = '0px'),
				(r.borderLeftWidth = '0px'),
				(r.borderTopWidth = '0px'),
				(r.borderTopStyle = 'none'),
				(r.borderRightStyle = 'none'),
				(r.borderLeftStyle = 'none'),
				(r.padding = '0px'),
				(r.margin = 0)),
			(e.value = e.value + t + '\r\n'),
			(e.scrollTop = e.scrollHeight));
	}),
	(cc._formatString = function (t) {
		if (!cc.isObject(t)) return t;
		try {
			return JSON.stringify(t);
		} catch (t) {
			return '';
		}
	}),
	(cc._initDebugSetting = function (t) {
		var n,
			e = cc.game;
		t !== e.DEBUG_MODE_NONE &&
			(t > e.DEBUG_MODE_ERROR
				? ((n = cc._logToWebPage.bind(cc)),
				  (cc.error = function () {
						n('ERROR :  ' + cc.formatStr.apply(cc, arguments));
				  }),
				  (cc.assert = function (t, e) {
						if (!t && e) {
							for (var i = 2; i < arguments.length; i++)
								e = e.replace(
									/(%s)|(%d)/,
									cc._formatString(arguments[i])
								);
							n('Assert: ' + e);
						}
				  }),
				  t !== e.DEBUG_MODE_ERROR_FOR_WEB_PAGE &&
						(cc.warn = function () {
							n('WARN :  ' + cc.formatStr.apply(cc, arguments));
						}),
				  t === e.DEBUG_MODE_INFO_FOR_WEB_PAGE &&
						(cc.log = function () {
							n(cc.formatStr.apply(cc, arguments));
						}))
				: console &&
				  console.log.apply &&
				  ((cc.error = Function.prototype.bind.call(
						console.error,
						console
				  )),
				  console.assert
						? (cc.assert = Function.prototype.bind.call(
								console.assert,
								console
						  ))
						: (cc.assert = function (t, e) {
								if (!t && e) {
									for (var i = 2; i < arguments.length; i++)
										e = e.replace(
											/(%s)|(%d)/,
											cc._formatString(arguments[i])
										);
									throw new Error(e);
								}
						  }),
				  t !== e.DEBUG_MODE_ERROR &&
						(cc.warn = Function.prototype.bind.call(
							console.warn,
							console
						)),
				  t === e.DEBUG_MODE_INFO &&
						(cc.log = Function.prototype.bind.call(
							console.log,
							console
						))));
	}),
	(cc.HashElement = cc.Class.extend({
		actions: null,
		target: null,
		actionIndex: 0,
		currentAction: null,
		currentActionSalvaged: !1,
		paused: !1,
		hh: null,
		ctor: function () {
			(this.actions = []),
				(this.target = null),
				(this.actionIndex = 0),
				(this.currentAction = null),
				(this.currentActionSalvaged = !1),
				(this.paused = !1),
				(this.hh = null);
		},
	})),
	(cc.ActionManager = cc.Class.extend({
		_hashTargets: null,
		_arrayTargets: null,
		_currentTarget: null,
		_currentTargetSalvaged: !1,
		_searchElementByTarget: function (t, e) {
			for (var i = 0; i < t.length; i++)
				if (e === t[i].target) return t[i];
			return null;
		},
		ctor: function () {
			(this._hashTargets = {}),
				(this._arrayTargets = []),
				(this._currentTarget = null),
				(this._currentTargetSalvaged = !1);
		},
		addAction: function (t, e, i) {
			if (!t)
				throw new Error(
					'cc.ActionManager.addAction(): action must be non-null'
				);
			if (!e)
				throw new Error(
					'cc.ActionManager.addAction(): action must be non-null'
				);
			var n = this._hashTargets[e.__instanceId];
			n ||
				(((n = new cc.HashElement()).paused = i),
				(n.target = e),
				(this._hashTargets[e.__instanceId] = n),
				this._arrayTargets.push(n)),
				this._actionAllocWithHashElement(n),
				n.actions.push(t),
				t.startWithTarget(e);
		},
		removeAllActions: function () {
			for (var t = this._arrayTargets, e = 0; e < t.length; e++) {
				var i = t[e];
				i && this.removeAllActionsFromTarget(i.target, !0);
			}
		},
		removeAllActionsFromTarget: function (t, e) {
			null == t ||
				((t = this._hashTargets[t.__instanceId]) &&
					(-1 === t.actions.indexOf(t.currentAction) ||
						t.currentActionSalvaged ||
						(t.currentActionSalvaged = !0),
					(t.actions.length = 0),
					this._currentTarget !== t || e
						? this._deleteHashElement(t)
						: (this._currentTargetSalvaged = !0)));
		},
		removeAction: function (t) {
			if (null != t) {
				var e = t.getOriginalTarget(),
					i = this._hashTargets[e.__instanceId];
				if (i) {
					for (var n = 0; n < i.actions.length; n++)
						if (i.actions[n] === t) {
							i.actions.splice(n, 1);
							break;
						}
				} else cc.log(cc._LogInfos.ActionManager_removeAction);
			}
		},
		removeActionByTag: function (t, e) {
			t === cc.ACTION_TAG_INVALID &&
				cc.log(cc._LogInfos.ActionManager_addAction),
				cc.assert(e, cc._LogInfos.ActionManager_addAction);
			var i = this._hashTargets[e.__instanceId];
			if (i)
				for (var n = i.actions.length, r = 0; r < n; ++r) {
					var o = i.actions[r];
					if (o && o.getTag() === t && o.getOriginalTarget() === e) {
						this._removeActionAtIndex(r, i);
						break;
					}
				}
		},
		getActionByTag: function (t, e) {
			t === cc.ACTION_TAG_INVALID &&
				cc.log(cc._LogInfos.ActionManager_getActionByTag);
			var i = this._hashTargets[e.__instanceId];
			if (i) {
				if (null != i.actions)
					for (var n = 0; n < i.actions.length; ++n) {
						var r = i.actions[n];
						if (r && r.getTag() === t) return r;
					}
				cc.log(cc._LogInfos.ActionManager_getActionByTag_2, t);
			}
			return null;
		},
		numberOfRunningActionsInTarget: function (t) {
			t = this._hashTargets[t.__instanceId];
			return t && t.actions ? t.actions.length : 0;
		},
		pauseTarget: function (t) {
			t = this._hashTargets[t.__instanceId];
			t && (t.paused = !0);
		},
		resumeTarget: function (t) {
			t = this._hashTargets[t.__instanceId];
			t && (t.paused = !1);
		},
		pauseAllRunningActions: function () {
			for (var t = [], e = this._arrayTargets, i = 0; i < e.length; i++) {
				var n = e[i];
				n && !n.paused && ((n.paused = !0), t.push(n.target));
			}
			return t;
		},
		resumeTargets: function (t) {
			if (t)
				for (var e = 0; e < t.length; e++)
					t[e] && this.resumeTarget(t[e]);
		},
		purgeSharedManager: function () {
			cc.director.getScheduler().unscheduleUpdate(this);
		},
		_removeActionAtIndex: function (t, e) {
			e.actions[t] !== e.currentAction ||
				e.currentActionSalvaged ||
				(e.currentActionSalvaged = !0),
				e.actions.splice(t, 1),
				e.actionIndex >= t && e.actionIndex--,
				0 === e.actions.length &&
					(this._currentTarget === e
						? (this._currentTargetSalvaged = !0)
						: this._deleteHashElement(e));
		},
		_deleteHashElement: function (t) {
			var e = !1;
			return (
				t &&
					(this._hashTargets[t.target.__instanceId] &&
						(delete this._hashTargets[t.target.__instanceId],
						cc.arrayRemoveObject(this._arrayTargets, t),
						(e = !0)),
					(t.actions = null),
					(t.target = null)),
				e
			);
		},
		_actionAllocWithHashElement: function (t) {
			null == t.actions && (t.actions = []);
		},
		update: function (t) {
			for (var e, i, n = this._arrayTargets, r = 0; r < n.length; r++) {
				if (
					((this._currentTarget = n[r]),
					!(e = this._currentTarget).paused)
				)
					for (
						e.actionIndex = 0;
						e.actionIndex < (e.actions ? e.actions.length : 0);
						e.actionIndex++
					)
						(e.currentAction = e.actions[e.actionIndex]),
							e.currentAction &&
								((e.currentActionSalvaged = !1),
								e.currentAction.step(
									t *
										(e.currentAction._speedMethod
											? e.currentAction._speed
											: 1)
								),
								e.currentActionSalvaged
									? (e.currentAction = null)
									: e.currentAction.isDone() &&
									  (e.currentAction.stop(),
									  (i = e.currentAction),
									  (e.currentAction = null),
									  this.removeAction(i)),
								(e.currentAction = null));
				this._currentTargetSalvaged &&
					0 === e.actions.length &&
					this._deleteHashElement(e) &&
					r--;
			}
		},
	})),
	(cc.ACTION_TAG_INVALID = -1),
	(cc.Action = cc.Class.extend({
		originalTarget: null,
		target: null,
		tag: cc.ACTION_TAG_INVALID,
		ctor: function () {
			(this.originalTarget = null),
				(this.target = null),
				(this.tag = cc.ACTION_TAG_INVALID);
		},
		copy: function () {
			return (
				cc.log('copy is deprecated. Please use clone instead.'),
				this.clone()
			);
		},
		clone: function () {
			var t = new cc.Action();
			return (
				(t.originalTarget = null),
				(t.target = null),
				(t.tag = this.tag),
				t
			);
		},
		isDone: function () {
			return !0;
		},
		startWithTarget: function (t) {
			(this.originalTarget = t), (this.target = t);
		},
		stop: function () {
			this.target = null;
		},
		step: function (t) {
			cc.log('[Action step]. override me');
		},
		update: function (t) {
			cc.log('[Action update]. override me');
		},
		getTarget: function () {
			return this.target;
		},
		setTarget: function (t) {
			this.target = t;
		},
		getOriginalTarget: function () {
			return this.originalTarget;
		},
		setOriginalTarget: function (t) {
			this.originalTarget = t;
		},
		getTag: function () {
			return this.tag;
		},
		setTag: function (t) {
			this.tag = t;
		},
		retain: function () {},
		release: function () {},
	})),
	(cc.action = function () {
		return new cc.Action();
	}),
	(cc.Action.create = cc.action),
	(cc.FiniteTimeAction = cc.Action.extend({
		_duration: 0,
		ctor: function () {
			cc.Action.prototype.ctor.call(this), (this._duration = 0);
		},
		getDuration: function () {
			return this._duration * (this._timesForRepeat || 1);
		},
		setDuration: function (t) {
			this._duration = t;
		},
		reverse: function () {
			return (
				cc.log('cocos2d: FiniteTimeAction#reverse: Implement me'), null
			);
		},
		clone: function () {
			return new cc.FiniteTimeAction();
		},
	})),
	(cc.Speed = cc.Action.extend({
		_speed: 0,
		_innerAction: null,
		ctor: function (t, e) {
			cc.Action.prototype.ctor.call(this),
				(this._speed = 0),
				(this._innerAction = null),
				t && this.initWithAction(t, e);
		},
		getSpeed: function () {
			return this._speed;
		},
		setSpeed: function (t) {
			this._speed = t;
		},
		initWithAction: function (t, e) {
			if (!t)
				throw new Error(
					'cc.Speed.initWithAction(): action must be non nil'
				);
			return (this._innerAction = t), (this._speed = e), !0;
		},
		clone: function () {
			var t = new cc.Speed();
			return t.initWithAction(this._innerAction.clone(), this._speed), t;
		},
		startWithTarget: function (t) {
			cc.Action.prototype.startWithTarget.call(this, t),
				this._innerAction.startWithTarget(t);
		},
		stop: function () {
			this._innerAction.stop(), cc.Action.prototype.stop.call(this);
		},
		step: function (t) {
			this._innerAction.step(t * this._speed);
		},
		isDone: function () {
			return this._innerAction.isDone();
		},
		reverse: function () {
			return new cc.Speed(this._innerAction.reverse(), this._speed);
		},
		setInnerAction: function (t) {
			this._innerAction !== t && (this._innerAction = t);
		},
		getInnerAction: function () {
			return this._innerAction;
		},
	})),
	(cc.speed = function (t, e) {
		return new cc.Speed(t, e);
	}),
	(cc.Speed.create = cc.speed),
	(cc.Follow = cc.Action.extend({
		_followedNode: null,
		_boundarySet: !1,
		_boundaryFullyCovered: !1,
		_halfScreenSize: null,
		_fullScreenSize: null,
		_worldRect: null,
		leftBoundary: 0,
		rightBoundary: 0,
		topBoundary: 0,
		bottomBoundary: 0,
		ctor: function (t, e) {
			cc.Action.prototype.ctor.call(this),
				(this._followedNode = null),
				(this._boundarySet = !1),
				(this._boundaryFullyCovered = !1),
				(this._halfScreenSize = null),
				(this._fullScreenSize = null),
				(this.leftBoundary = 0),
				(this.rightBoundary = 0),
				(this.topBoundary = 0),
				(this.bottomBoundary = 0),
				(this._worldRect = cc.rect(0, 0, 0, 0)),
				t && (e ? this.initWithTarget(t, e) : this.initWithTarget(t));
		},
		clone: function () {
			var t = new cc.Follow(),
				e = this._worldRect,
				e = new cc.Rect(e.x, e.y, e.width, e.height);
			return t.initWithTarget(this._followedNode, e), t;
		},
		isBoundarySet: function () {
			return this._boundarySet;
		},
		setBoudarySet: function (t) {
			this._boundarySet = t;
		},
		initWithTarget: function (t, e) {
			if (!t)
				throw new Error(
					'cc.Follow.initWithAction(): followedNode must be non nil'
				);
			var i = this;
			(e = e || cc.rect(0, 0, 0, 0)),
				(i._followedNode = t),
				(i._worldRect = e),
				(i._boundarySet = !cc._rectEqualToZero(e)),
				(i._boundaryFullyCovered = !1);
			t = cc.director.getWinSize();
			return (
				(i._fullScreenSize = cc.p(t.width, t.height)),
				(i._halfScreenSize = cc.pMult(i._fullScreenSize, 0.5)),
				i._boundarySet &&
					((i.leftBoundary = -(e.x + e.width - i._fullScreenSize.x)),
					(i.rightBoundary = -e.x),
					(i.topBoundary = -e.y),
					(i.bottomBoundary = -(
						e.y +
						e.height -
						i._fullScreenSize.y
					)),
					i.rightBoundary < i.leftBoundary &&
						(i.rightBoundary = i.leftBoundary =
							(i.leftBoundary + i.rightBoundary) / 2),
					i.topBoundary < i.bottomBoundary &&
						(i.topBoundary = i.bottomBoundary =
							(i.topBoundary + i.bottomBoundary) / 2),
					i.topBoundary === i.bottomBoundary &&
						i.leftBoundary === i.rightBoundary &&
						(i._boundaryFullyCovered = !0)),
				!0
			);
		},
		step: function (t) {
			var e = this._followedNode.x,
				i = this._followedNode.y,
				e = this._halfScreenSize.x - e,
				i = this._halfScreenSize.y - i;
			(this.target._renderCmd._dirtyFlag = 0),
				this._boundarySet
					? this._boundaryFullyCovered ||
					  this.target.setPosition(
							cc.clampf(e, this.leftBoundary, this.rightBoundary),
							cc.clampf(i, this.bottomBoundary, this.topBoundary)
					  )
					: this.target.setPosition(e, i);
		},
		isDone: function () {
			return !this._followedNode.running;
		},
		stop: function () {
			(this.target = null), cc.Action.prototype.stop.call(this);
		},
	})),
	(cc.follow = function (t, e) {
		return new cc.Follow(t, e);
	}),
	(cc.Follow.create = cc.follow),
	(cc.ActionInterval = cc.FiniteTimeAction.extend({
		_elapsed: 0,
		_firstTick: !1,
		_easeList: null,
		_timesForRepeat: 1,
		_repeatForever: !1,
		_repeatMethod: !1,
		_speed: 1,
		_speedMethod: !1,
		ctor: function (t) {
			(this._speed = 1),
				(this._timesForRepeat = 1),
				(this._repeatForever = !1),
				(this.MAX_VALUE = 2),
				(this._repeatMethod = !1),
				(this._speedMethod = !1),
				cc.FiniteTimeAction.prototype.ctor.call(this),
				void 0 !== t && this.initWithDuration(t);
		},
		getElapsed: function () {
			return this._elapsed;
		},
		initWithDuration: function (t) {
			return (
				(this._duration = 0 === t ? cc.FLT_EPSILON : t),
				(this._elapsed = 0),
				(this._firstTick = !0)
			);
		},
		isDone: function () {
			return this._elapsed >= this._duration;
		},
		_cloneDecoration: function (t) {
			(t._repeatForever = this._repeatForever),
				(t._speed = this._speed),
				(t._timesForRepeat = this._timesForRepeat),
				(t._easeList = this._easeList),
				(t._speedMethod = this._speedMethod),
				(t._repeatMethod = this._repeatMethod);
		},
		_reverseEaseList: function (t) {
			if (this._easeList) {
				t._easeList = [];
				for (var e = 0; e < this._easeList.length; e++)
					t._easeList.push(this._easeList[e].reverse());
			}
		},
		clone: function () {
			var t = new cc.ActionInterval(this._duration);
			return this._cloneDecoration(t), t;
		},
		easing: function (t) {
			this._easeList
				? (this._easeList.length = 0)
				: (this._easeList = []);
			for (var e = 0; e < arguments.length; e++)
				this._easeList.push(arguments[e]);
			return this;
		},
		_computeEaseTime: function (t) {
			var e = this._easeList;
			if (!e || 0 === e.length) return t;
			for (var i = 0, n = e.length; i < n; i++) t = e[i].easing(t);
			return t;
		},
		step: function (t) {
			this._firstTick
				? ((this._firstTick = !1), (this._elapsed = 0))
				: (this._elapsed += t);
			t =
				(t =
					this._elapsed /
					(1.192092896e-7 < this._duration
						? this._duration
						: 1.192092896e-7)) < 1
					? t
					: 1;
			this.update(0 < t ? t : 0),
				this._repeatMethod &&
					1 < this._timesForRepeat &&
					this.isDone() &&
					(this._repeatForever || this._timesForRepeat--,
					this.startWithTarget(this.target),
					this.step(this._elapsed - this._duration));
		},
		startWithTarget: function (t) {
			cc.Action.prototype.startWithTarget.call(this, t),
				(this._elapsed = 0),
				(this._firstTick = !0);
		},
		reverse: function () {
			return cc.log('cc.IntervalAction: reverse not implemented.'), null;
		},
		setAmplitudeRate: function (t) {
			cc.log(
				'cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.'
			);
		},
		getAmplitudeRate: function () {
			return (
				cc.log(
					'cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass.'
				),
				0
			);
		},
		speed: function (t) {
			return (
				t <= 0
					? cc.log('The speed parameter error')
					: ((this._speedMethod = !0), (this._speed *= t)),
				this
			);
		},
		getSpeed: function () {
			return this._speed;
		},
		setSpeed: function (t) {
			return (this._speed = t), this;
		},
		repeat: function (t) {
			return (
				(t = Math.round(t)),
				isNaN(t) || t < 1
					? cc.log('The repeat parameter error')
					: ((this._repeatMethod = !0), (this._timesForRepeat *= t)),
				this
			);
		},
		repeatForever: function () {
			return (
				(this._repeatMethod = !0),
				(this._timesForRepeat = this.MAX_VALUE),
				(this._repeatForever = !0),
				this
			);
		},
	})),
	(cc.actionInterval = function (t) {
		return new cc.ActionInterval(t);
	}),
	(cc.ActionInterval.create = cc.actionInterval),
	(cc.Sequence = cc.ActionInterval.extend({
		_actions: null,
		_split: null,
		_last: 0,
		ctor: function (t) {
			cc.ActionInterval.prototype.ctor.call(this), (this._actions = []);
			var e = t instanceof Array ? t : arguments,
				i = e.length - 1;
			if (
				(0 <= i &&
					null == e[i] &&
					cc.log(
						'parameters should not be ending with null in Javascript'
					),
				0 <= i)
			) {
				for (var n = e[0], r = 1; r < i; r++)
					e[r] && (n = cc.Sequence._actionOneTwo(n, e[r]));
				this.initWithTwoActions(n, e[i]);
			}
		},
		initWithTwoActions: function (t, e) {
			if (!t || !e)
				throw new Error(
					'cc.Sequence.initWithTwoActions(): arguments must all be non nil'
				);
			var i = t._duration + e._duration;
			return (
				this.initWithDuration(i),
				(this._actions[0] = t),
				(this._actions[1] = e),
				!0
			);
		},
		clone: function () {
			var t = new cc.Sequence();
			return (
				this._cloneDecoration(t),
				t.initWithTwoActions(
					this._actions[0].clone(),
					this._actions[1].clone()
				),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._split = this._actions[0]._duration / this._duration),
				(this._last = -1);
		},
		stop: function () {
			-1 !== this._last && this._actions[this._last].stop(),
				cc.Action.prototype.stop.call(this);
		},
		update: function (t) {
			var e,
				i = 0,
				n = this._split,
				r = this._actions,
				o = this._last;
			(t = this._computeEaseTime(t)) < n
				? ((e = 0 !== n ? t / n : 1),
				  0 === i && 1 === o && (r[1].update(0), r[1].stop()))
				: ((e = (i = 1) === n ? 1 : (t - n) / (1 - n)),
				  -1 === o &&
						(r[0].startWithTarget(this.target),
						r[0].update(1),
						r[0].stop()),
				  o || (r[0].update(1), r[0].stop())),
				(r = r[i]),
				(o === i && r.isDone()) ||
					(o !== i && r.startWithTarget(this.target),
					(e *= r._timesForRepeat),
					r.update(1 < e ? e % 1 : e),
					(this._last = i));
		},
		reverse: function () {
			var t = cc.Sequence._actionOneTwo(
				this._actions[1].reverse(),
				this._actions[0].reverse()
			);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.sequence = function (t) {
		var e,
			i,
			n,
			r,
			o = t instanceof Array ? t : arguments;
		for (
			0 < o.length &&
			null == o[o.length - 1] &&
			cc.log('parameters should not be ending with null in Javascript');
			o && 0 < o.length;

		)
			for (
				r = (i = Array.prototype.shift.call(o))._timesForRepeat || 1,
					i._repeatMethod = !1,
					i._timesForRepeat = 1,
					n = 0,
					e || ((e = i), (n = 1));
				n < r;
				n++
			)
				e = cc.Sequence._actionOneTwo(e, i);
		return e;
	}),
	(cc.Sequence.create = cc.sequence),
	(cc.Sequence._actionOneTwo = function (t, e) {
		var i = new cc.Sequence();
		return i.initWithTwoActions(t, e), i;
	}),
	(cc.Repeat = cc.ActionInterval.extend({
		_times: 0,
		_total: 0,
		_nextDt: 0,
		_actionInstant: !1,
		_innerAction: null,
		ctor: function (t, e) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== e && this.initWithAction(t, e);
		},
		initWithAction: function (t, e) {
			var i = t._duration * e;
			return (
				!!this.initWithDuration(i) &&
				((this._times = e),
				(this._innerAction = t) instanceof cc.ActionInstant &&
					((this._actionInstant = !0), --this._times),
				!(this._total = 0))
			);
		},
		clone: function () {
			var t = new cc.Repeat();
			return (
				this._cloneDecoration(t),
				t.initWithAction(this._innerAction.clone(), this._times),
				t
			);
		},
		startWithTarget: function (t) {
			(this._total = 0),
				(this._nextDt = this._innerAction._duration / this._duration),
				cc.ActionInterval.prototype.startWithTarget.call(this, t),
				this._innerAction.startWithTarget(t);
		},
		stop: function () {
			this._innerAction.stop(), cc.Action.prototype.stop.call(this);
		},
		update: function (t) {
			t = this._computeEaseTime(t);
			var e = this._innerAction,
				i = this._duration,
				n = this._times,
				r = this._nextDt;
			if (r <= t) {
				for (; r < t && this._total < n; )
					e.update(1),
						this._total++,
						e.stop(),
						e.startWithTarget(this.target),
						(r += e._duration / i),
						(this._nextDt = r);
				1 <= t && this._total < n && this._total++,
					this._actionInstant ||
						(this._total === n
							? (e.update(1), e.stop())
							: e.update(t - (r - e._duration / i)));
			} else e.update((t * n) % 1);
		},
		isDone: function () {
			return this._total === this._times;
		},
		reverse: function () {
			var t = new cc.Repeat(this._innerAction.reverse(), this._times);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
		setInnerAction: function (t) {
			this._innerAction !== t && (this._innerAction = t);
		},
		getInnerAction: function () {
			return this._innerAction;
		},
	})),
	(cc.repeat = function (t, e) {
		return new cc.Repeat(t, e);
	}),
	(cc.Repeat.create = cc.repeat),
	(cc.RepeatForever = cc.ActionInterval.extend({
		_innerAction: null,
		ctor: function (t) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._innerAction = null),
				t && this.initWithAction(t);
		},
		initWithAction: function (t) {
			if (!t)
				throw new Error(
					'cc.RepeatForever.initWithAction(): action must be non null'
				);
			return (this._innerAction = t), !0;
		},
		clone: function () {
			var t = new cc.RepeatForever();
			return (
				this._cloneDecoration(t),
				t.initWithAction(this._innerAction.clone()),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				this._innerAction.startWithTarget(t);
		},
		step: function (t) {
			var e = this._innerAction;
			e.step(t),
				e.isDone() &&
					(e.startWithTarget(this.target),
					e.step(e.getElapsed() - e._duration));
		},
		isDone: function () {
			return !1;
		},
		reverse: function () {
			var t = new cc.RepeatForever(this._innerAction.reverse());
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
		setInnerAction: function (t) {
			this._innerAction !== t && (this._innerAction = t);
		},
		getInnerAction: function () {
			return this._innerAction;
		},
	})),
	(cc.repeatForever = function (t) {
		return new cc.RepeatForever(t);
	}),
	(cc.RepeatForever.create = cc.repeatForever),
	(cc.Spawn = cc.ActionInterval.extend({
		_one: null,
		_two: null,
		ctor: function (t) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._one = null),
				(this._two = null);
			var e = t instanceof Array ? t : arguments,
				i = e.length - 1;
			if (
				(0 <= i &&
					null == e[i] &&
					cc.log(
						'parameters should not be ending with null in Javascript'
					),
				0 <= i)
			) {
				for (var n = e[0], r = 1; r < i; r++)
					e[r] && (n = cc.Spawn._actionOneTwo(n, e[r]));
				this.initWithTwoActions(n, e[i]);
			}
		},
		initWithTwoActions: function (t, e) {
			if (!t || !e)
				throw new Error(
					'cc.Spawn.initWithTwoActions(): arguments must all be non null'
				);
			var i = !1,
				n = t._duration,
				r = e._duration;
			return (
				this.initWithDuration(Math.max(n, r)) &&
					((this._one = t),
					(this._two = e),
					r < n
						? (this._two = cc.Sequence._actionOneTwo(
								e,
								cc.delayTime(n - r)
						  ))
						: n < r &&
						  (this._one = cc.Sequence._actionOneTwo(
								t,
								cc.delayTime(r - n)
						  )),
					(i = !0)),
				i
			);
		},
		clone: function () {
			var t = new cc.Spawn();
			return (
				this._cloneDecoration(t),
				t.initWithTwoActions(this._one.clone(), this._two.clone()),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				this._one.startWithTarget(t),
				this._two.startWithTarget(t);
		},
		stop: function () {
			this._one.stop(),
				this._two.stop(),
				cc.Action.prototype.stop.call(this);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)),
				this._one && this._one.update(t),
				this._two && this._two.update(t);
		},
		reverse: function () {
			var t = cc.Spawn._actionOneTwo(
				this._one.reverse(),
				this._two.reverse()
			);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.spawn = function (t) {
		var e = t instanceof Array ? t : arguments;
		0 < e.length &&
			null == e[e.length - 1] &&
			cc.log('parameters should not be ending with null in Javascript');
		for (var i = e[0], n = 1; n < e.length; n++)
			null != e[n] && (i = cc.Spawn._actionOneTwo(i, e[n]));
		return i;
	}),
	(cc.Spawn.create = cc.spawn),
	(cc.Spawn._actionOneTwo = function (t, e) {
		var i = new cc.Spawn();
		return i.initWithTwoActions(t, e), i;
	}),
	(cc.RotateTo = cc.ActionInterval.extend({
		_dstAngleX: 0,
		_startAngleX: 0,
		_diffAngleX: 0,
		_dstAngleY: 0,
		_startAngleY: 0,
		_diffAngleY: 0,
		ctor: function (t, e, i) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== e && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._dstAngleX = e || 0),
				(this._dstAngleY = i || this._dstAngleX),
				!0)
			);
		},
		clone: function () {
			var t = new cc.RotateTo();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(
					this._duration,
					this._dstAngleX,
					this._dstAngleY
				),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t);
			var e = t.rotationX % 360,
				i = this._dstAngleX - e;
			180 < i && (i -= 360),
				i < -180 && (i += 360),
				(this._startAngleX = e),
				(this._diffAngleX = i),
				(this._startAngleY = t.rotationY % 360);
			t = this._dstAngleY - this._startAngleY;
			180 < t && (t -= 360),
				t < -180 && (t += 360),
				(this._diffAngleY = t);
		},
		reverse: function () {
			cc.log(
				'cc.RotateTo.reverse(): it should be overridden in subclass.'
			);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)),
				this.target &&
					((this.target.rotationX =
						this._startAngleX + this._diffAngleX * t),
					(this.target.rotationY =
						this._startAngleY + this._diffAngleY * t));
		},
	})),
	(cc.rotateTo = function (t, e, i) {
		return new cc.RotateTo(t, e, i);
	}),
	(cc.RotateTo.create = cc.rotateTo),
	(cc.RotateBy = cc.ActionInterval.extend({
		_angleX: 0,
		_startAngleX: 0,
		_angleY: 0,
		_startAngleY: 0,
		ctor: function (t, e, i) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== e && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._angleX = e || 0),
				(this._angleY = i || this._angleX),
				!0)
			);
		},
		clone: function () {
			var t = new cc.RotateBy();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._angleX, this._angleY),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._startAngleX = t.rotationX),
				(this._startAngleY = t.rotationY);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)),
				this.target &&
					((this.target.rotationX =
						this._startAngleX + this._angleX * t),
					(this.target.rotationY =
						this._startAngleY + this._angleY * t));
		},
		reverse: function () {
			var t = new cc.RotateBy(
				this._duration,
				-this._angleX,
				-this._angleY
			);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.rotateBy = function (t, e, i) {
		return new cc.RotateBy(t, e, i);
	}),
	(cc.RotateBy.create = cc.rotateBy),
	(cc.MoveBy = cc.ActionInterval.extend({
		_positionDelta: null,
		_startPosition: null,
		_previousPosition: null,
		ctor: function (t, e, i) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._positionDelta = cc.p(0, 0)),
				(this._startPosition = cc.p(0, 0)),
				(this._previousPosition = cc.p(0, 0)),
				void 0 !== e && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				(void 0 !== e.x && ((i = e.y), (e = e.x)),
				(this._positionDelta.x = e),
				(this._positionDelta.y = i),
				!0)
			);
		},
		clone: function () {
			var t = new cc.MoveBy();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._positionDelta),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t);
			var e = t.getPositionX(),
				t = t.getPositionY();
			(this._previousPosition.x = e),
				(this._previousPosition.y = t),
				(this._startPosition.x = e),
				(this._startPosition.y = t);
		},
		update: function (t) {
			var e, i, n, r, o;
			(t = this._computeEaseTime(t)),
				this.target &&
					((e = this._positionDelta.x * t),
					(i = this._positionDelta.y * t),
					(n = this._startPosition),
					cc.ENABLE_STACKABLE_ACTIONS
						? ((r = this.target.getPositionX()),
						  (o = this.target.getPositionY()),
						  (t = this._previousPosition),
						  (n.x = n.x + r - t.x),
						  (n.y = n.y + o - t.y),
						  (e += n.x),
						  (i += n.y),
						  (t.x = e),
						  (t.y = i),
						  this.target.setPosition(e, i))
						: this.target.setPosition(n.x + e, n.y + i));
		},
		reverse: function () {
			var t = new cc.MoveBy(
				this._duration,
				cc.p(-this._positionDelta.x, -this._positionDelta.y)
			);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.moveBy = function (t, e, i) {
		return new cc.MoveBy(t, e, i);
	}),
	(cc.MoveBy.create = cc.moveBy),
	(cc.MoveTo = cc.MoveBy.extend({
		_endPosition: null,
		ctor: function (t, e, i) {
			cc.MoveBy.prototype.ctor.call(this),
				(this._endPosition = cc.p(0, 0)),
				void 0 !== e && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.MoveBy.prototype.initWithDuration.call(this, t, e, i) &&
				(void 0 !== e.x && ((i = e.y), (e = e.x)),
				(this._endPosition.x = e),
				(this._endPosition.y = i),
				!0)
			);
		},
		clone: function () {
			var t = new cc.MoveTo();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._endPosition),
				t
			);
		},
		startWithTarget: function (t) {
			cc.MoveBy.prototype.startWithTarget.call(this, t),
				(this._positionDelta.x =
					this._endPosition.x - t.getPositionX()),
				(this._positionDelta.y =
					this._endPosition.y - t.getPositionY());
		},
	})),
	(cc.moveTo = function (t, e, i) {
		return new cc.MoveTo(t, e, i);
	}),
	(cc.MoveTo.create = cc.moveTo),
	(cc.SkewTo = cc.ActionInterval.extend({
		_skewX: 0,
		_skewY: 0,
		_startSkewX: 0,
		_startSkewY: 0,
		_endSkewX: 0,
		_endSkewY: 0,
		_deltaX: 0,
		_deltaY: 0,
		ctor: function (t, e, i) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== i && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			var n = !1;
			return (
				cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
					((this._endSkewX = e), (this._endSkewY = i), (n = !0)),
				n
			);
		},
		clone: function () {
			var t = new cc.SkewTo();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(
					this._duration,
					this._endSkewX,
					this._endSkewY
				),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._startSkewX = t.skewX % 180),
				(this._deltaX = this._endSkewX - this._startSkewX),
				180 < this._deltaX && (this._deltaX -= 360),
				this._deltaX < -180 && (this._deltaX += 360),
				(this._startSkewY = t.skewY % 360),
				(this._deltaY = this._endSkewY - this._startSkewY),
				180 < this._deltaY && (this._deltaY -= 360),
				this._deltaY < -180 && (this._deltaY += 360);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)),
				(this.target.skewX = this._startSkewX + this._deltaX * t),
				(this.target.skewY = this._startSkewY + this._deltaY * t);
		},
	})),
	(cc.skewTo = function (t, e, i) {
		return new cc.SkewTo(t, e, i);
	}),
	(cc.SkewTo.create = cc.skewTo),
	(cc.SkewBy = cc.SkewTo.extend({
		ctor: function (t, e, i) {
			cc.SkewTo.prototype.ctor.call(this),
				void 0 !== i && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			var n = !1;
			return (
				cc.SkewTo.prototype.initWithDuration.call(this, t, e, i) &&
					((this._skewX = e), (this._skewY = i), (n = !0)),
				n
			);
		},
		clone: function () {
			var t = new cc.SkewBy();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._skewX, this._skewY),
				t
			);
		},
		startWithTarget: function (t) {
			cc.SkewTo.prototype.startWithTarget.call(this, t),
				(this._deltaX = this._skewX),
				(this._deltaY = this._skewY),
				(this._endSkewX = this._startSkewX + this._deltaX),
				(this._endSkewY = this._startSkewY + this._deltaY);
		},
		reverse: function () {
			var t = new cc.SkewBy(this._duration, -this._skewX, -this._skewY);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.skewBy = function (t, e, i) {
		return new cc.SkewBy(t, e, i);
	}),
	(cc.SkewBy.create = cc.skewBy),
	(cc.JumpBy = cc.ActionInterval.extend({
		_startPosition: null,
		_delta: null,
		_height: 0,
		_jumps: 0,
		_previousPosition: null,
		ctor: function (t, e, i, n, r) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._startPosition = cc.p(0, 0)),
				(this._previousPosition = cc.p(0, 0)),
				(this._delta = cc.p(0, 0)),
				void 0 !== n && this.initWithDuration(t, e, i, n, r);
		},
		initWithDuration: function (t, e, i, n, r) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				(void 0 === r && ((r = n), (n = i), (i = e.y), (e = e.x)),
				(this._delta.x = e),
				(this._delta.y = i),
				(this._height = n),
				(this._jumps = r),
				!0)
			);
		},
		clone: function () {
			var t = new cc.JumpBy();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(
					this._duration,
					this._delta,
					this._height,
					this._jumps
				),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t);
			var e = t.getPositionX(),
				t = t.getPositionY();
			(this._previousPosition.x = e),
				(this._previousPosition.y = t),
				(this._startPosition.x = e),
				(this._startPosition.y = t);
		},
		update: function (t) {
			var e, i, n, r, o;
			(t = this._computeEaseTime(t)),
				this.target &&
					((o = (t * this._jumps) % 1),
					(e = 4 * this._height * o * (1 - o)),
					(e += this._delta.y * t),
					(i = this._delta.x * t),
					(n = this._startPosition),
					cc.ENABLE_STACKABLE_ACTIONS
						? ((r = this.target.getPositionX()),
						  (o = this.target.getPositionY()),
						  (t = this._previousPosition),
						  (n.x = n.x + r - t.x),
						  (n.y = n.y + o - t.y),
						  (i += n.x),
						  (e += n.y),
						  (t.x = i),
						  (t.y = e),
						  this.target.setPosition(i, e))
						: this.target.setPosition(n.x + i, n.y + e));
		},
		reverse: function () {
			var t = new cc.JumpBy(
				this._duration,
				cc.p(-this._delta.x, -this._delta.y),
				this._height,
				this._jumps
			);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.jumpBy = function (t, e, i, n, r) {
		return new cc.JumpBy(t, e, i, n, r);
	}),
	(cc.JumpBy.create = cc.jumpBy),
	(cc.JumpTo = cc.JumpBy.extend({
		_endPosition: null,
		ctor: function (t, e, i, n, r) {
			cc.JumpBy.prototype.ctor.call(this),
				(this._endPosition = cc.p(0, 0)),
				void 0 !== n && this.initWithDuration(t, e, i, n, r);
		},
		initWithDuration: function (t, e, i, n, r) {
			return (
				!!cc.JumpBy.prototype.initWithDuration.call(
					this,
					t,
					e,
					i,
					n,
					r
				) &&
				(void 0 === r && ((i = e.y), (e = e.x)),
				(this._endPosition.x = e),
				(this._endPosition.y = i),
				!0)
			);
		},
		startWithTarget: function (t) {
			cc.JumpBy.prototype.startWithTarget.call(this, t),
				(this._delta.x = this._endPosition.x - this._startPosition.x),
				(this._delta.y = this._endPosition.y - this._startPosition.y);
		},
		clone: function () {
			var t = new cc.JumpTo();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(
					this._duration,
					this._endPosition,
					this._height,
					this._jumps
				),
				t
			);
		},
	})),
	(cc.jumpTo = function (t, e, i, n, r) {
		return new cc.JumpTo(t, e, i, n, r);
	}),
	(cc.JumpTo.create = cc.jumpTo),
	(cc.bezierAt = function (t, e, i, n, r) {
		return (
			Math.pow(1 - r, 3) * t +
			3 * r * Math.pow(1 - r, 2) * e +
			3 * Math.pow(r, 2) * (1 - r) * i +
			Math.pow(r, 3) * n
		);
	}),
	(cc.BezierBy = cc.ActionInterval.extend({
		_config: null,
		_startPosition: null,
		_previousPosition: null,
		ctor: function (t, e) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._config = []),
				(this._startPosition = cc.p(0, 0)),
				(this._previousPosition = cc.p(0, 0)),
				e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._config = e), !0)
			);
		},
		clone: function () {
			var t = new cc.BezierBy();
			this._cloneDecoration(t);
			for (var e = [], i = 0; i < this._config.length; i++) {
				var n = this._config[i];
				e.push(cc.p(n.x, n.y));
			}
			return t.initWithDuration(this._duration, e), t;
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t);
			var e = t.getPositionX(),
				t = t.getPositionY();
			(this._previousPosition.x = e),
				(this._previousPosition.y = t),
				(this._startPosition.x = e),
				(this._startPosition.y = t);
		},
		update: function (t) {
			var e, i, n, r, o, s;
			(t = this._computeEaseTime(t)),
				this.target &&
					((e = (s = this._config)[0].x),
					(i = s[1].x),
					(n = s[2].x),
					(r = s[0].y),
					(o = s[1].y),
					(s = s[2].y),
					(i = cc.bezierAt(0, e, i, n, t)),
					(n = cc.bezierAt(0, r, o, s, t)),
					(r = this._startPosition),
					cc.ENABLE_STACKABLE_ACTIONS
						? ((o = this.target.getPositionX()),
						  (s = this.target.getPositionY()),
						  (t = this._previousPosition),
						  (r.x = r.x + o - t.x),
						  (r.y = r.y + s - t.y),
						  (i += r.x),
						  (n += r.y),
						  (t.x = i),
						  (t.y = n),
						  this.target.setPosition(i, n))
						: this.target.setPosition(r.x + i, r.y + n));
		},
		reverse: function () {
			var t = this._config,
				t = [
					cc.pAdd(t[1], cc.pNeg(t[2])),
					cc.pAdd(t[0], cc.pNeg(t[2])),
					cc.pNeg(t[2]),
				],
				t = new cc.BezierBy(this._duration, t);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.bezierBy = function (t, e) {
		return new cc.BezierBy(t, e);
	}),
	(cc.BezierBy.create = cc.bezierBy),
	(cc.BezierTo = cc.BezierBy.extend({
		_toConfig: null,
		ctor: function (t, e) {
			cc.BezierBy.prototype.ctor.call(this),
				(this._toConfig = []),
				e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._toConfig = e), !0)
			);
		},
		clone: function () {
			var t = new cc.BezierTo();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._toConfig),
				t
			);
		},
		startWithTarget: function (t) {
			cc.BezierBy.prototype.startWithTarget.call(this, t);
			var e = this._startPosition,
				i = this._toConfig,
				t = this._config;
			(t[0] = cc.pSub(i[0], e)),
				(t[1] = cc.pSub(i[1], e)),
				(t[2] = cc.pSub(i[2], e));
		},
	})),
	(cc.bezierTo = function (t, e) {
		return new cc.BezierTo(t, e);
	}),
	(cc.BezierTo.create = cc.bezierTo),
	(cc.ScaleTo = cc.ActionInterval.extend({
		_scaleX: 1,
		_scaleY: 1,
		_startScaleX: 1,
		_startScaleY: 1,
		_endScaleX: 0,
		_endScaleY: 0,
		_deltaX: 0,
		_deltaY: 0,
		ctor: function (t, e, i) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== e && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._endScaleX = e),
				(this._endScaleY = null != i ? i : e),
				!0)
			);
		},
		clone: function () {
			var t = new cc.ScaleTo();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(
					this._duration,
					this._endScaleX,
					this._endScaleY
				),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._startScaleX = t.scaleX),
				(this._startScaleY = t.scaleY),
				(this._deltaX = this._endScaleX - this._startScaleX),
				(this._deltaY = this._endScaleY - this._startScaleY);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)),
				this.target &&
					((this.target.scaleX =
						this._startScaleX + this._deltaX * t),
					(this.target.scaleY =
						this._startScaleY + this._deltaY * t));
		},
	})),
	(cc.scaleTo = function (t, e, i) {
		return new cc.ScaleTo(t, e, i);
	}),
	(cc.ScaleTo.create = cc.scaleTo),
	(cc.ScaleBy = cc.ScaleTo.extend({
		startWithTarget: function (t) {
			cc.ScaleTo.prototype.startWithTarget.call(this, t),
				(this._deltaX =
					this._startScaleX * this._endScaleX - this._startScaleX),
				(this._deltaY =
					this._startScaleY * this._endScaleY - this._startScaleY);
		},
		reverse: function () {
			var t = new cc.ScaleBy(
				this._duration,
				1 / this._endScaleX,
				1 / this._endScaleY
			);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
		clone: function () {
			var t = new cc.ScaleBy();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(
					this._duration,
					this._endScaleX,
					this._endScaleY
				),
				t
			);
		},
	})),
	(cc.scaleBy = function (t, e, i) {
		return new cc.ScaleBy(t, e, i);
	}),
	(cc.ScaleBy.create = cc.scaleBy),
	(cc.Blink = cc.ActionInterval.extend({
		_times: 0,
		_originalState: !1,
		ctor: function (t, e) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._times = e), !0)
			);
		},
		clone: function () {
			var t = new cc.Blink();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._times),
				t
			);
		},
		update: function (t) {
			var e;
			(t = this._computeEaseTime(t)),
				this.target &&
					!this.isDone() &&
					((t = t % (e = 1 / this._times)),
					(this.target.visible = e / 2 < t));
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._originalState = t.visible);
		},
		stop: function () {
			(this.target.visible = this._originalState),
				cc.ActionInterval.prototype.stop.call(this);
		},
		reverse: function () {
			var t = new cc.Blink(this._duration, this._times);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.blink = function (t, e) {
		return new cc.Blink(t, e);
	}),
	(cc.Blink.create = cc.blink),
	(cc.FadeTo = cc.ActionInterval.extend({
		_toOpacity: 0,
		_fromOpacity: 0,
		ctor: function (t, e) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._toOpacity = e), !0)
			);
		},
		clone: function () {
			var t = new cc.FadeTo();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._toOpacity),
				t
			);
		},
		update: function (t) {
			t = this._computeEaseTime(t);
			var e = void 0 !== this._fromOpacity ? this._fromOpacity : 255;
			this.target.opacity = e + (this._toOpacity - e) * t;
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._fromOpacity = t.opacity);
		},
	})),
	(cc.fadeTo = function (t, e) {
		return new cc.FadeTo(t, e);
	}),
	(cc.FadeTo.create = cc.fadeTo),
	(cc.FadeIn = cc.FadeTo.extend({
		_reverseAction: null,
		ctor: function (t) {
			cc.FadeTo.prototype.ctor.call(this),
				null == t && (t = 0),
				this.initWithDuration(t, 255);
		},
		reverse: function () {
			var t = new cc.FadeOut();
			return (
				t.initWithDuration(this._duration, 0),
				this._cloneDecoration(t),
				this._reverseEaseList(t),
				t
			);
		},
		clone: function () {
			var t = new cc.FadeIn();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._toOpacity),
				t
			);
		},
		startWithTarget: function (t) {
			this._reverseAction &&
				(this._toOpacity = this._reverseAction._fromOpacity),
				cc.FadeTo.prototype.startWithTarget.call(this, t);
		},
	})),
	(cc.fadeIn = function (t) {
		return new cc.FadeIn(t);
	}),
	(cc.FadeIn.create = cc.fadeIn),
	(cc.FadeOut = cc.FadeTo.extend({
		ctor: function (t) {
			cc.FadeTo.prototype.ctor.call(this),
				null == t && (t = 0),
				this.initWithDuration(t, 0);
		},
		reverse: function () {
			var t = new cc.FadeIn();
			return (
				(t._reverseAction = this),
				t.initWithDuration(this._duration, 255),
				this._cloneDecoration(t),
				this._reverseEaseList(t),
				t
			);
		},
		clone: function () {
			var t = new cc.FadeOut();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(this._duration, this._toOpacity),
				t
			);
		},
	})),
	(cc.fadeOut = function (t) {
		return new cc.FadeOut(t);
	}),
	(cc.FadeOut.create = cc.fadeOut),
	(cc.TintTo = cc.ActionInterval.extend({
		_to: null,
		_from: null,
		ctor: function (t, e, i, n) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._to = cc.color(0, 0, 0)),
				(this._from = cc.color(0, 0, 0)),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._to = cc.color(e, i, n)), !0)
			);
		},
		clone: function () {
			var t = new cc.TintTo();
			this._cloneDecoration(t);
			var e = this._to;
			return t.initWithDuration(this._duration, e.r, e.g, e.b), t;
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._from = this.target.color);
		},
		update: function (t) {
			t = this._computeEaseTime(t);
			var e = this._from,
				i = this._to;
			e &&
				this.target.setColor(
					cc.color(
						e.r + (i.r - e.r) * t,
						e.g + (i.g - e.g) * t,
						e.b + (i.b - e.b) * t
					)
				);
		},
	})),
	(cc.tintTo = function (t, e, i, n) {
		return new cc.TintTo(t, e, i, n);
	}),
	(cc.TintTo.create = cc.tintTo),
	(cc.TintBy = cc.ActionInterval.extend({
		_deltaR: 0,
		_deltaG: 0,
		_deltaB: 0,
		_fromR: 0,
		_fromG: 0,
		_fromB: 0,
		ctor: function (t, e, i, n) {
			cc.ActionInterval.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._deltaR = e), (this._deltaG = i), (this._deltaB = n), !0)
			);
		},
		clone: function () {
			var t = new cc.TintBy();
			return (
				this._cloneDecoration(t),
				t.initWithDuration(
					this._duration,
					this._deltaR,
					this._deltaG,
					this._deltaB
				),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t);
			t = t.color;
			(this._fromR = t.r), (this._fromG = t.g), (this._fromB = t.b);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)),
				(this.target.color = cc.color(
					this._fromR + this._deltaR * t,
					this._fromG + this._deltaG * t,
					this._fromB + this._deltaB * t
				));
		},
		reverse: function () {
			var t = new cc.TintBy(
				this._duration,
				-this._deltaR,
				-this._deltaG,
				-this._deltaB
			);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
	})),
	(cc.tintBy = function (t, e, i, n) {
		return new cc.TintBy(t, e, i, n);
	}),
	(cc.TintBy.create = cc.tintBy),
	(cc.DelayTime = cc.ActionInterval.extend({
		update: function (t) {},
		reverse: function () {
			var t = new cc.DelayTime(this._duration);
			return this._cloneDecoration(t), this._reverseEaseList(t), t;
		},
		clone: function () {
			var t = new cc.DelayTime();
			return (
				this._cloneDecoration(t), t.initWithDuration(this._duration), t
			);
		},
	})),
	(cc.delayTime = function (t) {
		return new cc.DelayTime(t);
	}),
	(cc.DelayTime.create = cc.delayTime),
	(cc.ReverseTime = cc.ActionInterval.extend({
		_other: null,
		ctor: function (t) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._other = null),
				t && this.initWithAction(t);
		},
		initWithAction: function (t) {
			if (!t)
				throw new Error(
					'cc.ReverseTime.initWithAction(): action must be non null'
				);
			if (t === this._other)
				throw new Error(
					'cc.ReverseTime.initWithAction(): the action was already passed in.'
				);
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(
					this,
					t._duration
				) && ((this._other = t), !0)
			);
		},
		clone: function () {
			var t = new cc.ReverseTime();
			return (
				this._cloneDecoration(t),
				t.initWithAction(this._other.clone()),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				this._other.startWithTarget(t);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)),
				this._other && this._other.update(1 - t);
		},
		reverse: function () {
			return this._other.clone();
		},
		stop: function () {
			this._other.stop(), cc.Action.prototype.stop.call(this);
		},
	})),
	(cc.reverseTime = function (t) {
		return new cc.ReverseTime(t);
	}),
	(cc.ReverseTime.create = cc.reverseTime),
	(cc.Animate = cc.ActionInterval.extend({
		_animation: null,
		_nextFrame: 0,
		_origFrame: null,
		_executedLoops: 0,
		_splitTimes: null,
		_currFrameIndex: 0,
		ctor: function (t) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._splitTimes = []),
				t && this.initWithAnimation(t);
		},
		getAnimation: function () {
			return this._animation;
		},
		setAnimation: function (t) {
			this._animation = t;
		},
		getCurrentFrameIndex: function () {
			return this._currFrameIndex;
		},
		initWithAnimation: function (t) {
			if (!t)
				throw new Error(
					'cc.Animate.initWithAnimation(): animation must be non-NULL'
				);
			var e = t.getDuration();
			if (this.initWithDuration(e * t.getLoops())) {
				(this._nextFrame = 0),
					this.setAnimation(t),
					(this._origFrame = null),
					(this._executedLoops = 0);
				var i = this._splitTimes,
					n = (i.length = 0),
					r = e / t.getTotalDelayUnits(),
					o = t.getFrames();
				cc.arrayVerifyType(o, cc.AnimationFrame);
				for (var s = 0; s < o.length; s++) {
					var c = (n * r) / e;
					(n += o[s].getDelayUnits()), i.push(c);
				}
				return !0;
			}
			return !1;
		},
		clone: function () {
			var t = new cc.Animate();
			return (
				this._cloneDecoration(t),
				t.initWithAnimation(this._animation.clone()),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				this._animation.getRestoreOriginalFrame() &&
					(this._origFrame = t.displayFrame()),
				(this._nextFrame = 0),
				(this._executedLoops = 0);
		},
		update: function (t) {
			(t = this._computeEaseTime(t)) < 1 &&
				((0 | (t *= this._animation.getLoops())) >
					this._executedLoops &&
					((this._nextFrame = 0), this._executedLoops++),
				(t %= 1));
			for (
				var e = this._animation.getFrames(),
					i = e.length,
					n = this._splitTimes,
					r = this._nextFrame;
				r < i && n[r] <= t;
				r++
			)
				(_currFrameIndex = r),
					this.target.setSpriteFrame(
						e[_currFrameIndex].getSpriteFrame()
					),
					(this._nextFrame = r + 1);
		},
		reverse: function () {
			var t = this._animation,
				e = t.getFrames(),
				i = [];
			if ((cc.arrayVerifyType(e, cc.AnimationFrame), 0 < e.length))
				for (var n = e.length - 1; 0 <= n; n--) {
					var r = e[n];
					if (!r) break;
					i.push(r.clone());
				}
			var o = new cc.Animation(i, t.getDelayPerUnit(), t.getLoops());
			o.setRestoreOriginalFrame(t.getRestoreOriginalFrame());
			o = new cc.Animate(o);
			return this._cloneDecoration(o), this._reverseEaseList(o), o;
		},
		stop: function () {
			this._animation.getRestoreOriginalFrame() &&
				this.target &&
				this.target.setSpriteFrame(this._origFrame),
				cc.Action.prototype.stop.call(this);
		},
	})),
	(cc.animate = function (t) {
		return new cc.Animate(t);
	}),
	(cc.Animate.create = cc.animate),
	(cc.TargetedAction = cc.ActionInterval.extend({
		_action: null,
		_forcedTarget: null,
		ctor: function (t, e) {
			cc.ActionInterval.prototype.ctor.call(this),
				e && this.initWithTarget(t, e);
		},
		initWithTarget: function (t, e) {
			return (
				!!this.initWithDuration(e._duration) &&
				((this._forcedTarget = t), (this._action = e), !0)
			);
		},
		clone: function () {
			var t = new cc.TargetedAction();
			return (
				this._cloneDecoration(t),
				t.initWithTarget(this._forcedTarget, this._action.clone()),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				this._action.startWithTarget(this._forcedTarget);
		},
		stop: function () {
			this._action.stop();
		},
		update: function (t) {
			(t = this._computeEaseTime(t)), this._action.update(t);
		},
		getForcedTarget: function () {
			return this._forcedTarget;
		},
		setForcedTarget: function (t) {
			this._forcedTarget !== t && (this._forcedTarget = t);
		},
	})),
	(cc.targetedAction = function (t, e) {
		return new cc.TargetedAction(t, e);
	}),
	(cc.TargetedAction.create = cc.targetedAction),
	(cc.ActionInstant = cc.FiniteTimeAction.extend({
		isDone: function () {
			return !0;
		},
		step: function (t) {
			this.update(1);
		},
		update: function (t) {},
		reverse: function () {
			return this.clone();
		},
		clone: function () {
			return new cc.ActionInstant();
		},
	})),
	(cc.Show = cc.ActionInstant.extend({
		update: function (t) {
			this.target.visible = !0;
		},
		reverse: function () {
			return new cc.Hide();
		},
		clone: function () {
			return new cc.Show();
		},
	})),
	(cc.show = function () {
		return new cc.Show();
	}),
	(cc.Show.create = cc.show),
	(cc.Hide = cc.ActionInstant.extend({
		update: function (t) {
			this.target.visible = !1;
		},
		reverse: function () {
			return new cc.Show();
		},
		clone: function () {
			return new cc.Hide();
		},
	})),
	(cc.hide = function () {
		return new cc.Hide();
	}),
	(cc.Hide.create = cc.hide),
	(cc.ToggleVisibility = cc.ActionInstant.extend({
		update: function (t) {
			this.target.visible = !this.target.visible;
		},
		reverse: function () {
			return new cc.ToggleVisibility();
		},
		clone: function () {
			return new cc.ToggleVisibility();
		},
	})),
	(cc.toggleVisibility = function () {
		return new cc.ToggleVisibility();
	}),
	(cc.ToggleVisibility.create = cc.toggleVisibility),
	(cc.RemoveSelf = cc.ActionInstant.extend({
		_isNeedCleanUp: !0,
		ctor: function (t) {
			cc.FiniteTimeAction.prototype.ctor.call(this),
				void 0 !== t && this.init(t);
		},
		update: function (t) {
			this.target.removeFromParent(this._isNeedCleanUp);
		},
		init: function (t) {
			return (this._isNeedCleanUp = t), !0;
		},
		reverse: function () {
			return new cc.RemoveSelf(this._isNeedCleanUp);
		},
		clone: function () {
			return new cc.RemoveSelf(this._isNeedCleanUp);
		},
	})),
	(cc.removeSelf = function (t) {
		return new cc.RemoveSelf(t);
	}),
	(cc.RemoveSelf.create = cc.removeSelf),
	(cc.FlipX = cc.ActionInstant.extend({
		_flippedX: !1,
		ctor: function (t) {
			cc.FiniteTimeAction.prototype.ctor.call(this),
				(this._flippedX = !1),
				void 0 !== t && this.initWithFlipX(t);
		},
		initWithFlipX: function (t) {
			return (this._flippedX = t), !0;
		},
		update: function (t) {
			this.target.flippedX = this._flippedX;
		},
		reverse: function () {
			return new cc.FlipX(!this._flippedX);
		},
		clone: function () {
			var t = new cc.FlipX();
			return t.initWithFlipX(this._flippedX), t;
		},
	})),
	(cc.flipX = function (t) {
		return new cc.FlipX(t);
	}),
	(cc.FlipX.create = cc.flipX),
	(cc.FlipY = cc.ActionInstant.extend({
		_flippedY: !1,
		ctor: function (t) {
			cc.FiniteTimeAction.prototype.ctor.call(this),
				(this._flippedY = !1),
				void 0 !== t && this.initWithFlipY(t);
		},
		initWithFlipY: function (t) {
			return (this._flippedY = t), !0;
		},
		update: function (t) {
			this.target.flippedY = this._flippedY;
		},
		reverse: function () {
			return new cc.FlipY(!this._flippedY);
		},
		clone: function () {
			var t = new cc.FlipY();
			return t.initWithFlipY(this._flippedY), t;
		},
	})),
	(cc.flipY = function (t) {
		return new cc.FlipY(t);
	}),
	(cc.FlipY.create = cc.flipY),
	(cc.Place = cc.ActionInstant.extend({
		_x: 0,
		_y: 0,
		ctor: function (t, e) {
			cc.FiniteTimeAction.prototype.ctor.call(this),
				(this._x = 0),
				void (this._y = 0) !== t &&
					(void 0 !== t.x && ((e = t.y), (t = t.x)),
					this.initWithPosition(t, e));
		},
		initWithPosition: function (t, e) {
			return (this._x = t), (this._y = e), !0;
		},
		update: function (t) {
			this.target.setPosition(this._x, this._y);
		},
		clone: function () {
			var t = new cc.Place();
			return t.initWithPosition(this._x, this._y), t;
		},
	})),
	(cc.place = function (t, e) {
		return new cc.Place(t, e);
	}),
	(cc.Place.create = cc.place),
	(cc.CallFunc = cc.ActionInstant.extend({
		_selectorTarget: null,
		_function: null,
		_data: null,
		ctor: function (t, e, i) {
			cc.FiniteTimeAction.prototype.ctor.call(this),
				this.initWithFunction(t, e, i);
		},
		initWithFunction: function (t, e, i) {
			return (
				t && (this._function = t),
				e && (this._selectorTarget = e),
				void 0 !== i && (this._data = i),
				!0
			);
		},
		execute: function () {
			this._function &&
				this._function.call(
					this._selectorTarget,
					this.target,
					this._data
				);
		},
		update: function (t) {
			this.execute();
		},
		getTargetCallback: function () {
			return this._selectorTarget;
		},
		setTargetCallback: function (t) {
			t !== this._selectorTarget &&
				(this._selectorTarget && (this._selectorTarget = null),
				(this._selectorTarget = t));
		},
		clone: function () {
			var t = new cc.CallFunc();
			return (
				t.initWithFunction(
					this._function,
					this._selectorTarget,
					this._data
				),
				t
			);
		},
	})),
	(cc.callFunc = function (t, e, i) {
		return new cc.CallFunc(t, e, i);
	}),
	(cc.CallFunc.create = cc.callFunc),
	(cc.ActionEase = cc.ActionInterval.extend({
		_inner: null,
		ctor: function (t) {
			cc.ActionInterval.prototype.ctor.call(this),
				t && this.initWithAction(t);
		},
		initWithAction: function (t) {
			if (!t)
				throw new Error(
					'cc.ActionEase.initWithAction(): action must be non nil'
				);
			return (
				!!this.initWithDuration(t.getDuration()) &&
				((this._inner = t), !0)
			);
		},
		clone: function () {
			var t = new cc.ActionEase();
			return t.initWithAction(this._inner.clone()), t;
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				this._inner.startWithTarget(this.target);
		},
		stop: function () {
			this._inner.stop(), cc.ActionInterval.prototype.stop.call(this);
		},
		update: function (t) {
			this._inner.update(t);
		},
		reverse: function () {
			return new cc.ActionEase(this._inner.reverse());
		},
		getInnerAction: function () {
			return this._inner;
		},
	})),
	(cc.actionEase = function (t) {
		return new cc.ActionEase(t);
	}),
	(cc.ActionEase.create = cc.actionEase),
	(cc.EaseRateAction = cc.ActionEase.extend({
		_rate: 0,
		ctor: function (t, e) {
			cc.ActionEase.prototype.ctor.call(this),
				void 0 !== e && this.initWithAction(t, e);
		},
		setRate: function (t) {
			this._rate = t;
		},
		getRate: function () {
			return this._rate;
		},
		initWithAction: function (t, e) {
			return (
				!!cc.ActionEase.prototype.initWithAction.call(this, t) &&
				((this._rate = e), !0)
			);
		},
		clone: function () {
			var t = new cc.EaseRateAction();
			return t.initWithAction(this._inner.clone(), this._rate), t;
		},
		reverse: function () {
			return new cc.EaseRateAction(this._inner.reverse(), 1 / this._rate);
		},
	})),
	(cc.easeRateAction = function (t, e) {
		return new cc.EaseRateAction(t, e);
	}),
	(cc.EaseRateAction.create = cc.easeRateAction),
	(cc.EaseIn = cc.EaseRateAction.extend({
		update: function (t) {
			this._inner.update(Math.pow(t, this._rate));
		},
		reverse: function () {
			return new cc.EaseIn(this._inner.reverse(), 1 / this._rate);
		},
		clone: function () {
			var t = new cc.EaseIn();
			return t.initWithAction(this._inner.clone(), this._rate), t;
		},
	})),
	(cc.EaseIn.create = function (t, e) {
		return new cc.EaseIn(t, e);
	}),
	(cc.easeIn = function (t) {
		return {
			_rate: t,
			easing: function (t) {
				return Math.pow(t, this._rate);
			},
			reverse: function () {
				return cc.easeIn(1 / this._rate);
			},
		};
	}),
	(cc.EaseOut = cc.EaseRateAction.extend({
		update: function (t) {
			this._inner.update(Math.pow(t, 1 / this._rate));
		},
		reverse: function () {
			return new cc.EaseOut(this._inner.reverse(), 1 / this._rate);
		},
		clone: function () {
			var t = new cc.EaseOut();
			return t.initWithAction(this._inner.clone(), this._rate), t;
		},
	})),
	(cc.EaseOut.create = function (t, e) {
		return new cc.EaseOut(t, e);
	}),
	(cc.easeOut = function (t) {
		return {
			_rate: t,
			easing: function (t) {
				return Math.pow(t, 1 / this._rate);
			},
			reverse: function () {
				return cc.easeOut(1 / this._rate);
			},
		};
	}),
	(cc.EaseInOut = cc.EaseRateAction.extend({
		update: function (t) {
			(t *= 2) < 1
				? this._inner.update(0.5 * Math.pow(t, this._rate))
				: this._inner.update(1 - 0.5 * Math.pow(2 - t, this._rate));
		},
		clone: function () {
			var t = new cc.EaseInOut();
			return t.initWithAction(this._inner.clone(), this._rate), t;
		},
		reverse: function () {
			return new cc.EaseInOut(this._inner.reverse(), this._rate);
		},
	})),
	(cc.EaseInOut.create = function (t, e) {
		return new cc.EaseInOut(t, e);
	}),
	(cc.easeInOut = function (t) {
		return {
			_rate: t,
			easing: function (t) {
				return (t *= 2) < 1
					? 0.5 * Math.pow(t, this._rate)
					: 1 - 0.5 * Math.pow(2 - t, this._rate);
			},
			reverse: function () {
				return cc.easeInOut(this._rate);
			},
		};
	}),
	(cc.EaseExponentialIn = cc.ActionEase.extend({
		update: function (t) {
			this._inner.update(0 === t ? 0 : Math.pow(2, 10 * (t - 1)));
		},
		reverse: function () {
			return new cc.EaseExponentialOut(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseExponentialIn();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseExponentialIn.create = function (t) {
		return new cc.EaseExponentialIn(t);
	}),
	(cc._easeExponentialInObj = {
		easing: function (t) {
			return 0 === t ? 0 : Math.pow(2, 10 * (t - 1));
		},
		reverse: function () {
			return cc._easeExponentialOutObj;
		},
	}),
	(cc.easeExponentialIn = function () {
		return cc._easeExponentialInObj;
	}),
	(cc.EaseExponentialOut = cc.ActionEase.extend({
		update: function (t) {
			this._inner.update(1 === t ? 1 : 1 - Math.pow(2, -10 * t));
		},
		reverse: function () {
			return new cc.EaseExponentialIn(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseExponentialOut();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseExponentialOut.create = function (t) {
		return new cc.EaseExponentialOut(t);
	}),
	(cc._easeExponentialOutObj = {
		easing: function (t) {
			return 1 === t ? 1 : 1 - Math.pow(2, -10 * t);
		},
		reverse: function () {
			return cc._easeExponentialInObj;
		},
	}),
	(cc.easeExponentialOut = function () {
		return cc._easeExponentialOutObj;
	}),
	(cc.EaseExponentialInOut = cc.ActionEase.extend({
		update: function (t) {
			1 !== t &&
				0 !== t &&
				(t =
					(t *= 2) < 1
						? 0.5 * Math.pow(2, 10 * (t - 1))
						: 0.5 * (2 - Math.pow(2, -10 * (t - 1)))),
				this._inner.update(t);
		},
		reverse: function () {
			return new cc.EaseExponentialInOut(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseExponentialInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseExponentialInOut.create = function (t) {
		return new cc.EaseExponentialInOut(t);
	}),
	(cc._easeExponentialInOutObj = {
		easing: function (t) {
			return 1 !== t && 0 !== t
				? (t *= 2) < 1
					? 0.5 * Math.pow(2, 10 * (t - 1))
					: 0.5 * (2 - Math.pow(2, -10 * (t - 1)))
				: t;
		},
		reverse: function () {
			return cc._easeExponentialInOutObj;
		},
	}),
	(cc.easeExponentialInOut = function () {
		return cc._easeExponentialInOutObj;
	}),
	(cc.EaseSineIn = cc.ActionEase.extend({
		update: function (t) {
			(t = 0 === t || 1 === t ? t : -1 * Math.cos((t * Math.PI) / 2) + 1),
				this._inner.update(t);
		},
		reverse: function () {
			return new cc.EaseSineOut(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseSineIn();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseSineIn.create = function (t) {
		return new cc.EaseSineIn(t);
	}),
	(cc._easeSineInObj = {
		easing: function (t) {
			return 0 === t || 1 === t
				? t
				: -1 * Math.cos((t * Math.PI) / 2) + 1;
		},
		reverse: function () {
			return cc._easeSineOutObj;
		},
	}),
	(cc.easeSineIn = function () {
		return cc._easeSineInObj;
	}),
	(cc.EaseSineOut = cc.ActionEase.extend({
		update: function (t) {
			(t = 0 === t || 1 === t ? t : Math.sin((t * Math.PI) / 2)),
				this._inner.update(t);
		},
		reverse: function () {
			return new cc.EaseSineIn(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseSineOut();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseSineOut.create = function (t) {
		return new cc.EaseSineOut(t);
	}),
	(cc._easeSineOutObj = {
		easing: function (t) {
			return 0 === t || 1 === t ? t : Math.sin((t * Math.PI) / 2);
		},
		reverse: function () {
			return cc._easeSineInObj;
		},
	}),
	(cc.easeSineOut = function () {
		return cc._easeSineOutObj;
	}),
	(cc.EaseSineInOut = cc.ActionEase.extend({
		update: function (t) {
			(t = 0 === t || 1 === t ? t : -0.5 * (Math.cos(Math.PI * t) - 1)),
				this._inner.update(t);
		},
		clone: function () {
			var t = new cc.EaseSineInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseSineInOut(this._inner.reverse());
		},
	})),
	(cc.EaseSineInOut.create = function (t) {
		return new cc.EaseSineInOut(t);
	}),
	(cc._easeSineInOutObj = {
		easing: function (t) {
			return 0 === t || 1 === t ? t : -0.5 * (Math.cos(Math.PI * t) - 1);
		},
		reverse: function () {
			return cc._easeSineInOutObj;
		},
	}),
	(cc.easeSineInOut = function () {
		return cc._easeSineInOutObj;
	}),
	(cc.EaseElastic = cc.ActionEase.extend({
		_period: 0.3,
		ctor: function (t, e) {
			cc.ActionEase.prototype.ctor.call(this),
				t && this.initWithAction(t, e);
		},
		getPeriod: function () {
			return this._period;
		},
		setPeriod: function (t) {
			this._period = t;
		},
		initWithAction: function (t, e) {
			return (
				cc.ActionEase.prototype.initWithAction.call(this, t),
				(this._period = null == e ? 0.3 : e),
				!0
			);
		},
		reverse: function () {
			return (
				cc.log(
					'cc.EaseElastic.reverse(): it should be overridden in subclass.'
				),
				null
			);
		},
		clone: function () {
			var t = new cc.EaseElastic();
			return t.initWithAction(this._inner.clone(), this._period), t;
		},
	})),
	(cc.EaseElastic.create = function (t, e) {
		return new cc.EaseElastic(t, e);
	}),
	(cc.EaseElasticIn = cc.EaseElastic.extend({
		update: function (t) {
			var e,
				i = 0,
				i =
					0 === t || 1 === t
						? t
						: ((e = this._period / 4),
						  --t,
						  -Math.pow(2, 10 * t) *
								Math.sin(
									((t - e) * Math.PI * 2) / this._period
								));
			this._inner.update(i);
		},
		reverse: function () {
			return new cc.EaseElasticOut(this._inner.reverse(), this._period);
		},
		clone: function () {
			var t = new cc.EaseElasticIn();
			return t.initWithAction(this._inner.clone(), this._period), t;
		},
	})),
	(cc.EaseElasticIn.create = function (t, e) {
		return new cc.EaseElasticIn(t, e);
	}),
	(cc._easeElasticInObj = {
		easing: function (t) {
			return 0 === t || 1 === t
				? t
				: (--t,
				  -Math.pow(2, 10 * t) *
						Math.sin(((t - 0.075) * Math.PI * 2) / 0.3));
		},
		reverse: function () {
			return cc._easeElasticOutObj;
		},
	}),
	(cc.easeElasticIn = function (t) {
		return t && 0.3 !== t
			? {
					_period: t,
					easing: function (t) {
						return 0 === t || 1 === t
							? t
							: (--t,
							  -Math.pow(2, 10 * t) *
									Math.sin(
										((t - this._period / 4) * Math.PI * 2) /
											this._period
									));
					},
					reverse: function () {
						return cc.easeElasticOut(this._period);
					},
			  }
			: cc._easeElasticInObj;
	}),
	(cc.EaseElasticOut = cc.EaseElastic.extend({
		update: function (t) {
			var e,
				i = 0;
			(i =
				0 === t || 1 === t
					? t
					: ((e = this._period / 4),
					  Math.pow(2, -10 * t) *
							Math.sin(((t - e) * Math.PI * 2) / this._period) +
							1)),
				this._inner.update(i);
		},
		reverse: function () {
			return new cc.EaseElasticIn(this._inner.reverse(), this._period);
		},
		clone: function () {
			var t = new cc.EaseElasticOut();
			return t.initWithAction(this._inner.clone(), this._period), t;
		},
	})),
	(cc.EaseElasticOut.create = function (t, e) {
		return new cc.EaseElasticOut(t, e);
	}),
	(cc._easeElasticOutObj = {
		easing: function (t) {
			return 0 === t || 1 === t
				? t
				: Math.pow(2, -10 * t) *
						Math.sin(((t - 0.075) * Math.PI * 2) / 0.3) +
						1;
		},
		reverse: function () {
			return cc._easeElasticInObj;
		},
	}),
	(cc.easeElasticOut = function (t) {
		return t && 0.3 !== t
			? {
					_period: t,
					easing: function (t) {
						return 0 === t || 1 === t
							? t
							: Math.pow(2, -10 * t) *
									Math.sin(
										((t - this._period / 4) * Math.PI * 2) /
											this._period
									) +
									1;
					},
					reverse: function () {
						return cc.easeElasticIn(this._period);
					},
			  }
			: cc._easeElasticOutObj;
	}),
	(cc.EaseElasticInOut = cc.EaseElastic.extend({
		update: function (t) {
			var e,
				i = 0,
				n = this._period;
			(i =
				0 === t || 1 === t
					? t
					: ((t *= 2),
					  (e = (n = n || (this._period = 0.3 * 1.5)) / 4),
					  --t < 0
							? -0.5 *
							  Math.pow(2, 10 * t) *
							  Math.sin(((t - e) * Math.PI * 2) / n)
							: Math.pow(2, -10 * t) *
									Math.sin(((t - e) * Math.PI * 2) / n) *
									0.5 +
							  1)),
				this._inner.update(i);
		},
		reverse: function () {
			return new cc.EaseElasticInOut(this._inner.reverse(), this._period);
		},
		clone: function () {
			var t = new cc.EaseElasticInOut();
			return t.initWithAction(this._inner.clone(), this._period), t;
		},
	})),
	(cc.EaseElasticInOut.create = function (t, e) {
		return new cc.EaseElasticInOut(t, e);
	}),
	(cc.easeElasticInOut = function (t) {
		return {
			_period: (t = t || 0.3),
			easing: function (t) {
				var e,
					i = this._period;
				return 0 === t || 1 === t
					? t
					: ((t *= 2),
					  (e = (i = i || (this._period = 0.3 * 1.5)) / 4),
					  --t < 0
							? -0.5 *
							  Math.pow(2, 10 * t) *
							  Math.sin(((t - e) * Math.PI * 2) / i)
							: Math.pow(2, -10 * t) *
									Math.sin(((t - e) * Math.PI * 2) / i) *
									0.5 +
							  1);
			},
			reverse: function () {
				return cc.easeElasticInOut(this._period);
			},
		};
	}),
	(cc.EaseBounce = cc.ActionEase.extend({
		bounceTime: function (t) {
			return t < 1 / 2.75
				? 7.5625 * t * t
				: t < 2 / 2.75
				? 7.5625 * (t -= 1.5 / 2.75) * t + 0.75
				: t < 2.5 / 2.75
				? 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375
				: 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375;
		},
		clone: function () {
			var t = new cc.EaseBounce();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseBounce(this._inner.reverse());
		},
	})),
	(cc.EaseBounce.create = function (t) {
		return new cc.EaseBounce(t);
	}),
	(cc.EaseBounceIn = cc.EaseBounce.extend({
		update: function (t) {
			t = 1 - this.bounceTime(1 - t);
			this._inner.update(t);
		},
		reverse: function () {
			return new cc.EaseBounceOut(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseBounceIn();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseBounceIn.create = function (t) {
		return new cc.EaseBounceIn(t);
	}),
	(cc._bounceTime = function (t) {
		return t < 1 / 2.75
			? 7.5625 * t * t
			: t < 2 / 2.75
			? 7.5625 * (t -= 1.5 / 2.75) * t + 0.75
			: t < 2.5 / 2.75
			? 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375
			: 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375;
	}),
	(cc._easeBounceInObj = {
		easing: function (t) {
			return 1 - cc._bounceTime(1 - t);
		},
		reverse: function () {
			return cc._easeBounceOutObj;
		},
	}),
	(cc.easeBounceIn = function () {
		return cc._easeBounceInObj;
	}),
	(cc.EaseBounceOut = cc.EaseBounce.extend({
		update: function (t) {
			t = this.bounceTime(t);
			this._inner.update(t);
		},
		reverse: function () {
			return new cc.EaseBounceIn(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseBounceOut();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseBounceOut.create = function (t) {
		return new cc.EaseBounceOut(t);
	}),
	(cc._easeBounceOutObj = {
		easing: function (t) {
			return cc._bounceTime(t);
		},
		reverse: function () {
			return cc._easeBounceInObj;
		},
	}),
	(cc.easeBounceOut = function () {
		return cc._easeBounceOutObj;
	}),
	(cc.EaseBounceInOut = cc.EaseBounce.extend({
		update: function (t) {
			var e = 0,
				e =
					t < 0.5
						? ((t *= 2), 0.5 * (1 - this.bounceTime(1 - t)))
						: 0.5 * this.bounceTime(2 * t - 1) + 0.5;
			this._inner.update(e);
		},
		clone: function () {
			var t = new cc.EaseBounceInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseBounceInOut(this._inner.reverse());
		},
	})),
	(cc.EaseBounceInOut.create = function (t) {
		return new cc.EaseBounceInOut(t);
	}),
	(cc._easeBounceInOutObj = {
		easing: function (t) {
			t =
				t < 0.5
					? ((t *= 2), 0.5 * (1 - cc._bounceTime(1 - t)))
					: 0.5 * cc._bounceTime(2 * t - 1) + 0.5;
			return t;
		},
		reverse: function () {
			return cc._easeBounceInOutObj;
		},
	}),
	(cc.easeBounceInOut = function () {
		return cc._easeBounceInOutObj;
	}),
	(cc.EaseBackIn = cc.ActionEase.extend({
		update: function (t) {
			(t = 0 === t || 1 === t ? t : t * t * (2.70158 * t - 1.70158)),
				this._inner.update(t);
		},
		reverse: function () {
			return new cc.EaseBackOut(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseBackIn();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseBackIn.create = function (t) {
		return new cc.EaseBackIn(t);
	}),
	(cc._easeBackInObj = {
		easing: function (t) {
			return 0 === t || 1 === t ? t : t * t * (2.70158 * t - 1.70158);
		},
		reverse: function () {
			return cc._easeBackOutObj;
		},
	}),
	(cc.easeBackIn = function () {
		return cc._easeBackInObj;
	}),
	(cc.EaseBackOut = cc.ActionEase.extend({
		update: function (t) {
			--t, this._inner.update(t * t * (2.70158 * t + 1.70158) + 1);
		},
		reverse: function () {
			return new cc.EaseBackIn(this._inner.reverse());
		},
		clone: function () {
			var t = new cc.EaseBackOut();
			return t.initWithAction(this._inner.clone()), t;
		},
	})),
	(cc.EaseBackOut.create = function (t) {
		return new cc.EaseBackOut(t);
	}),
	(cc._easeBackOutObj = {
		easing: function (t) {
			return --t * t * (2.70158 * t + 1.70158) + 1;
		},
		reverse: function () {
			return cc._easeBackInObj;
		},
	}),
	(cc.easeBackOut = function () {
		return cc._easeBackOutObj;
	}),
	(cc.EaseBackInOut = cc.ActionEase.extend({
		update: function (t) {
			var e = 2.5949095;
			(t *= 2) < 1
				? this._inner.update((t * t * ((1 + e) * t - e)) / 2)
				: ((t -= 2),
				  this._inner.update((t * t * ((1 + e) * t + e)) / 2 + 1));
		},
		clone: function () {
			var t = new cc.EaseBackInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseBackInOut(this._inner.reverse());
		},
	})),
	(cc.EaseBackInOut.create = function (t) {
		return new cc.EaseBackInOut(t);
	}),
	(cc._easeBackInOutObj = {
		easing: function (t) {
			var e = 2.5949095;
			return (t *= 2) < 1
				? (t * t * ((1 + e) * t - e)) / 2
				: ((t -= 2) * t * ((1 + e) * t + e)) / 2 + 1;
		},
		reverse: function () {
			return cc._easeBackInOutObj;
		},
	}),
	(cc.easeBackInOut = function () {
		return cc._easeBackInOutObj;
	}),
	(cc.EaseBezierAction = cc.ActionEase.extend({
		_p0: null,
		_p1: null,
		_p2: null,
		_p3: null,
		ctor: function (t) {
			cc.ActionEase.prototype.ctor.call(this, t);
		},
		_updateTime: function (t, e, i, n, r) {
			return (
				Math.pow(1 - r, 3) * t +
				3 * r * Math.pow(1 - r, 2) * e +
				3 * Math.pow(r, 2) * (1 - r) * i +
				Math.pow(r, 3) * n
			);
		},
		update: function (t) {
			t = this._updateTime(this._p0, this._p1, this._p2, this._p3, t);
			this._inner.update(t);
		},
		clone: function () {
			var t = new cc.EaseBezierAction();
			return (
				t.initWithAction(this._inner.clone()),
				t.setBezierParamer(this._p0, this._p1, this._p2, this._p3),
				t
			);
		},
		reverse: function () {
			var t = new cc.EaseBezierAction(this._inner.reverse());
			return (
				t.setBezierParamer(this._p3, this._p2, this._p1, this._p0), t
			);
		},
		setBezierParamer: function (t, e, i, n) {
			(this._p0 = t || 0),
				(this._p1 = e || 0),
				(this._p2 = i || 0),
				(this._p3 = n || 0);
		},
	})),
	(cc.EaseBezierAction.create = function (t) {
		return new cc.EaseBezierAction(t);
	}),
	(cc.easeBezierAction = function (e, i, n, r) {
		return {
			easing: function (t) {
				return cc.EaseBezierAction.prototype._updateTime(e, i, n, r, t);
			},
			reverse: function () {
				return cc.easeBezierAction(r, n, i, e);
			},
		};
	}),
	(cc.EaseQuadraticActionIn = cc.ActionEase.extend({
		_updateTime: function (t) {
			return Math.pow(t, 2);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuadraticActionIn();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuadraticActionIn(this._inner.reverse());
		},
	})),
	(cc.EaseQuadraticActionIn.create = function (t) {
		return new cc.EaseQuadraticActionIn(t);
	}),
	(cc._easeQuadraticActionIn = {
		easing: cc.EaseQuadraticActionIn.prototype._updateTime,
		reverse: function () {
			return cc._easeQuadraticActionIn;
		},
	}),
	(cc.easeQuadraticActionIn = function () {
		return cc._easeQuadraticActionIn;
	}),
	(cc.EaseQuadraticActionOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return -t * (t - 2);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuadraticActionOut();
			return t.initWithAction(), t;
		},
		reverse: function () {
			return new cc.EaseQuadraticActionOut(this._inner.reverse());
		},
	})),
	(cc.EaseQuadraticActionOut.create = function (t) {
		return new cc.EaseQuadraticActionOut(t);
	}),
	(cc._easeQuadraticActionOut = {
		easing: cc.EaseQuadraticActionOut.prototype._updateTime,
		reverse: function () {
			return cc._easeQuadraticActionOut;
		},
	}),
	(cc.easeQuadraticActionOut = function () {
		return cc._easeQuadraticActionOut;
	}),
	(cc.EaseQuadraticActionInOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return (t *= 2) < 1 ? t * t * 0.5 : -0.5 * (--t * (t - 2) - 1);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuadraticActionInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuadraticActionInOut(this._inner.reverse());
		},
	})),
	(cc.EaseQuadraticActionInOut.create = function (t) {
		return new cc.EaseQuadraticActionInOut(t);
	}),
	(cc._easeQuadraticActionInOut = {
		easing: cc.EaseQuadraticActionInOut.prototype._updateTime,
		reverse: function () {
			return cc._easeQuadraticActionInOut;
		},
	}),
	(cc.easeQuadraticActionInOut = function () {
		return cc._easeQuadraticActionInOut;
	}),
	(cc.EaseQuarticActionIn = cc.ActionEase.extend({
		_updateTime: function (t) {
			return t * t * t * t;
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuarticActionIn();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuarticActionIn(this._inner.reverse());
		},
	})),
	(cc.EaseQuarticActionIn.create = function (t) {
		return new cc.EaseQuarticActionIn(t);
	}),
	(cc._easeQuarticActionIn = {
		easing: cc.EaseQuarticActionIn.prototype._updateTime,
		reverse: function () {
			return cc._easeQuarticActionIn;
		},
	}),
	(cc.easeQuarticActionIn = function () {
		return cc._easeQuarticActionIn;
	}),
	(cc.EaseQuarticActionOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return -(--t * t * t * t - 1);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuarticActionOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuarticActionOut(this._inner.reverse());
		},
	})),
	(cc.EaseQuarticActionOut.create = function (t) {
		return new cc.EaseQuarticActionOut(t);
	}),
	(cc._easeQuarticActionOut = {
		easing: cc.EaseQuarticActionOut.prototype._updateTime,
		reverse: function () {
			return cc._easeQuarticActionOut;
		},
	}),
	(cc.easeQuarticActionOut = function () {
		return cc._easeQuarticActionOut;
	}),
	(cc.EaseQuarticActionInOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return (t *= 2) < 1
				? 0.5 * t * t * t * t
				: -0.5 * ((t -= 2) * t * t * t - 2);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuarticActionInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuarticActionInOut(this._inner.reverse());
		},
	})),
	(cc.EaseQuarticActionInOut.create = function (t) {
		return new cc.EaseQuarticActionInOut(t);
	}),
	(cc._easeQuarticActionInOut = {
		easing: cc.EaseQuarticActionInOut.prototype._updateTime,
		reverse: function () {
			return cc._easeQuarticActionInOut;
		},
	}),
	(cc.easeQuarticActionInOut = function () {
		return cc._easeQuarticActionInOut;
	}),
	(cc.EaseQuinticActionIn = cc.ActionEase.extend({
		_updateTime: function (t) {
			return t * t * t * t * t;
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuinticActionIn();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuinticActionIn(this._inner.reverse());
		},
	})),
	(cc.EaseQuinticActionIn.create = function (t) {
		return new cc.EaseQuinticActionIn(t);
	}),
	(cc._easeQuinticActionIn = {
		easing: cc.EaseQuinticActionIn.prototype._updateTime,
		reverse: function () {
			return cc._easeQuinticActionIn;
		},
	}),
	(cc.easeQuinticActionIn = function () {
		return cc._easeQuinticActionIn;
	}),
	(cc.EaseQuinticActionOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return --t * t * t * t * t + 1;
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuinticActionOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuinticActionOut(this._inner.reverse());
		},
	})),
	(cc.EaseQuinticActionOut.create = function (t) {
		return new cc.EaseQuinticActionOut(t);
	}),
	(cc._easeQuinticActionOut = {
		easing: cc.EaseQuinticActionOut.prototype._updateTime,
		reverse: function () {
			return cc._easeQuinticActionOut;
		},
	}),
	(cc.easeQuinticActionOut = function () {
		return cc._easeQuinticActionOut;
	}),
	(cc.EaseQuinticActionInOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return (t *= 2) < 1
				? 0.5 * t * t * t * t * t
				: 0.5 * ((t -= 2) * t * t * t * t + 2);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseQuinticActionInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseQuinticActionInOut(this._inner.reverse());
		},
	})),
	(cc.EaseQuinticActionInOut.create = function (t) {
		return new cc.EaseQuinticActionInOut(t);
	}),
	(cc._easeQuinticActionInOut = {
		easing: cc.EaseQuinticActionInOut.prototype._updateTime,
		reverse: function () {
			return cc._easeQuinticActionInOut;
		},
	}),
	(cc.easeQuinticActionInOut = function () {
		return cc._easeQuinticActionInOut;
	}),
	(cc.EaseCircleActionIn = cc.ActionEase.extend({
		_updateTime: function (t) {
			return -1 * (Math.sqrt(1 - t * t) - 1);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseCircleActionIn();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseCircleActionIn(this._inner.reverse());
		},
	})),
	(cc.EaseCircleActionIn.create = function (t) {
		return new cc.EaseCircleActionIn(t);
	}),
	(cc._easeCircleActionIn = {
		easing: cc.EaseCircleActionIn.prototype._updateTime,
		reverse: function () {
			return cc._easeCircleActionIn;
		},
	}),
	(cc.easeCircleActionIn = function () {
		return cc._easeCircleActionIn;
	}),
	(cc.EaseCircleActionOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return --t, Math.sqrt(1 - t * t);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseCircleActionOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseCircleActionOut(this._inner.reverse());
		},
	})),
	(cc.EaseCircleActionOut.create = function (t) {
		return new cc.EaseCircleActionOut(t);
	}),
	(cc._easeCircleActionOut = {
		easing: cc.EaseCircleActionOut.prototype._updateTime,
		reverse: function () {
			return cc._easeCircleActionOut;
		},
	}),
	(cc.easeCircleActionOut = function () {
		return cc._easeCircleActionOut;
	}),
	(cc.EaseCircleActionInOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return (t *= 2) < 1
				? -0.5 * (Math.sqrt(1 - t * t) - 1)
				: ((t -= 2), 0.5 * (Math.sqrt(1 - t * t) + 1));
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseCircleActionInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseCircleActionInOut(this._inner.reverse());
		},
	})),
	(cc.EaseCircleActionInOut.create = function (t) {
		return new cc.EaseCircleActionInOut(t);
	}),
	(cc._easeCircleActionInOut = {
		easing: cc.EaseCircleActionInOut.prototype._updateTime,
		reverse: function () {
			return cc._easeCircleActionInOut;
		},
	}),
	(cc.easeCircleActionInOut = function () {
		return cc._easeCircleActionInOut;
	}),
	(cc.EaseCubicActionIn = cc.ActionEase.extend({
		_updateTime: function (t) {
			return t * t * t;
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseCubicActionIn();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseCubicActionIn(this._inner.reverse());
		},
	})),
	(cc.EaseCubicActionIn.create = function (t) {
		return new cc.EaseCubicActionIn(t);
	}),
	(cc._easeCubicActionIn = {
		easing: cc.EaseCubicActionIn.prototype._updateTime,
		reverse: function () {
			return cc._easeCubicActionIn;
		},
	}),
	(cc.easeCubicActionIn = function () {
		return cc._easeCubicActionIn;
	}),
	(cc.EaseCubicActionOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return --t * t * t + 1;
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseCubicActionOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseCubicActionOut(this._inner.reverse());
		},
	})),
	(cc.EaseCubicActionOut.create = function (t) {
		return new cc.EaseCubicActionOut(t);
	}),
	(cc._easeCubicActionOut = {
		easing: cc.EaseCubicActionOut.prototype._updateTime,
		reverse: function () {
			return cc._easeCubicActionOut;
		},
	}),
	(cc.easeCubicActionOut = function () {
		return cc._easeCubicActionOut;
	}),
	(cc.EaseCubicActionInOut = cc.ActionEase.extend({
		_updateTime: function (t) {
			return (t *= 2) < 1
				? 0.5 * t * t * t
				: 0.5 * ((t -= 2) * t * t + 2);
		},
		update: function (t) {
			this._inner.update(this._updateTime(t));
		},
		clone: function () {
			var t = new cc.EaseCubicActionInOut();
			return t.initWithAction(this._inner.clone()), t;
		},
		reverse: function () {
			return new cc.EaseCubicActionInOut(this._inner.reverse());
		},
	})),
	(cc.EaseCubicActionInOut.create = function (t) {
		return new cc.EaseCubicActionInOut(t);
	}),
	(cc._easeCubicActionInOut = {
		easing: cc.EaseCubicActionInOut.prototype._updateTime,
		reverse: function () {
			return cc._easeCubicActionInOut;
		},
	}),
	(cc.easeCubicActionInOut = function () {
		return cc._easeCubicActionInOut;
	}),
	(cc.cardinalSplineAt = function (t, e, i, n, r, o) {
		var s = o * o,
			c = s * o,
			a = (1 - r) / 2,
			l = a * (2 * s - c - o),
			r = a * (s - c) + (2 * c - 3 * s + 1),
			o = a * (c - 2 * s + o) + (-2 * c + 3 * s),
			c = a * (c - s),
			s = t.x * l + e.x * r + i.x * o + n.x * c,
			c = t.y * l + e.y * r + i.y * o + n.y * c;
		return cc.p(s, c);
	}),
	(cc.reverseControlPoints = function (t) {
		for (var e = [], i = t.length - 1; 0 <= i; i--)
			e.push(cc.p(t[i].x, t[i].y));
		return e;
	}),
	(cc.cloneControlPoints = function (t) {
		for (var e = [], i = 0; i < t.length; i++) e.push(cc.p(t[i].x, t[i].y));
		return e;
	}),
	(cc.copyControlPoints = cc.cloneControlPoints),
	(cc.getControlPointAt = function (t, e) {
		return t[Math.min(t.length - 1, Math.max(e, 0))];
	}),
	(cc.reverseControlPointsInline = function (t) {
		for (var e = t.length, i = 0 | (e / 2), n = 0; n < i; ++n) {
			var r = t[n];
			(t[n] = t[e - n - 1]), (t[e - n - 1] = r);
		}
	}),
	(cc.CardinalSplineTo = cc.ActionInterval.extend({
		_points: null,
		_deltaT: 0,
		_tension: 0,
		_previousPosition: null,
		_accumulatedDiff: null,
		ctor: function (t, e, i) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._points = []),
				void 0 !== i && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			if (!e || 0 === e.length)
				throw new Error(
					'Invalid configuration. It must at least have one control point'
				);
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				(this.setPoints(e), (this._tension = i), !0)
			);
		},
		clone: function () {
			var t = new cc.CardinalSplineTo();
			return (
				t.initWithDuration(
					this._duration,
					cc.copyControlPoints(this._points),
					this._tension
				),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._deltaT = 1 / (this._points.length - 1)),
				(this._previousPosition = cc.p(
					this.target.getPositionX(),
					this.target.getPositionY()
				)),
				(this._accumulatedDiff = cc.p(0, 0));
		},
		update: function (t) {
			t = this._computeEaseTime(t);
			var e = this._points;
			t =
				1 === t
					? ((i = e.length - 1), 1)
					: (t - (n = this._deltaT) * (i = 0 | (t / n))) / n;
			var i,
				n = cc.cardinalSplineAt(
					cc.getControlPointAt(e, i - 1),
					cc.getControlPointAt(e, +i),
					cc.getControlPointAt(e, i + 1),
					cc.getControlPointAt(e, i + 2),
					this._tension,
					t
				);
			cc.ENABLE_STACKABLE_ACTIONS &&
				((e = this.target.getPositionX() - this._previousPosition.x),
				(i = this.target.getPositionY() - this._previousPosition.y),
				(0 == e && 0 === i) ||
					((e = (t = this._accumulatedDiff).x + e),
					(i = t.y + i),
					(t.x = e),
					(t.y = i),
					(n.x += e),
					(n.y += i))),
				this.updatePosition(n);
		},
		reverse: function () {
			var t = cc.reverseControlPoints(this._points);
			return cc.cardinalSplineTo(this._duration, t, this._tension);
		},
		updatePosition: function (t) {
			this.target.setPosition(t), (this._previousPosition = t);
		},
		getPoints: function () {
			return this._points;
		},
		setPoints: function (t) {
			this._points = t;
		},
	})),
	(cc.cardinalSplineTo = function (t, e, i) {
		return new cc.CardinalSplineTo(t, e, i);
	}),
	(cc.CardinalSplineTo.create = cc.cardinalSplineTo),
	(cc.CardinalSplineBy = cc.CardinalSplineTo.extend({
		_startPosition: null,
		ctor: function (t, e, i) {
			cc.CardinalSplineTo.prototype.ctor.call(this),
				(this._startPosition = cc.p(0, 0)),
				void 0 !== i && this.initWithDuration(t, e, i);
		},
		startWithTarget: function (t) {
			cc.CardinalSplineTo.prototype.startWithTarget.call(this, t),
				(this._startPosition.x = t.getPositionX()),
				(this._startPosition.y = t.getPositionY());
		},
		reverse: function () {
			for (
				var t, e = this._points.slice(), i = e[0], n = 1;
				n < e.length;
				++n
			)
				(t = e[n]), (e[n] = cc.pSub(t, i)), (i = t);
			var r = cc.reverseControlPoints(e),
				i = r[r.length - 1];
			r.pop(), (i.x = -i.x), (i.y = -i.y), r.unshift(i);
			for (n = 1; n < r.length; ++n)
				((t = r[n]).x = -t.x),
					(t.y = -t.y),
					(t.x += i.x),
					(t.y += i.y),
					(i = r[n] = t);
			return cc.cardinalSplineBy(this._duration, r, this._tension);
		},
		updatePosition: function (t) {
			var e = this._startPosition,
				i = t.x + e.x,
				e = t.y + e.y;
			(this._previousPosition.x = i),
				(this._previousPosition.y = e),
				this.target.setPosition(i, e);
		},
		clone: function () {
			var t = new cc.CardinalSplineBy();
			return (
				t.initWithDuration(
					this._duration,
					cc.copyControlPoints(this._points),
					this._tension
				),
				t
			);
		},
	})),
	(cc.cardinalSplineBy = function (t, e, i) {
		return new cc.CardinalSplineBy(t, e, i);
	}),
	(cc.CardinalSplineBy.create = cc.cardinalSplineBy),
	(cc.CatmullRomTo = cc.CardinalSplineTo.extend({
		ctor: function (t, e) {
			e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return cc.CardinalSplineTo.prototype.initWithDuration.call(
				this,
				t,
				e,
				0.5
			);
		},
		clone: function () {
			var t = new cc.CatmullRomTo();
			return (
				t.initWithDuration(
					this._duration,
					cc.copyControlPoints(this._points)
				),
				t
			);
		},
	})),
	(cc.catmullRomTo = function (t, e) {
		return new cc.CatmullRomTo(t, e);
	}),
	(cc.CatmullRomTo.create = cc.catmullRomTo),
	(cc.CatmullRomBy = cc.CardinalSplineBy.extend({
		ctor: function (t, e) {
			cc.CardinalSplineBy.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return cc.CardinalSplineTo.prototype.initWithDuration.call(
				this,
				t,
				e,
				0.5
			);
		},
		clone: function () {
			var t = new cc.CatmullRomBy();
			return (
				t.initWithDuration(
					this._duration,
					cc.copyControlPoints(this._points)
				),
				t
			);
		},
	})),
	(cc.catmullRomBy = function (t, e) {
		return new cc.CatmullRomBy(t, e);
	}),
	(cc.CatmullRomBy.create = cc.catmullRomBy),
	(cc.ActionTweenDelegate = cc.Class.extend({
		updateTweenAction: function (t, e) {},
	})),
	(cc.ActionTween = cc.ActionInterval.extend({
		key: '',
		from: 0,
		to: 0,
		delta: 0,
		ctor: function (t, e, i, n) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this.key = ''),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this.key = e), (this.to = n), (this.from = i), !0)
			);
		},
		startWithTarget: function (t) {
			if (!t || !t.updateTweenAction)
				throw new Error(
					'cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function'
				);
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this.delta = this.to - this.from);
		},
		update: function (t) {
			this.target.updateTweenAction(
				this.to - this.delta * (1 - t),
				this.key
			);
		},
		reverse: function () {
			return new cc.ActionTween(
				this.duration,
				this.key,
				this.to,
				this.from
			);
		},
		clone: function () {
			var t = new cc.ActionTween();
			return (
				t.initWithDuration(
					this._duration,
					this.key,
					this.from,
					this.to
				),
				t
			);
		},
	})),
	(cc.actionTween = function (t, e, i, n) {
		return new cc.ActionTween(t, e, i, n);
	}),
	(cc.ActionTween.create = cc.actionTween),
	(function () {
		var t = cc.sys,
			e =
				(t.browserVersion,
				{
					ONLY_ONE: !1,
					WEB_AUDIO: !!(
						window.AudioContext ||
						window.webkitAudioContext ||
						window.mozAudioContext
					),
					DELAY_CREATE_CTX: !1,
					ONE_SOURCE: !1,
				});
		t.browserType === t.BROWSER_TYPE_FIREFOX &&
			((e.DELAY_CREATE_CTX = !0), (e.USE_LOADER_EVENT = 'canplay')),
			t.os === t.OS_IOS && (e.USE_LOADER_EVENT = 'loadedmetadata'),
			t.os === t.OS_ANDROID &&
				t.browserType === t.BROWSER_TYPE_UC &&
				(e.ONE_SOURCE = !0),
			(window.__audioSupport = e);
	})(),
	(cc.Audio = cc.Class.extend({
		interruptPlay: !1,
		src: null,
		_element: null,
		_AUDIO_TYPE: 'AUDIO',
		ctor: function (t) {
			this.src = t;
		},
		setBuffer: function (t) {
			(this._AUDIO_TYPE = 'WEBAUDIO'),
				(this._element = new cc.Audio.WebAudio(t));
		},
		setElement: function (t) {
			(this._AUDIO_TYPE = 'AUDIO'),
				(this._element = t).addEventListener('ended', function () {
					t.loop || (t.paused = !0);
				});
		},
		play: function (t, e) {
			this._element
				? ((this._element.loop = e),
				  this._element.play(),
				  'AUDIO' === this._AUDIO_TYPE &&
						this._element.paused &&
						(this.stop(),
						cc.Audio.touchPlayList.push({
							loop: e,
							offset: t,
							audio: this._element,
						})),
				  !1 === cc.Audio.bindTouch &&
						((cc.Audio.bindTouch = !0),
						cc.game.canvas.addEventListener(
							'touchstart',
							cc.Audio.touchStart
						)))
				: (this.interruptPlay = !1);
		},
		getPlaying: function () {
			return !this._element || !this._element.paused;
		},
		getPlayingEnd: function () {
			return !this._element || this._element.currentTime;
		},
		stop: function () {
			if (this._element) {
				this._element.pause();
				try {
					this._element.currentTime = 0;
				} catch (t) {}
			} else this.interruptPlay = !0;
		},
		pause: function () {
			this._element ? this._element.pause() : (this.interruptPlay = !0);
		},
		resume: function () {
			this._element ? this._element.play() : (this.interruptPlay = !1);
		},
		setVolume: function (t) {
			this._element && (this._element.volume = t);
		},
		getVolume: function () {
			if (this._element) return this._element.volume;
		},
		cloneNode: function () {
			var t = new cc.Audio(this.src);
			if ('AUDIO' === this._AUDIO_TYPE) {
				for (
					var e = document.createElement('audio'),
						i = e.getElementsByTagName('source'),
						n = 0;
					n < i.length;
					n++
				)
					e.appendChild(i[n]);
				(e.src = this.src), t.setElement(e);
			} else t.setBuffer(this._element.buffer);
			return t;
		},
	})),
	(cc.Audio.touchPlayList = []),
	(cc.Audio.bindTouch = !1),
	(cc.Audio.touchStart = function () {
		for (var t = cc.Audio.touchPlayList, e = null; (e = t.pop()); )
			(e.audio.loop = !!e.loop), e.audio.play(e.offset);
	}),
	(cc.Audio.WebAudio = function (t) {
		(this.buffer = t), (this.context = cc.Audio._context);
		t = this.context.createGain();
		(t.gain.value = 1),
			t.connect(this.context.destination),
			(this._volume = t),
			(this._loop = !1),
			(this._startTime = -1),
			(this._currentSource = null),
			(this.playedLength = 0),
			(this._currextTimer = null);
	}),
	(cc.Audio.WebAudio.prototype = {
		constructor: cc.Audio.WebAudio,
		get paused() {
			return (
				(!this._currentSource || !this._currentSource.loop) &&
				(-1 === this._startTime ||
					this.context.currentTime - this._startTime >
						this.buffer.duration)
			);
		},
		set paused(t) {},
		get loop() {
			return this._loop;
		},
		set loop(t) {
			return (this._loop = t);
		},
		get volume() {
			return this._volume.gain.value;
		},
		set volume(t) {
			return (this._volume.gain.value = t);
		},
		get currentTime() {
			return this.playedLength;
		},
		set currentTime(t) {
			return (this.playedLength = t);
		},
		play: function (t) {
			this._currentSource &&
				!this.paused &&
				(this._currentSource.stop(0), (this.playedLength = 0));
			var e = this.context.createBufferSource();
			(e.buffer = this.buffer),
				e.connect(this._volume),
				(e.loop = this._loop),
				(this._startTime = this.context.currentTime),
				(t = t || this.playedLength);
			var i,
				n = this.buffer.duration;
			this._loop
				? e.start
					? e.start(0)
					: e.notoGrainOn
					? e.noteGrainOn(0)
					: e.noteOn(0)
				: e.start
				? e.start(0, t, n - t)
				: e.notoGrainOn
				? e.noteGrainOn(0, t, n - t)
				: e.noteOn(0, t, n - t),
				(this._currentSource = e),
				0 === this.context.currentTime &&
					((i = this),
					clearTimeout(this._currextTimer),
					(this._currextTimer = setTimeout(function () {
						0 === i.context.currentTime &&
							cc.Audio.touchPlayList.push({
								offset: t,
								audio: i,
							});
					}, 10)));
		},
		pause: function () {
			(this.playedLength = this.context.currentTime - this._startTime),
				(this.playedLength %= this.buffer.duration);
			var t = this._currentSource;
			(this._currentSource = null),
				(this._startTime = -1),
				t && t.stop(0);
		},
	}),
	(function (_) {
		var t,
			e,
			n,
			d = _.WEB_AUDIO,
			s = _.ONLY_ONE,
			p = [];
		(e = document.createElement('audio')).canPlayType &&
			((t = e.canPlayType('audio/ogg; codecs="vorbis"')) &&
				'' !== t &&
				p.push('.ogg'),
			(t = e.canPlayType('audio/mpeg')) && '' !== t && p.push('.mp3'),
			(t = e.canPlayType('audio/wav; codecs="1"')) &&
				'' !== t &&
				p.push('.wav'),
			(t = e.canPlayType('audio/mp4')) && '' !== t && p.push('.mp4'),
			(e = e.canPlayType('audio/x-m4a')) && '' !== e && p.push('.m4a'));
		try {
			d &&
				((n = new (window.AudioContext ||
					window.webkitAudioContext ||
					window.mozAudioContext)()),
				(cc.Audio._context = n),
				_.DELAY_CREATE_CTX &&
					setTimeout(function () {
						(n = new (window.AudioContext ||
							window.webkitAudioContext ||
							window.mozAudioContext)()),
							(cc.Audio._context = n);
					}, 0));
		} catch (t) {
			(d = !1), cc.log("browser don't support web audio");
		}
		var c = {
			cache: {},
			useWebAudio: !1,
			loadBuffer: function (t, e) {
				var i;
				d &&
					((i = new XMLHttpRequest()).open('GET', t, !0),
					(i.responseType = 'arraybuffer'),
					(i.onload = function () {
						n.decodeAudioData(
							i.response,
							function (t) {
								e(null, t);
							},
							function () {
								e('decode error - ' + t);
							}
						);
					}),
					(i.onerror = function () {
						e('request error - ' + t);
					}),
					i.send());
			},
			load: function (t, e, i, n) {
				if (0 === p.length) return n('can not support audio!');
				var r = cc.loader.getRes(e);
				if (r) return n(null, r);
				cc.loader.audioPath &&
					(t = cc.path.join(cc.loader.audioPath, t));
				for (
					var o = cc.path.extname(t), s = [o], c = 0;
					c < p.length;
					c++
				)
					o !== p[c] && s.push(p[c]);
				return (
					(r = new cc.Audio(t)),
					(cc.loader.cache[e] = r),
					this.loadAudioFromExtList(t, s, r, n),
					r
				);
			},
			loadAudioFromExtList: function (t, e, i, n) {
				if (0 === e.length) {
					var r =
						'can not found the resource of audio! Last match url is : ';
					return (
						(r += t.replace(/\.(.*)?$/, '(')),
						p.forEach(function (t) {
							r += t + '|';
						}),
						(r = r.replace(/\|$/, ')')),
						n({ status: 520, errorMessage: r }, null)
					);
				}
				if (d && this.useWebAudio)
					this.loadBuffer(t, function (t, e) {
						t && cc.log(t), e && i.setBuffer(e), n(null, i);
					});
				else {
					for (
						var o = _.ONE_SOURCE ? 1 : e.length,
							s = document.createElement('audio'),
							c = 0;
						c < o;
						c++
					) {
						var a = document.createElement('source');
						(a.src = cc.path.changeExtname(t, e[c])),
							s.appendChild(a);
					}
					i.setElement(s);
					var l = setTimeout(function () {
							(0 === s.readyState ? u : h)();
						}, 8e3),
						h = function () {
							s.removeEventListener('canplaythrough', h, !1),
								s.removeEventListener('error', u, !1),
								s.removeEventListener('emptied', h, !1),
								_.USE_LOADER_EVENT &&
									s.removeEventListener(
										_.USE_LOADER_EVENT,
										h,
										!1
									),
								clearTimeout(l),
								n(null, i);
						},
						u = function () {
							cc.log('load audio failure - ' + t), h();
						};
					s.addEventListener('canplaythrough', h, !1),
						s.addEventListener('error', u, !1),
						_.USE_LOADER_EVENT &&
							s.addEventListener(_.USE_LOADER_EVENT, h, !1);
				}
			},
		};
		cc.loader.register(['mp3', 'ogg', 'wav', 'mp4', 'm4a'], c),
			(cc.audioEngine = {
				_currMusic: null,
				_musicVolume: 1,
				features: _,
				willPlayMusic: function () {
					return !1;
				},
				playMusic: function (t, e) {
					var i = this._currMusic;
					i && i.getPlaying() && i.stop();
					i = cc.loader.getRes(t);
					i || (cc.loader.load(t), (i = cc.loader.getRes(t))),
						i.setVolume(this._musicVolume),
						i.play(0, e || !1),
						(this._currMusic = i);
				},
				stopMusic: function (t) {
					var e = this._currMusic;
					e &&
						(e.stop(),
						(this._currMusic = null),
						t && cc.loader.release(e.src));
				},
				pauseMusic: function () {
					var t = this._currMusic;
					t && t.pause();
				},
				resumeMusic: function () {
					var t = this._currMusic;
					t && t.resume();
				},
				rewindMusic: function () {
					var t = this._currMusic;
					t && (t.stop(), t.play());
				},
				getMusicVolume: function () {
					return this._musicVolume;
				},
				setMusicVolume: function (t) {
					(t = +t),
						isNaN(t) && (t = 1),
						1 < t && (t = 1),
						t < 0 && (t = 0),
						(this._musicVolume = t);
					var e = this._currMusic;
					e && e.setVolume(t);
				},
				isMusicPlaying: function () {
					var t = this._currMusic;
					return !!t && t.getPlaying();
				},
				_audioPool: {},
				_maxAudioInstance: 10,
				_effectVolume: 1,
				playEffect: function (e, i) {
					if (s && this._currMusic && this._currMusic.getPlaying())
						return (
							cc.log('Browser is only allowed to play one audio'),
							null
						);
					for (
						var t,
							n,
							r =
								(r = this._audioPool[e]) ||
								(this._audioPool[e] = []),
							o = 0;
						o < r.length && r[o].getPlaying();
						o++
					);
					if (
						(!d &&
							o > this._maxAudioInstance &&
							((t = r.shift()).stop(),
							r.push(t),
							(o = r.length - 1)),
						r[o])
					)
						return (
							(n = r[o]).setVolume(this._effectVolume),
							n.play(0, i || !1),
							n
						);
					if (
						((n = cc.loader.getRes(e)) &&
							d &&
							'AUDIO' === n._AUDIO_TYPE &&
							(cc.loader.release(e), (n = null)),
						n)
					) {
						if (!d || 'AUDIO' !== n._AUDIO_TYPE)
							return (
								(n = n.cloneNode()).setVolume(
									this._effectVolume
								),
								n.play(0, i || !1),
								r.push(n),
								n
							);
						c.loadBuffer(e, function (t, e) {
							n.setBuffer(e),
								n.setVolume(cc.audioEngine._effectVolume),
								n.getPlaying() || n.play(0, i || !1);
						});
					}
					return (
						(c.useWebAudio = !0),
						cc.loader.load(e, function (t) {
							(t = (t =
								cc.loader.getRes(e)).cloneNode()).setVolume(
								cc.audioEngine._effectVolume
							),
								t.play(0, i || !1),
								r.push(t);
						}),
						(c.useWebAudio = !1),
						n
					);
				},
				setEffectsVolume: function (t) {
					(t = +t),
						isNaN(t) && (t = 1),
						1 < t && (t = 1),
						t < 0 && (t = 0),
						(this._effectVolume = t);
					var e,
						i = this._audioPool;
					for (e in i) {
						var n = i[e];
						if (Array.isArray(n))
							for (var r = 0; r < n.length; r++)
								n[r].setVolume(t);
					}
				},
				getEffectsVolume: function () {
					return this._effectVolume;
				},
				pauseEffect: function (t) {
					t && t.pause();
				},
				pauseAllEffects: function () {
					var t,
						e = this._audioPool;
					for (t in e)
						for (var i = e[t], n = 0; n < e[t].length; n++)
							i[n].getPlaying() && i[n].pause();
				},
				resumeEffect: function (t) {
					t && t.resume();
				},
				resumeAllEffects: function () {
					var t,
						e = this._audioPool;
					for (t in e)
						for (var i = e[t], n = 0; n < e[t].length; n++)
							0 != i[n].getPlayingEnd() && i[n].resume();
				},
				stopEffect: function (t) {
					t && t.stop();
				},
				stopAllEffects: function () {
					var t,
						e = this._audioPool;
					for (t in e) {
						for (var i = e[t], n = 0; n < i.length; n++)
							i[n].stop();
						i.length = 0;
					}
				},
				unloadEffect: function (t) {
					var e;
					t &&
						(cc.loader.release(t),
						(e = this._audioPool[t]) && (e.length = 0),
						delete this._audioPool[t]);
				},
				preloadEffect: function (e) {
					if (s && this._currMusic && this._currMusic.getPlaying())
						return (
							cc.log('Browser is only allowed to play one audio'),
							null
						);
					for (
						var t,
							i,
							n =
								(n = this._audioPool[e]) ||
								(this._audioPool[e] = []),
							r = 0;
						r < n.length && n[r].getPlaying();
						r++
					);
					if (
						(!d &&
							r > this._maxAudioInstance &&
							((t = n.shift()).stop(),
							n.push(t),
							(r = n.length - 1)),
						n[r])
					)
						return (i = n[r]).setVolume(this._effectVolume), i;
					if (
						((i = cc.loader.getRes(e)) &&
							d &&
							'AUDIO' === i._AUDIO_TYPE &&
							(cc.loader.release(e), (i = null)),
						i)
					) {
						if (!d || 'AUDIO' !== i._AUDIO_TYPE)
							return (
								(i = i.cloneNode()).setVolume(
									this._effectVolume
								),
								n.push(i),
								i
							);
						c.loadBuffer(e, function (t, e) {
							i.setBuffer(e),
								i.setVolume(cc.audioEngine._effectVolume);
						});
					}
					return (
						(c.useWebAudio = !0),
						cc.loader.load(e, function (t) {
							(t = (t =
								cc.loader.getRes(e)).cloneNode()).setVolume(
								cc.audioEngine._effectVolume
							),
								n.push(t);
						}),
						(c.useWebAudio = !1),
						i
					);
				},
				end: function () {
					this.stopMusic(), this.stopAllEffects();
				},
				_pauseCache: [],
				_pausePlaying: function () {
					var t = this._currMusic;
					t &&
						t.getPlaying() &&
						(t.pause(), this._pauseCache.push(t));
					var e,
						i = this._audioPool;
					for (e in i)
						for (var n = i[e], r = 0; r < i[e].length; r++)
							n[r].getPlaying() &&
								(n[r].pause(), this._pauseCache.push(n[r]));
				},
				_resumePlaying: function () {
					for (var t = this._pauseCache, e = 0; e < t.length; e++)
						t[e].resume();
					t.length = 0;
				},
			});
	})(window.__audioSupport),
	(cc._globalFontSize = cc.ITEM_SIZE),
	(cc._globalFontName = 'Arial'),
	(cc._globalFontNameRelease = !1),
	(cc.MenuItem = cc.Node.extend({
		_enabled: !1,
		_target: null,
		_callback: null,
		_isSelected: !1,
		_className: 'MenuItem',
		ctor: function (t, e) {
			var i = cc.Node.prototype;
			i.ctor.call(this),
				(this._target = null),
				(this._callback = null),
				(this._isSelected = !1),
				(this._enabled = !1),
				i.setAnchorPoint.call(this, 0.5, 0.5),
				(this._target = e || null),
				(this._callback = t || null),
				this._callback && (this._enabled = !0);
		},
		isSelected: function () {
			return this._isSelected;
		},
		setOpacityModifyRGB: function (t) {},
		isOpacityModifyRGB: function () {
			return !1;
		},
		setTarget: function (t, e) {
			(this._target = e), (this._callback = t);
		},
		isEnabled: function () {
			return this._enabled;
		},
		setEnabled: function (t) {
			this._enabled = t;
		},
		initWithCallback: function (t, e) {
			return (
				(this.anchorX = 0.5),
				(this.anchorY = 0.5),
				(this._target = e),
				(this._callback = t),
				(this._enabled = !0),
				!(this._isSelected = !1)
			);
		},
		rect: function () {
			var t = this._position,
				e = this._contentSize,
				i = this._anchorPoint;
			return cc.rect(
				t.x - e.width * i.x,
				t.y - e.height * i.y,
				e.width,
				e.height
			);
		},
		selected: function () {
			this._isSelected = !0;
		},
		unselected: function () {
			this._isSelected = !1;
		},
		setCallback: function (t, e) {
			(this._target = e), (this._callback = t);
		},
		activate: function () {
			var t, e;
			this._enabled &&
				((t = this._target),
				(e = this._callback) &&
					(t && cc.isString(e)
						? t[e](this)
						: t && cc.isFunction(e)
						? e.call(t, this)
						: e(this)));
		},
	}));
var _p = cc.MenuItem.prototype;
_p.enabled,
	cc.defineGetterSetter(_p, 'enabled', _p.isEnabled, _p.setEnabled),
	(cc.MenuItem.create = function (t, e) {
		return new cc.MenuItem(t, e);
	}),
	(cc.MenuItemLabel = cc.MenuItem.extend({
		_disabledColor: null,
		_label: null,
		_originalScale: 0,
		_colorBackup: null,
		ctor: function (t, e, i) {
			cc.MenuItem.prototype.ctor.call(this, e, i),
				(this._disabledColor = null),
				(this._label = null),
				(this._colorBackup = null),
				t &&
					((this._originalScale = 1),
					(this._colorBackup = cc.color.WHITE),
					(this._disabledColor = cc.color(126, 126, 126)),
					this.setLabel(t),
					t.textureLoaded &&
						!t.textureLoaded() &&
						t.addEventListener(
							'load',
							function (t) {
								(this.width = t.width),
									(this.height = t.height),
									this.parent instanceof cc.Menu &&
										this.parent.updateAlign();
							},
							this
						),
					this.setCascadeColorEnabled(!0),
					this.setCascadeOpacityEnabled(!0));
		},
		getDisabledColor: function () {
			return this._disabledColor;
		},
		setDisabledColor: function (t) {
			this._disabledColor = t;
		},
		getLabel: function () {
			return this._label;
		},
		setLabel: function (t) {
			t &&
				(this.addChild(t),
				(t.anchorX = 0),
				(t.anchorY = 0),
				(this.width = t.width),
				(this.height = t.height),
				t.setCascadeColorEnabled(!0)),
				this._label && this.removeChild(this._label, !0),
				(this._label = t);
		},
		setEnabled: function (t) {
			this._enabled !== t &&
				(t
					? this.setColor(this._colorBackup)
					: ((this._colorBackup = this.color),
					  this.setColor(this._disabledColor))),
				cc.MenuItem.prototype.setEnabled.call(this, t);
		},
		initWithLabel: function (t, e, i) {
			return (
				this.initWithCallback(e, i),
				(this._originalScale = 1),
				(this._colorBackup = cc.color.WHITE),
				(this._disabledColor = cc.color(126, 126, 126)),
				this.setLabel(t),
				this.setCascadeColorEnabled(!0),
				this.setCascadeOpacityEnabled(!0),
				!0
			);
		},
		setString: function (t) {
			(this._label.string = t),
				(this.width = this._label.width),
				(this.height = this._label.height);
		},
		getString: function () {
			return this._label.string;
		},
		activate: function () {
			this._enabled &&
				(this.stopAllActions(),
				(this.scale = this._originalScale),
				cc.MenuItem.prototype.activate.call(this));
		},
		selected: function () {
			var t;
			this._enabled &&
				(cc.MenuItem.prototype.selected.call(this),
				(t = this.getActionByTag(cc.ZOOM_ACTION_TAG))
					? this.stopAction(t)
					: (this._originalScale = this.scale),
				(t = cc.scaleTo(0.1, 1.2 * this._originalScale)).setTag(
					cc.ZOOM_ACTION_TAG
				),
				this.runAction(t));
		},
		unselected: function () {
			var t;
			this._enabled &&
				(cc.MenuItem.prototype.unselected.call(this),
				this.stopActionByTag(cc.ZOOM_ACTION_TAG),
				(t = cc.scaleTo(0.1, this._originalScale)).setTag(
					cc.ZOOM_ACTION_TAG
				),
				this.runAction(t));
		},
	}));
var _p = cc.MenuItemLabel.prototype;
_p.string,
	cc.defineGetterSetter(_p, 'string', _p.getString, _p.setString),
	_p.disabledColor,
	cc.defineGetterSetter(
		_p,
		'disabledColor',
		_p.getDisabledColor,
		_p.setDisabledColor
	),
	_p.label,
	cc.defineGetterSetter(_p, 'label', _p.getLabel, _p.setLabel),
	(cc.MenuItemLabel.create = function (t, e, i) {
		return new cc.MenuItemLabel(t, e, i);
	}),
	(cc.MenuItemAtlasFont = cc.MenuItemLabel.extend({
		ctor: function (t, e, i, n, r, o, s) {
			var c;
			t && 0 < t.length && (c = new cc.LabelAtlas(t, e, i, n, r)),
				cc.MenuItemLabel.prototype.ctor.call(this, c, o, s);
		},
		initWithString: function (t, e, i, n, r, o, s) {
			if (!t || 0 === t.length)
				throw new Error(
					'cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0'
				);
			var c = new cc.LabelAtlas();
			return (
				c.initWithString(t, e, i, n, r), this.initWithLabel(c, o, s), !0
			);
		},
	})),
	(cc.MenuItemAtlasFont.create = function (t, e, i, n, r, o, s) {
		return new cc.MenuItemAtlasFont(t, e, i, n, r, o, s);
	}),
	(cc.MenuItemFont = cc.MenuItemLabel.extend({
		_fontSize: null,
		_fontName: null,
		ctor: function (t, e, i) {
			var n;
			t && 0 < t.length
				? ((this._fontName = cc._globalFontName),
				  (this._fontSize = cc._globalFontSize),
				  (n = new cc.LabelTTF(t, this._fontName, this._fontSize)))
				: ((this._fontSize = 0), (this._fontName = '')),
				cc.MenuItemLabel.prototype.ctor.call(this, n, e, i);
		},
		initWithString: function (t, e, i) {
			if (!t || 0 === t.length)
				throw new Error(
					'Value should be non-null and its length should be greater than 0'
				);
			(this._fontName = cc._globalFontName),
				(this._fontSize = cc._globalFontSize);
			t = new cc.LabelTTF(t, this._fontName, this._fontSize);
			return this.initWithLabel(t, e, i), !0;
		},
		setFontSize: function (t) {
			(this._fontSize = t), this._recreateLabel();
		},
		getFontSize: function () {
			return this._fontSize;
		},
		setFontName: function (t) {
			(this._fontName = t), this._recreateLabel();
		},
		getFontName: function () {
			return this._fontName;
		},
		_recreateLabel: function () {
			var t = new cc.LabelTTF(
				this._label.string,
				this._fontName,
				this._fontSize
			);
			this.setLabel(t);
		},
	})),
	(cc.MenuItemFont.setFontSize = function (t) {
		cc._globalFontSize = t;
	}),
	(cc.MenuItemFont.fontSize = function () {
		return cc._globalFontSize;
	}),
	(cc.MenuItemFont.setFontName = function (t) {
		cc._globalFontNameRelease && (cc._globalFontName = ''),
			(cc._globalFontName = t),
			(cc._globalFontNameRelease = !0);
	});
var _p = cc.MenuItemFont.prototype;
_p.fontSize,
	cc.defineGetterSetter(_p, 'fontSize', _p.getFontSize, _p.setFontSize),
	_p.fontName,
	cc.defineGetterSetter(_p, 'fontName', _p.getFontName, _p.setFontName),
	(cc.MenuItemFont.fontName = function () {
		return cc._globalFontName;
	}),
	(cc.MenuItemFont.create = function (t, e, i) {
		return new cc.MenuItemFont(t, e, i);
	}),
	(cc.MenuItemSprite = cc.MenuItem.extend({
		_normalImage: null,
		_selectedImage: null,
		_disabledImage: null,
		ctor: function (t, e, i, n, r) {
			var o, s, c;
			if (
				(cc.MenuItem.prototype.ctor.call(this),
				(this._normalImage = null),
				(this._selectedImage = null),
				(this._disabledImage = null),
				(this._loader = new cc.Sprite.LoadManager()),
				void 0 !== t)
			)
				return (
					(e = e || null),
					void 0 !== r
						? ((o = i), (c = n), (s = r))
						: void 0 !== n && cc.isFunction(n)
						? ((o = i), (c = n))
						: void 0 !== n && cc.isFunction(i)
						? ((s = n), (c = i), (o = null))
						: void 0 === i && (o = null),
					this._loader.clear(),
					t.textureLoaded && !t.textureLoaded()
						? (this._loader.once(
								t,
								function () {
									this.initWithNormalSprite(t, e, o, c, s);
								},
								this
						  ),
						  !1)
						: (this.initWithNormalSprite(t, e, o, c, s), !0)
				);
		},
		getNormalImage: function () {
			return this._normalImage;
		},
		setNormalImage: function (t) {
			this._normalImage !== t &&
				(t &&
					(this.addChild(t, 0, cc.NORMAL_TAG),
					(t.anchorX = 0),
					(t.anchorY = 0)),
				this._normalImage && this.removeChild(this._normalImage, !0),
				(this._normalImage = t),
				this._normalImage &&
					((this.width = this._normalImage.width),
					(this.height = this._normalImage.height),
					this._updateImagesVisibility(),
					t.textureLoaded &&
						!t.textureLoaded() &&
						t.addEventListener(
							'load',
							function (t) {
								(this.width = t.width),
									(this.height = t.height),
									this.parent instanceof cc.Menu &&
										this.parent.updateAlign();
							},
							this
						)));
		},
		getSelectedImage: function () {
			return this._selectedImage;
		},
		setSelectedImage: function (t) {
			this._selectedImage !== t &&
				(t &&
					(this.addChild(t, 0, cc.SELECTED_TAG),
					(t.anchorX = 0),
					(t.anchorY = 0)),
				this._selectedImage &&
					this.removeChild(this._selectedImage, !0),
				(this._selectedImage = t),
				this._updateImagesVisibility());
		},
		getDisabledImage: function () {
			return this._disabledImage;
		},
		setDisabledImage: function (t) {
			this._disabledImage !== t &&
				(t &&
					(this.addChild(t, 0, cc.DISABLE_TAG),
					(t.anchorX = 0),
					(t.anchorY = 0)),
				this._disabledImage &&
					this.removeChild(this._disabledImage, !0),
				(this._disabledImage = t),
				this._updateImagesVisibility());
		},
		initWithNormalSprite: function (t, e, i, n, r) {
			if ((this._loader.clear(), t.textureLoaded && !t.textureLoaded()))
				return (
					this._loader.once(
						t,
						function () {
							this.initWithNormalSprite(t, e, i, n, r);
						},
						this
					),
					!1
				);
			this.initWithCallback(n, r),
				this.setNormalImage(t),
				this.setSelectedImage(e),
				this.setDisabledImage(i);
			var o = this._normalImage;
			return (
				o && ((this.width = o.width), (this.height = o.height)),
				this.setCascadeColorEnabled(!0),
				this.setCascadeOpacityEnabled(!0),
				!0
			);
		},
		selected: function () {
			cc.MenuItem.prototype.selected.call(this),
				this._normalImage &&
					(this._disabledImage && (this._disabledImage.visible = !1),
					this._selectedImage
						? ((this._normalImage.visible = !1),
						  (this._selectedImage.visible = !0))
						: (this._normalImage.visible = !0));
		},
		unselected: function () {
			cc.MenuItem.prototype.unselected.call(this),
				this._normalImage &&
					((this._normalImage.visible = !0),
					this._selectedImage && (this._selectedImage.visible = !1),
					this._disabledImage && (this._disabledImage.visible = !1));
		},
		setEnabled: function (t) {
			this._enabled !== t &&
				(cc.MenuItem.prototype.setEnabled.call(this, t),
				this._updateImagesVisibility());
		},
		_updateImagesVisibility: function () {
			var t = this._normalImage,
				e = this._selectedImage,
				i = this._disabledImage;
			this._enabled
				? (t && (t.visible = !0),
				  e && (e.visible = !1),
				  i && (i.visible = !1))
				: i
				? (t && (t.visible = !1),
				  e && (e.visible = !1),
				  i && (i.visible = !0))
				: (t && (t.visible = !0), e && (e.visible = !1));
		},
	}));
var _p = cc.MenuItemSprite.prototype;
_p.normalImage,
	cc.defineGetterSetter(
		_p,
		'normalImage',
		_p.getNormalImage,
		_p.setNormalImage
	),
	_p.selectedImage,
	cc.defineGetterSetter(
		_p,
		'selectedImage',
		_p.getSelectedImage,
		_p.setSelectedImage
	),
	_p.disabledImage,
	cc.defineGetterSetter(
		_p,
		'disabledImage',
		_p.getDisabledImage,
		_p.setDisabledImage
	),
	(cc.MenuItemSprite.create = function (t, e, i, n, r) {
		return new cc.MenuItemSprite(t, e, i, n, r || void 0);
	}),
	(cc.MenuItemImage = cc.MenuItemSprite.extend({
		ctor: function (t, e, i, n, r) {
			var o,
				s = null,
				c = null,
				a = null,
				l = null;
			null == t
				? cc.MenuItemSprite.prototype.ctor.call(this)
				: ((o = new cc.Sprite(t)),
				  e && (s = new cc.Sprite(e)),
				  void 0 === n
						? (a = i)
						: void 0 === r
						? ((a = i), (l = n))
						: r && ((c = new cc.Sprite(i)), (a = n), (l = r)),
				  cc.MenuItemSprite.prototype.ctor.call(this, o, s, c, a, l));
		},
		setNormalSpriteFrame: function (t) {
			this.setNormalImage(new cc.Sprite(t));
		},
		setSelectedSpriteFrame: function (t) {
			this.setSelectedImage(new cc.Sprite(t));
		},
		setDisabledSpriteFrame: function (t) {
			this.setDisabledImage(new cc.Sprite(t));
		},
		initWithNormalImage: function (t, e, i, n, r) {
			var o = null,
				s = null,
				c = null;
			return (
				t && (o = new cc.Sprite(t)),
				e && (s = new cc.Sprite(e)),
				i && (c = new cc.Sprite(i)),
				this.initWithNormalSprite(o, s, c, n, r)
			);
		},
	})),
	(cc.MenuItemImage.create = function (t, e, i, n, r) {
		return new cc.MenuItemImage(t, e, i, n, r);
	}),
	(cc.MenuItemToggle = cc.MenuItem.extend({
		subItems: null,
		_selectedIndex: 0,
		_opacity: null,
		_color: null,
		ctor: function () {
			cc.MenuItem.prototype.ctor.call(this),
				(this._selectedIndex = 0),
				(this.subItems = []),
				(this._opacity = 0),
				(this._color = cc.color.WHITE),
				0 < arguments.length &&
					this.initWithItems(Array.prototype.slice.apply(arguments));
		},
		getOpacity: function () {
			return this._opacity;
		},
		setOpacity: function (t) {
			if (
				((this._opacity = t), this.subItems && 0 < this.subItems.length)
			)
				for (var e = 0; e < this.subItems.length; e++)
					this.subItems[e].opacity = t;
			this._color.a = t;
		},
		getColor: function () {
			var t = this._color;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		setColor: function (t) {
			var e = this._color;
			if (
				((e.r = t.r),
				(e.g = t.g),
				(e.b = t.b),
				this.subItems && 0 < this.subItems.length)
			)
				for (var i = 0; i < this.subItems.length; i++)
					this.subItems[i].setColor(t);
			void 0 === t.a || t.a_undefined || this.setOpacity(t.a);
		},
		getSelectedIndex: function () {
			return this._selectedIndex;
		},
		setSelectedIndex: function (t) {
			var e, i;
			t !== this._selectedIndex &&
				((this._selectedIndex = t),
				(i = this.getChildByTag(cc.CURRENT_ITEM)) &&
					i.removeFromParent(!1),
				(e = this.subItems[this._selectedIndex]),
				this.addChild(e, 0, cc.CURRENT_ITEM),
				(t = e.width),
				(i = e.height),
				(this.width = t),
				(this.height = i),
				e.setPosition(t / 2, i / 2));
		},
		getSubItems: function () {
			return this.subItems;
		},
		setSubItems: function (t) {
			this.subItems = t;
		},
		initWithItems: function (t) {
			var e = t.length;
			cc.isFunction(t[t.length - 2])
				? (this.initWithCallback(t[t.length - 2], t[t.length - 1]),
				  (e -= 2))
				: cc.isFunction(t[t.length - 1])
				? (this.initWithCallback(t[t.length - 1], null), --e)
				: this.initWithCallback(null, null);
			for (var i = this.subItems, n = (i.length = 0); n < e; n++)
				t[n] && i.push(t[n]);
			return (
				(this._selectedIndex = cc.UINT_MAX),
				this.setSelectedIndex(0),
				this.setCascadeColorEnabled(!0),
				this.setCascadeOpacityEnabled(!0),
				!0
			);
		},
		addSubItem: function (t) {
			this.subItems.push(t);
		},
		activate: function () {
			var t;
			this._enabled &&
				((t = (this._selectedIndex + 1) % this.subItems.length),
				this.setSelectedIndex(t)),
				cc.MenuItem.prototype.activate.call(this);
		},
		selected: function () {
			cc.MenuItem.prototype.selected.call(this),
				this.subItems[this._selectedIndex].selected();
		},
		unselected: function () {
			cc.MenuItem.prototype.unselected.call(this),
				this.subItems[this._selectedIndex].unselected();
		},
		setEnabled: function (t) {
			if (this._enabled !== t) {
				cc.MenuItem.prototype.setEnabled.call(this, t);
				var e = this.subItems;
				if (e && 0 < e.length)
					for (var i = 0; i < e.length; i++) e[i].enabled = t;
			}
		},
		selectedItem: function () {
			return this.subItems[this._selectedIndex];
		},
		getSelectedItem: function () {
			return this.subItems[this._selectedIndex];
		},
		onEnter: function () {
			cc.Node.prototype.onEnter.call(this),
				this.setSelectedIndex(this._selectedIndex);
		},
	}));
var _p = cc.MenuItemToggle.prototype;
_p.selectedIndex,
	cc.defineGetterSetter(
		_p,
		'selectedIndex',
		_p.getSelectedIndex,
		_p.setSelectedIndex
	),
	(cc.MenuItemToggle.create = function () {
		0 < arguments.length &&
			null == arguments[arguments.length - 1] &&
			cc.log('parameters should not be ending with null in Javascript');
		var t = new cc.MenuItemToggle();
		return t.initWithItems(Array.prototype.slice.apply(arguments)), t;
	}),
	(cc.MENU_STATE_WAITING = 0),
	(cc.MENU_STATE_TRACKING_TOUCH = 1),
	(cc.MENU_HANDLER_PRIORITY = -128),
	(cc.DEFAULT_PADDING = 5),
	(cc.Menu = cc.Layer.extend({
		enabled: !1,
		_selectedItem: null,
		_state: -1,
		_touchListener: null,
		_className: 'Menu',
		ctor: function (t) {
			cc.Layer.prototype.ctor.call(this),
				(this._color = cc.color.WHITE),
				(this.enabled = !1),
				(this._opacity = 255),
				(this._selectedItem = null),
				(this._state = -1),
				(this._touchListener = cc.EventListener.create({
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this._onTouchBegan,
					onTouchMoved: this._onTouchMoved,
					onTouchEnded: this._onTouchEnded,
					onTouchCancelled: this._onTouchCancelled,
				})),
				0 < arguments.length &&
					null == arguments[arguments.length - 1] &&
					cc.log(
						'parameters should not be ending with null in Javascript'
					);
			var e,
				i = arguments.length;
			if (0 === i) e = [];
			else if (1 === i) e = t instanceof Array ? t : [t];
			else if (1 < i) {
				e = [];
				for (var n = 0; n < i; n++)
					arguments[n] && e.push(arguments[n]);
			}
			this.initWithArray(e);
		},
		onEnter: function () {
			var t = this._touchListener;
			t._isRegistered() || cc.eventManager.addListener(t, this),
				cc.Node.prototype.onEnter.call(this);
		},
		isEnabled: function () {
			return this.enabled;
		},
		setEnabled: function (t) {
			this.enabled = t;
		},
		initWithItems: function (t) {
			var e = [];
			if (t) for (var i = 0; i < t.length; i++) t[i] && e.push(t[i]);
			return this.initWithArray(e);
		},
		initWithArray: function (t) {
			if (cc.Layer.prototype.init.call(this)) {
				this.enabled = !0;
				var e = cc.winSize;
				if (
					(this.setPosition(e.width / 2, e.height / 2),
					this.setContentSize(e),
					this.setAnchorPoint(0.5, 0.5),
					this.ignoreAnchorPointForPosition(!0),
					t)
				)
					for (var i = 0; i < t.length; i++) this.addChild(t[i], i);
				return (
					(this._selectedItem = null),
					(this._state = cc.MENU_STATE_WAITING),
					(this.cascadeColor = !0),
					(this.cascadeOpacity = !0)
				);
			}
			return !1;
		},
		addChild: function (t, e, i) {
			if (!(t instanceof cc.MenuItem))
				throw new Error(
					'cc.Menu.addChild() : Menu only supports MenuItem objects as children'
				);
			cc.Layer.prototype.addChild.call(this, t, e, i);
		},
		updateAlign: function () {
			switch (this._align) {
				case 'vertically':
					this.alignItemsVertically();
					break;
				case 'horizontally':
					this.alignItemsHorizontally();
			}
		},
		alignItemsVertically: function () {
			this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING);
		},
		alignItemsVerticallyWithPadding: function (t) {
			this._align = 'vertically';
			var e,
				i,
				n,
				r = -t,
				o = this._children;
			if (o && 0 < o.length) {
				for (c = 0, a = o.length; c < a; c++)
					r += o[c].height * o[c].scaleY + t;
				for (var s = r / 2, c = 0, a = o.length; c < a; c++)
					(i = (n = o[c]).height),
						(e = n.scaleY),
						n.setPosition(0, s - (i * e) / 2),
						(s -= i * e + t);
			}
		},
		alignItemsHorizontally: function () {
			this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING);
		},
		alignItemsHorizontallyWithPadding: function (t) {
			this._align = 'horizontally';
			var e,
				i,
				n,
				r = -t,
				o = this._children;
			if (o && 0 < o.length) {
				for (c = 0, a = o.length; c < a; c++)
					r += o[c].width * o[c].scaleX + t;
				for (var s = -r / 2, c = 0, a = o.length; c < a; c++)
					(e = (n = o[c]).scaleX),
						(i = o[c].width),
						n.setPosition(s + (i * e) / 2, 0),
						(s += i * e + t);
			}
		},
		alignItemsInColumns: function () {
			0 < arguments.length &&
				null == arguments[arguments.length - 1] &&
				cc.log(
					'parameters should not be ending with null in Javascript'
				);
			for (var t = [], e = 0; e < arguments.length; e++)
				t.push(arguments[e]);
			var i,
				n,
				r = -5,
				o = 0,
				s = 0,
				c = 0,
				a = this._children;
			if (a && 0 < a.length)
				for (e = 0, n = a.length; e < n; e++)
					o >= t.length ||
						((h = t[o]) &&
							((s = (i = a[e].height) <= s || isNaN(i) ? s : i),
							h <= ++c && ((r += s + 5), (s = c = 0), ++o)));
			var l = cc.director.getWinSize(),
				o = 0,
				s = 0,
				h = 0,
				u = 0,
				_ = 0,
				d = r / 2;
			if (a && 0 < a.length)
				for (e = 0, n = a.length; e < n; e++) {
					var p = a[e];
					0 === h && ((h = t[o]), (_ = u = l.width / (1 + h))),
						(s = (i = p._getHeight()) <= s || isNaN(i) ? s : i),
						p.setPosition(_ - l.width / 2, d - i / 2),
						(_ += u),
						h <= ++c && ((d -= s + 5), (s = h = c = 0), ++o);
				}
		},
		alignItemsInRows: function () {
			0 < arguments.length &&
				null == arguments[arguments.length - 1] &&
				cc.log(
					'parameters should not be ending with null in Javascript'
				);
			for (var t = [], e = 0; e < arguments.length; e++)
				t.push(arguments[e]);
			var i,
				n,
				r,
				o = [],
				s = [],
				c = -10,
				a = -5,
				l = 0,
				h = 0,
				u = 0,
				_ = this._children;
			if (_ && 0 < _.length)
				for (e = 0, n = _.length; e < n; e++)
					(i = _[e]),
						l >= t.length ||
							((p = t[l]) &&
								((h = (r = i.width) <= h || isNaN(r) ? h : r),
								(a += i.height + 5),
								p <= ++u &&
									(o.push(h),
									s.push(a),
									(c += h + 10),
									(h = u = 0),
									(a = -5),
									++l)));
			var d = cc.director.getWinSize(),
				l = 0,
				h = 0,
				p = 0,
				f = -c / 2,
				m = 0;
			if (_ && 0 < _.length)
				for (e = 0, n = _.length; e < n; e++)
					(i = _[e]),
						0 === p && ((p = t[l]), (m = s[l])),
						(h = (r = i._getWidth()) <= h || isNaN(r) ? h : r),
						i.setPosition(f + o[l] / 2, m - d.height / 2),
						(m -= i.height + 10),
						p <= ++u && ((f += h + 5), (h = p = u = 0), ++l);
		},
		removeChild: function (t, e) {
			null != t &&
				(t instanceof cc.MenuItem
					? (this._selectedItem === t && (this._selectedItem = null),
					  cc.Node.prototype.removeChild.call(this, t, e))
					: cc.log(
							'cc.Menu.removeChild():Menu only supports MenuItem objects as children'
					  ));
		},
		_onTouchBegan: function (t, e) {
			e = e.getCurrentTarget();
			if (e._state !== cc.MENU_STATE_WAITING || !e._visible || !e.enabled)
				return !1;
			for (var i = e.parent; null != i; i = i.parent)
				if (!i.isVisible()) return !1;
			return (
				(e._selectedItem = e._itemForTouch(t)),
				!!e._selectedItem &&
					((e._state = cc.MENU_STATE_TRACKING_TOUCH),
					e._selectedItem.selected(),
					e._selectedItem.setNodeDirty(),
					!0)
			);
		},
		_onTouchEnded: function (t, e) {
			e = e.getCurrentTarget();
			e._state === cc.MENU_STATE_TRACKING_TOUCH
				? (e._selectedItem &&
						(e._selectedItem.unselected(),
						e._selectedItem.setNodeDirty(),
						e._selectedItem.activate()),
				  (e._state = cc.MENU_STATE_WAITING))
				: cc.log('cc.Menu.onTouchEnded(): invalid state');
		},
		_onTouchCancelled: function (t, e) {
			e = e.getCurrentTarget();
			e._state === cc.MENU_STATE_TRACKING_TOUCH
				? (e._selectedItem &&
						(e._selectedItem.unselected(),
						e._selectedItem.setNodeDirty()),
				  (e._state = cc.MENU_STATE_WAITING))
				: cc.log('cc.Menu.onTouchCancelled(): invalid state');
		},
		_onTouchMoved: function (t, e) {
			e = e.getCurrentTarget();
			e._state === cc.MENU_STATE_TRACKING_TOUCH
				? (t = e._itemForTouch(t)) !== e._selectedItem &&
				  (e._selectedItem &&
						(e._selectedItem.unselected(),
						e._selectedItem.setNodeDirty()),
				  (e._selectedItem = t),
				  e._selectedItem &&
						(e._selectedItem.selected(),
						e._selectedItem.setNodeDirty()))
				: cc.log('cc.Menu.onTouchMoved(): invalid state');
		},
		onExit: function () {
			this._state === cc.MENU_STATE_TRACKING_TOUCH &&
				(this._selectedItem &&
					(this._selectedItem.unselected(),
					(this._selectedItem = null)),
				(this._state = cc.MENU_STATE_WAITING)),
				cc.Node.prototype.onExit.call(this);
		},
		setOpacityModifyRGB: function (t) {},
		isOpacityModifyRGB: function () {
			return !1;
		},
		_itemForTouch: function (t) {
			var e,
				i = t.getLocation(),
				n = this._children;
			if (n && 0 < n.length)
				for (var r = n.length - 1; 0 <= r; r--)
					if ((e = n[r]).isVisible() && e.isEnabled()) {
						var o = e.convertToNodeSpace(i),
							s = e.rect();
						if (((s.x = 0), (s.y = 0), cc.rectContainsPoint(s, o)))
							return e;
					}
			return null;
		},
	}));
var _p = cc.Menu.prototype,
	_currBuffers;
_p.enabled,
	(cc.Menu.create = function (t) {
		var e = arguments.length;
		return (
			0 < e &&
				null == arguments[e - 1] &&
				cc.log(
					'parameters should not be ending with null in Javascript'
				),
			0 === e
				? new cc.Menu()
				: 1 === e
				? new cc.Menu(t)
				: new cc.Menu(Array.prototype.slice.call(arguments, 0))
		);
	}),
	(cc.math = cc.math || {}),
	(cc.math.EPSILON = 1 / 64),
	(cc.math.square = function (t) {
		return t * t;
	}),
	(cc.math.almostEqual = function (t, e) {
		return t + cc.math.EPSILON > e && t - cc.math.EPSILON < e;
	}),
	(function (e) {
		e.math.Vec2 = function (t, e) {
			void 0 === e
				? ((this.x = t.x), (this.y = t.y))
				: ((this.x = t || 0), (this.y = e || 0));
		};
		var t = e.math.Vec2.prototype;
		(t.fill = function (t, e) {
			(this.x = t), (this.y = e);
		}),
			(t.length = function () {
				return Math.sqrt(e.math.square(this.x) + e.math.square(this.y));
			}),
			(t.lengthSq = function () {
				return e.math.square(this.x) + e.math.square(this.y);
			}),
			(t.normalize = function () {
				var t = 1 / this.length();
				return (this.x *= t), (this.y *= t), this;
			}),
			(e.math.Vec2.add = function (t, e, i) {
				return (t.x = e.x + i.x), (t.y = e.y + i.y), t;
			}),
			(t.add = function (t) {
				return (this.x += t.x), (this.y += t.y), this;
			}),
			(t.dot = function (t) {
				return this.x * t.x + this.y * t.y;
			}),
			(e.math.Vec2.subtract = function (t, e, i) {
				return (t.x = e.x - i.x), (t.y = e.y - i.y), t;
			}),
			(t.subtract = function (t) {
				return (this.x -= t.x), (this.y -= t.y), this;
			}),
			(t.transform = function (t) {
				var e = this.x,
					i = this.y;
				return (
					(this.x = e * t.mat[0] + i * t.mat[3] + t.mat[6]),
					(this.y = e * t.mat[1] + i * t.mat[4] + t.mat[7]),
					this
				);
			}),
			(e.math.Vec2.scale = function (t, e, i) {
				return (t.x = e.x * i), (t.y = e.y * i), t;
			}),
			(t.scale = function (t) {
				return (this.x *= t), (this.y *= t), this;
			}),
			(t.equals = function (t) {
				return (
					this.x < t.x + e.math.EPSILON &&
					this.x > t.x - e.math.EPSILON &&
					this.y < t.y + e.math.EPSILON &&
					this.y > t.y - e.math.EPSILON
				);
			});
	})(cc),
	(function (n) {
		(n.math.Vec3 = n.kmVec3 =
			function (t, e, i) {
				t && void 0 === e
					? ((this.x = t.x), (this.y = t.y), (this.z = t.z))
					: ((this.x = t || 0), (this.y = e || 0), (this.z = i || 0));
			}),
			(n.math.vec3 = function (t, e, i) {
				return new n.math.Vec3(t, e, i);
			});
		var t = n.math.Vec3.prototype;
		(t.fill = function (t, e, i) {
			return (
				t && void 0 === e
					? ((this.x = t.x), (this.y = t.y), (this.z = t.z))
					: ((this.x = t), (this.y = e), (this.z = i)),
				this
			);
		}),
			(t.length = function () {
				return Math.sqrt(
					n.math.square(this.x) +
						n.math.square(this.y) +
						n.math.square(this.z)
				);
			}),
			(t.lengthSq = function () {
				return (
					n.math.square(this.x) +
					n.math.square(this.y) +
					n.math.square(this.z)
				);
			}),
			(t.normalize = function () {
				var t = 1 / this.length();
				return (this.x *= t), (this.y *= t), (this.z *= t), this;
			}),
			(t.cross = function (t) {
				var e = this.x,
					i = this.y,
					n = this.z;
				return (
					(this.x = i * t.z - n * t.y),
					(this.y = n * t.x - e * t.z),
					(this.z = e * t.y - i * t.x),
					this
				);
			}),
			(t.dot = function (t) {
				return this.x * t.x + this.y * t.y + this.z * t.z;
			}),
			(t.add = function (t) {
				return (this.x += t.x), (this.y += t.y), (this.z += t.z), this;
			}),
			(t.subtract = function (t) {
				return (this.x -= t.x), (this.y -= t.y), (this.z -= t.z), this;
			}),
			(t.transform = function (t) {
				var e = this.x,
					i = this.y,
					n = this.z,
					t = t.mat;
				return (
					(this.x = e * t[0] + i * t[4] + n * t[8] + t[12]),
					(this.y = e * t[1] + i * t[5] + n * t[9] + t[13]),
					(this.z = e * t[2] + i * t[6] + n * t[10] + t[14]),
					this
				);
			}),
			(t.transformNormal = function (t) {
				var e = this.x,
					i = this.y,
					n = this.z,
					t = t.mat;
				return (
					(this.x = e * t[0] + i * t[4] + n * t[8]),
					(this.y = e * t[1] + i * t[5] + n * t[9]),
					(this.z = e * t[2] + i * t[6] + n * t[10]),
					this
				);
			}),
			(t.transformCoord = function (t) {
				var e = new n.math.Vec4(this.x, this.y, this.z, 1);
				return (
					e.transform(t),
					(this.x = e.x / e.w),
					(this.y = e.y / e.w),
					(this.z = e.z / e.w),
					this
				);
			}),
			(t.scale = function (t) {
				return (this.x *= t), (this.y *= t), (this.z *= t), this;
			}),
			(t.equals = function (t) {
				var e = n.math.EPSILON;
				return (
					this.x < t.x + e &&
					this.x > t.x - e &&
					this.y < t.y + e &&
					this.y > t.y - e &&
					this.z < t.z + e &&
					this.z > t.z - e
				);
			}),
			(t.inverseTransform = function (t) {
				var e = t.mat,
					t = new n.math.Vec3(
						this.x - e[12],
						this.y - e[13],
						this.z - e[14]
					);
				return (
					(this.x = t.x * e[0] + t.y * e[1] + t.z * e[2]),
					(this.y = t.x * e[4] + t.y * e[5] + t.z * e[6]),
					(this.z = t.x * e[8] + t.y * e[9] + t.z * e[10]),
					this
				);
			}),
			(t.inverseTransformNormal = function (t) {
				var e = this.x,
					i = this.y,
					n = this.z,
					t = t.mat;
				return (
					(this.x = e * t[0] + i * t[1] + n * t[2]),
					(this.y = e * t[4] + i * t[5] + n * t[6]),
					(this.z = e * t[8] + i * t[9] + n * t[10]),
					this
				);
			}),
			(t.assignFrom = function (t) {
				return (
					t && ((this.x = t.x), (this.y = t.y), (this.z = t.z)), this
				);
			}),
			(n.math.Vec3.zero = function (t) {
				return (t.x = t.y = t.z = 0), t;
			}),
			(t.toTypeArray = function () {
				var t = new Float32Array(3);
				return (t[0] = this.x), (t[1] = this.y), (t[2] = this.z), t;
			});
	})(cc),
	(function (o) {
		(o.math.Vec4 = function (t, e, i, n) {
			t && void 0 === e
				? ((this.x = t.x),
				  (this.y = t.y),
				  (this.z = t.z),
				  (this.w = t.w))
				: ((this.x = t || 0),
				  (this.y = e || 0),
				  (this.z = i || 0),
				  (this.w = n || 0));
		}),
			(o.kmVec4 = o.math.Vec4);
		var t = o.math.Vec4.prototype;
		(t.fill = function (t, e, i, n) {
			t && void 0 === e
				? ((this.x = t.x),
				  (this.y = t.y),
				  (this.z = t.z),
				  (this.w = t.w))
				: ((this.x = t), (this.y = e), (this.z = i), (this.w = n));
		}),
			(t.add = function (t) {
				return (
					t &&
						((this.x += t.x),
						(this.y += t.y),
						(this.z += t.z),
						(this.w += t.w)),
					this
				);
			}),
			(t.dot = function (t) {
				return (
					this.x * t.x + this.y * t.y + this.z * t.z + this.w * t.w
				);
			}),
			(t.length = function () {
				return Math.sqrt(
					o.math.square(this.x) +
						o.math.square(this.y) +
						o.math.square(this.z) +
						o.math.square(this.w)
				);
			}),
			(t.lengthSq = function () {
				return (
					o.math.square(this.x) +
					o.math.square(this.y) +
					o.math.square(this.z) +
					o.math.square(this.w)
				);
			}),
			(t.lerp = function (t, e) {
				return this;
			}),
			(t.normalize = function () {
				var t = 1 / this.length();
				return (
					(this.x *= t),
					(this.y *= t),
					(this.z *= t),
					(this.w *= t),
					this
				);
			}),
			(t.scale = function (t) {
				return (
					this.normalize(),
					(this.x *= t),
					(this.y *= t),
					(this.z *= t),
					(this.w *= t),
					this
				);
			}),
			(t.subtract = function (t) {
				(this.x -= t.x),
					(this.y -= t.y),
					(this.z -= t.z),
					(this.w -= t.w);
			}),
			(t.transform = function (t) {
				var e = this.x,
					i = this.y,
					n = this.z,
					r = this.w,
					t = t.mat;
				return (
					(this.x = e * t[0] + i * t[4] + n * t[8] + r * t[12]),
					(this.y = e * t[1] + i * t[5] + n * t[9] + r * t[13]),
					(this.z = e * t[2] + i * t[6] + n * t[10] + r * t[14]),
					(this.w = e * t[3] + i * t[7] + n * t[11] + r * t[15]),
					this
				);
			}),
			(o.math.Vec4.transformArray = function (t, e) {
				for (var i = [], n = 0; n < t.length; n++) {
					var r = new o.math.Vec4(t[n]);
					r.transform(e), i.push(r);
				}
				return i;
			}),
			(t.equals = function (t) {
				var e = o.math.EPSILON;
				return (
					this.x < t.x + e &&
					this.x > t.x - e &&
					this.y < t.y + e &&
					this.y > t.y - e &&
					this.z < t.z + e &&
					this.z > t.z - e &&
					this.w < t.w + e &&
					this.w > t.w - e
				);
			}),
			(t.assignFrom = function (t) {
				return (
					(this.x = t.x),
					(this.y = t.y),
					(this.z = t.z),
					(this.w = t.w),
					this
				);
			}),
			(t.toTypeArray = function () {
				var t = new Float32Array(4);
				return (
					(t[0] = this.x),
					(t[1] = this.y),
					(t[2] = this.z),
					(t[3] = this.w),
					t
				);
			});
	})(cc),
	(function (_) {
		function u(t, e, i) {
			e = new _.math.Vec2(e);
			e.subtract(t), (i.x = -e.y), (i.y = e.x), i.normalize();
		}
		(_.math.Ray2 = function (t, e) {
			(this.start = t || new _.math.Vec2()),
				(this.dir = e || new _.math.Vec2());
		}),
			(_.math.Ray2.prototype.fill = function (t, e, i, n) {
				(this.start.x = t),
					(this.start.y = e),
					(this.dir.x = i),
					(this.dir.y = n);
			}),
			(_.math.Ray2.prototype.intersectLineSegment = function (t, e, i) {
				var n = this.start.x,
					r = this.start.y,
					o = this.start.x + this.dir.x,
					s = this.start.y + this.dir.y,
					c = t.x,
					a = t.y,
					l = e.x,
					h = e.y,
					u = (h - a) * (o - n) - (l - c) * (s - r);
				return (
					!(u > -_.math.EPSILON && u < _.math.EPSILON) &&
					((u =
						r +
						(c = ((l - c) * (r - a) - (h - a) * (n - c)) / u) *
							(s - r)),
					!(
						(c = n + c * (o - n)) <
							Math.min(t.x, e.x) - _.math.EPSILON ||
						c > Math.max(t.x, e.x) + _.math.EPSILON ||
						u < Math.min(t.y, e.y) - _.math.EPSILON ||
						u > Math.max(t.y, e.y) + _.math.EPSILON
					) &&
						!(
							c < Math.min(n, o) - _.math.EPSILON ||
							c > Math.max(n, o) + _.math.EPSILON ||
							u < Math.min(r, s) - _.math.EPSILON ||
							u > Math.max(r, s) + _.math.EPSILON
						) &&
						((i.x = c), (i.y = u), !0))
				);
			}),
			(_.math.Ray2.prototype.intersectTriangle = function (
				t,
				e,
				i,
				n,
				r
			) {
				var o,
					s = new _.math.Vec2(),
					c = new _.math.Vec2(),
					a = new _.math.Vec2(),
					l = 1e4,
					h = !1;
				return (
					this.intersectLineSegment(t, e, s) &&
						((h = !0),
						(o = s.subtract(this.start).length()) < l &&
							((c.x = s.x), (c.y = s.y), (l = o), u(t, e, a))),
					this.intersectLineSegment(e, i, s) &&
						((h = !0),
						(o = s.subtract(this.start).length()) < l &&
							((c.x = s.x), (c.y = s.y), (l = o), u(e, i, a))),
					this.intersectLineSegment(i, t, s) &&
						((h = !0),
						(o = s.subtract(this.start).length()) < l &&
							((c.x = s.x), (c.y = s.y), (l = o), u(i, t, a))),
					h &&
						((n.x = c.x),
						(n.y = c.y),
						r && ((r.x = a.x), (r.y = a.y))),
					h
				);
			});
	})(cc),
	(window.Uint16Array = window.Uint16Array || window.Array),
	(window.Float32Array = window.Float32Array || window.Array),
	(function (o) {
		(o.math.Matrix3 = function (t) {
			t && t.mat
				? (this.mat = new Float32Array(t.mat))
				: (this.mat = new Float32Array(9));
		}),
			(o.kmMat3 = o.math.Matrix3);
		var t = o.math.Matrix3.prototype;
		(t.fill = function (t) {
			var e = this.mat,
				t = t.mat;
			return (
				(e[0] = t[0]),
				(e[1] = t[1]),
				(e[2] = t[2]),
				(e[3] = t[3]),
				(e[4] = t[4]),
				(e[5] = t[5]),
				(e[6] = t[6]),
				(e[7] = t[7]),
				(e[8] = t[8]),
				this
			);
		}),
			(t.adjugate = function () {
				var t = this.mat,
					e = t[0],
					i = t[1],
					n = t[2],
					r = t[3],
					o = t[4],
					s = t[5],
					c = t[6],
					a = t[7],
					l = t[8];
				return (
					(t[0] = o * l - s * a),
					(t[1] = n * a - i * l),
					(t[2] = i * s - n * o),
					(t[3] = s * c - r * l),
					(t[4] = e * l - n * c),
					(t[5] = n * r - e * s),
					(t[6] = r * a - o * c),
					(t[8] = e * o - i * r),
					this
				);
			}),
			(t.identity = function () {
				var t = this.mat;
				return (
					(t[1] = t[2] = t[3] = t[5] = t[6] = t[7] = 0),
					(t[0] = t[4] = t[8] = 1),
					this
				);
			});
		var e = new o.math.Matrix3();
		(t.inverse = function (t) {
			if (0 === t) return this;
			e.assignFrom(this);
			t = 1 / t;
			return this.adjugate(), this.multiplyScalar(t), this;
		}),
			(t.isIdentity = function () {
				var t = this.mat;
				return (
					1 === t[0] &&
					0 === t[1] &&
					0 === t[2] &&
					0 === t[3] &&
					1 === t[4] &&
					0 === t[5] &&
					0 === t[6] &&
					0 === t[7] &&
					1 === t[8]
				);
			}),
			(t.transpose = function () {
				var t = this.mat,
					e = t[1],
					i = t[2],
					n = t[3],
					r = t[5],
					o = t[6],
					s = t[7];
				return (
					(t[1] = n),
					(t[2] = o),
					(t[3] = e),
					(t[5] = s),
					(t[6] = i),
					(t[7] = r),
					this
				);
			}),
			(t.determinant = function () {
				var t = this.mat,
					e =
						t[0] * t[4] * t[8] +
						t[1] * t[5] * t[6] +
						t[2] * t[3] * t[7];
				return (e -=
					t[2] * t[4] * t[6] +
					t[0] * t[5] * t[7] +
					t[1] * t[3] * t[8]);
			}),
			(t.multiply = function (t) {
				var e = this.mat,
					i = t.mat,
					n = e[0],
					r = e[1],
					o = e[2],
					s = e[3],
					c = e[4],
					a = e[5],
					l = e[6],
					h = e[7],
					u = e[8],
					_ = i[0],
					d = i[1],
					p = i[2],
					f = i[3],
					m = i[4],
					g = i[5],
					y = i[6],
					t = i[7],
					i = i[8];
				return (
					(e[0] = n * _ + s * d + l * p),
					(e[1] = r * _ + c * d + h * p),
					(e[2] = o * _ + a * d + u * p),
					(e[3] = o * _ + a * d + u * p),
					(e[4] = r * f + c * m + h * g),
					(e[5] = o * f + a * m + u * g),
					(e[6] = n * y + s * t + l * i),
					(e[7] = r * y + c * t + h * i),
					(e[8] = o * y + a * t + u * i),
					this
				);
			}),
			(t.multiplyScalar = function (t) {
				var e = this.mat;
				return (
					(e[0] *= t),
					(e[1] *= t),
					(e[2] *= t),
					(e[3] *= t),
					(e[4] *= t),
					(e[5] *= t),
					(e[6] *= t),
					(e[7] *= t),
					(e[8] *= t),
					this
				);
			}),
			(o.math.Matrix3.rotationAxisAngle = function (t, e) {
				var i = Math.cos(e),
					n = Math.sin(e),
					r = new o.math.Matrix3(),
					e = r.mat;
				return (
					(e[0] = i + t.x * t.x * (1 - i)),
					(e[1] = t.z * n + t.y * t.x * (1 - i)),
					(e[2] = -t.y * n + t.z * t.x * (1 - i)),
					(e[3] = -t.z * n + t.x * t.y * (1 - i)),
					(e[4] = i + t.y * t.y * (1 - i)),
					(e[5] = t.x * n + t.z * t.y * (1 - i)),
					(e[6] = t.y * n + t.x * t.z * (1 - i)),
					(e[7] = -t.x * n + t.y * t.z * (1 - i)),
					(e[8] = i + t.z * t.z * (1 - i)),
					r
				);
			}),
			(t.assignFrom = function (t) {
				if (this === t)
					return (
						o.log(
							'cc.math.Matrix3.assign(): current matrix equals matIn'
						),
						this
					);
				var e = this.mat,
					t = t.mat;
				return (
					(e[0] = t[0]),
					(e[1] = t[1]),
					(e[2] = t[2]),
					(e[3] = t[3]),
					(e[4] = t[4]),
					(e[5] = t[5]),
					(e[6] = t[6]),
					(e[7] = t[7]),
					(e[8] = t[8]),
					this
				);
			}),
			(t.equals = function (t) {
				if (this === t) return !0;
				for (
					var e = o.math.EPSILON, i = this.mat, n = t.mat, r = 0;
					r < 9;
					++r
				)
					if (!(i[r] + e > n[r] && i[r] - e < n[r])) return !1;
				return !0;
			}),
			(o.math.Matrix3.createByRotationX = function (t) {
				var e = new o.math.Matrix3(),
					i = e.mat;
				return (
					(i[0] = 1),
					(i[1] = 0),
					(i[2] = 0),
					(i[3] = 0),
					(i[4] = Math.cos(t)),
					(i[5] = Math.sin(t)),
					(i[6] = 0),
					(i[7] = -Math.sin(t)),
					(i[8] = Math.cos(t)),
					e
				);
			}),
			(o.math.Matrix3.createByRotationY = function (t) {
				var e = new o.math.Matrix3(),
					i = e.mat;
				return (
					(i[0] = Math.cos(t)),
					(i[1] = 0),
					(i[2] = -Math.sin(t)),
					(i[3] = 0),
					(i[4] = 1),
					(i[5] = 0),
					(i[6] = Math.sin(t)),
					(i[7] = 0),
					(i[8] = Math.cos(t)),
					e
				);
			}),
			(o.math.Matrix3.createByRotationZ = function (t) {
				var e = new o.math.Matrix3(),
					i = e.mat;
				return (
					(i[0] = Math.cos(t)),
					(i[1] = -Math.sin(t)),
					(i[2] = 0),
					(i[3] = Math.sin(t)),
					(i[4] = Math.cos(t)),
					(i[5] = 0),
					(i[6] = 0),
					(i[7] = 0),
					(i[8] = 1),
					e
				);
			}),
			(o.math.Matrix3.createByRotation = function (t) {
				var e = new o.math.Matrix3(),
					i = e.mat;
				return (
					(i[0] = Math.cos(t)),
					(i[1] = Math.sin(t)),
					(i[2] = 0),
					(i[3] = -Math.sin(t)),
					(i[4] = Math.cos(t)),
					(i[5] = 0),
					(i[6] = 0),
					(i[7] = 0),
					(i[8] = 1),
					e
				);
			}),
			(o.math.Matrix3.createByScale = function (t, e) {
				var i = new o.math.Matrix3();
				return i.identity(), (i.mat[0] = t), (i.mat[4] = e), i;
			}),
			(o.math.Matrix3.createByTranslation = function (t, e) {
				var i = new o.math.Matrix3();
				return i.identity(), (i.mat[6] = t), (i.mat[7] = e), i;
			}),
			(o.math.Matrix3.createByQuaternion = function (t) {
				if (!t) return null;
				var e = new o.math.Matrix3(),
					i = e.mat;
				return (
					(i[0] = 1 - 2 * (t.y * t.y + t.z * t.z)),
					(i[1] = 2 * (t.x * t.y - t.w * t.z)),
					(i[2] = 2 * (t.x * t.z + t.w * t.y)),
					(i[3] = 2 * (t.x * t.y + t.w * t.z)),
					(i[4] = 1 - 2 * (t.x * t.x + t.z * t.z)),
					(i[5] = 2 * (t.y * t.z - t.w * t.x)),
					(i[6] = 2 * (t.x * t.z - t.w * t.y)),
					(i[7] = 2 * (t.y * t.z + t.w * t.x)),
					(i[8] = 1 - 2 * (t.x * t.x + t.y * t.y)),
					e
				);
			}),
			(t.rotationToAxisAngle = function () {
				return o.math.Quaternion.rotationMatrix(this).toAxisAndAngle();
			});
	})(cc),
	(function (h) {
		(h.math.Matrix4 = function (t) {
			t && t.mat
				? (this.mat = new Float32Array(t.mat))
				: (this.mat = new Float32Array(16));
		}),
			(h.kmMat4 = h.math.Matrix4);
		var t = h.math.Matrix4.prototype;
		(t.fill = function (t) {
			for (var e = this.mat, i = 0; i < 16; i++) e[i] = t[i];
			return this;
		}),
			(h.kmMat4Identity = function (t) {
				var e = t.mat;
				return (
					(e[1] =
						e[2] =
						e[3] =
						e[4] =
						e[6] =
						e[7] =
						e[8] =
						e[9] =
						e[11] =
						e[12] =
						e[13] =
						e[14] =
							0),
					(e[0] = e[5] = e[10] = e[15] = 1),
					t
				);
			}),
			(t.identity = function () {
				var t = this.mat;
				return (
					(t[1] =
						t[2] =
						t[3] =
						t[4] =
						t[6] =
						t[7] =
						t[8] =
						t[9] =
						t[11] =
						t[12] =
						t[13] =
						t[14] =
							0),
					(t[0] = t[5] = t[10] = t[15] = 1),
					this
				);
			}),
			(t.get = function (t, e) {
				return this.mat[t + 4 * e];
			}),
			(t.set = function (t, e, i) {
				this.mat[t + 4 * e] = i;
			}),
			(t.swap = function (t, e, i, n) {
				var r = this.mat,
					o = r[t + 4 * e];
				(r[t + 4 * e] = r[i + 4 * n]), (r[i + 4 * n] = o);
			}),
			(h.math.Matrix4._gaussj = function (t, e) {
				for (
					var i,
						n,
						r,
						o,
						s,
						c,
						a,
						l,
						h = 0,
						u = 0,
						_ = [0, 0, 0, 0],
						d = [0, 0, 0, 0],
						p = [0, 0, 0, 0],
						f = 0;
					f < 4;
					f++
				) {
					for (i = c = 0; i < 4; i++)
						if (1 !== p[i])
							for (n = 0; n < 4; n++)
								0 === p[n] &&
									c <= (s = Math.abs(t.get(i, n))) &&
									((c = s), (u = i), (h = n));
					if ((++p[h], u !== h)) {
						for (r = 0; r < 4; r++) t.swap(u, r, h, r);
						for (r = 0; r < 4; r++) e.swap(u, r, h, r);
					}
					if (((d[f] = u), (_[f] = h), 0 === t.get(h, h))) return !1;
					for (l = 1 / t.get(h, h), t.set(h, h, 1), r = 0; r < 4; r++)
						t.set(h, r, t.get(h, r) * l);
					for (r = 0; r < 4; r++) e.set(h, r, e.get(h, r) * l);
					for (o = 0; o < 4; o++)
						if (o !== h) {
							for (
								a = t.get(o, h), t.set(o, h, 0), r = 0;
								r < 4;
								r++
							)
								t.set(o, r, t.get(o, r) - t.get(h, r) * a);
							for (r = 0; r < 4; r++)
								e.set(o, r, t.get(o, r) - e.get(h, r) * a);
						}
				}
				for (r = 3; 0 <= r; r--)
					if (d[r] !== _[r])
						for (n = 0; n < 4; n++) t.swap(n, d[r], n, _[r]);
				return !0;
			});
		var n = new h.math.Matrix4().identity();
		(h.kmMat4Inverse = function (t, e) {
			var i = new h.math.Matrix4(e),
				e = new h.math.Matrix4(n);
			return !1 === h.math.Matrix4._gaussj(i, e)
				? null
				: (t.assignFrom(i), t);
		}),
			(t.inverse = function () {
				var t = new h.math.Matrix4(this),
					e = new h.math.Matrix4(n);
				return !1 === h.math.Matrix4._gaussj(t, e) ? null : t;
			}),
			(t.isIdentity = function () {
				var t = this.mat;
				return (
					1 === t[0] &&
					0 === t[1] &&
					0 === t[2] &&
					0 === t[3] &&
					0 === t[4] &&
					1 === t[5] &&
					0 === t[6] &&
					0 === t[7] &&
					0 === t[8] &&
					0 === t[9] &&
					1 === t[10] &&
					0 === t[11] &&
					0 === t[12] &&
					0 === t[13] &&
					0 === t[14] &&
					1 === t[15]
				);
			}),
			(t.transpose = function () {
				var t = this.mat,
					e = t[1],
					i = t[2],
					n = t[3],
					r = t[4],
					o = t[6],
					s = t[7],
					c = t[8],
					a = t[9],
					l = t[11],
					h = t[12],
					u = t[13],
					_ = t[14];
				return (
					(t[1] = r),
					(t[2] = c),
					(t[3] = h),
					(t[4] = e),
					(t[6] = a),
					(t[7] = u),
					(t[8] = i),
					(t[9] = o),
					(t[11] = _),
					(t[12] = n),
					(t[13] = s),
					(t[14] = l),
					this
				);
			}),
			(h.kmMat4Multiply = function (t, e, i) {
				var n = t.mat,
					r = e.mat,
					o = i.mat,
					s = r[0],
					c = r[1],
					a = r[2],
					l = r[3],
					h = r[4],
					u = r[5],
					_ = r[6],
					d = r[7],
					p = r[8],
					f = r[9],
					m = r[10],
					g = r[11],
					y = r[12],
					T = r[13],
					S = r[14],
					C = r[15],
					x = o[0],
					v = o[1],
					E = o[2],
					A = o[3],
					b = o[4],
					R = o[5],
					P = o[6],
					I = o[7],
					w = o[8],
					D = o[9],
					L = o[10],
					O = o[11],
					e = o[12],
					i = o[13],
					r = o[14],
					o = o[15];
				return (
					(n[0] = x * s + v * h + E * p + A * y),
					(n[1] = x * c + v * u + E * f + A * T),
					(n[2] = x * a + v * _ + E * m + A * S),
					(n[3] = x * l + v * d + E * g + A * C),
					(n[4] = b * s + R * h + P * p + I * y),
					(n[5] = b * c + R * u + P * f + I * T),
					(n[6] = b * a + R * _ + P * m + I * S),
					(n[7] = b * l + R * d + P * g + I * C),
					(n[8] = w * s + D * h + L * p + O * y),
					(n[9] = w * c + D * u + L * f + O * T),
					(n[10] = w * a + D * _ + L * m + O * S),
					(n[11] = w * l + D * d + L * g + O * C),
					(n[12] = e * s + i * h + r * p + o * y),
					(n[13] = e * c + i * u + r * f + o * T),
					(n[14] = e * a + i * _ + r * m + o * S),
					(n[15] = e * l + i * d + r * g + o * C),
					t
				);
			}),
			(t.multiply = function (t) {
				var e = this.mat,
					i = t.mat,
					n = e[0],
					r = e[1],
					o = e[2],
					s = e[3],
					c = e[4],
					a = e[5],
					l = e[6],
					h = e[7],
					u = e[8],
					_ = e[9],
					d = e[10],
					p = e[11],
					f = e[12],
					m = e[13],
					g = e[14],
					y = e[15],
					T = i[0],
					S = i[1],
					C = i[2],
					x = i[3],
					v = i[4],
					E = i[5],
					A = i[6],
					b = i[7],
					R = i[8],
					P = i[9],
					I = i[10],
					w = i[11],
					D = i[12],
					L = i[13],
					t = i[14],
					i = i[15];
				return (
					(e[0] = T * n + S * c + C * u + x * f),
					(e[1] = T * r + S * a + C * _ + x * m),
					(e[2] = T * o + S * l + C * d + x * g),
					(e[3] = T * s + S * h + C * p + x * y),
					(e[4] = v * n + E * c + A * u + b * f),
					(e[5] = v * r + E * a + A * _ + b * m),
					(e[6] = v * o + E * l + A * d + b * g),
					(e[7] = v * s + E * h + A * p + b * y),
					(e[8] = R * n + P * c + I * u + w * f),
					(e[9] = R * r + P * a + I * _ + w * m),
					(e[10] = R * o + P * l + I * d + w * g),
					(e[11] = R * s + P * h + I * p + w * y),
					(e[12] = D * n + L * c + t * u + i * f),
					(e[13] = D * r + L * a + t * _ + i * m),
					(e[14] = D * o + L * l + t * d + i * g),
					(e[15] = D * s + L * h + t * p + i * y),
					this
				);
			}),
			(h.getMat4MultiplyValue = function (t, e) {
				var i = t.mat,
					t = e.mat,
					e = new Float32Array(16);
				return (
					(e[0] =
						i[0] * t[0] + i[4] * t[1] + i[8] * t[2] + i[12] * t[3]),
					(e[1] =
						i[1] * t[0] + i[5] * t[1] + i[9] * t[2] + i[13] * t[3]),
					(e[2] =
						i[2] * t[0] +
						i[6] * t[1] +
						i[10] * t[2] +
						i[14] * t[3]),
					(e[3] =
						i[3] * t[0] +
						i[7] * t[1] +
						i[11] * t[2] +
						i[15] * t[3]),
					(e[4] =
						i[0] * t[4] + i[4] * t[5] + i[8] * t[6] + i[12] * t[7]),
					(e[5] =
						i[1] * t[4] + i[5] * t[5] + i[9] * t[6] + i[13] * t[7]),
					(e[6] =
						i[2] * t[4] +
						i[6] * t[5] +
						i[10] * t[6] +
						i[14] * t[7]),
					(e[7] =
						i[3] * t[4] +
						i[7] * t[5] +
						i[11] * t[6] +
						i[15] * t[7]),
					(e[8] =
						i[0] * t[8] +
						i[4] * t[9] +
						i[8] * t[10] +
						i[12] * t[11]),
					(e[9] =
						i[1] * t[8] +
						i[5] * t[9] +
						i[9] * t[10] +
						i[13] * t[11]),
					(e[10] =
						i[2] * t[8] +
						i[6] * t[9] +
						i[10] * t[10] +
						i[14] * t[11]),
					(e[11] =
						i[3] * t[8] +
						i[7] * t[9] +
						i[11] * t[10] +
						i[15] * t[11]),
					(e[12] =
						i[0] * t[12] +
						i[4] * t[13] +
						i[8] * t[14] +
						i[12] * t[15]),
					(e[13] =
						i[1] * t[12] +
						i[5] * t[13] +
						i[9] * t[14] +
						i[13] * t[15]),
					(e[14] =
						i[2] * t[12] +
						i[6] * t[13] +
						i[10] * t[14] +
						i[14] * t[15]),
					(e[15] =
						i[3] * t[12] +
						i[7] * t[13] +
						i[11] * t[14] +
						i[15] * t[15]),
					e
				);
			}),
			(h.kmMat4Assign = function (t, e) {
				if (t === e)
					return h.log('cc.kmMat4Assign(): pOut equals pIn'), t;
				var i = t.mat,
					e = e.mat;
				return (
					(i[0] = e[0]),
					(i[1] = e[1]),
					(i[2] = e[2]),
					(i[3] = e[3]),
					(i[4] = e[4]),
					(i[5] = e[5]),
					(i[6] = e[6]),
					(i[7] = e[7]),
					(i[8] = e[8]),
					(i[9] = e[9]),
					(i[10] = e[10]),
					(i[11] = e[11]),
					(i[12] = e[12]),
					(i[13] = e[13]),
					(i[14] = e[14]),
					(i[15] = e[15]),
					t
				);
			}),
			(t.assignFrom = function (t) {
				if (this === t)
					return (
						h.log(
							'cc.mat.Matrix4.assignFrom(): mat4 equals current matrix'
						),
						this
					);
				var e = this.mat,
					t = t.mat;
				return (
					(e[0] = t[0]),
					(e[1] = t[1]),
					(e[2] = t[2]),
					(e[3] = t[3]),
					(e[4] = t[4]),
					(e[5] = t[5]),
					(e[6] = t[6]),
					(e[7] = t[7]),
					(e[8] = t[8]),
					(e[9] = t[9]),
					(e[10] = t[10]),
					(e[11] = t[11]),
					(e[12] = t[12]),
					(e[13] = t[13]),
					(e[14] = t[14]),
					(e[15] = t[15]),
					this
				);
			}),
			(t.equals = function (t) {
				if (this === t)
					return (
						h.log(
							'cc.kmMat4AreEqual(): pMat1 and pMat2 are same object.'
						),
						!0
					);
				for (
					var e = this.mat, i = t.mat, n = h.math.EPSILON, r = 0;
					r < 16;
					r++
				)
					if (!(e[r] + n > i[r] && e[r] - n < i[r])) return !1;
				return !0;
			}),
			(h.math.Matrix4.createByRotationX = function (t, e) {
				var i = (e = e || new h.math.Matrix4()).mat;
				return (
					(i[0] = 1),
					(i[3] = i[2] = i[1] = 0),
					(i[4] = 0),
					(i[5] = Math.cos(t)),
					(i[6] = Math.sin(t)),
					(i[7] = 0),
					(i[8] = 0),
					(i[9] = -Math.sin(t)),
					(i[10] = Math.cos(t)),
					(i[11] = 0),
					(i[14] = i[13] = i[12] = 0),
					(i[15] = 1),
					e
				);
			}),
			(h.math.Matrix4.createByRotationY = function (t, e) {
				var i = (e = e || new h.math.Matrix4()).mat;
				return (
					(i[0] = Math.cos(t)),
					(i[1] = 0),
					(i[2] = -Math.sin(t)),
					(i[3] = 0),
					(i[7] = i[6] = i[4] = 0),
					(i[5] = 1),
					(i[8] = Math.sin(t)),
					(i[9] = 0),
					(i[10] = Math.cos(t)),
					(i[11] = 0),
					(i[14] = i[13] = i[12] = 0),
					(i[15] = 1),
					e
				);
			}),
			(h.math.Matrix4.createByRotationZ = function (t, e) {
				var i = (e = e || new h.math.Matrix4()).mat;
				return (
					(i[0] = Math.cos(t)),
					(i[1] = Math.sin(t)),
					(i[3] = i[2] = 0),
					(i[4] = -Math.sin(t)),
					(i[5] = Math.cos(t)),
					(i[7] = i[6] = 0),
					(i[11] = i[9] = i[8] = 0),
					(i[10] = 1),
					(i[14] = i[13] = i[12] = 0),
					(i[15] = 1),
					e
				);
			}),
			(h.math.Matrix4.createByPitchYawRoll = function (t, e, i, n) {
				n = n || new h.math.Matrix4();
				var r = Math.cos(t),
					o = Math.sin(t),
					s = Math.cos(e),
					c = Math.sin(e),
					a = Math.cos(i),
					l = Math.sin(i),
					t = o * c,
					e = r * c,
					i = n.mat;
				return (
					(i[0] = s * a),
					(i[4] = s * l),
					(i[8] = -c),
					(i[1] = t * a - r * l),
					(i[5] = t * l + r * a),
					(i[9] = o * s),
					(i[2] = e * a + o * l),
					(i[6] = e * l - o * a),
					(i[10] = r * s),
					(i[3] = i[7] = i[11] = 0),
					(i[15] = 1),
					n
				);
			}),
			(h.math.Matrix4.createByQuaternion = function (t, e) {
				var i = (e = e || new h.math.Matrix4()).mat;
				return (
					(i[0] = 1 - 2 * (t.y * t.y + t.z * t.z)),
					(i[1] = 2 * (t.x * t.y + t.z * t.w)),
					(i[2] = 2 * (t.x * t.z - t.y * t.w)),
					(i[3] = 0),
					(i[4] = 2 * (t.x * t.y - t.z * t.w)),
					(i[5] = 1 - 2 * (t.x * t.x + t.z * t.z)),
					(i[6] = 2 * (t.z * t.y + t.x * t.w)),
					(i[7] = 0),
					(i[8] = 2 * (t.x * t.z + t.y * t.w)),
					(i[9] = 2 * (t.y * t.z - t.x * t.w)),
					(i[10] = 1 - 2 * (t.x * t.x + t.y * t.y)),
					(i[11] = 0),
					(i[14] = i[13] = i[12] = 0),
					(i[15] = 1),
					e
				);
			}),
			(h.math.Matrix4.createByRotationTranslation = function (t, e, i) {
				var n = (i = i || new h.math.Matrix4()).mat,
					t = t.mat;
				return (
					(n[0] = t[0]),
					(n[1] = t[1]),
					(n[2] = t[2]),
					(n[3] = 0),
					(n[4] = t[3]),
					(n[5] = t[4]),
					(n[6] = t[5]),
					(n[7] = 0),
					(n[8] = t[6]),
					(n[9] = t[7]),
					(n[10] = t[8]),
					(n[11] = 0),
					(n[12] = e.x),
					(n[13] = e.y),
					(n[14] = e.z),
					(n[15] = 1),
					i
				);
			}),
			(h.math.Matrix4.createByScale = function (t, e, i, n) {
				var r = (n = n || new h.math.Matrix4()).mat;
				return (
					(r[0] = t),
					(r[5] = e),
					(r[10] = i),
					(r[15] = 1),
					(r[1] =
						r[2] =
						r[3] =
						r[4] =
						r[6] =
						r[7] =
						r[8] =
						r[9] =
						r[11] =
						r[12] =
						r[13] =
						r[14] =
							0),
					n
				);
			}),
			(h.kmMat4Translation = function (t, e, i, n) {
				return (
					(t.mat[0] = t.mat[5] = t.mat[10] = t.mat[15] = 1),
					(t.mat[1] =
						t.mat[2] =
						t.mat[3] =
						t.mat[4] =
						t.mat[6] =
						t.mat[7] =
						t.mat[8] =
						t.mat[9] =
						t.mat[11] =
							0),
					(t.mat[12] = e),
					(t.mat[13] = i),
					(t.mat[14] = n),
					t
				);
			}),
			(h.math.Matrix4.createByTranslation = function (t, e, i, n) {
				return (
					(n = n || new h.math.Matrix4()).identity(),
					(n.mat[12] = t),
					(n.mat[13] = e),
					(n.mat[14] = i),
					n
				);
			}),
			(t.getUpVec3 = function () {
				var t = this.mat;
				return new h.math.Vec3(t[4], t[5], t[6]).normalize();
			}),
			(t.getRightVec3 = function () {
				var t = this.mat;
				return new h.math.Vec3(t[0], t[1], t[2]).normalize();
			}),
			(t.getForwardVec3 = function () {
				var t = this.mat;
				return new h.math.Vec3(t[8], t[9], t[10]).normalize();
			}),
			(h.kmMat4PerspectiveProjection = function (t, e, i, n, r) {
				var o = h.degreesToRadians(e / 2),
					s = r - n,
					e = Math.sin(o);
				if (0 == s || 0 === e || 0 === i) return null;
				e = Math.cos(o) / e;
				return (
					t.identity(),
					(t.mat[0] = e / i),
					(t.mat[5] = e),
					(t.mat[10] = -(r + n) / s),
					(t.mat[11] = -1),
					(t.mat[14] = (-2 * n * r) / s),
					(t.mat[15] = 0),
					t
				);
			}),
			(h.math.Matrix4.createPerspectiveProjection = function (
				t,
				e,
				i,
				n
			) {
				var r = h.degreesToRadians(t / 2),
					o = n - i,
					s = Math.sin(r);
				if (0 == o || 0 === s || 0 === e) return null;
				(t = Math.cos(r) / s), (r = new h.math.Matrix4()), (s = r.mat);
				return (
					r.identity(),
					(s[0] = t / e),
					(s[5] = t),
					(s[10] = -(n + i) / o),
					(s[11] = -1),
					(s[14] = (-2 * i * n) / o),
					(s[15] = 0),
					r
				);
			}),
			(h.kmMat4OrthographicProjection = function (t, e, i, n, r, o, s) {
				return (
					t.identity(),
					(t.mat[0] = 2 / (i - e)),
					(t.mat[5] = 2 / (r - n)),
					(t.mat[10] = -2 / (s - o)),
					(t.mat[12] = -(i + e) / (i - e)),
					(t.mat[13] = -(r + n) / (r - n)),
					(t.mat[14] = -(s + o) / (s - o)),
					t
				);
			}),
			(h.math.Matrix4.createOrthographicProjection = function (
				t,
				e,
				i,
				n,
				r,
				o
			) {
				var s = new h.math.Matrix4(),
					c = s.mat;
				return (
					s.identity(),
					(c[0] = 2 / (e - t)),
					(c[5] = 2 / (n - i)),
					(c[10] = -2 / (o - r)),
					(c[12] = -(e + t) / (e - t)),
					(c[13] = -(n + i) / (n - i)),
					(c[14] = -(o + r) / (o - r)),
					s
				);
			}),
			(h.kmMat4LookAt = function (t, e, i, n) {
				var r = new h.math.Vec3(i),
					i = new h.math.Vec3(n);
				r.subtract(e), r.normalize(), i.normalize();
				n = new h.math.Vec3(r);
				n.cross(i), n.normalize();
				i = new h.math.Vec3(n);
				i.cross(r),
					n.normalize(),
					t.identity(),
					(t.mat[0] = n.x),
					(t.mat[4] = n.y),
					(t.mat[8] = n.z),
					(t.mat[1] = i.x),
					(t.mat[5] = i.y),
					(t.mat[9] = i.z),
					(t.mat[2] = -r.x),
					(t.mat[6] = -r.y),
					(t.mat[10] = -r.z);
				e = h.math.Matrix4.createByTranslation(-e.x, -e.y, -e.z);
				return t.multiply(e), t;
			});
		var o = new h.math.Matrix4();
		(t.lookAt = function (t, e, i) {
			var n = new h.math.Vec3(e),
				r = new h.math.Vec3(i),
				e = this.mat;
			n.subtract(t), n.normalize(), r.normalize();
			i = new h.math.Vec3(n);
			i.cross(r), i.normalize();
			r = new h.math.Vec3(i);
			return (
				r.cross(n),
				i.normalize(),
				this.identity(),
				(e[0] = i.x),
				(e[4] = i.y),
				(e[8] = i.z),
				(e[1] = r.x),
				(e[5] = r.y),
				(e[9] = r.z),
				(e[2] = -n.x),
				(e[6] = -n.y),
				(e[10] = -n.z),
				(o = h.math.Matrix4.createByTranslation(-t.x, -t.y, -t.z, o)),
				this.multiply(o),
				this
			);
		}),
			(h.kmMat4RotationAxisAngle = function (t, e, i) {
				var n = Math.cos(i),
					i = Math.sin(i),
					e = new h.math.Vec3(e);
				return (
					e.normalize(),
					(t.mat[0] = n + e.x * e.x * (1 - n)),
					(t.mat[1] = e.z * i + e.y * e.x * (1 - n)),
					(t.mat[2] = -e.y * i + e.z * e.x * (1 - n)),
					(t.mat[3] = 0),
					(t.mat[4] = -e.z * i + e.x * e.y * (1 - n)),
					(t.mat[5] = n + e.y * e.y * (1 - n)),
					(t.mat[6] = e.x * i + e.z * e.y * (1 - n)),
					(t.mat[7] = 0),
					(t.mat[8] = e.y * i + e.x * e.z * (1 - n)),
					(t.mat[9] = -e.x * i + e.y * e.z * (1 - n)),
					(t.mat[10] = n + e.z * e.z * (1 - n)),
					(t.mat[11] = 0),
					(t.mat[12] = 0),
					(t.mat[13] = 0),
					(t.mat[14] = 0),
					(t.mat[15] = 1),
					t
				);
			}),
			(h.math.Matrix4.createByAxisAndAngle = function (t, e, i) {
				i = i || new h.math.Matrix4();
				var n = this.mat,
					r = Math.cos(e),
					e = Math.sin(e),
					t = new h.math.Vec3(t);
				return (
					t.normalize(),
					(n[0] = r + t.x * t.x * (1 - r)),
					(n[1] = t.z * e + t.y * t.x * (1 - r)),
					(n[2] = -t.y * e + t.z * t.x * (1 - r)),
					(n[3] = 0),
					(n[4] = -t.z * e + t.x * t.y * (1 - r)),
					(n[5] = r + t.y * t.y * (1 - r)),
					(n[6] = t.x * e + t.z * t.y * (1 - r)),
					(n[7] = 0),
					(n[8] = t.y * e + t.x * t.z * (1 - r)),
					(n[9] = -t.x * e + t.y * t.z * (1 - r)),
					(n[10] = r + t.z * t.z * (1 - r)),
					(n[11] = 0),
					(n[12] = n[13] = n[14] = 0),
					(n[15] = 1),
					i
				);
			}),
			(t.extractRotation = function () {
				var t = new h.math.Matrix3(),
					e = this.mat,
					i = t.mat;
				return (
					(i[0] = e[0]),
					(i[1] = e[1]),
					(i[2] = e[2]),
					(i[3] = e[4]),
					(i[4] = e[5]),
					(i[5] = e[6]),
					(i[6] = e[8]),
					(i[7] = e[9]),
					(i[8] = e[10]),
					t
				);
			}),
			(t.extractPlane = function (t) {
				var e = new h.math.Plane(),
					i = this.mat;
				switch (t) {
					case h.math.Plane.RIGHT:
						(e.a = i[3] - i[0]),
							(e.b = i[7] - i[4]),
							(e.c = i[11] - i[8]),
							(e.d = i[15] - i[12]);
						break;
					case h.math.Plane.LEFT:
						(e.a = i[3] + i[0]),
							(e.b = i[7] + i[4]),
							(e.c = i[11] + i[8]),
							(e.d = i[15] + i[12]);
						break;
					case h.math.Plane.BOTTOM:
						(e.a = i[3] + i[1]),
							(e.b = i[7] + i[5]),
							(e.c = i[11] + i[9]),
							(e.d = i[15] + i[13]);
						break;
					case h.math.Plane.TOP:
						(e.a = i[3] - i[1]),
							(e.b = i[7] - i[5]),
							(e.c = i[11] - i[9]),
							(e.d = i[15] - i[13]);
						break;
					case h.math.Plane.FAR:
						(e.a = i[3] - i[2]),
							(e.b = i[7] - i[6]),
							(e.c = i[11] - i[10]),
							(e.d = i[15] - i[14]);
						break;
					case h.math.Plane.NEAR:
						(e.a = i[3] + i[2]),
							(e.b = i[7] + i[6]),
							(e.c = i[11] + i[10]),
							(e.d = i[15] + i[14]);
						break;
					default:
						h.log(
							'cc.math.Matrix4.extractPlane: Invalid plane index'
						);
				}
				t = Math.sqrt(e.a * e.a + e.b * e.b + e.c * e.c);
				return (e.a /= t), (e.b /= t), (e.c /= t), (e.d /= t), e;
			}),
			(t.toAxisAndAngle = function () {
				var t = this.extractRotation();
				return h.math.Quaternion.rotationMatrix(t).toAxisAndAngle();
			});
	})(cc),
	(function (r) {
		(r.math.Plane = function (t, e, i, n) {
			t && void 0 === e
				? ((this.a = t.a),
				  (this.b = t.b),
				  (this.c = t.c),
				  (this.d = t.d))
				: ((this.a = t || 0),
				  (this.b = e || 0),
				  (this.c = i || 0),
				  (this.d = n || 0));
		}),
			(r.kmPlane = r.math.Plane);
		var t = r.math.Plane.prototype;
		(r.math.Plane.LEFT = 0),
			(r.math.Plane.RIGHT = 1),
			(r.math.Plane.BOTTOM = 2),
			(r.math.Plane.TOP = 3),
			(r.math.Plane.NEAR = 4),
			(r.math.Plane.FAR = 5),
			(r.math.Plane.POINT_INFRONT_OF_PLANE = 0),
			(r.math.Plane.POINT_BEHIND_PLANE = 1),
			(r.math.Plane.POINT_ON_PLANE = 2),
			(t.dot = function (t) {
				return (
					this.a * t.x + this.b * t.y + this.c * t.z + this.d * t.w
				);
			}),
			(t.dotCoord = function (t) {
				return this.a * t.x + this.b * t.y + this.c * t.z + this.d;
			}),
			(t.dotNormal = function (t) {
				return this.a * t.x + this.b * t.y + this.c * t.z;
			}),
			(r.math.Plane.fromPointNormal = function (t, e) {
				return new r.math.Plane(e.x, e.y, e.z, -e.dot(t));
			}),
			(r.math.Plane.fromPoints = function (t, e, i) {
				var n = new r.math.Vec3(e),
					e = new r.math.Vec3(i),
					i = new r.math.Plane();
				return (
					n.subtract(t),
					e.subtract(t),
					n.cross(e),
					n.normalize(),
					(i.a = n.x),
					(i.b = n.y),
					(i.c = n.z),
					(i.d = n.scale(-1).dot(t)),
					i
				);
			}),
			(t.normalize = function () {
				var t = new r.math.Vec3(this.a, this.b, this.c),
					e = 1 / t.length();
				return (
					t.normalize(),
					(this.a = t.x),
					(this.b = t.y),
					(this.c = t.z),
					(this.d = this.d * e),
					this
				);
			}),
			(t.classifyPoint = function (t) {
				t = this.a * t.x + this.b * t.y + this.c * t.z + this.d;
				return 0.001 < t
					? r.math.Plane.POINT_INFRONT_OF_PLANE
					: t < -0.001
					? r.math.Plane.POINT_BEHIND_PLANE
					: r.math.Plane.POINT_ON_PLANE;
			});
	})(cc),
	(function (l) {
		(l.math.Quaternion = function (t, e, i, n) {
			t && void 0 === e
				? ((this.x = t.x),
				  (this.y = t.y),
				  (this.z = t.z),
				  (this.w = t.w))
				: ((this.x = t || 0),
				  (this.y = e || 0),
				  (this.z = i || 0),
				  (this.w = n || 0));
		}),
			(l.kmQuaternion = l.math.Quaternion);
		var t = l.math.Quaternion.prototype;
		(t.conjugate = function (t) {
			return (
				(this.x = -t.x),
				(this.y = -t.y),
				(this.z = -t.z),
				(this.w = t.w),
				this
			);
		}),
			(t.dot = function (t) {
				return (
					this.w * t.w + this.x * t.x + this.y * t.y + this.z * t.z
				);
			}),
			(t.exponential = function () {
				return this;
			}),
			(t.identity = function () {
				return (
					(this.x = 0), (this.y = 0), (this.z = 0), (this.w = 1), this
				);
			}),
			(t.inverse = function () {
				var t = this.length();
				return (
					Math.abs(t) > l.math.EPSILON
						? ((this.x = 0),
						  (this.y = 0),
						  (this.z = 0),
						  (this.w = 0))
						: this.conjugate(this).scale(1 / t),
					this
				);
			}),
			(t.isIdentity = function () {
				return (
					0 === this.x && 0 === this.y && 0 === this.z && 1 === this.w
				);
			}),
			(t.length = function () {
				return Math.sqrt(this.lengthSq());
			}),
			(t.lengthSq = function () {
				return (
					this.x * this.x +
					this.y * this.y +
					this.z * this.z +
					this.w * this.w
				);
			}),
			(t.multiply = function (t) {
				var e = this.x,
					i = this.y,
					n = this.z,
					r = this.w;
				return (
					(this.w = r * t.w - e * t.x - i * t.y - n * t.z),
					(this.x = r * t.x + e * t.w + i * t.z - n * t.y),
					(this.y = r * t.y + i * t.w + n * t.x - e * t.z),
					(this.z = r * t.z + n * t.w + e * t.y - i * t.x),
					this
				);
			}),
			(t.normalize = function () {
				var t = this.length();
				if (Math.abs(t) <= l.math.EPSILON)
					throw new Error('current quaternion is an invalid value');
				return this.scale(1 / t), this;
			}),
			(t.rotationAxis = function (t, e) {
				var i = 0.5 * e,
					e = Math.sin(i);
				return (
					(this.w = Math.cos(i)),
					(this.x = t.x * e),
					(this.y = t.y * e),
					(this.z = t.z * e),
					this
				);
			}),
			(l.math.Quaternion.rotationMatrix = function (t) {
				if (!t) return null;
				var e,
					i,
					n,
					r = [],
					o = t.mat,
					t = 0;
				(r[0] = o[0]),
					(r[1] = o[3]),
					(r[2] = o[6]),
					(r[4] = o[1]),
					(r[5] = o[4]),
					(r[6] = o[7]),
					(r[8] = o[2]),
					(r[9] = o[5]),
					(r[10] = o[8]),
					(r[15] = 1);
				(o = r[0]),
					(r = o[0] + o[5] + o[10] + 1),
					(t =
						r > l.math.EPSILON
							? ((t = 2 * Math.sqrt(r)),
							  (e = (o[9] - o[6]) / t),
							  (i = (o[2] - o[8]) / t),
							  (n = (o[4] - o[1]) / t),
							  0.25 * t)
							: o[0] > o[5] && o[0] > o[10]
							? ((e =
									0.25 *
									(t =
										2 *
										Math.sqrt(1 + o[0] - o[5] - o[10]))),
							  (i = (o[4] + o[1]) / t),
							  (n = (o[2] + o[8]) / t),
							  (o[9] - o[6]) / t)
							: o[5] > o[10]
							? ((t = 2 * Math.sqrt(1 + o[5] - o[0] - o[10])),
							  (e = (o[4] + o[1]) / t),
							  (i = 0.25 * t),
							  (n = (o[9] + o[6]) / t),
							  (o[2] - o[8]) / t)
							: ((t = 2 * Math.sqrt(1 + o[10] - o[0] - o[5])),
							  (e = (o[2] + o[8]) / t),
							  (i = (o[9] + o[6]) / t),
							  (n = 0.25 * t),
							  (o[4] - o[1]) / t));
				return new l.math.Quaternion(e, i, n, t);
			}),
			(l.math.Quaternion.rotationYawPitchRoll = function (t, e, i) {
				var n = l.degreesToRadians(e) / 2,
					r = l.degreesToRadians(t) / 2,
					o = l.degreesToRadians(i) / 2,
					s = Math.cos(n),
					c = Math.cos(r),
					a = Math.cos(o),
					e = Math.sin(n),
					t = Math.sin(r),
					i = Math.sin(o),
					n = c * a,
					r = t * i,
					o = new l.math.Quaternion();
				return (
					(o.w = s * n + e * r),
					(o.x = e * n - s * r),
					(o.y = s * t * a + e * c * i),
					(o.z = s * c * i - e * t * a),
					o.normalize(),
					o
				);
			}),
			(t.slerp = function (t, e) {
				if (
					this.x === t.x &&
					this.y === t.y &&
					this.z === t.z &&
					this.w === t.w
				)
					return this;
				var i = this.dot(t),
					n = Math.acos(i),
					r = Math.sqrt(1 - l.math.square(i)),
					i = Math.sin(e * n) / r,
					r = Math.sin((1 - e) * n) / r,
					t = new l.math.Quaternion(t);
				return this.scale(r), t.scale(i), this.add(t), this;
			}),
			(t.toAxisAndAngle = function () {
				var t,
					e = new l.math.Vec3(),
					i = Math.acos(this.w),
					n = Math.sqrt(
						l.math.square(this.x) +
							l.math.square(this.y) +
							l.math.square(this.z)
					);
				return (
					(n > -l.math.EPSILON && n < l.math.EPSILON) ||
					(n < 2 * Math.PI + l.math.EPSILON &&
						n > 2 * Math.PI - l.math.EPSILON)
						? ((t = 0), (e.x = 0), (e.y = 0), (e.z = 1))
						: ((t = 2 * i),
						  (e.x = this.x / n),
						  (e.y = this.y / n),
						  (e.z = this.z / n),
						  e.normalize()),
					{ axis: e, angle: t }
				);
			}),
			(t.scale = function (t) {
				return (
					(this.x *= t),
					(this.y *= t),
					(this.z *= t),
					(this.w *= t),
					this
				);
			}),
			(t.assignFrom = function (t) {
				return (
					(this.x = t.x),
					(this.y = t.y),
					(this.z = t.z),
					(this.w = t.w),
					this
				);
			}),
			(t.add = function (t) {
				return (
					(this.x += t.x),
					(this.y += t.y),
					(this.z += t.z),
					(this.w += t.w),
					this
				);
			}),
			(l.math.Quaternion.rotationBetweenVec3 = function (t, e, i) {
				var n = new l.math.Vec3(t),
					r = new l.math.Vec3(e);
				n.normalize(), r.normalize();
				var o,
					s = n.dot(r),
					e = new l.math.Quaternion();
				return (
					1 <= s
						? e.identity()
						: s < 1e-6 - 1
						? Math.abs(i.lengthSq()) < l.math.EPSILON
							? e.rotationAxis(i, Math.PI)
							: ((o = new l.math.Vec3(1, 0, 0)).cross(t),
							  Math.abs(o.lengthSq()) < l.math.EPSILON &&
									(o.fill(0, 1, 0), o.cross(t)),
							  o.normalize(),
							  e.rotationAxis(o, Math.PI))
						: ((s = 1 / (o = Math.sqrt(2 * (1 + s)))),
						  n.cross(r),
						  (e.x = n.x * s),
						  (e.y = n.y * s),
						  (e.z = n.z * s),
						  (e.w = 0.5 * o),
						  e.normalize()),
					e
				);
			}),
			(t.multiplyVec3 = function (t) {
				var e = this.x,
					i = this.y,
					n = this.z,
					r = new l.math.Vec3(t),
					o = new l.math.Vec3(e, i, n),
					n = new l.math.Vec3(e, i, n);
				return (
					o.cross(t),
					n.cross(o),
					o.scale(2 * q.w),
					n.scale(2),
					r.add(o),
					r.add(n),
					r
				);
			});
	})(cc),
	(cc.math.AABB = function (t, e) {
		(this.min = t || new cc.math.Vec3()),
			(this.max = e || new cc.math.Vec3());
	}),
	(cc.math.AABB.prototype.containsPoint = function (t) {
		return (
			t.x >= this.min.x &&
			t.x <= this.max.x &&
			t.y >= this.min.y &&
			t.y <= this.max.y &&
			t.z >= this.min.z &&
			t.z <= this.max.z
		);
	}),
	(cc.math.AABB.containsPoint = function (t, e) {
		return (
			t.x >= e.min.x &&
			t.x <= e.max.x &&
			t.y >= e.min.y &&
			t.y <= e.max.y &&
			t.z >= e.min.z &&
			t.z <= e.max.z
		);
	}),
	(cc.math.AABB.prototype.assignFrom = function (t) {
		this.min.assignFrom(t.min), this.max.assignFrom(t.max);
	}),
	(cc.math.AABB.assign = function (t, e) {
		return t.min.assignFrom(e.min), t.max.assignFrom(e.max), t;
	}),
	(function (i) {
		(i.math.Matrix4Stack = function (t, e) {
			(this.top = t), (this.stack = e || []);
		}),
			(i.km_mat4_stack = i.math.Matrix4Stack);
		var t = i.math.Matrix4Stack.prototype;
		(t.initialize = function () {
			(this.stack.length = 0), (this.top = null);
		}),
			(i.km_mat4_stack_push = function (t, e) {
				t.stack.push(t.top), (t.top = new i.math.Matrix4(e));
			}),
			(i.km_mat4_stack_pop = function (t, e) {
				t.top = t.stack.pop();
			}),
			(i.km_mat4_stack_release = function (t) {
				(t.stack = null), (t.top = null);
			}),
			(t.push = function (t) {
				(t = t || this.top),
					this.stack.push(this.top),
					(this.top = new i.math.Matrix4(t));
			}),
			(t.pop = function () {
				this.top = this.stack.pop();
			}),
			(t.release = function () {
				(this.stack = null),
					(this.top = null),
					(this._matrixPool = null);
			}),
			(t._getFromPool = function (t) {
				var e = this._matrixPool;
				if (0 === e.length) return new i.math.Matrix4(t);
				e = e.pop();
				return e.assignFrom(t), e;
			}),
			(t._putInPool = function (t) {
				this._matrixPool.push(t);
			});
	})(cc),
	(function (r) {
		(r.KM_GL_MODELVIEW = 5888),
			(r.KM_GL_PROJECTION = 5889),
			(r.KM_GL_TEXTURE = 5890),
			(r.modelview_matrix_stack = new r.math.Matrix4Stack()),
			(r.projection_matrix_stack = new r.math.Matrix4Stack()),
			(r.texture_matrix_stack = new r.math.Matrix4Stack()),
			(r.current_stack = null),
			(r.lazyInitialize = function () {
				var t = new r.math.Matrix4();
				r.modelview_matrix_stack.initialize(),
					r.projection_matrix_stack.initialize(),
					r.texture_matrix_stack.initialize(),
					(r.current_stack = r.modelview_matrix_stack),
					(r.initialized = !0),
					t.identity(),
					r.modelview_matrix_stack.push(t),
					r.projection_matrix_stack.push(t),
					r.texture_matrix_stack.push(t);
			}),
			r.lazyInitialize(),
			(r.kmGLFreeAll = function () {
				r.modelview_matrix_stack.release(),
					(r.modelview_matrix_stack = null),
					r.projection_matrix_stack.release(),
					(r.projection_matrix_stack = null),
					r.texture_matrix_stack.release(),
					(r.texture_matrix_stack = null),
					(r.initialized = !1),
					(r.current_stack = null);
			}),
			(r.kmGLPushMatrix = function () {
				r.current_stack.push(r.current_stack.top);
			}),
			(r.kmGLPushMatrixWitMat4 = function (t) {
				r.current_stack.stack.push(r.current_stack.top),
					t.assignFrom(r.current_stack.top),
					(r.current_stack.top = t);
			}),
			(r.kmGLPopMatrix = function () {
				r.current_stack.top = r.current_stack.stack.pop();
			}),
			(r.kmGLMatrixMode = function (t) {
				switch (t) {
					case r.KM_GL_MODELVIEW:
						r.current_stack = r.modelview_matrix_stack;
						break;
					case r.KM_GL_PROJECTION:
						r.current_stack = r.projection_matrix_stack;
						break;
					case r.KM_GL_TEXTURE:
						r.current_stack = r.texture_matrix_stack;
						break;
					default:
						throw new Error('Invalid matrix mode specified');
				}
			}),
			(r.kmGLLoadIdentity = function () {
				r.current_stack.top.identity();
			}),
			(r.kmGLLoadMatrix = function (t) {
				r.current_stack.top.assignFrom(t);
			}),
			(r.kmGLMultMatrix = function (t) {
				r.current_stack.top.multiply(t);
			});
		var o = new r.math.Matrix4();
		r.kmGLTranslatef = function (t, e, i) {
			i = r.math.Matrix4.createByTranslation(t, e, i, o);
			r.current_stack.top.multiply(i);
		};
		var s = new r.math.Vec3();
		(r.kmGLRotatef = function (t, e, i, n) {
			s.fill(e, i, n);
			t = r.math.Matrix4.createByAxisAndAngle(
				s,
				r.degreesToRadians(t),
				o
			);
			r.current_stack.top.multiply(t);
		}),
			(r.kmGLScalef = function (t, e, i) {
				i = r.math.Matrix4.createByScale(t, e, i, o);
				r.current_stack.top.multiply(i);
			}),
			(r.kmGLGetMatrix = function (t, e) {
				switch (t) {
					case r.KM_GL_MODELVIEW:
						e.assignFrom(r.modelview_matrix_stack.top);
						break;
					case r.KM_GL_PROJECTION:
						e.assignFrom(r.projection_matrix_stack.top);
						break;
					case r.KM_GL_TEXTURE:
						e.assignFrom(r.texture_matrix_stack.top);
						break;
					default:
						throw new Error('Invalid matrix mode specified');
				}
			});
	})(cc),
	(cc.SHADER_POSITION_UCOLOR_FRAG =
		'precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor = v_fragmentColor;      \n}\n'),
	(cc.SHADER_POSITION_UCOLOR_VERT =
		'attribute vec4 a_position;\nuniform    vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    gl_PointSize = u_pointSize;          \n    v_fragmentColor = u_color;           \n}'),
	(cc.SHADER_POSITION_COLOR_FRAG =
		'precision lowp float; \nvarying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor = v_fragmentColor; \n} '),
	(cc.SHADER_POSITION_COLOR_VERT =
		'attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color;             \n}'),
	(cc.SHADER_SPRITE_POSITION_COLOR_VERT =
		'attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color;             \n}'),
	(cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG =
		'// #extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()  \n{ \n// #if defined GL_OES_standard_derivatives   \n// gl_FragColor = v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else \ngl_FragColor = v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}'),
	(cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT =
		'attribute mediump vec4 a_position; \nattribute mediump vec2 a_texcoord; \nattribute mediump vec4 a_color;  \nvarying mediump vec4 v_color; \nvarying mediump vec2 v_texcoord; \nvoid main() \n{ \n     v_color = a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord = a_texcoord; \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n}'),
	(cc.SHADER_POSITION_TEXTURE_FRAG =
		'precision lowp float;   \nvarying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord);   \n}'),
	(cc.SHADER_POSITION_TEXTURE_VERT =
		'attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;               \n}'),
	(cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG =
		'precision lowp float;  \nuniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}'),
	(cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT =
		'attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;                 \n}'),
	(cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG =
		'precision lowp float;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}'),
	(cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT =
		'attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}'),
	(cc.SHADER_POSITION_TEXTURE_COLOR_FRAG =
		'precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}'),
	(cc.SHADER_POSITION_TEXTURE_COLOR_VERT =
		'attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}'),
	(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT =
		'attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}'),
	(cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG =
		'precision lowp float;   \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor = texture2D(CC_Texture0, v_texCoord);  \n    if ( texColor.a <= CC_alpha_value )          \n        discard; \n    gl_FragColor = texColor * v_fragmentColor;  \n}'),
	(cc.SHADEREX_SWITCHMASK_FRAG =
		'precision lowp float; \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   = texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  = texture2D(u_mask, v_texCoord); \n    vec4 finalColor = vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    = v_fragmentColor * finalColor; \n}'),
	(cc.shaderCache = {
		TYPE_POSITION_TEXTURECOLOR: 0,
		TYPE_POSITION_TEXTURECOLOR_ALPHATEST: 1,
		TYPE_POSITION_COLOR: 2,
		TYPE_POSITION_TEXTURE: 3,
		TYPE_POSITION_TEXTURE_UCOLOR: 4,
		TYPE_POSITION_TEXTURE_A8COLOR: 5,
		TYPE_POSITION_UCOLOR: 6,
		TYPE_POSITION_LENGTH_TEXTURECOLOR: 7,
		TYPE_SPRITE_POSITION_TEXTURECOLOR: 8,
		TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST: 9,
		TYPE_SPRITE_POSITION_COLOR: 10,
		TYPE_MAX: 10,
		_programs: {},
		_init: function () {
			return this.loadDefaultShaders(), !0;
		},
		_loadDefaultShader: function (t, e) {
			switch (e) {
				case this.TYPE_POSITION_TEXTURECOLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_TEXTURE_COLOR_VERT,
						cc.SHADER_POSITION_TEXTURE_COLOR_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						);
					break;
				case this.TYPE_SPRITE_POSITION_TEXTURECOLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,
						cc.SHADER_POSITION_TEXTURE_COLOR_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						);
					break;
				case this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_TEXTURE_COLOR_VERT,
						cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						);
					break;
				case this.TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST:
					t.initWithVertexShaderByteArray(
						cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,
						cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						);
					break;
				case this.TYPE_POSITION_COLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_COLOR_VERT,
						cc.SHADER_POSITION_COLOR_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						);
					break;
				case this.TYPE_SPRITE_POSITION_COLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_SPRITE_POSITION_COLOR_VERT,
						cc.SHADER_POSITION_COLOR_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						);
					break;
				case this.TYPE_POSITION_TEXTURE:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_TEXTURE_VERT,
						cc.SHADER_POSITION_TEXTURE_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						);
					break;
				case this.TYPE_POSITION_TEXTURE_UCOLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT,
						cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						);
					break;
				case this.TYPE_POSITION_TEXTURE_A8COLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT,
						cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						);
					break;
				case this.TYPE_POSITION_UCOLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_UCOLOR_VERT,
						cc.SHADER_POSITION_UCOLOR_FRAG
					),
						t.addAttribute('aVertex', cc.VERTEX_ATTRIB_POSITION);
					break;
				case this.TYPE_POSITION_LENGTH_TEXTURECOLOR:
					t.initWithVertexShaderByteArray(
						cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT,
						cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG
					),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						);
					break;
				default:
					return void cc.log(
						'cocos2d: cc.shaderCache._loadDefaultShader, error shader type'
					);
			}
			t.link(), t.updateUniforms();
		},
		loadDefaultShaders: function () {
			var t = new cc.GLProgram();
			this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURECOLOR),
				(this._programs[cc.SHADER_POSITION_TEXTURECOLOR] = t),
				(this._programs.ShaderPositionTextureColor = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(
					t,
					this.TYPE_SPRITE_POSITION_TEXTURECOLOR
				),
				(this._programs[cc.SHADER_SPRITE_POSITION_TEXTURECOLOR] = t),
				(this._programs.ShaderSpritePositionTextureColor = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(
					t,
					this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST
				),
				(this._programs[cc.SHADER_POSITION_TEXTURECOLORALPHATEST] = t),
				(this._programs.ShaderPositionTextureColorAlphaTest = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(
					t,
					this.TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST
				),
				(this._programs[
					cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST
				] = t),
				(this._programs.ShaderSpritePositionTextureColorAlphaTest = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(t, this.TYPE_POSITION_COLOR),
				(this._programs[cc.SHADER_POSITION_COLOR] = t),
				(this._programs.ShaderPositionColor = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(t, this.TYPE_SPRITE_POSITION_COLOR),
				(this._programs[cc.SHADER_SPRITE_POSITION_COLOR] = t),
				(this._programs.ShaderSpritePositionColor = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURE),
				(this._programs[cc.SHADER_POSITION_TEXTURE] = t),
				(this._programs.ShaderPositionTexture = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURE_UCOLOR),
				(this._programs[cc.SHADER_POSITION_TEXTURE_UCOLOR] = t),
				(this._programs.ShaderPositionTextureUColor = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURE_A8COLOR),
				(this._programs[cc.SHADER_POSITION_TEXTUREA8COLOR] = t),
				(this._programs.ShaderPositionTextureA8Color = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(t, this.TYPE_POSITION_UCOLOR),
				(this._programs[cc.SHADER_POSITION_UCOLOR] = t),
				(this._programs.ShaderPositionUColor = t),
				(t = new cc.GLProgram()),
				this._loadDefaultShader(
					t,
					this.TYPE_POSITION_LENGTH_TEXTURECOLOR
				),
				(this._programs[cc.SHADER_POSITION_LENGTHTEXTURECOLOR] = t),
				(this._programs.ShaderPositionLengthTextureColor = t);
		},
		reloadDefaultShaders: function () {
			var t = this.programForKey(cc.SHADER_POSITION_TEXTURECOLOR);
			t.reset(),
				this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURECOLOR),
				(t = this.programForKey(
					cc.SHADER_SPRITE_POSITION_TEXTURECOLOR
				)).reset(),
				this._loadDefaultShader(
					t,
					this.TYPE_SPRITE_POSITION_TEXTURECOLOR
				),
				(t = this.programForKey(
					cc.SHADER_POSITION_TEXTURECOLORALPHATEST
				)).reset(),
				this._loadDefaultShader(
					t,
					this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST
				),
				(t = this.programForKey(
					cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST
				)).reset(),
				this._loadDefaultShader(
					t,
					this.TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST
				),
				(t = this.programForKey(cc.SHADER_POSITION_COLOR)).reset(),
				this._loadDefaultShader(t, this.TYPE_POSITION_COLOR),
				(t = this.programForKey(cc.SHADER_POSITION_TEXTURE)).reset(),
				this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURE),
				(t = this.programForKey(
					cc.SHADER_POSITION_TEXTURE_UCOLOR
				)).reset(),
				this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURE_UCOLOR),
				(t = this.programForKey(
					cc.SHADER_POSITION_TEXTUREA8COLOR
				)).reset(),
				this._loadDefaultShader(t, this.TYPE_POSITION_TEXTURE_A8COLOR),
				(t = this.programForKey(cc.SHADER_POSITION_UCOLOR)).reset(),
				this._loadDefaultShader(t, this.TYPE_POSITION_UCOLOR);
		},
		programForKey: function (t) {
			return this._programs[t];
		},
		getProgram: function (t) {
			return this._programs[t];
		},
		addProgram: function (t, e) {
			this._programs[e] = t;
		},
	}),
	(cc.GLProgram = cc.Class.extend({
		_glContext: null,
		_programObj: null,
		_vertShader: null,
		_fragShader: null,
		_uniforms: null,
		_hashForUniforms: null,
		_usesTime: !1,
		_updateUniformLocation: function (t) {
			if (!t) return !1;
			var e,
				i = this._hashForUniforms[t];
			if (i) {
				e = !1;
				for (var n = arguments.length - 1, r = 0; r < n; ++r)
					arguments[r + 1] !== i[r] &&
						((i[r] = arguments[r + 1]), (e = !0));
			} else
				(i = [arguments[1], arguments[2], arguments[3], arguments[4]]),
					(this._hashForUniforms[t] = i),
					(e = !0);
			return e;
		},
		_description: function () {
			return (
				'<CCGLProgram = ' +
				this.toString() +
				' | Program = ' +
				this._programObj.toString() +
				', VertexShader = ' +
				this._vertShader.toString() +
				', FragmentShader = ' +
				this._fragShader.toString() +
				'>'
			);
		},
		_compileShader: function (t, e, i) {
			if (!i || !t) return !1;
			(i =
				(cc.GLProgram._isHighpSupported()
					? 'precision highp float;\n'
					: 'precision mediump float;\n') +
				'uniform mat4 CC_PMatrix;         \nuniform mat4 CC_MVMatrix;        \nuniform mat4 CC_MVPMatrix;       \nuniform vec4 CC_Time;            \nuniform vec4 CC_SinTime;         \nuniform vec4 CC_CosTime;         \nuniform vec4 CC_Random01;        \nuniform sampler2D CC_Texture0;   \n//CC INCLUDES END                \n' +
				i),
				this._glContext.shaderSource(t, i),
				this._glContext.compileShader(t);
			i = this._glContext.getShaderParameter(
				t,
				this._glContext.COMPILE_STATUS
			);
			return (
				i ||
					(cc.log(
						'cocos2d: ERROR: Failed to compile shader:\n' +
							this._glContext.getShaderSource(t)
					),
					e === this._glContext.VERTEX_SHADER
						? cc.log('cocos2d: \n' + this.vertexShaderLog())
						: cc.log('cocos2d: \n' + this.fragmentShaderLog())),
				!0 === i
			);
		},
		ctor: function (t, e, i) {
			(this._uniforms = {}),
				(this._hashForUniforms = {}),
				(this._glContext = i || cc._renderContext),
				t && e && this.init(t, e);
		},
		destroyProgram: function () {
			(this._vertShader = null),
				(this._fragShader = null),
				(this._uniforms = null),
				(this._hashForUniforms = null),
				this._glContext.deleteProgram(this._programObj);
		},
		initWithVertexShaderByteArray: function (t, e) {
			var i,
				n = this._glContext;
			for (i in ((this._programObj = n.createProgram()),
			(this._vertShader = null),
			(this._fragShader = null),
			t &&
				((this._vertShader = n.createShader(n.VERTEX_SHADER)),
				this._compileShader(this._vertShader, n.VERTEX_SHADER, t) ||
					cc.log('cocos2d: ERROR: Failed to compile vertex shader')),
			e &&
				((this._fragShader = n.createShader(n.FRAGMENT_SHADER)),
				this._compileShader(this._fragShader, n.FRAGMENT_SHADER, e) ||
					cc.log(
						'cocos2d: ERROR: Failed to compile fragment shader'
					)),
			this._vertShader &&
				n.attachShader(this._programObj, this._vertShader),
			cc.checkGLErrorDebug(),
			this._fragShader &&
				n.attachShader(this._programObj, this._fragShader),
			this._hashForUniforms))
				delete this._hashForUniforms[i];
			return cc.checkGLErrorDebug(), !0;
		},
		initWithString: function (t, e) {
			return this.initWithVertexShaderByteArray(t, e);
		},
		initWithVertexShaderFilename: function (t, e) {
			var i = cc.loader.getRes(t);
			if (!i) throw new Error('Please load the resource firset : ' + t);
			t = cc.loader.getRes(e);
			if (!t) throw new Error('Please load the resource firset : ' + e);
			return this.initWithVertexShaderByteArray(i, t);
		},
		init: function (t, e) {
			return this.initWithVertexShaderFilename(t, e);
		},
		addAttribute: function (t, e) {
			this._glContext.bindAttribLocation(this._programObj, e, t);
		},
		link: function () {
			if (!this._programObj)
				return (
					cc.log('cc.GLProgram.link(): Cannot link invalid program'),
					!1
				);
			if (
				(this._glContext.linkProgram(this._programObj),
				this._vertShader &&
					this._glContext.deleteShader(this._vertShader),
				this._fragShader &&
					this._glContext.deleteShader(this._fragShader),
				(this._vertShader = null),
				(this._fragShader = null),
				cc.game.config[cc.game.CONFIG_KEY.debugMode]) &&
				!this._glContext.getProgramParameter(
					this._programObj,
					this._glContext.LINK_STATUS
				)
			)
				return (
					cc.log(
						'cocos2d: ERROR: Failed to link program: ' +
							this._glContext.getProgramInfoLog(this._programObj)
					),
					cc.glDeleteProgram(this._programObj),
					(this._programObj = null),
					!1
				);
			return !0;
		},
		use: function () {
			cc.glUseProgram(this._programObj);
		},
		updateUniforms: function () {
			(this._uniforms[cc.UNIFORM_PMATRIX_S] =
				this._glContext.getUniformLocation(
					this._programObj,
					cc.UNIFORM_PMATRIX_S
				)),
				(this._uniforms[cc.UNIFORM_MVMATRIX_S] =
					this._glContext.getUniformLocation(
						this._programObj,
						cc.UNIFORM_MVMATRIX_S
					)),
				(this._uniforms[cc.UNIFORM_MVPMATRIX_S] =
					this._glContext.getUniformLocation(
						this._programObj,
						cc.UNIFORM_MVPMATRIX_S
					)),
				(this._uniforms[cc.UNIFORM_TIME_S] =
					this._glContext.getUniformLocation(
						this._programObj,
						cc.UNIFORM_TIME_S
					)),
				(this._uniforms[cc.UNIFORM_SINTIME_S] =
					this._glContext.getUniformLocation(
						this._programObj,
						cc.UNIFORM_SINTIME_S
					)),
				(this._uniforms[cc.UNIFORM_COSTIME_S] =
					this._glContext.getUniformLocation(
						this._programObj,
						cc.UNIFORM_COSTIME_S
					)),
				(this._usesTime =
					null != this._uniforms[cc.UNIFORM_TIME_S] ||
					null != this._uniforms[cc.UNIFORM_SINTIME_S] ||
					null != this._uniforms[cc.UNIFORM_COSTIME_S]),
				(this._uniforms[cc.UNIFORM_RANDOM01_S] =
					this._glContext.getUniformLocation(
						this._programObj,
						cc.UNIFORM_RANDOM01_S
					)),
				(this._uniforms[cc.UNIFORM_SAMPLER_S] =
					this._glContext.getUniformLocation(
						this._programObj,
						cc.UNIFORM_SAMPLER_S
					)),
				this.use(),
				this.setUniformLocationWith1i(
					this._uniforms[cc.UNIFORM_SAMPLER_S],
					0
				);
		},
		_addUniformLocation: function (t) {
			var e = this._glContext.getUniformLocation(this._programObj, t);
			this._uniforms[t] = e;
		},
		getUniformLocationForName: function (t) {
			if (!t)
				throw new Error(
					'cc.GLProgram.getUniformLocationForName(): uniform name should be non-null'
				);
			if (!this._programObj)
				throw new Error(
					'cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized'
				);
			return (
				this._uniforms[t] ||
				this._glContext.getUniformLocation(this._programObj, t)
			);
		},
		getUniformMVPMatrix: function () {
			return this._uniforms[cc.UNIFORM_MVPMATRIX_S];
		},
		getUniformSampler: function () {
			return this._uniforms[cc.UNIFORM_SAMPLER_S];
		},
		setUniformLocationWith1i: function (t, e) {
			var i,
				n = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e) &&
				  ((i = this.getUniformLocationForName(t)), n.uniform1i(i, e))
				: n.uniform1i(t, e);
		},
		setUniformLocationWith2i: function (t, e, i) {
			var n,
				r = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e, i) &&
				  ((n = this.getUniformLocationForName(t)),
				  r.uniform2i(n, e, i))
				: r.uniform2i(t, e, i);
		},
		setUniformLocationWith3i: function (t, e, i, n) {
			var r,
				o = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e, i, n) &&
				  ((r = this.getUniformLocationForName(t)),
				  o.uniform3i(r, e, i, n))
				: o.uniform3i(t, e, i, n);
		},
		setUniformLocationWith4i: function (t, e, i, n, r) {
			var o,
				s = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e, i, n, r) &&
				  ((o = this.getUniformLocationForName(t)),
				  s.uniform4i(o, e, i, n, r))
				: s.uniform4i(t, e, i, n, r);
		},
		setUniformLocationWith2iv: function (t, e) {
			t = 'string' == typeof t ? this.getUniformLocationForName(t) : t;
			this._glContext.uniform2iv(t, e);
		},
		setUniformLocationWith3iv: function (t, e) {
			t = 'string' == typeof t ? this.getUniformLocationForName(t) : t;
			this._glContext.uniform3iv(t, e);
		},
		setUniformLocationWith4iv: function (t, e) {
			t = 'string' == typeof t ? this.getUniformLocationForName(t) : t;
			this._glContext.uniform4iv(t, e);
		},
		setUniformLocationI32: function (t, e) {
			this.setUniformLocationWith1i(t, e);
		},
		setUniformLocationWith1f: function (t, e) {
			var i,
				n = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e) &&
				  ((i = this.getUniformLocationForName(t)), n.uniform1f(i, e))
				: n.uniform1f(t, e);
		},
		setUniformLocationWith2f: function (t, e, i) {
			var n,
				r = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e, i) &&
				  ((n = this.getUniformLocationForName(t)),
				  r.uniform2f(n, e, i))
				: r.uniform2f(t, e, i);
		},
		setUniformLocationWith3f: function (t, e, i, n) {
			var r,
				o = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e, i, n) &&
				  ((r = this.getUniformLocationForName(t)),
				  o.uniform3f(r, e, i, n))
				: o.uniform3f(t, e, i, n);
		},
		setUniformLocationWith4f: function (t, e, i, n, r) {
			var o,
				s = this._glContext;
			'string' == typeof t
				? this._updateUniformLocation(t, e, i, n, r) &&
				  ((o = this.getUniformLocationForName(t)),
				  s.uniform4f(o, e, i, n, r))
				: s.uniform4f(t, e, i, n, r);
		},
		setUniformLocationWith2fv: function (t, e) {
			t = 'string' == typeof t ? this.getUniformLocationForName(t) : t;
			this._glContext.uniform2fv(t, e);
		},
		setUniformLocationWith3fv: function (t, e) {
			t = 'string' == typeof t ? this.getUniformLocationForName(t) : t;
			this._glContext.uniform3fv(t, e);
		},
		setUniformLocationWith4fv: function (t, e) {
			t = 'string' == typeof t ? this.getUniformLocationForName(t) : t;
			this._glContext.uniform4fv(t, e);
		},
		setUniformLocationWithMatrix4fv: function (t, e) {
			t = 'string' == typeof t ? this.getUniformLocationForName(t) : t;
			this._glContext.uniformMatrix4fv(t, !1, e);
		},
		setUniformLocationF32: function () {
			if (!(arguments.length < 2))
				switch (arguments.length) {
					case 2:
						this.setUniformLocationWith1f(
							arguments[0],
							arguments[1]
						);
						break;
					case 3:
						this.setUniformLocationWith2f(
							arguments[0],
							arguments[1],
							arguments[2]
						);
						break;
					case 4:
						this.setUniformLocationWith3f(
							arguments[0],
							arguments[1],
							arguments[2],
							arguments[3]
						);
						break;
					case 5:
						this.setUniformLocationWith4f(
							arguments[0],
							arguments[1],
							arguments[2],
							arguments[3],
							arguments[4]
						);
				}
		},
		setUniformsForBuiltins: function () {
			var t = new cc.math.Matrix4(),
				e = new cc.math.Matrix4(),
				i = new cc.math.Matrix4();
			cc.kmGLGetMatrix(cc.KM_GL_PROJECTION, t),
				cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW, e),
				cc.kmMat4Multiply(i, t, e),
				this.setUniformLocationWithMatrix4fv(
					this._uniforms[cc.UNIFORM_PMATRIX_S],
					t.mat,
					1
				),
				this.setUniformLocationWithMatrix4fv(
					this._uniforms[cc.UNIFORM_MVMATRIX_S],
					e.mat,
					1
				),
				this.setUniformLocationWithMatrix4fv(
					this._uniforms[cc.UNIFORM_MVPMATRIX_S],
					i.mat,
					1
				),
				this._usesTime &&
					((i =
						(i = cc.director).getTotalFrames() *
						i.getAnimationInterval()),
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_TIME_S],
						i / 10,
						i,
						2 * i,
						4 * i
					),
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_SINTIME_S],
						i / 8,
						i / 4,
						i / 2,
						Math.sin(i)
					),
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_COSTIME_S],
						i / 8,
						i / 4,
						i / 2,
						Math.cos(i)
					)),
				-1 !== this._uniforms[cc.UNIFORM_RANDOM01_S] &&
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_RANDOM01_S],
						Math.random(),
						Math.random(),
						Math.random(),
						Math.random()
					);
		},
		_setUniformsForBuiltinsForRenderer: function (t) {
			var e, i;
			t &&
				t._renderCmd &&
				((e = new cc.math.Matrix4()),
				(i = new cc.math.Matrix4()),
				cc.kmGLGetMatrix(cc.KM_GL_PROJECTION, e),
				cc.kmMat4Multiply(i, e, t._renderCmd._stackMatrix),
				this.setUniformLocationWithMatrix4fv(
					this._uniforms[cc.UNIFORM_PMATRIX_S],
					e.mat,
					1
				),
				this.setUniformLocationWithMatrix4fv(
					this._uniforms[cc.UNIFORM_MVMATRIX_S],
					t._renderCmd._stackMatrix.mat,
					1
				),
				this.setUniformLocationWithMatrix4fv(
					this._uniforms[cc.UNIFORM_MVPMATRIX_S],
					i.mat,
					1
				),
				this._usesTime &&
					((i =
						(i = cc.director).getTotalFrames() *
						i.getAnimationInterval()),
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_TIME_S],
						i / 10,
						i,
						2 * i,
						4 * i
					),
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_SINTIME_S],
						i / 8,
						i / 4,
						i / 2,
						Math.sin(i)
					),
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_COSTIME_S],
						i / 8,
						i / 4,
						i / 2,
						Math.cos(i)
					)),
				-1 !== this._uniforms[cc.UNIFORM_RANDOM01_S] &&
					this.setUniformLocationWith4f(
						this._uniforms[cc.UNIFORM_RANDOM01_S],
						Math.random(),
						Math.random(),
						Math.random(),
						Math.random()
					));
		},
		setUniformForModelViewProjectionMatrix: function () {
			this._glContext.uniformMatrix4fv(
				this._uniforms[cc.UNIFORM_MVPMATRIX_S],
				!1,
				cc.getMat4MultiplyValue(
					cc.projection_matrix_stack.top,
					cc.modelview_matrix_stack.top
				)
			);
		},
		setUniformForModelViewProjectionMatrixWithMat4: function (t) {
			cc.kmMat4Multiply(
				t,
				cc.projection_matrix_stack.top,
				cc.modelview_matrix_stack.top
			),
				this._glContext.uniformMatrix4fv(
					this._uniforms[cc.UNIFORM_MVPMATRIX_S],
					!1,
					t.mat
				);
		},
		setUniformForModelViewAndProjectionMatrixWithMat4: function () {
			this._glContext.uniformMatrix4fv(
				this._uniforms[cc.UNIFORM_MVMATRIX_S],
				!1,
				cc.modelview_matrix_stack.top.mat
			),
				this._glContext.uniformMatrix4fv(
					this._uniforms[cc.UNIFORM_PMATRIX_S],
					!1,
					cc.projection_matrix_stack.top.mat
				);
		},
		_setUniformForMVPMatrixWithMat4: function (t) {
			if (!t) throw new Error('modelView matrix is undefined.');
			this._glContext.uniformMatrix4fv(
				this._uniforms[cc.UNIFORM_MVMATRIX_S],
				!1,
				t.mat
			),
				this._glContext.uniformMatrix4fv(
					this._uniforms[cc.UNIFORM_PMATRIX_S],
					!1,
					cc.projection_matrix_stack.top.mat
				);
		},
		_updateProjectionUniform: function () {
			this._glContext.uniformMatrix4fv(
				this._uniforms[cc.UNIFORM_PMATRIX_S],
				!1,
				cc.projection_matrix_stack.top.mat
			);
		},
		vertexShaderLog: function () {
			return this._glContext.getShaderInfoLog(this._vertShader);
		},
		getVertexShaderLog: function () {
			return this._glContext.getShaderInfoLog(this._vertShader);
		},
		getFragmentShaderLog: function () {
			return this._glContext.getShaderInfoLog(this._vertShader);
		},
		fragmentShaderLog: function () {
			return this._glContext.getShaderInfoLog(this._fragShader);
		},
		programLog: function () {
			return this._glContext.getProgramInfoLog(this._programObj);
		},
		getProgramLog: function () {
			return this._glContext.getProgramInfoLog(this._programObj);
		},
		reset: function () {
			for (var t in ((this._vertShader = null),
			(this._fragShader = null),
			(this._uniforms.length = 0),
			this._glContext.deleteProgram(this._programObj),
			(this._programObj = null),
			this._hashForUniforms))
				(this._hashForUniforms[t].length = 0),
					delete this._hashForUniforms[t];
		},
		getProgram: function () {
			return this._programObj;
		},
		retain: function () {},
		release: function () {},
	})),
	(cc.GLProgram.create = function (t, e) {
		return new cc.GLProgram(t, e);
	}),
	(cc.GLProgram._highpSupported = null),
	(cc.GLProgram._isHighpSupported = function () {
		var t;
		return (
			null == cc.GLProgram._highpSupported &&
				((t = (t = cc._renderContext).getShaderPrecisionFormat(
					t.FRAGMENT_SHADER,
					t.HIGH_FLOAT
				)),
				(cc.GLProgram._highpSupported = 0 !== t.precision)),
			cc.GLProgram._highpSupported
		);
	}),
	(cc.setProgram = function (t, e) {
		t.shaderProgram = e;
		var i = t.children;
		if (i) for (var n = 0; n < i.length; n++) cc.setProgram(i[n], e);
	}),
	(cc._currentProjectionMatrix = -1),
	cc.ENABLE_GL_STATE_CACHE &&
		((cc.MAX_ACTIVETEXTURE = 16),
		(cc._currentShaderProgram = -1),
		(cc._currentBoundTexture = [
			-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
		]),
		(cc._blendingSource = -1),
		(cc._blendingDest = -1),
		(cc._GLServerState = 0),
		cc.TEXTURE_ATLAS_USE_VAO && (cc._uVAO = 0),
		(_currBuffers = {}),
		(WebGLRenderingContext.prototype.glBindBuffer =
			WebGLRenderingContext.prototype.bindBuffer),
		(WebGLRenderingContext.prototype.bindBuffer = function (t, e) {
			return (
				_currBuffers[t] === e ||
				(this.glBindBuffer(t, e), (_currBuffers[t] = e), !1)
			);
		}),
		(WebGLRenderingContext.prototype.glEnableVertexAttribArray =
			WebGLRenderingContext.prototype.enableVertexAttribArray),
		(WebGLRenderingContext.prototype.enableVertexAttribArray = function (
			t
		) {
			t === cc.VERTEX_ATTRIB_FLAG_POSITION
				? this._vertexAttribPosition ||
				  (this.glEnableVertexAttribArray(t),
				  (this._vertexAttribPosition = !0))
				: t === cc.VERTEX_ATTRIB_FLAG_COLOR
				? this._vertexAttribColor ||
				  (this.glEnableVertexAttribArray(t),
				  (this._vertexAttribColor = !0))
				: t === cc.VERTEX_ATTRIB_FLAG_TEX_COORDS
				? this._vertexAttribTexCoords ||
				  (this.glEnableVertexAttribArray(t),
				  (this._vertexAttribTexCoords = !0))
				: this.glEnableVertexAttribArray(t);
		}),
		(WebGLRenderingContext.prototype.glDisableVertexAttribArray =
			WebGLRenderingContext.prototype.disableVertexAttribArray),
		(WebGLRenderingContext.prototype.disableVertexAttribArray = function (
			t
		) {
			t === cc.VERTEX_ATTRIB_FLAG_COLOR
				? this._vertexAttribColor &&
				  (this.glDisableVertexAttribArray(t),
				  (this._vertexAttribColor = !1))
				: t === cc.VERTEX_ATTRIB_FLAG_TEX_COORDS
				? this._vertexAttribTexCoords &&
				  (this.glDisableVertexAttribArray(t),
				  (this._vertexAttribTexCoords = !1))
				: 0 !== t && this.glDisableVertexAttribArray(t);
		})),
	(cc.glInvalidateStateCache = function () {
		if (
			(cc.kmGLFreeAll(),
			(cc._currentProjectionMatrix = -1),
			cc.ENABLE_GL_STATE_CACHE)
		) {
			cc._currentShaderProgram = -1;
			for (var t = 0; t < cc.MAX_ACTIVETEXTURE; t++)
				cc._currentBoundTexture[t] = -1;
			(cc._blendingSource = -1),
				(cc._blendingDest = -1),
				(cc._GLServerState = 0);
		}
	}),
	(cc.glUseProgram = cc.ENABLE_GL_STATE_CACHE
		? function (t) {
				t !== cc._currentShaderProgram &&
					((cc._currentShaderProgram = t),
					cc._renderContext.useProgram(t));
		  }
		: function (t) {
				cc._renderContext.useProgram(t);
		  }),
	(cc.glDeleteProgram = function (t) {
		cc.ENABLE_GL_STATE_CACHE &&
			t === cc._currentShaderProgram &&
			(cc._currentShaderProgram = -1),
			gl.deleteProgram(t);
	}),
	(cc.setBlending = function (t, e) {
		var i = cc._renderContext;
		t === i.ONE && e === i.ZERO
			? i.disable(i.BLEND)
			: (i.enable(i.BLEND), cc._renderContext.blendFunc(t, e));
	}),
	(cc.glBlendFunc = cc.ENABLE_GL_STATE_CACHE
		? function (t, e) {
				(t === cc._blendingSource && e === cc._blendingDest) ||
					((cc._blendingSource = t),
					(cc._blendingDest = e),
					cc.setBlending(t, e));
		  }
		: cc.setBlending),
	(cc.glBlendFuncForParticle = function (t, e) {
		var i;
		(t === cc._blendingSource && e === cc._blendingDest) ||
			((cc._blendingSource = t),
			(cc._blendingDest = e),
			t === (i = cc._renderContext).ONE && e === i.ZERO
				? i.disable(i.BLEND)
				: (i.enable(i.BLEND),
				  i.blendFuncSeparate(i.SRC_ALPHA, e, t, e)));
	}),
	(cc.glBlendResetToCache = function () {
		var t = cc._renderContext;
		t.blendEquation(t.FUNC_ADD),
			cc.ENABLE_GL_STATE_CACHE
				? cc.setBlending(cc._blendingSource, cc._blendingDest)
				: cc.setBlending(t.BLEND_SRC, t.BLEND_DST);
	}),
	(cc.setProjectionMatrixDirty = function () {
		cc._currentProjectionMatrix = -1;
	}),
	(cc.glBindTexture2D = function (t) {
		cc.glBindTexture2DN(0, t);
	}),
	(cc.glBindTexture2DN = cc.ENABLE_GL_STATE_CACHE
		? function (t, e) {
				var i;
				cc._currentBoundTexture[t] !== e &&
					((cc._currentBoundTexture[t] = e),
					(i = cc._renderContext).activeTexture(i.TEXTURE0 + t),
					e
						? i.bindTexture(i.TEXTURE_2D, e._webTextureObj)
						: i.bindTexture(i.TEXTURE_2D, null));
		  }
		: function (t, e) {
				var i = cc._renderContext;
				i.activeTexture(i.TEXTURE0 + t),
					e
						? i.bindTexture(i.TEXTURE_2D, e._webTextureObj)
						: i.bindTexture(i.TEXTURE_2D, null);
		  }),
	(cc.glDeleteTexture = function (t) {
		cc.glDeleteTextureN(0, t);
	}),
	(cc.glDeleteTextureN = function (t, e) {
		cc.ENABLE_GL_STATE_CACHE &&
			e === cc._currentBoundTexture[t] &&
			(cc._currentBoundTexture[t] = -1),
			cc._renderContext.deleteTexture(e._webTextureObj);
	}),
	(cc.glBindVAO = function (t) {
		cc.TEXTURE_ATLAS_USE_VAO &&
			cc.ENABLE_GL_STATE_CACHE &&
			cc._uVAO !== t &&
			(cc._uVAO = t);
	}),
	(cc.glEnable = function (t) {
		cc.ENABLE_GL_STATE_CACHE;
	}),
	(cc.IMAGE_FORMAT_JPEG = 0),
	(cc.IMAGE_FORMAT_PNG = 1),
	(cc.IMAGE_FORMAT_RAWDATA = 9),
	(cc.NextPOT = function (t) {
		return (
			--t,
			(t |= t >> 1),
			(t |= t >> 2),
			(t |= t >> 4),
			(t |= t >> 8),
			(t |= t >> 16) + 1
		);
	}),
	(cc.RenderTexture = cc.Node.extend({
		sprite: null,
		clearFlags: 0,
		clearDepthVal: 0,
		autoDraw: !1,
		_texture: null,
		_pixelFormat: 0,
		clearStencilVal: 0,
		_clearColor: null,
		_className: 'RenderTexture',
		ctor: function (t, e, i, n) {
			cc.Node.prototype.ctor.call(this),
				(this._cascadeColorEnabled = !0),
				(this._cascadeOpacityEnabled = !0),
				(this._pixelFormat = cc.Texture2D.PIXEL_FORMAT_RGBA8888),
				(this._clearColor = new cc.Color(0, 0, 0, 255)),
				void 0 !== t &&
					void 0 !== e &&
					((i = i || cc.Texture2D.PIXEL_FORMAT_RGBA8888),
					(n = n || 0),
					this.initWithWidthAndHeight(t, e, i, n)),
				this.setAnchorPoint(0, 0);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.RenderTexture.CanvasRenderCmd
					: cc.RenderTexture.WebGLRenderCmd
			)(this);
		},
		cleanup: function () {
			cc.Node.prototype.onExit.call(this), this._renderCmd.cleanup();
		},
		getSprite: function () {
			return this.sprite;
		},
		setSprite: function (t) {
			this.sprite = t;
		},
		setVirtualViewport: function (t, e, i) {
			this._renderCmd.setVirtualViewport(t, e, i);
		},
		initWithWidthAndHeight: function (t, e, i, n) {
			return this._renderCmd.initWithWidthAndHeight(t, e, i, n);
		},
		begin: function () {
			cc.renderer._turnToCacheMode(this.__instanceId),
				this._renderCmd.begin();
		},
		beginWithClear: function (t, e, i, n, r, o) {
			var s = cc._renderContext;
			(r = r || s.COLOR_BUFFER_BIT),
				(o = o || s.COLOR_BUFFER_BIT | s.DEPTH_BUFFER_BIT),
				this._beginWithClear(
					t,
					e,
					i,
					n,
					r,
					o,
					s.COLOR_BUFFER_BIT |
						s.DEPTH_BUFFER_BIT |
						s.STENCIL_BUFFER_BIT
				);
		},
		_beginWithClear: function (t, e, i, n, r, o, s) {
			this.begin(), this._renderCmd._beginWithClear(t, e, i, n, r, o, s);
		},
		end: function () {
			this._renderCmd.end();
		},
		clear: function (t, e, i, n) {
			this.beginWithClear(t, e, i, n), this.end();
		},
		clearRect: function (t, e, i, n) {
			this._renderCmd.clearRect(t, e, i, n);
		},
		clearDepth: function (t) {
			this._renderCmd.clearDepth(t);
		},
		clearStencil: function (t) {
			this._renderCmd.clearStencil(t);
		},
		getClearFlags: function () {
			return this.clearFlags;
		},
		setClearFlags: function (t) {
			this.clearFlags = t;
		},
		getClearColor: function () {
			return this._clearColor;
		},
		setClearColor: function (t) {
			var e = this._clearColor;
			(e.r = t.r),
				(e.g = t.g),
				(e.b = t.b),
				(e.a = t.a),
				this._renderCmd.updateClearColor(t);
		},
		getClearDepth: function () {
			return this.clearDepthVal;
		},
		setClearDepth: function (t) {
			this.clearDepthVal = t;
		},
		getClearStencil: function () {
			return this.clearStencilVal;
		},
		setClearStencil: function (t) {
			this.clearStencilVal = t;
		},
		isAutoDraw: function () {
			return this.autoDraw;
		},
		setAutoDraw: function (t) {
			this.autoDraw = t;
		},
		saveToFile: function (t, e) {
			cc.log("saveToFile isn't supported on Cocos2d-Html5");
		},
		newCCImage: function (t) {
			return cc.log("saveToFile isn't supported on cocos2d-html5"), null;
		},
		listenToBackground: function (t) {},
		listenToForeground: function (t) {},
	}));
var _p = cc.RenderTexture.prototype;
_p.clearColorVal,
	cc.defineGetterSetter(
		_p,
		'clearColorVal',
		_p.getClearColor,
		_p.setClearColor
	),
	(cc.RenderTexture.create = function (t, e, i, n) {
		return new cc.RenderTexture(t, e, i, n);
	}),
	(function () {
		cc.RenderTexture.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._clearColorStr = 'rgba(255,255,255,1)'),
				(this._cacheCanvas = document.createElement('canvas')),
				(this._cacheContext = new cc.CanvasContextWrapper(
					this._cacheCanvas.getContext('2d')
				));
		};
		var t = (cc.RenderTexture.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.RenderTexture.CanvasRenderCmd),
			(t.cleanup = function () {
				(this._cacheContext = null), (this._cacheCanvas = null);
			}),
			(t.clearStencil = function (t) {}),
			(t.setVirtualViewport = function (t, e, i) {}),
			(t.updateClearColor = function (t) {
				this._clearColorStr =
					'rgba(' +
					(0 | t.r) +
					',' +
					(0 | t.g) +
					',' +
					(0 | t.b) +
					',' +
					t.a / 255 +
					')';
			}),
			(t.initWithWidthAndHeight = function (t, e, i, n) {
				var r = this._node,
					o = this._cacheCanvas,
					s = cc.contentScaleFactor();
				(o.width = 0 | (t * s)), (o.height = 0 | (e * s));
				s = new cc.Texture2D();
				s.initWithElement(o), s.handleLoadedTexture();
				s = r.sprite = new cc.Sprite(s);
				return (
					s.setBlendFunc(cc.ONE, cc.ONE_MINUS_SRC_ALPHA),
					(r.autoDraw = !1),
					r.addChild(s),
					!0
				);
			}),
			(t.begin = function () {}),
			(t._beginWithClear = function (t, e, i, n, r, o, s) {
				(t = t || 0),
					(e = e || 0),
					(i = i || 0),
					(n = isNaN(n) ? 255 : n);
				var c = this._cacheContext.getContext(),
					a = this._cacheCanvas;
				c.setTransform(1, 0, 0, 1, 0, 0),
					this._cacheContext.setFillStyle(
						'rgba(' +
							(0 | t) +
							',' +
							(0 | e) +
							',' +
							(0 | i) +
							',' +
							n / 255 +
							')'
					),
					c.clearRect(0, 0, a.width, a.height),
					c.fillRect(0, 0, a.width, a.height);
			}),
			(t.end = function () {
				var t = this._node,
					e = cc.contentScaleFactor();
				cc.renderer._renderingToCacheCanvas(
					this._cacheContext,
					t.__instanceId,
					e,
					e
				);
				t = t.sprite._renderCmd;
				t._notifyRegionStatus &&
					t._notifyRegionStatus(
						cc.Node.CanvasRenderCmd.RegionStatus.Dirty
					);
			}),
			(t.clearRect = function (t, e, i, n) {
				this._cacheContext.clearRect(t, e, i, -n);
			}),
			(t.clearDepth = function (t) {
				cc.log("clearDepth isn't supported on Cocos2d-Html5");
			}),
			(t.visit = function (t) {
				var e = this._node;
				this._syncStatus(t),
					e.sprite.visit(this),
					(this._dirtyFlag = 0);
			});
	})(),
	(function () {
		cc.RenderTexture.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._fBO = null),
				(this._oldFBO = null),
				(this._textureCopy = null),
				(this._depthRenderBuffer = null),
				(this._rtTextureRect = new cc.Rect()),
				(this._fullRect = new cc.Rect()),
				(this._fullViewport = new cc.Rect());
		};
		var t = (cc.RenderTexture.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.RenderTexture.WebGLRenderCmd),
			(t.setVirtualViewport = function (t, e, i) {
				(this._rtTextureRect.x = t.x),
					(this._rtTextureRect.y = t.y),
					(this._fullRect = e),
					(this._fullViewport = i);
			}),
			(t.needDraw = function () {
				return this._needDraw && this._node.autoDraw;
			}),
			(t.rendering = function (t) {
				var e = t || cc._renderContext,
					i = this._node;
				if (i.autoDraw) {
					i.begin();
					var n,
						r,
						o = i.clearFlags;
					o &&
						((n = [0, 0, 0, 0]),
						(t = r = 0),
						o & e.COLOR_BUFFER_BIT &&
							((n = e.getParameter(e.COLOR_CLEAR_VALUE)),
							e.clearColor(
								i._clearColor.r / 255,
								i._clearColor.g / 255,
								i._clearColor.b / 255,
								i._clearColor.a / 255
							)),
						o & e.DEPTH_BUFFER_BIT &&
							((r = e.getParameter(e.DEPTH_CLEAR_VALUE)),
							e.clearDepth(i.clearDepthVal)),
						o & e.STENCIL_BUFFER_BIT &&
							((t = e.getParameter(e.STENCIL_CLEAR_VALUE)),
							e.clearStencil(i.clearStencilVal)),
						e.clear(o),
						o & e.COLOR_BUFFER_BIT &&
							e.clearColor(n[0], n[1], n[2], n[3]),
						o & e.DEPTH_BUFFER_BIT && e.clearDepth(r),
						o & e.STENCIL_BUFFER_BIT && e.clearStencil(t)),
						i.sortAllChildren();
					for (var s = i._children, c = 0; c < s.length; c++) {
						var a = s[c];
						a !== i.sprite &&
							a._renderCmd.visit(i.sprite._renderCmd);
					}
					i.end();
				}
			}),
			(t.clearStencil = function (t) {
				var e = cc._renderContext,
					i = e.getParameter(e.STENCIL_CLEAR_VALUE);
				e.clearStencil(t),
					e.clear(e.STENCIL_BUFFER_BIT),
					e.clearStencil(i);
			}),
			(t.cleanup = function () {
				this._node;
				this._textureCopy = null;
				var t = cc._renderContext;
				t.deleteFramebuffer(this._fBO),
					this._depthRenderBuffer &&
						t.deleteRenderbuffer(this._depthRenderBuffer);
			}),
			(t.updateClearColor = function (t) {}),
			(t.initWithWidthAndHeight = function (t, e, i, n) {
				var r = this._node;
				i === cc.Texture2D.PIXEL_FORMAT_A8 &&
					cc.log(
						'cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;'
					);
				var o,
					s,
					c = cc._renderContext,
					a = cc.contentScaleFactor();
				(this._fullRect = new cc.Rect(0, 0, t, e)),
					(this._fullViewport = new cc.Rect(0, 0, t, e)),
					(t = 0 | (t * a)),
					(e = 0 | (e * a)),
					(this._oldFBO = c.getParameter(c.FRAMEBUFFER_BINDING)),
					(s = cc.configuration.supportsNPOT()
						? ((o = t), e)
						: ((o = cc.NextPOT(t)), cc.NextPOT(e)));
				for (
					var l = new Uint8Array(o * s * 4), h = 0;
					h < o * s * 4;
					h++
				)
					l[h] = 0;
				this._pixelFormat = i;
				a = r._texture = new cc.Texture2D();
				if (!r._texture) return !1;
				a.initWithData(l, r._pixelFormat, o, s, cc.size(t, e));
				i = c.getParameter(c.RENDERBUFFER_BINDING);
				if (cc.configuration.checkForGLExtension('GL_QCOM')) {
					if (
						((this._textureCopy = new cc.Texture2D()),
						!this._textureCopy)
					)
						return !1;
					this._textureCopy.initWithData(
						l,
						r._pixelFormat,
						o,
						s,
						cc.size(t, e)
					);
				}
				(this._fBO = c.createFramebuffer()),
					c.bindFramebuffer(c.FRAMEBUFFER, this._fBO),
					c.framebufferTexture2D(
						c.FRAMEBUFFER,
						c.COLOR_ATTACHMENT0,
						c.TEXTURE_2D,
						a._webTextureObj,
						0
					),
					0 !== n &&
						((this._depthRenderBuffer = c.createRenderbuffer()),
						c.bindRenderbuffer(
							c.RENDERBUFFER,
							this._depthRenderBuffer
						),
						c.renderbufferStorage(c.RENDERBUFFER, n, o, s),
						n === c.DEPTH_STENCIL
							? c.framebufferRenderbuffer(
									c.FRAMEBUFFER,
									c.DEPTH_STENCIL_ATTACHMENT,
									c.RENDERBUFFER,
									this._depthRenderBuffer
							  )
							: n === c.STENCIL_INDEX || n === c.STENCIL_INDEX8
							? c.framebufferRenderbuffer(
									c.FRAMEBUFFER,
									c.STENCIL_ATTACHMENT,
									c.RENDERBUFFER,
									this._depthRenderBuffer
							  )
							: n === c.DEPTH_COMPONENT16 &&
							  c.framebufferRenderbuffer(
									c.FRAMEBUFFER,
									c.DEPTH_ATTACHMENT,
									c.RENDERBUFFER,
									this._depthRenderBuffer
							  )),
					c.checkFramebufferStatus(c.FRAMEBUFFER) !==
						c.FRAMEBUFFER_COMPLETE &&
						cc.log('Could not attach texture to the framebuffer'),
					a.setAliasTexParameters();
				a = r.sprite = new cc.Sprite(a);
				return (
					(a.scaleY = -1),
					a.setBlendFunc(c.ONE, c.ONE_MINUS_SRC_ALPHA),
					c.bindRenderbuffer(c.RENDERBUFFER, i),
					c.bindFramebuffer(c.FRAMEBUFFER, this._oldFBO),
					(r.autoDraw = !1),
					r.addChild(a),
					!0
				);
			}),
			(t.begin = function () {
				var t = this._node;
				cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),
					cc.kmGLPushMatrix(),
					cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),
					cc.kmGLPushMatrix();
				var e = cc._renderContext,
					i = cc.director;
				i.setProjection(i.getProjection());
				var n = t._texture.getContentSizeInPixels(),
					r = cc.director.getWinSizeInPixels(),
					i = r.width / n.width,
					r = r.height / n.height,
					n = cc.math.Matrix4.createOrthographicProjection(
						-1 / i,
						1 / i,
						-1 / r,
						1 / r,
						-1,
						1
					);
				cc.kmGLMultMatrix(n);
				i = new cc.Rect(0, 0, 0, 0);
				(i.width = this._fullViewport.width),
					(i.height = this._fullViewport.height);
				(r = i.width / this._fullRect.width),
					(n = i.height / this._fullRect.height);
				(i.x = (this._fullRect.x - this._rtTextureRect.x) * r),
					(i.y = (this._fullRect.y - this._rtTextureRect.y) * n),
					e.viewport(i.x, i.y, i.width, i.height),
					(this._oldFBO = e.getParameter(e.FRAMEBUFFER_BINDING)),
					e.bindFramebuffer(e.FRAMEBUFFER, this._fBO),
					cc.configuration.checkForGLExtension('GL_QCOM') &&
						(e.framebufferTexture2D(
							e.FRAMEBUFFER,
							e.COLOR_ATTACHMENT0,
							e.TEXTURE_2D,
							this._textureCopy._webTextureObj,
							0
						),
						e.clear(e.COLOR_BUFFER_BIT | e.DEPTH_BUFFER_BIT),
						e.framebufferTexture2D(
							e.FRAMEBUFFER,
							e.COLOR_ATTACHMENT0,
							e.TEXTURE_2D,
							t._texture._webTextureObj,
							0
						));
			}),
			(t._beginWithClear = function (t, e, i, n, r, o, s) {
				(t /= 255), (e /= 255), (i /= 255), (n /= 255);
				var c = cc._renderContext,
					a = [0, 0, 0, 0],
					l = 0,
					h = 0;
				s & c.COLOR_BUFFER_BIT &&
					((a = c.getParameter(c.COLOR_CLEAR_VALUE)),
					c.clearColor(t, e, i, n)),
					s & c.DEPTH_BUFFER_BIT &&
						((l = c.getParameter(c.DEPTH_CLEAR_VALUE)),
						c.clearDepth(r)),
					s & c.STENCIL_BUFFER_BIT &&
						((h = c.getParameter(c.STENCIL_CLEAR_VALUE)),
						c.clearStencil(o)),
					c.clear(s),
					s & c.COLOR_BUFFER_BIT &&
						c.clearColor(a[0], a[1], a[2], a[3]),
					s & c.DEPTH_BUFFER_BIT && c.clearDepth(l),
					s & c.STENCIL_BUFFER_BIT && c.clearStencil(h);
			}),
			(t.end = function () {
				var t = this._node;
				cc.renderer._renderingToBuffer(t.__instanceId);
				var e = cc._renderContext,
					t = cc.director;
				e.bindFramebuffer(e.FRAMEBUFFER, this._oldFBO),
					t.setViewport(),
					cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),
					cc.kmGLPopMatrix(),
					cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),
					cc.kmGLPopMatrix();
			}),
			(t.clearRect = function (t, e, i, n) {}),
			(t.clearDepth = function (t) {
				var e = this._node;
				e.begin();
				var i = cc._renderContext,
					n = i.getParameter(i.DEPTH_CLEAR_VALUE);
				i.clearDepth(t),
					i.clear(i.DEPTH_BUFFER_BIT),
					i.clearDepth(n),
					e.end();
			}),
			(t.visit = function (t) {
				var e = this._node;
				e._visible &&
					(cc.kmGLPushMatrix(),
					this._syncStatus(t),
					cc.renderer.pushRenderCommand(this),
					e.sprite.visit(this),
					(this._dirtyFlag = 0),
					cc.kmGLPopMatrix());
			});
	})(),
	(cc.SpriteBatchNode = cc.Node.extend({
		_blendFunc: null,
		_texture: null,
		_className: 'SpriteBatchNode',
		ctor: function (t) {
			var e;
			cc.Node.prototype.ctor.call(this),
				(this._blendFunc = new cc.BlendFunc(
					cc.BLEND_SRC,
					cc.BLEND_DST
				)),
				cc.isString(t)
					? (e =
							(e = cc.textureCache.getTextureForKey(t)) ||
							cc.textureCache.addImage(t))
					: t instanceof cc.Texture2D && (e = t),
				e && this.initWithTexture(e);
		},
		addSpriteWithoutQuad: function (t, e, i) {
			return this.addChild(t, e, i), this;
		},
		getTextureAtlas: function () {
			return null;
		},
		setTextureAtlas: function (t) {},
		getDescendants: function () {
			return this._children;
		},
		initWithFile: function (t, e) {
			var i =
				(i = cc.textureCache.getTextureForKey(t)) ||
				cc.textureCache.addImage(t);
			return this.initWithTexture(i, e);
		},
		init: function (t, e) {
			var i =
				(i = cc.textureCache.getTextureForKey(t)) ||
				cc.textureCache.addImage(t);
			return this.initWithTexture(i, e);
		},
		increaseAtlasCapacity: function () {},
		removeChildAtIndex: function (t, e) {
			this.removeChild(this._children[t], e);
		},
		rebuildIndexInOrder: function (t, e) {
			return e;
		},
		highestAtlasIndexInChild: function (t) {
			var e = t.children;
			return e && 0 !== e.length
				? this.highestAtlasIndexInChild(e[e.length - 1])
				: t.zIndex;
		},
		lowestAtlasIndexInChild: function (t) {
			var e = t.children;
			return e && 0 !== e.length
				? this.lowestAtlasIndexInChild(e[e.length - 1])
				: t.zIndex;
		},
		atlasIndexForChild: function (t) {
			return t.zIndex;
		},
		reorderBatch: function (t) {
			this._reorderChildDirty = t;
		},
		setBlendFunc: function (t, e) {
			this._blendFunc = void 0 === e ? t : { src: t, dst: e };
		},
		getBlendFunc: function () {
			return new cc.BlendFunc(this._blendFunc.src, this._blendFunc.dst);
		},
		updateQuadFromSprite: function (t, e) {
			cc.assert(t, cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2),
				t instanceof cc.Sprite
					? ((t.dirty = !0),
					  t._renderCmd.transform(this._renderCmd, !0))
					: cc.log(
							cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite
					  );
		},
		insertQuadFromSprite: function (t, e) {
			this.addChild(t, e);
		},
		insertChild: function (t, e) {
			this.addChild(t, e);
		},
		appendChild: function (t) {
			this.sortAllChildren();
			this._children[this._children.length - 1]._localZOrder;
			this.addChild(t.lastLocalZOrder + 1);
		},
		removeSpriteFromAtlas: function (t, e) {
			this.removeChild(t, e);
		},
		initWithTexture: function (t) {
			return this.setTexture(t), !0;
		},
		getTexture: function () {
			return this._texture;
		},
		setTexture: function (n) {
			if ((this._texture = n)._textureLoaded)
				for (var t = this._children, e = t.length, i = 0; i < e; ++i)
					t[i].setTexture(n);
			else
				n.addEventListener(
					'load',
					function () {
						for (
							var t = this._children, e = t.length, i = 0;
							i < e;
							++i
						)
							t[i].setTexture(n);
					},
					this
				);
		},
		setShaderProgram: function (t) {
			this._renderCmd.setShaderProgram(t);
			for (var e = this._children, i = e.length, n = 0; n < i; ++n)
				e[n].setShaderProgram(t);
		},
		addChild: function (t, e, i) {
			cc.assert(void 0 !== t, cc._LogInfos.CCSpriteBatchNode_addChild_3),
				this._isValidChild(t) &&
					((e = void 0 === e ? t.zIndex : e),
					(i = void 0 === i ? t.tag : i),
					cc.Node.prototype.addChild.call(this, t, e, i),
					this._renderCmd._shaderProgram &&
						(t.shaderProgram = this._renderCmd._shaderProgram));
		},
		_isValidChild: function (t) {
			return t instanceof cc.Sprite
				? t.texture === this._texture ||
						(cc.log(cc._LogInfos.Sprite_addChild_5), !1)
				: (cc.log(cc._LogInfos.Sprite_addChild_4), !1);
		},
	}));
var _p = cc.SpriteBatchNode.prototype;
cc.defineGetterSetter(_p, 'texture', _p.getTexture, _p.setTexture),
	cc.defineGetterSetter(
		_p,
		'shaderProgram',
		_p.getShaderProgram,
		_p.setShaderProgram
	),
	(cc.SpriteBatchNode.create = function (t) {
		return new cc.SpriteBatchNode(t);
	}),
	(cc.SpriteBatchNode.createWithTexture = cc.SpriteBatchNode.create),
	(cc.LabelAtlas = cc.AtlasNode.extend({
		_string: null,
		_mapStartChar: null,
		_textureLoaded: !1,
		_className: 'LabelAtlas',
		ctor: function (t, e, i, n, r) {
			cc.AtlasNode.prototype.ctor.call(this),
				this._renderCmd.setCascade(),
				e &&
					cc.LabelAtlas.prototype.initWithString.call(
						this,
						t,
						e,
						i,
						n,
						r
					);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? cc.LabelAtlas.WebGLRenderCmd
					: cc.LabelAtlas.CanvasRenderCmd
			)(this);
		},
		textureLoaded: function () {
			return this._textureLoaded;
		},
		addLoadedEventListener: function (t, e) {
			this.addEventListener('load', t, e);
		},
		initWithString: function (t, e, i, n, r) {
			var o = t + '';
			if (void 0 === i) {
				var s = cc.loader.getRes(e);
				if (1 !== parseInt(s.version, 10))
					return (
						cc.log(
							'cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version'
						),
						!1
					);
				h = cc.path.changeBasename(e, s.textureFilename);
				var t = cc.contentScaleFactor(),
					c = parseInt(s.itemWidth, 10) / t,
					a = parseInt(s.itemHeight, 10) / t,
					s = String.fromCharCode(parseInt(s.firstChar, 10));
			} else (h = e), (c = i || 0), (a = n || 0), (s = r || ' ');
			var l = null,
				h = (l =
					h instanceof cc.Texture2D
						? h
						: cc.textureCache.addImage(h)).isLoaded();
			return (
				(this._textureLoaded = h) ||
					((this._string = o),
					l.addEventListener(
						'load',
						function (t) {
							this.initWithTexture(l, c, a, o.length),
								(this.string = this._string),
								this.setColor(this._renderCmd._displayedColor),
								this.dispatchEvent('load');
						},
						this
					)),
				!!this.initWithTexture(l, c, a, o.length) &&
					((this._mapStartChar = s), (this.string = o), !0)
			);
		},
		setColor: function (t) {
			cc.AtlasNode.prototype.setColor.call(this, t),
				this._renderCmd.updateAtlasValues();
		},
		getString: function () {
			return this._string;
		},
		addChild: function (t, e, i) {
			this._renderCmd._addChild(t),
				cc.Node.prototype.addChild.call(this, t, e, i);
		},
		updateAtlasValues: function () {
			this._renderCmd.updateAtlasValues();
		},
		setString: function (t) {
			var e = (t = String(t)).length;
			(this._string = t),
				this.setContentSize(e * this._itemWidth, this._itemHeight),
				this._renderCmd.setString(t),
				this._renderCmd.updateAtlasValues(),
				(this.quadsToDraw = e);
		},
	})),
	(function () {
		var t = cc.LabelAtlas.prototype;
		cc.defineGetterSetter(t, 'opacity', t.getOpacity, t.setOpacity),
			cc.defineGetterSetter(t, 'color', t.getColor, t.setColor),
			t.string,
			cc.defineGetterSetter(t, 'string', t.getString, t.setString);
	})(),
	(cc.LabelAtlas.create = function (t, e, i, n, r) {
		return new cc.LabelAtlas(t, e, i, n, r);
	}),
	(function () {
		cc.LabelAtlas.CanvasRenderCmd = function (t) {
			cc.AtlasNode.CanvasRenderCmd.call(this, t), (this._needDraw = !1);
		};
		var t = (cc.LabelAtlas.CanvasRenderCmd.prototype = Object.create(
			cc.AtlasNode.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.LabelAtlas.CanvasRenderCmd),
			(t.setCascade = function () {
				var t = this._node;
				(t._cascadeOpacityEnabled = !0), (t._cascadeColorEnabled = !1);
			}),
			(t.updateAtlasValues = function () {
				for (
					var t = this._node,
						e = t._string || '',
						i = e.length,
						n = this._textureToRender,
						r = t._itemWidth,
						o = t._itemHeight,
						s = 0,
						c = -1;
					s < i;
					s++
				) {
					var a = e.charCodeAt(s) - t._mapStartChar.charCodeAt(0),
						l = parseInt(a % t._itemsPerRow, 10),
						h = parseInt(a / t._itemsPerRow, 10);
					l < 0 ||
						h < 0 ||
						((a = cc.rect(l * r, h * o, r, o)),
						(l = n._contentSize),
						a.x < 0 ||
							a.y < 0 ||
							a.x + a.width > l.width ||
							a.y + a.height > l.height ||
							(c++,
							(h = e.charCodeAt(s)),
							(l = t.getChildByTag(s))
								? 32 === h
									? (l.init(),
									  l.setTextureRect(
											cc.rect(0, 0, 10, 10),
											!1,
											cc.size(0, 0)
									  ))
									: (l.initWithTexture(n, a),
									  (l.visible = !0))
								: ((l = new cc.Sprite()),
								  32 === h
										? (l.init(),
										  l.setTextureRect(
												cc.rect(0, 0, 10, 10),
												!1,
												cc.size(0, 0)
										  ))
										: l.initWithTexture(n, a),
								  cc.Node.prototype.addChild.call(t, l, 0, s)),
							l.setPosition(c * r + r / 2, o / 2)));
				}
				this.updateContentSize(s, c + 1);
			}),
			(t.updateContentSize = function (t, e) {
				var i = this._node,
					n = i._contentSize;
				t !== e &&
					t * i._itemWidth === n.width &&
					i._itemHeight === n.height &&
					i.setContentSize(e * i._itemWidth, i._itemHeight);
			}),
			(t.setString = function (t) {
				var e = this._node;
				if (e._children)
					for (var i = e._children, n = i.length, r = 0; r < n; r++) {
						var o = i[r];
						o && !o._lateChild && (o.visible = !1);
					}
			}),
			(t._addChild = function () {
				child._lateChild = !0;
			});
	})(),
	(cc.LabelBMFont = cc.SpriteBatchNode.extend({
		_opacityModifyRGB: !1,
		_string: '',
		_config: null,
		_fntFile: '',
		_initialString: '',
		_alignment: cc.TEXT_ALIGNMENT_CENTER,
		_width: -1,
		_lineBreakWithoutSpaces: !1,
		_imageOffset: null,
		_textureLoaded: !1,
		_className: 'LabelBMFont',
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? cc.LabelBMFont.WebGLRenderCmd
					: cc.LabelBMFont.CanvasRenderCmd
			)(this);
		},
		_setString: function (t, e) {
			e ? (this._initialString = t) : (this._string = t);
			var i = this._children;
			if (i)
				for (var n = 0; n < i.length; n++) {
					var r = i[n];
					r && r.setVisible(!1);
				}
			this._textureLoaded &&
				(this.createFontChars(), e && this.updateLabel());
		},
		ctor: function (t, e, i, n, r) {
			cc.SpriteBatchNode.prototype.ctor.call(this),
				(this._imageOffset = cc.p(0, 0)),
				(this._cascadeColorEnabled = !0),
				(this._cascadeOpacityEnabled = !0),
				this.initWithString(t, e, i, n, r);
		},
		textureLoaded: function () {
			return this._textureLoaded;
		},
		addLoadedEventListener: function (t, e) {
			this.addEventListener('load', t, e);
		},
		isOpacityModifyRGB: function () {
			return this._opacityModifyRGB;
		},
		setOpacityModifyRGB: function (t) {
			this._opacityModifyRGB = t;
			var e = this._children;
			if (e)
				for (var i = 0; i < e.length; i++) {
					var n = e[i];
					n && (n.opacityModifyRGB = this._opacityModifyRGB);
				}
		},
		_changeTextureColor: function () {
			this._renderCmd._changeTextureColor();
		},
		init: function () {
			return this.initWithString(null, null, null, null, null);
		},
		initWithString: function (t, e, i, n, r) {
			var o,
				s = this,
				t = t || '';
			if (
				(s._config &&
					cc.log(
						'cc.LabelBMFont.initWithString(): re-init is no longer supported'
					),
				e)
			) {
				var c = cc.loader.getRes(e);
				if (!c)
					return (
						cc.log(
							'cc.LabelBMFont.initWithString(): Impossible to create font. Please check file'
						),
						!1
					);
				(s._config = c), (s._fntFile = e);
				c = (o = cc.textureCache.addImage(c.atlasName)).isLoaded();
				(s._textureLoaded = c) ||
					o.addEventListener(
						'load',
						function (t) {
							(this._textureLoaded = !0),
								this.initWithTexture(
									t,
									this._initialString.length
								),
								this.setString(this._initialString, !0),
								this.dispatchEvent('load');
						},
						s
					);
			} else {
				o = new cc.Texture2D();
				c = new Image();
				o.initWithElement(c), (s._textureLoaded = !1);
			}
			return (
				!!s.initWithTexture(o, t.length) &&
				((s._alignment = n || cc.TEXT_ALIGNMENT_LEFT),
				(s._imageOffset = r || cc.p(0, 0)),
				(s._width = void 0 === i ? -1 : i),
				(s._realOpacity = 255),
				(s._realColor = cc.color(255, 255, 255, 255)),
				(s._contentSize.width = 0),
				(s._contentSize.height = 0),
				s.setAnchorPoint(0.5, 0.5),
				s.setString(t, !0),
				!0)
			);
		},
		createFontChars: function () {
			var t = this._renderCmd,
				e = t._texture || this._texture,
				i = 0,
				n = cc.size(0, 0),
				r = 0,
				o = 1,
				s = this._string,
				c = s ? s.length : 0;
			if (0 !== c) {
				for (
					var a = this._config,
						l = a.kerningDict,
						h = a.commonHeight,
						u = a.fontDefDictionary,
						_ = 0;
					_ < c - 1;
					_++
				)
					10 === s.charCodeAt(_) && o++;
				var d = h * o,
					p = -(h - h * o),
					f = -1;
				for (_ = 0; _ < c; _++) {
					var m,
						g,
						y,
						T,
						S,
						C = s.charCodeAt(_);
					0 !== C &&
						(10 !== C
							? ((m = l[(f << 16) | (65535 & C)] || 0),
							  (g = u[C]) ||
									(cc.log(
										'cocos2d: LabelBMFont: character not found ' +
											s[_]
									),
									(g = {
										rect: {
											x: 0,
											y: 0,
											width: 0,
											height: 0,
										},
										xOffset: 0,
										yOffset: 0,
										xAdvance: 0,
									})),
							  (S = cc.rect(
									g.rect.x,
									g.rect.y,
									g.rect.width,
									g.rect.height
							  )),
							  ((S = cc.rectPixelsToPoints(S)).x +=
									this._imageOffset.x),
							  (S.y += this._imageOffset.y),
							  (y = this.getChildByTag(_))
									? t._updateCharTexture(y, S, C)
									: ((y = new cc.Sprite()).initWithTexture(
											e,
											S,
											!1
									  ),
									  (y._newTextureWhenChangeColor = !0),
									  this.addChild(y, 0, _)),
							  (y.opacityModifyRGB = this._opacityModifyRGB),
							  t._updateCharColorAndOpacity(y),
							  (T = a.commonHeight - g.yOffset),
							  (S = cc.p(
									i + g.xOffset + 0.5 * g.rect.width + m,
									p +
										T -
										0.5 * S.height * cc.contentScaleFactor()
							  )),
							  y.setPosition(cc.pointPixelsToPoints(S)),
							  (f = C),
							  r < (i += g.xAdvance + m) && (r = i))
							: ((i = 0), (p -= a.commonHeight)));
				}
				g && g.xAdvance < g.rect.width
					? (n.width = r - g.xAdvance + g.rect.width)
					: (n.width = r),
					(n.height = d),
					this.setContentSize(cc.sizePixelsToPoints(n));
			}
		},
		updateString: function (t) {
			var e = this._children;
			if (e)
				for (var i = 0, n = e.length; i < n; i++) {
					var r = e[i];
					r && (r.visible = !1);
				}
			this._config && this.createFontChars(), t || this.updateLabel();
		},
		getString: function () {
			return this._initialString;
		},
		setString: function (t, e) {
			null == e && (e = !0),
				(null != (t = String(t)) && cc.isString(t)) || (t += ''),
				(this._initialString = t),
				this._setString(t, e);
		},
		_setStringForSetter: function (t) {
			this.setString(t, !1);
		},
		setCString: function (t) {
			this.setString(t, !0);
		},
		_getCharsWidth: function (t, e) {
			if (e <= 0) return 0;
			var i = this.getChildByTag(t),
				e = this.getChildByTag(t + e);
			return this._getLetterPosXLeft(e) - this._getLetterPosXLeft(i);
		},
		_checkWarp: function (t, e, i, n) {
			for (var r = t[e], o = 0, s = 0; s < e; s++) o += t[s].length;
			o = o + e - n;
			var c = this._getCharsWidth(o, t[e].length - 1);
			if (i < c && 1 < r.length) {
				for (
					var a,
						l,
						h = (r.length * (i / c)) | 0,
						u = r.substr(h),
						_ = c - this._getCharsWidth(o + h, u.length - 1),
						d = 0,
						p = 0;
					i < _ && p++ < 100;

				)
					(h *= i / _),
						(h |= 0),
						(u = r.substr(h)),
						(_ = c - this._getCharsWidth(o + h, u.length - 1));
				for (p = 0; _ < i && p++ < 100; )
					u &&
						((d = (a = cc.LabelTTF._wordRex.exec(u))
							? a[0].length
							: 1),
						(l = u)),
						this._lineBreakWithoutSpaces && (d = 0),
						(h += d),
						(u = r.substr(h)),
						(_ = c - this._getCharsWidth(o + h, u.length - 1));
				0 === (h -= d) && ((h = 1), (l = l.substr(1)));
				var f,
					n = r.substr(0, h);
				cc.LabelTTF.wrapInspection &&
					cc.LabelTTF._symbolRex.test(l || u) &&
					((d = (f = cc.LabelTTF._lastWordRex.exec(n))
						? f[0].length
						: 0),
					this._lineBreakWithoutSpaces && (d = 0),
					(h -= d),
					(l = r.substr(h)),
					(n = r.substr(0, h))),
					cc.LabelTTF._firsrEnglish.test(l) &&
						(f = cc.LabelTTF._lastEnglish.exec(n)) &&
						n !== f[0] &&
						((d = f[0].length),
						this._lineBreakWithoutSpaces && (d = 0),
						(h -= d),
						(l = r.substr(h)),
						(n = r.substr(0, h))),
					(t[e] = l || u),
					t.splice(e, 0, n);
			}
		},
		updateLabel: function () {
			var t,
				e,
				i = this;
			if (((i.string = i._initialString), 0 < i._width)) {
				for (
					var n, r = i.string.split('\n'), o = '', s = 0, c = 0;
					c < r.length;
					c++
				)
					(n = r.length),
						this._checkWarp(r, c, i._width * this._scaleX, s),
						n < r.length && s++,
						0 < c && (o += '\n'),
						(o += r[c]);
				(o += String.fromCharCode(0)), i._setString(o, !1);
			}
			if (i._alignment !== cc.TEXT_ALIGNMENT_LEFT)
				for (
					var a = (c = 0), l = i._string.length, h = [], u = 0;
					u < l;
					u++
				)
					if (
						10 !== i._string[u].charCodeAt(0) &&
						0 !== i._string[u].charCodeAt(0)
					)
						h.push(i._string[c]);
					else {
						var _,
							d = h.length;
						if (0 !== d) {
							var p = c + d - 1 + a;
							if (!(p < 0)) {
								var f = i.getChildByTag(p);
								if (null != f) {
									_ = f.getPositionX() + f._getWidth() / 2;
									var m = 0;
									switch (i._alignment) {
										case cc.TEXT_ALIGNMENT_CENTER:
											m = i.width / 2 - _ / 2;
											break;
										case cc.TEXT_ALIGNMENT_RIGHT:
											m = i.width - _;
									}
									if (0 !== m)
										for (t = 0; t < d; t++)
											(p = c + t + a) < 0 ||
												((e = i.getChildByTag(p)) &&
													(e.x += m));
									(c += d), a++, (h.length = 0);
								}
							}
						} else a++;
					}
		},
		setAlignment: function (t) {
			(this._alignment = t), this.updateLabel();
		},
		_getAlignment: function () {
			return this._alignment;
		},
		setBoundingWidth: function (t) {
			(this._width = t), this.updateLabel();
		},
		_getBoundingWidth: function () {
			return this._width;
		},
		setLineBreakWithoutSpace: function (t) {
			(this._lineBreakWithoutSpaces = t), this.updateLabel();
		},
		setScale: function (t, e) {
			cc.Node.prototype.setScale.call(this, t, e), this.updateLabel();
		},
		setScaleX: function (t) {
			cc.Node.prototype.setScaleX.call(this, t), this.updateLabel();
		},
		setScaleY: function (t) {
			cc.Node.prototype.setScaleY.call(this, t), this.updateLabel();
		},
		setFntFile: function (t) {
			var e;
			null != t &&
				t !== this._fntFile &&
				((e = cc.loader.getRes(t))
					? ((this._fntFile = t),
					  (this._config = e),
					  (e = (t = cc.textureCache.addImage(
							e.atlasName
					  )).isLoaded()),
					  (this._textureLoaded = e)
							? (this.setTexture(t), this.createFontChars())
							: t.addEventListener(
									'load',
									function (t) {
										(this._textureLoaded = !0),
											this.setTexture(t),
											this.createFontChars(),
											this._changeTextureColor(),
											this.updateLabel(),
											this.dispatchEvent('load');
									},
									this
							  ))
					: cc.log(
							'cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file'
					  ));
		},
		getFntFile: function () {
			return this._fntFile;
		},
		setTexture: function (t) {
			(this._texture = t), this._renderCmd.setTexture(t);
		},
		setAnchorPoint: function (t, e) {
			cc.Node.prototype.setAnchorPoint.call(this, t, e),
				this.updateLabel();
		},
		_setAnchorX: function (t) {
			cc.Node.prototype._setAnchorX.call(this, t), this.updateLabel();
		},
		_setAnchorY: function (t) {
			cc.Node.prototype._setAnchorY.call(this, t), this.updateLabel();
		},
		_atlasNameFromFntFile: function (t) {},
		_kerningAmountForFirst: function (t, e) {
			var i = 0,
				e = (t << 16) | (65535 & e);
			return (
				!this._configuration.kerningDictionary ||
					((e =
						this._configuration.kerningDictionary[e.toString()]) &&
						(i = e.amount)),
				i
			);
		},
		_getLetterPosXLeft: function (t) {
			return (
				t.getPositionX() * this._scaleX -
				t._getWidth() * this._scaleX * t._getAnchorX()
			);
		},
		_getLetterPosXRight: function (t) {
			return (
				t.getPositionX() * this._scaleX +
				t._getWidth() * this._scaleX * t._getAnchorX()
			);
		},
		_isspace_unicode: function (t) {
			return (
				(9 <= (t = t.charCodeAt(0)) && t <= 13) ||
				32 === t ||
				133 === t ||
				160 === t ||
				5760 === t ||
				(8192 <= t && t <= 8202) ||
				8232 === t ||
				8233 === t ||
				8239 === t ||
				8287 === t ||
				12288 === t
			);
		},
		_utf8_trim_ws: function (t) {
			var e = t.length;
			if (!(e <= 0)) {
				var i = e - 1;
				if (this._isspace_unicode(t[i])) {
					for (
						var n = i - 1;
						0 <= n && this._isspace_unicode(t[n]);
						--n
					)
						i = n;
					this._utf8_trim_from(t, i);
				}
			}
		},
		_utf8_trim_from: function (t, e) {
			var i = t.length;
			i <= e || e < 0 || t.splice(e, i);
		},
	})),
	(function () {
		var t = cc.LabelBMFont.prototype;
		cc.EventHelper.prototype.apply(t),
			t.string,
			cc.defineGetterSetter(
				t,
				'string',
				t.getString,
				t._setStringForSetter
			),
			t.boundingWidth,
			cc.defineGetterSetter(
				t,
				'boundingWidth',
				t._getBoundingWidth,
				t.setBoundingWidth
			),
			t.textAlign,
			cc.defineGetterSetter(
				t,
				'textAlign',
				t._getAlignment,
				t.setAlignment
			),
			cc.defineGetterSetter(t, 'texture', t.getTexture, t.setTexture);
	})(),
	(cc.LabelBMFont.create = function (t, e, i, n, r) {
		return new cc.LabelBMFont(t, e, i, n, r);
	});
var _fntLoader = {
	INFO_EXP: /info [^\n]*(\n|$)/gi,
	COMMON_EXP: /common [^\n]*(\n|$)/gi,
	PAGE_EXP: /page [^\n]*(\n|$)/gi,
	CHAR_EXP: /char [^\n]*(\n|$)/gi,
	KERNING_EXP: /kerning [^\n]*(\n|$)/gi,
	ITEM_EXP: /\w+=[^ \r\n]+/gi,
	INT_EXP: /^[\-]?\d+$/,
	_parseStrToObj: function (t) {
		var e = t.match(this.ITEM_EXP),
			i = {};
		if (e)
			for (var n = 0, r = e.length; n < r; n++) {
				var o = e[n],
					s = o.indexOf('='),
					c = o.substring(0, s),
					s = o.substring(s + 1);
				s.match(this.INT_EXP)
					? (s = parseInt(s))
					: '"' === s[0] && (s = s.substring(1, s.length - 1)),
					(i[c] = s);
			}
		return i;
	},
	parseFnt: function (t, e) {
		var i = this,
			n = {},
			r = i._parseStrToObj(t.match(i.INFO_EXP)[0]).padding.split(','),
			o =
				(parseInt(r[0]),
				parseInt(r[1]),
				parseInt(r[2]),
				parseInt(r[3]),
				i._parseStrToObj(t.match(i.COMMON_EXP)[0]));
		(n.commonHeight = o.lineHeight),
			cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
				((r = cc.configuration.getMaxTextureSize()),
				(o.scaleW > r.width || o.scaleH > r.height) &&
					cc.log(
						"cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported"
					)),
			1 !== o.pages &&
				cc.log(
					'cc.LabelBMFont._parseCommonArguments(): only supports 1 page'
				);
		o = i._parseStrToObj(t.match(i.PAGE_EXP)[0]);
		0 !== o.id &&
			cc.log(
				'cc.LabelBMFont._parseImageFileName() : file could not be found'
			),
			(n.atlasName = cc.path.changeBasename(e, o.file));
		for (
			var s = t.match(i.CHAR_EXP),
				c = (n.fontDefDictionary = {}),
				a = 0,
				l = s.length;
			a < l;
			a++
		) {
			var h = i._parseStrToObj(s[a]);
			c[h.id] = {
				rect: { x: h.x, y: h.y, width: h.width, height: h.height },
				xOffset: h.xoffset,
				yOffset: h.yoffset,
				xAdvance: h.xadvance,
			};
		}
		var u = (n.kerningDict = {}),
			_ = t.match(i.KERNING_EXP);
		if (_)
			for (a = 0, l = _.length; a < l; a++) {
				var d = i._parseStrToObj(_[a]);
				u[(d.first << 16) | (65535 & d.second)] = d.amount;
			}
		return n;
	},
	load: function (t, i, e, n) {
		var r = this;
		cc.loader.loadTxt(t, function (t, e) {
			return t ? n(t) : void n(null, r.parseFnt(e, i));
		});
	},
};
cc.loader.register(['fnt'], _fntLoader),
	(function () {
		cc.LabelBMFont.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t);
		};
		var t = (cc.LabelBMFont.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.LabelBMFont.CanvasRenderCmd),
			(t._updateCharTexture = function (t, e, i) {
				32 === i
					? t.setTextureRect(e, !1, cc.size(0, 0))
					: (t.setTextureRect(e, !1), (t.visible = !0));
			}),
			(t._updateCharColorAndOpacity = function (t) {
				(t._displayedColor = this._displayedColor),
					t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),
					(t._displayedOpacity = this._displayedOpacity),
					t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);
			}),
			(t.setTexture = function (t) {
				for (
					var e = this._node,
						i = e._children,
						n = this._displayedColor,
						r = 0;
					r < i.length;
					r++
				) {
					var o = i[r],
						s = o._renderCmd,
						c = s._displayedColor;
					(e._texture === s._texture ||
						(c.r === n.r && c.g === n.g && c.b === n.b)) &&
						(o.texture = t);
				}
				e._texture = t;
			}),
			(t._changeTextureColor = function () {
				var t = this._node,
					e = t._texture,
					i = e.getContentSize(),
					n = t._texture,
					r = n.getHtmlElementObj(),
					o = this._displayedColor,
					s = cc.rect(0, 0, r.width, r.height);
				e &&
					0 < i.width &&
					r &&
					((s = n._generateColorTexture(o.r, o.g, o.b, s)),
					t.setTexture(s));
			}),
			(t._updateChildrenDisplayedOpacity = function (t) {
				cc.Node.prototype.updateDisplayedOpacity.call(
					t,
					this._displayedOpacity
				);
			}),
			(t._updateChildrenDisplayedColor = function (t) {
				cc.Node.prototype.updateDisplayedColor.call(
					t,
					this._displayedColor
				);
			});
	})(),
	(function () {
		cc.LabelAtlas.WebGLRenderCmd = function (t) {
			cc.AtlasNode.WebGLRenderCmd.call(this, t), (this._needDraw = !0);
		};
		var t = (cc.LabelAtlas.WebGLRenderCmd.prototype = Object.create(
			cc.AtlasNode.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.LabelAtlas.WebGLRenderCmd),
			(t._updateColor = function () {
				var t, e;
				this._colorF32Array &&
					((t = this._displayedColor),
					(e = this._displayedOpacity / 255),
					this._node._opacityModifyRGB
						? ((this._colorF32Array[0] = (t.r * e) / 255),
						  (this._colorF32Array[1] = (t.g * e) / 255),
						  (this._colorF32Array[2] = (t.b * e) / 255))
						: ((this._colorF32Array[0] = t.r / 255),
						  (this._colorF32Array[1] = t.g / 255),
						  (this._colorF32Array[2] = t.b / 255)),
					(this._colorF32Array[3] = e));
			}),
			(t.setCascade = function () {
				var t = this._node;
				(t._cascadeOpacityEnabled = !0), (t._cascadeColorEnabled = !0);
			}),
			(t.rendering = function (t) {
				var e, i, n;
				cc.AtlasNode.WebGLRenderCmd.prototype.rendering.call(this, t),
					cc.LABELATLAS_DEBUG_DRAW &&
						((n = (i = this._node).getContentSize()),
						(t = (e = i.getBoundingBoxToWorld()).x),
						(i = e.y),
						(n.width = e.width),
						(n.height = e.height),
						(n = [
							cc.p(t, i),
							cc.p(t + n.width, i),
							cc.p(n.width + t, n.height + i),
							cc.p(t, i + n.height),
						]),
						cc._drawingUtil.drawPoly(n, 4, !0));
			}),
			(t.updateAtlasValues = function () {
				var t = this._node,
					e = t._string,
					i = e.length,
					n = this._textureAtlas,
					r = n.texture,
					o = r.pixelsWidth,
					s = r.pixelsHeight,
					c = t._itemWidth,
					a = t._itemHeight;
				t._ignoreContentScaleFactor ||
					((c = t._itemWidth * cc.contentScaleFactor()),
					(a = t._itemHeight * cc.contentScaleFactor())),
					i > n.getCapacity() &&
						cc.log(
							'cc.LabelAtlas._updateAtlasValues(): Invalid String length'
						);
				for (
					var l = n.quads,
						h = t._itemWidth,
						u = t._itemHeight,
						_ = 0,
						d = -1;
					_ < i;
					_++
				) {
					var p,
						f,
						m,
						g,
						y,
						T = e.charCodeAt(_) - t._mapStartChar.charCodeAt(0),
						S = T % t._itemsPerRow,
						C = 0 | (T / t._itemsPerRow);
					S < 0 ||
						C < 0 ||
						o < S * h + h ||
						s < C * u + u ||
						(d++,
						(g = cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL
							? ((f =
									(p = (2 * S * c + 1) / (2 * o)) +
									(2 * c - 2) / (2 * o)),
							  (m = (2 * C * a + 1) / (2 * s)) +
									(2 * a - 2) / (2 * s))
							: ((f = (p = (S * c) / o) + c / o),
							  (m = (C * a) / s) + a / s)),
						(T = (y = l[_]).tl),
						(S = y.tr),
						(C = y.bl),
						(y = y.br),
						(T.texCoords.u = p),
						(T.texCoords.v = m),
						(S.texCoords.u = f),
						(S.texCoords.v = m),
						(C.texCoords.u = p),
						(C.texCoords.v = g),
						(y.texCoords.u = f),
						(y.texCoords.v = g),
						(C.vertices.x = d * h),
						(C.vertices.y = 0),
						(C.vertices.z = 0),
						(y.vertices.x = d * h + h),
						(y.vertices.y = 0),
						(y.vertices.z = 0),
						(T.vertices.x = d * h),
						(T.vertices.y = t._itemHeight),
						(T.vertices.z = 0),
						(S.vertices.x = d * h + h),
						(S.vertices.y = t._itemHeight),
						(S.vertices.z = 0));
				}
				this._updateColor(),
					this.updateContentSize(_, d + 1),
					0 < i &&
						((n.dirty = !0),
						(r = n.totalQuads) < i &&
							n.increaseTotalQuadsWith(i - r));
			}),
			(t.updateContentSize = function (t, e) {
				var i = this._node,
					n = i._contentSize;
				t !== e &&
					t * i._itemWidth === n.width &&
					i._itemHeight === n.height &&
					i.setContentSize(e * i._itemWidth, i._itemHeight);
			}),
			(t.setString = function (t) {
				t = t.length;
				t > this._textureAtlas.totalQuads &&
					this._textureAtlas.resizeCapacity(t);
			}),
			(t._addChild = function () {});
	})(),
	(function () {
		cc.LabelBMFont.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t);
		};
		var t = (cc.LabelBMFont.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.LabelBMFont.WebGLRenderCmd),
			(t.setTexture = function (t) {
				this._node.setOpacityModifyRGB(
					this._node._texture.hasPremultipliedAlpha()
				);
			}),
			(t._updateCharTexture = function (t, e, i) {
				t.setTextureRect(e, !1), (t.visible = !0);
			}),
			(t._changeTextureColor = function () {}),
			(t._updateCharColorAndOpacity = function () {});
	})(),
	(cc.MotionStreak = cc.Node.extend({
		texture: null,
		fastMode: !1,
		startingPositionInitialized: !1,
		_blendFunc: null,
		_stroke: 0,
		_fadeDelta: 0,
		_minSeg: 0,
		_maxPoints: 0,
		_nuPoints: 0,
		_previousNuPoints: 0,
		_pointVertexes: null,
		_pointState: null,
		_vertices: null,
		_colorPointer: null,
		_texCoords: null,
		_verticesBuffer: null,
		_colorPointerBuffer: null,
		_texCoordsBuffer: null,
		_className: 'MotionStreak',
		ctor: function (t, e, i, n, r) {
			cc.Node.prototype.ctor.call(this),
				(this._positionR = cc.p(0, 0)),
				(this._blendFunc = new cc.BlendFunc(
					cc.SRC_ALPHA,
					cc.ONE_MINUS_SRC_ALPHA
				)),
				(this.fastMode = !1),
				(this.startingPositionInitialized = !1),
				(this.texture = null),
				(this._stroke = 0),
				(this._fadeDelta = 0),
				(this._minSeg = 0),
				(this._maxPoints = 0),
				(this._nuPoints = 0),
				(this._previousNuPoints = 0),
				(this._pointVertexes = null),
				(this._pointState = null),
				(this._vertices = null),
				(this._colorPointer = null),
				(this._texCoords = null),
				(this._verticesBuffer = null),
				(this._colorPointerBuffer = null),
				(this._texCoordsBuffer = null),
				void 0 !== r && this.initWithFade(t, e, i, n, r);
		},
		getTexture: function () {
			return this.texture;
		},
		setTexture: function (t) {
			this.texture !== t && (this.texture = t);
		},
		getBlendFunc: function () {
			return this._blendFunc;
		},
		setBlendFunc: function (t, e) {
			void 0 === e
				? (this._blendFunc = t)
				: ((this._blendFunc.src = t), (this._blendFunc.dst = e));
		},
		getOpacity: function () {
			return (
				cc.log('cc.MotionStreak.getOpacity has not been supported.'), 0
			);
		},
		setOpacity: function (t) {
			cc.log('cc.MotionStreak.setOpacity has not been supported.');
		},
		setOpacityModifyRGB: function (t) {},
		isOpacityModifyRGB: function () {
			return !1;
		},
		isFastMode: function () {
			return this.fastMode;
		},
		setFastMode: function (t) {
			this.fastMode = t;
		},
		isStartingPositionInitialized: function () {
			return this.startingPositionInitialized;
		},
		setStartingPositionInitialized: function (t) {
			this.startingPositionInitialized = t;
		},
		getStroke: function () {
			return this._stroke;
		},
		setStroke: function (t) {
			this._stroke = t;
		},
		initWithFade: function (t, e, i, n, r) {
			if (!r)
				throw new Error(
					'cc.MotionStreak.initWithFade(): Invalid filename or texture'
				);
			cc.isString(r) && (r = cc.textureCache.addImage(r)),
				cc.Node.prototype.setPosition.call(this, cc.p(0, 0)),
				(this.anchorX = 0),
				(this.anchorY = 0),
				(this.ignoreAnchor = !0),
				(this.startingPositionInitialized = !1),
				(this.fastMode = !0),
				(this._minSeg = -1 === e ? i / 5 : e),
				(this._minSeg *= this._minSeg),
				(this._stroke = i),
				(this._fadeDelta = 1 / t);
			t = 2 + (0 | (60 * t));
			return (
				(this._maxPoints = t),
				(this._nuPoints = 0),
				(this._pointState = new Float32Array(t)),
				(this._pointVertexes = new Float32Array(2 * t)),
				(this._vertices = new Float32Array(4 * t)),
				(this._texCoords = new Float32Array(4 * t)),
				(this._colorPointer = new Uint8Array(8 * t)),
				(this._verticesBuffer = gl.createBuffer()),
				(this._texCoordsBuffer = gl.createBuffer()),
				(this._colorPointerBuffer = gl.createBuffer()),
				(this._blendFunc.src = gl.SRC_ALPHA),
				(this._blendFunc.dst = gl.ONE_MINUS_SRC_ALPHA),
				(this.texture = r),
				(this.color = n),
				this.scheduleUpdate(),
				gl.bindBuffer(gl.ARRAY_BUFFER, this._verticesBuffer),
				gl.bufferData(gl.ARRAY_BUFFER, this._vertices, gl.DYNAMIC_DRAW),
				gl.bindBuffer(gl.ARRAY_BUFFER, this._texCoordsBuffer),
				gl.bufferData(
					gl.ARRAY_BUFFER,
					this._texCoords,
					gl.DYNAMIC_DRAW
				),
				gl.bindBuffer(gl.ARRAY_BUFFER, this._colorPointerBuffer),
				gl.bufferData(
					gl.ARRAY_BUFFER,
					this._colorPointer,
					gl.DYNAMIC_DRAW
				),
				!0
			);
		},
		tintWithColor: function (t) {
			this.color = t;
			for (
				var e = this._colorPointer, i = 0, n = 2 * this._nuPoints;
				i < n;
				i++
			)
				(e[4 * i] = t.r), (e[4 * i + 1] = t.g), (e[4 * i + 2] = t.b);
		},
		reset: function () {
			this._nuPoints = 0;
		},
		setPosition: function (t, e) {
			(this.startingPositionInitialized = !0),
				void 0 === e
					? ((this._positionR.x = t.x), (this._positionR.y = t.y))
					: ((this._positionR.x = t), (this._positionR.y = e));
		},
		getPositionX: function () {
			return this._positionR.x;
		},
		setPositionX: function (t) {
			(this._positionR.x = t),
				this.startingPositionInitialized ||
					(this.startingPositionInitialized = !0);
		},
		getPositionY: function () {
			return this._positionR.y;
		},
		setPositionY: function (t) {
			(this._positionR.y = t),
				this.startingPositionInitialized ||
					(this.startingPositionInitialized = !0);
		},
		update: function (t) {
			if (this.startingPositionInitialized) {
				var e, i;
				this._renderCmd._updateDisplayColor(), (t *= this._fadeDelta);
				var n,
					r = 0,
					o = this._nuPoints,
					s = this._pointState,
					c = this._pointVertexes,
					a = this._vertices,
					l = this._colorPointer;
				for (f = 0; f < o; f++)
					(s[f] -= t),
						s[f] <= 0
							? r++
							: ((n = f - r),
							  0 < r
									? ((s[n] = s[f]),
									  (c[2 * n] = c[2 * f]),
									  (c[2 * n + 1] = c[2 * f + 1]),
									  (i = 2 * f),
									  (a[2 * (e = 2 * n)] = a[2 * i]),
									  (a[2 * e + 1] = a[2 * i + 1]),
									  (a[2 * (e + 1)] = a[2 * (1 + i)]),
									  (a[2 * (e + 1) + 1] = a[2 * (1 + i) + 1]),
									  (i *= 4),
									  (l[(e *= 4) + 0] = l[0 + i]),
									  (l[e + 1] = l[1 + i]),
									  (l[e + 2] = l[2 + i]),
									  (l[e + 4] = l[4 + i]),
									  (l[e + 5] = l[5 + i]),
									  (l[e + 6] = l[6 + i]))
									: (e = 8 * n),
							  (n = 255 * s[n]),
							  (l[e + 3] = n),
							  (l[e + 7] = n));
				var h,
					u,
					_ = !0;
				if (
					((o -= r) >= this._maxPoints
						? (_ = !1)
						: 0 < o &&
						  ((h =
								cc.pDistanceSQ(
									cc.p(c[2 * (o - 1)], c[2 * (o - 1) + 1]),
									this._positionR
								) < this._minSeg),
						  (u =
								1 !== o &&
								cc.pDistanceSQ(
									cc.p(c[2 * (o - 2)], c[2 * (o - 2) + 1]),
									this._positionR
								) <
									2 * this._minSeg),
						  (h || u) && (_ = !1)),
					_ &&
						((c[2 * o] = this._positionR.x),
						(c[2 * o + 1] = this._positionR.y),
						(s[o] = 1),
						(u = 8 * o),
						(_ = this.getDisplayedColor()),
						(l[u] = _.r),
						(l[1 + u] = _.g),
						(l[2 + u] = _.b),
						(l[4 + u] = _.r),
						(l[5 + u] = _.g),
						(l[6 + u] = _.b),
						(l[3 + u] = 255),
						(l[7 + u] = 255),
						0 < o &&
							this.fastMode &&
							(1 < o
								? cc.vertexLineToPolygon(
										c,
										this._stroke,
										this._vertices,
										o,
										1
								  )
								: cc.vertexLineToPolygon(
										c,
										this._stroke,
										this._vertices,
										0,
										2
								  )),
						o++),
					this.fastMode ||
						cc.vertexLineToPolygon(
							c,
							this._stroke,
							this._vertices,
							0,
							o
						),
					o && this._previousNuPoints !== o)
				) {
					for (var d = 1 / o, p = this._texCoords, f = 0; f < o; f++)
						(p[4 * f] = 0),
							(p[4 * f + 1] = d * f),
							(p[2 * (2 * f + 1)] = 1),
							(p[2 * (2 * f + 1) + 1] = d * f);
					this._previousNuPoints = o;
				}
				this._nuPoints = o;
			}
		},
		_createRenderCmd: function () {
			return cc._renderType === cc.game.RENDER_TYPE_WEBGL
				? new cc.MotionStreak.WebGLRenderCmd(this)
				: null;
		},
	})),
	(cc.MotionStreak.create = function (t, e, i, n, r) {
		return new cc.MotionStreak(t, e, i, n, r);
	}),
	(cc.MotionStreak.WebGLRenderCmd = function (t) {
		cc.Node.WebGLRenderCmd.call(this, t),
			(this._needDraw = !0),
			(this._matrix = new cc.math.Matrix4()),
			this._matrix.identity(),
			(this._shaderProgram = cc.shaderCache.programForKey(
				cc.SHADER_POSITION_TEXTURECOLOR
			));
	}),
	(cc.MotionStreak.WebGLRenderCmd.prototype = Object.create(
		cc.Node.WebGLRenderCmd.prototype
	)),
	(cc.MotionStreak.WebGLRenderCmd.prototype.constructor =
		cc.Sprite.WebGLRenderCmd),
	(cc.MotionStreak.WebGLRenderCmd.prototype.rendering = function (t) {
		var e,
			i = this._node;
		i._nuPoints <= 1 ||
			(i.texture &&
				i.texture.isLoaded() &&
				((t = t || cc._renderContext),
				(e = this._worldTransform),
				(this._matrix.mat[0] = e.a),
				(this._matrix.mat[4] = e.c),
				(this._matrix.mat[12] = e.tx),
				(this._matrix.mat[1] = e.b),
				(this._matrix.mat[5] = e.d),
				(this._matrix.mat[13] = e.ty),
				this._shaderProgram.use(),
				this._shaderProgram._setUniformForMVPMatrixWithMat4(
					this._matrix
				),
				cc.glBlendFunc(i._blendFunc.src, i._blendFunc.dst),
				cc.glBindTexture2D(i.texture),
				t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
				t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
				t.bindBuffer(t.ARRAY_BUFFER, i._verticesBuffer),
				t.bufferData(t.ARRAY_BUFFER, i._vertices, t.DYNAMIC_DRAW),
				t.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					2,
					t.FLOAT,
					!1,
					0,
					0
				),
				t.bindBuffer(t.ARRAY_BUFFER, i._texCoordsBuffer),
				t.bufferData(t.ARRAY_BUFFER, i._texCoords, t.DYNAMIC_DRAW),
				t.vertexAttribPointer(
					cc.VERTEX_ATTRIB_TEX_COORDS,
					2,
					t.FLOAT,
					!1,
					0,
					0
				),
				t.bindBuffer(t.ARRAY_BUFFER, i._colorPointerBuffer),
				t.bufferData(t.ARRAY_BUFFER, i._colorPointer, t.DYNAMIC_DRAW),
				t.vertexAttribPointer(
					cc.VERTEX_ATTRIB_COLOR,
					4,
					t.UNSIGNED_BYTE,
					!0,
					0,
					0
				),
				t.drawArrays(t.TRIANGLE_STRIP, 0, 2 * i._nuPoints),
				cc.g_NumberOfDraws++));
	}),
	(cc.NodeGrid = cc.Node.extend({
		grid: null,
		_target: null,
		_gridRect: null,
		ctor: function (t) {
			cc.Node.prototype.ctor.call(this),
				void 0 === t && (t = cc.rect()),
				(this._gridRect = t);
		},
		getGrid: function () {
			return this.grid;
		},
		setGrid: function (t) {
			this.grid = t;
		},
		setGridRect: function (t) {
			this._gridRect = t;
		},
		getGridRect: function () {
			return this._gridRect;
		},
		setTarget: function (t) {
			this._target = t;
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? cc.NodeGrid.WebGLRenderCmd
					: cc.Node.CanvasRenderCmd
			)(this);
		},
	}));
var _p = cc.NodeGrid.prototype;
_p.grid,
	_p.target,
	cc.defineGetterSetter(_p, 'target', null, _p.setTarget),
	(cc.NodeGrid.create = function () {
		return new cc.NodeGrid();
	}),
	(function () {
		cc.NodeGrid.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !1),
				(this._gridBeginCommand = new cc.CustomRenderCmd(
					this,
					this.onGridBeginDraw
				)),
				(this._gridEndCommand = new cc.CustomRenderCmd(
					this,
					this.onGridEndDraw
				));
		};
		var t = (cc.NodeGrid.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.NodeGrid.WebGLRenderCmd),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible) {
					(t = t || this.getParentRenderCmd()),
						e._parent &&
							e._parent._renderCmd &&
							(this._curLevel =
								e._parent._renderCmd._curLevel + 1);
					var i = cc.current_stack;
					i.stack.push(i.top),
						this._syncStatus(t),
						(i.top = this._stackMatrix),
						cc.renderer.pushRenderCommand(this._gridBeginCommand),
						e._target && e._target.visit();
					var n = e._children;
					if (n && 0 < n.length) {
						var r = n.length;
						e.sortAllChildren();
						for (var o = 0; o < r; o++) {
							var s = n[o];
							s && s.visit();
						}
					}
					cc.renderer.pushRenderCommand(this._gridEndCommand),
						(this._dirtyFlag = 0),
						(i.top = i.stack.pop());
				}
			}),
			(t.onGridBeginDraw = function () {
				var t = this._node.grid;
				t && t._active && t.beforeDraw();
			}),
			(t.onGridEndDraw = function () {
				var t = this._node.grid;
				t && t._active && t.afterDraw(this._node);
			});
	})(),
	(cc.v2fzero = function () {
		return { x: 0, y: 0 };
	}),
	(cc.v2f = function (t, e) {
		return { x: t, y: e };
	}),
	(cc.v2fadd = function (t, e) {
		return cc.v2f(t.x + e.x, t.y + e.y);
	}),
	(cc.v2fsub = function (t, e) {
		return cc.v2f(t.x - e.x, t.y - e.y);
	}),
	(cc.v2fmult = function (t, e) {
		return cc.v2f(t.x * e, t.y * e);
	}),
	(cc.v2fperp = function (t) {
		return cc.v2f(-t.y, t.x);
	}),
	(cc.v2fneg = function (t) {
		return cc.v2f(-t.x, -t.y);
	}),
	(cc.v2fdot = function (t, e) {
		return t.x * e.x + t.y * e.y;
	}),
	(cc.v2fforangle = function (t) {
		return cc.v2f(Math.cos(t), Math.sin(t));
	}),
	(cc.v2fnormalize = function (t) {
		t = cc.pNormalize(cc.p(t.x, t.y));
		return cc.v2f(t.x, t.y);
	}),
	(cc.__v2f = function (t) {
		return cc.v2f(t.x, t.y);
	}),
	(cc.__t = function (t) {
		return { u: t.x, v: t.y };
	}),
	(cc.DrawNode = cc.Node.extend({
		_buffer: null,
		_blendFunc: null,
		_lineWidth: 1,
		_drawColor: null,
		getBlendFunc: function () {
			return this._blendFunc;
		},
		setBlendFunc: function (t, e) {
			void 0 === e
				? ((this._blendFunc.src = t.src), (this._blendFunc.dst = t.dst))
				: ((this._blendFunc.src = t), (this._blendFunc.dst = e));
		},
		setLineWidth: function (t) {
			this._lineWidth = t;
		},
		getLineWidth: function () {
			return this._lineWidth;
		},
		setDrawColor: function (t) {
			var e = this._drawColor;
			(e.r = t.r),
				(e.g = t.g),
				(e.b = t.b),
				(e.a = null == t.a ? 255 : t.a);
		},
		getDrawColor: function () {
			return cc.color(
				this._drawColor.r,
				this._drawColor.g,
				this._drawColor.b,
				this._drawColor.a
			);
		},
	})),
	(cc.DrawNode.create = function () {
		return new cc.DrawNode();
	}),
	(cc.DrawNode.TYPE_DOT = 0),
	(cc.DrawNode.TYPE_SEGMENT = 1),
	(cc.DrawNode.TYPE_POLY = 2),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		cc._renderType === cc.game.RENDER_TYPE_CANVAS
			? ((cc._DrawNodeElement = function (t, e, i, n, r, o, s, c, a) {
					(this.type = t),
						(this.verts = e || null),
						(this.fillColor = i || null),
						(this.lineWidth = n || 0),
						(this.lineColor = r || null),
						(this.lineCap = o || 'butt'),
						(this.isClosePolygon = s || !1),
						(this.isFill = c || !1),
						(this.isStroke = a || !1);
			  }),
			  cc.extend(cc.DrawNode.prototype, {
					_className: 'DrawNodeCanvas',
					ctor: function () {
						cc.Node.prototype.ctor.call(this);
						var t = this._renderCmd;
						(t._buffer = this._buffer = []),
							(t._drawColor = this._drawColor =
								cc.color(255, 255, 255, 255)),
							(t._blendFunc = this._blendFunc =
								new cc.BlendFunc(
									cc.SRC_ALPHA,
									cc.ONE_MINUS_SRC_ALPHA
								)),
							this.init(),
							(this._localBB = new cc.Rect());
					},
					setLocalBB: function (t, e, i, n) {
						var r = this._localBB;
						void 0 === e
							? ((r.x = t.x),
							  (r.y = t.y),
							  (r.width = t.width),
							  (r.height = t.height))
							: ((r.x = t),
							  (r.y = e),
							  (r.width = i),
							  (r.height = n));
					},
					drawRect: function (t, e, i, n, r) {
						(n = null == n ? this._lineWidth : n),
							null == (r = r || this.getDrawColor()).a &&
								(r.a = 255);
						(t = [t, cc.p(e.x, t.y), e, cc.p(t.x, e.y)]),
							(e = new cc._DrawNodeElement(
								cc.DrawNode.TYPE_POLY
							));
						(e.verts = t),
							(e.lineWidth = n),
							(e.lineColor = r),
							(e.isClosePolygon = !0),
							(e.isStroke = !0),
							(e.lineCap = 'butt'),
							(e.fillColor = i) &&
								(null == i.a && (i.a = 255), (e.isFill = !0)),
							this._buffer.push(e);
					},
					drawCircle: function (t, e, i, n, r, o, s) {
						(o = o || this._lineWidth),
							null == (s = s || this.getDrawColor()).a &&
								(s.a = 255);
						for (
							var c = (2 * Math.PI) / n, a = [], l = 0;
							l <= n;
							l++
						) {
							var h = l * c,
								u = e * Math.cos(h + i) + t.x,
								h = e * Math.sin(h + i) + t.y;
							a.push(cc.p(u, h));
						}
						r && a.push(cc.p(t.x, t.y));
						r = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
						(r.verts = a),
							(r.lineWidth = o),
							(r.lineColor = s),
							(r.isClosePolygon = !0),
							(r.isStroke = !0),
							this._buffer.push(r);
					},
					drawQuadBezier: function (t, e, i, n, r, o) {
						(r = r || this._lineWidth),
							null == (o = o || this.getDrawColor()).a &&
								(o.a = 255);
						for (var s = [], c = 0, a = 0; a < n; a++) {
							var l =
									Math.pow(1 - c, 2) * t.x +
									2 * (1 - c) * c * e.x +
									c * c * i.x,
								h =
									Math.pow(1 - c, 2) * t.y +
									2 * (1 - c) * c * e.y +
									c * c * i.y;
							s.push(cc.p(l, h)), (c += 1 / n);
						}
						s.push(cc.p(i.x, i.y));
						var u = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
						(u.verts = s),
							(u.lineWidth = r),
							(u.lineColor = o),
							(u.isStroke = !0),
							(u.lineCap = 'round'),
							this._buffer.push(u);
					},
					drawCubicBezier: function (t, e, i, n, r, o, s) {
						(o = o || this._lineWidth),
							null == (s = s || this.getDrawColor()).a &&
								(s.a = 255);
						for (var c = [], a = 0, l = 0; l < r; l++) {
							var h =
									Math.pow(1 - a, 3) * t.x +
									3 * Math.pow(1 - a, 2) * a * e.x +
									3 * (1 - a) * a * a * i.x +
									a * a * a * n.x,
								u =
									Math.pow(1 - a, 3) * t.y +
									3 * Math.pow(1 - a, 2) * a * e.y +
									3 * (1 - a) * a * a * i.y +
									a * a * a * n.y;
							c.push(cc.p(h, u)), (a += 1 / r);
						}
						c.push(cc.p(n.x, n.y));
						var _ = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
						(_.verts = c),
							(_.lineWidth = o),
							(_.lineColor = s),
							(_.isStroke = !0),
							(_.lineCap = 'round'),
							this._buffer.push(_);
					},
					drawCatmullRom: function (t, e, i, n) {
						this.drawCardinalSpline(t, 0.5, e, i, n);
					},
					drawCardinalSpline: function (t, e, i, n, r) {
						(n = n || this._lineWidth),
							null == (r = r || this.getDrawColor()).a &&
								(r.a = 255);
						for (
							var o, s = [], c = 1 / t.length, a = 0;
							a < i + 1;
							a++
						) {
							var l = a / i,
								l =
									1 == l
										? ((o = t.length - 1), 1)
										: (l - c * (o = 0 | (l / c))) / c,
								l = cc.cardinalSplineAt(
									cc.getControlPointAt(t, o - 1),
									cc.getControlPointAt(t, +o),
									cc.getControlPointAt(t, o + 1),
									cc.getControlPointAt(t, o + 2),
									e,
									l
								);
							s.push(l);
						}
						var h = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
						(h.verts = s),
							(h.lineWidth = n),
							(h.lineColor = r),
							(h.isStroke = !0),
							(h.lineCap = 'round'),
							this._buffer.push(h);
					},
					drawDot: function (t, e, i) {
						null == (i = i || this.getDrawColor()).a && (i.a = 255);
						var n = new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);
						(n.verts = [t]),
							(n.lineWidth = e),
							(n.fillColor = i),
							this._buffer.push(n);
					},
					drawDots: function (t, e, i) {
						if (t && 0 != t.length) {
							null == (i = i || this.getDrawColor()).a &&
								(i.a = 255);
							for (var n = 0, r = t.length; n < r; n++)
								this.drawDot(t[n], e, i);
						}
					},
					drawSegment: function (t, e, i, n) {
						(i = i || this._lineWidth),
							null == (n = n || this.getDrawColor()).a &&
								(n.a = 255);
						var r = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
						(r.verts = [t, e]),
							(r.lineWidth = 2 * i),
							(r.lineColor = n),
							(r.isStroke = !0),
							(r.lineCap = 'round'),
							this._buffer.push(r);
					},
					drawPoly_: function (t, e, i, n) {
						(i = null == i ? this._lineWidth : i),
							null == (n = n || this.getDrawColor()).a &&
								(n.a = 255);
						var r = new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);
						(r.verts = t),
							(r.fillColor = e),
							(r.lineWidth = i),
							(r.lineColor = n),
							(r.isClosePolygon = !0),
							(r.isStroke = !0),
							(r.lineCap = 'round'),
							e && (r.isFill = !0),
							this._buffer.push(r);
					},
					drawPoly: function (t, e, i, n) {
						for (var r = [], o = 0; o < t.length; o++)
							r.push(cc.p(t[o].x, t[o].y));
						return this.drawPoly_(r, e, i, n);
					},
					clear: function () {
						this._buffer.length = 0;
					},
					_createRenderCmd: function () {
						return new cc.DrawNode.CanvasRenderCmd(this);
					},
			  }))
			: cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			  cc.extend(cc.DrawNode.prototype, {
					_bufferCapacity: 0,
					_trianglesArrayBuffer: null,
					_trianglesWebBuffer: null,
					_trianglesReader: null,
					_dirty: !1,
					_className: 'DrawNodeWebGL',
					ctor: function () {
						cc.Node.prototype.ctor.call(this),
							(this._buffer = []),
							(this._blendFunc = new cc.BlendFunc(
								cc.SRC_ALPHA,
								cc.ONE_MINUS_SRC_ALPHA
							)),
							(this._drawColor = cc.color(255, 255, 255, 255)),
							this.init();
					},
					init: function () {
						return (
							!!cc.Node.prototype.init.call(this) &&
							((this.shaderProgram = cc.shaderCache.programForKey(
								cc.SHADER_POSITION_LENGTHTEXTURECOLOR
							)),
							this._ensureCapacity(64),
							(this._trianglesWebBuffer =
								cc._renderContext.createBuffer()),
							(this._dirty = !0))
						);
					},
					drawRect: function (t, e, i, n, r) {
						(n = null == n ? this._lineWidth : n),
							null == (r = r || this.getDrawColor()).a &&
								(r.a = 255);
						e = [t, cc.p(e.x, t.y), e, cc.p(t.x, e.y)];
						null == i
							? this._drawSegments(e, n, r, !0)
							: this.drawPoly(e, i, n, r);
					},
					drawCircle: function (t, e, i, n, r, o, s) {
						(o = o || this._lineWidth),
							null == (s = s || this.getDrawColor()).a &&
								(s.a = 255);
						for (
							var c, a = (2 * Math.PI) / n, l = [], h = 0;
							h <= n;
							h++
						) {
							var u = h * a,
								_ = e * Math.cos(u + i) + t.x,
								u = e * Math.sin(u + i) + t.y;
							l.push(cc.p(_, u));
						}
						for (
							r && l.push(cc.p(t.x, t.y)),
								o *= 0.5,
								h = 0,
								c = l.length;
							h < c - 1;
							h++
						)
							this.drawSegment(l[h], l[h + 1], o, s);
					},
					drawQuadBezier: function (t, e, i, n, r, o) {
						(r = r || this._lineWidth),
							null == (o = o || this.getDrawColor()).a &&
								(o.a = 255);
						for (var s = [], c = 0, a = 0; a < n; a++) {
							var l =
									Math.pow(1 - c, 2) * t.x +
									2 * (1 - c) * c * e.x +
									c * c * i.x,
								h =
									Math.pow(1 - c, 2) * t.y +
									2 * (1 - c) * c * e.y +
									c * c * i.y;
							s.push(cc.p(l, h)), (c += 1 / n);
						}
						s.push(cc.p(i.x, i.y)), this._drawSegments(s, r, o, !1);
					},
					drawCubicBezier: function (t, e, i, n, r, o, s) {
						(o = o || this._lineWidth),
							null == (s = s || this.getDrawColor()).a &&
								(s.a = 255);
						for (var c = [], a = 0, l = 0; l < r; l++) {
							var h =
									Math.pow(1 - a, 3) * t.x +
									3 * Math.pow(1 - a, 2) * a * e.x +
									3 * (1 - a) * a * a * i.x +
									a * a * a * n.x,
								u =
									Math.pow(1 - a, 3) * t.y +
									3 * Math.pow(1 - a, 2) * a * e.y +
									3 * (1 - a) * a * a * i.y +
									a * a * a * n.y;
							c.push(cc.p(h, u)), (a += 1 / r);
						}
						c.push(cc.p(n.x, n.y)), this._drawSegments(c, o, s, !1);
					},
					drawCatmullRom: function (t, e, i, n) {
						this.drawCardinalSpline(t, 0.5, e, i, n);
					},
					drawCardinalSpline: function (t, e, i, n, r) {
						(n = n || this._lineWidth),
							null == (r = r || this.getDrawColor()).a &&
								(r.a = 255);
						for (
							var o, s = [], c = 1 / t.length, a = 0;
							a < i + 1;
							a++
						) {
							var l = a / i,
								l =
									1 == l
										? ((o = t.length - 1), 1)
										: (l - c * (o = 0 | (l / c))) / c,
								l = cc.cardinalSplineAt(
									cc.getControlPointAt(t, o - 1),
									cc.getControlPointAt(t, +o),
									cc.getControlPointAt(t, o + 1),
									cc.getControlPointAt(t, o + 2),
									e,
									l
								);
							s.push(l);
						}
						n *= 0.5;
						for (var h = 0, u = s.length; h < u - 1; h++)
							this.drawSegment(s[h], s[h + 1], n, r);
					},
					_render: function () {
						var t = cc._renderContext;
						t.bindBuffer(t.ARRAY_BUFFER, this._trianglesWebBuffer),
							this._dirty &&
								(t.bufferData(
									t.ARRAY_BUFFER,
									this._trianglesArrayBuffer,
									t.STREAM_DRAW
								),
								(this._dirty = !1));
						var e = cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;
						t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
							t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
							t.enableVertexAttribArray(
								cc.VERTEX_ATTRIB_TEX_COORDS
							),
							t.vertexAttribPointer(
								cc.VERTEX_ATTRIB_POSITION,
								2,
								t.FLOAT,
								!1,
								e,
								0
							),
							t.vertexAttribPointer(
								cc.VERTEX_ATTRIB_COLOR,
								4,
								t.UNSIGNED_BYTE,
								!0,
								e,
								8
							),
							t.vertexAttribPointer(
								cc.VERTEX_ATTRIB_TEX_COORDS,
								2,
								t.FLOAT,
								!1,
								e,
								12
							),
							t.drawArrays(
								t.TRIANGLES,
								0,
								3 * this._buffer.length
							),
							cc.incrementGLDraws(1);
					},
					_ensureCapacity: function (t) {
						var e = this,
							i = e._buffer;
						if (i.length + t > e._bufferCapacity) {
							var n = cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;
							if (
								((e._bufferCapacity += Math.max(
									e._bufferCapacity,
									t
								)),
								null == i || 0 === i.length)
							)
								(e._buffer = []),
									(e._trianglesArrayBuffer = new ArrayBuffer(
										n * e._bufferCapacity
									)),
									(e._trianglesReader = new Uint8Array(
										e._trianglesArrayBuffer
									));
							else {
								for (
									var r = [],
										o = new ArrayBuffer(
											n * e._bufferCapacity
										),
										s = 0;
									s < i.length;
									s++
								)
									r[s] = new cc.V2F_C4B_T2F_Triangle(
										i[s].a,
										i[s].b,
										i[s].c,
										o,
										s * n
									);
								(e._trianglesReader = new Uint8Array(o)),
									(e._trianglesArrayBuffer = o),
									(e._buffer = r);
							}
						}
					},
					drawDot: function (t, e, i) {
						null == (i = i || this.getDrawColor()).a && (i.a = 255);
						var n = {
								r: 0 | i.r,
								g: 0 | i.g,
								b: 0 | i.b,
								a: 0 | i.a,
							},
							r = {
								vertices: { x: t.x - e, y: t.y - e },
								colors: n,
								texCoords: { u: -1, v: -1 },
							},
							o = {
								vertices: { x: t.x - e, y: t.y + e },
								colors: n,
								texCoords: { u: -1, v: 1 },
							},
							i = {
								vertices: { x: t.x + e, y: t.y + e },
								colors: n,
								texCoords: { u: 1, v: 1 },
							},
							n = {
								vertices: { x: t.x + e, y: t.y - e },
								colors: n,
								texCoords: { u: 1, v: -1 },
							};
						this._ensureCapacity(6),
							this._buffer.push(
								new cc.V2F_C4B_T2F_Triangle(
									r,
									o,
									i,
									this._trianglesArrayBuffer,
									this._buffer.length *
										cc.V2F_C4B_T2F_Triangle
											.BYTES_PER_ELEMENT
								)
							),
							this._buffer.push(
								new cc.V2F_C4B_T2F_Triangle(
									r,
									i,
									n,
									this._trianglesArrayBuffer,
									this._buffer.length *
										cc.V2F_C4B_T2F_Triangle
											.BYTES_PER_ELEMENT
								)
							),
							(this._dirty = !0);
					},
					drawDots: function (t, e, i) {
						if (t && 0 !== t.length) {
							null == (i = i || this.getDrawColor()).a &&
								(i.a = 255);
							for (var n = 0, r = t.length; n < r; n++)
								this.drawDot(t[n], e, i);
						}
					},
					drawSegment: function (t, e, i, n) {
						null == (n = n || this.getDrawColor()).a && (n.a = 255),
							(i = i || 0.5 * this._lineWidth);
						this._ensureCapacity(18);
						var r = {
								r: 0 | n.r,
								g: 0 | n.g,
								b: 0 | n.b,
								a: 0 | n.a,
							},
							o = cc.__v2f(t),
							s = cc.__v2f(e),
							c = cc.v2fnormalize(cc.v2fperp(cc.v2fsub(s, o))),
							a = cc.v2fperp(c),
							l = cc.v2fmult(c, i),
							h = cc.v2fmult(a, i),
							u = cc.v2fsub(s, cc.v2fadd(l, h)),
							_ = cc.v2fadd(s, cc.v2fsub(l, h)),
							d = cc.v2fsub(s, l),
							n = cc.v2fadd(s, l),
							t = cc.v2fsub(o, l),
							e = cc.v2fadd(o, l),
							i = cc.v2fsub(o, cc.v2fsub(l, h)),
							s = cc.v2fadd(o, cc.v2fadd(l, h)),
							o = cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,
							l = this._trianglesArrayBuffer,
							h = this._buffer;
						h.push(
							new cc.V2F_C4B_T2F_Triangle(
								{
									vertices: u,
									colors: r,
									texCoords: cc.__t(
										cc.v2fneg(cc.v2fadd(c, a))
									),
								},
								{
									vertices: _,
									colors: r,
									texCoords: cc.__t(cc.v2fsub(c, a)),
								},
								{
									vertices: d,
									colors: r,
									texCoords: cc.__t(cc.v2fneg(c)),
								},
								l,
								h.length * o
							)
						),
							h.push(
								new cc.V2F_C4B_T2F_Triangle(
									{
										vertices: n,
										colors: r,
										texCoords: cc.__t(c),
									},
									{
										vertices: _,
										colors: r,
										texCoords: cc.__t(cc.v2fsub(c, a)),
									},
									{
										vertices: d,
										colors: r,
										texCoords: cc.__t(cc.v2fneg(c)),
									},
									l,
									h.length * o
								)
							),
							h.push(
								new cc.V2F_C4B_T2F_Triangle(
									{
										vertices: n,
										colors: r,
										texCoords: cc.__t(c),
									},
									{
										vertices: t,
										colors: r,
										texCoords: cc.__t(cc.v2fneg(c)),
									},
									{
										vertices: d,
										colors: r,
										texCoords: cc.__t(cc.v2fneg(c)),
									},
									l,
									h.length * o
								)
							),
							h.push(
								new cc.V2F_C4B_T2F_Triangle(
									{
										vertices: n,
										colors: r,
										texCoords: cc.__t(c),
									},
									{
										vertices: t,
										colors: r,
										texCoords: cc.__t(cc.v2fneg(c)),
									},
									{
										vertices: e,
										colors: r,
										texCoords: cc.__t(c),
									},
									l,
									h.length * o
								)
							),
							h.push(
								new cc.V2F_C4B_T2F_Triangle(
									{
										vertices: i,
										colors: r,
										texCoords: cc.__t(cc.v2fsub(a, c)),
									},
									{
										vertices: t,
										colors: r,
										texCoords: cc.__t(cc.v2fneg(c)),
									},
									{
										vertices: e,
										colors: r,
										texCoords: cc.__t(c),
									},
									l,
									h.length * o
								)
							),
							h.push(
								new cc.V2F_C4B_T2F_Triangle(
									{
										vertices: i,
										colors: r,
										texCoords: cc.__t(cc.v2fsub(a, c)),
									},
									{
										vertices: s,
										colors: r,
										texCoords: cc.__t(cc.v2fadd(c, a)),
									},
									{
										vertices: e,
										colors: r,
										texCoords: cc.__t(c),
									},
									l,
									h.length * o
								)
							),
							(this._dirty = !0);
					},
					drawPoly: function (t, e, i, n) {
						if (null != e) {
							null == e.a && (e.a = 255),
								null == n.a && (n.a = 255),
								(i = null == i ? this._lineWidth : i),
								(i *= 0.5);
							for (
								var r,
									o = {
										r: 0 | e.r,
										g: 0 | e.g,
										b: 0 | e.b,
										a: 0 | e.a,
									},
									s = {
										r: 0 | n.r,
										g: 0 | n.g,
										b: 0 | n.b,
										a: 0 | n.a,
									},
									c = [],
									a = t.length,
									l = 0;
								l < a;
								l++
							) {
								(y = cc.__v2f(t[(l - 1 + a) % a])),
									(T = cc.__v2f(t[l])),
									(r = cc.__v2f(t[(l + 1) % a]));
								var h = cc.v2fnormalize(
										cc.v2fperp(cc.v2fsub(T, y))
									),
									u = cc.v2fnormalize(
										cc.v2fperp(cc.v2fsub(r, T))
									),
									h = cc.v2fmult(
										cc.v2fadd(h, u),
										1 / (cc.v2fdot(h, u) + 1)
									);
								c[l] = { offset: h, n: u };
							}
							var _ = 0 < i,
								e = 3 * (3 * a - 2);
							this._ensureCapacity(e);
							var d = cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,
								p = this._trianglesArrayBuffer,
								f = this._buffer,
								m = 0 == _ ? 0.5 : 0;
							for (l = 0; l < a - 2; l++)
								(y = cc.v2fsub(
									cc.__v2f(t[0]),
									cc.v2fmult(c[0].offset, m)
								)),
									(T = cc.v2fsub(
										cc.__v2f(t[l + 1]),
										cc.v2fmult(c[l + 1].offset, m)
									)),
									(r = cc.v2fsub(
										cc.__v2f(t[l + 2]),
										cc.v2fmult(c[l + 2].offset, m)
									)),
									f.push(
										new cc.V2F_C4B_T2F_Triangle(
											{
												vertices: y,
												colors: o,
												texCoords: cc.__t(cc.v2fzero()),
											},
											{
												vertices: T,
												colors: o,
												texCoords: cc.__t(cc.v2fzero()),
											},
											{
												vertices: r,
												colors: o,
												texCoords: cc.__t(cc.v2fzero()),
											},
											p,
											f.length * d
										)
									);
							for (l = 0; l < a; l++) {
								var g = (l + 1) % a,
									y = cc.__v2f(t[l]),
									T = cc.__v2f(t[g]),
									S = c[l].n,
									C = c[l].offset,
									x = c[g].offset,
									v = _
										? cc.v2fsub(y, cc.v2fmult(C, i))
										: cc.v2fsub(y, cc.v2fmult(C, 0.5)),
									g = _
										? cc.v2fsub(T, cc.v2fmult(x, i))
										: cc.v2fsub(T, cc.v2fmult(x, 0.5)),
									C = _
										? cc.v2fadd(y, cc.v2fmult(C, i))
										: cc.v2fadd(y, cc.v2fmult(C, 0.5)),
									x = _
										? cc.v2fadd(T, cc.v2fmult(x, i))
										: cc.v2fadd(T, cc.v2fmult(x, 0.5));
								_
									? (f.push(
											new cc.V2F_C4B_T2F_Triangle(
												{
													vertices: v,
													colors: s,
													texCoords: cc.__t(
														cc.v2fneg(S)
													),
												},
												{
													vertices: g,
													colors: s,
													texCoords: cc.__t(
														cc.v2fneg(S)
													),
												},
												{
													vertices: x,
													colors: s,
													texCoords: cc.__t(S),
												},
												p,
												f.length * d
											)
									  ),
									  f.push(
											new cc.V2F_C4B_T2F_Triangle(
												{
													vertices: v,
													colors: s,
													texCoords: cc.__t(
														cc.v2fneg(S)
													),
												},
												{
													vertices: C,
													colors: s,
													texCoords: cc.__t(S),
												},
												{
													vertices: x,
													colors: s,
													texCoords: cc.__t(S),
												},
												p,
												f.length * d
											)
									  ))
									: (f.push(
											new cc.V2F_C4B_T2F_Triangle(
												{
													vertices: v,
													colors: o,
													texCoords: cc.__t(
														cc.v2fzero()
													),
												},
												{
													vertices: g,
													colors: o,
													texCoords: cc.__t(
														cc.v2fzero()
													),
												},
												{
													vertices: x,
													colors: o,
													texCoords: cc.__t(S),
												},
												p,
												f.length * d
											)
									  ),
									  f.push(
											new cc.V2F_C4B_T2F_Triangle(
												{
													vertices: v,
													colors: o,
													texCoords: cc.__t(
														cc.v2fzero()
													),
												},
												{
													vertices: C,
													colors: o,
													texCoords: cc.__t(S),
												},
												{
													vertices: x,
													colors: o,
													texCoords: cc.__t(S),
												},
												p,
												f.length * d
											)
									  ));
							}
							(c = null), (this._dirty = !0);
						} else this._drawSegments(t, i, n, !0);
					},
					_drawSegments: function (t, e, i, n) {
						if (
							((e = null == e ? this._lineWidth : e),
							null == (i = i || this._drawColor).a && (i.a = 255),
							!((e *= 0.5) <= 0))
						) {
							for (
								var r = {
										r: 0 | i.r,
										g: 0 | i.g,
										b: 0 | i.b,
										a: 0 | i.a,
									},
									o = [],
									s = t.length,
									c = 0;
								c < s;
								c++
							) {
								(f = cc.__v2f(t[(c - 1 + s) % s])),
									(m = cc.__v2f(t[c])),
									(l = cc.__v2f(t[(c + 1) % s]));
								var a = cc.v2fnormalize(
										cc.v2fperp(cc.v2fsub(m, f))
									),
									l = cc.v2fnormalize(
										cc.v2fperp(cc.v2fsub(l, m))
									),
									a = cc.v2fmult(
										cc.v2fadd(a, l),
										1 / (cc.v2fdot(a, l) + 1)
									);
								o[c] = { offset: a, n: l };
							}
							i = 3 * (3 * s - 2);
							this._ensureCapacity(i);
							var h = cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,
								u = this._trianglesArrayBuffer,
								_ = this._buffer,
								d = n ? s : s - 1;
							for (c = 0; c < d; c++) {
								var p = (c + 1) % s,
									f = cc.__v2f(t[c]),
									m = cc.__v2f(t[p]),
									g = o[c].n,
									y = o[c].offset,
									T = o[p].offset,
									S = cc.v2fsub(f, cc.v2fmult(y, e)),
									p = cc.v2fsub(m, cc.v2fmult(T, e)),
									y = cc.v2fadd(f, cc.v2fmult(y, e)),
									T = cc.v2fadd(m, cc.v2fmult(T, e));
								_.push(
									new cc.V2F_C4B_T2F_Triangle(
										{
											vertices: S,
											colors: r,
											texCoords: cc.__t(cc.v2fneg(g)),
										},
										{
											vertices: p,
											colors: r,
											texCoords: cc.__t(cc.v2fneg(g)),
										},
										{
											vertices: T,
											colors: r,
											texCoords: cc.__t(g),
										},
										u,
										_.length * h
									)
								),
									_.push(
										new cc.V2F_C4B_T2F_Triangle(
											{
												vertices: S,
												colors: r,
												texCoords: cc.__t(cc.v2fneg(g)),
											},
											{
												vertices: y,
												colors: r,
												texCoords: cc.__t(g),
											},
											{
												vertices: T,
												colors: r,
												texCoords: cc.__t(g),
											},
											u,
											_.length * h
										)
									);
							}
							(o = null), (this._dirty = !0);
						}
					},
					clear: function () {
						(this._buffer.length = 0), (this._dirty = !0);
					},
					_createRenderCmd: function () {
						return new cc.DrawNode.WebGLRenderCmd(this);
					},
			  });
	}),
	(cc.DrawNode.CanvasRenderCmd = function (t) {
		cc.Node.CanvasRenderCmd.call(this, t),
			(this._needDraw = !0),
			(this._buffer = null),
			(this._drawColor = null),
			(this._blendFunc = null);
	}),
	(cc.DrawNode.CanvasRenderCmd.prototype = Object.create(
		cc.Node.CanvasRenderCmd.prototype
	)),
	(cc.DrawNode.CanvasRenderCmd.prototype.constructor =
		cc.DrawNode.CanvasRenderCmd),
	(cc.DrawNode.CanvasRenderCmd.prototype.getLocalBB = function () {
		return this._node._localBB;
	}),
	cc.extend(cc.DrawNode.CanvasRenderCmd.prototype, {
		rendering: function (t, e, i) {
			var n = t || cc._renderContext,
				t = (n.getContext(), this._node._displayedOpacity / 255);
			if (0 != t) {
				n.setTransform(this._worldTransform, e, i),
					n.setGlobalAlpha(t),
					this._blendFunc &&
						this._blendFunc.src === cc.SRC_ALPHA &&
						this._blendFunc.dst === cc.ONE &&
						n.setCompositeOperation('lighter');
				for (var r = this._buffer, o = 0, s = r.length; o < s; o++) {
					var c = r[o];
					switch (c.type) {
						case cc.DrawNode.TYPE_DOT:
							this._drawDot(n, c, e, i);
							break;
						case cc.DrawNode.TYPE_SEGMENT:
							this._drawSegment(n, c, e, i);
							break;
						case cc.DrawNode.TYPE_POLY:
							this._drawPoly(n, c, e, i);
					}
				}
			}
		},
		_drawDot: function (t, e) {
			var i = e.fillColor,
				n = e.verts[0],
				r = e.lineWidth,
				e = t.getContext();
			t.setFillStyle(
				'rgba(' +
					(0 | i.r) +
					',' +
					(0 | i.g) +
					',' +
					(0 | i.b) +
					',' +
					i.a / 255 +
					')'
			),
				e.beginPath(),
				e.arc(n.x, -n.y, r, 0, 2 * Math.PI, !1),
				e.closePath(),
				e.fill();
		},
		_drawSegment: function (t, e, i) {
			var n = e.lineColor,
				r = e.verts[0],
				o = e.verts[1],
				s = e.lineWidth,
				c = e.lineCap,
				e = t.getContext();
			t.setStrokeStyle(
				'rgba(' +
					(0 | n.r) +
					',' +
					(0 | n.g) +
					',' +
					(0 | n.b) +
					',' +
					n.a / 255 +
					')'
			),
				(e.lineWidth = s * i),
				e.beginPath(),
				(e.lineCap = c),
				e.moveTo(r.x, -r.y),
				e.lineTo(o.x, -o.y),
				e.stroke();
		},
		_drawPoly: function (t, e, i) {
			var n = e.verts,
				r = e.lineCap;
			if (null != n) {
				var o = e.fillColor,
					s = e.lineWidth,
					c = e.lineColor,
					a = e.isClosePolygon,
					l = e.isFill,
					h = e.isStroke,
					u = t.getContext(),
					e = n[0];
				(u.lineCap = r),
					o &&
						t.setFillStyle(
							'rgba(' +
								(0 | o.r) +
								',' +
								(0 | o.g) +
								',' +
								(0 | o.b) +
								',' +
								o.a / 255 +
								')'
						),
					s && (u.lineWidth = s * i),
					c &&
						t.setStrokeStyle(
							'rgba(' +
								(0 | c.r) +
								',' +
								(0 | c.g) +
								',' +
								(0 | c.b) +
								',' +
								c.a / 255 +
								')'
						),
					u.beginPath(),
					u.moveTo(e.x, -e.y);
				for (var _ = 1, d = n.length; _ < d; _++)
					u.lineTo(n[_].x, -n[_].y);
				a && u.closePath(), l && u.fill(), h && u.stroke();
			}
		},
	}),
	(cc.DrawNode.WebGLRenderCmd = function (t) {
		cc.Node.WebGLRenderCmd.call(this, t),
			(this._needDraw = !0),
			(this._matrix = new cc.math.Matrix4()),
			this._matrix.identity();
	}),
	(cc.DrawNode.WebGLRenderCmd.prototype = Object.create(
		cc.Node.WebGLRenderCmd.prototype
	)),
	(cc.DrawNode.WebGLRenderCmd.prototype.constructor =
		cc.DrawNode.WebGLRenderCmd),
	(cc.DrawNode.WebGLRenderCmd.prototype.rendering = function (t) {
		var e,
			i = this._node;
		0 < i._buffer.length &&
			((e = this._worldTransform),
			(this._matrix.mat[0] = e.a),
			(this._matrix.mat[4] = e.c),
			(this._matrix.mat[12] = e.tx),
			(this._matrix.mat[1] = e.b),
			(this._matrix.mat[5] = e.d),
			(this._matrix.mat[13] = e.ty),
			cc.glBlendFunc(i._blendFunc.src, i._blendFunc.dst),
			this._shaderProgram.use(),
			this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),
			i._render());
	}),
	(cc.stencilBits = -1),
	(cc.ClippingNode = cc.Node.extend({
		alphaThreshold: 0,
		inverted: !1,
		_stencil: null,
		_className: 'ClippingNode',
		ctor: function (t) {
			(t = t || null),
				cc.Node.prototype.ctor.call(this),
				(this._stencil = t),
				(this.alphaThreshold = 1),
				(this.inverted = !1),
				this._renderCmd.initStencilBits();
		},
		init: function (t) {
			return (
				(this._stencil = t),
				(this.alphaThreshold = 1),
				(this.inverted = !1),
				this._renderCmd.initStencilBits(),
				!0
			);
		},
		onEnter: function () {
			cc.Node.prototype.onEnter.call(this), this._stencil.onEnter();
		},
		onEnterTransitionDidFinish: function () {
			cc.Node.prototype.onEnterTransitionDidFinish.call(this),
				this._stencil.onEnterTransitionDidFinish();
		},
		onExitTransitionDidStart: function () {
			this._stencil.onExitTransitionDidStart(),
				cc.Node.prototype.onExitTransitionDidStart.call(this);
		},
		onExit: function () {
			this._stencil.onExit(), cc.Node.prototype.onExit.call(this);
		},
		getAlphaThreshold: function () {
			return this.alphaThreshold;
		},
		setAlphaThreshold: function (t) {
			this.alphaThreshold = t;
		},
		isInverted: function () {
			return this.inverted;
		},
		setInverted: function (t) {
			this.inverted = t;
		},
		getStencil: function () {
			return this._stencil;
		},
		setStencil: function (t) {
			this._stencil !== t && this._renderCmd.setStencil(t);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.ClippingNode.CanvasRenderCmd
					: cc.ClippingNode.WebGLRenderCmd
			)(this);
		},
	}));
var _p = cc.ClippingNode.prototype;
cc.defineGetterSetter(_p, 'stencil', _p.getStencil, _p.setStencil),
	_p.stencil,
	(cc.ClippingNode.create = function (t) {
		return new cc.ClippingNode(t);
	}),
	(function () {
		cc.ClippingNode.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._needDraw = !1),
				(this._godhelpme = !1),
				(this._clipElemType = !1),
				(this._rendererSaveCmd = new cc.CustomRenderCmd(
					this,
					this._saveCmdCallback
				)),
				(this._rendererClipCmd = new cc.CustomRenderCmd(
					this,
					this._clipCmdCallback
				)),
				(this._rendererRestoreCmd = new cc.CustomRenderCmd(
					this,
					this._restoreCmdCallback
				));
		};
		var t = (cc.ClippingNode.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.ClippingNode.CanvasRenderCmd),
			(t.initStencilBits = function () {}),
			(t.setStencil = function (t) {
				if (null != t)
					if ((this._node._stencil = t) instanceof cc.DrawNode) {
						if (t._buffer)
							for (var e = 0; e < t._buffer.length; e++)
								(t._buffer[e].isFill = !1),
									(t._buffer[e].isStroke = !1);
						(t._renderCmd.rendering = function (t, e, i) {}),
							(t._renderCmd._canUseDirtyRegion = !0),
							(this._rendererSaveCmd._canUseDirtyRegion = !0),
							(this._rendererClipCmd._canUseDirtyRegion = !0),
							(this._rendererRestoreCmd._canUseDirtyRegion = !0);
					} else t._parent = this._node;
			}),
			(t._saveCmdCallback = function (t, e, i) {
				var n,
					r = t || cc._renderContext,
					o = r.getContext();
				this._clipElemType
					? ((n = cc.ClippingNode.CanvasRenderCmd._getSharedCache()),
					  (t = o.canvas),
					  (n.width = t.width),
					  (n.height = t.height),
					  n.getContext('2d').drawImage(t, 0, 0))
					: (r.save(),
					  r.setTransform(this._worldTransform, e, i),
					  this._node.inverted &&
							(o.beginPath(),
							o.rect(0, 0, o.canvas.width, -o.canvas.height),
							o.clip()));
			}),
			(t._setStencilCompositionOperation = function (t) {
				if (t) {
					var e = this._node;
					if (
						(t._renderCmd &&
							t._renderCmd._blendFuncStr &&
							(t._renderCmd._blendFuncStr = e.inverted
								? 'destination-out'
								: 'destination-in'),
						t._children)
					)
						for (
							var i = t._children, n = 0, r = i.length;
							n < r;
							n++
						)
							this._setStencilCompositionOperation(i[n]);
				}
			}),
			(t._clipCmdCallback = function (t) {
				var e = this._node,
					i = (t || cc._renderContext).getContext();
				if (this._clipElemType)
					this._setStencilCompositionOperation(e._stencil);
				else {
					var n = this._node._stencil;
					if (n instanceof cc.DrawNode) {
						i.beginPath();
						e = n._renderCmd._transform;
						i.transform(e.a, e.b, e.c, e.d, e.tx, -e.ty);
						for (var r = 0; r < n._buffer.length; r++) {
							var o = n._buffer[r].verts,
								s = o[0];
							i.moveTo(s.x, -s.y);
							for (var c = o.length - 1; 0 < c; c--)
								i.lineTo(o[c].x, -o[c].y);
						}
					}
					i.clip();
				}
			}),
			(t._restoreCmdCallback = function (t) {
				var e = cc.ClippingNode.CanvasRenderCmd._getSharedCache(),
					i = t || cc._renderContext,
					t = i.getContext();
				this._clipElemType
					? (t.save(),
					  t.setTransform(1, 0, 0, 1, 0, 0),
					  (t.globalCompositeOperation = 'destination-over'),
					  t.drawImage(e, 0, 0),
					  t.restore(),
					  (this._dirtyFlag = 0))
					: i.restore();
			}),
			(t.transform = function (t, e) {
				cc.Node.CanvasRenderCmd.prototype.transform.call(this, t, e);
				t = this._node;
				t._stencil &&
					t._stencil._renderCmd &&
					t._stencil._renderCmd.transform(this, e);
			}),
			(t._cangodhelpme = function (t) {
				return (
					(!0 !== t && !1 !== t) ||
						(cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme =
							t),
					cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme
				);
			}),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible) {
					(t = t || this.getParentRenderCmd()) &&
						(this._curLevel = t._curLevel + 1);
					if (
						((this._clipElemType = !(
							!this._cangodhelpme() &&
							e._stencil instanceof cc.DrawNode
						)),
						e._stencil && e._stencil.visible)
					) {
						if (
							(this._syncStatus(t),
							cc.renderer.pushRenderCommand(
								this._rendererSaveCmd
							),
							this._clipElemType
								? this.originVisit(t)
								: e._stencil.visit(this),
							cc.renderer.pushRenderCommand(
								this._rendererClipCmd
							),
							this._clipElemType)
						)
							e._stencil.visit(this);
						else {
							var i,
								n = e._children;
							this._cangodhelpme(!0);
							var r = n.length;
							if (0 < r)
								for (e.sortAllChildren(), i = 0; i < r; i++)
									n[i]._renderCmd.visit(this);
							this._cangodhelpme(!1);
						}
						cc.renderer.pushRenderCommand(this._rendererRestoreCmd),
							(this._dirtyFlag = 0);
					} else this.inverted && this.originVisit(t);
				}
			}),
			(cc.ClippingNode.CanvasRenderCmd._sharedCache = null),
			(cc.ClippingNode.CanvasRenderCmd._getSharedCache = function () {
				return (
					cc.ClippingNode.CanvasRenderCmd._sharedCache ||
					(cc.ClippingNode.CanvasRenderCmd._sharedCache =
						document.createElement('canvas'))
				);
			});
	})(),
	(function () {
		cc.ClippingNode.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !1),
				(this._beforeVisitCmd = new cc.CustomRenderCmd(
					this,
					this._onBeforeVisit
				)),
				(this._afterDrawStencilCmd = new cc.CustomRenderCmd(
					this,
					this._onAfterDrawStencil
				)),
				(this._afterVisitCmd = new cc.CustomRenderCmd(
					this,
					this._onAfterVisit
				)),
				(this._currentStencilEnabled = null),
				(this._mask_layer_le = null);
		};
		var t = (cc.ClippingNode.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.ClippingNode.WebGLRenderCmd),
			(cc.ClippingNode.WebGLRenderCmd._init_once = null),
			(cc.ClippingNode.WebGLRenderCmd._visit_once = null),
			(cc.ClippingNode.WebGLRenderCmd._layer = -1),
			(t.initStencilBits = function () {
				(cc.ClippingNode.WebGLRenderCmd._init_once = !0),
					cc.ClippingNode.WebGLRenderCmd._init_once &&
						((cc.stencilBits = cc._renderContext.getParameter(
							cc._renderContext.STENCIL_BITS
						)),
						cc.stencilBits <= 0 &&
							cc.log('Stencil buffer is not enabled.'),
						(cc.ClippingNode.WebGLRenderCmd._init_once = !1));
			}),
			(t.transform = function (t, e) {
				var i = this._node;
				this.originTransform(t, e),
					i._stencil && i._stencil._renderCmd.transform(this, e);
			}),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible)
					if (
						(e._parent &&
							e._parent._renderCmd &&
							(this._curLevel =
								e._parent._renderCmd._curLevel + 1),
						cc.stencilBits < 1)
					)
						this.originVisit(t);
					else if (e._stencil && e._stencil.visible) {
						if (
							cc.ClippingNode.WebGLRenderCmd._layer + 1 ===
							cc.stencilBits
						)
							return (
								(cc.ClippingNode.WebGLRenderCmd._visit_once =
									!0),
								cc.ClippingNode.WebGLRenderCmd._visit_once &&
									(cc.log(
										'Nesting more than ' +
											cc.stencilBits +
											'stencils is not supported. Everything will be drawn without stencil for this node and its children.'
									),
									(cc.ClippingNode.WebGLRenderCmd._visit_once =
										!1)),
								void this.originVisit(t)
							);
						cc.renderer.pushRenderCommand(this._beforeVisitCmd);
						var i = cc.current_stack;
						i.stack.push(i.top),
							this._syncStatus(t),
							(i.top = this._stackMatrix),
							e._stencil._renderCmd.visit(this),
							cc.renderer.pushRenderCommand(
								this._afterDrawStencilCmd
							);
						var n = e._children;
						if (n && 0 < n.length) {
							var r = n.length;
							e.sortAllChildren();
							for (var o = 0; o < r; o++)
								n[o]._renderCmd.visit(this);
						}
						cc.renderer.pushRenderCommand(this._afterVisitCmd),
							(this._dirtyFlag = 0),
							(i.top = i.stack.pop());
					} else e.inverted && this.originVisit(t);
			}),
			(t.setStencil = function (t) {
				var e = this._node;
				e._stencil && (e._stencil._parent = null),
					(e._stencil = t),
					e._stencil && (e._stencil._parent = e);
			}),
			(t._onBeforeVisit = function (t) {
				var e = t || cc._renderContext,
					i = this._node;
				cc.ClippingNode.WebGLRenderCmd._layer++;
				var n = 1 << cc.ClippingNode.WebGLRenderCmd._layer,
					t = n - 1;
				(this._mask_layer_le = n | t),
					(this._currentStencilEnabled = e.isEnabled(e.STENCIL_TEST)),
					e.clear(e.DEPTH_BUFFER_BIT),
					e.enable(e.STENCIL_TEST),
					e.depthMask(!1),
					e.stencilFunc(e.NEVER, n, n),
					e.stencilOp(e.REPLACE, e.KEEP, e.KEEP),
					e.stencilMask(n),
					e.clear(e.STENCIL_BUFFER_BIT),
					i.alphaThreshold < 1 &&
						((e = cc.shaderCache.programForKey(
							cc.SHADER_POSITION_TEXTURECOLORALPHATEST
						)),
						cc.glUseProgram(e.getProgram()),
						e.setUniformLocationWith1f(
							cc.UNIFORM_ALPHA_TEST_VALUE_S,
							i.alphaThreshold
						),
						e.setUniformLocationWithMatrix4fv(
							cc.UNIFORM_MVMATRIX_S,
							cc.renderer.mat4Identity.mat
						),
						cc.setProgram(i._stencil, e));
			}),
			(t._onAfterDrawStencil = function (t) {
				t = t || cc._renderContext;
				t.depthMask(!0),
					t.stencilFunc(
						this._node.inverted ? t.NOTEQUAL : t.EQUAL,
						this._mask_layer_le,
						this._mask_layer_le
					),
					t.stencilOp(t.KEEP, t.KEEP, t.KEEP);
			}),
			(t._onAfterVisit = function (t) {
				var e,
					i = t || cc._renderContext;
				cc.ClippingNode.WebGLRenderCmd._layer--,
					this._currentStencilEnabled
						? ((t =
								(e =
									1 <<
									cc.ClippingNode.WebGLRenderCmd._layer) |
								(e - 1)),
						  i.stencilMask(e),
						  i.stencilFunc(i.EQUAL, t, t))
						: i.disable(i.STENCIL_TEST);
			});
	})(),
	(cc.GridBase = cc.Class.extend({
		_active: !1,
		_reuseGrid: 0,
		_gridSize: null,
		_gridRect: null,
		_texture: null,
		_step: null,
		_grabber: null,
		_isTextureFlipped: !1,
		_shaderProgram: null,
		_directorProjection: 0,
		_dirty: !1,
		ctor: function (t, e, i, n) {
			cc.sys._checkWebGLRenderMode(),
				(this._active = !1),
				(this._reuseGrid = 0),
				(this._gridSize = null),
				(this._gridRect = new cc.rect()),
				(this._texture = null),
				(this._step = cc.p(0, 0)),
				(this._grabber = null),
				(this._isTextureFlipped = !1),
				(this._shaderProgram = null),
				(this._directorProjection = 0),
				(this._dirty = !1),
				void 0 !== t && this.initWithSize(t, e, i, n);
		},
		isActive: function () {
			return this._active;
		},
		setActive: function (t) {
			var e;
			(this._active = t) ||
				((t = (e = cc.director).getProjection()), e.setProjection(t));
		},
		getReuseGrid: function () {
			return this._reuseGrid;
		},
		setReuseGrid: function (t) {
			this._reuseGrid = t;
		},
		getGridSize: function () {
			return cc.size(this._gridSize.width, this._gridSize.height);
		},
		setGridSize: function (t) {
			(this._gridSize.width = parseInt(t.width)),
				(this._gridSize.height = parseInt(t.height));
		},
		setGridRect: function (t) {
			this._gridRect = t;
		},
		getGridRect: function () {
			return this._gridRect;
		},
		getStep: function () {
			return cc.p(this._step.x, this._step.y);
		},
		setStep: function (t) {
			(this._step.x = t.x), (this._step.y = t.y);
		},
		isTextureFlipped: function () {
			return this._isTextureFlipped;
		},
		setTextureFlipped: function (t) {
			this._isTextureFlipped !== t &&
				((this._isTextureFlipped = t), this.calculateVertexPoints());
		},
		initWithSize: function (t, e, i, n) {
			if (!e) {
				var r = cc.director.getWinSizeInPixels(),
					o = cc.NextPOT(r.width),
					s = cc.NextPOT(r.height),
					c = new Uint8Array(o * s * 4);
				if (!c)
					return cc.log('cocos2d: CCGrid: not enough memory.'), !1;
				if (
					((e = new cc.Texture2D()).initWithData(
						c,
						cc.Texture2D.PIXEL_FORMAT_RGBA8888,
						o,
						s,
						r
					),
					!e)
				)
					return (
						cc.log('cocos2d: CCGrid: error creating texture'), !1
					);
			}
			return (
				(i = i || !1),
				(this._active = !1),
				(this._reuseGrid = 0),
				(this._gridSize = t),
				(this._texture = e),
				(this._isTextureFlipped = i),
				(void 0 !== n && !cc._rectEqualToZero(n)) ||
					((i = this._texture.getContentSize()),
					(n = new cc.rect(0, 0, i.width, i.height))),
				(this._gridRect = n),
				(this._step.x = this._gridRect.width / t.width),
				(this._step.y = this._gridRect.height / t.height),
				(this._grabber = new cc.Grabber()),
				!!this._grabber &&
					(this._grabber.grab(this._texture),
					(this._shaderProgram = cc.shaderCache.programForKey(
						cc.SHADER_POSITION_TEXTURE
					)),
					this.calculateVertexPoints(),
					!0)
			);
		},
		beforeDraw: function () {
			this._directorProjection = cc.director.getProjection();
			var t = cc.director.getWinSizeInPixels();
			gl.viewport(0, 0, t.width, t.height),
				this._grabber.beforeRender(this._texture);
		},
		afterDraw: function (t) {
			this._grabber.afterRender(this._texture),
				cc.director.setViewport(),
				cc.glBindTexture2D(this._texture),
				this.beforeBlit(),
				this.blit(t),
				this.afterBlit();
		},
		beforeBlit: function () {},
		afterBlit: function () {},
		blit: function () {
			cc.log('cc.GridBase.blit(): Shall be overridden in subclass.');
		},
		reuse: function () {
			cc.log('cc.GridBase.reuse(): Shall be overridden in subclass.');
		},
		calculateVertexPoints: function () {
			cc.log(
				'cc.GridBase.calculateVertexPoints(): Shall be overridden in subclass.'
			);
		},
		set2DProjection: function () {
			var t = cc.director.getWinSizeInPixels();
			cc._renderContext.viewport(0, 0, t.width, t.height),
				cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),
				cc.kmGLLoadIdentity();
			t = cc.math.Matrix4.createOrthographicProjection(
				0,
				t.width,
				0,
				t.height,
				-1,
				1
			);
			cc.kmGLMultMatrix(t),
				cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),
				cc.kmGLLoadIdentity(),
				cc.setProjectionMatrixDirty();
		},
	})),
	(cc.GridBase.create = function (t, e, i, n) {
		return new cc.GridBase(t, e, i, n);
	}),
	(cc.Grid3D = cc.GridBase.extend({
		_texCoordinates: null,
		_vertices: null,
		_originalVertices: null,
		_indices: null,
		_texCoordinateBuffer: null,
		_verticesBuffer: null,
		_indicesBuffer: null,
		_needDepthTestForBlit: !1,
		_oldDepthTestValue: !1,
		_oldDepthWriteValue: !1,
		ctor: function (t, e, i, n) {
			cc.GridBase.prototype.ctor.call(this),
				(this._texCoordinates = null),
				(this._vertices = null),
				(this._originalVertices = null),
				(this._indices = null),
				(this._texCoordinateBuffer = null),
				(this._verticesBuffer = null),
				(this._indicesBuffer = null),
				(this._matrix = new cc.math.Matrix4()),
				this._matrix.identity(),
				void 0 !== t && this.initWithSize(t, e, i, n);
		},
		vertex: function (t) {
			return this.getVertex(t);
		},
		getVertex: function (t) {
			(t.x === (0 | t.x) && t.y === (0 | t.y)) ||
				cc.log('cc.Grid3D.vertex() : Numbers must be integers');
			var e = 0 | (3 * (t.x * (this._gridSize.height + 1) + t.y)),
				t = this._vertices;
			return new cc.Vertex3F(t[e], t[1 + e], t[2 + e]);
		},
		originalVertex: function (t) {
			return this.getOriginalVertex(t);
		},
		getOriginalVertex: function (t) {
			(t.x === (0 | t.x) && t.y === (0 | t.y)) ||
				cc.log('cc.Grid3D.originalVertex() : Numbers must be integers');
			var e = 0 | (3 * (t.x * (this._gridSize.height + 1) + t.y)),
				t = this._originalVertices;
			return new cc.Vertex3F(t[e], t[1 + e], t[2 + e]);
		},
		setVertex: function (t, e) {
			(t.x === (0 | t.x) && t.y === (0 | t.y)) ||
				cc.log('cc.Grid3D.setVertex() : Numbers must be integers');
			var i = 0 | (3 * (t.x * (this._gridSize.height + 1) + t.y)),
				t = this._vertices;
			(t[i] = e.x),
				(t[1 + i] = e.y),
				(t[2 + i] = e.z),
				(this._dirty = !0);
		},
		beforeBlit: function () {
			var t;
			this._needDepthTestForBlit &&
				((t = cc._renderContext),
				(this._oldDepthTestValue = t.isEnabled(t.DEPTH_TEST)),
				(this._oldDepthWriteValue = t.getParameter(t.DEPTH_WRITEMASK)),
				t.enable(t.DEPTH_TEST),
				t.depthMask(!0));
		},
		afterBlit: function () {
			var t;
			this._needDepthTestForBlit &&
				((t = cc._renderContext),
				this._oldDepthTestValue
					? t.enable(t.DEPTH_TEST)
					: t.disable(t.DEPTH_TEST),
				t.depthMask(this._oldDepthWriteValue));
		},
		blit: function (t) {
			var e = this._gridSize.width * this._gridSize.height,
				i = t._renderCmd._worldTransform;
			(this._matrix.mat[0] = i.a),
				(this._matrix.mat[4] = i.c),
				(this._matrix.mat[12] = i.tx),
				(this._matrix.mat[1] = i.b),
				(this._matrix.mat[5] = i.d),
				(this._matrix.mat[13] = i.ty),
				this._shaderProgram.use(),
				this._shaderProgram._setUniformForMVPMatrixWithMat4(
					this._matrix
				);
			(t = cc._renderContext), (i = this._dirty);
			t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
				t.bindBuffer(t.ARRAY_BUFFER, this._verticesBuffer),
				i &&
					t.bufferData(
						t.ARRAY_BUFFER,
						this._vertices,
						t.DYNAMIC_DRAW
					),
				t.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					3,
					t.FLOAT,
					!1,
					0,
					0
				),
				t.bindBuffer(t.ARRAY_BUFFER, this._texCoordinateBuffer),
				i &&
					t.bufferData(
						t.ARRAY_BUFFER,
						this._texCoordinates,
						t.DYNAMIC_DRAW
					),
				t.vertexAttribPointer(
					cc.VERTEX_ATTRIB_TEX_COORDS,
					2,
					t.FLOAT,
					!1,
					0,
					0
				),
				t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this._indicesBuffer),
				i &&
					t.bufferData(
						t.ELEMENT_ARRAY_BUFFER,
						this._indices,
						t.STATIC_DRAW
					),
				t.drawElements(t.TRIANGLES, 6 * e, t.UNSIGNED_SHORT, 0),
				i && (this._dirty = !1),
				cc.incrementGLDraws(1);
		},
		reuse: function () {
			if (0 < this._reuseGrid) {
				for (
					var t = this._originalVertices,
						e = this._vertices,
						i = 0,
						n = this._vertices.length;
					i < n;
					i++
				)
					t[i] = e[i];
				--this._reuseGrid;
			}
		},
		calculateVertexPoints: function () {
			var t = cc._renderContext,
				e = this._texture.pixelsWidth,
				i = this._texture.pixelsHeight,
				n = this._texture.getContentSizeInPixels().height,
				r = this._gridSize,
				o = (r.width + 1) * (r.height + 1);
			(this._vertices = new Float32Array(3 * o)),
				(this._texCoordinates = new Float32Array(2 * o)),
				(this._indices = new Uint16Array(r.width * r.height * 6)),
				this._verticesBuffer && t.deleteBuffer(this._verticesBuffer),
				(this._verticesBuffer = t.createBuffer()),
				this._texCoordinateBuffer &&
					t.deleteBuffer(this._texCoordinateBuffer),
				(this._texCoordinateBuffer = t.createBuffer()),
				this._indicesBuffer && t.deleteBuffer(this._indicesBuffer),
				(this._indicesBuffer = t.createBuffer());
			for (
				var s,
					c = this._indices,
					a = this._texCoordinates,
					l = this._isTextureFlipped,
					h = this._vertices,
					u = 0;
				u < r.width;
				++u
			)
				for (s = 0; s < r.height; ++s) {
					var _ = s * r.width + u,
						d = u * this._step.x + this._gridRect.x,
						p = d + this._step.x,
						f = s * this._step.y + this._gridRect.y,
						m = f + this._step.y,
						g = u * (r.height + 1) + s,
						y = (u + 1) * (r.height + 1) + s,
						T = (u + 1) * (r.height + 1) + (s + 1),
						S = u * (r.height + 1) + (s + 1);
					(c[6 * _] = g), (c[6 * _ + 1] = y), (c[6 * _ + 2] = S);
					for (
						var C = [
								3 * g,
								3 * (c[6 * _ + 3] = y),
								3 * (c[6 * _ + 4] = T),
								3 * (c[6 * _ + 5] = S),
							],
							x = [
								{ x: d, y: f, z: 0 },
								{ x: p, y: f, z: 0 },
								{ x: p, y: m, z: 0 },
								{ x: d, y: m, z: 0 },
							],
							v = [2 * g, 2 * y, 2 * T, 2 * S],
							E = [
								cc.p(d, f),
								cc.p(p, f),
								cc.p(p, m),
								cc.p(d, m),
							],
							A = 0;
						A < 4;
						++A
					)
						(h[C[A]] = x[A].x),
							(h[C[A] + 1] = x[A].y),
							(h[C[A] + 2] = x[A].z),
							(a[v[A]] = E[A].x / e),
							(a[v[A] + 1] = l ? (n - E[A].y) / i : E[A].y / i);
				}
			(this._originalVertices = new Float32Array(this._vertices)),
				t.bindBuffer(t.ARRAY_BUFFER, this._verticesBuffer),
				t.bufferData(t.ARRAY_BUFFER, this._vertices, t.DYNAMIC_DRAW),
				t.bindBuffer(t.ARRAY_BUFFER, this._texCoordinateBuffer),
				t.bufferData(
					t.ARRAY_BUFFER,
					this._texCoordinates,
					t.DYNAMIC_DRAW
				),
				t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this._indicesBuffer),
				t.bufferData(
					t.ELEMENT_ARRAY_BUFFER,
					this._indices,
					t.STATIC_DRAW
				),
				(this._dirty = !0);
		},
		setNeedDepthTestForBlit: function (t) {
			this._needDepthTestForBlit = t;
		},
		getNeedDepthTestForBlit: function () {
			return this._needDepthTestForBlit;
		},
	})),
	(cc.Grid3D.create = function (t, e, i) {
		return new cc.Grid3D(t, e, i);
	}),
	(cc.TiledGrid3D = cc.GridBase.extend({
		_texCoordinates: null,
		_vertices: null,
		_originalVertices: null,
		_indices: null,
		_texCoordinateBuffer: null,
		_verticesBuffer: null,
		_indicesBuffer: null,
		ctor: function (t, e, i, n) {
			cc.GridBase.prototype.ctor.call(this),
				(this._texCoordinates = null),
				(this._vertices = null),
				(this._originalVertices = null),
				(this._indices = null),
				(this._texCoordinateBuffer = null),
				(this._verticesBuffer = null),
				(this._indicesBuffer = null),
				(this._matrix = new cc.math.Matrix4()),
				this._matrix.identity(),
				void 0 !== t && this.initWithSize(t, e, i, n);
		},
		tile: function (t) {
			return this.getTile(t);
		},
		getTile: function (t) {
			(t.x === (0 | t.x) && t.y === (0 | t.y)) ||
				cc.log('cc.TiledGrid3D.tile() : Numbers must be integers');
			var e = 4 * (this._gridSize.height * t.x + t.y) * 3,
				t = this._vertices;
			return new cc.Quad3(
				new cc.Vertex3F(t[e], t[1 + e], t[2 + e]),
				new cc.Vertex3F(t[3 + e], t[4 + e], t[5 + e]),
				new cc.Vertex3F(t[6 + e], t[7 + e], t[8 + e]),
				new cc.Vertex3F(t[9 + e], t[10 + e], t[11 + e])
			);
		},
		getOriginalTile: function (t) {
			(t.x === (0 | t.x) && t.y === (0 | t.y)) ||
				cc.log(
					'cc.TiledGrid3D.originalTile() : Numbers must be integers'
				);
			var e = 4 * (this._gridSize.height * t.x + t.y) * 3,
				t = this._originalVertices;
			return new cc.Quad3(
				new cc.Vertex3F(t[e], t[1 + e], t[2 + e]),
				new cc.Vertex3F(t[3 + e], t[4 + e], t[5 + e]),
				new cc.Vertex3F(t[6 + e], t[7 + e], t[8 + e]),
				new cc.Vertex3F(t[9 + e], t[10 + e], t[11 + e])
			);
		},
		originalTile: function (t) {
			return this.getOriginalTile(t);
		},
		setTile: function (t, e) {
			(t.x === (0 | t.x) && t.y === (0 | t.y)) ||
				cc.log('cc.TiledGrid3D.setTile() : Numbers must be integers');
			var i = 12 * (this._gridSize.height * t.x + t.y),
				t = this._vertices;
			(t[i] = e.bl.x),
				(t[1 + i] = e.bl.y),
				(t[2 + i] = e.bl.z),
				(t[3 + i] = e.br.x),
				(t[4 + i] = e.br.y),
				(t[5 + i] = e.br.z),
				(t[6 + i] = e.tl.x),
				(t[7 + i] = e.tl.y),
				(t[8 + i] = e.tl.z),
				(t[9 + i] = e.tr.x),
				(t[10 + i] = e.tr.y),
				(t[11 + i] = e.tr.z),
				(this._dirty = !0);
		},
		blit: function (t) {
			var e = this._gridSize.width * this._gridSize.height,
				i = t._renderCmd._worldTransform;
			(this._matrix.mat[0] = i.a),
				(this._matrix.mat[4] = i.c),
				(this._matrix.mat[12] = i.tx),
				(this._matrix.mat[1] = i.b),
				(this._matrix.mat[5] = i.d),
				(this._matrix.mat[13] = i.ty),
				this._shaderProgram.use(),
				this._shaderProgram._setUniformForMVPMatrixWithMat4(
					this._matrix
				);
			(t = cc._renderContext), (i = this._dirty);
			t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
				t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
				t.bindBuffer(t.ARRAY_BUFFER, this._verticesBuffer),
				i &&
					t.bufferData(
						t.ARRAY_BUFFER,
						this._vertices,
						t.DYNAMIC_DRAW
					),
				t.vertexAttribPointer(
					cc.VERTEX_ATTRIB_POSITION,
					3,
					t.FLOAT,
					!1,
					0,
					this._vertices
				),
				t.bindBuffer(t.ARRAY_BUFFER, this._texCoordinateBuffer),
				i &&
					t.bufferData(
						t.ARRAY_BUFFER,
						this._texCoordinates,
						t.DYNAMIC_DRAW
					),
				t.vertexAttribPointer(
					cc.VERTEX_ATTRIB_TEX_COORDS,
					2,
					t.FLOAT,
					!1,
					0,
					this._texCoordinates
				),
				t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this._indicesBuffer),
				i &&
					t.bufferData(
						t.ELEMENT_ARRAY_BUFFER,
						this._indices,
						t.STATIC_DRAW
					),
				t.drawElements(t.TRIANGLES, 6 * e, t.UNSIGNED_SHORT, 0),
				i && (this._dirty = !1),
				cc.incrementGLDraws(1);
		},
		reuse: function () {
			if (0 < this._reuseGrid) {
				for (
					var t = this._vertices, e = this._originalVertices, i = 0;
					i < t.length;
					i++
				)
					e[i] = t[i];
				--this._reuseGrid;
			}
		},
		calculateVertexPoints: function () {
			var t = this._texture.pixelsWidth,
				e = this._texture.pixelsHeight,
				i = this._texture.getContentSizeInPixels().height,
				n = this._gridSize,
				r = n.width * n.height;
			(this._vertices = new Float32Array(12 * r)),
				(this._texCoordinates = new Float32Array(8 * r)),
				(this._indices = new Uint16Array(6 * r));
			var o = cc._renderContext;
			this._verticesBuffer && o.deleteBuffer(this._verticesBuffer),
				(this._verticesBuffer = o.createBuffer()),
				this._texCoordinateBuffer &&
					o.deleteBuffer(this._texCoordinateBuffer),
				(this._texCoordinateBuffer = o.createBuffer()),
				this._indicesBuffer && o.deleteBuffer(this._indicesBuffer),
				(this._indicesBuffer = o.createBuffer());
			for (
				var s,
					c = 0,
					a = this._step,
					l = this._vertices,
					h = this._texCoordinates,
					u = this._isTextureFlipped,
					_ = 0;
				_ < n.width;
				_++
			)
				for (s = 0; s < n.height; s++) {
					var d = _ * a.x,
						p = d + a.x,
						f = s * a.y,
						m = f + a.y;
					(l[12 * c] = d),
						(l[12 * c + 1] = f),
						(l[12 * c + 2] = 0),
						(l[12 * c + 3] = p),
						(l[12 * c + 4] = f),
						(l[12 * c + 5] = 0),
						(l[12 * c + 6] = d),
						(l[12 * c + 7] = m),
						(l[12 * c + 8] = 0),
						(l[12 * c + 9] = p),
						(l[12 * c + 10] = m),
						(l[12 * c + 11] = 0);
					var g = f,
						y = m;
					u && ((g = i - f), (y = i - m)),
						(h[8 * c] = d / t),
						(h[8 * c + 1] = g / e),
						(h[8 * c + 2] = p / t),
						(h[8 * c + 3] = g / e),
						(h[8 * c + 4] = d / t),
						(h[8 * c + 5] = y / e),
						(h[8 * c + 6] = p / t),
						(h[8 * c + 7] = y / e),
						c++;
				}
			var T = this._indices;
			for (_ = 0; _ < r; _++)
				(T[6 * _ + 0] = 4 * _ + 0),
					(T[6 * _ + 1] = 4 * _ + 1),
					(T[6 * _ + 2] = 4 * _ + 2),
					(T[6 * _ + 3] = 4 * _ + 1),
					(T[6 * _ + 4] = 4 * _ + 2),
					(T[6 * _ + 5] = 4 * _ + 3);
			(this._originalVertices = new Float32Array(this._vertices)),
				o.bindBuffer(o.ARRAY_BUFFER, this._verticesBuffer),
				o.bufferData(o.ARRAY_BUFFER, this._vertices, o.DYNAMIC_DRAW),
				o.bindBuffer(o.ARRAY_BUFFER, this._texCoordinateBuffer),
				o.bufferData(
					o.ARRAY_BUFFER,
					this._texCoordinates,
					o.DYNAMIC_DRAW
				),
				o.bindBuffer(o.ELEMENT_ARRAY_BUFFER, this._indicesBuffer),
				o.bufferData(
					o.ELEMENT_ARRAY_BUFFER,
					this._indices,
					o.DYNAMIC_DRAW
				),
				(this._dirty = !0);
		},
	})),
	(cc.TiledGrid3D.create = function (t, e, i) {
		return new cc.TiledGrid3D(t, e, i);
	}),
	(cc.Grabber = cc.Class.extend({
		_FBO: null,
		_oldFBO: null,
		_oldClearColor: null,
		_gl: null,
		ctor: function () {
			cc.sys._checkWebGLRenderMode(),
				(this._gl = cc._renderContext),
				(this._oldClearColor = [0, 0, 0, 0]),
				(this._oldFBO = null),
				(this._FBO = this._gl.createFramebuffer());
		},
		grab: function (t) {
			var e = this._gl;
			(this._oldFBO = e.getParameter(e.FRAMEBUFFER_BINDING)),
				e.bindFramebuffer(e.FRAMEBUFFER, this._FBO),
				e.framebufferTexture2D(
					e.FRAMEBUFFER,
					e.COLOR_ATTACHMENT0,
					e.TEXTURE_2D,
					t._webTextureObj,
					0
				),
				e.checkFramebufferStatus(e.FRAMEBUFFER) !==
					e.FRAMEBUFFER_COMPLETE &&
					cc.log(
						'Frame Grabber: could not attach texture to frmaebuffer'
					),
				e.bindFramebuffer(e.FRAMEBUFFER, this._oldFBO);
		},
		beforeRender: function (t) {
			var e = this._gl;
			(this._oldFBO = e.getParameter(e.FRAMEBUFFER_BINDING)),
				e.bindFramebuffer(e.FRAMEBUFFER, this._FBO),
				(this._oldClearColor = e.getParameter(e.COLOR_CLEAR_VALUE)),
				e.clearColor(0, 0, 0, 0),
				e.clear(e.COLOR_BUFFER_BIT | e.DEPTH_BUFFER_BIT);
		},
		afterRender: function (t) {
			var e = this._gl;
			e.bindFramebuffer(e.FRAMEBUFFER, this._oldFBO),
				e.colorMask(!0, !0, !0, !0);
		},
		destroy: function () {
			this._gl.deleteFramebuffer(this._FBO);
		},
	})),
	(cc.GridAction = cc.ActionInterval.extend({
		_gridSize: null,
		_gridNodeTarget: null,
		ctor: function (t, e) {
			cc.sys._checkWebGLRenderMode(),
				cc.ActionInterval.prototype.ctor.call(this),
				(this._gridSize = cc.size(0, 0)),
				e && this.initWithDuration(t, e);
		},
		_cacheTargetAsGridNode: function (t) {
			this._gridNodeTarget = t;
		},
		clone: function () {
			var t = new cc.GridAction(),
				e = this._gridSize;
			return (
				t.initWithDuration(this._duration, cc.size(e.width, e.height)),
				t
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(cc.renderer.childrenOrderDirty = !0),
				this._cacheTargetAsGridNode(t);
			var e = this.getGrid(),
				i = this._gridNodeTarget.getGrid();
			i && 0 < i.getReuseGrid()
				? ((t = i.getGridSize()),
				  i.isActive() &&
						t.width === this._gridSize.width &&
						t.height === this._gridSize.height &&
						i.reuse())
				: (i && i.isActive() && i.setActive(!1),
				  this._gridNodeTarget.setGrid(e),
				  this._gridNodeTarget.getGrid().setActive(!0));
		},
		reverse: function () {
			return new cc.ReverseTime(this);
		},
		initWithDuration: function (t, e) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._gridSize.width = e.width),
				(this._gridSize.height = e.height),
				!0)
			);
		},
		getGrid: function () {
			cc.log(
				'cc.GridAction.getGrid(): it should be overridden in subclass.'
			);
		},
	})),
	(cc.gridAction = function (t, e) {
		return new cc.GridAction(t, e);
	}),
	(cc.GridAction.create = cc.gridAction),
	(cc.Grid3DAction = cc.GridAction.extend({
		getGrid: function () {
			return new cc.Grid3D(
				this._gridSize,
				void 0,
				void 0,
				this._gridNodeTarget.getGridRect()
			);
		},
		getGridRect: function () {
			return this._gridNodeTarget.getGridRect();
		},
		vertex: function (t) {
			return this.getVertex(t);
		},
		getVertex: function (t) {
			return this.target.grid.getVertex(t);
		},
		originalVertex: function (t) {
			return this.getOriginalVertex(t);
		},
		getOriginalVertex: function (t) {
			return this.target.grid.originalVertex(t);
		},
		setVertex: function (t, e) {
			this.target.grid.setVertex(t, e);
		},
	})),
	(cc.grid3DAction = function (t, e) {
		return new cc.Grid3DAction(t, e);
	}),
	(cc.Grid3DAction.create = cc.grid3DAction),
	(cc.TiledGrid3DAction = cc.GridAction.extend({
		tile: function (t) {
			return this.getTile(t);
		},
		getTile: function (t) {
			return this.target.grid.tile(t);
		},
		originalTile: function (t) {
			return this.getOriginalTile(t);
		},
		getOriginalTile: function (t) {
			return this.target.grid.originalTile(t);
		},
		setTile: function (t, e) {
			this.target.grid.setTile(t, e);
		},
		getGrid: function () {
			return new cc.TiledGrid3D(
				this._gridSize,
				void 0,
				void 0,
				this._gridNodeTarget.getGridRect()
			);
		},
	})),
	(cc.tiledGrid3DAction = function (t, e) {
		return new cc.TiledGrid3DAction(t, e);
	}),
	(cc.TiledGrid3DAction.create = cc.tiledGrid3DAction),
	(cc.StopGrid = cc.ActionInstant.extend({
		startWithTarget: function (t) {
			cc.ActionInstant.prototype.startWithTarget.call(this, t),
				(cc.renderer.childrenOrderDirty = !0);
			t = this.target.grid;
			t && t.isActive() && t.setActive(!1);
		},
	})),
	(cc.stopGrid = function () {
		return new cc.StopGrid();
	}),
	(cc.StopGrid.create = cc.stopGrid),
	(cc.ReuseGrid = cc.ActionInstant.extend({
		_times: null,
		ctor: function (t) {
			cc.ActionInstant.prototype.ctor.call(this),
				void 0 !== t && this.initWithTimes(t);
		},
		initWithTimes: function (t) {
			return (this._times = t), !0;
		},
		startWithTarget: function (t) {
			cc.ActionInstant.prototype.startWithTarget.call(this, t),
				(cc.renderer.childrenOrderDirty = !0),
				this.target.grid &&
					this.target.grid.isActive() &&
					this.target.grid.setReuseGrid(
						this.target.grid.getReuseGrid() + this._times
					);
		},
	})),
	(cc.reuseGrid = function (t) {
		return new cc.ReuseGrid(t);
	}),
	(cc.ReuseGrid.create = cc.reuseGrid),
	(cc.Waves3D = cc.Grid3DAction.extend({
		_waves: 0,
		_amplitude: 0,
		_amplitudeRate: 0,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		getAmplitude: function () {
			return this._amplitude;
		},
		setAmplitude: function (t) {
			this._amplitude = t;
		},
		getAmplitudeRate: function () {
			return this._amplitudeRate;
		},
		setAmplitudeRate: function (t) {
			this._amplitudeRate = t;
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.Grid3DAction.prototype.initWithDuration.call(this, t, e) &&
				((this._waves = i),
				(this._amplitude = n),
				(this._amplitudeRate = 1),
				!0)
			);
		},
		update: function (t) {
			for (
				var e = this._gridSize,
					i = this._amplitude,
					n = cc.p(0, 0),
					r = this._amplitudeRate,
					o = this._waves,
					s = 0;
				s < e.width + 1;
				++s
			)
				for (var c = 0; c < e.height + 1; ++c) {
					(n.x = s), (n.y = c);
					var a = this.originalVertex(n);
					(a.z +=
						Math.sin(Math.PI * t * o * 2 + 0.01 * (a.y + a.x)) *
						i *
						r),
						this.setVertex(n, a);
				}
		},
	})),
	(cc.waves3D = function (t, e, i, n) {
		return new cc.Waves3D(t, e, i, n);
	}),
	(cc.Waves3D.create = cc.waves3D),
	(cc.FlipX3D = cc.Grid3DAction.extend({
		ctor: function (t) {
			void 0 !== t
				? cc.GridAction.prototype.ctor.call(this, t, cc.size(1, 1))
				: cc.GridAction.prototype.ctor.call(this);
		},
		initWithDuration: function (t) {
			return cc.Grid3DAction.prototype.initWithDuration.call(
				this,
				t,
				cc.size(1, 1)
			);
		},
		initWithSize: function (t, e) {
			return 1 !== t.width || 1 !== t.height
				? (cc.log('Grid size must be (1,1)'), !1)
				: cc.Grid3DAction.prototype.initWithDuration.call(this, e, t);
		},
		update: function (t) {
			var e = Math.PI * t,
				i = Math.sin(e);
			e /= 2;
			var n = Math.cos(e),
				r = new cc.Vertex3F(),
				t = cc.p(0, 0);
			t.x = t.y = 1;
			e = this.originalVertex(t);
			t.x = t.y = 0;
			var o,
				s,
				c,
				a,
				t = this.originalVertex(t),
				e = e.x,
				t = t.x,
				t =
					t < e
						? ((o = cc.p(0, 0)),
						  (s = cc.p(0, 1)),
						  (c = cc.p(1, 0)),
						  (a = cc.p(1, 1)),
						  e)
						: ((c = cc.p(0, 0)),
						  (a = cc.p(0, 1)),
						  (o = cc.p(1, 0)),
						  (s = cc.p(1, 1)),
						  t);
			(r.x = t - t * n), (r.z = Math.abs(parseFloat((t * i) / 4)));
			i = this.originalVertex(o);
			(i.x = r.x),
				(i.z += r.z),
				this.setVertex(o, i),
				((i = this.originalVertex(s)).x = r.x),
				(i.z += r.z),
				this.setVertex(s, i),
				((i = this.originalVertex(c)).x -= r.x),
				(i.z -= r.z),
				this.setVertex(c, i),
				((i = this.originalVertex(a)).x -= r.x),
				(i.z -= r.z),
				this.setVertex(a, i);
		},
	})),
	(cc.flipX3D = function (t) {
		return new cc.FlipX3D(t);
	}),
	(cc.FlipX3D.create = cc.flipX3D),
	(cc.FlipY3D = cc.FlipX3D.extend({
		ctor: function (t) {
			void 0 !== t
				? cc.GridAction.prototype.ctor.call(this, t, cc.size(1, 1))
				: cc.GridAction.prototype.ctor.call(this);
		},
		update: function (t) {
			var e = Math.PI * t,
				i = Math.sin(e);
			e /= 2;
			var n = Math.cos(e),
				r = new cc.Vertex3F(),
				t = cc.p(0, 0);
			t.x = t.y = 1;
			e = this.originalVertex(t);
			t.x = t.y = 0;
			var o,
				s,
				c,
				a,
				t = this.originalVertex(t),
				e = e.y,
				t = t.y,
				t =
					t < e
						? ((o = cc.p(0, 0)),
						  (s = cc.p(0, 1)),
						  (c = cc.p(1, 0)),
						  (a = cc.p(1, 1)),
						  e)
						: ((s = cc.p(0, 0)),
						  (o = cc.p(0, 1)),
						  (a = cc.p(1, 0)),
						  (c = cc.p(1, 1)),
						  t);
			(r.y = t - t * n), (r.z = Math.abs(parseFloat(t * i) / 4));
			i = this.originalVertex(o);
			(i.y = r.y),
				(i.z += r.z),
				this.setVertex(o, i),
				((i = this.originalVertex(s)).y -= r.y),
				(i.z -= r.z),
				this.setVertex(s, i),
				((i = this.originalVertex(c)).y = r.y),
				(i.z += r.z),
				this.setVertex(c, i),
				((i = this.originalVertex(a)).y -= r.y),
				(i.z -= r.z),
				this.setVertex(a, i);
		},
	})),
	(cc.flipY3D = function (t) {
		return new cc.FlipY3D(t);
	}),
	(cc.FlipY3D.create = cc.flipY3D),
	(cc.Lens3D = cc.Grid3DAction.extend({
		_position: null,
		_radius: 0,
		_lensEffect: 0,
		_concave: !1,
		_dirty: !1,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				(this._position = cc.p(0, 0)),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		getLensEffect: function () {
			return this._lensEffect;
		},
		setLensEffect: function (t) {
			this._lensEffect = t;
		},
		setConcave: function (t) {
			this._concave = t;
		},
		getPosition: function () {
			return this._position;
		},
		setPosition: function (t) {
			cc.pointEqualToPoint(t, this._position) ||
				((this._position.x = t.x),
				(this._position.y = t.y),
				(this._dirty = !0));
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.Grid3DAction.prototype.initWithDuration.call(this, t, e) &&
				(this.setPosition(i),
				(this._radius = n),
				(this._lensEffect = 0.7),
				(this._dirty = !0))
			);
		},
		update: function (t) {
			if (this._dirty) {
				for (
					var e,
						i,
						n,
						r = this._gridSize.width,
						o = this._gridSize.height,
						s = this._radius,
						c = this._lensEffect,
						a = cc.p(0, 0),
						l = cc.p(0, 0),
						h = 0;
					h < r + 1;
					++h
				)
					for (var u = 0; u < o + 1; ++u)
						(a.x = h),
							(a.y = u),
							(e = this.originalVertex(a)),
							(l.x = this._position.x - e.x),
							(l.y = this._position.y - e.y),
							(i = cc.pLength(l)) < s &&
								(0 === (n = (s - i) / s) && (n = 0.001),
								(n = Math.log(n) * c),
								(n = Math.exp(n) * s),
								0 < (i = cc.pLength(l)) &&
									((l.x = l.x / i),
									(l.y = l.y / i),
									(l.x = l.x * n),
									(l.y = l.y * n),
									(e.z += cc.pLength(l) * c))),
							this.setVertex(a, e);
				this._dirty = !1;
			}
		},
	})),
	(cc.lens3D = function (t, e, i, n) {
		return new cc.Lens3D(t, e, i, n);
	}),
	(cc.Lens3D.create = cc.lens3D),
	(cc.Ripple3D = cc.Grid3DAction.extend({
		_position: null,
		_radius: 0,
		_waves: 0,
		_amplitude: 0,
		_amplitudeRate: 0,
		ctor: function (t, e, i, n, r, o) {
			cc.GridAction.prototype.ctor.call(this),
				(this._position = cc.p(0, 0)),
				void 0 !== o && this.initWithDuration(t, e, i, n, r, o);
		},
		getPosition: function () {
			return this._position;
		},
		setPosition: function (t) {
			(this._position.x = t.x), (this._position.y = t.y);
		},
		getAmplitude: function () {
			return this._amplitude;
		},
		setAmplitude: function (t) {
			this._amplitude = t;
		},
		getAmplitudeRate: function () {
			return this._amplitudeRate;
		},
		setAmplitudeRate: function (t) {
			this._amplitudeRate = t;
		},
		initWithDuration: function (t, e, i, n, r, o) {
			return (
				!!cc.Grid3DAction.prototype.initWithDuration.call(this, t, e) &&
				(this.setPosition(i),
				(this._radius = n),
				(this._waves = r),
				(this._amplitude = o),
				(this._amplitudeRate = 1),
				!0)
			);
		},
		update: function (t) {
			for (
				var e,
					i,
					n = this._gridSize.width,
					r = this._gridSize.height,
					o = cc.p(0, 0),
					s = this._radius,
					c = this._waves,
					a = this._amplitude,
					l = this._amplitudeRate,
					h = cc.p(0, 0),
					u = 0;
				u < n + 1;
				++u
			)
				for (var _, d = 0; d < r + 1; ++d)
					(o.x = u),
						(o.y = d),
						(e = this.originalVertex(o)),
						(h.x = this._position.x - e.x),
						(h.y = this._position.y - e.y),
						(i = cc.pLength(h)) < s &&
							((i = s - i),
							(_ = Math.pow(i / s, 2)),
							(e.z +=
								Math.sin(t * Math.PI * c * 2 + 0.1 * i) *
								a *
								l *
								_)),
						this.setVertex(o, e);
		},
	})),
	(cc.ripple3D = function (t, e, i, n, r, o) {
		return new cc.Ripple3D(t, e, i, n, r, o);
	}),
	(cc.Ripple3D.create = cc.ripple3D),
	(cc.Shaky3D = cc.Grid3DAction.extend({
		_randRange: 0,
		_shakeZ: !1,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.Grid3DAction.prototype.initWithDuration.call(this, t, e) &&
				((this._randRange = i), (this._shakeZ = n), !0)
			);
		},
		update: function (t) {
			for (
				var e,
					i = this._gridSize.width,
					n = this._gridSize.height,
					r = this._randRange,
					o = this._shakeZ,
					s = cc.p(0, 0),
					c = 0;
				c < i + 1;
				++c
			)
				for (var a = 0; a < n + 1; ++a)
					(s.x = c),
						(s.y = a),
						((e = this.originalVertex(s)).x +=
							(cc.rand() % (2 * r)) - r),
						(e.y += (cc.rand() % (2 * r)) - r),
						o && (e.z += (cc.rand() % (2 * r)) - r),
						this.setVertex(s, e);
		},
	})),
	(cc.shaky3D = function (t, e, i, n) {
		return new cc.Shaky3D(t, e, i, n);
	}),
	(cc.Shaky3D.create = cc.shaky3D),
	(cc.Liquid = cc.Grid3DAction.extend({
		_waves: 0,
		_amplitude: 0,
		_amplitudeRate: 0,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		getAmplitude: function () {
			return this._amplitude;
		},
		setAmplitude: function (t) {
			this._amplitude = t;
		},
		getAmplitudeRate: function () {
			return this._amplitudeRate;
		},
		setAmplitudeRate: function (t) {
			this._amplitudeRate = t;
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.Grid3DAction.prototype.initWithDuration.call(this, t, e) &&
				((this._waves = i),
				(this._amplitude = n),
				(this._amplitudeRate = 1),
				!0)
			);
		},
		update: function (t) {
			for (
				var e,
					i = this._gridSize.width,
					n = this._gridSize.height,
					r = cc.p(0, 0),
					o = this._waves,
					s = this._amplitude,
					c = this._amplitudeRate,
					a = 1;
				a < i;
				++a
			)
				for (var l = 1; l < n; ++l)
					(r.x = a),
						(r.y = l),
						((e = this.originalVertex(r)).x =
							e.x +
							Math.sin(t * Math.PI * o * 2 + 0.01 * e.x) * s * c),
						(e.y =
							e.y +
							Math.sin(t * Math.PI * o * 2 + 0.01 * e.y) * s * c),
						this.setVertex(r, e);
		},
	})),
	(cc.liquid = function (t, e, i, n) {
		return new cc.Liquid(t, e, i, n);
	}),
	(cc.Liquid.create = cc.liquid),
	(cc.Waves = cc.Grid3DAction.extend({
		_waves: 0,
		_amplitude: 0,
		_amplitudeRate: 0,
		_vertical: !1,
		_horizontal: !1,
		ctor: function (t, e, i, n, r, o) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== o && this.initWithDuration(t, e, i, n, r, o);
		},
		getAmplitude: function () {
			return this._amplitude;
		},
		setAmplitude: function (t) {
			this._amplitude = t;
		},
		getAmplitudeRate: function () {
			return this._amplitudeRate;
		},
		setAmplitudeRate: function (t) {
			this._amplitudeRate = t;
		},
		initWithDuration: function (t, e, i, n, r, o) {
			return (
				!!cc.Grid3DAction.prototype.initWithDuration.call(this, t, e) &&
				((this._waves = i),
				(this._amplitude = n),
				(this._amplitudeRate = 1),
				(this._horizontal = r),
				(this._vertical = o),
				!0)
			);
		},
		update: function (t) {
			for (
				var e,
					i = this._gridSize.width,
					n = this._gridSize.height,
					r = cc.p(0, 0),
					o = this._vertical,
					s = this._horizontal,
					c = this._waves,
					a = this._amplitude,
					l = this._amplitudeRate,
					h = 0;
				h < i + 1;
				++h
			)
				for (var u = 0; u < n + 1; ++u)
					(r.x = h),
						(r.y = u),
						(e = this.originalVertex(r)),
						o &&
							(e.x =
								e.x +
								Math.sin(t * Math.PI * c * 2 + 0.01 * e.y) *
									a *
									l),
						s &&
							(e.y =
								e.y +
								Math.sin(t * Math.PI * c * 2 + 0.01 * e.x) *
									a *
									l),
						this.setVertex(r, e);
		},
	})),
	(cc.waves = function (t, e, i, n, r, o) {
		return new cc.Waves(t, e, i, n, r, o);
	}),
	(cc.Waves.create = cc.waves),
	(cc.Twirl = cc.Grid3DAction.extend({
		_position: null,
		_twirls: 0,
		_amplitude: 0,
		_amplitudeRate: 0,
		ctor: function (t, e, i, n, r) {
			cc.GridAction.prototype.ctor.call(this),
				(this._position = cc.p(0, 0)),
				void 0 !== r && this.initWithDuration(t, e, i, n, r);
		},
		getPosition: function () {
			return this._position;
		},
		setPosition: function (t) {
			(this._position.x = t.x), (this._position.y = t.y);
		},
		getAmplitude: function () {
			return this._amplitude;
		},
		setAmplitude: function (t) {
			this._amplitude = t;
		},
		getAmplitudeRate: function () {
			return this._amplitudeRate;
		},
		setAmplitudeRate: function (t) {
			this._amplitudeRate = t;
		},
		initWithDuration: function (t, e, i, n, r) {
			return (
				!!cc.Grid3DAction.prototype.initWithDuration.call(this, t, e) &&
				(this.setPosition(i),
				(this._twirls = n),
				(this._amplitude = r),
				(this._amplitudeRate = 1),
				!0)
			);
		},
		update: function (t) {
			for (
				var e,
					i,
					n,
					r = this._position,
					o = this._gridSize.width,
					s = this._gridSize.height,
					c = cc.p(0, 0),
					a = 0.1 * this._amplitude * this._amplitudeRate,
					l = this._twirls,
					h = cc.p(0, 0),
					u = 0;
				u < o + 1;
				++u
			)
				for (var _ = 0; _ < s + 1; ++_)
					(c.x = u),
						(c.y = _),
						(e = this.originalVertex(c)),
						(h.x = u - o / 2),
						(h.y = _ - s / 2),
						(n =
							cc.pLength(h) *
							Math.cos(Math.PI / 2 + t * Math.PI * l * 2) *
							a),
						(i =
							Math.sin(n) * (e.y - r.y) +
							Math.cos(n) * (e.x - r.x)),
						(n =
							Math.cos(n) * (e.y - r.y) -
							Math.sin(n) * (e.x - r.x)),
						(e.x = r.x + i),
						(e.y = r.y + n),
						this.setVertex(c, e);
		},
	})),
	(cc.twirl = function (t, e, i, n, r) {
		return new cc.Twirl(t, e, i, n, r);
	}),
	(cc.Twirl.create = cc.twirl),
	(cc.ShakyTiles3D = cc.TiledGrid3DAction.extend({
		_randRange: 0,
		_shakeZ: !1,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					e
				) && ((this._randRange = i), (this._shakeZ = n), !0)
			);
		},
		update: function (t) {
			for (
				var e = this._gridSize,
					i = this._randRange,
					n = cc.p(0, 0),
					r = 0;
				r < e.width;
				++r
			)
				for (var o = 0; o < e.height; ++o) {
					(n.x = r), (n.y = o);
					var s = this.originalTile(n);
					(s.bl.x += (cc.rand() % (2 * i)) - i),
						(s.br.x += (cc.rand() % (2 * i)) - i),
						(s.tl.x += (cc.rand() % (2 * i)) - i),
						(s.tr.x += (cc.rand() % (2 * i)) - i),
						(s.bl.y += (cc.rand() % (2 * i)) - i),
						(s.br.y += (cc.rand() % (2 * i)) - i),
						(s.tl.y += (cc.rand() % (2 * i)) - i),
						(s.tr.y += (cc.rand() % (2 * i)) - i),
						this._shakeZ &&
							((s.bl.z += (cc.rand() % (2 * i)) - i),
							(s.br.z += (cc.rand() % (2 * i)) - i),
							(s.tl.z += (cc.rand() % (2 * i)) - i),
							(s.tr.z += (cc.rand() % (2 * i)) - i)),
						this.setTile(n, s);
				}
		},
	})),
	(cc.shakyTiles3D = function (t, e, i, n) {
		return new cc.ShakyTiles3D(t, e, i, n);
	}),
	(cc.ShakyTiles3D.create = cc.shakyTiles3D),
	(cc.ShatteredTiles3D = cc.TiledGrid3DAction.extend({
		_randRange: 0,
		_once: !1,
		_shatterZ: !1,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					e
				) &&
				((this._once = !1),
				(this._randRange = i),
				(this._shatterZ = n),
				!0)
			);
		},
		update: function (t) {
			if (!1 === this._once) {
				for (
					var e,
						i = this._gridSize,
						n = this._randRange,
						r = cc.p(0, 0),
						o = 0;
					o < i.width;
					++o
				)
					for (var s = 0; s < i.height; ++s)
						(r.x = o),
							(r.y = s),
							((e = this.originalTile(r)).bl.x +=
								(cc.rand() % (2 * n)) - n),
							(e.br.x += (cc.rand() % (2 * n)) - n),
							(e.tl.x += (cc.rand() % (2 * n)) - n),
							(e.tr.x += (cc.rand() % (2 * n)) - n),
							(e.bl.y += (cc.rand() % (2 * n)) - n),
							(e.br.y += (cc.rand() % (2 * n)) - n),
							(e.tl.y += (cc.rand() % (2 * n)) - n),
							(e.tr.y += (cc.rand() % (2 * n)) - n),
							this._shatterZ &&
								((e.bl.z += (cc.rand() % (2 * n)) - n),
								(e.br.z += (cc.rand() % (2 * n)) - n),
								(e.tl.z += (cc.rand() % (2 * n)) - n),
								(e.tr.z += (cc.rand() % (2 * n)) - n)),
							this.setTile(r, e);
				this._once = !0;
			}
		},
	})),
	(cc.shatteredTiles3D = function (t, e, i, n) {
		return new cc.ShatteredTiles3D(t, e, i, n);
	}),
	(cc.ShatteredTiles3D.create = cc.shatteredTiles3D),
	(cc.Tile = function (t, e, i) {
		(this.position = t || cc.p(0, 0)),
			(this.startPosition = e || cc.p(0, 0)),
			(this.delta = i || cc.p(0, 0));
	}),
	(cc.ShuffleTiles = cc.TiledGrid3DAction.extend({
		_seed: 0,
		_tilesCount: 0,
		_tilesOrder: null,
		_tiles: null,
		ctor: function (t, e, i) {
			cc.GridAction.prototype.ctor.call(this),
				(this._tilesOrder = []),
				(this._tiles = []),
				void 0 !== i && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					e
				) &&
				((this._seed = i),
				(this._tilesOrder.length = 0),
				!(this._tiles.length = 0))
			);
		},
		shuffle: function (t, e) {
			for (var i = e - 1; 0 <= i; i--) {
				var n = 0 | cc.rand() % (i + 1),
					r = t[i];
				(t[i] = t[n]), (t[n] = r);
			}
		},
		getDelta: function (t) {
			var e = this._gridSize,
				i = t.width * e.height + t.height;
			return cc.size(
				this._tilesOrder[i] / e.height - t.width,
				(this._tilesOrder[i] % e.height) - t.height
			);
		},
		placeTile: function (t, e) {
			var i = this.originalTile(t),
				n = this.target.grid.getStep(),
				e = e.position;
			(i.bl.x += e.x * n.x),
				(i.bl.y += e.y * n.y),
				(i.br.x += e.x * n.x),
				(i.br.y += e.y * n.y),
				(i.tl.x += e.x * n.x),
				(i.tl.y += e.y * n.y),
				(i.tr.x += e.x * n.x),
				(i.tr.y += e.y * n.y),
				this.setTile(t, i);
		},
		startWithTarget: function (t) {
			cc.TiledGrid3DAction.prototype.startWithTarget.call(this, t);
			var e = this._gridSize;
			this._tilesCount = e.width * e.height;
			for (
				var i = this._tilesOrder, n = (i.length = 0);
				n < this._tilesCount;
				++n
			)
				i[n] = n;
			this.shuffle(i, this._tilesCount);
			for (
				var r = this._tiles,
					o = (r.length = 0),
					s = cc.size(0, 0),
					c = 0;
				c < e.width;
				++c
			)
				for (var a = 0; a < e.height; ++a)
					(r[o] = new cc.Tile()),
						(r[o].position = cc.p(c, a)),
						(r[o].startPosition = cc.p(c, a)),
						(s.width = c),
						(s.height = a),
						(r[o].delta = this.getDelta(s)),
						++o;
		},
		update: function (t) {
			for (
				var e,
					i = 0,
					n = this._gridSize,
					r = this._tiles,
					o = cc.p(0, 0),
					s = 0;
				s < n.width;
				++s
			)
				for (var c = 0; c < n.height; ++c)
					(o.x = s),
						(o.y = c),
						((e = r[i]).position.x = e.delta.width * t),
						(e.position.y = e.delta.height * t),
						this.placeTile(o, e),
						++i;
		},
	})),
	(cc.shuffleTiles = function (t, e, i) {
		return new cc.ShuffleTiles(t, e, i);
	}),
	(cc.ShuffleTiles.create = cc.shuffleTiles),
	(cc.FadeOutTRTiles = cc.TiledGrid3DAction.extend({
		testFunc: function (t, e) {
			var i = this._gridSize.width * e,
				e = this._gridSize.height * e;
			return i === this._gridSize.width && e === this._gridSize.height
				? 0
				: i + e == 0
				? 1
				: Math.pow((t.x + t.y) / (i + e), 6);
		},
		turnOnTile: function (t) {
			this.setTile(t, this.originalTile(t));
		},
		turnOffTile: function (t) {
			this.setTile(t, new cc.Quad3());
		},
		transformTile: function (t, e) {
			var i = this.originalTile(t),
				n = this.target.grid.getStep();
			(i.bl.x += (n.x / 2) * (1 - e)),
				(i.bl.y += (n.y / 2) * (1 - e)),
				(i.br.x -= (n.x / 2) * (1 - e)),
				(i.br.y += (n.y / 2) * (1 - e)),
				(i.tl.x += (n.x / 2) * (1 - e)),
				(i.tl.y -= (n.y / 2) * (1 - e)),
				(i.tr.x -= (n.x / 2) * (1 - e)),
				(i.tr.y -= (n.y / 2) * (1 - e)),
				this.setTile(t, i);
		},
		update: function (t) {
			for (
				var e, i = this._gridSize, n = cc.p(0, 0), r = 0;
				r < i.width;
				++r
			)
				for (var o = 0; o < i.height; ++o)
					(n.x = r),
						(n.y = o),
						0 === (e = this.testFunc(n, t))
							? this.turnOffTile(n)
							: e < 1
							? this.transformTile(n, e)
							: this.turnOnTile(n);
		},
	})),
	(cc.fadeOutTRTiles = function (t, e) {
		return new cc.FadeOutTRTiles(t, e);
	}),
	(cc.FadeOutTRTiles.create = cc.fadeOutTRTiles),
	(cc.FadeOutBLTiles = cc.FadeOutTRTiles.extend({
		testFunc: function (t, e) {
			var i = this._gridSize.width * (1 - e),
				e = this._gridSize.height * (1 - e);
			return i + e == 0
				? 0
				: t.x + t.y === 0
				? 1
				: Math.pow((i + e) / (t.x + t.y), 6);
		},
	})),
	(cc.fadeOutBLTiles = function (t, e) {
		return new cc.FadeOutBLTiles(t, e);
	}),
	(cc.FadeOutBLTiles.create = cc.fadeOutBLTiles),
	(cc.FadeOutUpTiles = cc.FadeOutTRTiles.extend({
		testFunc: function (t, e) {
			e = this._gridSize.height * e;
			return e === this._gridSize.height
				? 0
				: 0 == e
				? 1
				: Math.pow(t.y / e, 6);
		},
		transformTile: function (t, e) {
			var i = this.originalTile(t),
				n = this.target.grid.getStep();
			(i.bl.y += (n.y / 2) * (1 - e)),
				(i.br.y += (n.y / 2) * (1 - e)),
				(i.tl.y -= (n.y / 2) * (1 - e)),
				(i.tr.y -= (n.y / 2) * (1 - e)),
				this.setTile(t, i);
		},
	})),
	(cc.fadeOutUpTiles = function (t, e) {
		return new cc.FadeOutUpTiles(t, e);
	}),
	(cc.FadeOutUpTiles.create = cc.fadeOutUpTiles),
	(cc.FadeOutDownTiles = cc.FadeOutUpTiles.extend({
		testFunc: function (t, e) {
			e = this._gridSize.height * (1 - e);
			return 0 == e ? 0 : 0 === t.y ? 1 : Math.pow(e / t.y, 6);
		},
	})),
	(cc.fadeOutDownTiles = function (t, e) {
		return new cc.FadeOutDownTiles(t, e);
	}),
	(cc.FadeOutDownTiles.create = cc.fadeOutDownTiles),
	(cc.TurnOffTiles = cc.TiledGrid3DAction.extend({
		_seed: null,
		_tilesCount: 0,
		_tilesOrder: null,
		ctor: function (t, e, i) {
			cc.GridAction.prototype.ctor.call(this),
				(this._tilesOrder = []),
				void 0 !== e && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					e
				) && ((this._seed = i || 0), !(this._tilesOrder.length = 0))
			);
		},
		shuffle: function (t, e) {
			for (var i = e - 1; 0 <= i; i--) {
				var n = 0 | cc.rand() % (i + 1),
					r = t[i];
				(t[i] = t[n]), (t[n] = r);
			}
		},
		turnOnTile: function (t) {
			this.setTile(t, this.originalTile(t));
		},
		turnOffTile: function (t) {
			this.setTile(t, new cc.Quad3());
		},
		startWithTarget: function (t) {
			cc.TiledGrid3DAction.prototype.startWithTarget.call(this, t),
				(this._tilesCount =
					this._gridSize.width * this._gridSize.height);
			for (
				var e = this._tilesOrder, i = (e.length = 0);
				i < this._tilesCount;
				++i
			)
				e[i] = i;
			this.shuffle(e, this._tilesCount);
		},
		update: function (t) {
			for (
				var e,
					i = 0 | (t * this._tilesCount),
					n = this._gridSize,
					r = cc.p(0, 0),
					o = this._tilesOrder,
					s = 0;
				s < this._tilesCount;
				s++
			)
				(e = o[s]),
					(r.x = 0 | (e / n.height)),
					(r.y = e % (0 | n.height)),
					s < i ? this.turnOffTile(r) : this.turnOnTile(r);
		},
	})),
	(cc.turnOffTiles = function (t, e, i) {
		return new cc.TurnOffTiles(t, e, i);
	}),
	(cc.TurnOffTiles.create = cc.turnOffTiles),
	(cc.WavesTiles3D = cc.TiledGrid3DAction.extend({
		_waves: 0,
		_amplitude: 0,
		_amplitudeRate: 0,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		getAmplitude: function () {
			return this._amplitude;
		},
		setAmplitude: function (t) {
			this._amplitude = t;
		},
		getAmplitudeRate: function () {
			return this._amplitudeRate;
		},
		setAmplitudeRate: function (t) {
			this._amplitudeRate = t;
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					e
				) &&
				((this._waves = i),
				(this._amplitude = n),
				(this._amplitudeRate = 1),
				!0)
			);
		},
		update: function (t) {
			for (
				var e,
					i = this._gridSize,
					n = this._waves,
					r = this._amplitude,
					o = this._amplitudeRate,
					s = cc.p(0, 0),
					c = 0;
				c < i.width;
				c++
			)
				for (var a = 0; a < i.height; a++)
					(s.x = c),
						(s.y = a),
						((e = this.originalTile(s)).bl.z =
							Math.sin(
								t * Math.PI * n * 2 + 0.01 * (e.bl.y + e.bl.x)
							) *
							r *
							o),
						(e.br.z = e.bl.z),
						(e.tl.z = e.bl.z),
						(e.tr.z = e.bl.z),
						this.setTile(s, e);
		},
	})),
	(cc.wavesTiles3D = function (t, e, i, n) {
		return new cc.WavesTiles3D(t, e, i, n);
	}),
	(cc.WavesTiles3D.create = cc.wavesTiles3D),
	(cc.JumpTiles3D = cc.TiledGrid3DAction.extend({
		_jumps: 0,
		_amplitude: 0,
		_amplitudeRate: 0,
		ctor: function (t, e, i, n) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== n && this.initWithDuration(t, e, i, n);
		},
		getAmplitude: function () {
			return this._amplitude;
		},
		setAmplitude: function (t) {
			this._amplitude = t;
		},
		getAmplitudeRate: function () {
			return this._amplitudeRate;
		},
		setAmplitudeRate: function (t) {
			this._amplitudeRate = t;
		},
		initWithDuration: function (t, e, i, n) {
			return (
				!!cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					e
				) &&
				((this._jumps = i),
				(this._amplitude = n),
				(this._amplitudeRate = 1),
				!0)
			);
		},
		update: function (t) {
			for (
				var e,
					i =
						Math.sin(Math.PI * t * this._jumps * 2) *
						this._amplitude *
						this._amplitudeRate,
					n =
						Math.sin(Math.PI * (t * this._jumps * 2 + 1)) *
						this._amplitude *
						this._amplitudeRate,
					r = this._gridSize,
					o = this.target.grid,
					s = cc.p(0, 0),
					c = 0;
				c < r.width;
				c++
			)
				for (var a = 0; a < r.height; a++)
					(s.x = c),
						(s.y = a),
						(e = o.originalTile(s)),
						(c + a) % 2 == 0
							? ((e.bl.z += i),
							  (e.br.z += i),
							  (e.tl.z += i),
							  (e.tr.z += i))
							: ((e.bl.z += n),
							  (e.br.z += n),
							  (e.tl.z += n),
							  (e.tr.z += n)),
						o.setTile(s, e);
		},
	})),
	(cc.jumpTiles3D = function (t, e, i, n) {
		return new cc.JumpTiles3D(t, e, i, n);
	}),
	(cc.JumpTiles3D.create = cc.jumpTiles3D),
	(cc.SplitRows = cc.TiledGrid3DAction.extend({
		_rows: 0,
		_winSize: null,
		ctor: function (t, e) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return (
				(this._rows = e),
				cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					cc.size(1, e)
				)
			);
		},
		update: function (t) {
			for (
				var e,
					i,
					n = this._gridSize,
					r = this._winSize.width,
					o = cc.p(0, 0),
					s = 0;
				s < n.height;
				++s
			)
				(i = 1),
					(o.y = s) % 2 == 0 && (i = -1),
					((e = this.originalTile(o)).bl.x += i * r * t),
					(e.br.x += i * r * t),
					(e.tl.x += i * r * t),
					(e.tr.x += i * r * t),
					this.setTile(o, e);
		},
		startWithTarget: function (t) {
			cc.TiledGrid3DAction.prototype.startWithTarget.call(this, t),
				(this._winSize = cc.director.getWinSizeInPixels());
		},
	})),
	(cc.splitRows = function (t, e) {
		return new cc.SplitRows(t, e);
	}),
	(cc.SplitRows.create = cc.splitRows),
	(cc.SplitCols = cc.TiledGrid3DAction.extend({
		_cols: 0,
		_winSize: null,
		ctor: function (t, e) {
			cc.GridAction.prototype.ctor.call(this),
				void 0 !== e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return (
				(this._cols = e),
				cc.TiledGrid3DAction.prototype.initWithDuration.call(
					this,
					t,
					cc.size(e, 1)
				)
			);
		},
		update: function (t) {
			for (
				var e,
					i,
					n = this._gridSize.width,
					r = this._winSize.height,
					o = cc.p(0, 0),
					s = 0;
				s < n;
				++s
			)
				(i = 1),
					(o.x = s) % 2 == 0 && (i = -1),
					((e = this.originalTile(o)).bl.y += i * r * t),
					(e.br.y += i * r * t),
					(e.tl.y += i * r * t),
					(e.tr.y += i * r * t),
					this.setTile(o, e);
			cc.renderer.childrenOrderDirty = !0;
		},
		startWithTarget: function (t) {
			cc.TiledGrid3DAction.prototype.startWithTarget.call(this, t),
				(this._winSize = cc.director.getWinSizeInPixels());
		},
	})),
	(cc.splitCols = function (t, e) {
		return new cc.SplitCols(t, e);
	}),
	(cc.SplitCols.create = cc.splitCols),
	(cc.PageTurn3D = cc.Grid3DAction.extend({
		getGrid: function () {
			var t = new cc.Grid3D(
				this._gridSize,
				void 0,
				void 0,
				this._gridNodeTarget.getGridRect()
			);
			return t.setNeedDepthTestForBlit(!0), t;
		},
		clone: function () {
			var t = new cc.PageTurn3D();
			return t.initWithDuration(this._duration, this._gridSize), t;
		},
		update: function (t) {
			for (
				var e = Math.max(0, t - 0.25),
					i = -100 - e * e * 500,
					e = Math.sqrt(t),
					e = 0.5 < e ? (Math.PI / 2) * e : (Math.PI / 2) * (1 - e),
					n = (2 - t) * Math.PI,
					r = Math.sin(e),
					o = Math.cos(e),
					s = this._gridSize,
					c = cc.p(0, 0),
					a = 0;
				a <= s.width;
				++a
			)
				for (var l = 0; l <= s.height; ++l) {
					(c.x = a), (c.y = l);
					var h = this.getOriginalVertex(c);
					h.x -= this.getGridRect().x;
					var u = Math.sqrt(h.x * h.x + (h.y - i) * (h.y - i)),
						_ = u * r,
						d = Math.asin(h.x / u) / r,
						p = Math.cos(d);
					d <= Math.PI ? (h.x = _ * Math.sin(d)) : (h.x = 0),
						(h.y = u + i - _ * (1 - p) * r),
						(h.z = _ * (1 - p) * o),
						(h.x = h.z * Math.sin(n) + h.x * Math.cos(n)),
						(h.z = h.z * Math.cos(n) - h.x * Math.cos(n)),
						(h.z /= 7),
						h.z < 0.5 && (h.z = 0.5),
						(h.x += this.getGridRect().x),
						this.setVertex(c, h);
				}
		},
	})),
	(cc.pageTurn3D = function (t, e) {
		return new cc.PageTurn3D(t, e);
	}),
	(cc.PageTurn3D.create = cc.pageTurn3D),
	(cc.ProgressTimer = cc.Node.extend({
		_type: null,
		_percentage: 0,
		_sprite: null,
		_midPoint: null,
		_barChangeRate: null,
		_reverseDirection: !1,
		_className: 'ProgressTimer',
		ctor: function (t) {
			cc.Node.prototype.ctor.call(this),
				(this._type = cc.ProgressTimer.TYPE_RADIAL),
				(this._percentage = 0),
				(this._midPoint = cc.p(0, 0)),
				(this._barChangeRate = cc.p(0, 0)),
				(this._reverseDirection = !1),
				(this._sprite = null),
				t && this.initWithSprite(t);
		},
		onEnter: function () {
			this._super(),
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					(this._renderCmd.initCmd(),
					this._renderCmd._updateProgress());
		},
		cleanup: function () {
			cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
				this._renderCmd.releaseData(),
				this._super();
		},
		getMidpoint: function () {
			return cc.p(this._midPoint.x, this._midPoint.y);
		},
		setMidpoint: function (t) {
			this._midPoint = cc.pClamp(t, cc.p(0, 0), cc.p(1, 1));
		},
		getBarChangeRate: function () {
			return cc.p(this._barChangeRate.x, this._barChangeRate.y);
		},
		setBarChangeRate: function (t) {
			this._barChangeRate = cc.pClamp(t, cc.p(0, 0), cc.p(1, 1));
		},
		getType: function () {
			return this._type;
		},
		getPercentage: function () {
			return this._percentage;
		},
		getSprite: function () {
			return this._sprite;
		},
		setPercentage: function (t) {
			this._percentage !== t &&
				((this._percentage = cc.clampf(t, 0, 100)),
				this._renderCmd._updateProgress());
		},
		setOpacityModifyRGB: function (t) {},
		isOpacityModifyRGB: function () {
			return !1;
		},
		isReverseDirection: function () {
			return this._reverseDirection;
		},
		setColor: function (t) {
			(this._sprite.color = t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);
		},
		setOpacity: function (t) {
			(this._sprite.opacity = t),
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty);
		},
		getColor: function () {
			return this._sprite.color;
		},
		getOpacity: function () {
			return this._sprite.opacity;
		},
		setReverseProgress: function (t) {
			this._reverseDirection !== t &&
				((this._reverseDirection = t),
				this._renderCmd.resetVertexData());
		},
		setSprite: function (t) {
			this._sprite !== t &&
				((this._sprite = t)
					? (this.setContentSize(t.width, t.height),
					  t.ignoreAnchorPointForPosition(!0))
					: this.setContentSize(0, 0),
				this._renderCmd.resetVertexData());
		},
		setType: function (t) {
			t !== this._type &&
				((this._type = t), this._renderCmd.resetVertexData());
		},
		setReverseDirection: function (t) {
			this._reverseDirection !== t &&
				((this._reverseDirection = t),
				this._renderCmd.resetVertexData());
		},
		initWithSprite: function (t) {
			return (
				(this.percentage = 0),
				this.setAnchorPoint(0.5, 0.5),
				(this._type = cc.ProgressTimer.TYPE_RADIAL),
				(this._reverseDirection = !1),
				(this.midPoint = cc.p(0.5, 0.5)),
				(this.barChangeRate = cc.p(1, 1)),
				this.setSprite(t),
				this._renderCmd.resetVertexData(),
				!0
			);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.ProgressTimer.CanvasRenderCmd
					: cc.ProgressTimer.WebGLRenderCmd
			)(this);
		},
	}));
var _p = cc.ProgressTimer.prototype;
_p.midPoint,
	cc.defineGetterSetter(_p, 'midPoint', _p.getMidpoint, _p.setMidpoint),
	_p.barChangeRate,
	cc.defineGetterSetter(
		_p,
		'barChangeRate',
		_p.getBarChangeRate,
		_p.setBarChangeRate
	),
	_p.type,
	cc.defineGetterSetter(_p, 'type', _p.getType, _p.setType),
	_p.percentage,
	cc.defineGetterSetter(_p, 'percentage', _p.getPercentage, _p.setPercentage),
	_p.sprite,
	cc.defineGetterSetter(_p, 'sprite', _p.getSprite, _p.setSprite),
	_p.reverseDir,
	cc.defineGetterSetter(
		_p,
		'reverseDir',
		_p.isReverseDirection,
		_p.setReverseDirection
	),
	(cc.ProgressTimer.create = function (t) {
		return new cc.ProgressTimer(t);
	}),
	(cc.ProgressTimer.TEXTURE_COORDS_COUNT = 4),
	(cc.ProgressTimer.TEXTURE_COORDS = 75),
	(cc.ProgressTimer.TYPE_RADIAL = 0),
	(cc.ProgressTimer.TYPE_BAR = 1),
	(function () {
		cc.ProgressTimer.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._PI180 = Math.PI / 180),
				(this._barRect = cc.rect(0, 0, 0, 0)),
				(this._origin = cc.p(0, 0)),
				(this._radius = 0),
				(this._startAngle = 270),
				(this._endAngle = 270),
				(this._counterClockWise = !1),
				(this._canUseDirtyRegion = !0);
		};
		var t = (cc.ProgressTimer.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.ProgressTimer.CanvasRenderCmd),
			(t.rendering = function (t, e, i) {
				var n,
					r,
					o = t || cc._renderContext,
					s = o.getContext(),
					c = this._node,
					a = c._sprite,
					l = a._renderCmd._textureCoord,
					h = a._renderCmd._displayedOpacity / 255;
				0 !== l.width &&
					0 !== l.height &&
					a._texture &&
					l.validRect &&
					0 != h &&
					(o.setTransform(this._worldTransform, e, i),
					o.setCompositeOperation(a._blendFuncStr),
					o.setGlobalAlpha(h),
					(n = a._rect),
					(e = (t = a._offsetPosition).x),
					(i = -t.y - n.height),
					(h = n.width),
					(n = n.height),
					o.save(),
					a._flippedX && ((e = -e - h), s.scale(-1, 1)),
					a._flippedY && ((i = t.y), s.scale(1, -1)),
					c._type === cc.ProgressTimer.TYPE_BAR
						? ((t = this._barRect),
						  s.beginPath(),
						  s.rect(t.x, t.y, t.width, t.height),
						  s.clip(),
						  s.closePath())
						: c._type === cc.ProgressTimer.TYPE_RADIAL &&
						  ((c = this._origin.x),
						  (r = this._origin.y),
						  s.beginPath(),
						  s.arc(
								c,
								r,
								this._radius,
								this._PI180 * this._startAngle,
								this._PI180 * this._endAngle,
								this._counterClockWise
						  ),
						  s.lineTo(c, r),
						  s.clip(),
						  s.closePath()),
					(r = (
						a._renderCmd._textureToRender || a._texture
					).getHtmlElementObj()),
					a._renderCmd._colorized
						? s.drawImage(r, 0, 0, l.width, l.height, e, i, h, n)
						: s.drawImage(
								r,
								l.renderX,
								l.renderY,
								l.width,
								l.height,
								e,
								i,
								h,
								n
						  ),
					o.restore(),
					cc.g_NumberOfDraws++);
			}),
			(t.releaseData = function () {}),
			(t.resetVertexData = function () {}),
			(t._updateProgress = function () {
				this.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);
				var t,
					e,
					i,
					n,
					r = this._node,
					o = r._sprite,
					s = o.width,
					c = o.height,
					a = r._midPoint;
				r._type === cc.ProgressTimer.TYPE_RADIAL
					? ((this._radius = Math.round(Math.sqrt(s * s + c * c))),
					  (e = !1),
					  ((t = this._origin).x = s * a.x),
					  (t.y = -c * a.y),
					  r._reverseDirection
							? (n = (i = 270) - 3.6 * r._percentage)
							: ((n = -90), (i = 3.6 * r._percentage - 90)),
					  o._flippedX &&
							((t.x -= s * (2 * r._midPoint.x)),
							(n = -n),
							(i = -i),
							(n -= 180),
							(i -= 180),
							(e = !e)),
					  o._flippedY &&
							((t.y += c * (2 * r._midPoint.y)),
							(e = !e),
							(n = -n),
							(i = -i)),
					  (this._startAngle = n),
					  (this._endAngle = i),
					  (this._counterClockWise = e))
					: ((n = r._barChangeRate),
					  (i = r._percentage / 100),
					  (e = this._barRect),
					  (r = cc.size(s * (1 - n.x), c * (1 - n.y))),
					  (n = cc.size((s - r.width) * i, (c - r.height) * i)),
					  (i = cc.size(r.width + n.width, r.height + n.height)),
					  (n = (r = cc.p(s * a.x, c * a.y)).x - i.width / 2),
					  0.5 < a.x && i.width / 2 >= s - r.x && (n = s - i.width),
					  (s = r.y - i.height / 2),
					  0.5 < a.y &&
							i.height / 2 >= c - r.y &&
							(s = c - i.height),
					  (e.x = 0),
					  (c = 1),
					  o._flippedX && ((e.x -= i.width), (c = -1)),
					  0 < n && (e.x += n * c),
					  (e.y = 0),
					  (c = 1),
					  o._flippedY && ((e.y += i.height), (c = -1)),
					  0 < s && (e.y -= s * c),
					  (e.width = i.width),
					  (e.height = -i.height));
			}),
			(t._syncStatus = function (t) {
				var e,
					i,
					n,
					r,
					o = this._node;
				o._sprite &&
					((e = cc.Node._dirtyFlags),
					(i = this._dirtyFlag),
					(r = t ? t._node : null) &&
						r._cascadeColorEnabled &&
						t._dirtyFlag & e.colorDirty &&
						(i |= e.colorDirty),
					r &&
						r._cascadeOpacityEnabled &&
						t._dirtyFlag & e.opacityDirty &&
						(i |= e.opacityDirty),
					t &&
						t._dirtyFlag & e.transformDirty &&
						(i |= e.transformDirty),
					(this._dirtyFlag = i),
					(o =
						(r = (n = o._sprite._renderCmd)._dirtyFlag) &
						e.colorDirty),
					(r = r & e.opacityDirty),
					o &&
						(n._syncDisplayColor(),
						(n._dirtyFlag =
							(n._dirtyFlag & e.colorDirty) ^ n._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & e.colorDirty) ^
							this._dirtyFlag)),
					r &&
						(n._syncDisplayOpacity(),
						(n._dirtyFlag =
							(n._dirtyFlag & e.opacityDirty) ^ n._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & e.opacityDirty) ^
							this._dirtyFlag)),
					(o || r) && n._updateColor(),
					i & e.transformDirty && this.transform(t),
					i & e.orderDirty &&
						(this._dirtyFlag =
							(this._dirtyFlag & e.orderDirty) ^
							this._dirtyFlag));
			}),
			(t.updateStatus = function () {
				var t,
					e,
					i,
					n,
					r = this._node;
				r._sprite &&
					((t = cc.Node._dirtyFlags),
					(e = this._dirtyFlag),
					(r =
						(n = (i = r._sprite._renderCmd)._dirtyFlag) &
						t.colorDirty),
					(n = n & t.opacityDirty),
					r &&
						(i._updateDisplayColor(),
						(i._dirtyFlag =
							(i._dirtyFlag & t.colorDirty) ^ i._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & t.colorDirty) ^
							this._dirtyFlag)),
					n &&
						(i._updateDisplayOpacity(),
						(i._dirtyFlag =
							(i._dirtyFlag & t.opacityDirty) ^ i._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & t.opacityDirty) ^
							this._dirtyFlag)),
					(r || n) && i._updateColor(),
					e & t.transformDirty &&
						this.transform(this.getParentRenderCmd(), !0),
					e & t.contentDirty &&
						this._notifyRegionStatus &&
						this._notifyRegionStatus(
							cc.Node.CanvasRenderCmd.RegionStatus.Dirty
						),
					(this._dirtyFlag = 0));
			});
	})(),
	(cc.ProgressTo = cc.ActionInterval.extend({
		_to: 0,
		_from: 0,
		ctor: function (t, e) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._to = 0),
				void (this._from = 0) !== e && this.initWithDuration(t, e);
		},
		initWithDuration: function (t, e) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._to = e), !0)
			);
		},
		clone: function () {
			var t = new cc.ProgressTo();
			return t.initWithDuration(this._duration, this._to), t;
		},
		reverse: function () {
			return (
				cc.log(
					"cc.ProgressTo.reverse(): reverse hasn't been supported."
				),
				null
			);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._from = t.percentage);
		},
		update: function (t) {
			this.target instanceof cc.ProgressTimer &&
				(this.target.percentage =
					this._from + (this._to - this._from) * t);
		},
	})),
	(cc.progressTo = function (t, e) {
		return new cc.ProgressTo(t, e);
	}),
	(cc.ProgressTo.create = cc.progressTo),
	(cc.ProgressFromTo = cc.ActionInterval.extend({
		_to: 0,
		_from: 0,
		ctor: function (t, e, i) {
			cc.ActionInterval.prototype.ctor.call(this),
				(this._to = 0),
				void (this._from = 0) !== i && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._to = i), (this._from = e), !0)
			);
		},
		clone: function () {
			var t = new cc.ProgressFromTo();
			return t.initWithDuration(this._duration, this._from, this._to), t;
		},
		reverse: function () {
			return cc.progressFromTo(this._duration, this._to, this._from);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t);
		},
		update: function (t) {
			this.target instanceof cc.ProgressTimer &&
				(this.target.percentage =
					this._from + (this._to - this._from) * t);
		},
	})),
	(cc.progressFromTo = function (t, e, i) {
		return new cc.ProgressFromTo(t, e, i);
	}),
	(cc.ProgressFromTo.create = cc.progressFromTo),
	(function () {
		cc.ProgressTimer.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._progressDirty = !0),
				(this._bl = cc.p()),
				(this._tr = cc.p()),
				this.initCmd();
		};
		var t = (cc.ProgressTimer.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.ProgressTimer.WebGLRenderCmd),
			(t.transform = function (t, e) {
				this.originTransform(t, e);
				var i = this._node._sprite;
				i._renderCmd.transform(this, e);
				var n = i._offsetPosition.x,
					r = n + i._rect.width,
					t = i._offsetPosition.y,
					e = t + i._rect.height,
					i = this._worldTransform;
				(this._bl.x = n * i.a + t * i.c + i.tx),
					(this._bl.y = n * i.b + t * i.d + i.ty),
					(this._tr.x = r * i.a + e * i.c + i.tx),
					(this._tr.y = r * i.b + e * i.d + i.ty),
					this._updateProgressData();
			}),
			(t.rendering = function (t) {
				var e = this._node,
					i = t || cc._renderContext;
				0 !== this._vertexDataCount &&
					e._sprite &&
					(this._shaderProgram.use(),
					this._shaderProgram._updateProjectionUniform(),
					(t = e._sprite._blendFunc),
					cc.glBlendFunc(t.src, t.dst),
					cc.glBindTexture2D(e._sprite.texture),
					i.bindBuffer(i.ARRAY_BUFFER, this._vertexWebGLBuffer),
					i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
					i.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
					i.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
					this._vertexDataDirty &&
						(i.bufferSubData(i.ARRAY_BUFFER, 0, this._float32View),
						(this._vertexDataDirty = !1)),
					(t = cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),
					i.vertexAttribPointer(
						cc.VERTEX_ATTRIB_POSITION,
						3,
						i.FLOAT,
						!1,
						t,
						0
					),
					i.vertexAttribPointer(
						cc.VERTEX_ATTRIB_COLOR,
						4,
						i.UNSIGNED_BYTE,
						!0,
						t,
						12
					),
					i.vertexAttribPointer(
						cc.VERTEX_ATTRIB_TEX_COORDS,
						2,
						i.FLOAT,
						!1,
						t,
						16
					),
					e._type === cc.ProgressTimer.TYPE_RADIAL
						? i.drawArrays(i.TRIANGLE_FAN, 0, this._vertexDataCount)
						: e._type === cc.ProgressTimer.TYPE_BAR &&
						  (e._reverseDirection
								? (i.drawArrays(
										i.TRIANGLE_STRIP,
										0,
										this._vertexDataCount / 2
								  ),
								  i.drawArrays(
										i.TRIANGLE_STRIP,
										4,
										this._vertexDataCount / 2
								  ),
								  cc.g_NumberOfDraws++)
								: i.drawArrays(
										i.TRIANGLE_STRIP,
										0,
										this._vertexDataCount
								  )),
					cc.g_NumberOfDraws++);
			}),
			(t._syncStatus = function (t) {
				var e,
					i,
					n,
					r,
					o = this._node;
				o._sprite &&
					((e = cc.Node._dirtyFlags),
					(i = this._dirtyFlag),
					(r = t ? t._node : null) &&
						r._cascadeColorEnabled &&
						t._dirtyFlag & e.colorDirty &&
						(i |= e.colorDirty),
					r &&
						r._cascadeOpacityEnabled &&
						t._dirtyFlag & e.opacityDirty &&
						(i |= e.opacityDirty),
					t &&
						t._dirtyFlag & e.transformDirty &&
						(i |= e.transformDirty),
					(o =
						((this._dirtyFlag = i) |
							(r = (n = o._sprite._renderCmd)._dirtyFlag)) &
						e.colorDirty),
					(r = (i | r) & e.opacityDirty),
					o &&
						(n._syncDisplayColor(),
						(n._dirtyFlag =
							(n._dirtyFlag & e.colorDirty) ^ n._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & e.colorDirty) ^
							this._dirtyFlag)),
					r &&
						(n._syncDisplayOpacity(),
						(n._dirtyFlag =
							(n._dirtyFlag & e.opacityDirty) ^ n._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & e.opacityDirty) ^
							this._dirtyFlag)),
					(o || r) && this._updateColor(),
					i & e.transformDirty && this.transform(t),
					i & e.textureDirty &&
						(this._updateProgressData(),
						(this._dirtyFlag =
							(this._dirtyFlag & e.textureDirty) ^
							this._dirtyFlag)),
					(n._dirtyFlag = 0));
			}),
			(t.updateStatus = function () {
				var t,
					e,
					i,
					n,
					r = this._node;
				r._sprite &&
					((t = cc.Node._dirtyFlags),
					(r =
						((e = this._dirtyFlag) |
							(n = (i = r._sprite._renderCmd)._dirtyFlag)) &
						t.colorDirty),
					(n = (e | n) & t.opacityDirty),
					r &&
						(i._updateDisplayColor(),
						(i._dirtyFlag =
							(i._dirtyFlag & t.colorDirty) ^ i._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & t.colorDirty) ^
							this._dirtyFlag)),
					n &&
						(i._updateDisplayOpacity(),
						(i._dirtyFlag =
							(i._dirtyFlag & t.opacityDirty) ^ i._dirtyFlag),
						(this._dirtyFlag =
							(this._dirtyFlag & t.opacityDirty) ^
							this._dirtyFlag)),
					(r || n) && this._updateColor(),
					e & t.transformDirty &&
						this.transform(this.getParentRenderCmd(), !0),
					e & t.orderDirty &&
						(this._dirtyFlag =
							(this._dirtyFlag & t.orderDirty) ^ this._dirtyFlag),
					e & t.textureDirty &&
						(this._updateProgressData(),
						(this._dirtyFlag =
							(this._dirtyFlag & t.textureDirty) ^
							this._dirtyFlag)));
			}),
			(t.releaseData = function () {
				var t;
				this._vertexData &&
					((t = this._vertexWebGLBuffer),
					setTimeout(function () {
						cc._renderContext.deleteBuffer(t);
					}, 0.1),
					(this._vertexWebGLBuffer = null),
					(this._vertexData = null),
					(this._float32View = null),
					(this._vertexArrayBuffer = null),
					(this._vertexDataCount = 0));
			}),
			(t.initCmd = function () {
				if (!this._vertexData) {
					this._vertexWebGLBuffer = cc._renderContext.createBuffer();
					var t = cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;
					(this._vertexArrayBuffer = new ArrayBuffer(8 * t)),
						(this._float32View = new Float32Array(
							this._vertexArrayBuffer
						)),
						(this._vertexData = []);
					for (var e = 0; e < 8; e++)
						this._vertexData[e] = new cc.V3F_C4B_T2F(
							null,
							null,
							null,
							this._vertexArrayBuffer,
							e * t
						);
					gl.bindBuffer(gl.ARRAY_BUFFER, this._vertexWebGLBuffer),
						gl.bufferData(
							gl.ARRAY_BUFFER,
							this._float32View,
							gl.DYNAMIC_DRAW
						),
						(this._vertexDataCount = 0),
						(this._vertexDataDirty = !0),
						(this._shaderProgram = cc.shaderCache.programForKey(
							cc.SHADER_SPRITE_POSITION_TEXTURECOLOR
						));
				}
			}),
			(t.resetVertexData = function () {
				this._vertexDataCount = 0;
			}),
			(t._updateProgressData = function () {
				var t = this._node._type;
				t === cc.ProgressTimer.TYPE_RADIAL
					? this._updateRadial()
					: t === cc.ProgressTimer.TYPE_BAR && this._updateBar(),
					(this._vertexDataDirty = !0);
			}),
			(t._updateProgress = function () {
				this.setDirtyFlag(cc.Node._dirtyFlags.textureDirty);
			}),
			(t._updateBar = function () {
				var t,
					e,
					i,
					n = this._node;
				n._sprite &&
					((e = n._percentage / 100),
					(t = n._barChangeRate),
					(e = cc.pMult(
						cc.p(1 - t.x + e * t.x, 1 - t.y + e * t.y),
						0.5
					)),
					(t = cc.pSub(n._midPoint, e)),
					(e = cc.pAdd(n._midPoint, e)),
					t.x < 0 && ((e.x += -t.x), (t.x = 0)),
					1 < e.x && ((t.x -= e.x - 1), (e.x = 1)),
					t.y < 0 && ((e.y += -t.y), (t.y = 0)),
					1 < e.y && ((t.y -= e.y - 1), (e.y = 1)),
					this._reverseDirection
						? ((i = this._vertexData),
						  this._vertexDataCount ||
								((this._vertexDataCount = 8),
								this._textureCoordFromAlphaPoint(
									i[0].texCoords,
									0,
									1
								),
								this._vertexFromAlphaPoint(i[0].vertices, 0, 1),
								this._textureCoordFromAlphaPoint(
									i[1].texCoords,
									0,
									0
								),
								this._vertexFromAlphaPoint(i[1].vertices, 0, 0),
								this._textureCoordFromAlphaPoint(
									i[6].texCoords,
									1,
									1
								),
								this._vertexFromAlphaPoint(i[6].vertices, 1, 1),
								this._textureCoordFromAlphaPoint(
									i[7].texCoords,
									1,
									0
								),
								this._vertexFromAlphaPoint(
									i[7].vertices,
									1,
									0
								)),
						  this._textureCoordFromAlphaPoint(
								i[2].texCoords,
								t.x,
								e.y
						  ),
						  this._vertexFromAlphaPoint(i[2].vertices, t.x, e.y),
						  this._textureCoordFromAlphaPoint(
								i[3].texCoords,
								t.x,
								t.y
						  ),
						  this._vertexFromAlphaPoint(i[3].vertices, t.x, t.y),
						  this._textureCoordFromAlphaPoint(
								i[4].texCoords,
								e.x,
								e.y
						  ),
						  this._vertexFromAlphaPoint(i[4].vertices, e.x, e.y),
						  this._textureCoordFromAlphaPoint(
								i[5].texCoords,
								e.x,
								t.y
						  ),
						  this._vertexFromAlphaPoint(i[5].vertices, e.x, t.y))
						: (this._vertexDataCount || (this._vertexDataCount = 4),
						  (i = this._vertexData),
						  this._textureCoordFromAlphaPoint(
								i[0].texCoords,
								t.x,
								e.y
						  ),
						  this._vertexFromAlphaPoint(i[0].vertices, t.x, e.y),
						  this._textureCoordFromAlphaPoint(
								i[1].texCoords,
								t.x,
								t.y
						  ),
						  this._vertexFromAlphaPoint(i[1].vertices, t.x, t.y),
						  this._textureCoordFromAlphaPoint(
								i[2].texCoords,
								e.x,
								e.y
						  ),
						  this._vertexFromAlphaPoint(i[2].vertices, e.x, e.y),
						  this._textureCoordFromAlphaPoint(
								i[3].texCoords,
								e.x,
								t.y
						  ),
						  this._vertexFromAlphaPoint(i[3].vertices, e.x, t.y)),
					this._updateColor());
			}),
			(t._updateRadial = function () {
				var t = this._node;
				if (t._sprite) {
					var e,
						i = t._midPoint,
						n = t._percentage / 100,
						r = 2 * cc.PI * (t._reverseDirection ? n : 1 - n),
						t = cc.p(i.x, 1),
						o = cc.pRotateByAngle(t, i, r),
						s = 0;
					if (0 == n) (e = t), (s = 0);
					else if (1 == n) (e = t), (s = 4);
					else {
						for (
							var c = cc.FLT_MAX,
								a = cc.ProgressTimer.TEXTURE_COORDS_COUNT,
								l = 0;
							l <= a;
							++l
						) {
							var h = (l + (a - 1)) % a,
								u = this._boundaryTexCoord(l % a),
								_ = this._boundaryTexCoord(h);
							0 === l
								? (_ = cc.pLerp(u, _, 1 - i.x))
								: 4 === l && (u = cc.pLerp(u, _, 1 - i.x));
							h = cc.p(0, 0);
							cc.pLineIntersect(u, _, i, o, h) &&
								((0 !== l && 4 !== l) ||
									(0 <= h.x && h.x <= 1)) &&
								0 <= h.y &&
								h.y < c &&
								((c = h.y), (s = l));
						}
						e = cc.pAdd(i, cc.pMult(cc.pSub(o, i), c));
					}
					n = !0;
					this._vertexDataCount !== s + 3 &&
						((n = !1), (this._vertexDataCount = s + 3)),
						this._updateColor();
					var d = this._vertexData;
					if (!n)
						for (
							this._textureCoordFromAlphaPoint(
								d[0].texCoords,
								i.x,
								i.y
							),
								this._vertexFromAlphaPoint(
									d[0].vertices,
									i.x,
									i.y
								),
								this._textureCoordFromAlphaPoint(
									d[1].texCoords,
									t.x,
									t.y
								),
								this._vertexFromAlphaPoint(
									d[1].vertices,
									t.x,
									t.y
								),
								l = 0;
							l < s;
							l++
						) {
							var p = this._boundaryTexCoord(l);
							this._textureCoordFromAlphaPoint(
								d[l + 2].texCoords,
								p.x,
								p.y
							),
								this._vertexFromAlphaPoint(
									d[l + 2].vertices,
									p.x,
									p.y
								);
						}
					this._textureCoordFromAlphaPoint(
						d[this._vertexDataCount - 1].texCoords,
						e.x,
						e.y
					),
						this._vertexFromAlphaPoint(
							d[this._vertexDataCount - 1].vertices,
							e.x,
							e.y
						);
				}
			}),
			(t._boundaryTexCoord = function (t) {
				if (t < cc.ProgressTimer.TEXTURE_COORDS_COUNT) {
					var e = cc.ProgressTimer.TEXTURE_COORDS;
					return this._node._reverseDirection
						? cc.p(
								(e >> (7 - (t << 1))) & 1,
								(e >> (7 - (1 + (t << 1)))) & 1
						  )
						: cc.p((e >> (1 + (t << 1))) & 1, (e >> (t << 1)) & 1);
				}
				return cc.p(0, 0);
			}),
			(t._textureCoordFromAlphaPoint = function (t, e, i) {
				var n = this._node._sprite;
				if (!n) return (t.u = 0), void (t.v = 0);
				var r = n._renderCmd._vertices,
					o = r[1],
					r = r[2],
					o = cc.p(o.u, o.v),
					r = cc.p(r.u, r.v);
				n.textureRectRotated && ((n = e), (e = i), (i = n)),
					(t.u = o.x * (1 - e) + r.x * e),
					(t.v = o.y * (1 - i) + r.y * i);
			}),
			(t._vertexFromAlphaPoint = function (t, e, i) {
				(t.x = this._bl.x * (1 - e) + this._tr.x * e),
					(t.y = this._bl.y * (1 - i) + this._tr.y * i),
					(t.z = this._node._vertexZ);
			}),
			(t._updateColor = function () {
				var t = this._node._sprite;
				if (this._vertexDataCount && t) {
					var e = this._displayedColor,
						i = t._renderCmd._displayedColor,
						n = i.r,
						r = i.g,
						o = i.b,
						i = t._renderCmd._displayedOpacity / 255;
					t._opacityModifyRGB && ((n *= i), (r *= i), (o *= i)),
						(e.r = n),
						(e.g = r),
						(e.b = o),
						(e.a = t._renderCmd._displayedOpacity);
					for (
						var s = this._vertexData,
							c = 0,
							a = this._vertexDataCount;
						c < a;
						++c
					)
						s[c].colors = e;
					this._vertexDataDirty = !0;
				}
			});
	})(),
	(cc.SCENE_FADE = 4208917214),
	(cc.TRANSITION_ORIENTATION_LEFT_OVER = 0),
	(cc.TRANSITION_ORIENTATION_RIGHT_OVER = 1),
	(cc.TRANSITION_ORIENTATION_UP_OVER = 0),
	(cc.TRANSITION_ORIENTATION_DOWN_OVER = 1),
	(cc.TransitionScene = cc.Scene.extend({
		_inScene: null,
		_outScene: null,
		_duration: null,
		_isInSceneOnTop: !1,
		_isSendCleanupToScene: !1,
		_className: 'TransitionScene',
		ctor: function (t, e) {
			cc.Scene.prototype.ctor.call(this),
				void 0 !== t && void 0 !== e && this.initWithDuration(t, e);
		},
		_setNewScene: function (t) {
			this.unschedule(this._setNewScene);
			var e = cc.director;
			(this._isSendCleanupToScene = e.isSendCleanupToScene()),
				e.runScene(this._inScene),
				cc.eventManager.setEnabled(!0),
				(this._outScene.visible = !0);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !0;
		},
		visit: function () {
			this._isInSceneOnTop
				? (this._outScene.visit(), this._inScene.visit())
				: (this._inScene.visit(), this._outScene.visit()),
				cc.Node.prototype.visit.call(this);
		},
		onEnter: function () {
			cc.Node.prototype.onEnter.call(this),
				cc.eventManager.setEnabled(!1),
				this._outScene.onExitTransitionDidStart(),
				this._inScene.onEnter();
		},
		onExit: function () {
			cc.Node.prototype.onExit.call(this),
				cc.eventManager.setEnabled(!0),
				this._outScene.onExit(),
				this._inScene.onEnterTransitionDidFinish();
		},
		cleanup: function () {
			cc.Node.prototype.cleanup.call(this),
				this._isSendCleanupToScene && this._outScene.cleanup();
		},
		initWithDuration: function (t, e) {
			if (!e)
				throw new Error(
					'cc.TransitionScene.initWithDuration(): Argument scene must be non-nil'
				);
			if (this.init()) {
				if (
					((this._duration = t),
					this.attr({ x: 0, y: 0, anchorX: 0, anchorY: 0 }),
					(this._inScene = e),
					(this._outScene = cc.director.getRunningScene()),
					this._outScene ||
						((this._outScene = new cc.Scene()),
						this._outScene.init()),
					this._inScene === this._outScene)
				)
					throw new Error(
						'cc.TransitionScene.initWithDuration(): Incoming scene must be different from the outgoing scene'
					);
				return this._sceneOrder(), !0;
			}
			return !1;
		},
		finish: function () {
			this._inScene.attr({
				visible: !0,
				x: 0,
				y: 0,
				scale: 1,
				rotation: 0,
			}),
				this._outScene.attr({
					visible: !1,
					x: 0,
					y: 0,
					scale: 1,
					rotation: 0,
				}),
				this.schedule(this._setNewScene, 0);
		},
		hideOutShowIn: function () {
			(this._inScene.visible = !0), (this._outScene.visible = !1);
		},
	})),
	(cc.TransitionScene.create = function (t, e) {
		return new cc.TransitionScene(t, e);
	}),
	(cc.TransitionSceneOriented = cc.TransitionScene.extend({
		_orientation: 0,
		ctor: function (t, e, i) {
			cc.TransitionScene.prototype.ctor.call(this),
				null != i && this.initWithDuration(t, e, i);
		},
		initWithDuration: function (t, e, i) {
			return (
				cc.TransitionScene.prototype.initWithDuration.call(
					this,
					t,
					e
				) && (this._orientation = i),
				!0
			);
		},
	})),
	(cc.TransitionSceneOriented.create = function (t, e, i) {
		return new cc.TransitionSceneOriented(t, e, i);
	}),
	(cc.TransitionRotoZoom = cc.TransitionScene.extend({
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this),
				this._inScene.attr({
					scale: 0.001,
					anchorX: 0.5,
					anchorY: 0.5,
				}),
				this._outScene.attr({ scale: 1, anchorX: 0.5, anchorY: 0.5 });
			var t = cc.sequence(
				cc.spawn(
					cc.scaleBy(this._duration / 2, 0.001),
					cc.rotateBy(this._duration / 2, 720)
				),
				cc.delayTime(this._duration / 2)
			);
			this._outScene.runAction(t),
				this._inScene.runAction(
					cc.sequence(t.reverse(), cc.callFunc(this.finish, this))
				);
		},
	})),
	(cc.TransitionRotoZoom.create = function (t, e) {
		return new cc.TransitionRotoZoom(t, e);
	}),
	(cc.TransitionJumpZoom = cc.TransitionScene.extend({
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this);
			var t = cc.director.getWinSize();
			this._inScene.attr({
				scale: 0.5,
				x: t.width,
				y: 0,
				anchorX: 0.5,
				anchorY: 0.5,
			}),
				(this._outScene.anchorX = 0.5),
				(this._outScene.anchorY = 0.5);
			var e = cc.jumpBy(
					this._duration / 4,
					cc.p(-t.width, 0),
					t.width / 4,
					2
				),
				i = cc.scaleTo(this._duration / 4, 1),
				t = cc.scaleTo(this._duration / 4, 0.5),
				t = cc.sequence(t, e),
				e = cc.sequence(e, i),
				i = cc.delayTime(this._duration / 2);
			this._outScene.runAction(t),
				this._inScene.runAction(
					cc.sequence(i, e, cc.callFunc(this.finish, this))
				);
		},
	})),
	(cc.TransitionJumpZoom.create = function (t, e) {
		return new cc.TransitionJumpZoom(t, e);
	}),
	(cc.TransitionMoveInL = cc.TransitionScene.extend({
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this), this.initScenes();
			var t = this.action();
			this._inScene.runAction(
				cc.sequence(
					this.easeActionWithAction(t),
					cc.callFunc(this.finish, this)
				)
			);
		},
		initScenes: function () {
			this._inScene.setPosition(-cc.director.getWinSize().width, 0);
		},
		action: function () {
			return cc.moveTo(this._duration, cc.p(0, 0));
		},
		easeActionWithAction: function (t) {
			return new cc.EaseOut(t, 2);
		},
	})),
	(cc.TransitionMoveInL.create = function (t, e) {
		return new cc.TransitionMoveInL(t, e);
	}),
	(cc.TransitionMoveInR = cc.TransitionMoveInL.extend({
		ctor: function (t, e) {
			cc.TransitionMoveInL.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		initScenes: function () {
			this._inScene.setPosition(cc.director.getWinSize().width, 0);
		},
	})),
	(cc.TransitionMoveInR.create = function (t, e) {
		return new cc.TransitionMoveInR(t, e);
	}),
	(cc.TransitionMoveInT = cc.TransitionMoveInL.extend({
		ctor: function (t, e) {
			cc.TransitionMoveInL.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		initScenes: function () {
			this._inScene.setPosition(0, cc.director.getWinSize().height);
		},
	})),
	(cc.TransitionMoveInT.create = function (t, e) {
		return new cc.TransitionMoveInT(t, e);
	}),
	(cc.TransitionMoveInB = cc.TransitionMoveInL.extend({
		ctor: function (t, e) {
			cc.TransitionMoveInL.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		initScenes: function () {
			this._inScene.setPosition(0, -cc.director.getWinSize().height);
		},
	})),
	(cc.TransitionMoveInB.create = function (t, e) {
		return new cc.TransitionMoveInB(t, e);
	}),
	(cc.ADJUST_FACTOR = 0.5),
	(cc.TransitionSlideInL = cc.TransitionScene.extend({
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !1;
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this), this.initScenes();
			var t = this.action(),
				e = this.action(),
				t = cc.sequence(
					this.easeActionWithAction(t),
					cc.callFunc(this.finish, this)
				),
				e = this.easeActionWithAction(e);
			this._inScene.runAction(t), this._outScene.runAction(e);
		},
		initScenes: function () {
			this._inScene.setPosition(
				-cc.director.getWinSize().width + cc.ADJUST_FACTOR,
				0
			);
		},
		action: function () {
			return cc.moveBy(
				this._duration,
				cc.p(cc.director.getWinSize().width - cc.ADJUST_FACTOR, 0)
			);
		},
		easeActionWithAction: function (t) {
			return new cc.EaseInOut(t, 2);
		},
	})),
	(cc.TransitionSlideInL.create = function (t, e) {
		return new cc.TransitionSlideInL(t, e);
	}),
	(cc.TransitionSlideInR = cc.TransitionSlideInL.extend({
		ctor: function (t, e) {
			cc.TransitionSlideInL.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !0;
		},
		initScenes: function () {
			this._inScene.setPosition(
				cc.director.getWinSize().width - cc.ADJUST_FACTOR,
				0
			);
		},
		action: function () {
			return cc.moveBy(
				this._duration,
				cc.p(-(cc.director.getWinSize().width - cc.ADJUST_FACTOR), 0)
			);
		},
	})),
	(cc.TransitionSlideInR.create = function (t, e) {
		return new cc.TransitionSlideInR(t, e);
	}),
	(cc.TransitionSlideInB = cc.TransitionSlideInL.extend({
		ctor: function (t, e) {
			cc.TransitionSlideInL.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !1;
		},
		initScenes: function () {
			this._inScene.setPosition(
				0,
				-(cc.director.getWinSize().height - cc.ADJUST_FACTOR)
			);
		},
		action: function () {
			return cc.moveBy(
				this._duration,
				cc.p(0, cc.director.getWinSize().height - cc.ADJUST_FACTOR)
			);
		},
	})),
	(cc.TransitionSlideInB.create = function (t, e) {
		return new cc.TransitionSlideInB(t, e);
	}),
	(cc.TransitionSlideInT = cc.TransitionSlideInL.extend({
		ctor: function (t, e) {
			cc.TransitionSlideInL.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !0;
		},
		initScenes: function () {
			this._inScene.setPosition(
				0,
				cc.director.getWinSize().height - cc.ADJUST_FACTOR
			);
		},
		action: function () {
			return cc.moveBy(
				this._duration,
				cc.p(0, -(cc.director.getWinSize().height - cc.ADJUST_FACTOR))
			);
		},
	})),
	(cc.TransitionSlideInT.create = function (t, e) {
		return new cc.TransitionSlideInT(t, e);
	}),
	(cc.TransitionShrinkGrow = cc.TransitionScene.extend({
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this),
				this._inScene.attr({
					scale: 0.001,
					anchorX: 2 / 3,
					anchorY: 0.5,
				}),
				this._outScene.attr({ scale: 1, anchorX: 1 / 3, anchorY: 0.5 });
			var t = cc.scaleTo(this._duration, 0.01),
				e = cc.scaleTo(this._duration, 1);
			this._inScene.runAction(
				cc.sequence(
					this.easeActionWithAction(e),
					cc.callFunc(this.finish, this)
				)
			),
				this._outScene.runAction(this.easeActionWithAction(t));
		},
		easeActionWithAction: function (t) {
			return new cc.EaseOut(t, 2);
		},
	})),
	(cc.TransitionShrinkGrow.create = function (t, e) {
		return new cc.TransitionShrinkGrow(t, e);
	}),
	(cc.TransitionFade = cc.TransitionScene.extend({
		_color: null,
		ctor: function (t, e, i) {
			cc.TransitionScene.prototype.ctor.call(this),
				(this._color = cc.color()),
				e && this.initWithDuration(t, e, i);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this);
			var t = new cc.LayerColor(this._color);
			(this._inScene.visible = !1), this.addChild(t, 2, cc.SCENE_FADE);
			var e = this.getChildByTag(cc.SCENE_FADE),
				t = cc.sequence(
					cc.fadeIn(this._duration / 2),
					cc.callFunc(this.hideOutShowIn, this),
					cc.fadeOut(this._duration / 2),
					cc.callFunc(this.finish, this)
				);
			e.runAction(t);
		},
		onExit: function () {
			cc.TransitionScene.prototype.onExit.call(this),
				this.removeChildByTag(cc.SCENE_FADE, !1);
		},
		initWithDuration: function (t, e, i) {
			return (
				(i = i || cc.color.BLACK),
				cc.TransitionScene.prototype.initWithDuration.call(
					this,
					t,
					e
				) &&
					((this._color.r = i.r),
					(this._color.g = i.g),
					(this._color.b = i.b),
					(this._color.a = 0)),
				!0
			);
		},
	})),
	(cc.TransitionFade.create = function (t, e, i) {
		return new cc.TransitionFade(t, e, i);
	}),
	(cc.TransitionCrossFade = cc.TransitionScene.extend({
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this);
			var t = cc.color(0, 0, 0, 0),
				e = cc.director.getWinSize(),
				i = new cc.LayerColor(t),
				n = new cc.RenderTexture(e.width, e.height);
			(n.sprite.anchorX = 0.5),
				(n.sprite.anchorY = 0.5),
				n.attr({
					x: e.width / 2,
					y: e.height / 2,
					anchorX: 0.5,
					anchorY: 0.5,
				}),
				n.begin(),
				this._inScene.visit(),
				n.end();
			t = new cc.RenderTexture(e.width, e.height);
			t.setPosition(e.width / 2, e.height / 2),
				(t.sprite.anchorX = t.anchorX = 0.5),
				(t.sprite.anchorY = t.anchorY = 0.5),
				t.begin(),
				this._outScene.visit(),
				t.end(),
				n.sprite.setBlendFunc(cc.ONE, cc.ONE),
				t.sprite.setBlendFunc(cc.SRC_ALPHA, cc.ONE_MINUS_SRC_ALPHA),
				i.addChild(n),
				i.addChild(t),
				(n.sprite.opacity = 255),
				(t.sprite.opacity = 255);
			n = cc.sequence(
				cc.fadeTo(this._duration, 0),
				cc.callFunc(this.hideOutShowIn, this),
				cc.callFunc(this.finish, this)
			);
			t.sprite.runAction(n), this.addChild(i, 2, cc.SCENE_FADE);
		},
		onExit: function () {
			this.removeChildByTag(cc.SCENE_FADE, !1),
				cc.TransitionScene.prototype.onExit.call(this);
		},
		visit: function () {
			cc.Node.prototype.visit.call(this);
		},
		draw: function () {},
	})),
	(cc.TransitionCrossFade.create = function (t, e) {
		return new cc.TransitionCrossFade(t, e);
	}),
	(cc.TransitionTurnOffTiles = cc.TransitionScene.extend({
		_gridProxy: null,
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				(this._gridProxy = new cc.NodeGrid()),
				e && this.initWithDuration(t, e);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !1;
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this),
				this._gridProxy.setTarget(this._outScene),
				this._gridProxy.onEnter();
			var t = cc.director.getWinSize(),
				t = 0 | (12 * (t.width / t.height)),
				t = cc.turnOffTiles(this._duration, cc.size(t, 12)),
				t = this.easeActionWithAction(t);
			this._gridProxy.runAction(
				cc.sequence(t, cc.callFunc(this.finish, this), cc.stopGrid())
			);
		},
		visit: function () {
			this._inScene.visit(), this._gridProxy.visit();
		},
		easeActionWithAction: function (t) {
			return t;
		},
	})),
	(cc.TransitionTurnOffTiles.create = function (t, e) {
		return new cc.TransitionTurnOffTiles(t, e);
	}),
	(cc.TransitionSplitCols = cc.TransitionScene.extend({
		_gridProxy: null,
		_switchTargetToInscene: function () {
			this._gridProxy.setTarget(this._inScene);
		},
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				(this._gridProxy = new cc.NodeGrid()),
				e && this.initWithDuration(t, e);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this),
				this._gridProxy.setTarget(this._outScene),
				this._gridProxy.onEnter();
			var t = this.action(),
				t = cc.sequence(
					t,
					cc.callFunc(this._switchTargetToInscene, this),
					t.reverse()
				);
			this._gridProxy.runAction(
				cc.sequence(
					this.easeActionWithAction(t),
					cc.callFunc(this.finish, this),
					cc.stopGrid()
				)
			);
		},
		onExit: function () {
			this._gridProxy.setTarget(null),
				this._gridProxy.onExit(),
				cc.TransitionScene.prototype.onExit.call(this);
		},
		visit: function () {
			this._gridProxy.visit();
		},
		easeActionWithAction: function (t) {
			return new cc.EaseInOut(t, 3);
		},
		action: function () {
			return cc.splitCols(this._duration / 2, 3);
		},
	})),
	(cc.TransitionSplitCols.create = function (t, e) {
		return new cc.TransitionSplitCols(t, e);
	}),
	(cc.TransitionSplitRows = cc.TransitionSplitCols.extend({
		ctor: function (t, e) {
			cc.TransitionSplitCols.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		action: function () {
			return cc.splitRows(this._duration / 2, 3);
		},
	})),
	(cc.TransitionSplitRows.create = function (t, e) {
		return new cc.TransitionSplitRows(t, e);
	}),
	(cc.TransitionFadeTR = cc.TransitionScene.extend({
		_gridProxy: null,
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				(this._gridProxy = new cc.NodeGrid()),
				e && this.initWithDuration(t, e);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !1;
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this),
				this._gridProxy.setTarget(this._outScene),
				this._gridProxy.onEnter();
			var t = cc.director.getWinSize(),
				t = 0 | (12 * (t.width / t.height)),
				t = this.actionWithSize(cc.size(t, 12));
			this._gridProxy.runAction(
				cc.sequence(
					this.easeActionWithAction(t),
					cc.callFunc(this.finish, this),
					cc.stopGrid()
				)
			);
		},
		visit: function () {
			this._inScene.visit(), this._gridProxy.visit();
		},
		easeActionWithAction: function (t) {
			return t;
		},
		actionWithSize: function (t) {
			return cc.fadeOutTRTiles(this._duration, t);
		},
	})),
	(cc.TransitionFadeTR.create = function (t, e) {
		return new cc.TransitionFadeTR(t, e);
	}),
	(cc.TransitionFadeBL = cc.TransitionFadeTR.extend({
		ctor: function (t, e) {
			cc.TransitionFadeTR.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		actionWithSize: function (t) {
			return cc.fadeOutBLTiles(this._duration, t);
		},
	})),
	(cc.TransitionFadeBL.create = function (t, e) {
		return new cc.TransitionFadeBL(t, e);
	}),
	(cc.TransitionFadeUp = cc.TransitionFadeTR.extend({
		ctor: function (t, e) {
			cc.TransitionFadeTR.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		actionWithSize: function (t) {
			return new cc.FadeOutUpTiles(this._duration, t);
		},
	})),
	(cc.TransitionFadeUp.create = function (t, e) {
		return new cc.TransitionFadeUp(t, e);
	}),
	(cc.TransitionFadeDown = cc.TransitionFadeTR.extend({
		ctor: function (t, e) {
			cc.TransitionFadeTR.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		actionWithSize: function (t) {
			return cc.fadeOutDownTiles(this._duration, t);
		},
	})),
	(cc.TransitionFadeDown.create = function (t, e) {
		return new cc.TransitionFadeDown(t, e);
	}),
	(cc.SCENE_RADIAL = 49153),
	(cc.TransitionProgress = cc.TransitionScene.extend({
		_to: 0,
		_from: 0,
		_sceneToBeModified: null,
		_className: 'TransitionProgress',
		ctor: function (t, e) {
			cc.TransitionScene.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_setAttrs: function (t, e, i) {
			t.attr({ x: e, y: i, anchorX: 0.5, anchorY: 0.5 });
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this),
				this._setupTransition();
			var t = cc.director.getWinSize(),
				e = new cc.RenderTexture(t.width, t.height);
			(e.sprite.anchorX = 0.5),
				(e.sprite.anchorY = 0.5),
				this._setAttrs(e, t.width / 2, t.height / 2),
				e.clear(0, 0, 0, 1),
				e.begin(),
				this._sceneToBeModified.visit(),
				e.end(),
				this._sceneToBeModified === this._outScene &&
					this.hideOutShowIn();
			(t = this._progressTimerNodeWithRenderTexture(e)),
				(e = cc.sequence(
					cc.progressFromTo(this._duration, this._from, this._to),
					cc.callFunc(this.finish, this)
				));
			t.runAction(e), this.addChild(t, 2, cc.SCENE_RADIAL);
		},
		onExit: function () {
			this.removeChildByTag(cc.SCENE_RADIAL, !0),
				cc.TransitionScene.prototype.onExit.call(this);
		},
		_setupTransition: function () {
			(this._sceneToBeModified = this._outScene),
				(this._from = 100),
				(this._to = 0);
		},
		_progressTimerNodeWithRenderTexture: function (t) {
			return (
				cc.log(
					'cc.TransitionProgress._progressTimerNodeWithRenderTexture(): should be overridden in subclass'
				),
				null
			);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !1;
		},
	})),
	(cc.TransitionProgress.create = function (t, e) {
		return new cc.TransitionProgress(t, e);
	}),
	(cc.TransitionProgressRadialCCW = cc.TransitionProgress.extend({
		ctor: function (t, e) {
			cc.TransitionProgress.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_progressTimerNodeWithRenderTexture: function (t) {
			var e = cc.director.getWinSize(),
				t = new cc.ProgressTimer(t.sprite);
			return (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					(t.sprite.flippedY = !0),
				(t.type = cc.ProgressTimer.TYPE_RADIAL),
				(t.reverseDir = !1),
				(t.percentage = 100),
				this._setAttrs(t, e.width / 2, e.height / 2),
				t
			);
		},
	})),
	(cc.TransitionProgressRadialCCW.create = function (t, e) {
		return new cc.TransitionProgressRadialCCW(t, e);
	}),
	(cc.TransitionProgressRadialCW = cc.TransitionProgress.extend({
		ctor: function (t, e) {
			cc.TransitionProgress.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_progressTimerNodeWithRenderTexture: function (t) {
			var e = cc.director.getWinSize(),
				t = new cc.ProgressTimer(t.sprite);
			return (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					(t.sprite.flippedY = !0),
				(t.type = cc.ProgressTimer.TYPE_RADIAL),
				(t.reverseDir = !0),
				(t.percentage = 100),
				this._setAttrs(t, e.width / 2, e.height / 2),
				t
			);
		},
	})),
	(cc.TransitionProgressRadialCW.create = function (t, e) {
		var i = new cc.TransitionProgressRadialCW();
		return null !== i && i.initWithDuration(t, e)
			? i
			: new cc.TransitionProgressRadialCW(t, e);
	}),
	(cc.TransitionProgressHorizontal = cc.TransitionProgress.extend({
		ctor: function (t, e) {
			cc.TransitionProgress.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_progressTimerNodeWithRenderTexture: function (t) {
			var e = cc.director.getWinSize(),
				t = new cc.ProgressTimer(t.sprite);
			return (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					(t.sprite.flippedY = !0),
				(t.type = cc.ProgressTimer.TYPE_BAR),
				(t.midPoint = cc.p(1, 0)),
				(t.barChangeRate = cc.p(1, 0)),
				(t.percentage = 100),
				this._setAttrs(t, e.width / 2, e.height / 2),
				t
			);
		},
	})),
	(cc.TransitionProgressHorizontal.create = function (t, e) {
		return new cc.TransitionProgressHorizontal(t, e);
	}),
	(cc.TransitionProgressVertical = cc.TransitionProgress.extend({
		ctor: function (t, e) {
			cc.TransitionProgress.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_progressTimerNodeWithRenderTexture: function (t) {
			var e = cc.director.getWinSize(),
				t = new cc.ProgressTimer(t.sprite);
			return (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					(t.sprite.flippedY = !0),
				(t.type = cc.ProgressTimer.TYPE_BAR),
				(t.midPoint = cc.p(0, 0)),
				(t.barChangeRate = cc.p(0, 1)),
				(t.percentage = 100),
				this._setAttrs(t, e.width / 2, e.height / 2),
				t
			);
		},
	})),
	(cc.TransitionProgressVertical.create = function (t, e) {
		return new cc.TransitionProgressVertical(t, e);
	}),
	(cc.TransitionProgressInOut = cc.TransitionProgress.extend({
		ctor: function (t, e) {
			cc.TransitionProgress.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_progressTimerNodeWithRenderTexture: function (t) {
			var e = cc.director.getWinSize(),
				t = new cc.ProgressTimer(t.sprite);
			return (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					(t.sprite.flippedY = !0),
				(t.type = cc.ProgressTimer.TYPE_BAR),
				(t.midPoint = cc.p(0.5, 0.5)),
				(t.barChangeRate = cc.p(1, 1)),
				(t.percentage = 0),
				this._setAttrs(t, e.width / 2, e.height / 2),
				t
			);
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = !1;
		},
		_setupTransition: function () {
			(this._sceneToBeModified = this._inScene),
				(this._from = 0),
				(this._to = 100);
		},
	})),
	(cc.TransitionProgressInOut.create = function (t, e) {
		return new cc.TransitionProgressInOut(t, e);
	}),
	(cc.TransitionProgressOutIn = cc.TransitionProgress.extend({
		ctor: function (t, e) {
			cc.TransitionProgress.prototype.ctor.call(this),
				e && this.initWithDuration(t, e);
		},
		_progressTimerNodeWithRenderTexture: function (t) {
			var e = cc.director.getWinSize(),
				t = new cc.ProgressTimer(t.sprite);
			return (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					(t.sprite.flippedY = !0),
				(t.type = cc.ProgressTimer.TYPE_BAR),
				(t.midPoint = cc.p(0.5, 0.5)),
				(t.barChangeRate = cc.p(1, 1)),
				(t.percentage = 100),
				this._setAttrs(t, e.width / 2, e.height / 2),
				t
			);
		},
	})),
	(cc.TransitionProgressOutIn.create = function (t, e) {
		return new cc.TransitionProgressOutIn(t, e);
	}),
	(cc.TransitionPageTurn = cc.TransitionScene.extend({
		ctor: function (t, e, i) {
			cc.TransitionScene.prototype.ctor.call(this),
				(this._gridProxy = new cc.NodeGrid()),
				this.initWithDuration(t, e, i);
		},
		_back: !0,
		_gridProxy: null,
		_className: 'TransitionPageTurn',
		initWithDuration: function (t, e, i) {
			return (
				(this._back = i),
				cc.TransitionScene.prototype.initWithDuration.call(this, t, e),
				!0
			);
		},
		actionWithSize: function (t) {
			return this._back
				? cc.reverseTime(cc.pageTurn3D(this._duration, t))
				: cc.pageTurn3D(this._duration, t);
		},
		onEnter: function () {
			cc.TransitionScene.prototype.onEnter.call(this);
			var t = cc.director.getWinSize(),
				t = t.width > t.height ? ((e = 16), 12) : ((e = 12), 16),
				e = this.actionWithSize(cc.size(e, t)),
				t = this._gridProxy;
			this._back
				? (t.setTarget(this._inScene),
				  t.onEnter(),
				  (this._inScene.visible = !1),
				  t.runAction(
						cc.sequence(
							e,
							cc.callFunc(this.finish, this),
							cc.stopGrid()
						)
				  ),
				  this._inScene.runAction(cc.show()))
				: (t.setTarget(this._outScene),
				  t.onEnter(),
				  t.runAction(
						cc.sequence(
							e,
							cc.callFunc(this.finish, this),
							cc.stopGrid()
						)
				  ));
		},
		visit: function () {
			(this._back ? this._outScene : this._inScene).visit(),
				this._gridProxy.visit();
		},
		_sceneOrder: function () {
			this._isInSceneOnTop = this._back;
		},
	})),
	(cc.TransitionPageTurn.create = function (t, e, i) {
		return new cc.TransitionPageTurn(t, e, i);
	}),
	(cc.Codec = { name: 'Jacob__Codec' }),
	(cc.unzip = function () {
		return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip, arguments);
	}),
	(cc.unzipBase64 = function () {
		var t = cc.Codec.Base64.decode.apply(cc.Codec.Base64, arguments);
		return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip, [t]);
	}),
	(cc.unzipBase64AsArray = function (t, e) {
		e = e || 1;
		for (
			var i, n = this.unzipBase64(t), r = [], o = 0, s = n.length / e;
			o < s;
			o++
		)
			for (r[o] = 0, i = e - 1; 0 <= i; --i)
				r[o] += n.charCodeAt(o * e + i) << (8 * i);
		return r;
	}),
	(cc.unzipAsArray = function (t, e) {
		e = e || 1;
		for (
			var i, n = this.unzip(t), r = [], o = 0, s = n.length / e;
			o < s;
			o++
		)
			for (r[o] = 0, i = e - 1; 0 <= i; --i)
				r[o] += n.charCodeAt(o * e + i) << (8 * i);
		return r;
	}),
	(cc.StringToArray = function (t) {
		for (var e = t.split(','), i = [], n = 0; n < e.length; n++)
			i.push(parseInt(e[n]));
		return i;
	}),
	(cc.Codec.Base64 = { name: 'Jacob__Codec__Base64' }),
	(cc.Codec.Base64._keyStr =
		'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='),
	(cc.Codec.Base64.decode = function (t) {
		var e,
			i,
			n,
			r,
			o,
			s = [],
			c = 0;
		for (t = t.replace(/[^A-Za-z0-9\+\/\=]/g, ''); c < t.length; )
			(e =
				(this._keyStr.indexOf(t.charAt(c++)) << 2) |
				((n = this._keyStr.indexOf(t.charAt(c++))) >> 4)),
				(i =
					((15 & n) << 4) |
					((r = this._keyStr.indexOf(t.charAt(c++))) >> 2)),
				(n =
					((3 & r) << 6) | (o = this._keyStr.indexOf(t.charAt(c++)))),
				s.push(String.fromCharCode(e)),
				64 !== r && s.push(String.fromCharCode(i)),
				64 !== o && s.push(String.fromCharCode(n));
		return (s = s.join(''));
	}),
	(cc.Codec.Base64.decodeAsArray = function (t, e) {
		for (
			var i, n = this.decode(t), r = [], o = 0, s = n.length / e;
			o < s;
			o++
		)
			for (r[o] = 0, i = e - 1; 0 <= i; --i)
				r[o] += n.charCodeAt(o * e + i) << (8 * i);
		return r;
	}),
	(cc.uint8ArrayToUint32Array = function (t) {
		if (t.length % 4 != 0) return null;
		for (
			var e = t.length / 4,
				i = window.Uint32Array ? new Uint32Array(e) : [],
				n = 0;
			n < e;
			n++
		) {
			var r = 4 * n;
			i[n] =
				t[r] + 256 * t[1 + r] + 65536 * t[2 + r] + t[3 + r] * (1 << 24);
		}
		return i;
	}),
	(cc.Codec.GZip = function (t) {
		(this.data = t),
			(this.debug = !1),
			(this.gpflags = void 0),
			(this.files = 0),
			(this.unzipped = []),
			(this.buf32k = new Array(32768)),
			(this.bIdx = 0),
			(this.modeZIP = !1),
			(this.bytepos = 0),
			(this.bb = 1),
			(this.bits = 0),
			(this.nameBuf = []),
			(this.fileout = void 0),
			(this.literalTree = new Array(cc.Codec.GZip.LITERALS)),
			(this.distanceTree = new Array(32)),
			(this.treepos = 0),
			(this.Places = null),
			(this.len = 0),
			(this.fpos = new Array(17)),
			(this.fpos[0] = 0),
			(this.flens = void 0),
			(this.fmax = void 0);
	}),
	(cc.Codec.GZip.gunzip = function (t) {
		return (
			t.constructor === Array || (t.constructor, String),
			new cc.Codec.GZip(t).gunzip()[0][0]
		);
	}),
	(cc.Codec.GZip.HufNode = function () {
		(this.b0 = 0), (this.b1 = 0), (this.jump = null), (this.jumppos = -1);
	}),
	(cc.Codec.GZip.LITERALS = 288),
	(cc.Codec.GZip.NAMEMAX = 256),
	(cc.Codec.GZip.bitReverse = [
		0, 128, 64, 192, 32, 160, 96, 224, 16, 144, 80, 208, 48, 176, 112, 240,
		8, 136, 72, 200, 40, 168, 104, 232, 24, 152, 88, 216, 56, 184, 120, 248,
		4, 132, 68, 196, 36, 164, 100, 228, 20, 148, 84, 212, 52, 180, 116, 244,
		12, 140, 76, 204, 44, 172, 108, 236, 28, 156, 92, 220, 60, 188, 124,
		252, 2, 130, 66, 194, 34, 162, 98, 226, 18, 146, 82, 210, 50, 178, 114,
		242, 10, 138, 74, 202, 42, 170, 106, 234, 26, 154, 90, 218, 58, 186,
		122, 250, 6, 134, 70, 198, 38, 166, 102, 230, 22, 150, 86, 214, 54, 182,
		118, 246, 14, 142, 78, 206, 46, 174, 110, 238, 30, 158, 94, 222, 62,
		190, 126, 254, 1, 129, 65, 193, 33, 161, 97, 225, 17, 145, 81, 209, 49,
		177, 113, 241, 9, 137, 73, 201, 41, 169, 105, 233, 25, 153, 89, 217, 57,
		185, 121, 249, 5, 133, 69, 197, 37, 165, 101, 229, 21, 149, 85, 213, 53,
		181, 117, 245, 13, 141, 77, 205, 45, 173, 109, 237, 29, 157, 93, 221,
		61, 189, 125, 253, 3, 131, 67, 195, 35, 163, 99, 227, 19, 147, 83, 211,
		51, 179, 115, 243, 11, 139, 75, 203, 43, 171, 107, 235, 27, 155, 91,
		219, 59, 187, 123, 251, 7, 135, 71, 199, 39, 167, 103, 231, 23, 151, 87,
		215, 55, 183, 119, 247, 15, 143, 79, 207, 47, 175, 111, 239, 31, 159,
		95, 223, 63, 191, 127, 255,
	]),
	(cc.Codec.GZip.cplens = [
		3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59,
		67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0,
	]),
	(cc.Codec.GZip.cplext = [
		0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4,
		5, 5, 5, 5, 0, 99, 99,
	]),
	(cc.Codec.GZip.cpdist = [
		1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385,
		513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577,
	]),
	(cc.Codec.GZip.cpdext = [
		0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10,
		10, 11, 11, 12, 12, 13, 13,
	]),
	(cc.Codec.GZip.border = [
		16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15,
	]),
	(cc.Codec.GZip.prototype.gunzip = function () {
		return (this.outputArr = []), this.nextFile(), this.unzipped;
	}),
	(cc.Codec.GZip.prototype.readByte = function () {
		return (
			(this.bits += 8),
			this.bytepos < this.data.length
				? this.data.charCodeAt(this.bytepos++)
				: -1
		);
	}),
	(cc.Codec.GZip.prototype.byteAlign = function () {
		this.bb = 1;
	}),
	(cc.Codec.GZip.prototype.readBit = function () {
		var t;
		return (
			this.bits++,
			(t = 1 & this.bb),
			(this.bb >>= 1),
			0 === this.bb &&
				((this.bb = this.readByte()),
				(t = 1 & this.bb),
				(this.bb = (this.bb >> 1) | 128)),
			t
		);
	}),
	(cc.Codec.GZip.prototype.readBits = function (t) {
		for (var e = 0, i = t; i--; ) e = (e << 1) | this.readBit();
		return t && (e = cc.Codec.GZip.bitReverse[e] >> (8 - t)), e;
	}),
	(cc.Codec.GZip.prototype.flushBuffer = function () {
		this.bIdx = 0;
	}),
	(cc.Codec.GZip.prototype.addBuffer = function (t) {
		(this.buf32k[this.bIdx++] = t),
			this.outputArr.push(String.fromCharCode(t)),
			32768 === this.bIdx && (this.bIdx = 0);
	}),
	(cc.Codec.GZip.prototype.IsPat = function () {
		for (;;) {
			if (this.fpos[this.len] >= this.fmax) return -1;
			if (this.flens[this.fpos[this.len]] === this.len)
				return this.fpos[this.len]++;
			this.fpos[this.len]++;
		}
	}),
	(cc.Codec.GZip.prototype.Rec = function () {
		var t,
			e = this.Places[this.treepos];
		if (17 === this.len) return -1;
		if ((this.treepos++, this.len++, 0 <= (t = this.IsPat()))) e.b0 = t;
		else if (((e.b0 = 32768), this.Rec())) return -1;
		if (0 <= (t = this.IsPat())) (e.b1 = t), (e.jump = null);
		else if (
			((e.b1 = 32768),
			(e.jump = this.Places[this.treepos]),
			(e.jumppos = this.treepos),
			this.Rec())
		)
			return -1;
		return this.len--, 0;
	}),
	(cc.Codec.GZip.prototype.CreateTree = function (t, e, i, n) {
		var r;
		for (
			this.Places = t,
				this.treepos = 0,
				this.flens = i,
				this.fmax = e,
				r = 0;
			r < 17;
			r++
		)
			this.fpos[r] = 0;
		return (this.len = 0), this.Rec() ? -1 : 0;
	}),
	(cc.Codec.GZip.prototype.DecodeValue = function (t) {
		for (var e, i, n = 0, r = t[n]; ; )
			if (this.readBit()) {
				if (!(32768 & r.b1)) return r.b1;
				for (r = r.jump, e = t.length, i = 0; i < e; i++)
					if (t[i] === r) {
						n = i;
						break;
					}
			} else {
				if (!(32768 & r.b0)) return r.b0;
				r = t[++n];
			}
	}),
	(cc.Codec.GZip.prototype.DeflateLoop = function () {
		do {
			var t,
				e,
				i = this.readBit(),
				n = this.readBits(2);
			if (0 === n)
				for (
					this.byteAlign(),
						t = this.readByte(),
						t |= this.readByte() << 8,
						e = this.readByte(),
						65535 & (t ^ ~(e |= this.readByte() << 8)) &&
							document.write('BlockLen checksum mismatch\n');
					t--;

				)
					(r = this.readByte()), this.addBuffer(r);
			else if (1 === n)
				for (;;)
					if (
						(23 <
						(o = cc.Codec.GZip.bitReverse[this.readBits(7)] >> 1)
							? 199 < (o = (o << 1) | this.readBit())
								? (o = ((o -= 128) << 1) | this.readBit())
								: 143 < (o -= 48) && (o += 136)
							: (o += 256),
						o < 256)
					)
						this.addBuffer(o);
					else {
						if (256 === o) break;
						for (
							o -= 257,
								u =
									this.readBits(cc.Codec.GZip.cplext[o]) +
									cc.Codec.GZip.cplens[o],
								o =
									cc.Codec.GZip.bitReverse[
										this.readBits(5)
									] >> 3,
								8 < cc.Codec.GZip.cpdext[o]
									? ((_ = this.readBits(8)),
									  (_ |=
											this.readBits(
												cc.Codec.GZip.cpdext[o] - 8
											) << 8))
									: (_ = this.readBits(
											cc.Codec.GZip.cpdext[o]
									  )),
								_ += cc.Codec.GZip.cpdist[o],
								o = 0;
							o < u;
							o++
						) {
							var r = this.buf32k[(this.bIdx - _) & 32767];
							this.addBuffer(r);
						}
					}
			else if (2 === n) {
				var o,
					s,
					c = new Array(320),
					a = 257 + this.readBits(5),
					n = 1 + this.readBits(5),
					l = 4 + this.readBits(4);
				for (o = 0; o < 19; o++) c[o] = 0;
				for (o = 0; o < l; o++)
					c[cc.Codec.GZip.border[o]] = this.readBits(3);
				for (u = this.distanceTree.length, p = 0; p < u; p++)
					this.distanceTree[p] = new cc.Codec.GZip.HufNode();
				if (this.CreateTree(this.distanceTree, 19, c, 0))
					return this.flushBuffer(), 1;
				(s = a + n), (p = 0);
				for (var h; p < s; )
					if ((o = this.DecodeValue(this.distanceTree)) < 16)
						c[p++] = o;
					else if (16 === o) {
						if (s < p + (o = 3 + this.readBits(2)))
							return this.flushBuffer(), 1;
						for (h = p ? c[p - 1] : 0; o--; ) c[p++] = h;
					} else {
						if (
							s <
							p +
								(o =
									17 === o
										? 3 + this.readBits(3)
										: 11 + this.readBits(7))
						)
							return this.flushBuffer(), 1;
						for (; o--; ) c[p++] = 0;
					}
				for (u = this.literalTree.length, p = 0; p < u; p++)
					this.literalTree[p] = new cc.Codec.GZip.HufNode();
				if (this.CreateTree(this.literalTree, a, c, 0))
					return this.flushBuffer(), 1;
				for (u = this.literalTree.length, p = 0; p < u; p++)
					this.distanceTree[p] = new cc.Codec.GZip.HufNode();
				for (var u, _, d = new Array(), p = a; p < c.length; p++)
					d[p - a] = c[p];
				if (this.CreateTree(this.distanceTree, n, d, 0))
					return this.flushBuffer(), 1;
				for (;;)
					if (256 <= (o = this.DecodeValue(this.literalTree))) {
						if (0 === (o -= 256)) break;
						for (
							o--,
								u =
									this.readBits(cc.Codec.GZip.cplext[o]) +
									cc.Codec.GZip.cplens[o],
								o = this.DecodeValue(this.distanceTree),
								8 < cc.Codec.GZip.cpdext[o]
									? ((_ = this.readBits(8)),
									  (_ |=
											this.readBits(
												cc.Codec.GZip.cpdext[o] - 8
											) << 8))
									: (_ = this.readBits(
											cc.Codec.GZip.cpdext[o]
									  )),
								_ += cc.Codec.GZip.cpdist[o];
							u--;

						) {
							r = this.buf32k[(this.bIdx - _) & 32767];
							this.addBuffer(r);
						}
					} else this.addBuffer(o);
			}
		} while (!i);
		return this.flushBuffer(), this.byteAlign(), 0;
	}),
	(cc.Codec.GZip.prototype.unzipFile = function (t) {
		var e;
		for (this.gunzip(), e = 0; e < this.unzipped.length; e++)
			if (this.unzipped[e][1] === t) return this.unzipped[e][0];
	}),
	(cc.Codec.GZip.prototype.nextFile = function () {
		(this.outputArr = []), (this.modeZIP = !1);
		var t = [];
		if (
			((t[0] = this.readByte()),
			(t[1] = this.readByte()),
			120 === t[0] &&
				218 === t[1] &&
				(this.DeflateLoop(),
				(this.unzipped[this.files] = [
					this.outputArr.join(''),
					'geonext.gxt',
				]),
				this.files++),
			31 === t[0] &&
				139 === t[1] &&
				(this.skipdir(),
				(this.unzipped[this.files] = [this.outputArr.join(''), 'file']),
				this.files++),
			80 === t[0] &&
				75 === t[1] &&
				((this.modeZIP = !0),
				(t[2] = this.readByte()),
				(t[3] = this.readByte()),
				3 === t[2] && 4 === t[3]))
		) {
			(t[0] = this.readByte()),
				(t[1] = this.readByte()),
				(this.gpflags = this.readByte()),
				(this.gpflags |= this.readByte() << 8);
			var e = this.readByte();
			(e |= this.readByte() << 8),
				this.readByte(),
				this.readByte(),
				this.readByte(),
				this.readByte();
			t = this.readByte();
			(t |= this.readByte() << 8),
				(t |= this.readByte() << 16),
				(t |= this.readByte() << 24);
			t = this.readByte();
			(t |= this.readByte() << 8),
				(t |= this.readByte() << 16),
				(t |= this.readByte() << 24);
			var i = this.readByte();
			i |= this.readByte() << 8;
			var n = this.readByte();
			for (n |= this.readByte() << 8, o = 0, this.nameBuf = []; i--; ) {
				var r = this.readByte();
				('/' === r) | (':' === r)
					? (o = 0)
					: o < cc.Codec.GZip.NAMEMAX - 1 &&
					  (this.nameBuf[o++] = String.fromCharCode(r));
			}
			this.fileout || (this.fileout = this.nameBuf);
			for (var o = 0; o < n; ) (r = this.readByte()), o++;
			8 == e &&
				(this.DeflateLoop(),
				(this.unzipped[this.files] = [
					this.outputArr.join(''),
					this.nameBuf.join(''),
				]),
				this.files++),
				this.skipdir();
		}
	}),
	(cc.Codec.GZip.prototype.skipdir = function () {
		var t,
			e,
			i = [];
		if (
			(8 & this.gpflags &&
				((i[0] = this.readByte()),
				(i[1] = this.readByte()),
				(i[2] = this.readByte()),
				(i[3] = this.readByte()),
				this.readByte(),
				this.readByte(),
				this.readByte(),
				this.readByte(),
				this.readByte(),
				this.readByte(),
				this.readByte(),
				this.readByte()),
			this.modeZIP && this.nextFile(),
			(i[0] = this.readByte()),
			8 !== i[0])
		)
			return 0;
		if (
			((this.gpflags = this.readByte()),
			this.readByte(),
			this.readByte(),
			this.readByte(),
			this.readByte(),
			this.readByte(),
			this.readByte(),
			4 & this.gpflags)
		)
			for (
				i[0] = this.readByte(),
					i[2] = this.readByte(),
					this.len = i[0] + 256 * i[1],
					t = 0;
				t < this.len;
				t++
			)
				this.readByte();
		if (8 & this.gpflags)
			for (t = 0, this.nameBuf = []; (e = this.readByte()); )
				('7' !== e && ':' !== e) || (t = 0),
					t < cc.Codec.GZip.NAMEMAX - 1 && (this.nameBuf[t++] = e);
		if (16 & this.gpflags) for (; (e = this.readByte()); );
		2 & this.gpflags && (this.readByte(), this.readByte()),
			this.DeflateLoop(),
			this.readByte(),
			this.readByte(),
			this.readByte(),
			this.readByte(),
			this.modeZIP && this.nextFile();
	}),
	function () {
		'use strict';
		function tt(t) {
			throw t;
		}
		var et = void 0,
			it = !0,
			o = this;
		function t(t, e) {
			var i,
				n = t.split('.'),
				r = o;
			n[0] in r || !r.execScript || r.execScript('var ' + n[0]);
			for (; n.length && (i = n.shift()); )
				n.length || e === et ? (r = r[i] || (r[i] = {})) : (r[i] = e);
		}
		var nt =
			'undefined' != typeof Uint8Array &&
			'undefined' != typeof Uint16Array &&
			'undefined' != typeof Uint32Array;
		function s(t) {
			if ('string' == typeof t) {
				for (var e = t.split(''), i = 0, n = e.length; i < n; i++)
					e[i] = (255 & e[i].charCodeAt(0)) >>> 0;
				t = e;
			}
			for (var r, o = 1, s = 0, c = t.length, a = 0; 0 < c; ) {
				for (
					r = 1024 < c ? 1024 : c, c -= r;
					(o += t[a++]), (s += o), --r;

				);
				(o %= 65521), (s %= 65521);
			}
			return ((s << 16) | o) >>> 0;
		}
		function rt(t, e) {
			(this.index = 'number' == typeof e ? e : 0),
				(this.i = 0),
				(this.buffer =
					t instanceof (nt ? Uint8Array : Array)
						? t
						: new (nt ? Uint8Array : Array)(32768)),
				2 * this.buffer.length <= this.index &&
					tt(Error('invalid index')),
				this.buffer.length <= this.index && this.f();
		}
		(rt.prototype.f = function () {
			var t,
				e = this.buffer,
				i = e.length,
				n = new (nt ? Uint8Array : Array)(i << 1);
			if (nt) n.set(e);
			else for (t = 0; t < i; ++t) n[t] = e[t];
			return (this.buffer = n);
		}),
			(rt.prototype.d = function (t, e, i) {
				var n,
					r = this.buffer,
					o = this.index,
					s = this.i,
					c = r[o];
				if (
					(i &&
						1 < e &&
						(t =
							8 < e
								? ((a[255 & t] << 24) |
										(a[(t >>> 8) & 255] << 16) |
										(a[(t >>> 16) & 255] << 8) |
										a[(t >>> 24) & 255]) >>
								  (32 - e)
								: a[t] >> (8 - e)),
					e + s < 8)
				)
					(c = (c << e) | t), (s += e);
				else
					for (n = 0; n < e; ++n)
						(c = (c << 1) | ((t >> (e - n - 1)) & 1)),
							8 == ++s &&
								((s = 0),
								(r[o++] = a[c]),
								(c = 0),
								o === r.length && (r = this.f()));
				(r[o] = c), (this.buffer = r), (this.i = s), (this.index = o);
			}),
			(rt.prototype.finish = function () {
				var t = this.buffer,
					e = this.index;
				return (
					0 < this.i &&
						((t[e] <<= 8 - this.i), (t[e] = a[t[e]]), e++),
					nt ? t.subarray(0, e) : ((t.length = e), t)
				);
			});
		for (var e = new (nt ? Uint8Array : Array)(256), i = 0; i < 256; ++i) {
			for (var n = (c = i), r = 7, c = c >>> 1; c; c >>>= 1)
				(n <<= 1), (n |= 1 & c), --r;
			e[i] = ((n << r) & 255) >>> 0;
		}
		var a = e;
		function E(t) {
			(this.buffer = new (nt ? Uint16Array : Array)(2 * t)),
				(this.length = 0);
		}
		function h(t) {
			for (
				var e,
					i,
					n,
					r,
					o,
					s,
					c,
					a,
					l = t.length,
					h = 0,
					u = Number.POSITIVE_INFINITY,
					_ = 0;
				_ < l;
				++_
			)
				t[_] > h && (h = t[_]), t[_] < u && (u = t[_]);
			for (
				e = 1 << h,
					i = new (nt ? Uint32Array : Array)(e),
					n = 1,
					r = 0,
					o = 2;
				n <= h;

			) {
				for (_ = 0; _ < l; ++_)
					if (t[_] === n) {
						for (c = r, a = s = 0; a < n; ++a)
							(s = (s << 1) | (1 & c)), (c >>= 1);
						for (a = s; a < e; a += o) i[a] = (n << 16) | _;
						++r;
					}
				++n, (r <<= 1), (o <<= 1);
			}
			return [i, h, u];
		}
		function l(t, e) {
			(this.h = ot),
				(this.w = 0),
				(this.input = t),
				(this.b = 0),
				e &&
					(e.lazy && (this.w = e.lazy),
					'number' == typeof e.compressionType &&
						(this.h = e.compressionType),
					e.outputBuffer &&
						(this.a =
							nt && e.outputBuffer instanceof Array
								? new Uint8Array(e.outputBuffer)
								: e.outputBuffer),
					'number' == typeof e.outputIndex &&
						(this.b = e.outputIndex)),
				this.a || (this.a = new (nt ? Uint8Array : Array)(32768));
		}
		nt &&
			new Uint32Array([
				0, 1996959894, 3993919788, 2567524794, 124634137, 1886057615,
				3915621685, 2657392035, 249268274, 2044508324, 3772115230,
				2547177864, 162941995, 2125561021, 3887607047, 2428444049,
				498536548, 1789927666, 4089016648, 2227061214, 450548861,
				1843258603, 4107580753, 2211677639, 325883990, 1684777152,
				4251122042, 2321926636, 335633487, 1661365465, 4195302755,
				2366115317, 997073096, 1281953886, 3579855332, 2724688242,
				1006888145, 1258607687, 3524101629, 2768942443, 901097722,
				1119000684, 3686517206, 2898065728, 853044451, 1172266101,
				3705015759, 2882616665, 651767980, 1373503546, 3369554304,
				3218104598, 565507253, 1454621731, 3485111705, 3099436303,
				671266974, 1594198024, 3322730930, 2970347812, 795835527,
				1483230225, 3244367275, 3060149565, 1994146192, 31158534,
				2563907772, 4023717930, 1907459465, 112637215, 2680153253,
				3904427059, 2013776290, 251722036, 2517215374, 3775830040,
				2137656763, 141376813, 2439277719, 3865271297, 1802195444,
				476864866, 2238001368, 4066508878, 1812370925, 453092731,
				2181625025, 4111451223, 1706088902, 314042704, 2344532202,
				4240017532, 1658658271, 366619977, 2362670323, 4224994405,
				1303535960, 984961486, 2747007092, 3569037538, 1256170817,
				1037604311, 2765210733, 3554079995, 1131014506, 879679996,
				2909243462, 3663771856, 1141124467, 855842277, 2852801631,
				3708648649, 1342533948, 654459306, 3188396048, 3373015174,
				1466479909, 544179635, 3110523913, 3462522015, 1591671054,
				702138776, 2966460450, 3352799412, 1504918807, 783551873,
				3082640443, 3233442989, 3988292384, 2596254646, 62317068,
				1957810842, 3939845945, 2647816111, 81470997, 1943803523,
				3814918930, 2489596804, 225274430, 2053790376, 3826175755,
				2466906013, 167816743, 2097651377, 4027552580, 2265490386,
				503444072, 1762050814, 4150417245, 2154129355, 426522225,
				1852507879, 4275313526, 2312317920, 282753626, 1742555852,
				4189708143, 2394877945, 397917763, 1622183637, 3604390888,
				2714866558, 953729732, 1340076626, 3518719985, 2797360999,
				1068828381, 1219638859, 3624741850, 2936675148, 906185462,
				1090812512, 3747672003, 2825379669, 829329135, 1181335161,
				3412177804, 3160834842, 628085408, 1382605366, 3423369109,
				3138078467, 570562233, 1426400815, 3317316542, 2998733608,
				733239954, 1555261956, 3268935591, 3050360625, 752459403,
				1541320221, 2607071920, 3965973030, 1969922972, 40735498,
				2617837225, 3943577151, 1913087877, 83908371, 2512341634,
				3803740692, 2075208622, 213261112, 2463272603, 3855990285,
				2094854071, 198958881, 2262029012, 4057260610, 1759359992,
				534414190, 2176718541, 4139329115, 1873836001, 414664567,
				2282248934, 4279200368, 1711684554, 285281116, 2405801727,
				4167216745, 1634467795, 376229701, 2685067896, 3608007406,
				1308918612, 956543938, 2808555105, 3495958263, 1231636301,
				1047427035, 2932959818, 3654703836, 1088359270, 936918e3,
				2847714899, 3736837829, 1202900863, 817233897, 3183342108,
				3401237130, 1404277552, 615818150, 3134207493, 3453421203,
				1423857449, 601450431, 3009837614, 3294710456, 1567103746,
				711928724, 3020668471, 3272380065, 1510334235, 755167117,
			]),
			(E.prototype.getParent = function (t) {
				return 2 * (((t - 2) / 4) | 0);
			}),
			(E.prototype.push = function (t, e) {
				var i,
					n,
					r = this.buffer,
					o = this.length;
				for (
					r[this.length++] = e, r[this.length++] = t;
					0 < o && ((i = this.getParent(o)), r[o] > r[i]);

				)
					(n = r[o]),
						(r[o] = r[i]),
						(r[i] = n),
						(n = r[o + 1]),
						(r[o + 1] = r[i + 1]),
						(r[i + 1] = n),
						(o = i);
				return this.length;
			}),
			(E.prototype.pop = function () {
				var t,
					e,
					i,
					n = this.buffer,
					r = n[0],
					o = n[1];
				for (
					this.length -= 2,
						n[0] = n[this.length],
						n[1] = n[this.length + 1],
						i = 0;
					!((e = 2 * i + 2) >= this.length) &&
					(e + 2 < this.length && n[e + 2] > n[e] && (e += 2),
					n[e] > n[i]);

				)
					(t = n[i]),
						(n[i] = n[e]),
						(n[e] = t),
						(t = n[i + 1]),
						(n[i + 1] = n[e + 1]),
						(n[e + 1] = t),
						(i = e);
				return { index: o, value: r, length: this.length };
			});
		for (
			var ot = 2, u = { NONE: 0, r: 1, j: ot, N: 3 }, st = [], _ = 0;
			_ < 288;
			_++
		)
			switch (it) {
				case _ <= 143:
					st.push([_ + 48, 8]);
					break;
				case _ <= 255:
					st.push([_ - 144 + 400, 9]);
					break;
				case _ <= 279:
					st.push([_ - 256, 7]);
					break;
				case _ <= 287:
					st.push([_ - 280 + 192, 8]);
					break;
				default:
					tt('invalid literal: ' + _);
			}
		function R(t, e) {
			(this.length = t), (this.G = e);
		}
		l.prototype.n = function () {
			var t,
				e,
				i,
				n = this.input;
			switch (this.h) {
				case 0:
					for (e = 0, i = n.length; e < i; ) {
						var r,
							o,
							s,
							c,
							a = (s = nt
								? n.subarray(e, e + 65535)
								: n.slice(e, e + 65535)),
							l = (e += s.length) === i,
							h = et,
							u = this.a,
							_ = this.b;
						if (nt) {
							for (
								u = new Uint8Array(this.a.buffer);
								u.length <= _ + a.length + 5;

							)
								u = new Uint8Array(u.length << 1);
							u.set(this.a);
						}
						if (
							((r = l ? 1 : 0),
							(u[_++] = 0 | r),
							(s = (65536 + ~(o = a.length)) & 65535),
							(u[_++] = 255 & o),
							(u[_++] = (o >>> 8) & 255),
							(u[_++] = 255 & s),
							(u[_++] = (s >>> 8) & 255),
							nt)
						)
							u.set(a, _),
								(_ += a.length),
								(u = u.subarray(0, _));
						else {
							for (h = 0, c = a.length; h < c; ++h) u[_++] = a[h];
							u.length = _;
						}
						(this.b = _), (this.a = u);
					}
					break;
				case 1:
					var d = new rt(new Uint8Array(this.a.buffer), this.b);
					d.d(1, 1, it), d.d(1, 2, it);
					for (
						var p, f = ct(this, n), m = 0, g = f.length;
						m < g;
						m++
					)
						if (
							((p = f[m]),
							rt.prototype.d.apply(d, st[p]),
							256 < p)
						)
							d.d(f[++m], f[++m], it),
								d.d(f[++m], 5),
								d.d(f[++m], f[++m], it);
						else if (256 === p) break;
					(this.a = d.finish()), (this.b = this.a.length);
					break;
				case ot:
					var y,
						T,
						S,
						C,
						x,
						v,
						E,
						A,
						b,
						R,
						P,
						I,
						w = new rt(new Uint8Array(this.a), this.b),
						D = [
							16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13,
							2, 14, 1, 15,
						],
						L = Array(19),
						O = ot;
					for (
						w.d(1, 1, it),
							w.d(O, 2, it),
							y = ct(this, n),
							j = lt((x = at(this.L, 15))),
							O = lt((v = at(this.K, 7))),
							T = 286;
						257 < T && 0 === x[T - 1];
						T--
					);
					for (S = 30; 1 < S && 0 === v[S - 1]; S--);
					for (
						var B,
							N,
							F,
							M,
							V,
							k = T,
							G = S,
							W = new (nt ? Uint32Array : Array)(k + G),
							z = new (nt ? Uint32Array : Array)(316),
							U = new (nt ? Uint8Array : Array)(19),
							Y = (B = 0);
						Y < k;
						Y++
					)
						W[B++] = x[Y];
					for (Y = 0; Y < G; Y++) W[B++] = v[Y];
					if (!nt) for (Y = 0, F = U.length; Y < F; ++Y) U[Y] = 0;
					for (Y = M = 0, F = W.length; Y < F; Y += B) {
						for (B = 1; Y + B < F && W[Y + B] === W[Y]; ++B);
						if (((N = B), 0 === W[Y]))
							if (N < 3) for (; 0 < N--; ) U[(z[M++] = 0)]++;
							else
								for (; 0 < N; )
									N - 3 < (V = N < 138 ? N : 138) &&
										V < N &&
										(V = N - 3),
										V <= 10
											? ((z[M++] = 17),
											  (z[M++] = V - 3),
											  U[17]++)
											: ((z[M++] = 18),
											  (z[M++] = V - 11),
											  U[18]++),
										(N -= V);
						else if (((z[M++] = W[Y]), U[W[Y]]++, --N < 3))
							for (; 0 < N--; ) (z[M++] = W[Y]), U[W[Y]]++;
						else
							for (; 0 < N; )
								N - 3 < (V = N < 6 ? N : 6) &&
									V < N &&
									(V = N - 3),
									(z[M++] = 16),
									(z[M++] = V - 3),
									U[16]++,
									(N -= V);
					}
					for (
						t = nt ? z.subarray(0, M) : z.slice(0, M),
							E = at(U, 7),
							P = 0;
						P < 19;
						P++
					)
						L[P] = E[D[P]];
					for (C = 19; 4 < C && 0 === L[C - 1]; C--);
					for (
						A = lt(E),
							w.d(T - 257, 5, it),
							w.d(S - 1, 5, it),
							w.d(C - 4, 4, it),
							P = 0;
						P < C;
						P++
					)
						w.d(L[P], 3, it);
					for (P = 0, I = t.length; P < I; P++)
						if (((b = t[P]), w.d(A[b], E[b], it), 16 <= b)) {
							switch ((P++, b)) {
								case 16:
									R = 2;
									break;
								case 17:
									R = 3;
									break;
								case 18:
									R = 7;
									break;
								default:
									tt('invalid code: ' + b);
							}
							w.d(t[P], R, it);
						}
					for (
						var X,
							H,
							j = [j, x],
							O = [O, v],
							q = j[0],
							J = j[1],
							Z = O[0],
							K = O[1],
							Q = 0,
							$ = y.length;
						Q < $;
						++Q
					)
						if (((X = y[Q]), w.d(q[X], J[X], it), 256 < X))
							w.d(y[++Q], y[++Q], it),
								(H = y[++Q]),
								w.d(Z[H], K[H], it),
								w.d(y[++Q], y[++Q], it);
						else if (256 === X) break;
					(this.a = w.finish()), (this.b = this.a.length);
					break;
				default:
					tt('invalid compression type');
			}
			return this.a;
		};
		for (var d, p = [], f = 3; f <= 258; f++)
			(d = (function () {
				var t = f;
				switch (it) {
					case 3 === t:
						return [257, t - 3, 0];
					case 4 === t:
						return [258, t - 4, 0];
					case 5 === t:
						return [259, t - 5, 0];
					case 6 === t:
						return [260, t - 6, 0];
					case 7 === t:
						return [261, t - 7, 0];
					case 8 === t:
						return [262, t - 8, 0];
					case 9 === t:
						return [263, t - 9, 0];
					case 10 === t:
						return [264, t - 10, 0];
					case t <= 12:
						return [265, t - 11, 1];
					case t <= 14:
						return [266, t - 13, 1];
					case t <= 16:
						return [267, t - 15, 1];
					case t <= 18:
						return [268, t - 17, 1];
					case t <= 22:
						return [269, t - 19, 2];
					case t <= 26:
						return [270, t - 23, 2];
					case t <= 30:
						return [271, t - 27, 2];
					case t <= 34:
						return [272, t - 31, 2];
					case t <= 42:
						return [273, t - 35, 3];
					case t <= 50:
						return [274, t - 43, 3];
					case t <= 58:
						return [275, t - 51, 3];
					case t <= 66:
						return [276, t - 59, 3];
					case t <= 82:
						return [277, t - 67, 4];
					case t <= 98:
						return [278, t - 83, 4];
					case t <= 114:
						return [279, t - 99, 4];
					case t <= 130:
						return [280, t - 115, 4];
					case t <= 162:
						return [281, t - 131, 5];
					case t <= 194:
						return [282, t - 163, 5];
					case t <= 226:
						return [283, t - 195, 5];
					case t <= 257:
						return [284, t - 227, 5];
					case 258 === t:
						return [285, t - 258, 0];
					default:
						tt('invalid length: ' + t);
				}
			})()),
				(p[f] = (d[2] << 24) | (d[1] << 16) | d[0]);
		var P = nt ? new Uint32Array(p) : p;
		function ct(t, e) {
			function i(t, e) {
				var i,
					n,
					r,
					o = t.G,
					s = [],
					c = 0,
					a = P[t.length];
				switch (
					((s[c++] = 65535 & a),
					(s[c++] = (a >> 16) & 255),
					(s[c++] = a >> 24),
					it)
				) {
					case 1 === o:
						i = [0, o - 1, 0];
						break;
					case 2 === o:
						i = [1, o - 2, 0];
						break;
					case 3 === o:
						i = [2, o - 3, 0];
						break;
					case 4 === o:
						i = [3, o - 4, 0];
						break;
					case o <= 6:
						i = [4, o - 5, 1];
						break;
					case o <= 8:
						i = [5, o - 7, 1];
						break;
					case o <= 12:
						i = [6, o - 9, 2];
						break;
					case o <= 16:
						i = [7, o - 13, 2];
						break;
					case o <= 24:
						i = [8, o - 17, 3];
						break;
					case o <= 32:
						i = [9, o - 25, 3];
						break;
					case o <= 48:
						i = [10, o - 33, 4];
						break;
					case o <= 64:
						i = [11, o - 49, 4];
						break;
					case o <= 96:
						i = [12, o - 65, 5];
						break;
					case o <= 128:
						i = [13, o - 97, 5];
						break;
					case o <= 192:
						i = [14, o - 129, 6];
						break;
					case o <= 256:
						i = [15, o - 193, 6];
						break;
					case o <= 384:
						i = [16, o - 257, 7];
						break;
					case o <= 512:
						i = [17, o - 385, 7];
						break;
					case o <= 768:
						i = [18, o - 513, 8];
						break;
					case o <= 1024:
						i = [19, o - 769, 8];
						break;
					case o <= 1536:
						i = [20, o - 1025, 9];
						break;
					case o <= 2048:
						i = [21, o - 1537, 9];
						break;
					case o <= 3072:
						i = [22, o - 2049, 10];
						break;
					case o <= 4096:
						i = [23, o - 3073, 10];
						break;
					case o <= 6144:
						i = [24, o - 4097, 11];
						break;
					case o <= 8192:
						i = [25, o - 6145, 11];
						break;
					case o <= 12288:
						i = [26, o - 8193, 12];
						break;
					case o <= 16384:
						i = [27, o - 12289, 12];
						break;
					case o <= 24576:
						i = [28, o - 16385, 13];
						break;
					case o <= 32768:
						i = [29, o - 24577, 13];
						break;
					default:
						tt('invalid distance');
				}
				for (
					a = i,
						s[c++] = a[0],
						s[+c] = a[1],
						s[5] = a[2],
						n = 0,
						r = s.length;
					n < r;
					++n
				)
					d[p++] = s[n];
				m[s[0]]++, g[s[3]]++, (f = t.length + e - 1), (h = null);
			}
			var n,
				r,
				o,
				s,
				c,
				a,
				l,
				h,
				u,
				_ = {},
				d = nt ? new Uint16Array(2 * e.length) : [],
				p = 0,
				f = 0,
				m = new (nt ? Uint32Array : Array)(286),
				g = new (nt ? Uint32Array : Array)(30),
				y = t.w;
			if (!nt) {
				for (o = 0; o <= 285; ) m[o++] = 0;
				for (o = 0; o <= 29; ) g[o++] = 0;
			}
			for (m[256] = 1, n = 0, r = e.length; n < r; ++n) {
				for (o = c = 0, s = 3; o < s && n + o !== r; ++o)
					c = (c << 8) | e[n + o];
				if ((_[c] === et && (_[c] = []), (a = _[c]), !(0 < f--))) {
					for (; 0 < a.length && 32768 < n - a[0]; ) a.shift();
					if (r <= n + 3) {
						for (h && i(h, -1), o = 0, s = r - n; o < s; ++o)
							(u = e[n + o]), (d[p++] = u), ++m[u];
						break;
					}
					if (0 < a.length) {
						var T,
							S = et,
							C = 0,
							x = et,
							v = et,
							E = et,
							A = e.length,
							v = 0,
							b = a.length;
						t: for (; v < b; v++) {
							if (((T = a[b - v - 1]), (x = 3) < C)) {
								for (E = C; 3 < E; E--)
									if (e[T + E - 1] !== e[n + E - 1])
										continue t;
								x = C;
							}
							for (
								;
								x < 258 && n + x < A && e[T + x] === e[n + x];

							)
								++x;
							if ((C < x && ((S = T), (C = x)), 258 === x)) break;
						}
						(l = new R(C, n - S)),
							h
								? h.length < l.length
									? ((u = e[n - 1]),
									  (d[p++] = u),
									  ++m[u],
									  i(l, 0))
									: i(h, -1)
								: l.length < y
								? (h = l)
								: i(l, 0);
					} else h ? i(h, -1) : ((u = e[n]), (d[p++] = u), ++m[u]);
				}
				a.push(n);
			}
			return (
				(d[p++] = 256),
				m[256]++,
				(t.L = m),
				(t.K = g),
				nt ? d.subarray(0, p) : d
			);
		}
		function at(t, e) {
			var i,
				n,
				r,
				o,
				s,
				c = t.length,
				a = new E(572),
				l = new (nt ? Uint8Array : Array)(c);
			if (!nt) for (o = 0; o < c; o++) l[o] = 0;
			for (o = 0; o < c; ++o) 0 < t[o] && a.push(o, t[o]);
			if (
				((i = Array(a.length / 2)),
				(n = new (nt ? Uint32Array : Array)(a.length / 2)),
				1 === i.length)
			)
				return (l[a.pop().index] = 1), l;
			for (o = 0, s = a.length / 2; o < s; ++o)
				(i[o] = a.pop()), (n[o] = i[o].value);
			var h,
				u,
				_,
				d,
				p,
				f = n.length,
				m = new (nt ? Uint16Array : Array)(e),
				g = new (nt ? Uint8Array : Array)(e),
				y = new (nt ? Uint8Array : Array)(f),
				T = Array(e),
				S = Array(e),
				C = Array(e),
				x = (1 << e) - f,
				v = 1 << (e - 1);
			for (m[e - 1] = f, u = 0; u < e; ++u)
				x < v ? (g[u] = 0) : ((g[u] = 1), (x -= v)),
					(x <<= 1),
					(m[e - 2 - u] = ((m[e - 1 - u] / 2) | 0) + f);
			for (
				m[0] = g[0], T[0] = Array(m[0]), S[0] = Array(m[0]), u = 1;
				u < e;
				++u
			)
				m[u] > 2 * m[u - 1] + g[u] && (m[u] = 2 * m[u - 1] + g[u]),
					(T[u] = Array(m[u])),
					(S[u] = Array(m[u]));
			for (h = 0; h < f; ++h) y[h] = e;
			for (_ = 0; _ < m[e - 1]; ++_)
				(T[e - 1][_] = n[_]), (S[e - 1][_] = _);
			for (h = 0; h < e; ++h) C[h] = 0;
			for (
				1 === g[e - 1] && (--y[0], ++C[e - 1]), u = e - 2;
				0 <= u;
				--u
			) {
				for (h = 0, p = C[u + 1], _ = 0; _ < m[u]; _++)
					(d = T[u + 1][p] + T[u + 1][p + 1]) > n[h]
						? ((T[u][_] = d), (S[u][_] = f), (p += 2))
						: ((T[u][_] = n[h]), (S[u][_] = h), ++h);
				(C[u] = 0),
					1 === g[u] &&
						(function t(e) {
							var i = S[e][C[e]];
							i === f ? (t(e + 1), t(e + 1)) : --y[i], ++C[e];
						})(u);
			}
			for (r = y, o = 0, s = i.length; o < s; ++o) l[i[o].index] = r[o];
			return l;
		}
		function lt(t) {
			for (
				var e,
					i,
					n = new (nt ? Uint16Array : Array)(t.length),
					r = [],
					o = [],
					s = 0,
					c = 0,
					a = t.length;
				c < a;
				c++
			)
				r[t[c]] = 1 + (0 | r[t[c]]);
			for (c = 1, a = 16; c <= a; c++)
				(o[c] = s),
					1 << c < (s += 0 | r[c]) && tt('overcommitted'),
					(s <<= 1);
			for (
				s < 65536 && tt('undercommitted'), c = 0, a = t.length;
				c < a;
				c++
			)
				for (
					s = o[t[c]], o[t[c]] += 1, e = n[c] = 0, i = t[c];
					e < i;
					e++
				)
					(n[c] = (n[c] << 1) | (1 & s)), (s >>>= 1);
			return n;
		}
		function m(t, e) {
			(this.input = t),
				(this.a = new (nt ? Uint8Array : Array)(32768)),
				(this.h = g.j);
			var i,
				n = {};
			for (i in ((e
				? 'number' == typeof e.compressionType
				: ((e = {}), 0)) && (this.h = e.compressionType),
			e))
				n[i] = e[i];
			(n.outputBuffer = this.a), (this.z = new l(this.input, n));
		}
		var g = u;
		function y(t, e) {
			switch (
				((this.k = []),
				(this.l = 32768),
				(this.e = this.g = this.c = this.q = 0),
				(this.input = nt ? new Uint8Array(t) : t),
				(this.s = !1),
				(this.m = S),
				(this.B = !1),
				e
					? (e.index && (this.c = e.index),
					  e.bufferSize && (this.l = e.bufferSize),
					  e.bufferType && (this.m = e.bufferType),
					  e.resize && (this.B = e.resize))
					: (e = {}),
				this.m)
			) {
				case T:
					(this.b = 32768),
						(this.a = new (nt ? Uint8Array : Array)(
							32768 + this.l + 258
						));
					break;
				case S:
					(this.b = 0),
						(this.a = new (nt ? Uint8Array : Array)(this.l)),
						(this.f = this.J),
						(this.t = this.H),
						(this.o = this.I);
					break;
				default:
					tt(Error('invalid inflate mode'));
			}
		}
		(m.prototype.n = function () {
			var t,
				e,
				i = 0,
				n = this.a,
				r = j;
			if (
				(r === j
					? (t = Math.LOG2E * Math.log(32768) - 8)
					: tt(Error('invalid compression method')),
				(t = (t << 4) | r),
				(n[i++] = t),
				r === j)
			)
				switch (this.h) {
					case g.NONE:
						e = 0;
						break;
					case g.r:
						e = 1;
						break;
					case g.j:
						e = 2;
						break;
					default:
						tt(Error('unsupported compression type'));
				}
			else tt(Error('invalid compression method'));
			return (
				(r = (e << 6) | 0),
				(n[i++] = r | (31 - ((256 * t + r) % 31))),
				(r = s(this.input)),
				(this.z.b = i),
				(i = (n = this.z.n()).length),
				nt &&
					((n = new Uint8Array(n.buffer)).length <= i + 4 &&
						((this.a = new Uint8Array(n.length + 4)),
						this.a.set(n),
						(n = this.a)),
					(n = n.subarray(0, i + 4))),
				(n[i++] = (r >> 24) & 255),
				(n[i++] = (r >> 16) & 255),
				(n[i++] = (r >> 8) & 255),
				(n[i++] = 255 & r),
				n
			);
		}),
			t('Zlib.Deflate', m),
			t('Zlib.Deflate.compress', function (t, e) {
				return new m(t, e).n();
			}),
			t('Zlib.Deflate.CompressionType', g),
			t('Zlib.Deflate.CompressionType.NONE', g.NONE),
			t('Zlib.Deflate.CompressionType.FIXED', g.r),
			t('Zlib.Deflate.CompressionType.DYNAMIC', g.j);
		var T = 0,
			S = 1,
			C = { D: T, C: S };
		y.prototype.p = function () {
			for (; !this.s; ) {
				var t = V(this, 3);
				switch ((1 & t && (this.s = it), (t >>>= 1))) {
					case 0:
						var e,
							i,
							n = this.input,
							r = this.c,
							o = this.a,
							s = this.b,
							c = et,
							a = o.length,
							l = et;
						switch (
							((this.e = this.g = 0),
							(e = n[r++]) === et &&
								tt(
									Error(
										'invalid uncompressed block header: LEN (first byte)'
									)
								),
							(c = e),
							(e = n[r++]) === et &&
								tt(
									Error(
										'invalid uncompressed block header: LEN (second byte)'
									)
								),
							(c |= e << 8),
							(e = n[r++]) === et &&
								tt(
									Error(
										'invalid uncompressed block header: NLEN (first byte)'
									)
								),
							(i = e),
							(e = n[r++]) === et &&
								tt(
									Error(
										'invalid uncompressed block header: NLEN (second byte)'
									)
								),
							c === ~(i |= e << 8) &&
								tt(
									Error(
										'invalid uncompressed block header: length verify'
									)
								),
							r + c > n.length &&
								tt(Error('input buffer is broken')),
							this.m)
						) {
							case T:
								for (; s + c > o.length; ) {
									if (((c -= l = a - s), nt))
										o.set(n.subarray(r, r + l), s),
											(s += l),
											(r += l);
									else for (; l--; ) o[s++] = n[r++];
									(this.b = s), (o = this.f()), (s = this.b);
								}
								break;
							case S:
								for (; s + c > o.length; ) o = this.f({ v: 2 });
								break;
							default:
								tt(Error('invalid inflate mode'));
						}
						if (nt)
							o.set(n.subarray(r, r + c), s), (s += c), (r += c);
						else for (; c--; ) o[s++] = n[r++];
						(this.c = r), (this.b = s), (this.a = o);
						break;
					case 1:
						this.o(O, M);
						break;
					case 2:
						!(function (t) {
							function e(t, e, i) {
								for (var n, r, o, s = 0; s < t; )
									switch (((n = k(this, e)), n)) {
										case 16:
											for (o = 3 + V(this, 2); o--; )
												i[s++] = r;
											break;
										case 17:
											for (o = 3 + V(this, 3); o--; )
												i[s++] = 0;
											r = 0;
											break;
										case 18:
											for (o = 11 + V(this, 7); o--; )
												i[s++] = 0;
											r = 0;
											break;
										default:
											r = i[s++] = n;
									}
								return i;
							}
							var i,
								n,
								r,
								o,
								s = V(t, 5) + 257,
								c = V(t, 5) + 1,
								a = V(t, 4) + 4,
								l = new (nt ? Uint8Array : Array)(x.length);
							for (o = 0; o < a; ++o) l[x[o]] = V(t, 3);
							(i = h(l)),
								(n = new (nt ? Uint8Array : Array)(s)),
								(r = new (nt ? Uint8Array : Array)(c)),
								t.o(
									h(e.call(t, s, i, n)),
									h(e.call(t, c, i, r))
								);
						})(this);
						break;
					default:
						tt(Error('unknown BTYPE: ' + t));
				}
			}
			return this.t();
		};
		for (
			var u = [
					16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14,
					1, 15,
				],
				x = nt ? new Uint16Array(u) : u,
				u = [
					3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35,
					43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 258,
					258,
				],
				v = nt ? new Uint16Array(u) : u,
				u = [
					0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3,
					4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0,
				],
				A = nt ? new Uint8Array(u) : u,
				u = [
					1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193,
					257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145,
					8193, 12289, 16385, 24577,
				],
				b = nt ? new Uint16Array(u) : u,
				u = [
					0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8,
					9, 9, 10, 10, 11, 11, 12, 12, 13, 13,
				],
				I = nt ? new Uint8Array(u) : u,
				w = new (nt ? Uint8Array : Array)(288),
				D = 0,
				L = w.length;
			D < L;
			++D
		)
			w[D] = D <= 143 ? 8 : D <= 255 ? 9 : D <= 279 ? 7 : 8;
		for (
			var O = h(w),
				B = new (nt ? Uint8Array : Array)(30),
				N = 0,
				F = B.length;
			N < F;
			++N
		)
			B[N] = 5;
		var M = h(B);
		function V(t, e) {
			for (var i, n = t.g, r = t.e, o = t.input, s = t.c; r < e; )
				(i = o[s++]) === et && tt(Error('input buffer is broken')),
					(n |= i << r),
					(r += 8);
			return (
				(i = n & ((1 << e) - 1)),
				(t.g = n >>> e),
				(t.e = r - e),
				(t.c = s),
				i
			);
		}
		function k(t, e) {
			for (
				var i,
					n = t.g,
					r = t.e,
					o = t.input,
					s = t.c,
					c = e[0],
					a = e[1];
				r < a;

			)
				(i = o[s++]) === et && tt(Error('input buffer is broken')),
					(n |= i << r),
					(r += 8);
			return (
				(c = (e = c[n & ((1 << a) - 1)]) >>> 16),
				(t.g = n >> c),
				(t.e = r - c),
				(t.c = s),
				65535 & e
			);
		}
		function G(t, e) {
			var i, n;
			(this.input = t),
				(this.c = 0),
				e
					? (e.index && (this.c = e.index),
					  e.verify && (this.M = e.verify))
					: (e = {}),
				(i = t[this.c++]),
				(n = t[this.c++]),
				(15 & i) === j
					? (this.method = j)
					: tt(Error('unsupported compression method')),
				0 != ((i << 8) + n) % 31 &&
					tt(Error('invalid fcheck flag:' + (((i << 8) + n) % 31))),
				32 & n && tt(Error('fdict flag is not supported')),
				(this.A = new y(t, {
					index: this.c,
					bufferSize: e.bufferSize,
					bufferType: e.bufferType,
					resize: e.resize,
				}));
		}
		(y.prototype.o = function (t, e) {
			var i = this.a,
				n = this.b;
			this.u = t;
			for (var r, o, s, c, a = i.length - 258; 256 !== (r = k(this, t)); )
				if (r < 256)
					a <= n && ((this.b = n), (i = this.f()), (n = this.b)),
						(i[n++] = r);
				else
					for (
						c = v[(o = r - 257)],
							0 < A[o] && (c += V(this, A[o])),
							r = k(this, e),
							s = b[r],
							0 < I[r] && (s += V(this, I[r])),
							a <= n &&
								((this.b = n), (i = this.f()), (n = this.b));
						c--;

					)
						i[n] = i[n++ - s];
			for (; 8 <= this.e; ) (this.e -= 8), this.c--;
			this.b = n;
		}),
			(y.prototype.I = function (t, e) {
				var i = this.a,
					n = this.b;
				this.u = t;
				for (var r, o, s, c, a = i.length; 256 !== (r = k(this, t)); )
					if (r < 256)
						a <= n && (a = (i = this.f()).length), (i[n++] = r);
					else
						for (
							c = v[(o = r - 257)],
								0 < A[o] && (c += V(this, A[o])),
								r = k(this, e),
								s = b[r],
								0 < I[r] && (s += V(this, I[r])),
								a < n + c && (a = (i = this.f()).length);
							c--;

						)
							i[n] = i[n++ - s];
				for (; 8 <= this.e; ) (this.e -= 8), this.c--;
				this.b = n;
			}),
			(y.prototype.f = function () {
				var t,
					e,
					i = new (nt ? Uint8Array : Array)(this.b - 32768),
					n = this.b - 32768,
					r = this.a;
				if (nt) i.set(r.subarray(32768, i.length));
				else for (t = 0, e = i.length; t < e; ++t) i[t] = r[t + 32768];
				if ((this.k.push(i), (this.q += i.length), nt))
					r.set(r.subarray(n, 32768 + n));
				else for (t = 0; t < 32768; ++t) r[t] = r[n + t];
				return (this.b = 32768), r;
			}),
			(y.prototype.J = function (t) {
				var e,
					i = (this.input.length / this.c + 1) | 0,
					n = this.input,
					r = this.a;
				return (
					t &&
						('number' == typeof t.v && (i = t.v),
						'number' == typeof t.F && (i += t.F)),
					(i =
						i < 2
							? (n =
									(((n.length - this.c) / this.u[2] / 2) *
										258) |
									0) < r.length
								? r.length + n
								: r.length << 1
							: r.length * i),
					nt ? (e = new Uint8Array(i)).set(r) : (e = r),
					(this.a = e)
				);
			}),
			(y.prototype.t = function () {
				var t,
					e,
					i,
					n,
					r,
					o = 0,
					s = this.a,
					c = this.k,
					a = new (nt ? Uint8Array : Array)(
						this.q + (this.b - 32768)
					);
				if (0 === c.length)
					return nt
						? this.a.subarray(32768, this.b)
						: this.a.slice(32768, this.b);
				for (e = 0, i = c.length; e < i; ++e)
					for (n = 0, r = (t = c[e]).length; n < r; ++n)
						a[o++] = t[n];
				for (e = 32768, i = this.b; e < i; ++e) a[o++] = s[e];
				return (this.k = []), (this.buffer = a);
			}),
			(y.prototype.H = function () {
				var t,
					e = this.b;
				return (
					nt
						? this.B
							? (t = new Uint8Array(e)).set(this.a.subarray(0, e))
							: (t = this.a.subarray(0, e))
						: (this.a.length > e && (this.a.length = e),
						  (t = this.a)),
					(this.buffer = t)
				);
			}),
			(G.prototype.p = function () {
				var t = this.input,
					e = this.A.p();
				return (
					(this.c = this.A.c),
					this.M &&
						((t[this.c++] << 24) |
							(t[this.c++] << 16) |
							(t[this.c++] << 8) |
							t[this.c++]) >>>
							0 !==
							s(e) &&
						tt(Error('invalid adler-32 checksum')),
					e
				);
			}),
			t('Zlib.Inflate', G),
			t('Zlib.Inflate.BufferType', C),
			(C.ADAPTIVE = C.C),
			(C.BLOCK = C.D),
			t('Zlib.Inflate.prototype.decompress', G.prototype.p);
		nt &&
			new Uint16Array([
				16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1,
				15,
			]);
		nt &&
			new Uint16Array([
				3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43,
				51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 258, 258,
			]);
		nt &&
			new Uint8Array([
				0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4,
				4, 4, 4, 5, 5, 5, 5, 0, 0, 0,
			]);
		nt &&
			new Uint16Array([
				1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257,
				385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289,
				16385, 24577,
			]);
		nt &&
			new Uint8Array([
				0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9,
				9, 10, 10, 11, 11, 12, 12, 13, 13,
			]);
		for (
			var W = new (nt ? Uint8Array : Array)(288), z = 0, U = W.length;
			z < U;
			++z
		)
			W[z] = z <= 143 ? 8 : z <= 255 ? 9 : z <= 279 ? 7 : 8;
		h(W);
		for (
			var Y = new (nt ? Uint8Array : Array)(30), X = 0, H = Y.length;
			X < H;
			++X
		)
			Y[X] = 5;
		h(Y);
		var j = 8;
	}.call(this);
var _p = window;
(_p = _p.Zlib = _p.Zlib),
	(_p.Deflate = _p.Deflate),
	(_p.Deflate.compress = _p.Deflate.compress),
	(_p.Inflate = _p.Inflate),
	(_p.Inflate.BufferType = _p.Inflate.BufferType),
	(_p.Inflate.prototype.decompress = _p.Inflate.prototype.decompress),
	(cc.PNGReader = cc.Class.extend({
		ctor: function (t) {
			var e, i, n, r, o, s, c, a, l;
			for (
				this.data = t,
					this.pos = 8,
					this.palette = [],
					this.imgData = [],
					this.transparency = {},
					this.animation = null,
					this.text = {},
					i = null;
				;

			) {
				switch (
					((e = this.readUInt32()),
					(r = function () {
						var t,
							e = [];
						for (t = 0; t < 4; ++t)
							e.push(String.fromCharCode(this.data[this.pos++]));
						return e;
					}
						.call(this)
						.join('')))
				) {
					case 'IHDR':
						(this.width = this.readUInt32()),
							(this.height = this.readUInt32()),
							(this.bits = this.data[this.pos++]),
							(this.colorType = this.data[this.pos++]),
							(this.compressionMethod = this.data[this.pos++]),
							(this.filterMethod = this.data[this.pos++]),
							(this.interlaceMethod = this.data[this.pos++]);
						break;
					case 'acTL':
						this.animation = {
							numFrames: this.readUInt32(),
							numPlays: this.readUInt32() || 1 / 0,
							frames: [],
						};
						break;
					case 'PLTE':
						this.palette = this.read(e);
						break;
					case 'fcTL':
						i && this.animation.frames.push(i),
							(this.pos += 4),
							(i = {
								width: this.readUInt32(),
								height: this.readUInt32(),
								xOffset: this.readUInt32(),
								yOffset: this.readUInt32(),
							}),
							(s = this.readUInt16()),
							(n = this.readUInt16() || 100),
							(i.delay = (1e3 * s) / n),
							(i.disposeOp = this.data[this.pos++]),
							(i.blendOp = this.data[this.pos++]),
							(i.data = []);
						break;
					case 'IDAT':
					case 'fdAT':
						for (
							'fdAT' === r && ((this.pos += 4), (e -= 4)),
								t =
									(null != i ? i.data : void 0) ||
									this.imgData,
								c = 0;
							0 <= e ? c < e : e < c;
							0 <= e ? ++c : --c
						)
							t.push(this.data[this.pos++]);
						break;
					case 'tRNS':
						switch (((this.transparency = {}), this.colorType)) {
							case 3:
								if (
									((this.transparency.indexed = this.read(e)),
									0 <
										(o =
											255 -
											this.transparency.indexed.length))
								)
									for (
										a = 0;
										0 <= o ? a < o : o < a;
										0 <= o ? ++a : --a
									)
										this.transparency.indexed.push(255);
								break;
							case 0:
								this.transparency.grayscale = this.read(e)[0];
								break;
							case 2:
								this.transparency.rgb = this.read(e);
						}
						break;
					case 'tEXt':
						(l = (s = this.read(e)).indexOf(0)),
							(n = String.fromCharCode.apply(
								String,
								s.slice(0, l)
							)),
							(this.text[n] = String.fromCharCode.apply(
								String,
								s.slice(l + 1)
							));
						break;
					case 'IEND':
						return (
							i && this.animation.frames.push(i),
							(this.colors = function () {
								switch (this.colorType) {
									case 0:
									case 3:
									case 4:
										return 1;
									case 2:
									case 6:
										return 3;
								}
							}.call(this)),
							(this.hasAlphaChannel =
								4 === (l = this.colorType) || 6 === l),
							(l = this.colors + (this.hasAlphaChannel ? 1 : 0)),
							(this.pixelBitlength = this.bits * l),
							(this.colorSpace = function () {
								switch (this.colors) {
									case 1:
										return 'DeviceGray';
									case 3:
										return 'DeviceRGB';
								}
							}.call(this)),
							void (
								Uint8Array != Array &&
								(this.imgData = new Uint8Array(this.imgData))
							)
						);
					default:
						this.pos += e;
				}
				if (((this.pos += 4), this.pos > this.data.length))
					throw new Error('Incomplete or corrupt PNG file');
			}
		},
		read: function (t) {
			var e,
				i = [];
			for (e = 0; 0 <= t ? e < t : t < e; 0 <= t ? ++e : --e)
				i.push(this.data[this.pos++]);
			return i;
		},
		readUInt32: function () {
			return (
				(this.data[this.pos++] << 24) |
				(this.data[this.pos++] << 16) |
				(this.data[this.pos++] << 8) |
				this.data[this.pos++]
			);
		},
		readUInt16: function () {
			return (this.data[this.pos++] << 8) | this.data[this.pos++];
		},
		decodePixels: function (t) {
			var e, i, n, r, o, s, c, a, l, h, u, _, d, p, f, m, g, y, T, S, C;
			if ((null == t && (t = this.imgData), 0 === t.length))
				return new Uint8Array(0);
			for (
				t = new Zlib.Inflate(t, { index: 0, verify: !1 }).decompress(),
					p = (h = this.pixelBitlength / 8) * this.width,
					u = new Uint8Array(p * this.height),
					s = t.length,
					i = _ = d = 0;
				_ < s;

			) {
				switch (t[_++]) {
					case 0:
						for (r = g = 0; g < p; r = g += 1) u[i++] = t[_++];
						break;
					case 1:
						for (r = y = 0; y < p; r = y += 1)
							(e = t[_++]),
								(o = r < h ? 0 : u[i - h]),
								(u[i++] = (e + o) % 256);
						break;
					case 2:
						for (r = T = 0; T < p; r = T += 1)
							(e = t[_++]),
								(n = (r - (r % h)) / h),
								(f = d && u[(d - 1) * p + n * h + (r % h)]),
								(u[i++] = (f + e) % 256);
						break;
					case 3:
						for (r = S = 0; S < p; r = S += 1)
							(e = t[_++]),
								(n = (r - (r % h)) / h),
								(o = r < h ? 0 : u[i - h]),
								(f = d && u[(d - 1) * p + n * h + (r % h)]),
								(u[i++] = (e + Math.floor((o + f) / 2)) % 256);
						break;
					case 4:
						for (r = C = 0; C < p; r = C += 1)
							(e = t[_++]),
								(n = (r - (r % h)) / h),
								(o = r < h ? 0 : u[i - h]),
								0 === d
									? (f = m = 0)
									: ((f = u[(d - 1) * p + n * h + (r % h)]),
									  (m =
											n &&
											u[
												(d - 1) * p +
													(n - 1) * h +
													(r % h)
											])),
								(l = o + f - m),
								(c = Math.abs(l - o)),
								(a = Math.abs(l - f)),
								(l = Math.abs(l - m)),
								(l = c <= a && c <= l ? o : a <= l ? f : m),
								(u[i++] = (e + l) % 256);
						break;
					default:
						throw new Error(
							'Invalid filter algorithm: ' + t[_ - 1]
						);
				}
				d++;
			}
			return u;
		},
		copyToImageData: function (t, e) {
			var i,
				n,
				r,
				o,
				s,
				c,
				a,
				l,
				h = this.colors,
				u = null,
				_ = this.hasAlphaChannel;
			if (
				(this.palette.length &&
					((u =
						null != (l = this._decodedPalette)
							? l
							: (this._decodedPalette = this.decodePalette())),
					(h = 4),
					(_ = !0)),
				(c = (i = t.data || t).length),
				(r = u || e),
				(n = o = 0),
				1 === h)
			)
				for (; n < c; )
					(s = u ? 4 * e[n / 4] : o),
						(a = r[s++]),
						(i[n++] = a),
						(i[n++] = a),
						(i[n++] = a),
						(i[n++] = _ ? r[s++] : 255),
						(o = s);
			else
				for (; n < c; )
					(s = u ? 4 * e[n / 4] : o),
						(i[n++] = r[s++]),
						(i[n++] = r[s++]),
						(i[n++] = r[s++]),
						(i[n++] = _ ? r[s++] : 255),
						(o = s);
		},
		decodePalette: function () {
			for (
				var t,
					e,
					i = this.palette,
					n = this.transparency.indexed || [],
					r = new Uint8Array((n.length || 0) + i.length),
					o = 0,
					s = 0,
					c = (t = 0),
					a = i.length;
				t < a;
				c = t += 3
			)
				(r[o++] = i[c]),
					(r[o++] = i[c + 1]),
					(r[o++] = i[c + 2]),
					(r[o++] = null != (e = n[s++]) ? e : 255);
			return r;
		},
		render: function (t) {
			var e;
			return (
				(t.width = this.width),
				(t.height = this.height),
				(t = (e = t.getContext('2d')).createImageData(
					this.width,
					this.height
				)),
				this.copyToImageData(t, this.decodePixels()),
				e.putImageData(t, 0, 0)
			);
		},
	})),
	(cc.tiffReader = {
		_littleEndian: !1,
		_tiffData: null,
		_fileDirectories: [],
		getUint8: function (t) {
			return this._tiffData[t];
		},
		getUint16: function (t) {
			return this._littleEndian
				? (this._tiffData[t + 1] << 8) | this._tiffData[t]
				: (this._tiffData[t] << 8) | this._tiffData[t + 1];
		},
		getUint32: function (t) {
			var e = this._tiffData;
			return this._littleEndian
				? (e[t + 3] << 24) | (e[t + 2] << 16) | (e[t + 1] << 8) | e[t]
				: (e[t] << 24) | (e[t + 1] << 16) | (e[t + 2] << 8) | e[t + 3];
		},
		checkLittleEndian: function () {
			var t = this.getUint16(0);
			if (18761 === t) this.littleEndian = !0;
			else {
				if (19789 !== t)
					throw (
						(console.log(t), TypeError('Invalid byte order value.'))
					);
				this.littleEndian = !1;
			}
			return this.littleEndian;
		},
		hasTowel: function () {
			if (42 !== this.getUint16(2))
				throw RangeError('You forgot your towel!');
			return !0;
		},
		getFieldTypeName: function (t) {
			var e = this.fieldTypeNames;
			return t in e ? e[t] : null;
		},
		getFieldTagName: function (t) {
			var e = this.fieldTagNames;
			return t in e
				? e[t]
				: (console.log('Unknown Field Tag:', t), 'Tag' + t);
		},
		getFieldTypeLength: function (t) {
			return -1 !== ['BYTE', 'ASCII', 'SBYTE', 'UNDEFINED'].indexOf(t)
				? 1
				: -1 !== ['SHORT', 'SSHORT'].indexOf(t)
				? 2
				: -1 !== ['LONG', 'SLONG', 'FLOAT'].indexOf(t)
				? 4
				: -1 !== ['RATIONAL', 'SRATIONAL', 'DOUBLE'].indexOf(t)
				? 8
				: null;
		},
		getFieldValues: function (t, e, i, n) {
			var r = [],
				o = this.getFieldTypeLength(e);
			if (o * i <= 4)
				!1 === this.littleEndian
					? r.push(n >>> (8 * (4 - o)))
					: r.push(n);
			else
				for (var s = 0; s < i; s++) {
					var c = o * s;
					8 <= o
						? -1 !== ['RATIONAL', 'SRATIONAL'].indexOf(e)
							? (r.push(this.getUint32(n + c)),
							  r.push(this.getUint32(n + c + 4)))
							: cc.log("Can't handle this field type or size")
						: r.push(this.getBytes(o, n + c));
				}
			return (
				'ASCII' === e &&
					r.forEach(function (t, e, i) {
						i[e] = String.fromCharCode(t);
					}),
				r
			);
		},
		getBytes: function (t, e) {
			if (t <= 0) cc.log('No bytes requested');
			else {
				if (t <= 1) return this.getUint8(e);
				if (t <= 2) return this.getUint16(e);
				if (t <= 3) return this.getUint32(e) >>> 8;
				{
					if (t <= 4) return this.getUint32(e);
					cc.log('Too many bytes requested');
				}
			}
		},
		getBits: function (t, e, i) {
			i = i || 0;
			var n,
				r,
				o = e + Math.floor(i / 8),
				e = i + t,
				t = 32 - t;
			return (
				e <= 0
					? console.log('No bits requested')
					: e <= 8
					? ((n = 24 + i), (r = this.getUint8(o)))
					: e <= 16
					? ((n = 16 + i), (r = this.getUint16(o)))
					: e <= 32
					? ((n = i), (r = this.getUint32(o)))
					: console.log('Too many bits requested'),
				{
					bits: (r << n) >>> t,
					byteOffset: o + Math.floor(e / 8),
					bitOffset: e % 8,
				}
			);
		},
		parseFileDirectory: function (t) {
			for (
				var e = this.getUint16(t), i = [], n = t + 2, r = 0;
				r < e;
				n += 12, r++
			) {
				var o = this.getUint16(n),
					s = this.getUint16(n + 2),
					c = this.getUint32(n + 4),
					a = this.getUint32(n + 8),
					o = this.getFieldTagName(o),
					s = this.getFieldTypeName(s),
					a = this.getFieldValues(o, s, c, a);
				i[o] = { type: s, values: a };
			}
			this._fileDirectories.push(i);
			t = this.getUint32(n);
			0 !== t && this.parseFileDirectory(t);
		},
		clampColorSample: function (t, e) {
			e = Math.pow(2, 8 - e);
			return Math.floor(t * e + (e - 1));
		},
		parseTIFF: function (t, e) {
			if (
				((e = e || document.createElement('canvas')),
				(this._tiffData = t),
				(this.canvas = e),
				this.checkLittleEndian(),
				this.hasTowel())
			) {
				var i = this.getUint32(4);
				(this._fileDirectories.length = 0), this.parseFileDirectory(i);
				var t = this._fileDirectories[0],
					n = t.ImageWidth.values[0],
					i = t.ImageLength.values[0];
				(this.canvas.width = n), (this.canvas.height = i);
				var r,
					o = [],
					s = t.Compression ? t.Compression.values[0] : 1,
					c = t.SamplesPerPixel.values[0],
					a = [],
					l = 0,
					h = !1;
				t.BitsPerSample.values.forEach(function (t, e, i) {
					(a[e] = {
						bitsPerSample: t,
						hasBytesPerSample: !1,
						bytesPerSample: void 0,
					}),
						t % 8 == 0 &&
							((a[e].hasBytesPerSample = !0),
							(a[e].bytesPerSample = t / 8)),
						(l += t);
				}, this),
					l % 8 == 0 && ((h = !0), (r = l / 8));
				var u = t.StripOffsets.values,
					_ = u.length;
				if (t.StripByteCounts) var d = t.StripByteCounts.values;
				else {
					if ((cc.log('Missing StripByteCounts!'), 1 !== _))
						throw Error(
							'Cannot recover from missing StripByteCounts'
						);
					d = [Math.ceil((n * i * l) / 8)];
				}
				for (var p = 0; p < _; p++) {
					var f = u[p];
					o[p] = [];
					for (
						var m = d[p],
							g = 0,
							y = 0,
							T = 1,
							S = !0,
							C = [],
							x = 0,
							v = 0,
							E = 0;
						g < m;
						g += T
					)
						switch (s) {
							case 1:
								for (var A = 0, C = []; A < c; A++) {
									if (!a[A].hasBytesPerSample) {
										var b = this.getBits(
											a[A].bitsPerSample,
											f + g,
											y
										);
										throw (
											(C.push(b.bits),
											(g = b.byteOffset - f),
											(y = b.bitOffset),
											RangeError(
												'Cannot handle sub-byte bits per sample'
											))
										);
									}
									b = a[A].bytesPerSample * A;
									C.push(
										this.getBytes(
											a[A].bytesPerSample,
											f + g + b
										)
									);
								}
								if ((o[p].push(C), !h))
									throw (
										((T = 0),
										RangeError(
											'Cannot handle sub-byte bits per pixel'
										))
									);
								T = r;
								break;
							case 2:
							case 3:
							case 4:
							case 5:
							case 6:
							case 7:
								break;
							case 32773:
								if (S) {
									S = !1;
									var R = 1,
										P = 1,
										I = this.getInt8(f + g);
									0 <= I && I <= 127
										? (R = I + 1)
										: -127 <= I && I <= -1
										? (P = 1 - I)
										: (S = !0);
								} else {
									for (
										var w = this.getUint8(f + g), A = 0;
										A < P;
										A++
									) {
										if (!a[v].hasBytesPerSample)
											throw RangeError(
												'Cannot handle sub-byte bits per sample'
											);
										(E = (E << (8 * x)) | w),
											++x === a[v].bytesPerSample &&
												(C.push(E), (E = x = 0), v++),
											v === c &&
												(o[p].push(C),
												(C = []),
												(v = 0));
									}
									0 === --R && (S = !0);
								}
								T = 1;
						}
				}
				if (e.getContext) {
					var D = this.canvas.getContext('2d');
					D.fillStyle = 'rgba(255, 255, 255, 0)';
					var L,
						O,
						e = t.RowsPerStrip ? t.RowsPerStrip.values[0] : i,
						B = o.length,
						i = i % e,
						N = 0 == i ? e : i,
						F = e,
						M = 0,
						V = t.PhotometricInterpretation.values[0],
						k = [],
						G = 0;
					t.ExtraSamples && (G = (k = t.ExtraSamples.values).length),
						t.ColorMap &&
							((L = t.ColorMap.values),
							(O = Math.pow(2, a[0].bitsPerSample)));
					for (p = 0; p < B; p++) {
						p + 1 === B && (F = N);
						for (
							var W = o[p].length, z = M * p, U = 0, Y = 0;
							Y < W;
							U++
						)
							for (var X = 0; X < n; X++, Y++) {
								var H,
									j = o[p][Y],
									q = 0,
									J = 0,
									Z = 0,
									K = 1;
								if (0 < G)
									for (var Q = 0; Q < G; Q++)
										if (1 === k[Q] || 2 === k[Q]) {
											K = j[3 + Q] / 256;
											break;
										}
								switch (V) {
									case 0:
										a[0].hasBytesPerSample &&
											(H = Math.pow(
												16,
												2 * a[0].bytesPerSample
											)),
											j.forEach(function (t, e, i) {
												i[e] = H - t;
											});
									case 1:
										q =
											J =
											Z =
												this.clampColorSample(
													j[0],
													a[0].bitsPerSample
												);
										break;
									case 2:
										(q = this.clampColorSample(
											j[0],
											a[0].bitsPerSample
										)),
											(J = this.clampColorSample(
												j[1],
												a[1].bitsPerSample
											)),
											(Z = this.clampColorSample(
												j[2],
												a[2].bitsPerSample
											));
										break;
									case 3:
										if (void 0 === L)
											throw Error(
												'Palette image missing color map'
											);
										var $ = j[0],
											q = this.clampColorSample(L[$], 16),
											J = this.clampColorSample(
												L[O + $],
												16
											),
											Z = this.clampColorSample(
												L[2 * O + $],
												16
											);
										break;
									default:
										throw RangeError(
											'Unknown Photometric Interpretation:',
											V
										);
								}
								(D.fillStyle =
									'rgba(' +
									q +
									', ' +
									J +
									', ' +
									Z +
									', ' +
									K +
									')'),
									D.fillRect(X, z + U, 1, 1);
							}
						M = F;
					}
				}
				return this.canvas;
			}
		},
		fieldTagNames: {
			315: 'Artist',
			258: 'BitsPerSample',
			265: 'CellLength',
			264: 'CellWidth',
			320: 'ColorMap',
			259: 'Compression',
			33432: 'Copyright',
			306: 'DateTime',
			338: 'ExtraSamples',
			266: 'FillOrder',
			289: 'FreeByteCounts',
			288: 'FreeOffsets',
			291: 'GrayResponseCurve',
			290: 'GrayResponseUnit',
			316: 'HostComputer',
			270: 'ImageDescription',
			257: 'ImageLength',
			256: 'ImageWidth',
			271: 'Make',
			281: 'MaxSampleValue',
			280: 'MinSampleValue',
			272: 'Model',
			254: 'NewSubfileType',
			274: 'Orientation',
			262: 'PhotometricInterpretation',
			284: 'PlanarConfiguration',
			296: 'ResolutionUnit',
			278: 'RowsPerStrip',
			277: 'SamplesPerPixel',
			305: 'Software',
			279: 'StripByteCounts',
			273: 'StripOffsets',
			255: 'SubfileType',
			263: 'Threshholding',
			282: 'XResolution',
			283: 'YResolution',
			326: 'BadFaxLines',
			327: 'CleanFaxData',
			343: 'ClipPath',
			328: 'ConsecutiveBadFaxLines',
			433: 'Decode',
			434: 'DefaultImageColor',
			269: 'DocumentName',
			336: 'DotRange',
			321: 'HalftoneHints',
			346: 'Indexed',
			347: 'JPEGTables',
			285: 'PageName',
			297: 'PageNumber',
			317: 'Predictor',
			319: 'PrimaryChromaticities',
			532: 'ReferenceBlackWhite',
			339: 'SampleFormat',
			559: 'StripRowCounts',
			330: 'SubIFDs',
			292: 'T4Options',
			293: 'T6Options',
			325: 'TileByteCounts',
			323: 'TileLength',
			324: 'TileOffsets',
			322: 'TileWidth',
			301: 'TransferFunction',
			318: 'WhitePoint',
			344: 'XClipPathUnits',
			286: 'XPosition',
			529: 'YCbCrCoefficients',
			531: 'YCbCrPositioning',
			530: 'YCbCrSubSampling',
			345: 'YClipPathUnits',
			287: 'YPosition',
			37378: 'ApertureValue',
			40961: 'ColorSpace',
			36868: 'DateTimeDigitized',
			36867: 'DateTimeOriginal',
			34665: 'Exif IFD',
			36864: 'ExifVersion',
			33434: 'ExposureTime',
			41728: 'FileSource',
			37385: 'Flash',
			40960: 'FlashpixVersion',
			33437: 'FNumber',
			42016: 'ImageUniqueID',
			37384: 'LightSource',
			37500: 'MakerNote',
			37377: 'ShutterSpeedValue',
			37510: 'UserComment',
			33723: 'IPTC',
			34675: 'ICC Profile',
			700: 'XMP',
			42112: 'GDAL_METADATA',
			42113: 'GDAL_NODATA',
			34377: 'Photoshop',
		},
		fieldTypeNames: {
			1: 'BYTE',
			2: 'ASCII',
			3: 'SHORT',
			4: 'LONG',
			5: 'RATIONAL',
			6: 'SBYTE',
			7: 'UNDEFINED',
			8: 'SSHORT',
			9: 'SLONG',
			10: 'SRATIONAL',
			11: 'FLOAT',
			12: 'DOUBLE',
		},
	}),
	(cc.Particle = function (t, e, i, n, r, o, s, c, a, l, h, u) {
		(this.pos = t || cc.p(0, 0)),
			(this.startPos = e || cc.p(0, 0)),
			(this.color = i || { r: 0, g: 0, b: 0, a: 255 }),
			(this.deltaColor = n || { r: 0, g: 0, b: 0, a: 255 }),
			(this.size = r || 0),
			(this.deltaSize = o || 0),
			(this.rotation = s || 0),
			(this.deltaRotation = c || 0),
			(this.timeToLive = a || 0),
			(this.atlasIndex = l || 0),
			(this.modeA = h || new cc.Particle.ModeA()),
			(this.modeB = u || new cc.Particle.ModeB()),
			(this.isChangeColor = !1),
			(this.drawPos = cc.p(0, 0));
	}),
	(cc.Particle.ModeA = function (t, e, i) {
		(this.dir = t || cc.p(0, 0)),
			(this.radialAccel = e || 0),
			(this.tangentialAccel = i || 0);
	}),
	(cc.Particle.ModeB = function (t, e, i, n) {
		(this.angle = t || 0),
			(this.degreesPerSecond = e || 0),
			(this.radius = i || 0),
			(this.deltaRadius = n || 0);
	}),
	(cc.Particle.TemporaryPoints = [cc.p(), cc.p(), cc.p(), cc.p()]),
	(cc.ParticleSystem = cc.Node.extend({
		_className: 'ParticleSystem',
		_plistFile: '',
		_elapsed: 0,
		_dontTint: !1,
		modeA: null,
		modeB: null,
		_pointZeroForParticle: cc.p(0, 0),
		_particles: null,
		_emitCounter: 0,
		_particleIdx: 0,
		_batchNode: null,
		atlasIndex: 0,
		_transformSystemDirty: !1,
		_allocatedParticles: 0,
		_isActive: !1,
		particleCount: 0,
		duration: 0,
		_sourcePosition: null,
		_posVar: null,
		life: 0,
		lifeVar: 0,
		angle: 0,
		angleVar: 0,
		startSize: 0,
		startSizeVar: 0,
		endSize: 0,
		endSizeVar: 0,
		_startColor: null,
		_startColorVar: null,
		_endColor: null,
		_endColorVar: null,
		startSpin: 0,
		startSpinVar: 0,
		endSpin: 0,
		endSpinVar: 0,
		emissionRate: 0,
		_totalParticles: 0,
		_texture: null,
		_blendFunc: null,
		_opacityModifyRGB: !1,
		positionType: null,
		autoRemoveOnFinish: !1,
		emitterMode: 0,
		_textureLoaded: null,
		ctor: function (t) {
			var e;
			cc.Node.prototype.ctor.call(this),
				(this.emitterMode = cc.ParticleSystem.MODE_GRAVITY),
				(this.modeA = new cc.ParticleSystem.ModeA()),
				(this.modeB = new cc.ParticleSystem.ModeB()),
				(this._blendFunc = { src: cc.BLEND_SRC, dst: cc.BLEND_DST }),
				(this._particles = []),
				(this._sourcePosition = cc.p(0, 0)),
				(this._posVar = cc.p(0, 0)),
				(this._startColor = cc.color(255, 255, 255, 255)),
				(this._startColorVar = cc.color(255, 255, 255, 255)),
				(this._endColor = cc.color(255, 255, 255, 255)),
				(this._endColorVar = cc.color(255, 255, 255, 255)),
				(this._plistFile = ''),
				(this._elapsed = 0),
				(this._dontTint = !1),
				(this._pointZeroForParticle = cc.p(0, 0)),
				(this._emitCounter = 0),
				(this._particleIdx = 0),
				(this._batchNode = null),
				(this.atlasIndex = 0),
				(this._transformSystemDirty = !1),
				(this._allocatedParticles = 0),
				(this._isActive = !1),
				(this.particleCount = 0),
				(this.duration = 0),
				(this.life = 0),
				(this.lifeVar = 0),
				(this.angle = 0),
				(this.angleVar = 0),
				(this.startSize = 0),
				(this.startSizeVar = 0),
				(this.endSize = 0),
				(this.endSizeVar = 0),
				(this.startSpin = 0),
				(this.startSpinVar = 0),
				(this.endSpin = 0),
				(this.endSpinVar = 0),
				(this.emissionRate = 0),
				(this._totalParticles = 0),
				(this._texture = null),
				(this._opacityModifyRGB = !1),
				(this.positionType = cc.ParticleSystem.TYPE_FREE),
				(this.autoRemoveOnFinish = !1),
				(this._textureLoaded = !0),
				!t || cc.isNumber(t)
					? ((e = t || 100),
					  this.setDrawMode(cc.ParticleSystem.TEXTURE_MODE),
					  this.initWithTotalParticles(e))
					: cc.isString(t)
					? this.initWithFile(t)
					: cc.isObject(t) && this.initWithDictionary(t, '');
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.ParticleSystem.CanvasRenderCmd
					: cc.ParticleSystem.WebGLRenderCmd
			)(this);
		},
		ignoreColor: function (t) {
			this._dontTint = t;
		},
		initTexCoordsWithRect: function (t) {
			this._renderCmd.initTexCoordsWithRect(t);
		},
		getBatchNode: function () {
			return this._batchNode;
		},
		setBatchNode: function (t) {
			this._renderCmd.setBatchNode(t);
		},
		getAtlasIndex: function () {
			return this.atlasIndex;
		},
		setAtlasIndex: function (t) {
			this.atlasIndex = t;
		},
		getDrawMode: function () {
			return this._renderCmd.getDrawMode();
		},
		setDrawMode: function (t) {
			this._renderCmd.setDrawMode(t);
		},
		getShapeType: function () {
			return this._renderCmd.getShapeType();
		},
		setShapeType: function (t) {
			this._renderCmd.setShapeType(t);
		},
		isActive: function () {
			return this._isActive;
		},
		getParticleCount: function () {
			return this.particleCount;
		},
		setParticleCount: function (t) {
			this.particleCount = t;
		},
		getDuration: function () {
			return this.duration;
		},
		setDuration: function (t) {
			this.duration = t;
		},
		getSourcePosition: function () {
			return { x: this._sourcePosition.x, y: this._sourcePosition.y };
		},
		setSourcePosition: function (t) {
			this._sourcePosition = t;
		},
		getPosVar: function () {
			return { x: this._posVar.x, y: this._posVar.y };
		},
		setPosVar: function (t) {
			this._posVar = t;
		},
		getLife: function () {
			return this.life;
		},
		setLife: function (t) {
			this.life = t;
		},
		getLifeVar: function () {
			return this.lifeVar;
		},
		setLifeVar: function (t) {
			this.lifeVar = t;
		},
		getAngle: function () {
			return this.angle;
		},
		setAngle: function (t) {
			this.angle = t;
		},
		getAngleVar: function () {
			return this.angleVar;
		},
		setAngleVar: function (t) {
			this.angleVar = t;
		},
		getGravity: function () {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.getGravity() : Particle Mode should be Gravity'
				);
			var t = this.modeA.gravity;
			return cc.p(t.x, t.y);
		},
		setGravity: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setGravity() : Particle Mode should be Gravity'
				),
				(this.modeA.gravity = t);
		},
		getSpeed: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
					cc.log(
						'cc.ParticleBatchNode.getSpeed() : Particle Mode should be Gravity'
					),
				this.modeA.speed
			);
		},
		setSpeed: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setSpeed() : Particle Mode should be Gravity'
				),
				(this.modeA.speed = t);
		},
		getSpeedVar: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
					cc.log(
						'cc.ParticleBatchNode.getSpeedVar() : Particle Mode should be Gravity'
					),
				this.modeA.speedVar
			);
		},
		setSpeedVar: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setSpeedVar() : Particle Mode should be Gravity'
				),
				(this.modeA.speedVar = t);
		},
		getTangentialAccel: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
					cc.log(
						'cc.ParticleBatchNode.getTangentialAccel() : Particle Mode should be Gravity'
					),
				this.modeA.tangentialAccel
			);
		},
		setTangentialAccel: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setTangentialAccel() : Particle Mode should be Gravity'
				),
				(this.modeA.tangentialAccel = t);
		},
		getTangentialAccelVar: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
					cc.log(
						'cc.ParticleBatchNode.getTangentialAccelVar() : Particle Mode should be Gravity'
					),
				this.modeA.tangentialAccelVar
			);
		},
		setTangentialAccelVar: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setTangentialAccelVar() : Particle Mode should be Gravity'
				),
				(this.modeA.tangentialAccelVar = t);
		},
		getRadialAccel: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
					cc.log(
						'cc.ParticleBatchNode.getRadialAccel() : Particle Mode should be Gravity'
					),
				this.modeA.radialAccel
			);
		},
		setRadialAccel: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setRadialAccel() : Particle Mode should be Gravity'
				),
				(this.modeA.radialAccel = t);
		},
		getRadialAccelVar: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
					cc.log(
						'cc.ParticleBatchNode.getRadialAccelVar() : Particle Mode should be Gravity'
					),
				this.modeA.radialAccelVar
			);
		},
		setRadialAccelVar: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setRadialAccelVar() : Particle Mode should be Gravity'
				),
				(this.modeA.radialAccelVar = t);
		},
		getRotationIsDir: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
					cc.log(
						'cc.ParticleBatchNode.getRotationIsDir() : Particle Mode should be Gravity'
					),
				this.modeA.rotationIsDir
			);
		},
		setRotationIsDir: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_GRAVITY &&
				cc.log(
					'cc.ParticleBatchNode.setRotationIsDir() : Particle Mode should be Gravity'
				),
				(this.modeA.rotationIsDir = t);
		},
		getStartRadius: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
					cc.log(
						'cc.ParticleBatchNode.getStartRadius() : Particle Mode should be Radius'
					),
				this.modeB.startRadius
			);
		},
		setStartRadius: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
				cc.log(
					'cc.ParticleBatchNode.setStartRadius() : Particle Mode should be Radius'
				),
				(this.modeB.startRadius = t);
		},
		getStartRadiusVar: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
					cc.log(
						'cc.ParticleBatchNode.getStartRadiusVar() : Particle Mode should be Radius'
					),
				this.modeB.startRadiusVar
			);
		},
		setStartRadiusVar: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
				cc.log(
					'cc.ParticleBatchNode.setStartRadiusVar() : Particle Mode should be Radius'
				),
				(this.modeB.startRadiusVar = t);
		},
		getEndRadius: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
					cc.log(
						'cc.ParticleBatchNode.getEndRadius() : Particle Mode should be Radius'
					),
				this.modeB.endRadius
			);
		},
		setEndRadius: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
				cc.log(
					'cc.ParticleBatchNode.setEndRadius() : Particle Mode should be Radius'
				),
				(this.modeB.endRadius = t);
		},
		getEndRadiusVar: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
					cc.log(
						'cc.ParticleBatchNode.getEndRadiusVar() : Particle Mode should be Radius'
					),
				this.modeB.endRadiusVar
			);
		},
		setEndRadiusVar: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
				cc.log(
					'cc.ParticleBatchNode.setEndRadiusVar() : Particle Mode should be Radius'
				),
				(this.modeB.endRadiusVar = t);
		},
		getRotatePerSecond: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
					cc.log(
						'cc.ParticleBatchNode.getRotatePerSecond() : Particle Mode should be Radius'
					),
				this.modeB.rotatePerSecond
			);
		},
		setRotatePerSecond: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
				cc.log(
					'cc.ParticleBatchNode.setRotatePerSecond() : Particle Mode should be Radius'
				),
				(this.modeB.rotatePerSecond = t);
		},
		getRotatePerSecondVar: function () {
			return (
				this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
					cc.log(
						'cc.ParticleBatchNode.getRotatePerSecondVar() : Particle Mode should be Radius'
					),
				this.modeB.rotatePerSecondVar
			);
		},
		setRotatePerSecondVar: function (t) {
			this.emitterMode !== cc.ParticleSystem.MODE_RADIUS &&
				cc.log(
					'cc.ParticleBatchNode.setRotatePerSecondVar() : Particle Mode should be Radius'
				),
				(this.modeB.rotatePerSecondVar = t);
		},
		setScale: function (t, e) {
			(this._transformSystemDirty = !0),
				cc.Node.prototype.setScale.call(this, t, e);
		},
		setRotation: function (t) {
			(this._transformSystemDirty = !0),
				cc.Node.prototype.setRotation.call(this, t);
		},
		setScaleX: function (t) {
			(this._transformSystemDirty = !0),
				cc.Node.prototype.setScaleX.call(this, t);
		},
		setScaleY: function (t) {
			(this._transformSystemDirty = !0),
				cc.Node.prototype.setScaleY.call(this, t);
		},
		getStartSize: function () {
			return this.startSize;
		},
		setStartSize: function (t) {
			this.startSize = t;
		},
		getStartSizeVar: function () {
			return this.startSizeVar;
		},
		setStartSizeVar: function (t) {
			this.startSizeVar = t;
		},
		getEndSize: function () {
			return this.endSize;
		},
		setEndSize: function (t) {
			this.endSize = t;
		},
		getEndSizeVar: function () {
			return this.endSizeVar;
		},
		setEndSizeVar: function (t) {
			this.endSizeVar = t;
		},
		getStartColor: function () {
			return cc.color(
				this._startColor.r,
				this._startColor.g,
				this._startColor.b,
				this._startColor.a
			);
		},
		setStartColor: function (t) {
			this._startColor = cc.color(t);
		},
		getStartColorVar: function () {
			return cc.color(
				this._startColorVar.r,
				this._startColorVar.g,
				this._startColorVar.b,
				this._startColorVar.a
			);
		},
		setStartColorVar: function (t) {
			this._startColorVar = cc.color(t);
		},
		getEndColor: function () {
			return cc.color(
				this._endColor.r,
				this._endColor.g,
				this._endColor.b,
				this._endColor.a
			);
		},
		setEndColor: function (t) {
			this._endColor = cc.color(t);
		},
		getEndColorVar: function () {
			return cc.color(
				this._endColorVar.r,
				this._endColorVar.g,
				this._endColorVar.b,
				this._endColorVar.a
			);
		},
		setEndColorVar: function (t) {
			this._endColorVar = cc.color(t);
		},
		getStartSpin: function () {
			return this.startSpin;
		},
		setStartSpin: function (t) {
			this.startSpin = t;
		},
		getStartSpinVar: function () {
			return this.startSpinVar;
		},
		setStartSpinVar: function (t) {
			this.startSpinVar = t;
		},
		getEndSpin: function () {
			return this.endSpin;
		},
		setEndSpin: function (t) {
			this.endSpin = t;
		},
		getEndSpinVar: function () {
			return this.endSpinVar;
		},
		setEndSpinVar: function (t) {
			this.endSpinVar = t;
		},
		getEmissionRate: function () {
			return this.emissionRate;
		},
		setEmissionRate: function (t) {
			this.emissionRate = t;
		},
		getTotalParticles: function () {
			return this._totalParticles;
		},
		setTotalParticles: function (t) {
			this._renderCmd.setTotalParticles(t);
		},
		getTexture: function () {
			return this._texture;
		},
		setTexture: function (t) {
			t &&
				(t.isLoaded()
					? this.setTextureWithRect(
							t,
							cc.rect(0, 0, t.width, t.height)
					  )
					: ((this._textureLoaded = !1),
					  t.addEventListener(
							'load',
							function (t) {
								(this._textureLoaded = !0),
									this.setTextureWithRect(
										t,
										cc.rect(0, 0, t.width, t.height)
									);
							},
							this
					  )));
		},
		getBlendFunc: function () {
			return this._blendFunc;
		},
		setBlendFunc: function (t, e) {
			void 0 === e
				? this._blendFunc !== t &&
				  ((this._blendFunc = t), this._updateBlendFunc())
				: (this._blendFunc.src === t && this._blendFunc.dst === e) ||
				  ((this._blendFunc = { src: t, dst: e }),
				  this._updateBlendFunc());
		},
		isOpacityModifyRGB: function () {
			return this._opacityModifyRGB;
		},
		setOpacityModifyRGB: function (t) {
			this._opacityModifyRGB = t;
		},
		isBlendAdditive: function () {
			return (
				(this._blendFunc.src === cc.SRC_ALPHA &&
					this._blendFunc.dst === cc.ONE) ||
				(this._blendFunc.src === cc.ONE &&
					this._blendFunc.dst === cc.ONE)
			);
		},
		setBlendAdditive: function (t) {
			var e = this._blendFunc;
			t
				? ((e.src = cc.SRC_ALPHA), (e.dst = cc.ONE))
				: this._renderCmd._setBlendAdditive();
		},
		getPositionType: function () {
			return this.positionType;
		},
		setPositionType: function (t) {
			this.positionType = t;
		},
		isAutoRemoveOnFinish: function () {
			return this.autoRemoveOnFinish;
		},
		setAutoRemoveOnFinish: function (t) {
			this.autoRemoveOnFinish = t;
		},
		getEmitterMode: function () {
			return this.emitterMode;
		},
		setEmitterMode: function (t) {
			this.emitterMode = t;
		},
		init: function () {
			return this.initWithTotalParticles(150);
		},
		initWithFile: function (t) {
			this._plistFile = t;
			t = cc.loader.getRes(t);
			return t
				? this.initWithDictionary(t, '')
				: (cc.log(
						'cc.ParticleSystem.initWithFile(): Particles: file not found'
				  ),
				  !1);
		},
		getBoundingBoxToWorld: function () {
			return cc.rect(0, 0, cc._canvas.width, cc._canvas.height);
		},
		initWithDictionary: function (t, e) {
			var i = !1,
				n = this._valueForKey,
				r = parseInt(n('maxParticles', t));
			if (this.initWithTotalParticles(r)) {
				(this.angle = parseFloat(n('angle', t))),
					(this.angleVar = parseFloat(n('angleVariance', t))),
					(this.duration = parseFloat(n('duration', t))),
					(this._blendFunc.src = parseInt(n('blendFuncSource', t))),
					(this._blendFunc.dst = parseInt(
						n('blendFuncDestination', t)
					));
				r = this._startColor;
				(r.r = 255 * parseFloat(n('startColorRed', t))),
					(r.g = 255 * parseFloat(n('startColorGreen', t))),
					(r.b = 255 * parseFloat(n('startColorBlue', t))),
					(r.a = 255 * parseFloat(n('startColorAlpha', t)));
				r = this._startColorVar;
				(r.r = 255 * parseFloat(n('startColorVarianceRed', t))),
					(r.g = 255 * parseFloat(n('startColorVarianceGreen', t))),
					(r.b = 255 * parseFloat(n('startColorVarianceBlue', t))),
					(r.a = 255 * parseFloat(n('startColorVarianceAlpha', t)));
				r = this._endColor;
				(r.r = 255 * parseFloat(n('finishColorRed', t))),
					(r.g = 255 * parseFloat(n('finishColorGreen', t))),
					(r.b = 255 * parseFloat(n('finishColorBlue', t))),
					(r.a = 255 * parseFloat(n('finishColorAlpha', t)));
				r = this._endColorVar;
				if (
					((r.r = 255 * parseFloat(n('finishColorVarianceRed', t))),
					(r.g = 255 * parseFloat(n('finishColorVarianceGreen', t))),
					(r.b = 255 * parseFloat(n('finishColorVarianceBlue', t))),
					(r.a = 255 * parseFloat(n('finishColorVarianceAlpha', t))),
					(this.startSize = parseFloat(n('startParticleSize', t))),
					(this.startSizeVar = parseFloat(
						n('startParticleSizeVariance', t)
					)),
					(this.endSize = parseFloat(n('finishParticleSize', t))),
					(this.endSizeVar = parseFloat(
						n('finishParticleSizeVariance', t)
					)),
					this.setPosition(
						parseFloat(n('sourcePositionx', t)),
						parseFloat(n('sourcePositiony', t))
					),
					(this._posVar.x = parseFloat(
						n('sourcePositionVariancex', t)
					)),
					(this._posVar.y = parseFloat(
						n('sourcePositionVariancey', t)
					)),
					(this.startSpin = parseFloat(n('rotationStart', t))),
					(this.startSpinVar = parseFloat(
						n('rotationStartVariance', t)
					)),
					(this.endSpin = parseFloat(n('rotationEnd', t))),
					(this.endSpinVar = parseFloat(n('rotationEndVariance', t))),
					(this.emitterMode = parseInt(n('emitterType', t))),
					this.emitterMode === cc.ParticleSystem.MODE_GRAVITY)
				) {
					r = this.modeA;
					(r.gravity.x = parseFloat(n('gravityx', t))),
						(r.gravity.y = parseFloat(n('gravityy', t))),
						(r.speed = parseFloat(n('speed', t))),
						(r.speedVar = parseFloat(n('speedVariance', t)));
					var o = n('radialAcceleration', t);
					(r.radialAccel = o ? parseFloat(o) : 0),
						(o = n('radialAccelVariance', t)),
						(r.radialAccelVar = o ? parseFloat(o) : 0),
						(o = n('tangentialAcceleration', t)),
						(r.tangentialAccel = o ? parseFloat(o) : 0),
						(o = n('tangentialAccelVariance', t)),
						(r.tangentialAccelVar = o ? parseFloat(o) : 0);
					o = n('rotationIsDir', t).toLowerCase();
					r.rotationIsDir = null != o && ('true' === o || '1' === o);
				} else {
					if (this.emitterMode !== cc.ParticleSystem.MODE_RADIUS)
						return (
							cc.log(
								'cc.ParticleSystem.initWithDictionary(): Invalid emitterType in config file'
							),
							!1
						);
					o = this.modeB;
					(o.startRadius = parseFloat(n('maxRadius', t))),
						(o.startRadiusVar = parseFloat(
							n('maxRadiusVariance', t)
						)),
						(o.endRadius = parseFloat(n('minRadius', t))),
						(o.endRadiusVar = 0),
						(o.rotatePerSecond = parseFloat(
							n('rotatePerSecond', t)
						)),
						(o.rotatePerSecondVar = parseFloat(
							n('rotatePerSecondVariance', t)
						));
				}
				(this.life = parseFloat(n('particleLifespan', t))),
					(this.lifeVar = parseFloat(
						n('particleLifespanVariance', t)
					)),
					(this.emissionRate = this._totalParticles / this.life),
					(i = !0);
			}
			return i;
		},
		initWithTotalParticles: function (t) {
			this._totalParticles = t;
			for (var e = this._particles, i = (e.length = 0); i < t; i++)
				e[i] = new cc.Particle();
			if (!e) return cc.log('Particle system: not enough memory'), !1;
			if (((this._allocatedParticles = t), this._batchNode))
				for (i = 0; i < this._totalParticles; i++) e[i].atlasIndex = i;
			return (
				(this._isActive = !0),
				(this._blendFunc.src = cc.BLEND_SRC),
				(this._blendFunc.dst = cc.BLEND_DST),
				(this.positionType = cc.ParticleSystem.TYPE_FREE),
				(this.emitterMode = cc.ParticleSystem.MODE_GRAVITY),
				(this.autoRemoveOnFinish = !1),
				(this._transformSystemDirty = !1),
				this.scheduleUpdateWithPriority(1),
				this._renderCmd._initWithTotalParticles(t),
				!0
			);
		},
		destroyParticleSystem: function () {
			this.unscheduleUpdate();
		},
		addParticle: function () {
			if (this.isFull()) return !1;
			var t = this._renderCmd.addParticle();
			return this.initParticle(t), ++this.particleCount, !0;
		},
		initParticle: function (t) {
			var e = cc.randomMinus1To1;
			(t.timeToLive = this.life + this.lifeVar * e()),
				(t.timeToLive = Math.max(0, t.timeToLive)),
				(t.pos.x = this._sourcePosition.x + this._posVar.x * e()),
				(t.pos.y = this._sourcePosition.y + this._posVar.y * e());
			var i = this._startColor,
				n = this._startColorVar,
				r = this._endColor,
				o = this._endColorVar,
				i = {
					r: cc.clampf(i.r + n.r * e(), 0, 255),
					g: cc.clampf(i.g + n.g * e(), 0, 255),
					b: cc.clampf(i.b + n.b * e(), 0, 255),
					a: cc.clampf(i.a + n.a * e(), 0, 255),
				},
				n = {
					r: cc.clampf(r.r + o.r * e(), 0, 255),
					g: cc.clampf(r.g + o.g * e(), 0, 255),
					b: cc.clampf(r.b + o.b * e(), 0, 255),
					a: cc.clampf(r.a + o.a * e(), 0, 255),
				};
			t.color = i;
			(r = t.deltaColor), (o = t.timeToLive);
			(r.r = (n.r - i.r) / o),
				(r.g = (n.g - i.g) / o),
				(r.b = (n.b - i.b) / o),
				(r.a = (n.a - i.a) / o);
			(i = this.startSize + this.startSizeVar * e()),
				(i = Math.max(0, i));
			(t.size = i),
				this.endSize === cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					? (t.deltaSize = 0)
					: ((s = this.endSize + this.endSizeVar * e()),
					  (s = Math.max(0, s)),
					  (t.deltaSize = (s - i) / o));
			var s = this.startSpin + this.startSpinVar * e(),
				i = this.endSpin + this.endSpinVar * e();
			(t.rotation = s),
				(t.deltaRotation = (i - s) / o),
				this.positionType === cc.ParticleSystem.TYPE_FREE
					? (t.startPos = this.convertToWorldSpace(
							this._pointZeroForParticle
					  ))
					: this.positionType === cc.ParticleSystem.TYPE_RELATIVE &&
					  ((t.startPos.x = this._position.x),
					  (t.startPos.y = this._position.y));
			var c,
				a,
				l,
				s = cc.degreesToRadians(this.angle + this.angleVar * e());
			this.emitterMode === cc.ParticleSystem.MODE_GRAVITY
				? ((a = this.modeA),
				  (l = t.modeA),
				  (c = a.speed + a.speedVar * e()),
				  (l.dir.x = Math.cos(s)),
				  (l.dir.y = Math.sin(s)),
				  cc.pMultIn(l.dir, c),
				  (l.radialAccel = a.radialAccel + a.radialAccelVar * e()),
				  (l.tangentialAccel =
						a.tangentialAccel + a.tangentialAccelVar * e()),
				  a.rotationIsDir &&
						(t.rotation = -cc.radiansToDegrees(cc.pToAngle(l.dir))))
				: ((c = this.modeB),
				  (a = t.modeB),
				  (l = c.startRadius + c.startRadiusVar * e()),
				  (t = c.endRadius + c.endRadiusVar * e()),
				  (a.radius = l),
				  (a.deltaRadius =
						c.endRadius ===
						cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS
							? 0
							: (t - l) / o),
				  (a.angle = s),
				  (a.degreesPerSecond = cc.degreesToRadians(
						c.rotatePerSecond + c.rotatePerSecondVar * e()
				  )));
		},
		stopSystem: function () {
			(this._isActive = !1),
				(this._elapsed = this.duration),
				(this._emitCounter = 0);
		},
		resetSystem: function () {
			(this._isActive = !0), (this._elapsed = 0);
			var t = this._particles;
			for (
				this._particleIdx = 0;
				this._particleIdx < this.particleCount;
				++this._particleIdx
			)
				t[this._particleIdx].timeToLive = 0;
		},
		isFull: function () {
			return this.particleCount >= this._totalParticles;
		},
		updateQuadWithParticle: function (t, e) {
			this._renderCmd.updateQuadWithParticle(t, e);
		},
		postStep: function () {
			this._renderCmd.postStep();
		},
		update: function (t) {
			if (this._isActive && this.emissionRate) {
				var e = 1 / this.emissionRate;
				for (
					this.particleCount < this._totalParticles &&
					(this._emitCounter += t);
					this.particleCount < this._totalParticles &&
					this._emitCounter > e;

				)
					this.addParticle(), (this._emitCounter -= e);
				(this._elapsed += t),
					-1 !== this.duration &&
						this.duration < this._elapsed &&
						this.stopSystem();
			}
			this._particleIdx = 0;
			var i = cc.Particle.TemporaryPoints[0];
			if (
				(this.positionType === cc.ParticleSystem.TYPE_FREE
					? cc.pIn(
							i,
							this.convertToWorldSpace(this._pointZeroForParticle)
					  )
					: this.positionType === cc.ParticleSystem.TYPE_RELATIVE &&
					  ((i.x = this._position.x), (i.y = this._position.y)),
				this._visible)
			) {
				for (
					var n = cc.Particle.TemporaryPoints[1],
						r = cc.Particle.TemporaryPoints[2],
						o = cc.Particle.TemporaryPoints[3],
						s = this._particles;
					this._particleIdx < this.particleCount;

				) {
					cc.pZeroIn(n), cc.pZeroIn(r), cc.pZeroIn(o);
					var c,
						a,
						l,
						h = s[this._particleIdx];
					if (((h.timeToLive -= t), 0 < h.timeToLive)) {
						this.emitterMode === cc.ParticleSystem.MODE_GRAVITY
							? ((_ = o),
							  (c = n),
							  (a = r),
							  h.pos.x || h.pos.y
									? (cc.pIn(c, h.pos), cc.pNormalizeIn(c))
									: cc.pZeroIn(c),
							  cc.pIn(a, c),
							  cc.pMultIn(c, h.modeA.radialAccel),
							  (l = a.x),
							  (a.x = -a.y),
							  (a.y = l),
							  cc.pMultIn(a, h.modeA.tangentialAccel),
							  cc.pIn(_, c),
							  cc.pAddIn(_, a),
							  cc.pAddIn(_, this.modeA.gravity),
							  cc.pMultIn(_, t),
							  cc.pAddIn(h.modeA.dir, _),
							  cc.pIn(_, h.modeA.dir),
							  cc.pMultIn(_, t),
							  cc.pAddIn(h.pos, _))
							: (((u = h.modeB).angle += u.degreesPerSecond * t),
							  (u.radius += u.deltaRadius * t),
							  (h.pos.x = -Math.cos(u.angle) * u.radius),
							  (h.pos.y = -Math.sin(u.angle) * u.radius)),
							this._renderCmd._updateDeltaColor(h, t),
							(h.size += h.deltaSize * t),
							(h.size = Math.max(0, h.size)),
							(h.rotation += h.deltaRotation * t);
						var u,
							_ = n;
						this.positionType === cc.ParticleSystem.TYPE_FREE ||
						this.positionType === cc.ParticleSystem.TYPE_RELATIVE
							? ((u = r),
							  cc.pIn(u, i),
							  cc.pSubIn(u, h.startPos),
							  cc.pIn(_, h.pos),
							  cc.pSubIn(_, u))
							: cc.pIn(_, h.pos),
							this._batchNode &&
								((_.x += this._position.x),
								(_.y += this._position.y)),
							this._renderCmd.updateParticlePosition(h, _),
							++this._particleIdx;
					} else {
						_ = h.atlasIndex;
						if (
							(this._particleIdx !== this.particleCount - 1 &&
								((h = s[this._particleIdx]),
								(s[this._particleIdx] =
									s[this.particleCount - 1]),
								(s[this.particleCount - 1] = h)),
							this._batchNode &&
								(this._batchNode.disableParticle(
									this.atlasIndex + _
								),
								(s[this.particleCount - 1].atlasIndex = _)),
							--this.particleCount,
							0 === this.particleCount && this.autoRemoveOnFinish)
						)
							return (
								this.unscheduleUpdate(),
								void this._parent.removeChild(this, !0)
							);
					}
				}
				this._transformSystemDirty = !1;
			}
			this._batchNode || this.postStep();
		},
		updateWithNoTime: function () {
			this.update(0);
		},
		_valueForKey: function (t, e) {
			if (e) {
				t = e[t];
				return null != t ? t : '';
			}
			return '';
		},
		_updateBlendFunc: function () {
			var t, e;
			this._batchNode
				? cc.log(
						"Can't change blending functions when the particle is being batched"
				  )
				: (t = this._texture) &&
				  t instanceof cc.Texture2D &&
				  ((this._opacityModifyRGB = !1),
				  (e = this._blendFunc).src === cc.BLEND_SRC &&
						e.dst === cc.BLEND_DST &&
						(t.hasPremultipliedAlpha()
							? (this._opacityModifyRGB = !0)
							: ((e.src = cc.SRC_ALPHA),
							  (e.dst = cc.ONE_MINUS_SRC_ALPHA))));
		},
		clone: function () {
			var t,
				e,
				i = new cc.ParticleSystem();
			return (
				i.initWithTotalParticles(this.getTotalParticles()) &&
					(i.setAngle(this.getAngle()),
					i.setAngleVar(this.getAngleVar()),
					i.setDuration(this.getDuration()),
					(t = this.getBlendFunc()),
					i.setBlendFunc(t.src, t.dst),
					i.setStartColor(this.getStartColor()),
					i.setStartColorVar(this.getStartColorVar()),
					i.setEndColor(this.getEndColor()),
					i.setEndColorVar(this.getEndColorVar()),
					i.setStartSize(this.getStartSize()),
					i.setStartSizeVar(this.getStartSizeVar()),
					i.setEndSize(this.getEndSize()),
					i.setEndSizeVar(this.getEndSizeVar()),
					i.setPosition(cc.p(this.x, this.y)),
					i.setPosVar(cc.p(this.getPosVar().x, this.getPosVar().y)),
					i.setPositionType(this.getPositionType()),
					i.setStartSpin(this.getStartSpin() || 0),
					i.setStartSpinVar(this.getStartSpinVar() || 0),
					i.setEndSpin(this.getEndSpin() || 0),
					i.setEndSpinVar(this.getEndSpinVar() || 0),
					i.setEmitterMode(this.getEmitterMode()),
					this.getEmitterMode() === cc.ParticleSystem.MODE_GRAVITY
						? ((e = this.getGravity()),
						  i.setGravity(cc.p(e.x, e.y)),
						  i.setSpeed(this.getSpeed()),
						  i.setSpeedVar(this.getSpeedVar()),
						  i.setRadialAccel(this.getRadialAccel()),
						  i.setRadialAccelVar(this.getRadialAccelVar()),
						  i.setTangentialAccel(this.getTangentialAccel()),
						  i.setTangentialAccelVar(this.getTangentialAccelVar()))
						: this.getEmitterMode() ===
								cc.ParticleSystem.MODE_RADIUS &&
						  (i.setStartRadius(this.getStartRadius()),
						  i.setStartRadiusVar(this.getStartRadiusVar()),
						  i.setEndRadius(this.getEndRadius()),
						  i.setEndRadiusVar(this.getEndRadiusVar()),
						  i.setRotatePerSecond(this.getRotatePerSecond()),
						  i.setRotatePerSecondVar(
								this.getRotatePerSecondVar()
						  )),
					i.setLife(this.getLife()),
					i.setLifeVar(this.getLifeVar()),
					i.setEmissionRate(this.getEmissionRate()),
					this.getBatchNode() ||
						(i.setOpacityModifyRGB(this.isOpacityModifyRGB()),
						(t = this.getTexture()) &&
							((e = t.getContentSize()),
							i.setTextureWithRect(
								t,
								cc.rect(0, 0, e.width, e.height)
							)))),
				i
			);
		},
		setDisplayFrame: function (t) {
			var e;
			t &&
				((0 === (e = t.getOffsetInPixels()).x && 0 === e.y) ||
					cc.log(
						'cc.ParticleSystem.setDisplayFrame(): QuadParticle only supports SpriteFrames with no offsets'
					),
				(t = t.getTexture()),
				this._texture !== t && this.setTexture(t));
		},
		setTextureWithRect: function (t, e) {
			this._texture !== t &&
				((this._texture = t), this._updateBlendFunc()),
				this.initTexCoordsWithRect(e);
		},
		listenBackToForeground: function (t) {},
	}));
var _p = cc.ParticleSystem.prototype;
_p.opacityModifyRGB,
	cc.defineGetterSetter(
		_p,
		'opacityModifyRGB',
		_p.isOpacityModifyRGB,
		_p.setOpacityModifyRGB
	),
	_p.batchNode,
	cc.defineGetterSetter(_p, 'batchNode', _p.getBatchNode, _p.setBatchNode),
	_p.drawMode,
	cc.defineGetterSetter(_p, 'drawMode', _p.getDrawMode, _p.setDrawMode),
	_p.shapeType,
	cc.defineGetterSetter(_p, 'shapeType', _p.getShapeType, _p.setShapeType),
	_p.active,
	cc.defineGetterSetter(_p, 'active', _p.isActive),
	_p.sourcePos,
	cc.defineGetterSetter(
		_p,
		'sourcePos',
		_p.getSourcePosition,
		_p.setSourcePosition
	),
	_p.posVar,
	cc.defineGetterSetter(_p, 'posVar', _p.getPosVar, _p.setPosVar),
	_p.gravity,
	cc.defineGetterSetter(_p, 'gravity', _p.getGravity, _p.setGravity),
	_p.speed,
	cc.defineGetterSetter(_p, 'speed', _p.getSpeed, _p.setSpeed),
	_p.speedVar,
	cc.defineGetterSetter(_p, 'speedVar', _p.getSpeedVar, _p.setSpeedVar),
	_p.tangentialAccel,
	cc.defineGetterSetter(
		_p,
		'tangentialAccel',
		_p.getTangentialAccel,
		_p.setTangentialAccel
	),
	_p.tangentialAccelVar,
	cc.defineGetterSetter(
		_p,
		'tangentialAccelVar',
		_p.getTangentialAccelVar,
		_p.setTangentialAccelVar
	),
	_p.radialAccel,
	cc.defineGetterSetter(
		_p,
		'radialAccel',
		_p.getRadialAccel,
		_p.setRadialAccel
	),
	_p.radialAccelVar,
	cc.defineGetterSetter(
		_p,
		'radialAccelVar',
		_p.getRadialAccelVar,
		_p.setRadialAccelVar
	),
	_p.rotationIsDir,
	cc.defineGetterSetter(
		_p,
		'rotationIsDir',
		_p.getRotationIsDir,
		_p.setRotationIsDir
	),
	_p.startRadius,
	cc.defineGetterSetter(
		_p,
		'startRadius',
		_p.getStartRadius,
		_p.setStartRadius
	),
	_p.startRadiusVar,
	cc.defineGetterSetter(
		_p,
		'startRadiusVar',
		_p.getStartRadiusVar,
		_p.setStartRadiusVar
	),
	_p.endRadius,
	cc.defineGetterSetter(_p, 'endRadius', _p.getEndRadius, _p.setEndRadius),
	_p.endRadiusVar,
	cc.defineGetterSetter(
		_p,
		'endRadiusVar',
		_p.getEndRadiusVar,
		_p.setEndRadiusVar
	),
	_p.rotatePerS,
	cc.defineGetterSetter(
		_p,
		'rotatePerS',
		_p.getRotatePerSecond,
		_p.setRotatePerSecond
	),
	_p.rotatePerSVar,
	cc.defineGetterSetter(
		_p,
		'rotatePerSVar',
		_p.getRotatePerSecondVar,
		_p.setRotatePerSecondVar
	),
	_p.startColor,
	cc.defineGetterSetter(_p, 'startColor', _p.getStartColor, _p.setStartColor),
	_p.startColorVar,
	cc.defineGetterSetter(
		_p,
		'startColorVar',
		_p.getStartColorVar,
		_p.setStartColorVar
	),
	_p.endColor,
	cc.defineGetterSetter(_p, 'endColor', _p.getEndColor, _p.setEndColor),
	_p.endColorVar,
	cc.defineGetterSetter(
		_p,
		'endColorVar',
		_p.getEndColorVar,
		_p.setEndColorVar
	),
	_p.totalParticles,
	cc.defineGetterSetter(
		_p,
		'totalParticles',
		_p.getTotalParticles,
		_p.setTotalParticles
	),
	_p.texture,
	cc.defineGetterSetter(_p, 'texture', _p.getTexture, _p.setTexture),
	(cc.ParticleSystem.create = function (t) {
		return new cc.ParticleSystem(t);
	}),
	(cc.ParticleSystem.createWithTotalParticles = cc.ParticleSystem.create),
	(cc.ParticleSystem.ModeA = function (t, e, i, n, r, o, s, c) {
		(this.gravity = t || cc.p(0, 0)),
			(this.speed = e || 0),
			(this.speedVar = i || 0),
			(this.tangentialAccel = n || 0),
			(this.tangentialAccelVar = r || 0),
			(this.radialAccel = o || 0),
			(this.radialAccelVar = s || 0),
			(this.rotationIsDir = c || !1);
	}),
	(cc.ParticleSystem.ModeB = function (t, e, i, n, r, o) {
		(this.startRadius = t || 0),
			(this.startRadiusVar = e || 0),
			(this.endRadius = i || 0),
			(this.endRadiusVar = n || 0),
			(this.rotatePerSecond = r || 0),
			(this.rotatePerSecondVar = o || 0);
	}),
	(cc.ParticleSystem.SHAPE_MODE = 0),
	(cc.ParticleSystem.TEXTURE_MODE = 1),
	(cc.ParticleSystem.STAR_SHAPE = 0),
	(cc.ParticleSystem.BALL_SHAPE = 1),
	(cc.ParticleSystem.DURATION_INFINITY = -1),
	(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE = -1),
	(cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS = -1),
	(cc.ParticleSystem.MODE_GRAVITY = 0),
	(cc.ParticleSystem.MODE_RADIUS = 1),
	(cc.ParticleSystem.TYPE_FREE = 0),
	(cc.ParticleSystem.TYPE_RELATIVE = 1),
	(cc.ParticleSystem.TYPE_GROUPED = 2),
	(function () {
		cc.ParticleSystem.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._drawMode = cc.ParticleSystem.TEXTURE_MODE),
				(this._shapeType = cc.ParticleSystem.BALL_SHAPE),
				(this._pointRect = cc.rect(0, 0, 0, 0)),
				(this._tintCache = document.createElement('canvas'));
		};
		var t = (cc.ParticleSystem.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.ParticleSystem.CanvasRenderCmd),
			(t.getDrawMode = function () {
				return this._drawMode;
			}),
			(t.setDrawMode = function (t) {
				this._drawMode = t;
			}),
			(t.getShapeType = function () {
				return this._shapeType;
			}),
			(t.setShapeType = function (t) {
				this._shapeType = t;
			}),
			(t.setBatchNode = function (t) {
				this._batchNode !== t && (this._node._batchNode = t);
			}),
			(t.updateQuadWithParticle = function (t, e) {}),
			(t.updateParticlePosition = function (t, e) {
				cc.pIn(t.drawPos, e);
			}),
			(t.rendering = function (t, e, i) {
				var n,
					r = t || cc._renderContext,
					o = r.getContext(),
					s = this._node,
					c = this._pointRect;
				r.setTransform(this._worldTransform, e, i),
					r.save(),
					s.isBlendAdditive()
						? (o.globalCompositeOperation = 'lighter')
						: (o.globalCompositeOperation = 'source-over');
				var a = this._node.particleCount,
					l = this._node._particles;
				if (s.drawMode !== cc.ParticleSystem.SHAPE_MODE && s._texture) {
					if (!s._texture._textureLoaded) return void r.restore();
					var h = s._texture.getHtmlElementObj();
					if (!h.width || !h.height) return void r.restore();
					for (var u, _ = 0; _ < a; _++) {
						var d,
							p,
							f,
							m,
							g = 0 | (0.5 * (n = l[_]).size);
						0 !== (m = n.color.a / 255) &&
							((o.globalAlpha = m),
							o.save(),
							o.translate(0 | n.drawPos.x, -(0 | n.drawPos.y)),
							(d = 4 * Math.floor(n.size / 4)),
							(p = c.width),
							(f = c.height),
							o.scale(
								Math.max((1 / p) * d, 1e-6),
								Math.max((1 / f) * d, 1e-6)
							),
							n.rotation &&
								o.rotate(cc.degreesToRadians(n.rotation)),
							(u = n.isChangeColor
								? this._changeTextureColor(
										s._texture,
										n.color,
										this._pointRect
								  )
								: h),
							o.drawImage(u, -(0 | (p / 2)), -(0 | (f / 2))),
							o.restore());
					}
				} else {
					var y = cc._drawingUtil;
					for (_ = 0; _ < a; _++)
						(g = 0 | (0.5 * (n = l[_]).size)),
							0 !== (m = n.color.a / 255) &&
								((o.globalAlpha = m),
								o.save(),
								o.translate(
									0 | n.drawPos.x,
									-(0 | n.drawPos.y)
								),
								s.shapeType === cc.ParticleSystem.STAR_SHAPE
									? (n.rotation &&
											o.rotate(
												cc.degreesToRadians(n.rotation)
											),
									  y.drawStar(r, g, n.color))
									: y.drawColorBall(r, g, n.color),
								o.restore());
				}
				r.restore(), cc.g_NumberOfDraws++;
			}),
			(t._changeTextureColor = function (t, e, i) {
				var n = this._tintCache,
					r = t.getContentSize();
				return (
					(n.width = r.width),
					(n.height = r.height),
					t._generateColorTexture(e.r, e.g, e.b, i, n)
				);
			}),
			(t.initTexCoordsWithRect = function (t) {
				this._pointRect = t;
			}),
			(t.setTotalParticles = function (t) {
				this._node._totalParticles = t < 200 ? t : 200;
			}),
			(t.addParticle = function () {
				var t,
					e = this._node,
					i = e._particles;
				return (
					e.particleCount < i.length
						? (t = i[e.particleCount])
						: ((t = new cc.Particle()), i.push(t)),
					t
				);
			}),
			(t._setupVBO = function () {}),
			(t._allocMemory = function () {
				return !0;
			}),
			(t.postStep = function () {}),
			(t._setBlendAdditive = function () {
				var t = this._node._blendFunc;
				(t.src = cc.BLEND_SRC), (t.dst = cc.BLEND_DST);
			}),
			(t._initWithTotalParticles = function (t) {}),
			(t._updateDeltaColor = function (t, e) {
				this._node._dontTint ||
					((t.color.r += t.deltaColor.r * e),
					(t.color.g += t.deltaColor.g * e),
					(t.color.b += t.deltaColor.b * e),
					(t.color.a += t.deltaColor.a * e),
					(t.isChangeColor = !0));
			});
	})(),
	(cc.ParticleFire = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 300 : 150
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, 0)),
					this.setRadialAccel(0),
					this.setRadialAccelVar(0),
					this.setSpeed(60),
					this.setSpeedVar(20),
					this.setAngle(90),
					this.setAngleVar(10);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, 60),
					this.setPosVar(cc.p(40, 20)),
					this.setLife(3),
					this.setLifeVar(0.25),
					this.setStartSize(54),
					this.setStartSizeVar(10),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(194, 64, 31, 255)),
					this.setStartColorVar(cc.color(0, 0, 0, 0)),
					this.setEndColor(cc.color(0, 0, 0, 255)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					this.setBlendAdditive(!0),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleFire.create = function () {
		return new cc.ParticleFire();
	}),
	(cc.ParticleFireworks = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 1500 : 150
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, -90)),
					this.setRadialAccel(0),
					this.setRadialAccelVar(0),
					this.setSpeed(180),
					this.setSpeedVar(50);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height / 2),
					this.setAngle(90),
					this.setAngleVar(20),
					this.setLife(3.5),
					this.setLifeVar(1),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(128, 128, 128, 255)),
					this.setStartColorVar(cc.color(128, 128, 128, 255)),
					this.setEndColor(cc.color(26, 26, 26, 51)),
					this.setEndColorVar(cc.color(26, 26, 26, 51)),
					this.setStartSize(8),
					this.setStartSizeVar(2),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setBlendAdditive(!1),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleFireworks.create = function () {
		return new cc.ParticleFireworks();
	}),
	(cc.ParticleSun = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 350 : 150
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setBlendAdditive(!0),
					this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, 0)),
					this.setRadialAccel(0),
					this.setRadialAccelVar(0),
					this.setSpeed(20),
					this.setSpeedVar(5),
					this.setAngle(90),
					this.setAngleVar(360);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height / 2),
					this.setPosVar(cc.p(0, 0)),
					this.setLife(1),
					this.setLifeVar(0.5),
					this.setStartSize(30),
					this.setStartSizeVar(10),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(194, 64, 31, 255)),
					this.setStartColorVar(cc.color(0, 0, 0, 0)),
					this.setEndColor(cc.color(0, 0, 0, 255)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleSun.create = function () {
		return new cc.ParticleSun();
	}),
	(cc.ParticleGalaxy = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 200 : 100
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, 0)),
					this.setSpeed(60),
					this.setSpeedVar(10),
					this.setRadialAccel(-80),
					this.setRadialAccelVar(0),
					this.setTangentialAccel(80),
					this.setTangentialAccelVar(0),
					this.setAngle(90),
					this.setAngleVar(360);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height / 2),
					this.setPosVar(cc.p(0, 0)),
					this.setLife(4),
					this.setLifeVar(1),
					this.setStartSize(37),
					this.setStartSizeVar(10),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(31, 64, 194, 255)),
					this.setStartColorVar(cc.color(0, 0, 0, 0)),
					this.setEndColor(cc.color(0, 0, 0, 255)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					this.setBlendAdditive(!0),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleGalaxy.create = function () {
		return new cc.ParticleGalaxy();
	}),
	(cc.ParticleFlower = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 250 : 100
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, 0)),
					this.setSpeed(80),
					this.setSpeedVar(10),
					this.setRadialAccel(-60),
					this.setRadialAccelVar(0),
					this.setTangentialAccel(15),
					this.setTangentialAccelVar(0),
					this.setAngle(90),
					this.setAngleVar(360);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height / 2),
					this.setPosVar(cc.p(0, 0)),
					this.setLife(4),
					this.setLifeVar(1),
					this.setStartSize(30),
					this.setStartSizeVar(10),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(128, 128, 128, 255)),
					this.setStartColorVar(cc.color(128, 128, 128, 128)),
					this.setEndColor(cc.color(0, 0, 0, 255)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					this.setBlendAdditive(!0),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleFlower.create = function () {
		return new cc.ParticleFlower();
	}),
	(cc.ParticleMeteor = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 150 : 100
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(-200, 200)),
					this.setSpeed(15),
					this.setSpeedVar(5),
					this.setRadialAccel(0),
					this.setRadialAccelVar(0),
					this.setTangentialAccel(0),
					this.setTangentialAccelVar(0),
					this.setAngle(90),
					this.setAngleVar(360);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height / 2),
					this.setPosVar(cc.p(0, 0)),
					this.setLife(2),
					this.setLifeVar(1),
					this.setStartSize(60),
					this.setStartSizeVar(10),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(51, 102, 179)),
					this.setStartColorVar(cc.color(0, 0, 51, 26)),
					this.setEndColor(cc.color(0, 0, 0, 255)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					this.setBlendAdditive(!0),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleMeteor.create = function () {
		return new cc.ParticleMeteor();
	}),
	(cc.ParticleSpiral = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 500 : 100
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, 0)),
					this.setSpeed(150),
					this.setSpeedVar(0),
					this.setRadialAccel(-380),
					this.setRadialAccelVar(0),
					this.setTangentialAccel(45),
					this.setTangentialAccelVar(0),
					this.setAngle(90),
					this.setAngleVar(0);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height / 2),
					this.setPosVar(cc.p(0, 0)),
					this.setLife(12),
					this.setLifeVar(0),
					this.setStartSize(20),
					this.setStartSizeVar(0),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(128, 128, 128, 255)),
					this.setStartColorVar(cc.color(128, 128, 128, 0)),
					this.setEndColor(cc.color(128, 128, 128, 255)),
					this.setEndColorVar(cc.color(128, 128, 128, 0)),
					this.setBlendAdditive(!1),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleSpiral.create = function () {
		return new cc.ParticleSpiral();
	}),
	(cc.ParticleExplosion = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 700 : 300
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(0.1),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, 0)),
					this.setSpeed(70),
					this.setSpeedVar(40),
					this.setRadialAccel(0),
					this.setRadialAccelVar(0),
					this.setTangentialAccel(0),
					this.setTangentialAccelVar(0),
					this.setAngle(90),
					this.setAngleVar(360);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height / 2),
					this.setPosVar(cc.p(0, 0)),
					this.setLife(5),
					this.setLifeVar(2),
					this.setStartSize(15),
					this.setStartSizeVar(10),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getDuration()
					),
					this.setStartColor(cc.color(179, 26, 51, 255)),
					this.setStartColorVar(cc.color(128, 128, 128, 0)),
					this.setEndColor(cc.color(128, 128, 128, 0)),
					this.setEndColorVar(cc.color(128, 128, 128, 0)),
					this.setBlendAdditive(!1),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleExplosion.create = function () {
		return new cc.ParticleExplosion();
	}),
	(cc.ParticleSmoke = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 200 : 100
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, 0)),
					this.setRadialAccel(0),
					this.setRadialAccelVar(0),
					this.setSpeed(25),
					this.setSpeedVar(10),
					this.setAngle(90),
					this.setAngleVar(5);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, 0),
					this.setPosVar(cc.p(20, 0)),
					this.setLife(4),
					this.setLifeVar(1),
					this.setStartSize(60),
					this.setStartSizeVar(10),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(
						this.getTotalParticles() / this.getLife()
					),
					this.setStartColor(cc.color(204, 204, 204, 255)),
					this.setStartColorVar(cc.color(5, 5, 5, 0)),
					this.setEndColor(cc.color(0, 0, 0, 255)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					this.setBlendAdditive(!1),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleSmoke.create = function () {
		return new cc.ParticleSmoke();
	}),
	(cc.ParticleSnow = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 700 : 250
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(0, -1)),
					this.setSpeed(5),
					this.setSpeedVar(1),
					this.setRadialAccel(0),
					this.setRadialAccelVar(1),
					this.setTangentialAccel(0),
					this.setTangentialAccelVar(1);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height + 10),
					this.setPosVar(cc.p(t.width / 2, 0)),
					this.setAngle(-90),
					this.setAngleVar(5),
					this.setLife(45),
					this.setLifeVar(15),
					this.setStartSize(10),
					this.setStartSizeVar(5),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(10),
					this.setStartColor(cc.color(255, 255, 255, 255)),
					this.setStartColorVar(cc.color(0, 0, 0, 0)),
					this.setEndColor(cc.color(255, 255, 255, 0)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					this.setBlendAdditive(!1),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleSnow.create = function () {
		return new cc.ParticleSnow();
	}),
	(cc.ParticleRain = cc.ParticleSystem.extend({
		ctor: function () {
			cc.ParticleSystem.prototype.ctor.call(
				this,
				cc._renderType === cc.game.RENDER_TYPE_WEBGL ? 1e3 : 300
			);
		},
		initWithTotalParticles: function (t) {
			if (
				cc.ParticleSystem.prototype.initWithTotalParticles.call(this, t)
			) {
				this.setDuration(cc.ParticleSystem.DURATION_INFINITY),
					this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),
					this.setGravity(cc.p(10, -10)),
					this.setRadialAccel(0),
					this.setRadialAccelVar(1),
					this.setTangentialAccel(0),
					this.setTangentialAccelVar(1),
					this.setSpeed(130),
					this.setSpeedVar(30),
					this.setAngle(-90),
					this.setAngleVar(5);
				t = cc.director.getWinSize();
				return (
					this.setPosition(t.width / 2, t.height),
					this.setPosVar(cc.p(t.width / 2, 0)),
					this.setLife(4.5),
					this.setLifeVar(0),
					this.setStartSize(4),
					this.setStartSizeVar(2),
					this.setEndSize(
						cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE
					),
					this.setEmissionRate(20),
					this.setStartColor(cc.color(179, 204, 255, 255)),
					this.setStartColorVar(cc.color(0, 0, 0, 0)),
					this.setEndColor(cc.color(179, 204, 255, 128)),
					this.setEndColorVar(cc.color(0, 0, 0, 0)),
					this.setBlendAdditive(!1),
					!0
				);
			}
			return !1;
		},
	})),
	(cc.ParticleRain.create = function () {
		return new cc.ParticleRain();
	}),
	(cc.PARTICLE_DEFAULT_CAPACITY = 500),
	(cc.ParticleBatchNode = cc.Node.extend({
		textureAtlas: null,
		_blendFunc: null,
		_className: 'ParticleBatchNode',
		ctor: function (t, e) {
			cc.Node.prototype.ctor.call(this),
				(this._blendFunc = { src: cc.BLEND_SRC, dst: cc.BLEND_DST }),
				cc.isString(t)
					? this.init(t, e)
					: t instanceof cc.Texture2D && this.initWithTexture(t, e);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.ParticleBatchNode.CanvasRenderCmd
					: cc.ParticleBatchNode.WebGLRenderCmd
			)(this);
		},
		initWithTexture: function (t, e) {
			return (
				(this.textureAtlas = new cc.TextureAtlas()),
				this.textureAtlas.initWithTexture(t, e),
				(this._children.length = 0),
				this._renderCmd._initWithTexture(),
				!0
			);
		},
		initWithFile: function (t, e) {
			t = cc.textureCache.addImage(t);
			return this.initWithTexture(t, e);
		},
		init: function (t, e) {
			t = cc.textureCache.addImage(t);
			return this.initWithTexture(t, e);
		},
		addChild: function (t, e, i) {
			if (!t)
				throw new Error(
					'cc.ParticleBatchNode.addChild() : child should be non-null'
				);
			if (!(t instanceof cc.ParticleSystem))
				throw new Error(
					'cc.ParticleBatchNode.addChild() : only supports cc.ParticleSystem as children'
				);
			if (
				((e = null == e ? t.zIndex : e),
				(i = null == i ? t.tag : i),
				t.getTexture() !== this.textureAtlas.texture)
			)
				throw new Error(
					'cc.ParticleSystem.addChild() : the child is not using the same texture id'
				);
			var n = t.getBlendFunc();
			if (0 === this._children.length) this.setBlendFunc(n);
			else if (
				n.src !== this._blendFunc.src ||
				n.dst !== this._blendFunc.dst
			)
				return void cc.log(
					"cc.ParticleSystem.addChild() : Can't add a ParticleSystem that uses a different blending function"
				);
			(e = this._addChildHelper(t, e, i)), (i = 0);
			(i =
				0 !== e
					? (e = this._children[e - 1]).getAtlasIndex() +
					  e.getTotalParticles()
					: 0),
				this.insertChild(t, i),
				t.setBatchNode(this);
		},
		insertChild: function (t, e) {
			var i = t.getTotalParticles(),
				n = this.textureAtlas,
				r = n.totalQuads;
			t.setAtlasIndex(e),
				r + i > n.getCapacity() &&
					(this._increaseAtlasCapacityTo(r + i),
					n.fillWithEmptyQuadsFromIndex(n.getCapacity() - i, i)),
				t.getAtlasIndex() + i !== r && n.moveQuadsFromIndex(e, e + i),
				n.increaseTotalQuadsWith(i),
				this._updateAllAtlasIndexes();
		},
		removeChild: function (t, e) {
			if (null != t) {
				if (!(t instanceof cc.ParticleSystem))
					throw new Error(
						'cc.ParticleBatchNode.removeChild(): only supports cc.ParticleSystem as children'
					);
				-1 !== this._children.indexOf(t)
					? (cc.Node.prototype.removeChild.call(this, t, e),
					  (e = this.textureAtlas).removeQuadsAtIndex(
							t.getAtlasIndex(),
							t.getTotalParticles()
					  ),
					  e.fillWithEmptyQuadsFromIndex(
							e.totalQuads,
							t.getTotalParticles()
					  ),
					  t.setBatchNode(null),
					  this._updateAllAtlasIndexes())
					: cc.log(
							"cc.ParticleBatchNode.removeChild(): doesn't contain the sprite. Can't remove it"
					  );
			}
		},
		reorderChild: function (t, e) {
			if (!t)
				throw new Error(
					'cc.ParticleBatchNode.reorderChild(): child should be non-null'
				);
			if (!(t instanceof cc.ParticleSystem))
				throw new Error(
					'cc.ParticleBatchNode.reorderChild(): only supports cc.QuadParticleSystems as children'
				);
			if (-1 !== this._children.indexOf(t)) {
				if (e !== t.zIndex) {
					if (1 < this._children.length) {
						var i = this._getCurrentIndex(t, e);
						if (i.oldIndex !== i.newIndex) {
							this._children.splice(i.oldIndex, 1),
								this._children.splice(i.newIndex, 0, t);
							i = t.getAtlasIndex();
							this._updateAllAtlasIndexes();
							for (
								var n = 0, r = this._children, o = 0;
								o < r.length;
								o++
							)
								if (r[o] === t) {
									n = t.getAtlasIndex();
									break;
								}
							this.textureAtlas.moveQuadsFromIndex(
								i,
								t.getTotalParticles(),
								n
							),
								t.updateWithNoTime();
						}
					}
					t._setLocalZOrder(e);
				}
			} else
				cc.log(
					"cc.ParticleBatchNode.reorderChild(): Child doesn't belong to batch"
				);
		},
		removeChildAtIndex: function (t, e) {
			this.removeChild(this._children[i], e);
		},
		removeAllChildren: function (t) {
			for (var e = this._children, i = 0; i < e.length; i++)
				e[i].setBatchNode(null);
			cc.Node.prototype.removeAllChildren.call(this, t),
				this.textureAtlas.removeAllQuads();
		},
		disableParticle: function (t) {
			t = this.textureAtlas.quads[t];
			(t.br.vertices.x =
				t.br.vertices.y =
				t.tr.vertices.x =
				t.tr.vertices.y =
				t.tl.vertices.x =
				t.tl.vertices.y =
				t.bl.vertices.x =
				t.bl.vertices.y =
					0),
				this.textureAtlas._setDirty(!0);
		},
		getTexture: function () {
			return this.textureAtlas.texture;
		},
		setTexture: function (t) {
			this.textureAtlas.texture = t;
			var e = this._blendFunc;
			t &&
				!t.hasPremultipliedAlpha() &&
				e.src === cc.BLEND_SRC &&
				e.dst === cc.BLEND_DST &&
				((e.src = cc.SRC_ALPHA), (e.dst = cc.ONE_MINUS_SRC_ALPHA));
		},
		setBlendFunc: function (t, e) {
			void 0 === e
				? ((this._blendFunc.src = t.src), (this._blendFunc.dst = t.dst))
				: ((this._blendFunc.src = t), (this._blendFunc.src = e));
		},
		getBlendFunc: function () {
			return new cc.BlendFunc(this._blendFunc.src, this._blendFunc.dst);
		},
		_updateAllAtlasIndexes: function () {
			for (var t = 0, e = this._children, i = 0; i < e.length; i++) {
				var n = e[i];
				n.setAtlasIndex(t), (t += n.getTotalParticles());
			}
		},
		_increaseAtlasCapacityTo: function (t) {
			cc.log(
				'cocos2d: cc.ParticleBatchNode: resizing TextureAtlas capacity from [' +
					this.textureAtlas.getCapacity() +
					'] to [' +
					t +
					'].'
			),
				this.textureAtlas.resizeCapacity(t) ||
					cc.log(
						'cc.ParticleBatchNode._increaseAtlasCapacityTo() : WARNING: Not enough memory to resize the atlas'
					);
		},
		_searchNewPositionInChildrenForZ: function (t) {
			for (var e = this._children, i = e.length, n = 0; n < i; n++)
				if (e[n].zIndex > t) return n;
			return i;
		},
		_getCurrentIndex: function (t, e) {
			for (
				var i = !1,
					n = !1,
					r = 0,
					o = 0,
					s = 0,
					c = this._children,
					a = c.length,
					l = 0;
				l < a;
				l++
			) {
				var h = c[l];
				if (h.zIndex > e && !n && ((r = l), (n = !0), i && n)) break;
				if (t === h && ((o = l), n || (s = -1), (i = !0) && n)) break;
			}
			return n || (r = a), { newIndex: (r += s), oldIndex: o };
		},
		_addChildHelper: function (t, e, i) {
			if (!t)
				throw new Error(
					'cc.ParticleBatchNode._addChildHelper(): child should be non-null'
				);
			if (t.parent)
				return (
					cc.log(
						"cc.ParticleBatchNode._addChildHelper(): child already added. It can't be added again"
					),
					null
				);
			this._children || (this._children = []);
			var n = this._searchNewPositionInChildrenForZ(e);
			return (
				this._children.splice(n, 0, t),
				(t.tag = i),
				t._setLocalZOrder(e),
				(t.parent = this)._running &&
					(t.onEnter(), t.onEnterTransitionDidFinish()),
				n
			);
		},
		_updateBlendFunc: function () {
			this.textureAtlas.texture.hasPremultipliedAlpha() ||
				((this._blendFunc.src = cc.SRC_ALPHA),
				(this._blendFunc.dst = cc.ONE_MINUS_SRC_ALPHA));
		},
		getTextureAtlas: function () {
			return this.textureAtlas;
		},
		setTextureAtlas: function (t) {
			this.textureAtlas = t;
		},
	}));
var _p = cc.ParticleBatchNode.prototype;
_p.texture,
	cc.defineGetterSetter(_p, 'texture', _p.getTexture, _p.setTexture),
	(cc.ParticleBatchNode.create = function (t, e) {
		return new cc.ParticleBatchNode(t, e);
	}),
	(function () {
		cc.ParticleBatchNode.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t), (this._needDraw = !1);
		};
		var t = (cc.ParticleBatchNode.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.ParticleBatchNode.CanvasRenderCmd),
			(t._initWithTexture = function () {});
	})(),
	(function () {
		cc.ParticleBatchNode.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._matrix = new cc.math.Matrix4()),
				this._matrix.identity();
		};
		var t = (cc.ParticleBatchNode.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.ParticleBatchNode.WebGLRenderCmd),
			(t.rendering = function (t) {
				var e,
					i = this._node;
				0 !== i.textureAtlas.totalQuads &&
					((e = this._worldTransform),
					(this._matrix.mat[0] = e.a),
					(this._matrix.mat[4] = e.c),
					(this._matrix.mat[12] = e.tx),
					(this._matrix.mat[1] = e.b),
					(this._matrix.mat[5] = e.d),
					(this._matrix.mat[13] = e.ty),
					this._shaderProgram.use(),
					this._shaderProgram._setUniformForMVPMatrixWithMat4(
						this._matrix
					),
					cc.glBlendFuncForParticle(
						i._blendFunc.src,
						i._blendFunc.dst
					),
					i.textureAtlas.drawQuads());
			}),
			(t._initWithTexture = function () {
				this._shaderProgram = cc.shaderCache.programForKey(
					cc.SHADER_POSITION_TEXTURECOLOR
				);
			}),
			(t.visit = function (t) {
				this._node._visible &&
					((t = t || this.getParentRenderCmd()) &&
						(this._curLevel = t._curLevel + 1),
					this._syncStatus(t),
					cc.renderer.pushRenderCommand(this),
					(this._dirtyFlag = 0));
			});
	})(),
	(function () {
		cc.ParticleSystem.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._matrix = new cc.math.Matrix4()),
				this._matrix.identity(),
				(this._buffersVBO = [0, 0]),
				(this._quads = []),
				(this._indices = []),
				(this._quadsArrayBuffer = null);
		};
		var t = (cc.ParticleSystem.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.ParticleSystem.WebGLRenderCmd),
			(t.getDrawMode = function () {}),
			(t.setDrawMode = function (t) {}),
			(t.getShapeType = function () {}),
			(t.setShapeType = function (t) {}),
			(t.setBatchNode = function (t) {
				var e = this._node;
				if (e._batchNode !== t) {
					var i = e._batchNode;
					if ((e._batchNode = t))
						for (
							var n = e._particles, r = 0;
							r < e._totalParticles;
							r++
						)
							n[r].atlasIndex = r;
					t
						? i ||
						  (e._batchNode.textureAtlas._copyQuadsToTextureAtlas(
								this._quads,
								e.atlasIndex
						  ),
						  cc._renderContext.deleteBuffer(this._buffersVBO[1]))
						: (this._allocMemory(),
						  this.initIndices(e._totalParticles),
						  e.setTexture(i.getTexture()),
						  this._setupVBO());
				}
			}),
			(t.initIndices = function (t) {
				for (var e = this._indices, i = 0, n = t; i < n; ++i) {
					var r = 6 * i,
						o = 4 * i;
					(e[0 + r] = 0 + o),
						(e[1 + r] = 1 + o),
						(e[2 + r] = 2 + o),
						(e[5 + r] = 1 + o),
						(e[4 + r] = 2 + o),
						(e[3 + r] = 3 + o);
				}
			}),
			(t.isDifferentTexture = function (t, e) {
				return t === e;
			}),
			(t.updateParticlePosition = function (t, e) {
				this.updateQuadWithParticle(t, e);
			}),
			(t.updateQuadWithParticle = function (t, e) {
				var i = null,
					n = this._node;
				n._batchNode
					? ((i =
							n._batchNode.textureAtlas.quads[
								n.atlasIndex + t.atlasIndex
							]),
					  (n._batchNode.textureAtlas.dirty = !0))
					: (i = this._quads[n._particleIdx]),
					(d = n._opacityModifyRGB
						? ((l = 0 | ((t.color.r * t.color.a) / 255)),
						  (_ = 0 | ((t.color.g * t.color.a) / 255)),
						  0 | ((t.color.b * t.color.a) / 255))
						: ((l = 0 | t.color.r),
						  (_ = 0 | t.color.g),
						  0 | t.color.b)),
					(h = 0 | t.color.a);
				var r = i.bl.colors,
					o = i.br.colors,
					s = i.tl.colors,
					c = i.tr.colors;
				(r.r = o.r = s.r = c.r = l),
					(r.g = o.g = s.g = c.g = _),
					(r.b = o.b = s.b = c.b = d),
					(r.a = o.a = s.a = c.a = h);
				var a,
					l,
					h,
					u,
					_,
					d,
					p = t.size / 2;
				t.rotation
					? ((u = a = -p),
					  (l = n = p),
					  (_ = e.x),
					  (d = e.y),
					  (r = -cc.degreesToRadians(t.rotation)),
					  (c = a * (o = Math.cos(r)) - u * (s = Math.sin(r)) + _),
					  (h = a * s + u * o + d),
					  (t = n * o - u * s + _),
					  (r = n * s + u * o + d),
					  (u = n * o - l * s + _),
					  (n = n * s + l * o + d),
					  (_ = a * o - l * s + _),
					  (d = a * s + l * o + d),
					  (i.bl.vertices.x = c),
					  (i.bl.vertices.y = h),
					  (i.br.vertices.x = t),
					  (i.br.vertices.y = r),
					  (i.tl.vertices.x = _),
					  (i.tl.vertices.y = d),
					  (i.tr.vertices.x = u),
					  (i.tr.vertices.y = n))
					: ((i.bl.vertices.x = e.x - p),
					  (i.bl.vertices.y = e.y - p),
					  (i.br.vertices.x = e.x + p),
					  (i.br.vertices.y = e.y - p),
					  (i.tl.vertices.x = e.x - p),
					  (i.tl.vertices.y = e.y + p),
					  (i.tr.vertices.x = e.x + p),
					  (i.tr.vertices.y = e.y + p));
			}),
			(t.rendering = function (t) {
				var e,
					i = this._node;
				i._texture &&
					((e = t || cc._renderContext),
					(t = this._worldTransform),
					(this._matrix.mat[0] = t.a),
					(this._matrix.mat[4] = t.c),
					(this._matrix.mat[12] = t.tx),
					(this._matrix.mat[1] = t.b),
					(this._matrix.mat[5] = t.d),
					(this._matrix.mat[13] = t.ty),
					this._shaderProgram.use(),
					this._shaderProgram._setUniformForMVPMatrixWithMat4(
						this._matrix
					),
					cc.glBindTexture2D(i._texture),
					cc.glBlendFuncForParticle(
						i._blendFunc.src,
						i._blendFunc.dst
					),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),
					e.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
					e.bindBuffer(e.ARRAY_BUFFER, this._buffersVBO[0]),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_POSITION,
						3,
						e.FLOAT,
						!1,
						24,
						0
					),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_COLOR,
						4,
						e.UNSIGNED_BYTE,
						!0,
						24,
						12
					),
					e.vertexAttribPointer(
						cc.VERTEX_ATTRIB_TEX_COORDS,
						2,
						e.FLOAT,
						!1,
						24,
						16
					),
					e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._buffersVBO[1]),
					e.drawElements(
						e.TRIANGLES,
						6 * i._particleIdx,
						e.UNSIGNED_SHORT,
						0
					));
			}),
			(t.initTexCoordsWithRect = function (t) {
				var e,
					i,
					n = this._node,
					r = n.texture,
					o = cc.contentScaleFactor(),
					s = cc.rect(t.x * o, t.y * o, t.width * o, t.height * o),
					o = t.width,
					t = t.height;
				r && ((o = r.pixelsWidth), (t = r.pixelsHeight));
				for (
					var c,
						t = (a = cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL
							? ((e = (2 * s.x + 1) / (2 * o)),
							  (l = (2 * s.y + 1) / (2 * t)),
							  (i = e + (2 * s.width - 2) / (2 * o)),
							  l + (2 * s.height - 2) / (2 * t))
							: ((e = s.x / o),
							  (l = s.y / t),
							  (i = e + s.width / o),
							  l + s.height / t)),
						a = l,
						l = t,
						t = 0,
						h = 0,
						h = n._batchNode
							? ((c = n._batchNode.textureAtlas.quads),
							  (t = n.atlasIndex),
							  n.atlasIndex + n._totalParticles)
							: ((c = this._quads), (t = 0), n._totalParticles),
						u = t;
					u < h;
					u++
				) {
					c[u] || (c[u] = cc.V3F_C4B_T2F_QuadZero());
					var _ = c[u];
					(_.bl.texCoords.u = e),
						(_.bl.texCoords.v = l),
						(_.br.texCoords.u = i),
						(_.br.texCoords.v = l),
						(_.tl.texCoords.u = e),
						(_.tl.texCoords.v = a),
						(_.tr.texCoords.u = i),
						(_.tr.texCoords.v = a);
				}
			}),
			(t.setTotalParticles = function (t) {
				var e = this._node;
				if (t > e._allocatedParticles) {
					var i = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;
					this._indices = new Uint16Array(6 * t);
					var n = new ArrayBuffer(t * i),
						r = e._particles;
					r.length = 0;
					for (var o = this._quads, s = (o.length = 0); s < t; s++)
						(r[s] = new cc.Particle()),
							(o[s] = new cc.V3F_C4B_T2F_Quad(
								null,
								null,
								null,
								null,
								n,
								s * i
							));
					if (
						((e._allocatedParticles = t),
						(e._totalParticles = t),
						e._batchNode)
					)
						for (var c = 0; c < t; c++) r[c].atlasIndex = c;
					(this._quadsArrayBuffer = n),
						this.initIndices(t),
						this._setupVBO(),
						e._texture &&
							this.initTexCoordsWithRect(
								cc.rect(
									0,
									0,
									e._texture.width,
									e._texture.height
								)
							);
				} else e._totalParticles = t;
				e.resetSystem();
			}),
			(t.addParticle = function () {
				var t = this._node;
				return t._particles[t.particleCount];
			}),
			(t._setupVBO = function () {
				var t = cc._renderContext;
				(this._buffersVBO[0] = t.createBuffer()),
					t.bindBuffer(t.ARRAY_BUFFER, this._buffersVBO[0]),
					t.bufferData(
						t.ARRAY_BUFFER,
						this._quadsArrayBuffer,
						t.DYNAMIC_DRAW
					),
					(this._buffersVBO[1] = t.createBuffer()),
					t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this._buffersVBO[1]),
					t.bufferData(
						t.ELEMENT_ARRAY_BUFFER,
						this._indices,
						t.STATIC_DRAW
					);
			}),
			(t._allocMemory = function () {
				var t = this._node;
				if (t._batchNode)
					return (
						cc.log(
							'cc.ParticleSystem._allocMemory(): Memory should not be allocated when not using batchNode'
						),
						!1
					);
				var e = cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
					i = t._totalParticles,
					n = this._quads;
				(n.length = 0), (this._indices = new Uint16Array(6 * i));
				for (var r = new ArrayBuffer(e * i), o = 0; o < i; o++)
					n[o] = new cc.V3F_C4B_T2F_Quad(
						null,
						null,
						null,
						null,
						r,
						o * e
					);
				return n && this._indices
					? ((this._quadsArrayBuffer = r), !0)
					: (cc.log('cocos2d: Particle system: not enough memory'),
					  !1);
			}),
			(t.postStep = function () {
				var t = cc._renderContext;
				t.bindBuffer(t.ARRAY_BUFFER, this._buffersVBO[0]),
					t.bufferSubData(t.ARRAY_BUFFER, 0, this._quadsArrayBuffer);
			}),
			(t._setBlendAdditive = function () {
				var t = this._node._blendFunc;
				this._texture && !this._texture.hasPremultipliedAlpha()
					? ((t.src = cc.SRC_ALPHA), (t.dst = cc.ONE_MINUS_SRC_ALPHA))
					: ((t.src = cc.BLEND_SRC), (t.dst = cc.BLEND_DST));
			}),
			(t._initWithTotalParticles = function (t) {
				if (!this._allocMemory()) return !1;
				this.initIndices(t),
					this._setupVBO(),
					(this._shaderProgram = cc.shaderCache.programForKey(
						cc.SHADER_POSITION_TEXTURECOLOR
					));
			}),
			(t._updateDeltaColor = function (t, e) {
				(t.color.r += t.deltaColor.r * e),
					(t.color.g += t.deltaColor.g * e),
					(t.color.b += t.deltaColor.b * e),
					(t.color.a += t.deltaColor.a * e),
					(t.isChangeColor = !0);
			});
	})(),
	(cc.IMEKeyboardNotificationInfo = function (t, e, i) {
		(this.begin = t || cc.rect(0, 0, 0, 0)),
			(this.end = e || cc.rect(0, 0, 0, 0)),
			(this.duration = i || 0);
	}),
	(cc.IMEDelegate = cc.Class.extend({
		ctor: function () {
			cc.imeDispatcher.addDelegate(this);
		},
		removeDelegate: function () {
			cc.imeDispatcher.removeDelegate(this);
		},
		attachWithIME: function () {
			return cc.imeDispatcher.attachDelegateWithIME(this);
		},
		detachWithIME: function () {
			return cc.imeDispatcher.detachDelegateWithIME(this);
		},
		canAttachWithIME: function () {
			return !1;
		},
		didAttachWithIME: function () {},
		canDetachWithIME: function () {
			return !1;
		},
		didDetachWithIME: function () {},
		insertText: function (t, e) {},
		deleteBackward: function () {},
		getContentText: function () {
			return '';
		},
		keyboardWillShow: function (t) {},
		keyboardDidShow: function (t) {},
		keyboardWillHide: function (t) {},
		keyboardDidHide: function (t) {},
	})),
	(cc.IMEDispatcher = cc.Class.extend({
		_domInputControl: null,
		impl: null,
		_currentInputString: '',
		_lastClickPosition: null,
		ctor: function () {
			(this.impl = new cc.IMEDispatcher.Impl()),
				(this._lastClickPosition = cc.p(0, 0));
		},
		init: function () {
			var i;
			cc.sys.isMobile ||
				((this._domInputControl = cc.$('#imeDispatcherInput')),
				this._domInputControl ||
					((this._domInputControl = cc.$new('input')),
					this._domInputControl.setAttribute('type', 'text'),
					this._domInputControl.setAttribute(
						'id',
						'imeDispatcherInput'
					),
					this._domInputControl.resize(0, 0),
					this._domInputControl.translates(0, 0),
					(this._domInputControl.style.opacity = '0'),
					(this._domInputControl.style.fontSize = '1px'),
					this._domInputControl.setAttribute('tabindex', 2),
					(this._domInputControl.style.position = 'absolute'),
					(this._domInputControl.style.top = 0),
					(this._domInputControl.style.left = 0),
					document.body.appendChild(this._domInputControl)),
				(i = this)._domInputControl.addEventListener(
					'input',
					function () {
						i._processDomInputString(i._domInputControl.value);
					},
					!1
				),
				this._domInputControl.addEventListener(
					'keydown',
					function (t) {
						t.keyCode === cc.KEY.tab
							? (t.stopPropagation(), t.preventDefault())
							: t.keyCode === cc.KEY.enter &&
							  (i.dispatchInsertText('\n', 1),
							  t.stopPropagation(),
							  t.preventDefault());
					},
					!1
				),
				/msie/i.test(navigator.userAgent) &&
					this._domInputControl.addEventListener(
						'keyup',
						function (t) {
							t.keyCode === cc.KEY.backspace &&
								i._processDomInputString(
									i._domInputControl.value
								);
						},
						!1
					),
				window.addEventListener(
					'mousedown',
					function (t) {
						var e = t.pageX || 0,
							t = t.pageY || 0;
						(i._lastClickPosition.x = e),
							(i._lastClickPosition.y = t);
					},
					!1
				));
		},
		_processDomInputString: function (t) {
			for (
				var e = (
						this._currentInputString.length < t.length
							? this._currentInputString
							: t
					).length,
					i = 0;
				i < e && t[i] === this._currentInputString[i];
				i++
			);
			for (
				var n = this._currentInputString.length - i,
					r = t.length - i,
					o = 0;
				o < n;
				o++
			)
				this.dispatchDeleteBackward();
			for (o = 0; o < r; o++) this.dispatchInsertText(t[i + o], 1);
			this._currentInputString = t;
		},
		dispatchInsertText: function (t, e) {
			!this.impl ||
				!t ||
				e <= 0 ||
				(this.impl._delegateWithIme &&
					this.impl._delegateWithIme.insertText(t, e));
		},
		dispatchDeleteBackward: function () {
			this.impl &&
				this.impl._delegateWithIme &&
				this.impl._delegateWithIme.deleteBackward();
		},
		getContentText: function () {
			if (this.impl && this.impl._delegateWithIme) {
				var t = this.impl._delegateWithIme.getContentText();
				return t || '';
			}
			return '';
		},
		dispatchKeyboardWillShow: function (t) {
			if (this.impl)
				for (var e = 0; e < this.impl._delegateList.length; e++) {
					var i = this.impl._delegateList[e];
					i && i.keyboardWillShow(t);
				}
		},
		dispatchKeyboardDidShow: function (t) {
			if (this.impl)
				for (var e = 0; e < this.impl._delegateList.length; e++) {
					var i = this.impl._delegateList[e];
					i && i.keyboardDidShow(t);
				}
		},
		dispatchKeyboardWillHide: function (t) {
			if (this.impl)
				for (var e = 0; e < this.impl._delegateList.length; e++) {
					var i = this.impl._delegateList[e];
					i && i.keyboardWillHide(t);
				}
		},
		dispatchKeyboardDidHide: function (t) {
			if (this.impl)
				for (var e = 0; e < this.impl._delegateList.length; e++) {
					var i = this.impl._delegateList[e];
					i && i.keyboardDidHide(t);
				}
		},
		addDelegate: function (t) {
			t &&
				this.impl &&
				(-1 < this.impl._delegateList.indexOf(t) ||
					this.impl._delegateList.splice(0, 0, t));
		},
		attachDelegateWithIME: function (t) {
			if (!this.impl || !t) return !1;
			if (-1 === this.impl._delegateList.indexOf(t)) return !1;
			if (this.impl._delegateWithIme) {
				if (
					!this.impl._delegateWithIme.canDetachWithIME() ||
					!t.canAttachWithIME()
				)
					return !1;
				var e = this.impl._delegateWithIme;
				return (
					(this.impl._delegateWithIme = null),
					e.didDetachWithIME(),
					this._focusDomInput(t),
					!0
				);
			}
			return !!t.canAttachWithIME() && (this._focusDomInput(t), !0);
		},
		_focusDomInput: function (t) {
			var e, i;
			cc.sys.isMobile
				? ((this.impl._delegateWithIme = t).didAttachWithIME(),
				  (this._currentInputString = t.string || ''),
				  (i = t.getTipMessage
						? t.getTipMessage()
						: 'please enter your word:'),
				  null !=
						(i =
							(e = window.Window) &&
							e.prototype.prompt &&
							e.prototype.prompt != prompt
								? e.prototype.prompt.call(
										window,
										i,
										this._currentInputString
								  )
								: prompt(i, this._currentInputString)) &&
						this._processDomInputString(i),
				  this.dispatchInsertText('\n', 1))
				: ((this.impl._delegateWithIme = t),
				  (this._currentInputString = t.string || ''),
				  t.didAttachWithIME(),
				  this._domInputControl.focus(),
				  (this._domInputControl.value = this._currentInputString),
				  this._domInputControlTranslate());
		},
		_domInputControlTranslate: function () {
			/msie/i.test(navigator.userAgent)
				? ((this._domInputControl.style.left =
						this._lastClickPosition.x + 'px'),
				  (this._domInputControl.style.top =
						this._lastClickPosition.y + 'px'))
				: this._domInputControl.translates(
						this._lastClickPosition.x,
						this._lastClickPosition.y
				  );
		},
		detachDelegateWithIME: function (t) {
			return (
				!(!this.impl || !t) &&
				this.impl._delegateWithIme === t &&
				!!t.canDetachWithIME() &&
				((this.impl._delegateWithIme = null),
				t.didDetachWithIME(),
				cc._canvas.focus(),
				!0)
			);
		},
		removeDelegate: function (t) {
			this.impl &&
				t &&
				-1 !== this.impl._delegateList.indexOf(t) &&
				(this.impl._delegateWithIme &&
					t === this.impl._delegateWithIme &&
					(this.impl._delegateWithIme = null),
				cc.arrayRemoveObject(this.impl._delegateList, t));
		},
		processKeycode: function (t) {
			t < 32
				? t === cc.KEY.backspace
					? this.dispatchDeleteBackward()
					: t === cc.KEY.enter
					? this.dispatchInsertText('\n', 1)
					: t === cc.KEY.tab || cc.KEY.escape
				: t < 255 && this.dispatchInsertText(String.fromCharCode(t), 1);
		},
	})),
	(cc.IMEDispatcher.Impl = cc.Class.extend({
		_delegateWithIme: null,
		_delegateList: null,
		ctor: function () {
			this._delegateList = [];
		},
		findDelegate: function (t) {
			for (var e = 0; e < this._delegateList.length; e++)
				if (this._delegateList[e] === t) return e;
			return null;
		},
	})),
	(cc.imeDispatcher = new cc.IMEDispatcher()),
	document.body
		? cc.imeDispatcher.init()
		: window.addEventListener(
				'load',
				function () {
					cc.imeDispatcher.init();
				},
				!1
		  ),
	(cc.TextFieldDelegate = cc.Class.extend({
		onTextFieldAttachWithIME: function (t) {
			return !1;
		},
		onTextFieldDetachWithIME: function (t) {
			return !1;
		},
		onTextFieldInsertText: function (t, e, i) {
			return !1;
		},
		onTextFieldDeleteBackward: function (t, e, i) {
			return !1;
		},
		onDraw: function (t) {
			return !1;
		},
	})),
	(cc.TextFieldTTF = cc.LabelTTF.extend({
		delegate: null,
		colorSpaceHolder: null,
		_colorText: null,
		_lens: null,
		_inputText: '',
		_placeHolder: '',
		_charCount: 0,
		_className: 'TextFieldTTF',
		ctor: function (t, e, i, n, r) {
			(this.colorSpaceHolder = cc.color(127, 127, 127)),
				(this._colorText = cc.color(255, 255, 255, 255)),
				cc.LabelTTF.prototype.ctor.call(this),
				void 0 !== r
					? (this.initWithPlaceHolder('', e, i, n, r),
					  t && this.setPlaceHolder(t))
					: void 0 === n &&
					  void 0 !== i &&
					  (this.initWithString('', e, i),
					  t && this.setPlaceHolder(t));
		},
		onEnter: function () {
			cc.LabelTTF.prototype.onEnter.call(this),
				cc.imeDispatcher.addDelegate(this);
		},
		onExit: function () {
			cc.LabelTTF.prototype.onExit.call(this),
				cc.imeDispatcher.removeDelegate(this);
		},
		getDelegate: function () {
			return this.delegate;
		},
		setDelegate: function (t) {
			this.delegate = t;
		},
		getCharCount: function () {
			return this._charCount;
		},
		getColorSpaceHolder: function () {
			return cc.color(this.colorSpaceHolder);
		},
		setColorSpaceHolder: function (t) {
			(this.colorSpaceHolder.r = t.r),
				(this.colorSpaceHolder.g = t.g),
				(this.colorSpaceHolder.b = t.b),
				(this.colorSpaceHolder.a = cc.isUndefined(t.a) ? 255 : t.a),
				this._inputText.length || this.setColor(this.colorSpaceHolder);
		},
		setTextColor: function (t) {
			(this._colorText.r = t.r),
				(this._colorText.g = t.g),
				(this._colorText.b = t.b),
				(this._colorText.a = cc.isUndefined(t.a) ? 255 : t.a),
				this._inputText.length && this.setColor(this._colorText);
		},
		initWithPlaceHolder: function (t, e, i, n, r) {
			switch (arguments.length) {
				case 5:
					return (
						t && this.setPlaceHolder(t),
						this.initWithString(this._placeHolder, n, r, e, i)
					);
				case 3:
					return (
						t && this.setPlaceHolder(t),
						this.initWithString(this._placeHolder, e, i)
					);
				default:
					throw new Error('Argument must be non-nil ');
			}
		},
		setString: function (t) {
			(t = String(t)),
				(this._inputText = t || ''),
				this._inputText.length
					? (cc.LabelTTF.prototype.setString.call(
							this,
							this._inputText
					  ),
					  this.setColor(this._colorText))
					: (cc.LabelTTF.prototype.setString.call(
							this,
							this._placeHolder
					  ),
					  this.setColor(this.colorSpaceHolder)),
				cc._renderType === cc.game.RENDER_TYPE_CANVAS &&
					this._renderCmd._updateTexture(),
				(this._charCount = this._inputText.length);
		},
		getString: function () {
			return this._inputText;
		},
		setPlaceHolder: function (t) {
			(this._placeHolder = t || ''),
				this._inputText.length ||
					(cc.LabelTTF.prototype.setString.call(
						this,
						this._placeHolder
					),
					this.setColor(this.colorSpaceHolder));
		},
		getPlaceHolder: function () {
			return this._placeHolder;
		},
		draw: function (t) {
			t = t || cc._renderContext;
			(this.delegate && this.delegate.onDraw(this)) ||
				cc.LabelTTF.prototype.draw.call(this, t);
		},
		visit: function (t) {
			this._super(t);
		},
		attachWithIME: function () {
			return cc.imeDispatcher.attachDelegateWithIME(this);
		},
		detachWithIME: function () {
			return cc.imeDispatcher.detachDelegateWithIME(this);
		},
		canAttachWithIME: function () {
			return (
				!this.delegate || !this.delegate.onTextFieldAttachWithIME(this)
			);
		},
		didAttachWithIME: function () {},
		canDetachWithIME: function () {
			return (
				!this.delegate || !this.delegate.onTextFieldDetachWithIME(this)
			);
		},
		didDetachWithIME: function () {},
		deleteBackward: function () {
			var t = this._inputText.length;
			if (0 !== t)
				if (
					!this.delegate ||
					!this.delegate.onTextFieldDeleteBackward(
						this,
						this._inputText[t - 1],
						1
					)
				)
					return t <= 1
						? ((this._inputText = ''),
						  (this._charCount = 0),
						  cc.LabelTTF.prototype.setString.call(
								this,
								this._placeHolder
						  ),
						  void this.setColor(this.colorSpaceHolder))
						: void (this.string = this._inputText.substring(
								0,
								t - 1
						  ));
		},
		removeDelegate: function () {
			cc.imeDispatcher.removeDelegate(this);
		},
		_tipMessage: 'please enter your word:',
		setTipMessage: function (t) {
			null != t && (this._tipMessage = t);
		},
		getTipMessage: function () {
			return this._tipMessage;
		},
		insertText: function (t, e) {
			var i = t,
				t = i.indexOf('\n');
			if ((-1 < t && (i = i.substring(0, t)), 0 < i.length)) {
				if (
					this.delegate &&
					this.delegate.onTextFieldInsertText(this, i, i.length)
				)
					return;
				i = this._inputText + i;
				(this._charCount = i.length), (this.string = i);
			}
			-1 !== t &&
				((this.delegate &&
					this.delegate.onTextFieldInsertText(this, '\n', 1)) ||
					this.detachWithIME());
		},
		getContentText: function () {
			return this._inputText;
		},
		keyboardWillShow: function (t) {},
		keyboardDidShow: function (t) {},
		keyboardWillHide: function (t) {},
		keyboardDidHide: function (t) {},
	}));
var _p = cc.TextFieldTTF.prototype;
_p.charCount,
	cc.defineGetterSetter(_p, 'charCount', _p.getCharCount),
	_p.placeHolder,
	cc.defineGetterSetter(
		_p,
		'placeHolder',
		_p.getPlaceHolder,
		_p.setPlaceHolder
	),
	(cc.TextFieldTTF.create = function (t, e, i, n, r) {
		return new cc.TextFieldTTF(t, e, i, n, r);
	}),
	(cc.TGA_OK = 0),
	(cc.TGA_ERROR_FILE_OPEN = 1),
	(cc.TGA_ERROR_READING_FILE = 2),
	(cc.TGA_ERROR_INDEXED_COLOR = 3),
	(cc.TGA_ERROR_MEMORY = 4),
	(cc.TGA_ERROR_COMPRESSED_FILE = 5),
	(cc.ImageTGA = function (t, e, i, n, r, o, s) {
		(this.status = t || 0),
			(this.type = e || 0),
			(this.pixelDepth = i || 0),
			(this.width = n || 0),
			(this.height = r || 0),
			(this.imageData = o || []),
			(this.flipped = s || 0);
	}),
	(cc.tgaLoadHeader = function (t, e, i) {
		if (e < 3) return !1;
		t = new cc.BinaryStreamReader(t);
		if ((t.setOffset(2), (i.type = t.readByte()), e < 17)) return !1;
		if (
			(t.setOffset(12),
			(i.width = t.readUnsignedShort()),
			(i.height = t.readUnsignedInteger()),
			(i.pixelDepth = t.readByte()),
			e < 18)
		)
			return !1;
		t = t.readByte();
		return (i.flipped = 0), 32 & t && (i.flipped = 1), !0;
	}),
	(cc.tgaLoadImageData = function (t, e, i) {
		var n,
			r,
			o = 0 | (i.pixelDepth / 2),
			s = i.height * i.width * o;
		if (e < 18 + s) return !1;
		if (((i.imageData = cc.__getSubArray(t, 18, 18 + s)), 3 <= o))
			for (n = 0; n < s; n += o)
				(r = i.imageData[n]),
					(i.imageData[n] = i.imageData[n + 2]),
					(i.imageData[n + 2] = r);
		return !0;
	}),
	(cc.tgaRGBtogreyscale = function (t) {
		var e, i;
		if (8 !== t.pixelDepth) {
			var n = t.pixelDepth / 8,
				r = new Uint8Array(t.height * t.width);
			if (null !== r) {
				for (i = e = 0; i < t.width * t.height; e += n, i++)
					r[i] =
						0.3 * t.imageData[e] +
						0.59 * t.imageData[e + 1] +
						0.11 * t.imageData[e + 2];
				(t.pixelDepth = 8), (t.type = 3), (t.imageData = r);
			}
		}
	}),
	(cc.tgaDestroy = function (t) {
		t && ((t.imageData = null), (t = null));
	}),
	(cc.tgaLoadRLEImageData = function (t, e, i) {
		for (
			var n = 0,
				r = 0,
				o = 0,
				s = [],
				c = 0,
				a = 18,
				l = i.pixelDepth / 8,
				h = i.height * i.width,
				u = 0;
			u < h;
			u++
		) {
			if (0 !== c) c--, (r = 0 !== o);
			else {
				if (e < a + 1) break;
				(c = t[a]), (a += 1), (o = 128 & c) && (c -= 128), (r = 0);
			}
			if (!r) {
				if (e < a + l) break;
				var _,
					s = cc.__getSubArray(t, a, a + l);
				(a += l), 3 <= l && ((_ = s[0]), (s[0] = s[2]), (s[2] = _));
			}
			for (var d = 0; d < l; d++) i.imageData[n + d] = s[d];
			n += l;
		}
		return !0;
	}),
	(cc.tgaFlipImage = function (t) {
		for (
			var e = t.pixelDepth / 8, i = t.width * e, n = 0;
			n < t.height / 2;
			n++
		) {
			var r = cc.__getSubArray(t.imageData, n * i, n * i + i);
			cc.__setDataToArray(
				cc.__getSubArray(t.imageData, (t.height - (n + 1)) * i, i),
				t.imageData,
				n * i
			),
				cc.__setDataToArray(r, t.imageData, (t.height - (n + 1)) * i);
		}
		t.flipped = 0;
	}),
	(cc.__getSubArray = function (t, e, i) {
		return t instanceof Array ? t.slice(e, i) : t.subarray(e, i);
	}),
	(cc.__setDataToArray = function (t, e, i) {
		for (var n = 0; n < t.length; n++) e[i + n] = t[n];
	}),
	(cc.BinaryStreamReader = cc.Class.extend({
		_binaryData: null,
		_offset: 0,
		ctor: function (t) {
			this._binaryData = t;
		},
		setBinaryData: function (t) {
			(this._binaryData = t), (this._offset = 0);
		},
		getBinaryData: function () {
			return this._binaryData;
		},
		_checkSize: function (t) {
			if (!(this._offset + Math.ceil(t / 8) < this._data.length))
				throw new Error('Index out of bound');
		},
		_decodeFloat: function (t, e) {
			var i = t + e + 1,
				n = i >> 3;
			this._checkSize(i);
			var r = Math.pow(2, e - 1) - 1,
				i = this._readBits(t + e, 1, n),
				e = this._readBits(t, e, n),
				o = 0,
				s = 2,
				c = 0;
			do {
				for (
					var a = this._readByte(++c, n), l = t % 8 || 8, h = 1 << l;
					(h >>= 1);

				)
					a & h && (o += 1 / s), (s *= 2);
			} while ((t -= l));
			return (
				(this._offset += n),
				e === 1 + (r << 1)
					? o
						? NaN
						: i
						? -1 / 0
						: 1 / 0
					: (1 + -2 * i) *
					  (e || o
							? e
								? Math.pow(2, e - r) * (1 + o)
								: Math.pow(2, 1 - r) * o
							: 0)
			);
		},
		_readByte: function (t, e) {
			return this._data[this._offset + e - t - 1];
		},
		_decodeInt: function (t, e) {
			var i = this._readBits(0, t, t / 8),
				n = Math.pow(2, t),
				i = e && n / 2 <= i ? i - n : i;
			return (this._offset += t / 8), i;
		},
		_shl: function (t, e) {
			for (
				++e;
				--e;
				t =
					1073741824 == (1073741824 & (t %= 2147483648))
						? 2 * t
						: 2 * (t - 1073741824) + 2147483647 + 1
			);
			return t;
		},
		_readBits: function (t, e, i) {
			var n = (t + e) % 8,
				r = t % 8,
				o = i - (t >> 3) - 1,
				s = i + (-(t + e) >> 3),
				c = o - s,
				a = (this._readByte(o, i) >> r) & ((1 << (c ? 8 - r : e)) - 1);
			for (
				c &&
				n &&
				(a +=
					(this._readByte(s++, i) & ((1 << n) - 1)) <<
					((c-- << 3) - r));
				c;

			)
				a += this._shl(this._readByte(s++, i), (c-- << 3) - r);
			return a;
		},
		readInteger: function () {
			return this._decodeInt(32, !0);
		},
		readUnsignedInteger: function () {
			return this._decodeInt(32, !1);
		},
		readSingle: function () {
			return this._decodeFloat(23, 8);
		},
		readShort: function () {
			return this._decodeInt(16, !0);
		},
		readUnsignedShort: function () {
			return this._decodeInt(16, !1);
		},
		readByte: function () {
			var t = this._data[this._offset];
			return (this._offset += 1), t;
		},
		readData: function (t, e) {
			return this._binaryData instanceof Array
				? this._binaryData.slice(t, e)
				: this._binaryData.subarray(t, e);
		},
		setOffset: function (t) {
			this._offset = t;
		},
		getOffset: function () {
			return this._offset;
		},
	})),
	(cc.TMX_ORIENTATION_ORTHO = 0),
	(cc.TMX_ORIENTATION_HEX = 1),
	(cc.TMX_ORIENTATION_ISO = 2),
	(cc.TMXTiledMap = cc.Node.extend({
		properties: null,
		mapOrientation: null,
		objectGroups: null,
		_mapSize: null,
		_tileSize: null,
		_tileProperties: null,
		_className: 'TMXTiledMap',
		ctor: function (t, e) {
			cc.Node.prototype.ctor.call(this),
				(this._mapSize = cc.size(0, 0)),
				(this._tileSize = cc.size(0, 0)),
				void 0 !== e
					? this.initWithXML(t, e)
					: void 0 !== t && this.initWithTMXFile(t);
		},
		getMapSize: function () {
			return cc.size(this._mapSize.width, this._mapSize.height);
		},
		setMapSize: function (t) {
			(this._mapSize.width = t.width), (this._mapSize.height = t.height);
		},
		_getMapWidth: function () {
			return this._mapSize.width;
		},
		_setMapWidth: function (t) {
			this._mapSize.width = t;
		},
		_getMapHeight: function () {
			return this._mapSize.height;
		},
		_setMapHeight: function (t) {
			this._mapSize.height = t;
		},
		getTileSize: function () {
			return cc.size(this._tileSize.width, this._tileSize.height);
		},
		setTileSize: function (t) {
			(this._tileSize.width = t.width),
				(this._tileSize.height = t.height);
		},
		_getTileWidth: function () {
			return this._tileSize.width;
		},
		_setTileWidth: function (t) {
			this._tileSize.width = t;
		},
		_getTileHeight: function () {
			return this._tileSize.height;
		},
		_setTileHeight: function (t) {
			this._tileSize.height = t;
		},
		getMapOrientation: function () {
			return this.mapOrientation;
		},
		setMapOrientation: function (t) {
			this.mapOrientation = t;
		},
		getObjectGroups: function () {
			return this.objectGroups;
		},
		setObjectGroups: function (t) {
			this.objectGroups = t;
		},
		getProperties: function () {
			return this.properties;
		},
		setProperties: function (t) {
			this.properties = t;
		},
		initWithTMXFile: function (t) {
			if (!t || 0 === t.length)
				throw new Error(
					'cc.TMXTiledMap.initWithTMXFile(): tmxFile should be non-null or non-empty string.'
				);
			(this.width = 0), (this.height = 0);
			var e = new cc.TMXMapInfo(t);
			if (!e) return !1;
			t = e.getTilesets();
			return (
				(t && 0 !== t.length) ||
					cc.log(
						'cc.TMXTiledMap.initWithTMXFile(): Map not found. Please check the filename.'
					),
				this._buildWithMapInfo(e),
				!0
			);
		},
		initWithXML: function (t, e) {
			(this.width = 0), (this.height = 0);
			(t = new cc.TMXMapInfo(t, e)), (e = t.getTilesets());
			return (
				(e && 0 !== e.length) ||
					cc.log(
						'cc.TMXTiledMap.initWithXML(): Map not found. Please check the filename.'
					),
				this._buildWithMapInfo(t),
				!0
			);
		},
		_buildWithMapInfo: function (t) {
			(this._mapSize = t.getMapSize()),
				(this._tileSize = t.getTileSize()),
				(this.mapOrientation = t.orientation),
				(this.objectGroups = t.getObjectGroups()),
				(this.properties = t.properties),
				(this._tileProperties = t.getTileProperties());
			var e = 0,
				i = t.getLayers();
			if (i)
				for (var n, r = null, o = 0, s = i.length; o < s; o++)
					(r = i[o]) &&
						r.visible &&
						((n = this._parseLayer(r, t)),
						this.addChild(n, e, e),
						(this.width = Math.max(this.width, n.width)),
						(this.height = Math.max(this.height, n.height)),
						e++);
		},
		allLayers: function () {
			for (
				var t = [], e = this._children, i = 0, n = e.length;
				i < n;
				i++
			) {
				var r = e[i];
				r && r instanceof cc.TMXLayer && t.push(r);
			}
			return t;
		},
		getLayer: function (t) {
			if (!t || 0 === t.length)
				throw new Error(
					'cc.TMXTiledMap.getLayer(): layerName should be non-null or non-empty string.'
				);
			for (var e = this._children, i = 0; i < e.length; i++) {
				var n = e[i];
				if (n && n.layerName === t) return n;
			}
			return null;
		},
		getObjectGroup: function (t) {
			if (!t || 0 === t.length)
				throw new Error(
					'cc.TMXTiledMap.getObjectGroup(): groupName should be non-null or non-empty string.'
				);
			if (this.objectGroups)
				for (var e = 0; e < this.objectGroups.length; e++) {
					var i = this.objectGroups[e];
					if (i && i.groupName === t) return i;
				}
			return null;
		},
		getProperty: function (t) {
			return this.properties[t.toString()];
		},
		propertiesForGID: function (t) {
			return (
				cc.log(
					'propertiesForGID is deprecated. Please use getPropertiesForGID instead.'
				),
				this.getPropertiesForGID[t]
			);
		},
		getPropertiesForGID: function (t) {
			return this._tileProperties[t];
		},
		_parseLayer: function (t, e) {
			var i = this._tilesetForLayer(t, e),
				e = new cc.TMXLayer(i, t, e);
			return (t.ownTiles = !1), e;
		},
		_tilesetForLayer: function (t, e) {
			var i = t._layerSize,
				n = e.getTilesets();
			if (n)
				for (var r = n.length - 1; 0 <= r; r--) {
					var o = n[r];
					if (o)
						for (var s = 0; s < i.height; s++)
							for (var c = 0; c < i.width; c++) {
								var a = c + i.width * s,
									a = t._tiles[a];
								if (
									0 !== a &&
									(a & cc.TMX_TILE_FLIPPED_MASK) >>> 0 >=
										o.firstGid
								)
									return o;
							}
				}
			return (
				cc.log(
					'cocos2d: Warning: TMX Layer ' + t.name + ' has no tiles'
				),
				null
			);
		},
	}));
var _p = cc.TMXTiledMap.prototype;
_p.mapWidth,
	cc.defineGetterSetter(_p, 'mapWidth', _p._getMapWidth, _p._setMapWidth),
	_p.mapHeight,
	cc.defineGetterSetter(_p, 'mapHeight', _p._getMapHeight, _p._setMapHeight),
	_p.tileWidth,
	cc.defineGetterSetter(_p, 'tileWidth', _p._getTileWidth, _p._setTileWidth),
	_p.tileHeight,
	cc.defineGetterSetter(
		_p,
		'tileHeight',
		_p._getTileHeight,
		_p._setTileHeight
	),
	(cc.TMXTiledMap.create = function (t, e) {
		return new cc.TMXTiledMap(t, e);
	}),
	(cc.TMX_PROPERTY_NONE = 0),
	(cc.TMX_PROPERTY_MAP = 1),
	(cc.TMX_PROPERTY_LAYER = 2),
	(cc.TMX_PROPERTY_OBJECTGROUP = 3),
	(cc.TMX_PROPERTY_OBJECT = 4),
	(cc.TMX_PROPERTY_TILE = 5),
	(cc.TMX_TILE_HORIZONTAL_FLAG = 2147483648),
	(cc.TMX_TILE_VERTICAL_FLAG = 1073741824),
	(cc.TMX_TILE_DIAGONAL_FLAG = 536870912),
	(cc.TMX_TILE_FLIPPED_ALL =
		(cc.TMX_TILE_HORIZONTAL_FLAG |
			cc.TMX_TILE_VERTICAL_FLAG |
			cc.TMX_TILE_DIAGONAL_FLAG) >>>
		0),
	(cc.TMX_TILE_FLIPPED_MASK = ~cc.TMX_TILE_FLIPPED_ALL >>> 0),
	(cc.TMXLayerInfo = cc.Class.extend({
		properties: null,
		name: '',
		_layerSize: null,
		_tiles: null,
		visible: null,
		_opacity: null,
		ownTiles: !0,
		_minGID: 1e5,
		_maxGID: 0,
		offset: null,
		ctor: function () {
			(this.properties = []),
				(this.name = ''),
				(this._layerSize = null),
				(this._tiles = null),
				(this.visible = !0),
				(this._opacity = 0),
				(this.ownTiles = !0),
				(this._minGID = 1e5),
				(this._maxGID = 0),
				(this.offset = cc.p(0, 0));
		},
		getProperties: function () {
			return this.properties;
		},
		setProperties: function (t) {
			this.properties = t;
		},
	})),
	(cc.TMXTilesetInfo = cc.Class.extend({
		name: '',
		firstGid: 0,
		_tileSize: null,
		spacing: 0,
		margin: 0,
		sourceImage: '',
		imageSize: null,
		ctor: function () {
			(this._tileSize = cc.size(0, 0)), (this.imageSize = cc.size(0, 0));
		},
		rectForGID: function (t, e) {
			var i = e || cc.rect(0, 0, 0, 0);
			(i.width = this._tileSize.width),
				(i.height = this._tileSize.height),
				(t &= cc.TMX_TILE_FLIPPED_MASK),
				(t -= parseInt(this.firstGid, 10));
			e = parseInt(
				(this.imageSize.width - 2 * this.margin + this.spacing) /
					(this._tileSize.width + this.spacing),
				10
			);
			return (
				(i.x = parseInt(
					(t % e) * (this._tileSize.width + this.spacing) +
						this.margin,
					10
				)),
				(i.y = parseInt(
					parseInt(t / e, 10) *
						(this._tileSize.height + this.spacing) +
						this.margin,
					10
				)),
				i
			);
		},
	})),
	(cc.TMXMapInfo = cc.SAXParser.extend({
		properties: null,
		orientation: null,
		parentElement: null,
		parentGID: null,
		layerAttrs: 0,
		storingCharacters: !1,
		tmxFileName: null,
		currentString: null,
		_objectGroups: null,
		_mapSize: null,
		_tileSize: null,
		_layers: null,
		_tilesets: null,
		_tileProperties: null,
		_resources: '',
		_currentFirstGID: 0,
		ctor: function (t, e) {
			cc.SAXParser.prototype.ctor.apply(this),
				(this._mapSize = cc.size(0, 0)),
				(this._tileSize = cc.size(0, 0)),
				(this._layers = []),
				(this._tilesets = []),
				(this._objectGroups = []),
				(this.properties = []),
				(this._tileProperties = {}),
				void (this._currentFirstGID = 0) !== e
					? this.initWithXML(t, e)
					: void 0 !== t && this.initWithTMXFile(t);
		},
		getOrientation: function () {
			return this.orientation;
		},
		setOrientation: function (t) {
			this.orientation = t;
		},
		getMapSize: function () {
			return cc.size(this._mapSize.width, this._mapSize.height);
		},
		setMapSize: function (t) {
			(this._mapSize.width = t.width), (this._mapSize.height = t.height);
		},
		_getMapWidth: function () {
			return this._mapSize.width;
		},
		_setMapWidth: function (t) {
			this._mapSize.width = t;
		},
		_getMapHeight: function () {
			return this._mapSize.height;
		},
		_setMapHeight: function (t) {
			this._mapSize.height = t;
		},
		getTileSize: function () {
			return cc.size(this._tileSize.width, this._tileSize.height);
		},
		setTileSize: function (t) {
			(this._tileSize.width = t.width),
				(this._tileSize.height = t.height);
		},
		_getTileWidth: function () {
			return this._tileSize.width;
		},
		_setTileWidth: function (t) {
			this._tileSize.width = t;
		},
		_getTileHeight: function () {
			return this._tileSize.height;
		},
		_setTileHeight: function (t) {
			this._tileSize.height = t;
		},
		getLayers: function () {
			return this._layers;
		},
		setLayers: function (t) {
			this._layers.push(t);
		},
		getTilesets: function () {
			return this._tilesets;
		},
		setTilesets: function (t) {
			this._tilesets.push(t);
		},
		getObjectGroups: function () {
			return this._objectGroups;
		},
		setObjectGroups: function (t) {
			this._objectGroups.push(t);
		},
		getParentElement: function () {
			return this.parentElement;
		},
		setParentElement: function (t) {
			this.parentElement = t;
		},
		getParentGID: function () {
			return this.parentGID;
		},
		setParentGID: function (t) {
			this.parentGID = t;
		},
		getLayerAttribs: function () {
			return this.layerAttrs;
		},
		setLayerAttribs: function (t) {
			this.layerAttrs = t;
		},
		getStoringCharacters: function () {
			return this.storingCharacters;
		},
		setStoringCharacters: function (t) {
			this.storingCharacters = t;
		},
		getProperties: function () {
			return this.properties;
		},
		setProperties: function (t) {
			this.properties = t;
		},
		initWithTMXFile: function (t) {
			return this._internalInit(t, null), this.parseXMLFile(t);
		},
		initWithXML: function (t, e) {
			return this._internalInit(null, e), this.parseXMLString(t);
		},
		parseXMLFile: function (t, e) {
			var i = (e = e || !1) ? t : cc.loader.getRes(t);
			if (!i) throw new Error('Please load the resource first : ' + t);
			var n = this._parseXML(i).documentElement,
				r = n.getAttribute('version'),
				i = n.getAttribute('orientation');
			if ('map' === n.nodeName) {
				'1.0' !== r &&
					null !== r &&
					cc.log('cocos2d: TMXFormat: Unsupported TMX version:' + r),
					'orthogonal' === i
						? (this.orientation = cc.TMX_ORIENTATION_ORTHO)
						: 'isometric' === i
						? (this.orientation = cc.TMX_ORIENTATION_ISO)
						: 'hexagonal' === i
						? (this.orientation = cc.TMX_ORIENTATION_HEX)
						: null !== i &&
						  cc.log(
								'cocos2d: TMXFomat: Unsupported orientation:' +
									i
						  );
				i = cc.size(0, 0);
				(i.width = parseFloat(n.getAttribute('width'))),
					(i.height = parseFloat(n.getAttribute('height'))),
					this.setMapSize(i),
					((i = cc.size(0, 0)).width = parseFloat(
						n.getAttribute('tilewidth')
					)),
					(i.height = parseFloat(n.getAttribute('tileheight'))),
					this.setTileSize(i);
				var o = n.querySelectorAll('map > properties >  property');
				if (o) {
					for (var s = {}, c = 0; c < o.length; c++)
						s[o[c].getAttribute('name')] =
							o[c].getAttribute('value');
					this.properties = s;
				}
			}
			var a = n.getElementsByTagName('tileset');
			for (
				'map' !== n.nodeName && (a = []).push(n), c = 0;
				c < a.length;
				c++
			) {
				var l = a[c],
					h = l.getAttribute('source');
				if (h) {
					var u = e
						? cc.path.join(this._resources, h)
						: cc.path.changeBasename(t, h);
					this.parseXMLFile(u);
				} else {
					var _ = new cc.TMXTilesetInfo();
					(_.name = l.getAttribute('name') || ''),
						(_.firstGid =
							parseInt(l.getAttribute('firstgid')) || 0),
						(_.spacing = parseInt(l.getAttribute('spacing')) || 0),
						(_.margin = parseInt(l.getAttribute('margin')) || 0);
					h = cc.size(0, 0);
					(h.width = parseFloat(l.getAttribute('tilewidth'))),
						(h.height = parseFloat(l.getAttribute('tileheight'))),
						(_._tileSize = h);
					(u = l
						.getElementsByTagName('image')[0]
						.getAttribute('source')),
						(h = -1);
					if (
						(this.tmxFileName &&
							(h = this.tmxFileName.lastIndexOf('/')),
						-1 !== h
							? ((h = this.tmxFileName.substr(0, h + 1)),
							  (_.sourceImage = h + u))
							: (_.sourceImage =
									this._resources +
									(this._resources ? '/' : '') +
									u),
						this.setTilesets(_),
						(E = l.getElementsByTagName('tile')))
					)
						for (var d = 0; d < E.length; d++) {
							var p = E[d];
							this.parentGID =
								parseInt(_.firstGid) +
								parseInt(p.getAttribute('id') || 0);
							var f = p.querySelectorAll('properties > property');
							if (f) {
								for (var m = {}, g = 0; g < f.length; g++)
									m[f[g].getAttribute('name')] =
										f[g].getAttribute('value');
								this._tileProperties[this.parentGID] = m;
							}
						}
				}
			}
			var y = n.getElementsByTagName('layer');
			if (y)
				for (c = 0; c < y.length; c++) {
					var T = y[c],
						S = T.getElementsByTagName('data')[0],
						C = new cc.TMXLayerInfo();
					C.name = T.getAttribute('name');
					var x = cc.size(0, 0);
					(x.width = parseFloat(T.getAttribute('width'))),
						(x.height = parseFloat(T.getAttribute('height'))),
						(C._layerSize = x);
					x = T.getAttribute('visible');
					C.visible = !('0' == x);
					x = T.getAttribute('opacity') || 1;
					(C._opacity = x ? parseInt(255 * parseFloat(x)) : 255),
						(C.offset = cc.p(
							parseFloat(T.getAttribute('x')) || 0,
							parseFloat(T.getAttribute('y')) || 0
						));
					var v = '';
					for (g = 0; g < S.childNodes.length; g++)
						v += S.childNodes[g].nodeValue;
					v = v.trim();
					var E,
						x = S.getAttribute('compression'),
						A = S.getAttribute('encoding');
					if (x && 'gzip' !== x && 'zlib' !== x)
						return (
							cc.log(
								'cc.TMXMapInfo.parseXMLFile(): unsupported compression method'
							),
							null
						);
					switch (x) {
						case 'gzip':
							E = cc.unzipBase64AsArray(v, 4);
							break;
						case 'zlib':
							var b = new Zlib.Inflate(
								cc.Codec.Base64.decodeAsArray(v, 1)
							);
							E = cc.uint8ArrayToUint32Array(b.decompress());
							break;
						case null:
						case '':
							if ('base64' === A)
								E = cc.Codec.Base64.decodeAsArray(v, 4);
							else if ('csv' === A) {
								E = [];
								for (
									var R = v.split(','), P = 0;
									P < R.length;
									P++
								)
									E.push(parseInt(R[P]));
							} else {
								var I = S.getElementsByTagName('tile');
								E = [];
								for (var w = 0; w < I.length; w++)
									E.push(parseInt(I[w].getAttribute('gid')));
							}
							break;
						default:
							this.layerAttrs === cc.TMXLayerInfo.ATTRIB_NONE &&
								cc.log(
									'cc.TMXMapInfo.parseXMLFile(): Only base64 and/or gzip/zlib maps are supported'
								);
					}
					E && (C._tiles = new Uint32Array(E));
					var D = T.querySelectorAll('properties > property');
					if (D) {
						var L = {};
						for (g = 0; g < D.length; g++)
							L[D[g].getAttribute('name')] =
								D[g].getAttribute('value');
						C.properties = L;
					}
					this.setLayers(C);
				}
			var O = n.getElementsByTagName('objectgroup');
			if (O)
				for (c = 0; c < O.length; c++) {
					var B = O[c],
						N = new cc.TMXObjectGroup();
					(N.groupName = B.getAttribute('name')),
						N.setPositionOffset(
							cc.p(
								parseFloat(B.getAttribute('x')) *
									this.getTileSize().width || 0,
								parseFloat(B.getAttribute('y')) *
									this.getTileSize().height || 0
							)
						);
					var F = B.querySelectorAll(
						'objectgroup > properties > property'
					);
					if (F)
						for (g = 0; g < F.length; g++) {
							var M = {};
							(M[F[g].getAttribute('name')] =
								F[g].getAttribute('value')),
								(N.properties = M);
						}
					var V = B.querySelectorAll('object'),
						k = cc.director.getContentScaleFactor();
					if (V)
						for (g = 0; g < V.length; g++) {
							var G = V[g],
								W = {};
							(W.name = G.getAttribute('name') || ''),
								(W.type = G.getAttribute('type') || ''),
								(W.width =
									parseInt(G.getAttribute('width')) || 0),
								(W.height =
									parseInt(G.getAttribute('height')) || 0),
								(W.x =
									((0 | (G.getAttribute('x') || 0)) +
										N.getPositionOffset().x) /
									k);
							var z =
								(0 | (G.getAttribute('y') || 0)) +
								N.getPositionOffset().y / k;
							(W.y =
								(parseInt(
									this.getMapSize().height *
										this.getTileSize().height
								) -
									z -
									W.height) /
								cc.director.getContentScaleFactor()),
								(W.rotation =
									parseInt(G.getAttribute('rotation')) || 0);
							var U = G.querySelectorAll('properties > property');
							if (U)
								for (var Y = 0; Y < U.length; Y++)
									W[U[Y].getAttribute('name')] =
										U[Y].getAttribute('value');
							z = G.querySelectorAll('polygon');
							z &&
								0 < z.length &&
								(z = z[0].getAttribute('points')) &&
								(W.points = this._parsePointsString(z));
							G = G.querySelectorAll('polyline');
							G &&
								0 < G.length &&
								(G = G[0].getAttribute('points')) &&
								(W.polylinePoints = this._parsePointsString(G)),
								N.setObjects(W);
						}
					this.setObjectGroups(N);
				}
			return n;
		},
		_parsePointsString: function (t) {
			if (!t) return null;
			for (var e = [], i = t.split(' '), n = 0; n < i.length; n++) {
				var r = i[n].split(',');
				e.push({ x: r[0], y: r[1] });
			}
			return e;
		},
		parseXMLString: function (t) {
			return this.parseXMLFile(t, !0);
		},
		getTileProperties: function () {
			return this._tileProperties;
		},
		setTileProperties: function (t) {
			this._tileProperties.push(t);
		},
		getCurrentString: function () {
			return this.currentString;
		},
		setCurrentString: function (t) {
			this.currentString = t;
		},
		getTMXFileName: function () {
			return this.tmxFileName;
		},
		setTMXFileName: function (t) {
			this.tmxFileName = t;
		},
		_internalInit: function (t, e) {
			(this._tilesets.length = 0),
				(this._layers.length = 0),
				(this.tmxFileName = t),
				e && (this._resources = e),
				(this._objectGroups.length = 0),
				(this.properties.length = 0),
				(this._tileProperties.length = 0),
				(this.currentString = ''),
				(this.storingCharacters = !1),
				(this.layerAttrs = cc.TMXLayerInfo.ATTRIB_NONE),
				(this.parentElement = cc.TMX_PROPERTY_NONE),
				(this._currentFirstGID = 0);
		},
	}));
var _p = cc.TMXMapInfo.prototype;
_p.mapWidth,
	cc.defineGetterSetter(_p, 'mapWidth', _p._getMapWidth, _p._setMapWidth),
	_p.mapHeight,
	cc.defineGetterSetter(_p, 'mapHeight', _p._getMapHeight, _p._setMapHeight),
	_p.tileWidth,
	cc.defineGetterSetter(_p, 'tileWidth', _p._getTileWidth, _p._setTileWidth),
	_p.tileHeight,
	cc.defineGetterSetter(
		_p,
		'tileHeight',
		_p._getTileHeight,
		_p._setTileHeight
	),
	(cc.TMXMapInfo.create = function (t, e) {
		return new cc.TMXMapInfo(t, e);
	}),
	cc.loader.register(['tmx', 'tsx'], cc._txtLoader),
	(cc.TMXLayerInfo.ATTRIB_NONE = 1),
	(cc.TMXLayerInfo.ATTRIB_BASE64 = 2),
	(cc.TMXLayerInfo.ATTRIB_GZIP = 4),
	(cc.TMXLayerInfo.ATTRIB_ZLIB = 8),
	(cc.TMXObjectGroup = cc.Class.extend({
		properties: null,
		groupName: '',
		_positionOffset: null,
		_objects: null,
		ctor: function () {
			(this.groupName = ''),
				(this._positionOffset = cc.p(0, 0)),
				(this.properties = []),
				(this._objects = []);
		},
		getPositionOffset: function () {
			return cc.p(this._positionOffset);
		},
		setPositionOffset: function (t) {
			(this._positionOffset.x = t.x), (this._positionOffset.y = t.y);
		},
		getProperties: function () {
			return this.properties;
		},
		setProperties: function (t) {
			this.properties.push(t);
		},
		getGroupName: function () {
			return this.groupName.toString();
		},
		setGroupName: function (t) {
			this.groupName = t;
		},
		propertyNamed: function (t) {
			return this.properties[t];
		},
		objectNamed: function (t) {
			return this.getObject(t);
		},
		getObject: function (t) {
			if (this._objects && 0 < this._objects.length)
				for (var e = this._objects, i = 0, n = e.length; i < n; i++) {
					var r = e[i].name;
					if (r && r === t) return e[i];
				}
			return null;
		},
		getObjects: function () {
			return this._objects;
		},
		setObjects: function (t) {
			this._objects.push(t);
		},
	})),
	(cc.TMXLayer = cc.SpriteBatchNode.extend({
		tiles: null,
		tileset: null,
		layerOrientation: null,
		properties: null,
		layerName: '',
		_textures: null,
		_texGrids: null,
		_spriteTiles: null,
		_layerSize: null,
		_mapTileSize: null,
		_opacity: 255,
		_minGID: null,
		_maxGID: null,
		_vertexZvalue: null,
		_useAutomaticVertexZ: null,
		_reusedTile: null,
		_atlasIndexArray: null,
		_contentScaleFactor: null,
		_className: 'TMXLayer',
		ctor: function (t, e, i) {
			cc.SpriteBatchNode.prototype.ctor.call(this),
				(this._descendants = []),
				(this._layerSize = cc.size(0, 0)),
				(this._mapTileSize = cc.size(0, 0)),
				(this._spriteTiles = {}),
				void 0 !== i && this.initWithTilesetInfo(t, e, i);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.TMXLayer.CanvasRenderCmd
					: cc.TMXLayer.WebGLRenderCmd
			)(this);
		},
		_fillTextureGrids: function (t, e) {
			var i = this._textures[e];
			if (i.isLoaded()) {
				(t.imageSize.width && t.imageSize.height) ||
					((t.imageSize.width = i.width),
					(t.imageSize.height = i.height));
				for (
					var n = t._tileSize.width,
						r = t._tileSize.height,
						o = i._contentSize.width,
						s = i._contentSize.height,
						c = t.spacing,
						a = t.margin,
						l = Math.floor((o - 2 * a + c) / (n + c)),
						l = Math.floor((s - 2 * a + c) / (r + c)) * l,
						h = t.firstGid,
						u = t.firstGid + l,
						_ = this._texGrids,
						d = null,
						p = !!_[h];
					h < u && (p && !_[h] && (p = !1), p || !_[h]);
					++h
				)
					(d = {
						texId: e,
						x: 0,
						y: 0,
						width: n,
						height: r,
						t: 0,
						l: 0,
						r: 0,
						b: 0,
					}),
						t.rectForGID(h, d),
						(d.t = d.y / s),
						(d.l = d.x / o),
						(d.r = (d.x + d.width) / o),
						(d.b = (d.y + d.height) / s),
						(_[h] = d);
			} else
				i.addEventListener(
					'load',
					function () {
						this._fillTextureGrids(t, e);
					},
					this
				);
		},
		initWithTilesetInfo: function (t, e, i) {
			var n = e._layerSize;
			parseInt(n.width * n.height);
			(this.layerName = e.name),
				(this.tiles = e._tiles),
				(this.properties = e.properties),
				(this._layerSize = n),
				(this._minGID = e._minGID),
				(this._maxGID = e._maxGID),
				(this._opacity = e._opacity),
				(this.tileset = t),
				(this.layerOrientation = i.orientation),
				(this._mapTileSize = i.getTileSize());
			var r = i._tilesets;
			if (r) {
				(this._textures = []), (this._texGrids = []);
				for (var o, s, c = r.length, a = 0; a < c; ++a)
					(o = r[a]),
						(s = cc.textureCache.addImage(o.sourceImage)),
						this._textures.push(s),
						this._fillTextureGrids(o, a),
						o === t && (this._texture = s);
			}
			e = this._calculateLayerOffset(e.offset);
			return (
				this.setPosition(cc.pointPixelsToPoints(e)),
				this._parseInternalProperties(),
				this.setContentSize(
					cc.sizePixelsToPoints(
						cc.size(
							this._layerSize.width * this._mapTileSize.width,
							this._layerSize.height * this._mapTileSize.height
						)
					)
				),
				(this._useAutomaticVertexZ = !1),
				!(this._vertexZvalue = 0)
			);
		},
		getLayerSize: function () {
			return cc.size(this._layerSize.width, this._layerSize.height);
		},
		setLayerSize: function (t) {
			(this._layerSize.width = t.width),
				(this._layerSize.height = t.height);
		},
		_getLayerWidth: function () {
			return this._layerSize.width;
		},
		_setLayerWidth: function (t) {
			this._layerSize.width = t;
		},
		_getLayerHeight: function () {
			return this._layerSize.height;
		},
		_setLayerHeight: function (t) {
			this._layerSize.height = t;
		},
		getMapTileSize: function () {
			return cc.size(this._mapTileSize.width, this._mapTileSize.height);
		},
		setMapTileSize: function (t) {
			(this._mapTileSize.width = t.width),
				(this._mapTileSize.height = t.height);
		},
		_getTileWidth: function () {
			return this._mapTileSize.width;
		},
		_setTileWidth: function (t) {
			this._mapTileSize.width = t;
		},
		_getTileHeight: function () {
			return this._mapTileSize.height;
		},
		_setTileHeight: function (t) {
			this._mapTileSize.height = t;
		},
		getTiles: function () {
			return this.tiles;
		},
		setTiles: function (t) {
			this.tiles = t;
		},
		getTileset: function () {
			return this.tileset;
		},
		setTileset: function (t) {
			this.tileset = t;
		},
		getLayerOrientation: function () {
			return this.layerOrientation;
		},
		setLayerOrientation: function (t) {
			this.layerOrientation = t;
		},
		getProperties: function () {
			return this.properties;
		},
		setProperties: function (t) {
			this.properties = t;
		},
		getProperty: function (t) {
			return this.properties[t];
		},
		getLayerName: function () {
			return this.layerName;
		},
		setLayerName: function (t) {
			this.layerName = t;
		},
		releaseMap: function () {
			this._spriteTiles = {};
		},
		getTileAt: function (t, e) {
			if (void 0 === t)
				throw new Error(
					'cc.TMXLayer.getTileAt(): pos should be non-null'
				);
			var i = t;
			if (
				(void 0 === e && ((i = t.x), (e = t.y)),
				i >= this._layerSize.width ||
					e >= this._layerSize.height ||
					i < 0 ||
					e < 0)
			)
				throw new Error('cc.TMXLayer.getTileAt(): invalid position');
			if (!this.tiles)
				return (
					cc.log(
						'cc.TMXLayer.getTileAt(): TMXLayer: the tiles map has been released'
					),
					null
				);
			var n = null,
				r = this.getTileGIDAt(i, e);
			if (0 === r) return n;
			var o = 0 | (i + e * this._layerSize.width);
			return (
				(n = this._spriteTiles[o]) ||
					((t = this._texGrids[r]),
					(r = this._textures[t.texId]),
					(t = cc.rectPixelsToPoints(t)),
					(n = new cc.Sprite(r, t)).setPosition(
						this.getPositionAt(i, e)
					),
					(e = this._vertexZForPos(i, e)),
					n.setVertexZ(e),
					n.setAnchorPoint(0, 0),
					n.setOpacity(this._opacity),
					this.addChild(n, e, o)),
				n
			);
		},
		getTileGIDAt: function (t, e) {
			if (void 0 === t)
				throw new Error(
					'cc.TMXLayer.getTileGIDAt(): pos should be non-null'
				);
			var i = t;
			if (
				(void 0 === e && ((i = t.x), (e = t.y)),
				i >= this._layerSize.width ||
					e >= this._layerSize.height ||
					i < 0 ||
					e < 0)
			)
				throw new Error('cc.TMXLayer.getTileGIDAt(): invalid position');
			if (!this.tiles)
				return (
					cc.log(
						'cc.TMXLayer.getTileGIDAt(): TMXLayer: the tiles map has been released'
					),
					null
				);
			e = 0 | (i + e * this._layerSize.width);
			return (this.tiles[e] & cc.TMX_TILE_FLIPPED_MASK) >>> 0;
		},
		setTileGID: function (t, e, i, n) {
			if (void 0 === e)
				throw new Error(
					'cc.TMXLayer.setTileGID(): pos should be non-null'
				);
			var r, o, s;
			if (
				(void 0 !== n ? (r = cc.p(e, i)) : ((r = e), (n = i)),
				r.x >= this._layerSize.width ||
					r.y >= this._layerSize.height ||
					r.x < 0 ||
					r.y < 0)
			)
				throw new Error('cc.TMXLayer.setTileGID(): invalid position');
			this.tiles
				? 0 !== t && t < this.tileset.firstGid
					? cc.log('cc.TMXLayer.setTileGID(): invalid gid:' + t)
					: ((n = n || 0),
					  (o = this.getTileFlagsAt(r)),
					  ((s = this.getTileGIDAt(r)) === t && o === n) ||
							((e = (t | n) >>> 0),
							0 === t
								? this.removeTileAt(r)
								: 0 === s
								? this._updateTileForGID(e, r)
								: ((i = r.x + r.y * this._layerSize.width),
								  (o = this.getChildByTag(i))
										? ((s = this._texGrids[t]),
										  (t = this._textures[s.texId]),
										  (s = cc.rectPixelsToPoints(s)),
										  o.setTexture(t),
										  o.setTextureRect(s, !1),
										  null != n &&
												this._setupTileSprite(o, r, e),
										  (this.tiles[i] = e))
										: this._updateTileForGID(e, r))))
				: cc.log(
						'cc.TMXLayer.setTileGID(): TMXLayer: the tiles map has been released'
				  );
		},
		addChild: function (t, e, i) {
			cc.Node.prototype.addChild.call(this, t, e, i),
				void 0 !== i &&
					((this._spriteTiles[i] = t)._vertexZ =
						this._vertexZ +
						(cc.renderer.assignedZStep * i) / this.tiles.length);
		},
		removeChild: function (t, e) {
			this._spriteTiles[t.tag] && (this._spriteTiles[t.tag] = null),
				cc.Node.prototype.removeChild.call(this, t, e);
		},
		getTileFlagsAt: function (t, e) {
			if (!t)
				throw new Error(
					'cc.TMXLayer.getTileFlagsAt(): pos should be non-null'
				);
			if (
				(void 0 !== e && (t = cc.p(t, e)),
				t.x >= this._layerSize.width ||
					t.y >= this._layerSize.height ||
					t.x < 0 ||
					t.y < 0)
			)
				throw new Error(
					'cc.TMXLayer.getTileFlagsAt(): invalid position'
				);
			if (!this.tiles)
				return (
					cc.log(
						'cc.TMXLayer.getTileFlagsAt(): TMXLayer: the tiles map has been released'
					),
					null
				);
			t = 0 | (t.x + t.y * this._layerSize.width);
			return (this.tiles[t] & cc.TMX_TILE_FLIPPED_ALL) >>> 0;
		},
		removeTileAt: function (t, e) {
			if (!t)
				throw new Error(
					'cc.TMXLayer.removeTileAt(): pos should be non-null'
				);
			if (
				(void 0 !== e && (t = cc.p(t, e)),
				t.x >= this._layerSize.width ||
					t.y >= this._layerSize.height ||
					t.x < 0 ||
					t.y < 0)
			)
				throw new Error('cc.TMXLayer.removeTileAt(): invalid position');
			this.tiles
				? 0 !== this.getTileGIDAt(t) &&
				  ((t = 0 | (t.x + t.y * this._layerSize.width)),
				  (this.tiles[t] = 0),
				  (t = this._spriteTiles[t]) && this.removeChild(t, !0))
				: cc.log(
						'cc.TMXLayer.removeTileAt(): TMXLayer: the tiles map has been released'
				  );
		},
		getPositionAt: function (t, e) {
			void 0 !== e && (t = cc.p(t, e));
			var i = cc.p(0, 0);
			switch (this.layerOrientation) {
				case cc.TMX_ORIENTATION_ORTHO:
					i = this._positionForOrthoAt(t);
					break;
				case cc.TMX_ORIENTATION_ISO:
					i = this._positionForIsoAt(t);
					break;
				case cc.TMX_ORIENTATION_HEX:
					i = this._positionForHexAt(t);
			}
			return cc.pointPixelsToPoints(i);
		},
		_positionForIsoAt: function (t) {
			return cc.p(
				(this._mapTileSize.width / 2) *
					(this._layerSize.width + t.x - t.y - 1),
				(this._mapTileSize.height / 2) *
					(2 * this._layerSize.height - t.x - t.y - 2)
			);
		},
		_positionForOrthoAt: function (t) {
			return cc.p(
				t.x * this._mapTileSize.width,
				(this._layerSize.height - t.y - 1) * this._mapTileSize.height
			);
		},
		_positionForHexAt: function (t) {
			var e = t.x % 2 == 1 ? -this._mapTileSize.height / 2 : 0;
			return cc.p(
				(t.x * this._mapTileSize.width * 3) / 4,
				(this._layerSize.height - t.y - 1) * this._mapTileSize.height +
					e
			);
		},
		_calculateLayerOffset: function (t) {
			var e = cc.p(0, 0);
			switch (this.layerOrientation) {
				case cc.TMX_ORIENTATION_ORTHO:
					e = cc.p(
						t.x * this._mapTileSize.width,
						-t.y * this._mapTileSize.height
					);
					break;
				case cc.TMX_ORIENTATION_ISO:
					e = cc.p(
						(this._mapTileSize.width / 2) * (t.x - t.y),
						(this._mapTileSize.height / 2) * (-t.x - t.y)
					);
					break;
				case cc.TMX_ORIENTATION_HEX:
					(0 === t.x && 0 === t.y) ||
						cc.log('offset for hexagonal map not implemented yet');
			}
			return e;
		},
		_updateTileForGID: function (t, e) {
			!this._texGrids[t] ||
				((e = 0 | (e.x + e.y * this._layerSize.width)) <
					this.tiles.length &&
					(this.tiles[e] = t));
		},
		_parseInternalProperties: function () {
			var t,
				e,
				i = this.getProperty('cc_vertexz');
			i &&
				('automatic' === i
					? ((this._useAutomaticVertexZ = !0),
					  (e = 0),
					  (t = this.getProperty('cc_alpha_func')) &&
							(e = parseFloat(t)),
					  cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
							((this.shaderProgram = cc.shaderCache.programForKey(
								cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST
							)),
							this.shaderProgram.use(),
							this.shaderProgram.setUniformLocationWith1f(
								cc.UNIFORM_ALPHA_TEST_VALUE_S,
								e
							)))
					: (this._vertexZvalue = parseInt(i, 10)));
		},
		_setupTileSprite: function (t, e, i) {
			e.x, e.y, this._layerSize.width;
			var n = this.getPositionAt(e);
			t.setPosition(n),
				t.setVertexZ(this._vertexZForPos(e)),
				t.setAnchorPoint(0, 0),
				t.setOpacity(this._opacity),
				t.setFlippedX(!1),
				t.setFlippedY(!1),
				t.setRotation(0),
				(i & cc.TMX_TILE_DIAGONAL_FLAG) >>> 0
					? (t.setAnchorPoint(0.5, 0.5),
					  t.setPosition(n.x + t.width / 2, n.y + t.height / 2),
					  (n =
							(i &
								((cc.TMX_TILE_HORIZONTAL_FLAG |
									cc.TMX_TILE_VERTICAL_FLAG) >>>
									0)) >>>
							0) === cc.TMX_TILE_HORIZONTAL_FLAG
							? t.setRotation(90)
							: n === cc.TMX_TILE_VERTICAL_FLAG
							? t.setRotation(270)
							: (n ==
							  (cc.TMX_TILE_VERTICAL_FLAG |
									cc.TMX_TILE_HORIZONTAL_FLAG) >>>
									0
									? t.setRotation(90)
									: t.setRotation(270),
							  t.setFlippedX(!0)))
					: ((i & cc.TMX_TILE_HORIZONTAL_FLAG) >>> 0 &&
							t.setFlippedX(!0),
					  (i & cc.TMX_TILE_VERTICAL_FLAG) >>> 0 &&
							t.setFlippedY(!0));
		},
		_vertexZForPos: function (t, e) {
			void 0 === e && ((e = t.y), (t = t.x));
			var i = 0;
			if (this._useAutomaticVertexZ)
				switch (this.layerOrientation) {
					case cc.TMX_ORIENTATION_ISO:
						i = -(
							this._layerSize.width +
							this._layerSize.height -
							(t + e)
						);
						break;
					case cc.TMX_ORIENTATION_ORTHO:
						i = -(this._layerSize.height - e);
						break;
					case cc.TMX_ORIENTATION_HEX:
						cc.log('TMX Hexa zOrder not supported');
						break;
					default:
						cc.log('TMX invalid value');
				}
			else i = this._vertexZvalue;
			return i;
		},
	}));
var _p = cc.TMXLayer.prototype;
_p.layerWidth,
	cc.defineGetterSetter(
		_p,
		'layerWidth',
		_p._getLayerWidth,
		_p._setLayerWidth
	),
	_p.layerHeight,
	cc.defineGetterSetter(
		_p,
		'layerHeight',
		_p._getLayerHeight,
		_p._setLayerHeight
	),
	_p.tileWidth,
	cc.defineGetterSetter(_p, 'tileWidth', _p._getTileWidth, _p._setTileWidth),
	_p.tileHeight,
	cc.defineGetterSetter(
		_p,
		'tileHeight',
		_p._getTileHeight,
		_p._setTileHeight
	),
	(cc.TMXLayer.create = function (t, e, i) {
		return new cc.TMXLayer(t, e, i);
	}),
	(function () {
		cc.TMXLayer.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t), (this._needDraw = !0);
		};
		var t = (cc.TMXLayer.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.TMXLayer.CanvasRenderCmd),
			(t.visit = function (t) {
				var e = this._node,
					i = cc.renderer;
				if (
					((t = t || this.getParentRenderCmd()) &&
						(this._curLevel = t._curLevel + 1),
					e._visible)
				) {
					isNaN(e._customZ) &&
						((e._vertexZ = i.assignedZ),
						(i.assignedZ += i.assignedZStep)),
						this._syncStatus(t);
					var n,
						r,
						o = e._children,
						s = e._spriteTiles,
						c = o.length;
					if (0 < c) {
						for (
							e.sortAllChildren(), r = 0;
							r < c && (n = o[r])._localZOrder < 0;
							r++
						)
							n._renderCmd.visit(this);
						for (i.pushRenderCommand(this); r < c; r++)
							0 === (n = o[r])._localZOrder && s[n.tag]
								? (isNaN(n._customZ) &&
										((n._vertexZ = i.assignedZ),
										(i.assignedZ += i.assignedZStep)),
								  n._renderCmd.updateStatus())
								: n._renderCmd.visit(this);
					} else i.pushRenderCommand(this);
					this._dirtyFlag = 0;
				}
			}),
			(t.rendering = function (t, e, i) {
				var n = this._node,
					r = n._rotationX || n._rotationY,
					o = n.layerOrientation,
					s = n.tiles,
					c = n._opacity / 255;
				if (s && !(c <= 0)) {
					var a = n._mapTileSize.width,
						l = n._mapTileSize.height,
						h =
							n.tileset._tileSize.width /
							cc.director._contentScaleFactor,
						u =
							n.tileset._tileSize.height /
							cc.director._contentScaleFactor,
						_ = h - a,
						d = u - l,
						p = cc.winSize.width,
						f = cc.winSize.height,
						m = n._layerSize.height,
						g = n._layerSize.width,
						y = n._texGrids,
						T = n._spriteTiles,
						S = this._worldTransform,
						C = -n._contentSize.width * n._anchorPoint.x,
						x = -n._contentSize.height * n._anchorPoint.y,
						v = S.a,
						E = S.b,
						s = S.c,
						A = S.d,
						b = C * v + x * s + S.tx,
						R = C * E + x * A + S.ty,
						P = t || cc._renderContext,
						I = P.getContext(),
						w = 0,
						x = 0,
						D = g,
						L = m;
					r ||
						o !== cc.TMX_ORIENTATION_ORTHO ||
						((w = Math.floor(-(b - _ * v) / (a * v))) < 0 &&
							(w = 0),
						(x = Math.floor(
							(R - d * A + l * m * A - f) / (l * A)
						)) < 0 && (x = 0),
						g < (D = Math.ceil((p - b + _ * v) / (a * v))) &&
							(D = g),
						m < (L = m - Math.floor(-(R + d * A) / (l * A))) &&
							(L = m));
					var O,
						B,
						N,
						F,
						M,
						V,
						k,
						G,
						W,
						z,
						U,
						Y,
						X = x * g,
						H = cc.TMX_TILE_FLIPPED_MASK,
						j = h,
						q = u,
						J = h * v,
						Z = u * A,
						K = !1,
						Q = !1,
						$ = X + w;
					for (O in T)
						if (O < $ && T[O])
							(k = T[O]._renderCmd),
								0 === T[O]._localZOrder &&
									k.rendering &&
									k.rendering(t, e, i);
						else if ($ <= O) break;
					for (
						P.setTransform(S, e, i), P.setGlobalAlpha(c), B = x;
						B < L;
						++B
					) {
						for (N = w; N < D; ++N)
							if (T[($ = X + N)])
								(k = T[$]._renderCmd),
									0 === T[$]._localZOrder &&
										k.rendering &&
										(k.rendering(t, e, i),
										P.setTransform(S, e, i),
										P.setGlobalAlpha(c));
							else if (
								((F = n.tiles[$]),
								(M = y[(F & H) >>> 0]),
								M &&
									(V = n._textures[M.texId]) &&
									V._htmlElementObj)
							) {
								switch (o) {
									case cc.TMX_ORIENTATION_ORTHO:
										(W = N * a), (z = -(m - B - 1) * l);
										break;
									case cc.TMX_ORIENTATION_ISO:
										(W = (a / 2) * (g + N - B - 1)),
											(z =
												(-l / 2) * (2 * m - N - B - 2));
										break;
									case cc.TMX_ORIENTATION_HEX:
										(W = (N * a * 3) / 4),
											(z =
												-(m - B - 1) * l +
												(N % 2 == 1 ? -l / 2 : 0));
								}
								if (
									((U = W + h),
									(G = z - u),
									!r && o === cc.TMX_ORIENTATION_ISO)
								) {
									if ((Y = z * A - R) < -f - Z) {
										N += Math.floor((2 * (-f - Y)) / Z) - 1;
										continue;
									}
									if ((Y = b + U * v) < -J) {
										N += Math.floor((2 * -Y) / J) - 1;
										continue;
									}
									if (p < b + W * v || 0 < G * A - R) {
										N = D;
										continue;
									}
								}
								F > cc.TMX_TILE_DIAGONAL_FLAG &&
									((K =
										(F & cc.TMX_TILE_HORIZONTAL_FLAG) >>>
										0),
									(Q =
										(F & cc.TMX_TILE_VERTICAL_FLAG) >>> 0)),
									K && ((W = -U), I.scale(-1, 1)),
									Q && ((G = -z), I.scale(1, -1)),
									I.drawImage(
										V._htmlElementObj,
										M.x,
										M.y,
										M.width,
										M.height,
										W,
										G,
										j,
										q
									),
									K && I.scale(-1, 1),
									Q && I.scale(1, -1),
									cc.g_NumberOfDraws++;
							}
						X += g;
					}
					for (O in T)
						$ < O &&
							T[O] &&
							((k = T[O]._renderCmd),
							0 === T[O]._localZOrder &&
								k.rendering &&
								k.rendering(t, e, i));
				}
			});
	})(),
	(function () {
		cc.TMXLayer.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._vertices = [
					{ x: 0, y: 0 },
					{ x: 0, y: 0 },
					{ x: 0, y: 0 },
					{ x: 0, y: 0 },
				]),
				(this._color = new Uint32Array(1)),
				(this._shaderProgram = cc.shaderCache.programForKey(
					cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST
				));
			t = (90 * Math.PI) / 180;
			(this._sin90 = Math.sin(t)),
				(this._cos90 = Math.cos(t)),
				(t *= 3),
				(this._sin270 = Math.sin(t)),
				(this._cos270 = Math.cos(t));
		};
		var t = (cc.TMXLayer.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.TMXLayer.WebGLRenderCmd),
			(t.uploadData = function (t, e, i) {
				var n = this._node,
					r = n._rotationX || n._rotationY,
					o = n.layerOrientation,
					s = n.tiles;
				if (!s) return 0;
				cc.view._scaleX, cc.view._scaleY;
				var c = n._mapTileSize.width,
					a = n._mapTileSize.height,
					l =
						n.tileset._tileSize.width /
						cc.director._contentScaleFactor,
					h =
						n.tileset._tileSize.height /
						cc.director._contentScaleFactor,
					u = l - c,
					_ = h - a,
					d = cc.winSize.width,
					p = cc.winSize.height,
					f = n._layerSize.height,
					m = n._layerSize.width,
					g = n._texGrids,
					y = n._spriteTiles,
					T = this._worldTransform,
					S = T.a,
					C = T.b,
					x = T.c,
					v = T.d,
					E = T.tx,
					A = T.ty,
					b = -n._contentSize.width * n._anchorPoint.x,
					R = -n._contentSize.height * n._anchorPoint.y,
					P = b * S + R * x + E,
					I = b * C + R * v + A,
					w = n._opacity,
					D = this._displayedColor.r,
					T = this._displayedColor.g,
					b = this._displayedColor.b;
				n._opacityModifyRGB && ((D *= R = w / 255), (T *= R), (b *= R)),
					(this._color[0] = (w << 24) | (b << 16) | (T << 8) | D);
				var L = 0,
					D = 0,
					O = m,
					B = f;
				r ||
					o !== cc.TMX_ORIENTATION_ORTHO ||
					((L = Math.floor(-(P - u * S) / (c * S))) < 0 && (L = 0),
					(D = Math.floor((I - _ * v + a * f * v - p) / (a * v))) <
						0 && (D = 0),
					m < (O = Math.ceil((d - P + u * S) / (c * S))) && (O = m),
					f < (B = f - Math.floor(-(I + _ * v) / (a * v))) &&
						(B = f));
				for (
					var N,
						F,
						M,
						V,
						k,
						G,
						W,
						z,
						U,
						Y,
						X = i,
						H = D * m,
						j = cc.TMX_TILE_FLIPPED_MASK,
						q = l * S,
						J = h * v,
						Z = S,
						K = C,
						Q = x,
						$ = v,
						tt = E,
						et = A,
						it = !1,
						nt = !1,
						rt = !1,
						ot = this._vertices,
						st = D;
					st < B;
					++st
				) {
					for (N = L; N < O; ++N)
						if (
							(X + 24 > t.length &&
								(cc.renderer._increaseBatchingSize((X - i) / 6),
								cc.renderer._batchRendering(),
								(X = i = 0)),
							(F = H + N),
							!y[F] && (V = g[((M = n.tiles[F]) & j) >>> 0]))
						) {
							switch (o) {
								case cc.TMX_ORIENTATION_ORTHO:
									(W = N * c),
										(z = (f - st - 1) * a),
										(F =
											n._vertexZ +
											(cc.renderer.assignedZStep * F) /
												s.length);
									break;
								case cc.TMX_ORIENTATION_ISO:
									(W = (c / 2) * (m + N - st - 1)),
										(z = (a / 2) * (2 * f - N - st - 2)),
										(F =
											n._vertexZ +
											(cc.renderer.assignedZStep *
												(n.height - z)) /
												n.height);
									break;
								case cc.TMX_ORIENTATION_HEX:
									(W = (N * c * 3) / 4),
										(z =
											(f - st - 1) * a +
											(N % 2 == 1 ? -a / 2 : 0)),
										(F =
											n._vertexZ +
											(cc.renderer.assignedZStep *
												(n.height - z)) /
												n.height);
							}
							if (
								((U = W + l),
								(G = z + h),
								!r && o === cc.TMX_ORIENTATION_ISO)
							) {
								if (p + J < (Y = I + z * v)) {
									N += Math.floor((2 * (Y - p)) / J) - 1;
									continue;
								}
								if ((Y = P + U * S) < -q) {
									N += Math.floor((2 * -Y) / q) - 1;
									continue;
								}
								if (d < P + W * S || I + G * v < 0) {
									N = O;
									continue;
								}
							}
							for (
								M > cc.TMX_TILE_DIAGONAL_FLAG &&
									((it = !0),
									(nt =
										(M & cc.TMX_TILE_HORIZONTAL_FLAG) >>>
										0),
									(rt =
										(M & cc.TMX_TILE_VERTICAL_FLAG) >>> 0)),
									ot[0].x = W * Z + G * Q + tt,
									ot[0].y = W * K + G * $ + et,
									ot[1].x = W * Z + z * Q + tt,
									ot[1].y = W * K + z * $ + et,
									ot[2].x = U * Z + G * Q + tt,
									ot[2].y = U * K + G * $ + et,
									ot[3].x = U * Z + z * Q + tt,
									ot[3].y = U * K + z * $ + et,
									k = 0;
								k < 4;
								++k
							) {
								switch (
									((t[X] = ot[k].x),
									(t[X + 1] = ot[k].y),
									(t[X + 2] = F),
									(e[X + 3] = this._color[0]),
									k)
								) {
									case 0:
										(t[X + 4] = nt ? V.r : V.l),
											(t[X + 5] = rt ? V.b : V.t);
										break;
									case 1:
										(t[X + 4] = nt ? V.r : V.l),
											(t[X + 5] = rt ? V.t : V.b);
										break;
									case 2:
										(t[X + 4] = nt ? V.l : V.r),
											(t[X + 5] = rt ? V.b : V.t);
										break;
									case 3:
										(t[X + 4] = nt ? V.l : V.r),
											(t[X + 5] = rt ? V.t : V.b);
								}
								X += 6;
							}
							it &&
								((Z = S),
								(K = C),
								(Q = x),
								($ = v),
								(tt = E),
								(et = A),
								(it = rt = nt = !1));
						}
					H += m;
				}
				return (X - i) / 6;
			});
	})(),
	(cc.PointObject = cc.Class.extend({
		_ratio: null,
		_offset: null,
		_child: null,
		ctor: function (t, e) {
			this.initWithCCPoint(t, e);
		},
		getRatio: function () {
			return this._ratio;
		},
		setRatio: function (t) {
			this._ratio = t;
		},
		getOffset: function () {
			return this._offset;
		},
		setOffset: function (t) {
			this._offset = t;
		},
		getChild: function () {
			return this._child;
		},
		setChild: function (t) {
			this._child = t;
		},
		initWithCCPoint: function (t, e) {
			return (this._ratio = t), (this._offset = e), !(this._child = null);
		},
	})),
	(cc.PointObject.create = function (t, e) {
		return new cc.PointObject(t, e);
	}),
	(cc.ParallaxNode = cc.Node.extend({
		parallaxArray: null,
		_lastPosition: null,
		_className: 'ParallaxNode',
		getParallaxArray: function () {
			return this.parallaxArray;
		},
		setParallaxArray: function (t) {
			this.parallaxArray = t;
		},
		ctor: function () {
			cc.Node.prototype.ctor.call(this),
				(this.parallaxArray = []),
				(this._lastPosition = cc.p(-100, -100));
		},
		addChild: function (t, e, i, n) {
			if (3 !== arguments.length) {
				if (!t)
					throw new Error(
						'cc.ParallaxNode.addChild(): child should be non-null'
					);
				var r = new cc.PointObject(i, n);
				r.setChild(t),
					this.parallaxArray.push(r),
					t.setPosition(
						this._position.x * i.x + n.x,
						this._position.y * i.y + n.y
					),
					cc.Node.prototype.addChild.call(this, t, e, t.tag);
			} else
				cc.log(
					'ParallaxNode: use addChild(child, z, ratio, offset) instead'
				);
		},
		removeChild: function (t, e) {
			for (var i = this.parallaxArray, n = 0; n < i.length; n++)
				if (i[n].getChild() === t) {
					i.splice(n, 1);
					break;
				}
			cc.Node.prototype.removeChild.call(this, t, e);
		},
		removeAllChildren: function (t) {
			(this.parallaxArray.length = 0),
				cc.Node.prototype.removeAllChildren.call(this, t);
		},
		_updateParallaxPosition: function () {
			var t = this._absolutePosition();
			if (!cc.pointEqualToPoint(t, this._lastPosition)) {
				for (
					var e = this.parallaxArray, i = 0, n = e.length;
					i < n;
					i++
				) {
					var r = e[i];
					r.getChild().setPosition(
						-t.x + t.x * r.getRatio().x + r.getOffset().x,
						-t.y + t.y * r.getRatio().y + r.getOffset().y
					);
				}
				this._lastPosition = t;
			}
		},
		_absolutePosition: function () {
			for (var t = this._position, e = this; null !== e.parent; )
				(e = e.parent), (t = cc.pAdd(t, e.getPosition()));
			return t;
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.ParallaxNode.CanvasRenderCmd
					: cc.ParallaxNode.WebGLRenderCmd
			)(this);
		},
	})),
	(cc.ParallaxNode.create = function () {
		return new cc.ParallaxNode();
	}),
	(function () {
		cc.ParallaxNode.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t), (this._needDraw = !1);
		};
		var t = (cc.ParallaxNode.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.ParallaxNode.CanvasRenderCmd),
			(t.updateStatus = function () {
				this._node._updateParallaxPosition(),
					cc.Node.CanvasRenderCmd.prototype.updateStatus.call(this);
			}),
			(t._syncStatus = function (t) {
				this._node._updateParallaxPosition(),
					cc.Node.CanvasRenderCmd.prototype._syncStatus.call(this, t);
			});
	})(),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		var t;
		cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
			((cc.ParallaxNode.WebGLRenderCmd = function (t) {
				cc.Node.WebGLRenderCmd.call(this, t), (this._needDraw = !1);
			}),
			((t = cc.ParallaxNode.WebGLRenderCmd.prototype =
				Object.create(cc.Node.WebGLRenderCmd.prototype)).constructor =
				cc.ParallaxNode.WebGLRenderCmd),
			(t.updateStatus = function () {
				this._node._updateParallaxPosition(),
					cc.Node.WebGLRenderCmd.prototype.updateStatus.call(this);
			}),
			(t._syncStatus = function (t) {
				this._node._updateParallaxPosition(),
					cc.Node.WebGLRenderCmd.prototype._syncStatus.call(this, t);
			}));
	}),
	(cc.CONTROL_EVENT_TOTAL_NUMBER = 9),
	(cc.CONTROL_EVENT_TOUCH_DOWN = 1),
	(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE = 2),
	(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE = 4),
	(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER = 8),
	(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT = 16),
	(cc.CONTROL_EVENT_TOUCH_UP_INSIDE = 32),
	(cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE = 64),
	(cc.CONTROL_EVENT_TOUCH_CANCEL = 128),
	(cc.CONTROL_EVENT_VALUECHANGED = 256),
	(cc.CONTROL_STATE_NORMAL = 1),
	(cc.CONTROL_STATE_HIGHLIGHTED = 2),
	(cc.CONTROL_STATE_DISABLED = 4),
	(cc.CONTROL_STATE_SELECTED = 8),
	(cc.CONTROL_STATE_INITIAL = 8),
	(cc.Control = cc.Layer.extend({
		_isOpacityModifyRGB: !1,
		_hasVisibleParents: !1,
		_touchListener: null,
		_className: 'Control',
		isOpacityModifyRGB: function () {
			return this._isOpacityModifyRGB;
		},
		setOpacityModifyRGB: function (t) {
			this._isOpacityModifyRGB = t;
			for (var e = this.getChildren(), i = 0, n = e.length; i < n; i++) {
				var r = e[i];
				r && r.setOpacityModifyRGB(t);
			}
		},
		_state: cc.CONTROL_STATE_NORMAL,
		getState: function () {
			return this._state;
		},
		_enabled: !1,
		_selected: !1,
		_highlighted: !1,
		_dispatchTable: null,
		setEnabled: function (t) {
			(this._enabled = t),
				(this._state = t
					? cc.CONTROL_STATE_NORMAL
					: cc.CONTROL_STATE_DISABLED),
				this.needsLayout();
		},
		isEnabled: function () {
			return this._enabled;
		},
		setSelected: function (t) {
			(this._selected = t), this.needsLayout();
		},
		isSelected: function () {
			return this._selected;
		},
		setHighlighted: function (t) {
			(this._highlighted = t), this.needsLayout();
		},
		isHighlighted: function () {
			return this._highlighted;
		},
		hasVisibleParents: function () {
			for (var t = this.getParent(); null != t; t = t.getParent())
				if (!t.isVisible()) return !1;
			return !0;
		},
		ctor: function () {
			cc.Layer.prototype.ctor.call(this),
				(this._dispatchTable = {}),
				(this._color = cc.color.WHITE);
		},
		init: function () {
			if (cc.Layer.prototype.init.call(this)) {
				(this._state = cc.CONTROL_STATE_NORMAL),
					(this._enabled = !0),
					(this._selected = !1),
					(this._highlighted = !1);
				var t = cc.EventListener.create({
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
				});
				return (
					this.onTouchBegan &&
						(t.onTouchBegan = this.onTouchBegan.bind(this)),
					this.onTouchMoved &&
						(t.onTouchMoved = this.onTouchMoved.bind(this)),
					this.onTouchEnded &&
						(t.onTouchEnded = this.onTouchEnded.bind(this)),
					this.onTouchCancelled &&
						(t.onTouchCancelled = this.onTouchCancelled.bind(this)),
					(this._touchListener = t),
					!0
				);
			}
			return !1;
		},
		onEnter: function () {
			var t = this._touchListener;
			t._isRegistered() || cc.eventManager.addListener(t, this),
				cc.Node.prototype.onEnter.call(this);
		},
		sendActionsForControlEvents: function (t) {
			for (var e = 0, i = cc.CONTROL_EVENT_TOTAL_NUMBER; e < i; e++)
				if (t & (1 << e))
					for (
						var n = this._dispatchListforControlEvent(1 << e),
							r = 0,
							o = n.length;
						r < o;
						r++
					)
						n[r].invoke(this);
		},
		addTargetWithActionForControlEvents: function (t, e, i) {
			for (var n = 0, r = cc.CONTROL_EVENT_TOTAL_NUMBER; n < r; n++)
				i & (1 << n) &&
					this._addTargetWithActionForControlEvent(t, e, 1 << n);
		},
		removeTargetWithActionForControlEvents: function (t, e, i) {
			for (var n = 0, r = cc.CONTROL_EVENT_TOTAL_NUMBER; n < r; n++)
				i & (1 << n) &&
					this._removeTargetWithActionForControlEvent(t, e, 1 << n);
		},
		getTouchLocation: function (t) {
			t = t.getLocation();
			return this.convertToNodeSpace(t);
		},
		isTouchInside: function (t) {
			(t = t.getLocation()), (t = this.getParent().convertToNodeSpace(t));
			return cc.rectContainsPoint(this.getBoundingBox(), t);
		},
		_invocationWithTargetAndActionForControlEvent: function (t, e, i) {
			return null;
		},
		_dispatchListforControlEvent: function (t) {
			return (
				(t = t.toString()),
				this._dispatchTable[t] || (this._dispatchTable[t] = []),
				this._dispatchTable[t]
			);
		},
		_addTargetWithActionForControlEvent: function (t, e, i) {
			e = new cc.Invocation(t, e, i);
			this._dispatchListforControlEvent(i).push(e);
		},
		_removeTargetWithActionForControlEvent: function (t, e, i) {
			var n = this._dispatchListforControlEvent(i);
			if (t || e)
				for (var r = 0; r < n.length; ) {
					var o = n[r],
						s = !0;
					t && (s = t === o.getTarget()),
						e && (s = s && e === o.getAction()),
						s ? cc.arrayRemoveObject(n, o) : r++;
				}
			else n.length = 0;
		},
		needsLayout: function () {},
	}));
var _p = cc.Control.prototype;
_p.state,
	cc.defineGetterSetter(_p, 'state', _p.getState),
	_p.enabled,
	cc.defineGetterSetter(_p, 'enabled', _p.isEnabled, _p.setEnabled),
	_p.selected,
	cc.defineGetterSetter(_p, 'selected', _p.isSelected, _p.setSelected),
	_p.highlighted,
	cc.defineGetterSetter(
		_p,
		'highlighted',
		_p.isHighlighted,
		_p.setHighlighted
	),
	(_p = null),
	(cc.Control.create = function () {
		var t = new cc.Control();
		return t && t.init() ? t : null;
	}),
	(cc.CONTROL_ZOOM_ACTION_TAG = 3435855873),
	(cc.ControlButton = cc.Control.extend({
		_doesAdjustBackgroundImage: !1,
		zoomOnTouchDown: !1,
		_preferredSize: null,
		_labelAnchorPoint: null,
		_currentTitle: null,
		_currentTitleColor: null,
		_titleLabel: null,
		_backgroundSprite: null,
		_opacity: 0,
		_isPushed: !1,
		_titleDispatchTable: null,
		_titleColorDispatchTable: null,
		_titleLabelDispatchTable: null,
		_backgroundSpriteDispatchTable: null,
		_parentInited: !1,
		_marginV: 0,
		_marginH: 0,
		_className: 'ControlButton',
		ctor: function (t, e, i) {
			cc.Control.prototype.ctor.call(this),
				(this._preferredSize = cc.size(0, 0)),
				(this._labelAnchorPoint = cc.p(0, 0)),
				(this._currentTitle = ''),
				(this._currentTitleColor = cc.color.WHITE),
				(this._titleDispatchTable = {}),
				(this._titleColorDispatchTable = {}),
				(this._titleLabelDispatchTable = {}),
				(this._backgroundSpriteDispatchTable = {}),
				null != i
					? this.initWithTitleAndFontNameAndFontSize(t, e, i)
					: null != e
					? this.initWithLabelAndBackgroundSprite(t, e)
					: null != t
					? this.initWithBackgroundSprite(t)
					: this.init();
		},
		init: function () {
			return this.initWithLabelAndBackgroundSprite(
				new cc.LabelTTF('', 'Arial', 12),
				new cc.Scale9Sprite()
			);
		},
		needsLayout: function () {
			var t, e, i, n, r, o;
			this._parentInited &&
				(this._titleLabel && this._titleLabel.setVisible(!1),
				this._backgroundSprite && this._backgroundSprite.setVisible(!1),
				this.setLabelAnchorPoint(this._labelAnchorPoint),
				(n = this._state),
				(this._currentTitle = this.getTitleForState(n)),
				(this._currentTitleColor = this.getTitleColorForState(n)),
				(this._titleLabel = this.getTitleLabelForState(n)),
				(t = this._titleLabel) &&
					t.setString &&
					t.setString(this._currentTitle),
				t && t.setColor(this._currentTitleColor),
				(e = this.getContentSize()),
				t && t.setPosition(e.width / 2, e.height / 2),
				(this._backgroundSprite = this.getBackgroundSpriteForState(n)),
				(i = this._backgroundSprite) &&
					i.setPosition(e.width / 2, e.height / 2),
				(r = cc.size(0, 0)),
				t &&
					((n = t.getBoundingBox()),
					(r.width = n.width),
					(r.height = n.height)),
				this._doesAdjustBackgroundImage
					? i &&
					  i.setContentSize(
							r.width + 2 * this._marginH,
							r.height + 2 * this._marginV
					  )
					: i &&
					  ((o = i.getPreferredSize()),
					  (o = cc.size(o.width, o.height)).width <= 0 &&
							(o.width = r.width),
					  o.height <= 0 && (o.height = r.height),
					  i.setContentSize(o)),
				(r = t ? t.getBoundingBox() : cc.rect(0, 0, 0, 0)),
				(o = i ? i.getBoundingBox() : cc.rect(0, 0, 0, 0)),
				(o = cc.rectUnion(r, o)),
				this.setContentSize(o.width, o.height),
				(e = this.getContentSize()),
				t &&
					(t.setPosition(e.width / 2, e.height / 2),
					t.setVisible(!0)),
				i &&
					(i.setPosition(e.width / 2, e.height / 2),
					i.setVisible(!0)));
		},
		initWithLabelAndBackgroundSprite: function (t, e) {
			if (!t)
				throw new Error(
					'cc.ControlButton.initWithLabelAndBackgroundSprite(): label should be non-null'
				);
			if (!e)
				throw new Error(
					'cc.ControlButton.initWithLabelAndBackgroundSprite(): backgroundSprite should be non-null'
				);
			if (cc.Control.prototype.init.call(this, !0)) {
				(this._parentInited = !0),
					(this._titleDispatchTable = {}),
					(this._titleColorDispatchTable = {}),
					(this._titleLabelDispatchTable = {}),
					(this._backgroundSpriteDispatchTable = {}),
					(this._isPushed = !1),
					(this.zoomOnTouchDown = !0),
					(this._currentTitle = null),
					this.setAdjustBackgroundImage(!0),
					this.setPreferredSize(cc.size(0, 0)),
					(this.zoomOnTouchDown = !0),
					this.ignoreAnchorPointForPosition(!1),
					this.setAnchorPoint(0.5, 0.5),
					(this._titleLabel = t),
					(this._backgroundSprite = e),
					this.setOpacity(255),
					this.setOpacityModifyRGB(!0);
				var i = t.getString();
				return (
					this.setTitleForState(i, cc.CONTROL_STATE_NORMAL),
					this.setTitleColorForState(
						t.getColor(),
						cc.CONTROL_STATE_NORMAL
					),
					this.setTitleLabelForState(t, cc.CONTROL_STATE_NORMAL),
					this.setBackgroundSpriteForState(
						e,
						cc.CONTROL_STATE_NORMAL
					),
					(this._state = cc.CONTROL_STATE_NORMAL),
					(this._marginH = 24),
					(this._marginV = 12),
					(this._labelAnchorPoint = cc.p(0.5, 0.5)),
					this.setPreferredSize(cc.size(0, 0)),
					this.needsLayout(),
					!0
				);
			}
			return !1;
		},
		initWithTitleAndFontNameAndFontSize: function (t, e, i) {
			i = new cc.LabelTTF(t, e, i);
			return this.initWithLabelAndBackgroundSprite(
				i,
				new cc.Scale9Sprite()
			);
		},
		initWithBackgroundSprite: function (t) {
			var e = new cc.LabelTTF('', 'Arial', 30);
			return this.initWithLabelAndBackgroundSprite(e, t);
		},
		doesAdjustBackgroundImage: function () {
			return this._doesAdjustBackgroundImage;
		},
		setAdjustBackgroundImage: function (t) {
			(this._doesAdjustBackgroundImage = t), this.needsLayout();
		},
		getZoomOnTouchDown: function () {
			return this.zoomOnTouchDown;
		},
		setZoomOnTouchDown: function (t) {
			return (this.zoomOnTouchDown = t);
		},
		getPreferredSize: function () {
			return this._preferredSize;
		},
		setPreferredSize: function (t) {
			if (0 === t.width && 0 === t.height)
				this._doesAdjustBackgroundImage = !0;
			else {
				this._doesAdjustBackgroundImage = !1;
				var e,
					i = this._backgroundSpriteDispatchTable;
				for (e in i) i[e].setPreferredSize(t);
			}
			(this._preferredSize = t), this.needsLayout();
		},
		getLabelAnchorPoint: function () {
			return this._labelAnchorPoint;
		},
		setLabelAnchorPoint: function (t) {
			(this._labelAnchorPoint = t),
				this._titleLabel && this._titleLabel.setAnchorPoint(t);
		},
		_getCurrentTitle: function () {
			return this._currentTitle;
		},
		_getCurrentTitleColor: function () {
			return this._currentTitleColor;
		},
		getOpacity: function () {
			return this._opacity;
		},
		setOpacity: function (t) {
			cc.Control.prototype.setOpacity.call(this, t);
			var e,
				i = this._backgroundSpriteDispatchTable;
			for (e in i) i[e].setOpacity(t);
		},
		setColor: function (t) {
			cc.Control.prototype.setColor.call(this, t);
			var e,
				i = this._backgroundSpriteDispatchTable;
			for (e in i) i[e].setColor(t);
		},
		getColor: function () {
			var t = this._realColor;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		isPushed: function () {
			return this._isPushed;
		},
		_getVerticalMargin: function () {
			return this._marginV;
		},
		_getHorizontalOrigin: function () {
			return this._marginH;
		},
		setMargins: function (t, e) {
			(this._marginV = e), (this._marginH = t), this.needsLayout();
		},
		setEnabled: function (t) {
			cc.Control.prototype.setEnabled.call(this, t), this.needsLayout();
		},
		setSelected: function (t) {
			cc.Control.prototype.setSelected.call(this, t), this.needsLayout();
		},
		setHighlighted: function (t) {
			(this._state = t
				? cc.CONTROL_STATE_HIGHLIGHTED
				: cc.CONTROL_STATE_NORMAL),
				cc.Control.prototype.setHighlighted.call(this, t);
			t = this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG);
			t && this.stopAction(t),
				this.zoomOnTouchDown &&
					((t =
						this.isHighlighted() &&
						this.isEnabled() &&
						!this.isSelected()
							? 1.1
							: 1),
					(t = cc.scaleTo(0.05, t)).setTag(
						cc.CONTROL_ZOOM_ACTION_TAG
					),
					this.runAction(t));
		},
		onTouchBegan: function (t, e) {
			return (
				!!(
					this.isTouchInside(t) &&
					this.isEnabled() &&
					this.isVisible() &&
					this.hasVisibleParents()
				) &&
				((this._isPushed = !0),
				this.setHighlighted(!0),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),
				!0)
			);
		},
		onTouchMoved: function (t, e) {
			this._enabled && this._isPushed && !this._selected
				? (t = this.isTouchInside(t)) && !this._highlighted
					? (this.setHighlighted(!0),
					  this.sendActionsForControlEvents(
							cc.CONTROL_EVENT_TOUCH_DRAG_ENTER
					  ))
					: t && this._highlighted
					? this.sendActionsForControlEvents(
							cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE
					  )
					: !t && this._highlighted
					? (this.setHighlighted(!1),
					  this.sendActionsForControlEvents(
							cc.CONTROL_EVENT_TOUCH_DRAG_EXIT
					  ))
					: t ||
					  this._highlighted ||
					  this.sendActionsForControlEvents(
							cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE
					  )
				: this._highlighted && this.setHighlighted(!1);
		},
		onTouchEnded: function (t, e) {
			(this._isPushed = !1),
				this.setHighlighted(!1),
				this.isTouchInside(t)
					? this.sendActionsForControlEvents(
							cc.CONTROL_EVENT_TOUCH_UP_INSIDE
					  )
					: this.sendActionsForControlEvents(
							cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE
					  );
		},
		onTouchCancelled: function (t, e) {
			(this._isPushed = !1),
				this.setHighlighted(!1),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL);
		},
		getTitleForState: function (t) {
			var e = this._titleDispatchTable;
			return e ? e[t] || e[cc.CONTROL_STATE_NORMAL] : '';
		},
		setTitleForState: function (t, e) {
			(this._titleDispatchTable[e] = t || ''),
				this.getState() === e && this.needsLayout();
		},
		getTitleColorForState: function (t) {
			t = this._titleColorDispatchTable[t];
			return (
				(t =
					t ||
					this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL]) ||
				cc.color.WHITE
			);
		},
		setTitleColorForState: function (t, e) {
			(this._titleColorDispatchTable[e] = t),
				this.getState() === e && this.needsLayout();
		},
		getTitleLabelForState: function (t) {
			var e = this._titleLabelDispatchTable;
			return e[t] || e[cc.CONTROL_STATE_NORMAL];
		},
		setTitleLabelForState: function (t, e) {
			var i,
				n = this._titleLabelDispatchTable;
			!n[e] || ((i = n[e]) && this.removeChild(i, !0)),
				(n[e] = t).setVisible(!1),
				t.setAnchorPoint(0.5, 0.5),
				this.addChild(t, 1),
				this.getState() === e && this.needsLayout();
		},
		setTitleTTFForState: function (t, e) {
			var i = (i = this.getTitleForState(e)) || '';
			this.setTitleLabelForState(new cc.LabelTTF(i, t, 12), e);
		},
		getTitleTTFForState: function (t) {
			t = this.getTitleLabelForState(t);
			return null != t && t instanceof cc.LabelTTF ? t.getFontName() : '';
		},
		setTitleTTFSizeForState: function (t, e) {
			e = this.getTitleLabelForState(e);
			null != e && e instanceof cc.LabelTTF && e.setFontSize(t);
		},
		getTitleTTFSizeForState: function (t) {
			t = this.getTitleLabelForState(t);
			return null != t && t instanceof cc.LabelTTF ? t.getFontSize() : 0;
		},
		setTitleBMFontForState: function (t, e) {
			var i = (i = this.getTitleForState(e)) || '';
			this.setTitleLabelForState(new cc.LabelBMFont(i, t), e);
		},
		getTitleBMFontForState: function (t) {
			t = this.getTitleLabelForState(t);
			return null != t && t instanceof cc.LabelBMFont
				? t.getFntFile()
				: '';
		},
		getBackgroundSpriteForState: function (t) {
			var e = this._backgroundSpriteDispatchTable;
			return e[t] || e[cc.CONTROL_STATE_NORMAL];
		},
		setBackgroundSpriteForState: function (t, e) {
			var i,
				n = this._backgroundSpriteDispatchTable;
			!n[e] || ((i = n[e]) && this.removeChild(i, !0)),
				(n[e] = t).setVisible(!1),
				t.setAnchorPoint(0.5, 0.5),
				this.addChild(t);
			n = this._preferredSize;
			(0 === n.width && 0 === n.height) || t.setPreferredSize(n),
				this._state === e && this.needsLayout();
		},
		setBackgroundSpriteFrameForState: function (t, e) {
			t = cc.Scale9Sprite.createWithSpriteFrame(t);
			this.setBackgroundSpriteForState(t, e);
		},
	}));
var _p = cc.ControlButton.prototype;
_p.adjustBackground,
	cc.defineGetterSetter(
		_p,
		'adjustBackground',
		_p.getAdjustBackgroundImage,
		_p.setAdjustBackgroundImage
	),
	_p.preferredSize,
	cc.defineGetterSetter(
		_p,
		'preferredSize',
		_p.getPreferredSize,
		_p.setPreferredSize
	),
	_p.labelAnchor,
	cc.defineGetterSetter(
		_p,
		'labelAnchor',
		_p.getLabelAnchorPoint,
		_p.setLabelAnchorPoint
	),
	(_p = null),
	(cc.ControlButton.create = function (t, e, i) {
		return new cc.ControlButton(t, e, i);
	}),
	(cc.RGBA = function (t, e, i, n) {
		(this.r = t), (this.g = e), (this.b = i), (this.a = n);
	}),
	(cc.HSV = function (t, e, i) {
		(this.h = t), (this.s = e), (this.v = i);
	}),
	(cc.ControlUtils = {}),
	(cc.ControlUtils.addSpriteToTargetWithPosAndAnchor = function (t, e, i, n) {
		t = new cc.Sprite('#' + t);
		return t
			? (t.setPosition(i), t.setAnchorPoint(n), e.addChild(t), t)
			: null;
	}),
	(cc.ControlUtils.HSVfromRGB = function (t) {
		var e,
			i = new cc.HSV(),
			n = t.r < t.g ? t.r : t.g;
		return (
			(n = n < t.b ? n : t.b),
			(e = (e = t.r > t.g ? t.r : t.g) > t.b ? e : t.b),
			(n = (i.v = e) - n),
			0 < e
				? ((i.s = n / e),
				  t.r >= e
						? (i.h = (t.g - t.b) / n)
						: t.g >= e
						? (i.h = 2 + (t.b - t.r) / n)
						: (i.h = 4 + (t.r - t.g) / n),
				  (i.h *= 60),
				  i.h < 0 && (i.h += 360))
				: ((i.s = 0), (i.h = -1)),
			i
		);
	}),
	(cc.ControlUtils.RGBfromHSV = function (t) {
		var e,
			i,
			n,
			r,
			o,
			s = new cc.RGBA();
		if (((s.a = 1), t.s <= 0))
			return (
				t.h
					? ((s.r = 0), (s.g = 0), (s.b = 0))
					: ((s.r = t.v), (s.g = t.v), (s.b = t.v)),
				s
			);
		switch (
			(360 <= (r = t.h) && (r = 0),
			(r = (r /= 60) - (o = 0 | r)),
			(e = t.v * (1 - t.s)),
			(i = t.v * (1 - t.s * r)),
			(n = t.v * (1 - t.s * (1 - r))),
			o)
		) {
			case 0:
				(s.r = t.v), (s.g = n), (s.b = e);
				break;
			case 1:
				(s.r = i), (s.g = t.v), (s.b = e);
				break;
			case 2:
				(s.r = e), (s.g = t.v), (s.b = n);
				break;
			case 3:
				(s.r = e), (s.g = i), (s.b = t.v);
				break;
			case 4:
				(s.r = n), (s.g = e), (s.b = t.v);
				break;
			default:
				(s.r = t.v), (s.g = e), (s.b = i);
		}
		return s;
	}),
	(cc.ControlUtils.CCRectUnion = function (t, e) {
		return cc.rectUnion(t, e);
	}),
	(cc.Invocation = cc.Class.extend({
		_action: null,
		_target: null,
		_controlEvent: null,
		ctor: function (t, e, i) {
			(this._target = t), (this._action = e), (this._controlEvent = i);
		},
		getAction: function () {
			return this._action;
		},
		getTarget: function () {
			return this._target;
		},
		getControlEvent: function () {
			return this._controlEvent;
		},
		invoke: function (t) {
			this._target &&
				this._action &&
				(cc.isString(this._action)
					? this._target[this._action](t, this._controlEvent)
					: this._action.call(this._target, t, this._controlEvent));
		},
	})),
	(cc.Spacer = cc.Layer.extend({})),
	(cc.Spacer.verticalSpacer = function (t) {
		var e = new cc.Spacer();
		return e.init(), e.setContentSize(0, t), e;
	}),
	(cc.Spacer.horizontalSpacer = function (t) {
		var e = new cc.Spacer();
		return e.init(), e.setContentSize(t, 0), e;
	}),
	(cc.MenuPassive = cc.Layer.extend({
		_color: null,
		_opacity: 0,
		_className: 'MenuPassive',
		ctor: function () {},
		getColor: function () {
			var t = this._color;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		setColor: function (t) {
			var e = this._color;
			if (
				((e.r = t.r),
				(e.g = t.g),
				(e.b = t.b),
				this._children && 0 < this._children.length)
			)
				for (var i = 0; i < this._children.length; i++)
					this._children[i] && this._children[i].setColor(t);
			void 0 === t.a || t.a_undefined || this.setOpacity(t.a);
		},
		getOpacity: function () {
			return this._opacity;
		},
		setOpacity: function (t) {
			if (
				((this._opacity = t),
				this._children && 0 < this._children.length)
			)
				for (var e = 0; e < this._children.length; e++)
					this._children[e] && this._children[e].setOpacity(t);
			this._color.a = t;
		},
		initWithItems: function (t, e) {
			if (this.init()) {
				var i = cc.director.getWinSize();
				this.ignoreAnchorPointForPosition(!0),
					this.setAnchorPoint(0.5, 0.5),
					this.setContentSize(i),
					this.setPosition(i.width / 2, i.height / 2);
				var n = 0;
				if (t) {
					this.addChild(t, n);
					for (var r = 0; r < e.length; r++)
						e[r] && (n++, this.addChild(e[r], n));
				}
				return !0;
			}
			return !1;
		},
		alignItemsVertically: function () {
			this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING);
		},
		alignItemsVerticallyWithPadding: function (t) {
			var e,
				i = -t;
			if (this._children && 0 < this._children.length)
				for (e = 0; e < this._children.length; e++)
					this._children[e] &&
						(i +=
							this._children[e].getContentSize().height *
								this._children[e].getScaleY() +
							t);
			var n = 0,
				r = i / 2;
			if (this._children && 0 < this._children.length)
				for (e = 0; e < this._children.length; e++)
					this._children[e] &&
						((n = Math.max(
							n,
							this._children[e].getContentSize().width
						)),
						this._children[e].setPosition(
							0,
							r -
								(this._children[e].getContentSize().height *
									this._children[e].getScaleY()) /
									2
						),
						(r -=
							this._children[e].getContentSize().height *
								this._children[e].getScaleY() +
							t));
			this.setContentSize(n, i);
		},
		alignItemsHorizontally: function () {
			this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING);
		},
		alignItemsHorizontallyWithPadding: function (t) {
			var e,
				i = -t;
			if (this._children && 0 < this._children.length)
				for (e = 0; e < this._children.length; e++)
					this._children[e] &&
						(i +=
							this._children[e].getContentSize().width *
								this._children[e].getScaleX() +
							t);
			var n = 0,
				r = -i / 2;
			if (this._children && 0 < this._children.length)
				for (e = 0; e < this._children.length; e++)
					this._children[e] &&
						((n = Math.max(
							n,
							this._children[e].getContentSize().height
						)),
						this._children[e].setPosition(
							r +
								(this._children[e].getContentSize().width *
									this._children[e].getScaleX()) /
									2,
							0
						),
						(r +=
							this._children[e].getContentSize().width *
								this._children[e].getScaleX() +
							t));
			this.setContentSize(i, n);
		},
		alignItemsInColumns: function (t) {
			for (var e = [], i = 1; i < arguments.length; i++)
				e.push(arguments[i]);
			var n,
				r = -5,
				o = 0,
				s = 0,
				c = 0;
			if (this._children && 0 < this._children.length)
				for (i = 0; i < this._children.length; i++)
					this._children[i] &&
						(o >= e.length
							? cc.log(
									'cc.MenuPassive.alignItemsInColumns(): invalid row index'
							  )
							: (l = e[o])
							? ((s =
									0 |
									((n =
										this._children[i].getContentSize()
											.height) <= s || null == n
										? s
										: n)),
							  l <= ++c && ((r += s + 5), (s = c = 0), ++o))
							: cc.log(
									'cc.MenuPassive.alignItemsInColumns(): can not have zero columns on a row'
							  ));
			var a = cc.director.getWinSize(),
				o = 0,
				s = 0,
				l = 0,
				h = 0,
				u = 0,
				_ = r / 2;
			if (this._children && 0 < this._children.length)
				for (i = 0; i < this._children.length; i++)
					this._children[i] &&
						(0 === l && ((l = e[o]), (u = h = a.width / (1 + l))),
						(s =
							0 |
							((n = this._children[i].getContentSize().height) <=
								s || null == n
								? s
								: n)),
						this._children[i].setPosition(
							u - a.width / 2,
							_ - this._children[i].getContentSize().height / 2
						),
						(u += h),
						l <= ++c && ((_ -= s + 5), (s = l = c = 0), ++o));
		},
		alignItemsInRows: function (t) {
			for (var e = [], i = 1; i < arguments.length; i++)
				e.push(arguments[i]);
			var n,
				r = [],
				o = [],
				s = -10,
				c = -5,
				a = 0,
				l = 0,
				h = 0;
			if (this._children && 0 < this._children.length)
				for (i = 0; i < this._children.length; i++)
					this._children[i] &&
						(a >= e.length
							? cc.log(
									'cc.MenuPassive.alignItemsInRows(): invalid row index'
							  )
							: (_ = e[a])
							? ((l =
									0 |
									((n =
										this._children[i].getContentSize()
											.width) <= l || null == n
										? l
										: n)),
							  (c +=
									0 |
									(this._children[i].getContentSize().height +
										5)),
							  _ <= ++h &&
									(r.push(l),
									o.push(c),
									(s += l + 10),
									(l = h = 0),
									(c = -5),
									++a))
							: cc.log(
									"cc.MenuPassive.alignItemsInColumns(): can't have zero rows on a column"
							  ));
			var u = cc.director.getWinSize(),
				a = 0,
				l = 0,
				_ = null,
				d = -s / 2,
				p = 0;
			if (this._children && 0 < this._children.length)
				for (i = 0; i < this._children.length; i++)
					this._children[i] &&
						(null == _ && ((_ = e[a]), (p = o[a])),
						(l =
							0 |
							((n = this._children[i].getContentSize().width) <=
								l || null == n
								? l
								: n)),
						this._children[i].setPosition(
							d + r[a] / 2,
							p - u.height / 2
						),
						(p -= this._children[i].getContentSize().height + 10),
						_ <= ++h && ((d += l + 5), (l = _ = h = 0), ++a));
		},
		setOpacityModifyRGB: function (t) {},
		isOpacityModifyRGB: function () {
			return !1;
		},
	})),
	(cc.MenuPassive.create = function (t) {
		t = t || null;
		for (var e = [], i = 1; i < arguments.length; i++) e.push(arguments[i]);
		var n = new cc.MenuPassive();
		return n && n.initWithItems(t, e) ? n : null;
	}),
	(cc.MenuPassive.createWithItem = function (t) {
		return cc.MenuPassive.create(t, null);
	}),
	(cc.ControlSaturationBrightnessPicker = cc.Control.extend({
		_saturation: 0,
		_brightness: 0,
		_background: null,
		_overlay: null,
		_shadow: null,
		_slider: null,
		_startPos: null,
		_boxPos: 0,
		_boxSize: 0,
		_className: 'ControlSaturationBrightnessPicker',
		ctor: function (t, e) {
			cc.Control.prototype.ctor.call(this),
				e && this.initWithTargetAndPos(t, e);
		},
		getSaturation: function () {
			return this._saturation;
		},
		getBrightness: function () {
			return this._brightness;
		},
		getBackground: function () {
			return this._background;
		},
		getOverlay: function () {
			return this._brightness;
		},
		getShadow: function () {
			return this._shadow;
		},
		getSlider: function () {
			return this._slider;
		},
		getStartPos: function () {
			return this._startPos;
		},
		initWithTargetAndPos: function (t, e) {
			return (
				!!cc.Control.prototype.init.call(this) &&
				((this._background =
					cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(
						'colourPickerBackground.png',
						t,
						e,
						cc.p(0, 0)
					)),
				(this._overlay =
					cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(
						'colourPickerOverlay.png',
						t,
						e,
						cc.p(0, 0)
					)),
				(this._shadow =
					cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(
						'colourPickerShadow.png',
						t,
						e,
						cc.p(0, 0)
					)),
				(this._slider =
					cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(
						'colourPicker.png',
						t,
						e,
						cc.p(0.5, 0.5)
					)),
				(this._startPos = e),
				(this._boxPos = 35),
				(this._boxSize = this._background.getContentSize().width / 2),
				!0)
			);
		},
		setEnabled: function (t) {
			cc.Control.prototype.setEnabled.call(this, t),
				this._slider && this._slider.setOpacity(t ? 255 : 128);
		},
		updateWithHSV: function (t) {
			var e = new cc.HSV();
			(e.s = 1), (e.h = t.h), (e.v = 1);
			e = cc.ControlUtils.RGBfromHSV(e);
			this._background.setColor(
				cc.color(0 | (255 * e.r), 0 | (255 * e.g), 0 | (255 * e.b))
			);
		},
		updateDraggerWithHSV: function (t) {
			t = cc.p(
				this._startPos.x + this._boxPos + this._boxSize * (1 - t.s),
				this._startPos.y + this._boxPos + this._boxSize * t.v
			);
			this._updateSliderPosition(t);
		},
		_updateSliderPosition: function (t) {
			var e =
					this._startPos.x +
					0.5 * this._background.getBoundingBox().width,
				i =
					this._startPos.y +
					0.5 * this._background.getBoundingBox().height,
				n = t.x - e,
				r = t.y - i,
				o = Math.sqrt(n * n + r * r),
				r = Math.atan2(r, n),
				n = 0.5 * this._background.getBoundingBox().width;
			n < o && ((t.x = e + n * Math.cos(r)), (t.y = i + n * Math.sin(r))),
				this._slider.setPosition(t),
				t.x < this._startPos.x + this._boxPos
					? (t.x = this._startPos.x + this._boxPos)
					: t.x >
							this._startPos.x +
								this._boxPos +
								this._boxSize -
								1 &&
					  (t.x =
							this._startPos.x +
							this._boxPos +
							this._boxSize -
							1),
				t.y < this._startPos.y + this._boxPos
					? (t.y = this._startPos.y + this._boxPos)
					: t.y > this._startPos.y + this._boxPos + this._boxSize &&
					  (t.y = this._startPos.y + this._boxPos + this._boxSize),
				(this._saturation =
					1 -
					Math.abs(
						(this._startPos.x + this._boxPos - t.x) / this._boxSize
					)),
				(this._brightness = Math.abs(
					(this._startPos.y + this._boxPos - t.y) / this._boxSize
				));
		},
		_checkSliderPosition: function (t) {
			var e =
					this._startPos.x +
					0.5 * this._background.getBoundingBox().width,
				i =
					this._startPos.y +
					0.5 * this._background.getBoundingBox().height,
				e = t.x - e,
				i = t.y - i;
			return (
				Math.sqrt(e * e + i * i) <=
					0.5 * this._background.getBoundingBox().width &&
				(this._updateSliderPosition(t),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),
				!0)
			);
		},
		onTouchBegan: function (t, e) {
			if (!this.isEnabled() || !this.isVisible()) return !1;
			t = this.getTouchLocation(t);
			return this._checkSliderPosition(t);
		},
		onTouchMoved: function (t, e) {
			t = this.getTouchLocation(t);
			this._checkSliderPosition(t);
		},
	}));
var _p = cc.ControlSaturationBrightnessPicker.prototype;
_p.saturation,
	cc.defineGetterSetter(_p, 'saturation', _p.getSaturation),
	_p.brightness,
	cc.defineGetterSetter(_p, 'brightness', _p.getBrightness),
	_p.background,
	cc.defineGetterSetter(_p, 'background', _p.getBackground),
	_p.overlay,
	cc.defineGetterSetter(_p, 'overlay', _p.getOverlay),
	_p.shadow,
	cc.defineGetterSetter(_p, 'shadow', _p.getShadow),
	_p.slider,
	cc.defineGetterSetter(_p, 'slider', _p.getSlider),
	_p.startPos,
	cc.defineGetterSetter(_p, 'startPos', _p.getStartPos),
	(_p = null),
	(cc.ControlSaturationBrightnessPicker.create = function (t, e) {
		return new cc.ControlSaturationBrightnessPicker(t, e);
	}),
	(cc.ControlHuePicker = cc.Control.extend({
		_hue: 0,
		_huePercentage: 0,
		_background: null,
		_slider: null,
		_startPos: null,
		_className: 'ControlHuePicker',
		ctor: function (t, e) {
			cc.Control.prototype.ctor.call(this),
				e && this.initWithTargetAndPos(t, e);
		},
		getHue: function () {
			return this._hue;
		},
		setHue: function (t) {
			(this._hue = t), this.setHuePercentage(this._hue / 360);
		},
		getHuePercentage: function () {
			return this._huePercentage;
		},
		setHuePercentage: function (t) {
			(this._huePercentage = t), (this._hue = 360 * this._huePercentage);
			var e = this._background.getBoundingBox(),
				i = this._startPos.x + 0.5 * e.width,
				n = this._startPos.y + 0.5 * e.height,
				t = 0.5 * e.width - 15,
				e = 360 * this._huePercentage - 180,
				e = cc.degreesToRadians(e),
				i = i + t * Math.cos(e),
				e = n + t * Math.sin(e);
			this._slider.setPosition(i, e);
		},
		setEnabled: function (t) {
			cc.Control.prototype.setEnabled.call(this, t),
				this._slider && this._slider.setOpacity(t ? 255 : 128);
		},
		getBackground: function () {
			return this._background;
		},
		getSlider: function () {
			return this._slider;
		},
		getStartPos: function () {
			return this._startPos;
		},
		initWithTargetAndPos: function (t, e) {
			return (
				!!cc.Control.prototype.init.call(this) &&
				((this._background =
					cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(
						'huePickerBackground.png',
						t,
						e,
						cc.p(0, 0)
					)),
				(this._slider =
					cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(
						'colourPicker.png',
						t,
						e,
						cc.p(0.5, 0.5)
					)),
				this._slider.setPosition(
					e.x,
					e.y + 0.5 * this._background.getBoundingBox().height
				),
				(this._startPos = e),
				(this._hue = 0),
				!(this._huePercentage = 0))
			);
		},
		_updateSliderPosition: function (t) {
			var e = this._background.getBoundingBox(),
				i = this._startPos.x + 0.5 * e.width,
				e = this._startPos.y + 0.5 * e.height,
				i = t.x - i,
				e = t.y - e,
				i = Math.atan2(e, i),
				i = cc.radiansToDegrees(i) + 180;
			this.setHue(i),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);
		},
		_checkSliderPosition: function (t) {
			var e = Math.sqrt(Math.pow(t.x + 10, 2) + Math.pow(t.y, 2));
			return e < 80 && 59 < e && (this._updateSliderPosition(t), !0);
		},
		onTouchBegan: function (t, e) {
			if (!this.isEnabled() || !this.isVisible()) return !1;
			t = this.getTouchLocation(t);
			return this._checkSliderPosition(t);
		},
		onTouchMoved: function (t, e) {
			t = this.getTouchLocation(t);
			this._checkSliderPosition(t);
		},
	}));
var _p = cc.ControlHuePicker.prototype;
_p.hue,
	cc.defineGetterSetter(_p, 'hue', _p.getHue, _p.setHue),
	_p.huePercent,
	cc.defineGetterSetter(
		_p,
		'huePercent',
		_p.getHuePercentage,
		_p.setHuePercentage
	),
	_p.background,
	cc.defineGetterSetter(_p, 'background', _p.getBackground),
	_p.slider,
	cc.defineGetterSetter(_p, 'slider', _p.getSlider),
	_p.startPos,
	cc.defineGetterSetter(_p, 'startPos', _p.getStartPos),
	(_p = null),
	(cc.ControlHuePicker.create = function (t, e) {
		return new cc.ControlHuePicker(t, e);
	}),
	(cc.ControlColourPicker = cc.Control.extend({
		_hsv: null,
		_colourPicker: null,
		_huePicker: null,
		_background: null,
		_className: 'ControlColourPicker',
		ctor: function () {
			cc.Control.prototype.ctor.call(this), this.init();
		},
		hueSliderValueChanged: function (t, e) {
			this._hsv.h = t.getHue();
			t = cc.ControlUtils.RGBfromHSV(this._hsv);
			cc.Control.prototype.setColor.call(
				this,
				cc.color(0 | (255 * t.r), 0 | (255 * t.g), 0 | (255 * t.b))
			),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),
				this._updateControlPicker();
		},
		colourSliderValueChanged: function (t, e) {
			(this._hsv.s = t.getSaturation()),
				(this._hsv.v = t.getBrightness());
			t = cc.ControlUtils.RGBfromHSV(this._hsv);
			cc.Control.prototype.setColor.call(
				this,
				cc.color(0 | (255 * t.r), 0 | (255 * t.g), 0 | (255 * t.b))
			),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);
		},
		setColor: function (t) {
			cc.Control.prototype.setColor.call(this, t);
			var e = new cc.RGBA();
			(e.r = t.r / 255),
				(e.g = t.g / 255),
				(e.b = t.b / 255),
				(e.a = 1),
				(this._hsv = cc.ControlUtils.HSVfromRGB(e)),
				this._updateHueAndControlPicker();
		},
		getBackground: function () {
			return this._background;
		},
		init: function () {
			if (cc.Control.prototype.init.call(this)) {
				cc.spriteFrameCache.addSpriteFrames(
					res.CCControlColourPickerSpriteSheet_plist
				);
				var t = new cc.SpriteBatchNode(
					res.CCControlColourPickerSpriteSheet_png
				);
				this.addChild(t),
					(this._hsv = new cc.HSV(0, 0, 0)),
					(this._background =
						cc.ControlUtils.addSpriteToTargetWithPosAndAnchor(
							'menuColourPanelBackground.png',
							t,
							cc.p(0, 0),
							cc.p(0.5, 0.5)
						));
				var e = cc.pSub(
					this._background.getPosition(),
					cc.p(
						this._background.getContentSize().width / 2,
						this._background.getContentSize().height / 2
					)
				);
				return (
					(this._huePicker = new cc.ControlHuePicker(
						t,
						cc.p(e.x + 8, e.y + 8)
					)),
					(this._colourPicker =
						new cc.ControlSaturationBrightnessPicker(
							t,
							cc.p(e.x + 28, e.y + 28)
						)),
					this._huePicker.addTargetWithActionForControlEvents(
						this,
						this.hueSliderValueChanged,
						cc.CONTROL_EVENT_VALUECHANGED
					),
					this._colourPicker.addTargetWithActionForControlEvents(
						this,
						this.colourSliderValueChanged,
						cc.CONTROL_EVENT_VALUECHANGED
					),
					this._updateHueAndControlPicker(),
					this.addChild(this._huePicker),
					this.addChild(this._colourPicker),
					this.setContentSize(this._background.getContentSize()),
					!0
				);
			}
			return !1;
		},
		_updateControlPicker: function () {
			this._huePicker.setHue(this._hsv.h),
				this._colourPicker.updateWithHSV(this._hsv);
		},
		_updateHueAndControlPicker: function () {
			this._huePicker.setHue(this._hsv.h),
				this._colourPicker.updateWithHSV(this._hsv),
				this._colourPicker.updateDraggerWithHSV(this._hsv);
		},
		setEnabled: function (t) {
			cc.Control.prototype.setEnabled.call(this, t),
				null !== this._huePicker && this._huePicker.setEnabled(t),
				this._colourPicker && this._colourPicker.setEnabled(t);
		},
		onTouchBegan: function () {
			return !1;
		},
	}));
var _p = cc.ControlColourPicker.prototype;
_p.background,
	cc.defineGetterSetter(_p, 'background', _p.getBackground),
	(_p = null),
	(cc.ControlColourPicker.create = function () {
		return new cc.ControlColourPicker();
	});
var res = res || {};
(res.CCControlColourPickerSpriteSheet_plist =
	res.CCControlColourPickerSpriteSheet_plist ||
	'res/extensions/CCControlColourPickerSpriteSheet.plist'),
	(res.CCControlColourPickerSpriteSheet_png =
		res.CCControlColourPickerSpriteSheet_png ||
		'res/extensions/CCControlColourPickerSpriteSheet.png'),
	(cc.SLIDER_MARGIN_H = 24),
	(cc.SLIDER_MARGIN_V = 8),
	(cc.ControlSlider = cc.Control.extend({
		_value: 0,
		_minimumValue: 0,
		_maximumValue: 0,
		_minimumAllowedValue: 0,
		_maximumAllowedValue: 0,
		_thumbSprite: null,
		_progressSprite: null,
		_backgroundSprite: null,
		_className: 'ControlSlider',
		ctor: function (t, e, i) {
			cc.Control.prototype.ctor.call(this),
				null != i &&
					((t = new cc.Sprite(t)),
					(e = new cc.Sprite(e)),
					(i = new cc.Sprite(i)),
					this.initWithSprites(t, e, i));
		},
		getValue: function () {
			return this._value;
		},
		setValue: function (t) {
			(t = Math.max(t, this._minimumValue)),
				(t = Math.min(t, this._maximumValue)),
				(this._value = t),
				this.needsLayout(),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);
		},
		getMinimumValue: function () {
			return this._minimumValue;
		},
		setMinimumValue: function (t) {
			(this._minimumValue = t),
				(this._minimumAllowedValue = t),
				this._minimumValue >= this._maximumValue &&
					(this._maximumValue = this._minimumValue + 1),
				this.setValue(this._value);
		},
		getMaximumValue: function () {
			return this._maximumValue;
		},
		setMaximumValue: function (t) {
			(this._maximumValue = t),
				(this._maximumAllowedValue = t),
				this._maximumValue <= this._minimumValue &&
					(this._minimumValue = this._maximumValue - 1),
				this.setValue(this._value);
		},
		isTouchInside: function (t) {
			var e = t.getLocation(),
				e = this.getParent().convertToNodeSpace(e),
				t = this.getBoundingBox();
			return (
				(t.width += this._thumbSprite.getContentSize().width),
				(t.x -= this._thumbSprite.getContentSize().width / 2),
				cc.rectContainsPoint(t, e)
			);
		},
		locationFromTouch: function (t) {
			t = t.getLocation();
			return (
				(t = this.convertToNodeSpace(t)).x < 0
					? (t.x = 0)
					: t.x > this._backgroundSprite.getContentSize().width &&
					  (t.x = this._backgroundSprite.getContentSize().width),
				t
			);
		},
		getMinimumAllowedValue: function () {
			return this._minimumAllowedValue;
		},
		setMinimumAllowedValue: function (t) {
			this._minimumAllowedValue = t;
		},
		getMaximumAllowedValue: function () {
			return this._maximumAllowedValue;
		},
		setMaximumAllowedValue: function (t) {
			this._maximumAllowedValue = t;
		},
		getThumbSprite: function () {
			return this._thumbSprite;
		},
		getProgressSprite: function () {
			return this._progressSprite;
		},
		getBackgroundSprite: function () {
			return this._backgroundSprite;
		},
		initWithSprites: function (t, e, i) {
			if (cc.Control.prototype.init.call(this)) {
				this.ignoreAnchorPointForPosition(!1),
					(this._backgroundSprite = t),
					(this._progressSprite = e),
					(this._thumbSprite = i);
				i = cc.ControlUtils.CCRectUnion(
					t.getBoundingBox(),
					i.getBoundingBox()
				);
				return (
					this.setContentSize(i.width, i.height),
					this._backgroundSprite.setAnchorPoint(0.5, 0.5),
					this._backgroundSprite.setPosition(
						i.width / 2,
						i.height / 2
					),
					this.addChild(this._backgroundSprite),
					this._progressSprite.setAnchorPoint(0, 0.5),
					this._progressSprite.setPosition(0, i.height / 2),
					this.addChild(this._progressSprite),
					this._thumbSprite.setPosition(0, i.height / 2),
					this.addChild(this._thumbSprite),
					(this._minimumValue = 0),
					(this._maximumValue = 1),
					this.setValue(this._minimumValue),
					!0
				);
			}
			return !1;
		},
		setEnabled: function (t) {
			cc.Control.prototype.setEnabled.call(this, t),
				this._thumbSprite &&
					this._thumbSprite.setOpacity(t ? 255 : 128);
		},
		sliderBegan: function (t) {
			this.setSelected(!0),
				this._thumbSprite.setColor(cc.color.GRAY),
				this.setValue(this.valueForLocation(t));
		},
		sliderMoved: function (t) {
			this.setValue(this.valueForLocation(t));
		},
		sliderEnded: function (t) {
			this.isSelected() &&
				this.setValue(
					this.valueForLocation(this._thumbSprite.getPosition())
				),
				this._thumbSprite.setColor(cc.color.WHITE),
				this.setSelected(!1);
		},
		getTouchLocationInControl: function (t) {
			t = t.getLocation();
			return (
				(t = this.convertToNodeSpace(t)).x < 0
					? (t.x = 0)
					: t.x >
							this._backgroundSprite.getContentSize().width +
								cc.SLIDER_MARGIN_H &&
					  (t.x =
							this._backgroundSprite.getContentSize().width +
							cc.SLIDER_MARGIN_H),
				t
			);
		},
		onTouchBegan: function (t, e) {
			if (
				!this.isTouchInside(t) ||
				!this.isEnabled() ||
				!this.isVisible()
			)
				return !1;
			t = this.locationFromTouch(t);
			return this.sliderBegan(t), !0;
		},
		onTouchMoved: function (t, e) {
			t = this.locationFromTouch(t);
			this.sliderMoved(t);
		},
		onTouchEnded: function (t, e) {
			this.sliderEnded(cc.p(0, 0));
		},
		needsLayout: function () {
			var t =
				(this._value - this._minimumValue) /
				(this._maximumValue - this._minimumValue);
			this._thumbSprite.setPositionX(
				t * this._backgroundSprite.getContentSize().width
			);
			(t = this._progressSprite.getTextureRect()),
				(t = cc.rect(
					t.x,
					t.y,
					this._thumbSprite.getPositionX(),
					t.height
				));
			this._progressSprite.setTextureRect(
				t,
				this._progressSprite.isTextureRectRotated()
			),
				this._thumbSprite._renderCmd.transform(this._renderCmd);
		},
		valueForLocation: function (t) {
			t = t.x / this._backgroundSprite.getContentSize().width;
			return Math.max(
				Math.min(
					this._minimumValue +
						t * (this._maximumValue - this._minimumValue),
					this._maximumAllowedValue
				),
				this._minimumAllowedValue
			);
		},
	}));
var _p = cc.ControlSlider.prototype;
_p.value,
	cc.defineGetterSetter(_p, 'value', _p.getValue, _p.setValue),
	_p.minValue,
	cc.defineGetterSetter(
		_p,
		'minValue',
		_p.getMinimumValue,
		_p.setMinimumValue
	),
	_p.maxValue,
	cc.defineGetterSetter(
		_p,
		'maxValue',
		_p.getMaximumValue,
		_p.setMaximumValue
	),
	_p.minAllowedValue,
	cc.defineGetterSetter(
		_p,
		'minAllowedValue',
		_p.getMinimumAllowedValue,
		_p.setMinimumAllowedValue
	),
	_p.maxAllowedValue,
	cc.defineGetterSetter(
		_p,
		'maxAllowedValue',
		_p.getMaximumAllowedValue,
		_p.setMaximumAllowedValue
	),
	_p.thumbSprite,
	cc.defineGetterSetter(_p, 'thumbSprite', _p.getThumbSprite),
	_p.progressSprite,
	cc.defineGetterSetter(_p, 'progressSprite', _p.getProgressSprite),
	_p.backgroundSprite,
	cc.defineGetterSetter(_p, 'backgroundSprite', _p.getBackgroundSprite),
	(_p = null),
	(cc.ControlSlider.create = function (t, e, i) {
		return new cc.ControlSlider(t, e, i);
	}),
	(cc.ControlSwitch = cc.Control.extend({
		_switchSprite: null,
		_initialTouchXPosition: 0,
		_moved: !1,
		_on: !1,
		_className: 'ControlSwitch',
		ctor: function (t, e, i, n, r, o) {
			cc.Control.prototype.ctor.call(this),
				o && this.initWithMaskSprite(t, e, i, n, r, o);
		},
		initWithMaskSprite: function (t, e, i, n, r, o) {
			if (!t)
				throw new Error(
					'cc.ControlSwitch.initWithMaskSprite(): maskSprite should be non-null.'
				);
			if (!e)
				throw new Error(
					'cc.ControlSwitch.initWithMaskSprite(): onSprite should be non-null.'
				);
			if (!i)
				throw new Error(
					'cc.ControlSwitch.initWithMaskSprite(): offSprite should be non-null.'
				);
			if (!n)
				throw new Error(
					'cc.ControlSwitch.initWithMaskSprite(): thumbSprite should be non-null.'
				);
			return (
				!!this.init() &&
				((this._on = !0),
				(this._switchSprite = new cc.ControlSwitchSprite()),
				this._switchSprite.initWithMaskSprite(t, e, i, n, r, o),
				this._switchSprite.setPosition(
					this._switchSprite.getContentSize().width / 2,
					this._switchSprite.getContentSize().height / 2
				),
				this.addChild(this._switchSprite),
				this.ignoreAnchorPointForPosition(!1),
				this.setAnchorPoint(0.5, 0.5),
				this.setContentSize(this._switchSprite.getContentSize()),
				!0)
			);
		},
		setOn: function (t, e) {
			(e = e || !1), (this._on = t);
			t = this._on
				? this._switchSprite.getOnPosition()
				: this._switchSprite.getOffPosition();
			e
				? this._switchSprite.runAction(
						new cc.ActionTween(
							0.2,
							'sliderXPosition',
							this._switchSprite.getSliderXPosition(),
							t
						)
				  )
				: this._switchSprite.setSliderXPosition(t),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);
		},
		isOn: function () {
			return this._on;
		},
		hasMoved: function () {
			return this._moved;
		},
		setEnabled: function (t) {
			(this._enabled = t), this._switchSprite.setOpacity(t ? 255 : 128);
		},
		locationFromTouch: function (t) {
			t = t.getLocation();
			return (t = this.convertToNodeSpace(t));
		},
		onTouchBegan: function (t, e) {
			if (
				!this.isTouchInside(t) ||
				!this.isEnabled() ||
				!this.isVisible()
			)
				return !1;
			this._moved = !1;
			t = this.locationFromTouch(t);
			return (
				(this._initialTouchXPosition =
					t.x - this._switchSprite.getSliderXPosition()),
				this._switchSprite.getThumbSprite().setColor(cc.color.GRAY),
				this._switchSprite.needsLayout(),
				!0
			);
		},
		onTouchMoved: function (t, e) {
			(t = this.locationFromTouch(t)),
				(t = cc.p(t.x - this._initialTouchXPosition, 0));
			(this._moved = !0), this._switchSprite.setSliderXPosition(t.x);
		},
		onTouchEnded: function (t, e) {
			t = this.locationFromTouch(t);
			this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),
				this.hasMoved()
					? this.setOn(
							!(
								t.x <
								this._switchSprite.getContentSize().width / 2
							),
							!0
					  )
					: this.setOn(!this._on, !0);
		},
		onTouchCancelled: function (t, e) {
			t = this.locationFromTouch(t);
			this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),
				this.hasMoved()
					? this.setOn(
							!(
								t.x <
								this._switchSprite.getContentSize().width / 2
							),
							!0
					  )
					: this.setOn(!this._on, !0);
		},
	})),
	(cc.ControlSwitch.create = function (t, e, i, n, r, o) {
		return new cc.ControlSwitch(t, e, i, n, r, o);
	}),
	(cc.ControlSwitchSprite = cc.Sprite.extend({
		_sliderXPosition: 0,
		_onPosition: 0,
		_offPosition: 0,
		_textureLocation: 0,
		_maskLocation: 0,
		_maskSize: null,
		_onSprite: null,
		_offSprite: null,
		_thumbSprite: null,
		_onLabel: null,
		_offLabel: null,
		_clipper: null,
		_stencil: null,
		_backRT: null,
		ctor: function () {
			cc.Sprite.prototype.ctor.call(this),
				(this._sliderXPosition = 0),
				(this._onPosition = 0),
				(this._offPosition = 0),
				(this._maskLocation = 0),
				(this._maskSize = cc.size(0, 0)),
				(this._onSprite = null),
				(this._offSprite = null),
				(this._thumbSprite = null),
				(this._onLabel = null),
				(this._offLabel = null);
		},
		initWithMaskSprite: function (t, e, i, n, r, o) {
			if (cc.Sprite.prototype.init.call(this)) {
				this.setSpriteFrame(t.displayFrame()),
					(this._onPosition = 0),
					(this._offPosition =
						-e.getContentSize().width +
						n.getContentSize().width / 2),
					(this._sliderXPosition = this._onPosition),
					this.setOnSprite(e),
					this.setOffSprite(i),
					this.setThumbSprite(n),
					this.setOnLabel(r),
					this.setOffLabel(o),
					(this._stencil = t);
				t = this._maskSize = this._stencil.getContentSize();
				return (
					this._stencil.setPosition(0, 0),
					(this._clipper = new cc.ClippingNode()),
					this._clipper.setAnchorPoint(0.5, 0.5),
					this._clipper.setPosition(t.width / 2, t.height / 2),
					this._clipper.setStencil(this._stencil),
					this.addChild(this._clipper),
					this._clipper.addChild(e),
					this._clipper.addChild(i),
					this._clipper.addChild(r),
					this._clipper.addChild(o),
					this.addChild(this._thumbSprite),
					this.needsLayout(),
					!0
				);
			}
			return !1;
		},
		needsLayout: function () {
			var t = this._maskSize;
			this._onSprite.setPosition(
				this._onSprite.getContentSize().width / 2 +
					this._sliderXPosition -
					t.width / 2,
				this._onSprite.getContentSize().height / 2 - t.height / 2
			),
				this._offSprite.setPosition(
					this._onSprite.getContentSize().width +
						this._offSprite.getContentSize().width / 2 +
						this._sliderXPosition -
						t.width / 2,
					this._offSprite.getContentSize().height / 2 - t.height / 2
				),
				this._onLabel &&
					this._onLabel.setPosition(
						this._onSprite.getPositionX() -
							this._thumbSprite.getContentSize().width / 6,
						this._onSprite.getContentSize().height / 2 -
							t.height / 2
					),
				this._offLabel &&
					this._offLabel.setPosition(
						this._offSprite.getPositionX() +
							this._thumbSprite.getContentSize().width / 6,
						this._offSprite.getContentSize().height / 2 -
							t.height / 2
					),
				this._thumbSprite.setPosition(
					this._onSprite.getContentSize().width +
						this._sliderXPosition,
					this._maskSize.height / 2
				);
		},
		setSliderXPosition: function (t) {
			t <= this._offPosition
				? (t = this._offPosition)
				: t >= this._onPosition && (t = this._onPosition),
				(this._sliderXPosition = t),
				this.needsLayout();
		},
		getSliderXPosition: function () {
			return this._sliderXPosition;
		},
		_getOnSideWidth: function () {
			return this._onSprite.getContentSize().width;
		},
		_getOffSideWidth: function () {
			return this._offSprite.getContentSize().height;
		},
		updateTweenAction: function (t, e) {
			'sliderXPosition' === e && this.setSliderXPosition(t);
		},
		setOnPosition: function (t) {
			this._onPosition = t;
		},
		getOnPosition: function () {
			return this._onPosition;
		},
		setOffPosition: function (t) {
			this._offPosition = t;
		},
		getOffPosition: function () {
			return this._offPosition;
		},
		setMaskTexture: function (t) {
			this._stencil.setTexture(t);
		},
		getMaskTexture: function () {
			return this._stencil.getTexture();
		},
		setTextureLocation: function (t) {
			this._textureLocation = t;
		},
		getTextureLocation: function () {
			return this._textureLocation;
		},
		setMaskLocation: function (t) {
			this._maskLocation = t;
		},
		getMaskLocation: function () {
			return this._maskLocation;
		},
		setOnSprite: function (t) {
			this._onSprite = t;
		},
		getOnSprite: function () {
			return this._onSprite;
		},
		setOffSprite: function (t) {
			this._offSprite = t;
		},
		getOffSprite: function () {
			return this._offSprite;
		},
		setThumbSprite: function (t) {
			this._thumbSprite = t;
		},
		getThumbSprite: function () {
			return this._thumbSprite;
		},
		setOnLabel: function (t) {
			this._onLabel = t;
		},
		getOnLabel: function () {
			return this._onLabel;
		},
		setOffLabel: function (t) {
			this._offLabel = t;
		},
		getOffLabel: function () {
			return this._offLabel;
		},
	}));
var _p = cc.ControlSwitchSprite.prototype;
_p.sliderX,
	cc.defineGetterSetter(
		_p,
		'sliderX',
		_p.getSliderXPosition,
		_p.setSliderXPosition
	),
	_p.onPos,
	cc.defineGetterSetter(_p, 'onPos', _p.getOnPosition, _p.setOnPosition),
	_p.offPos,
	cc.defineGetterSetter(_p, 'offPos', _p.getOffPosition, _p.setOffPosition),
	_p.maskTexture,
	cc.defineGetterSetter(
		_p,
		'maskTexture',
		_p.getMaskTexture,
		_p.setMaskTexture
	),
	_p.maskPos,
	cc.defineGetterSetter(
		_p,
		'maskPos',
		_p.getMaskLocation,
		_p.setMaskLocation
	),
	_p.onSprite,
	cc.defineGetterSetter(_p, 'onSprite', _p.getOnSprite, _p.setOnSprite),
	_p.offSprite,
	cc.defineGetterSetter(_p, 'offSprite', _p.getOffSprite, _p.setOffSprite),
	_p.thumbSprite,
	cc.defineGetterSetter(
		_p,
		'thumbSprite',
		_p.getThumbSprite,
		_p.setThumbSprite
	),
	_p.onLabel,
	cc.defineGetterSetter(_p, 'onLabel', _p.getOnLabel, _p.setOnLabel),
	_p.offLabel,
	cc.defineGetterSetter(_p, 'offLabel', _p.getOffLabel, _p.setOffLabel),
	_p.onSideWidth,
	cc.defineGetterSetter(_p, 'onSideWidth', _p._getOnSideWidth),
	_p.offSideWidth,
	cc.defineGetterSetter(_p, 'offSideWidth', _p._getOffSideWidth),
	(_p = null),
	(cc.CONTROL_STEPPER_PARTMINUS = 0),
	(cc.CONTROL_STEPPER_PARTPLUS = 1),
	(cc.CONTROL_STEPPER_PARTNONE = 2),
	(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED = cc.color(55, 55, 55)),
	(cc.CONTROL_STEPPER_LABELCOLOR_DISABLED = cc.color(147, 147, 147)),
	(cc.CONTROL_STEPPER_LABELFONT = 'CourierNewPSMT'),
	(cc.AUTOREPEAT_DELTATIME = 0.15),
	(cc.AUTOREPEAT_INCREASETIME_INCREMENT = 12),
	(cc.ControlStepper = cc.Control.extend({
		_minusSprite: null,
		_plusSprite: null,
		_minusLabel: null,
		_plusLabel: null,
		_value: 0,
		_continuous: !1,
		_autorepeat: !1,
		_wraps: !1,
		_minimumValue: 0,
		_maximumValue: 0,
		_stepValue: 0,
		_touchInsideFlag: !1,
		_touchedPart: cc.CONTROL_STEPPER_PARTNONE,
		_autorepeatCount: 0,
		_className: 'ControlStepper',
		ctor: function (t, e) {
			cc.Control.prototype.ctor.call(this),
				(this._minusSprite = null),
				(this._plusSprite = null),
				(this._minusLabel = null),
				(this._plusLabel = null),
				(this._value = 0),
				(this._continuous = !1),
				(this._autorepeat = !1),
				(this._wraps = !1),
				(this._minimumValue = 0),
				(this._maximumValue = 0),
				(this._stepValue = 0),
				(this._touchInsideFlag = !1),
				(this._touchedPart = cc.CONTROL_STEPPER_PARTNONE),
				(this._autorepeatCount = 0),
				e && this.initWithMinusSpriteAndPlusSprite(t, e);
		},
		initWithMinusSpriteAndPlusSprite: function (t, e) {
			if (!t)
				throw new Error(
					'cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Minus sprite should be non-null.'
				);
			if (!e)
				throw new Error(
					'cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Plus sprite should be non-null.'
				);
			if (this.init()) {
				(this._autorepeat = !0),
					(this._continuous = !0),
					(this._minimumValue = 0),
					(this._maximumValue = 100),
					(this._value = 0),
					(this._stepValue = 1),
					(this._wraps = !1),
					this.ignoreAnchorPointForPosition(!1),
					this.setMinusSprite(t),
					this._minusSprite.setPosition(
						t.getContentSize().width / 2,
						t.getContentSize().height / 2
					),
					this.addChild(this._minusSprite),
					this.setMinusLabel(
						new cc.LabelTTF(
							'-',
							cc.CONTROL_STEPPER_LABELFONT,
							40,
							cc.size(40, 40),
							cc.TEXT_ALIGNMENT_CENTER,
							cc.VERTICAL_TEXT_ALIGNMENT_CENTER
						)
					),
					this._minusLabel.setColor(
						cc.CONTROL_STEPPER_LABELCOLOR_DISABLED
					),
					this._minusLabel.setPosition(
						this._minusSprite.getContentSize().width / 2,
						this._minusSprite.getContentSize().height / 2
					),
					this._minusSprite.addChild(this._minusLabel),
					this.setPlusSprite(e),
					this._plusSprite.setPosition(
						t.getContentSize().width + e.getContentSize().width / 2,
						t.getContentSize().height / 2
					),
					this.addChild(this._plusSprite),
					this.setPlusLabel(
						new cc.LabelTTF(
							'+',
							cc.CONTROL_STEPPER_LABELFONT,
							40,
							cc.size(40, 40),
							cc.TEXT_ALIGNMENT_CENTER,
							cc.VERTICAL_TEXT_ALIGNMENT_CENTER
						)
					),
					this._plusLabel.setColor(
						cc.CONTROL_STEPPER_LABELCOLOR_ENABLED
					),
					this._plusLabel.setPosition(
						this._plusSprite.getContentSize().width / 2,
						this._plusSprite.getContentSize().height / 2
					),
					this._plusSprite.addChild(this._plusLabel);
				t = cc.ControlUtils.CCRectUnion(
					this._minusSprite.getBoundingBox(),
					this._plusSprite.getBoundingBox()
				);
				return (
					this.setContentSize(
						this._minusSprite.getContentSize().width +
							this._plusSprite.getContentSize().height,
						t.height
					),
					!0
				);
			}
			return !1;
		},
		setWraps: function (t) {
			(this._wraps = t),
				this._wraps &&
					(this._minusLabel.setColor(
						cc.CONTROL_STEPPER_LABELCOLOR_ENABLED
					),
					this._plusLabel.setColor(
						cc.CONTROL_STEPPER_LABELCOLOR_ENABLED
					)),
				this.setValue(this._value);
		},
		getWraps: function () {
			return this._wraps;
		},
		setMinimumValue: function (t) {
			if (t >= this._maximumValue)
				throw new Error(
					'cc.ControlStepper.setMinimumValue(): minimumValue should be numerically less than maximumValue.'
				);
			(this._minimumValue = t), this.setValue(this._value);
		},
		getMinimumValue: function () {
			return this._minimumValue;
		},
		setMaximumValue: function (t) {
			if (t <= this._minimumValue)
				throw new Error(
					'cc.ControlStepper.setMaximumValue(): maximumValue should be numerically less than maximumValue.'
				);
			(this._maximumValue = t), this.setValue(this._value);
		},
		getMaximumValue: function () {
			return this._maximumValue;
		},
		setValue: function (t) {
			this.setValueWithSendingEvent(t, !0);
		},
		getValue: function () {
			return this._value;
		},
		setStepValue: function (t) {
			if (t <= 0)
				throw new Error(
					'cc.ControlStepper.setMaximumValue(): stepValue should be numerically greater than 0.'
				);
			this._stepValue = t;
		},
		getStepValue: function () {
			return this._stepValue;
		},
		isContinuous: function () {
			return this._continuous;
		},
		setValueWithSendingEvent: function (t, e) {
			t < this._minimumValue
				? (t = this._wraps ? this._maximumValue : this._minimumValue)
				: t > this._maximumValue &&
				  (t = this._wraps ? this._minimumValue : this._maximumValue),
				(this._value = t),
				this._wraps ||
					(this._minusLabel.setColor(
						t === this._minimumValue
							? cc.CONTROL_STEPPER_LABELCOLOR_DISABLED
							: cc.CONTROL_STEPPER_LABELCOLOR_ENABLED
					),
					this._plusLabel.setColor(
						t === this._maximumValue
							? cc.CONTROL_STEPPER_LABELCOLOR_DISABLED
							: cc.CONTROL_STEPPER_LABELCOLOR_ENABLED
					)),
				e &&
					this.sendActionsForControlEvents(
						cc.CONTROL_EVENT_VALUECHANGED
					);
		},
		startAutorepeat: function () {
			(this._autorepeatCount = -1),
				this.schedule(
					this.update,
					cc.AUTOREPEAT_DELTATIME,
					cc.REPEAT_FOREVER,
					3 * cc.AUTOREPEAT_DELTATIME
				);
		},
		stopAutorepeat: function () {
			this.unschedule(this.update);
		},
		update: function (t) {
			this._autorepeatCount++,
				(this._autorepeatCount < cc.AUTOREPEAT_INCREASETIME_INCREMENT &&
					this._autorepeatCount % 3 != 0) ||
					(this._touchedPart === cc.CONTROL_STEPPER_PARTMINUS
						? this.setValueWithSendingEvent(
								this._value - this._stepValue,
								this._continuous
						  )
						: this._touchedPart === cc.CONTROL_STEPPER_PARTPLUS &&
						  this.setValueWithSendingEvent(
								this._value + this._stepValue,
								this._continuous
						  ));
		},
		updateLayoutUsingTouchLocation: function (t) {
			t.x < this._minusSprite.getContentSize().width &&
			this._value > this._minimumValue
				? ((this._touchedPart = cc.CONTROL_STEPPER_PARTMINUS),
				  this._minusSprite.setColor(cc.color.GRAY),
				  this._plusSprite.setColor(cc.color.WHITE))
				: t.x >= this._minusSprite.getContentSize().width &&
				  this._value < this._maximumValue
				? ((this._touchedPart = cc.CONTROL_STEPPER_PARTPLUS),
				  this._minusSprite.setColor(cc.color.WHITE),
				  this._plusSprite.setColor(cc.color.GRAY))
				: ((this._touchedPart = cc.CONTROL_STEPPER_PARTNONE),
				  this._minusSprite.setColor(cc.color.WHITE),
				  this._plusSprite.setColor(cc.color.WHITE));
		},
		onTouchBegan: function (t, e) {
			if (
				!this.isTouchInside(t) ||
				!this.isEnabled() ||
				!this.isVisible()
			)
				return !1;
			t = this.getTouchLocation(t);
			return (
				this.updateLayoutUsingTouchLocation(t),
				(this._touchInsideFlag = !0),
				this._autorepeat && this.startAutorepeat(),
				!0
			);
		},
		onTouchMoved: function (t, e) {
			this.isTouchInside(t)
				? ((t = this.getTouchLocation(t)),
				  this.updateLayoutUsingTouchLocation(t),
				  this._touchInsideFlag ||
						((this._touchInsideFlag = !0),
						this._autorepeat && this.startAutorepeat()))
				: ((this._touchInsideFlag = !1),
				  (this._touchedPart = cc.CONTROL_STEPPER_PARTNONE),
				  this._minusSprite.setColor(cc.color.WHITE),
				  this._plusSprite.setColor(cc.color.WHITE),
				  this._autorepeat && this.stopAutorepeat());
		},
		onTouchEnded: function (t, e) {
			this._minusSprite.setColor(cc.color.WHITE),
				this._plusSprite.setColor(cc.color.WHITE),
				this._autorepeat && this.stopAutorepeat(),
				this.isTouchInside(t) &&
					((t = this.getTouchLocation(t)),
					this.setValue(
						this._value +
							(t.x < this._minusSprite.getContentSize().width
								? 0 - this._stepValue
								: this._stepValue)
					));
		},
		setMinusSprite: function (t) {
			this._minusSprite = t;
		},
		getMinusSprite: function () {
			return this._minusSprite;
		},
		setPlusSprite: function (t) {
			this._plusSprite = t;
		},
		getPlusSprite: function () {
			return this._plusSprite;
		},
		setMinusLabel: function (t) {
			this._minusLabel = t;
		},
		getMinusLabel: function () {
			return this._minusLabel;
		},
		setPlusLabel: function (t) {
			this._plusLabel = t;
		},
		getPlusLabel: function () {
			return this._plusLabel;
		},
	}));
var _p = cc.ControlStepper.prototype;
_p.wraps,
	cc.defineGetterSetter(_p, 'wraps', _p.getWraps, _p.setWraps),
	_p.value,
	cc.defineGetterSetter(_p, 'value', _p.getValue, _p.setValue),
	_p.minValue,
	cc.defineGetterSetter(
		_p,
		'minValue',
		_p.getMinimumValue,
		_p.setMinimumValue
	),
	_p.maxValue,
	cc.defineGetterSetter(
		_p,
		'maxValue',
		_p.getMaximumValue,
		_p.setMaximumValue
	),
	_p.stepValue,
	cc.defineGetterSetter(_p, 'stepValue', _p.getStepValue, _p.setStepValue),
	_p.continuous,
	cc.defineGetterSetter(_p, 'continuous', _p.isContinuous),
	_p.minusSprite,
	cc.defineGetterSetter(
		_p,
		'minusSprite',
		_p.getMinusSprite,
		_p.setMinusSprite
	),
	_p.plusSprite,
	cc.defineGetterSetter(_p, 'plusSprite', _p.getPlusSprite, _p.setPlusSprite),
	_p.minusLabel,
	cc.defineGetterSetter(_p, 'minusLabel', _p.getMinusLabel, _p.setMinusLabel),
	_p.plusLabel,
	cc.defineGetterSetter(_p, 'plusLabel', _p.getPlusLabel, _p.setPlusLabel),
	(_p = null),
	(cc.ControlStepper.create = function (t, e) {
		return new cc.ControlStepper(t, e);
	}),
	(cc.ControlPotentiometer = cc.Control.extend({
		_thumbSprite: null,
		_progressTimer: null,
		_previousLocation: null,
		_value: 0,
		_minimumValue: 0,
		_maximumValue: 1,
		_className: 'ControlPotentiometer',
		ctor: function (t, e, i) {
			cc.Control.prototype.ctor.call(this),
				null != i &&
					((t = new cc.Sprite(t)),
					(i = new cc.Sprite(i)),
					(e = new cc.ProgressTimer(new cc.Sprite(e))),
					this.initWithTrackSprite_ProgressTimer_ThumbSprite(
						t,
						e,
						i
					));
		},
		initWithTrackSprite_ProgressTimer_ThumbSprite: function (t, e, i) {
			return (
				!!this.init() &&
				(this.setProgressTimer(e),
				this.setThumbSprite(i),
				this._thumbSprite.setPosition(e.getPosition()),
				this.addChild(i, 2),
				this.addChild(e, 1),
				this.addChild(t),
				this.setContentSize(t.getContentSize()),
				(this._minimumValue = 0),
				(this._maximumValue = 1),
				this.setValue(this._minimumValue),
				!0)
			);
		},
		setEnabled: function (t) {
			this.setEnabled(t),
				null !== this._thumbSprite &&
					this._thumbSprite.setOpacity(t ? 255 : 128);
		},
		setValue: function (t) {
			t < this._minimumValue && (t = this._minimumValue),
				t > this._maximumValue && (t = this._maximumValue);
			t =
				((this._value = t) - this._minimumValue) /
				(this._maximumValue - this._minimumValue);
			this._progressTimer.setPercentage(100 * t),
				this._thumbSprite.setRotation(360 * t),
				this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);
		},
		getValue: function () {
			return this._value;
		},
		setMinimumValue: function (t) {
			(this._minimumValue = t),
				this._minimumValue >= this._maximumValue &&
					(this._maximumValue = this._minimumValue + 1),
				this.setValue(this._maximumValue);
		},
		getMinimumValue: function () {
			return this._minimumValue;
		},
		setMaximumValue: function (t) {
			(this._maximumValue = t),
				this._maximumValue <= this._minimumValue &&
					(this._minimumValue = this._maximumValue - 1),
				this.setValue(this._minimumValue);
		},
		getMaximumValue: function () {
			return this._maximumValue;
		},
		isTouchInside: function (t) {
			t = this.getTouchLocation(t);
			return (
				this.distanceBetweenPointAndPoint(
					this._progressTimer.getPosition(),
					t
				) <
				Math.min(
					this.getContentSize().width / 2,
					this.getContentSize().height / 2
				)
			);
		},
		onTouchBegan: function (t, e) {
			return (
				!!(
					this.isTouchInside(t) &&
					this.isEnabled() &&
					this.isVisible()
				) &&
				((this._previousLocation = this.getTouchLocation(t)),
				this.potentiometerBegan(this._previousLocation),
				!0)
			);
		},
		onTouchMoved: function (t, e) {
			t = this.getTouchLocation(t);
			this.potentiometerMoved(t);
		},
		onTouchEnded: function (t, e) {
			this.potentiometerEnded(cc.p(0, 0));
		},
		distanceBetweenPointAndPoint: function (t, e) {
			var i = t.x - e.x,
				e = t.y - e.y;
			return Math.sqrt(i * i + e * e);
		},
		angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint:
			function (t, e, i, n) {
				var r = e.x - t.x,
					e = e.y - t.y,
					t = n.x - i.x,
					i = n.y - i.y;
				return (180 * (Math.atan2(r, e) - Math.atan2(t, i))) / Math.PI;
			},
		potentiometerBegan: function (t) {
			this.setSelected(!0), this.getThumbSprite().setColor(cc.color.GRAY);
		},
		potentiometerMoved: function (t) {
			var e =
				this.angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint(
					this._progressTimer.getPosition(),
					t,
					this._progressTimer.getPosition(),
					this._previousLocation
				);
			180 < e ? (e -= 360) : e < -180 && (e += 360),
				this.setValue(
					this._value +
						(e / 360) * (this._maximumValue - this._minimumValue)
				),
				(this._previousLocation = t);
		},
		potentiometerEnded: function (t) {
			this.getThumbSprite().setColor(cc.color.WHITE),
				this.setSelected(!1);
		},
		setThumbSprite: function (t) {
			this._thumbSprite = t;
		},
		getThumbSprite: function () {
			return this._thumbSprite;
		},
		setProgressTimer: function (t) {
			this._progressTimer = t;
		},
		getProgressTimer: function () {
			return this._progressTimer;
		},
		setPreviousLocation: function (t) {
			this._previousLocation = t;
		},
		getPreviousLocation: function () {
			return this._previousLocation;
		},
	}));
var _p = cc.ControlPotentiometer.prototype;
_p.value,
	cc.defineGetterSetter(_p, 'value', _p.getValue, _p.setValue),
	_p.minValue,
	cc.defineGetterSetter(
		_p,
		'minValue',
		_p.getMinimumValue,
		_p.setMinimumValue
	),
	_p.maxValue,
	cc.defineGetterSetter(
		_p,
		'maxValue',
		_p.getMaximumValue,
		_p.setMaximumValue
	),
	_p.progressTimer,
	cc.defineGetterSetter(
		_p,
		'progressTimer',
		_p.getProgressTimer,
		_p.setProgressTimer
	),
	_p.thumbSprite,
	cc.defineGetterSetter(
		_p,
		'thumbSprite',
		_p.getThumbSprite,
		_p.setThumbSprite
	),
	_p.prevLocation,
	cc.defineGetterSetter(
		_p,
		'prevLocation',
		_p.getPreviousLocation,
		_p.setPreviousLocation
	),
	(_p = null),
	(cc.ControlPotentiometer.create = function (t, e, i) {
		return new cc.ControlPotentiometer(t, e, i);
	}),
	(cc.SCROLLVIEW_DIRECTION_NONE = -1),
	(cc.SCROLLVIEW_DIRECTION_HORIZONTAL = 0),
	(cc.SCROLLVIEW_DIRECTION_VERTICAL = 1),
	(cc.SCROLLVIEW_DIRECTION_BOTH = 2);
var SCROLL_DEACCEL_RATE = 0.95,
	SCROLL_DEACCEL_DIST = 1,
	BOUNCE_DURATION = 0.15,
	INSET_RATIO = 0.2,
	MOVE_INCH = 7 / 160,
	BOUNCE_BACK_FACTOR = 0.35;
(cc.convertDistanceFromPointToInch = function (t) {
	var e = cc.view;
	return (t * ((e.getScaleX() + e.getScaleY()) / 2)) / 160;
}),
	(cc.ScrollViewDelegate = cc.Class.extend({
		scrollViewDidScroll: function (t) {},
		scrollViewDidZoom: function (t) {},
	})),
	(cc.ScrollView = cc.Layer.extend({
		_zoomScale: 0,
		_minZoomScale: 0,
		_maxZoomScale: 0,
		_delegate: null,
		_direction: cc.SCROLLVIEW_DIRECTION_BOTH,
		_dragging: !1,
		_contentOffset: null,
		_container: null,
		_touchMoved: !1,
		_maxInset: null,
		_minInset: null,
		_bounceable: !1,
		_clippingToBounds: !1,
		_scrollDistance: null,
		_touchPoint: null,
		_touchLength: 0,
		_touches: null,
		_viewSize: null,
		_minScale: 0,
		_maxScale: 0,
		_parentScissorRect: null,
		_scissorRestored: !1,
		_tmpViewRect: null,
		_touchListener: null,
		_className: 'ScrollView',
		ctor: function (t, e) {
			cc.Layer.prototype.ctor.call(this),
				(this._contentOffset = cc.p(0, 0)),
				(this._maxInset = cc.p(0, 0)),
				(this._minInset = cc.p(0, 0)),
				(this._scrollDistance = cc.p(0, 0)),
				(this._touchPoint = cc.p(0, 0)),
				(this._touches = []),
				(this._viewSize = cc.size(0, 0)),
				(this._parentScissorRect = new cc.Rect(0, 0, 0, 0)),
				(this._tmpViewRect = new cc.Rect(0, 0, 0, 0)),
				null != e
					? this.initWithViewSize(t, e)
					: this.initWithViewSize(cc.size(200, 200), null);
		},
		init: function () {
			return this.initWithViewSize(cc.size(200, 200), null);
		},
		initWithViewSize: function (t, e) {
			var i = cc.p(0, 0);
			return (
				!!cc.Layer.prototype.init.call(this) &&
				(e || this._container || (e = new cc.Layer()),
				e && this.setContainer(e),
				this.setViewSize(t),
				this.setTouchEnabled(!0),
				(this._touches.length = 0),
				(this._delegate = null),
				(this._bounceable = !0),
				(this._clippingToBounds = !0),
				(this._direction = cc.SCROLLVIEW_DIRECTION_BOTH),
				this._container.setPosition(i),
				(this._touchLength = 0),
				(this._minScale = this._maxScale = 1),
				!0)
			);
		},
		setContentOffset: function (t, e) {
			var i;
			e
				? this.setContentOffsetInDuration(t, BOUNCE_DURATION)
				: (this._bounceable ||
						((i = this.minContainerOffset()),
						(e = this.maxContainerOffset()),
						(t.x = Math.max(i.x, Math.min(e.x, t.x))),
						(t.y = Math.max(i.y, Math.min(e.y, t.y)))),
				  this._container.setPosition(t),
				  null != (t = this._delegate) &&
						t.scrollViewDidScroll &&
						t.scrollViewDidScroll(this));
		},
		getContentOffset: function () {
			var t = this._container.getPosition();
			return cc.p(t.x, t.y);
		},
		setContentOffsetInDuration: function (t, e) {
			(e = cc.moveTo(e, t)),
				(t = cc.callFunc(this._stoppedAnimatedScroll, this));
			this._container.runAction(cc.sequence(e, t)),
				this.schedule(this._performedAnimatedScroll);
		},
		setZoomScale: function (t, e) {
			var i, n;
			e
				? this.setZoomScaleInDuration(t, BOUNCE_DURATION)
				: (e = this._container).getScale() !== t &&
				  ((i =
						0 === this._touchLength
							? ((n = this._viewSize),
							  (i = cc.p(0.5 * n.width, 0.5 * n.height)),
							  this.convertToWorldSpace(i))
							: this._touchPoint),
				  (n = e.convertToNodeSpace(i)),
				  e.setScale(
						Math.max(this._minScale, Math.min(this._maxScale, t))
				  ),
				  (n = e.convertToWorldSpace(n)),
				  (n = cc.pSub(i, n)),
				  this._delegate &&
						this._delegate.scrollViewDidZoom &&
						this._delegate.scrollViewDidZoom(this),
				  this.setContentOffset(cc.pAdd(e.getPosition(), n)));
		},
		getZoomScale: function () {
			return this._container.getScale();
		},
		setZoomScaleInDuration: function (t, e) {
			var i;
			0 < e
				? (i = this._container.getScale()) !== t &&
				  ((i = cc.actionTween(e, 'zoomScale', i, t)),
				  this.runAction(i))
				: this.setZoomScale(t);
		},
		minContainerOffset: function () {
			var t = this._container,
				e = t.getContentSize(),
				i = this._viewSize;
			return cc.p(
				i.width - e.width * t.getScaleX(),
				i.height - e.height * t.getScaleY()
			);
		},
		maxContainerOffset: function () {
			return cc.p(0, 0);
		},
		isNodeVisible: function (t) {
			var e = this.getContentOffset(),
				i = this.getViewSize(),
				n = this.getZoomScale(),
				n = cc.rect(-e.x / n, -e.y / n, i.width / n, i.height / n);
			return cc.rectIntersectsRect(n, t.getBoundingBox());
		},
		pause: function (t) {
			this._container.pause();
			for (
				var e = this._container.getChildren(), i = 0;
				i < e.length;
				i++
			)
				e[i].pause();
			this._super();
		},
		resume: function (t) {
			for (
				var e = this._container.getChildren(), i = 0, n = e.length;
				i < n;
				i++
			)
				e[i].resume();
			this._container.resume(), this._super();
		},
		isDragging: function () {
			return this._dragging;
		},
		isTouchMoved: function () {
			return this._touchMoved;
		},
		isBounceable: function () {
			return this._bounceable;
		},
		setBounceable: function (t) {
			this._bounceable = t;
		},
		getViewSize: function () {
			return this._viewSize;
		},
		setViewSize: function (t) {
			(this._viewSize = t),
				cc.Node.prototype.setContentSize.call(this, t);
		},
		getContainer: function () {
			return this._container;
		},
		setContainer: function (t) {
			t &&
				(this.removeAllChildren(!0),
				(this._container = t).ignoreAnchorPointForPosition(!1),
				t.setAnchorPoint(0, 0),
				this.addChild(t),
				this.setViewSize(this._viewSize));
		},
		getDirection: function () {
			return this._direction;
		},
		setDirection: function (t) {
			this._direction = t;
		},
		getDelegate: function () {
			return this._delegate;
		},
		setDelegate: function (t) {
			this._delegate = t;
		},
		onTouchBegan: function (t, e) {
			for (var i = this; null != i; i = i.parent)
				if (!i.isVisible()) return !1;
			var n = this._getViewRect(),
				r = this._container,
				o = r.convertToWorldSpace(r.convertTouchToNodeSpace(t)),
				s = this._touches;
			return (
				!(
					2 < s.length ||
					this._touchMoved ||
					!cc.rectContainsPoint(n, o)
				) &&
				(s.push(t),
				1 === s.length
					? ((this._touchPoint = this.convertTouchToNodeSpace(t)),
					  (this._touchMoved = !1),
					  (this._dragging = !0),
					  (this._scrollDistance.x = 0),
					  (this._scrollDistance.y = 0),
					  (this._touchLength = 0))
					: 2 === s.length &&
					  ((this._touchPoint = cc.pMidpoint(
							this.convertTouchToNodeSpace(s[0]),
							this.convertTouchToNodeSpace(s[1])
					  )),
					  (this._touchLength = cc.pDistance(
							r.convertTouchToNodeSpace(s[0]),
							r.convertTouchToNodeSpace(s[1])
					  )),
					  (this._dragging = !1)),
				!0)
			);
		},
		onTouchMoved: function (t, e) {
			if (this.isVisible())
				if (
					(this.setNodeDirty(),
					1 === this._touches.length && this._dragging)
				) {
					this._touchMoved = !0;
					this._getViewRect();
					var i,
						n,
						r = this.convertTouchToNodeSpace(t),
						o = cc.pSub(r, this._touchPoint),
						s = 0,
						c = this._direction;
					if (
						(c === cc.SCROLLVIEW_DIRECTION_VERTICAL
							? ((s = o.y),
							  (i = this._container.getPositionY()),
							  (this.minContainerOffset().y <= i &&
									i <= this.maxContainerOffset().y) ||
									(o.y *= BOUNCE_BACK_FACTOR))
							: c === cc.SCROLLVIEW_DIRECTION_HORIZONTAL
							? ((s = o.x),
							  (i = this._container.getPositionX()),
							  (this.minContainerOffset().x <= i &&
									i <= this.maxContainerOffset().x) ||
									(o.x *= BOUNCE_BACK_FACTOR))
							: ((s = Math.sqrt(o.x * o.x + o.y * o.y)),
							  (i = this._container.getPositionY()),
							  (n = this.minContainerOffset()),
							  (t = this.maxContainerOffset()),
							  (n.y <= i && i <= t.y) ||
									(o.y *= BOUNCE_BACK_FACTOR),
							  (i = this._container.getPositionX()),
							  (n.x <= i && i <= t.x) ||
									(o.x *= BOUNCE_BACK_FACTOR)),
						(this._touchMoved ||
							!(
								Math.abs(cc.convertDistanceFromPointToInch(s)) <
								MOVE_INCH
							)) &&
							(this._touchMoved || ((o.x = 0), (o.y = 0)),
							(this._touchPoint = r),
							(this._touchMoved = !0),
							this._dragging))
					) {
						switch (c) {
							case cc.SCROLLVIEW_DIRECTION_VERTICAL:
								o.x = 0;
								break;
							case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:
								o.y = 0;
						}
						var a = this._container.getPosition(),
							c = a.x + o.x,
							a = a.y + o.y;
						(this._scrollDistance = o),
							this.setContentOffset(cc.p(c, a));
					}
				} else
					2 !== this._touches.length ||
						this._dragging ||
						((a = cc.pDistance(
							this._container.convertTouchToNodeSpace(
								this._touches[0]
							),
							this._container.convertTouchToNodeSpace(
								this._touches[1]
							)
						)),
						this.setZoomScale(
							(this.getZoomScale() * a) / this._touchLength
						));
		},
		onTouchEnded: function (t, e) {
			this.isVisible() &&
				(1 === this._touches.length &&
					this._touchMoved &&
					this.schedule(this._deaccelerateScrolling),
				(this._touches.length = 0),
				(this._dragging = !1),
				(this._touchMoved = !1));
		},
		onTouchCancelled: function (t, e) {
			this.isVisible() &&
				((this._touches.length = 0),
				(this._dragging = !1),
				(this._touchMoved = !1));
		},
		setContentSize: function (t, e) {
			null !== this.getContainer() &&
				(void 0 === e
					? this.getContainer().setContentSize(t)
					: this.getContainer().setContentSize(t, e),
				this.updateInset());
		},
		_setWidth: function (t) {
			var e = this.getContainer();
			null !== e && (e._setWidth(t), this.updateInset());
		},
		_setHeight: function (t) {
			var e = this.getContainer();
			null !== e && (e._setHeight(t), this.updateInset());
		},
		getContentSize: function () {
			return this._container.getContentSize();
		},
		updateInset: function () {
			var t, e;
			null !== this.getContainer() &&
				((t = this._viewSize),
				(e = this.maxContainerOffset()),
				(this._maxInset.x = e.x + t.width * INSET_RATIO),
				(this._maxInset.y = e.y + t.height * INSET_RATIO),
				(e = this.minContainerOffset()),
				(this._minInset.x = e.x - t.width * INSET_RATIO),
				(this._minInset.y = e.y - t.height * INSET_RATIO));
		},
		isClippingToBounds: function () {
			return this._clippingToBounds;
		},
		setClippingToBounds: function (t) {
			this._clippingToBounds = t;
		},
		addChild: function (t, e, i) {
			if (!t) throw new Error('child must not nil!');
			(e = e || t.getLocalZOrder()),
				(i = i || t.getTag()),
				this._container !== t
					? this._container.addChild(t, e, i)
					: cc.Layer.prototype.addChild.call(this, t, e, i);
		},
		isTouchEnabled: function () {
			return null !== this._touchListener;
		},
		setTouchEnabled: function (t) {
			this._touchListener &&
				cc.eventManager.removeListener(this._touchListener),
				(this._touchListener = null),
				t
					? ((t = cc.EventListener.create({
							event: cc.EventListener.TOUCH_ONE_BY_ONE,
					  })),
					  this.onTouchBegan &&
							(t.onTouchBegan = this.onTouchBegan.bind(this)),
					  this.onTouchMoved &&
							(t.onTouchMoved = this.onTouchMoved.bind(this)),
					  this.onTouchEnded &&
							(t.onTouchEnded = this.onTouchEnded.bind(this)),
					  this.onTouchCancelled &&
							(t.onTouchCancelled =
								this.onTouchCancelled.bind(this)),
					  (this._touchListener = t),
					  cc.eventManager.addListener(t, this))
					: ((this._dragging = !1),
					  (this._touchMoved = !1),
					  (this._touches.length = 0));
		},
		_initWithViewSize: function (t) {
			return null;
		},
		_relocateContainer: function (t) {
			var e = this.minContainerOffset(),
				i = this.maxContainerOffset(),
				n = this._direction,
				r = this._container.getPosition(),
				o = r.x,
				s = r.y;
			(n !== cc.SCROLLVIEW_DIRECTION_BOTH &&
				n !== cc.SCROLLVIEW_DIRECTION_HORIZONTAL) ||
				((o = Math.max(o, e.x)), (o = Math.min(o, i.x))),
				(n !== cc.SCROLLVIEW_DIRECTION_BOTH &&
					n !== cc.SCROLLVIEW_DIRECTION_VERTICAL) ||
					((s = Math.min(s, i.y)), (s = Math.max(s, e.y))),
				(s === r.y && o === r.x) ||
					this.setContentOffset(cc.p(o, s), t);
		},
		_deaccelerateScrolling: function (t) {
			var e, i, n, r, o;
			this._dragging
				? this.unschedule(this._deaccelerateScrolling)
				: ((o = this._container.getPosition()),
				  (n = this._scrollDistance),
				  this._container.setPosition(o.x + n.x, o.y + n.y),
				  (i = this._bounceable
						? ((e = this._maxInset), this._minInset)
						: ((e = this.maxContainerOffset()),
						  this.minContainerOffset())),
				  (r = this._container.getPositionX()),
				  (o = this._container.getPositionY()),
				  (n.x = n.x * SCROLL_DEACCEL_RATE),
				  (n.y = n.y * SCROLL_DEACCEL_RATE),
				  this.setContentOffset(cc.p(r, o)),
				  ((Math.abs(n.x) <= SCROLL_DEACCEL_DIST &&
						Math.abs(n.y) <= SCROLL_DEACCEL_DIST) ||
						o > e.y ||
						o < i.y ||
						r > e.x ||
						r < i.x ||
						r === e.x ||
						r === i.x ||
						o === e.y ||
						o === i.y) &&
						(this.unschedule(this._deaccelerateScrolling),
						this._relocateContainer(!0)));
		},
		_performedAnimatedScroll: function (t) {
			this._dragging
				? this.unschedule(this._performedAnimatedScroll)
				: this._delegate &&
				  this._delegate.scrollViewDidScroll &&
				  this._delegate.scrollViewDidScroll(this);
		},
		_stoppedAnimatedScroll: function (t) {
			this.unschedule(this._performedAnimatedScroll),
				this._delegate &&
					this._delegate.scrollViewDidScroll &&
					this._delegate.scrollViewDidScroll(this);
		},
		_handleZoom: function () {},
		_getViewRect: function () {
			for (
				var t = this.convertToWorldSpace(cc.p(0, 0)),
					e = this._viewSize,
					i = this.getScaleX(),
					n = this.getScaleY(),
					r = this._parent;
				null != r;
				r = r.getParent()
			)
				(i *= r.getScaleX()), (n *= r.getScaleY());
			i < 0 && ((t.x += e.width * i), (i = -i)),
				n < 0 && ((t.y += e.height * n), (n = -n));
			var o = this._tmpViewRect;
			return (
				(o.x = t.x),
				(o.y = t.y),
				(o.width = e.width * i),
				(o.height = e.height * n),
				o
			);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.ScrollView.CanvasRenderCmd
					: cc.ScrollView.WebGLRenderCmd
			)(this);
		},
	}));
var _p = cc.ScrollView.prototype;
_p.minOffset,
	cc.defineGetterSetter(_p, 'minOffset', _p.minContainerOffset),
	_p.maxOffset,
	cc.defineGetterSetter(_p, 'maxOffset', _p.maxContainerOffset),
	_p.bounceable,
	cc.defineGetterSetter(_p, 'bounceable', _p.isBounceable, _p.setBounceable),
	_p.viewSize,
	cc.defineGetterSetter(_p, 'viewSize', _p.getViewSize, _p.setViewSize),
	_p.container,
	cc.defineGetterSetter(_p, 'container', _p.getContainer, _p.setContainer),
	_p.direction,
	cc.defineGetterSetter(_p, 'direction', _p.getDirection, _p.setDirection),
	_p.delegate,
	cc.defineGetterSetter(_p, 'delegate', _p.getDelegate, _p.setDelegate),
	_p.clippingToBounds,
	cc.defineGetterSetter(
		_p,
		'clippingToBounds',
		_p.isClippingToBounds,
		_p.setClippingToBounds
	),
	(_p = null),
	(cc.ScrollView.create = function (t, e) {
		return new cc.ScrollView(t, e);
	}),
	(function () {
		cc.ScrollView.CanvasRenderCmd = function (t) {
			cc.Layer.CanvasRenderCmd.call(this, t),
				(this._needDraw = !1),
				(this.startCmd = new cc.CustomRenderCmd(this, this._startCmd)),
				(this.startCmd._canUseDirtyRegion = !0),
				(this.endCmd = new cc.CustomRenderCmd(this, this._endCmd)),
				(this.endCmd._canUseDirtyRegion = !0);
		};
		var t = (cc.ScrollView.CanvasRenderCmd.prototype = Object.create(
			cc.Layer.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.ScrollView.CanvasRenderCmd),
			(t._startCmd = function (t, e, i) {
				var n = this._node,
					r = t || cc._renderContext,
					t = r.getContext();
				r.save(),
					n._clippingToBounds &&
						((this._scissorRestored = !1),
						r.setTransform(this._worldTransform, e, i),
						(e = n.getScaleX()),
						(i = n.getScaleY()),
						(e = n._viewSize.width * e),
						(i = n._viewSize.height * i),
						t.beginPath(),
						t.rect(0, 0, e, -i),
						t.closePath(),
						t.clip());
			}),
			(t._endCmd = function (t) {
				(t = t || cc._renderContext).restore();
			}),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible) {
					var i,
						n,
						r = e._children;
					if (
						(this._syncStatus(t),
						cc.renderer.pushRenderCommand(this.startCmd),
						r && 0 < r.length)
					)
						for (
							n = r.length, e.sortAllChildren(), i = 0;
							i < n;
							i++
						)
							r[i]._renderCmd.visit(this);
					cc.renderer.pushRenderCommand(this.endCmd),
						(this._dirtyFlag = 0);
				}
			});
	})(),
	(cc.SortableObject = cc.Class.extend({
		setObjectID: function (t) {},
		getObjectID: function () {
			return 0;
		},
	})),
	(cc.SortedObject = cc.SortableObject.extend({
		_objectID: 0,
		ctor: function () {
			this._objectID = 0;
		},
		setObjectID: function (t) {
			this._objectID = t;
		},
		getObjectID: function () {
			return this._objectID;
		},
	}));
var _compareObject = function (t, e) {
	return t.getObjectID() - e.getObjectID();
};
(cc.ArrayForObjectSorting = cc.Class.extend({
	_saveObjectArr: null,
	ctor: function () {
		this._saveObjectArr = [];
	},
	insertSortedObject: function (t) {
		if (!t)
			throw new Error(
				'cc.ArrayForObjectSorting.insertSortedObject(): addObject should be non-null.'
			);
		var e = this.indexOfSortedObject(t);
		this.insertObject(t, e);
	},
	removeSortedObject: function (t) {
		var e;
		0 === this.count() ||
			((e = this.indexOfSortedObject(t)) < this.count() &&
				e !== cc.INVALID_INDEX &&
				this.objectAtIndex(e).getObjectID() === t.getObjectID() &&
				this.removeObjectAtIndex(e));
	},
	setObjectID_ofSortedObject: function (t, e) {
		var i,
			n = this.indexOfSortedObject(e);
		n < this.count() &&
			n !== cc.INVALID_INDEX &&
			(i = this.objectAtIndex(n)).getObjectID() === e.getObjectID() &&
			(this.removeObjectAtIndex(n),
			i.setObjectID(t),
			this.insertSortedObject(i));
	},
	objectWithObjectID: function (t) {
		if (0 === this.count()) return null;
		var e = new cc.SortedObject();
		e.setObjectID(t);
		var i = this.indexOfSortedObject(e);
		return (
			i < this.count() &&
				i !== cc.INVALID_INDEX &&
				(e = this.objectAtIndex(i)).getObjectID() !== t &&
				(e = null),
			e
		);
	},
	getObjectWithObjectID: function (t) {
		return null;
	},
	indexOfSortedObject: function (t) {
		var e = 0;
		if (t)
			for (
				var i = 0, n = t.getObjectID(), r = this._saveObjectArr, o = 0;
				o < r.length;
				o++
			) {
				var s = r[o].getObjectID();
				if (n === s || (i <= n && n < s)) break;
				(i = s), e++;
			}
		else e = cc.INVALID_INDEX;
		return e;
	},
	count: function () {
		return this._saveObjectArr.length;
	},
	lastObject: function () {
		var t = this._saveObjectArr;
		return 0 === t.length ? null : t[t.length - 1];
	},
	objectAtIndex: function (t) {
		return this._saveObjectArr[t];
	},
	addObject: function (t) {
		this._saveObjectArr.push(t), this._saveObjectArr.sort(_compareObject);
	},
	removeObjectAtIndex: function (t) {
		this._saveObjectArr.splice(t, 1),
			this._saveObjectArr.sort(_compareObject);
	},
	insertObject: function (t, e) {
		this._saveObjectArr.splice(e, 0, t),
			this._saveObjectArr.sort(_compareObject);
	},
})),
	(cc.TABLEVIEW_FILL_TOPDOWN = 0),
	(cc.TABLEVIEW_FILL_BOTTOMUP = 1),
	(cc.TableViewCell = cc.Node.extend({
		_idx: 0,
		_className: 'TableViewCell',
		getIdx: function () {
			return this._idx;
		},
		setIdx: function (t) {
			this._idx = t;
		},
		reset: function () {
			this._idx = cc.INVALID_INDEX;
		},
		setObjectID: function (t) {
			this._idx = t;
		},
		getObjectID: function () {
			return this._idx;
		},
	}));
var _p = cc.TableViewCell.prototype;
_p.objectId,
	cc.defineGetterSetter(_p, 'objectId', _p.getObjectID, _p.setObjectID),
	(_p = null),
	(cc.TableViewDelegate = cc.ScrollViewDelegate.extend({
		tableCellTouched: function (t, e) {},
		tableCellHighlight: function (t, e) {},
		tableCellUnhighlight: function (t, e) {},
		tableCellWillRecycle: function (t, e) {},
	})),
	(cc.TableViewDataSource = cc.Class.extend({
		tableCellSizeForIndex: function (t, e) {
			return this.cellSizeForTable(t);
		},
		cellSizeForTable: function (t) {
			return cc.size(0, 0);
		},
		tableCellAtIndex: function (t, e) {
			return null;
		},
		numberOfCellsInTableView: function (t) {
			return 0;
		},
	})),
	(cc.TableView = cc.ScrollView.extend({
		_vOrdering: null,
		_indices: null,
		_cellsFreed: null,
		_dataSource: null,
		_tableViewDelegate: null,
		_oldDirection: null,
		_cellsPositions: null,
		_touchedCell: null,
		ctor: function (t, e, i) {
			cc.ScrollView.prototype.ctor.call(this),
				(this._oldDirection = cc.SCROLLVIEW_DIRECTION_NONE),
				(this._cellsPositions = []),
				this.initWithViewSize(e, i),
				this.setDataSource(t),
				this._updateCellPositions(),
				this._updateContentSize();
		},
		__indexFromOffset: function (t) {
			for (
				var e = 0,
					i = this._dataSource.numberOfCellsInTableView(this) - 1,
					n =
						this.getDirection() ===
						cc.SCROLLVIEW_DIRECTION_HORIZONTAL
							? t.x
							: t.y,
					r = this._cellsPositions;
				e <= i;

			) {
				var o = 0 | (e + (i - e) / 2),
					s = r[o],
					c = r[1 + o];
				if (s <= n && n <= c) return o;
				n < s ? (i = o - 1) : (e = 1 + o);
			}
			return e <= 0 ? 0 : -1;
		},
		_indexFromOffset: function (t) {
			var e = { x: t.x, y: t.y },
				t = this._dataSource.numberOfCellsInTableView(this) - 1;
			this._vOrdering === cc.TABLEVIEW_FILL_TOPDOWN &&
				(e.y = this.getContainer().getContentSize().height - e.y);
			e = this.__indexFromOffset(e);
			return (
				-1 !== e && t < (e = Math.max(0, e)) && (e = cc.INVALID_INDEX),
				e
			);
		},
		__offsetFromIndex: function (t) {
			t =
				this.getDirection() === cc.SCROLLVIEW_DIRECTION_HORIZONTAL
					? cc.p(this._cellsPositions[t], 0)
					: cc.p(0, this._cellsPositions[t]);
			return t;
		},
		_offsetFromIndex: function (t) {
			var e = this.__offsetFromIndex(t),
				t = this._dataSource.tableCellSizeForIndex(this, t);
			return (
				this._vOrdering === cc.TABLEVIEW_FILL_TOPDOWN &&
					(e.y =
						this.getContainer().getContentSize().height -
						e.y -
						t.height),
				e
			);
		},
		_updateCellPositions: function () {
			var t = this._dataSource.numberOfCellsInTableView(this),
				e = this._cellsPositions;
			if (0 < t) {
				for (var i, n = 0, r = this._dataSource, o = 0; o < t; o++)
					(e[o] = n),
						(i = r.tableCellSizeForIndex(this, o)),
						this.getDirection() ===
						cc.SCROLLVIEW_DIRECTION_HORIZONTAL
							? (n += i.width)
							: (n += i.height);
				this._cellsPositions[t] = n;
			}
		},
		_updateContentSize: function () {
			var t = cc.size(0, 0),
				e = this._dataSource.numberOfCellsInTableView(this);
			0 < e &&
				((e = this._cellsPositions[e]),
				(t =
					this.getDirection() === cc.SCROLLVIEW_DIRECTION_HORIZONTAL
						? cc.size(e, this._viewSize.height)
						: cc.size(this._viewSize.width, e))),
				this.setContentSize(t),
				this._oldDirection !== this._direction &&
					(this._direction === cc.SCROLLVIEW_DIRECTION_HORIZONTAL
						? this.setContentOffset(cc.p(0, 0))
						: this.setContentOffset(
								cc.p(0, this.minContainerOffset().y)
						  ),
					(this._oldDirection = this._direction));
		},
		_moveCellOutOfSight: function (t) {
			this._tableViewDelegate &&
				this._tableViewDelegate.tableCellWillRecycle &&
				this._tableViewDelegate.tableCellWillRecycle(this, t),
				this._cellsFreed.addObject(t),
				this._cellsUsed.removeSortedObject(t),
				cc.arrayRemoveObject(this._indices, t.getIdx()),
				t.reset(),
				t.getParent() === this.getContainer() &&
					this.getContainer().removeChild(t, !0);
		},
		_setIndexForCell: function (t, e) {
			e.setAnchorPoint(0, 0),
				e.setPosition(this._offsetFromIndex(t)),
				e.setIdx(t);
		},
		_addCellIfNecessary: function (t) {
			t.getParent() !== this.getContainer() &&
				this.getContainer().addChild(t),
				this._cellsUsed.insertSortedObject(t);
			var e = this._indices,
				t = t.getIdx();
			-1 === e.indexOf(t) &&
				(e.push(t),
				e.sort(function (t, e) {
					return t - e;
				}));
		},
		getDataSource: function () {
			return this._dataSource;
		},
		setDataSource: function (t) {
			this._dataSource = t;
		},
		getDelegate: function () {
			return this._tableViewDelegate;
		},
		setDelegate: function (t) {
			this._tableViewDelegate = t;
		},
		setVerticalFillOrder: function (t) {
			this._vOrdering !== t &&
				((this._vOrdering = t),
				0 < this._cellsUsed.count() && this.reloadData());
		},
		getVerticalFillOrder: function () {
			return this._vOrdering;
		},
		initWithViewSize: function (t, e) {
			return (
				!!cc.ScrollView.prototype.initWithViewSize.call(this, t, e) &&
				((this._cellsUsed = new cc.ArrayForObjectSorting()),
				(this._cellsFreed = new cc.ArrayForObjectSorting()),
				(this._indices = []),
				(this._tableViewDelegate = null),
				(this._vOrdering = cc.TABLEVIEW_FILL_BOTTOMUP),
				this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),
				cc.ScrollView.prototype.setDelegate.call(this, this),
				!0)
			);
		},
		updateCellAtIndex: function (t) {
			var e;
			t === cc.INVALID_INDEX ||
				t > this._dataSource.numberOfCellsInTableView(this) - 1 ||
				((e = this.cellAtIndex(t)) && this._moveCellOutOfSight(e),
				(e = this._dataSource.tableCellAtIndex(this, t)),
				this._setIndexForCell(t, e),
				this._addCellIfNecessary(e));
		},
		insertCellAtIndex: function (t) {
			if (
				!(
					t === cc.INVALID_INDEX ||
					t > this._dataSource.numberOfCellsInTableView(this) - 1
				)
			) {
				var e = this._cellsUsed,
					i = e.objectWithObjectID(t);
				if (i)
					for (var n = e.indexOfSortedObject(i); n < e.count(); n++)
						(i = e.objectAtIndex(n)),
							this._setIndexForCell(i.getIdx() + 1, i);
				(i = this._dataSource.tableCellAtIndex(this, t)),
					this._setIndexForCell(t, i),
					this._addCellIfNecessary(i),
					this._updateCellPositions(),
					this._updateContentSize();
			}
		},
		removeCellAtIndex: function (t) {
			if (
				!(
					t === cc.INVALID_INDEX ||
					t > this._dataSource.numberOfCellsInTableView(this) - 1
				)
			) {
				var e = this.cellAtIndex(t);
				if (e) {
					var i = this._cellsUsed,
						n = i.indexOfSortedObject(e);
					this._moveCellOutOfSight(e),
						cc.arrayRemoveObject(this._indices, t),
						this._updateCellPositions();
					for (var r = i.count() - 1; n < r; r--)
						(e = i.objectAtIndex(r)),
							this._setIndexForCell(e.getIdx() - 1, e);
				}
			}
		},
		reloadData: function () {
			this._oldDirection = cc.SCROLLVIEW_DIRECTION_NONE;
			for (
				var t = this._cellsUsed,
					e = this._cellsFreed,
					i = this.getContainer(),
					n = 0,
					r = t.count();
				n < r;
				n++
			) {
				var o = t.objectAtIndex(n);
				this._tableViewDelegate &&
					this._tableViewDelegate.tableCellWillRecycle &&
					this._tableViewDelegate.tableCellWillRecycle(this, o),
					e.addObject(o),
					o.reset(),
					o.getParent() === i && i.removeChild(o, !0);
			}
			(this._indices = []),
				(this._cellsUsed = new cc.ArrayForObjectSorting()),
				this._updateCellPositions(),
				this._updateContentSize(),
				0 < this._dataSource.numberOfCellsInTableView(this) &&
					this.scrollViewDidScroll(this),
				this.setNodeDirty();
		},
		dequeueCell: function () {
			if (0 === this._cellsFreed.count()) return null;
			var t = this._cellsFreed.objectAtIndex(0);
			return this._cellsFreed.removeObjectAtIndex(0), t;
		},
		cellAtIndex: function (t) {
			return -1 === this._indices.indexOf(t)
				? null
				: this._cellsUsed.objectWithObjectID(t);
		},
		scrollViewDidScroll: function (t) {
			var e = this._dataSource.numberOfCellsInTableView(this);
			if (0 !== e) {
				null !== this._tableViewDelegate &&
					this._tableViewDelegate.scrollViewDidScroll &&
					this._tableViewDelegate.scrollViewDidScroll(this);
				var i = 0,
					n = this._viewSize,
					r = this.getContainer(),
					o = this.getContentOffset();
				(o.x *= -1), (o.y *= -1);
				var s = Math.max(e - 1, 0);
				this._vOrdering === cc.TABLEVIEW_FILL_TOPDOWN &&
					(o.y = o.y + n.height / r.getScaleY());
				var c = this._indexFromOffset(o);
				c === cc.INVALID_INDEX && (c = e - 1),
					this._vOrdering === cc.TABLEVIEW_FILL_TOPDOWN
						? (o.y -= n.height / r.getScaleY())
						: (o.y += n.height / r.getScaleY()),
					(o.x += n.width / r.getScaleX());
				var a = this._indexFromOffset(o);
				a === cc.INVALID_INDEX && (a = e - 1);
				var l,
					h = this._cellsUsed;
				if (0 < h.count())
					for (
						i = (l = h.objectAtIndex(0)).getIdx();
						i < c && (this._moveCellOutOfSight(l), 0 < h.count());

					)
						i = (l = h.objectAtIndex(0)).getIdx();
				if (0 < h.count())
					for (
						i = (l = h.lastObject()).getIdx();
						i <= s &&
						a < i &&
						(this._moveCellOutOfSight(l), 0 < h.count());

					)
						i = (l = h.lastObject()).getIdx();
				for (var u = this._indices, _ = c; _ <= a; _++)
					-1 === u.indexOf(_) && this.updateCellAtIndex(_);
			}
		},
		scrollViewDidZoom: function (t) {},
		onTouchEnded: function (t, e) {
			var i, n;
			this.isVisible() &&
				(this._touchedCell &&
					((i = this.getBoundingBox()),
					(n = cc.p(i.x, i.y)),
					(n = this._parent.convertToWorldSpace(n)),
					(i.x = n.x),
					(i.y = n.y),
					(n = this._tableViewDelegate),
					cc.rectContainsPoint(i, t.getLocation()) &&
						null !== n &&
						(n.tableCellUnhighlight &&
							n.tableCellUnhighlight(this, this._touchedCell),
						n.tableCellTouched &&
							n.tableCellTouched(this, this._touchedCell)),
					(this._touchedCell = null)),
				cc.ScrollView.prototype.onTouchEnded.call(this, t, e));
		},
		onTouchBegan: function (t, e) {
			for (var i = this; null != i; i = i.parent)
				if (!i.isVisible()) return !1;
			e = cc.ScrollView.prototype.onTouchBegan.call(this, t, e);
			return (
				1 === this._touches.length
					? ((t = this.getContainer().convertTouchToNodeSpace(t)),
					  (t = this._indexFromOffset(t)) === cc.INVALID_INDEX
							? (this._touchedCell = null)
							: (this._touchedCell = this.cellAtIndex(t)),
					  this._touchedCell &&
							null !== this._tableViewDelegate &&
							this._tableViewDelegate.tableCellHighlight &&
							this._tableViewDelegate.tableCellHighlight(
								this,
								this._touchedCell
							))
					: this._touchedCell &&
					  (null !== this._tableViewDelegate &&
							this._tableViewDelegate.tableCellUnhighlight &&
							this._tableViewDelegate.tableCellUnhighlight(
								this,
								this._touchedCell
							),
					  (this._touchedCell = null)),
				e
			);
		},
		onTouchMoved: function (t, e) {
			cc.ScrollView.prototype.onTouchMoved.call(this, t, e),
				this._touchedCell &&
					this.isTouchMoved() &&
					(null !== this._tableViewDelegate &&
						this._tableViewDelegate.tableCellUnhighlight &&
						this._tableViewDelegate.tableCellUnhighlight(
							this,
							this._touchedCell
						),
					(this._touchedCell = null));
		},
		onTouchCancelled: function (t, e) {
			cc.ScrollView.prototype.onTouchCancelled.call(this, t, e),
				this._touchedCell &&
					(null !== this._tableViewDelegate &&
						this._tableViewDelegate.tableCellUnhighlight &&
						this._tableViewDelegate.tableCellUnhighlight(
							this,
							this._touchedCell
						),
					(this._touchedCell = null));
		},
	}));
var _p = cc.TableView.prototype;
_p.dataSource,
	cc.defineGetterSetter(_p, 'dataSource', _p.getDataSource, _p.setDataSource),
	_p.delegate,
	cc.defineGetterSetter(_p, 'delegate', _p.getDelegate, _p.setDelegate),
	_p.verticalFillOrder,
	cc.defineGetterSetter(
		_p,
		'verticalFillOrder',
		_p.getVerticalFillOrder,
		_p.setVerticalFillOrder
	),
	(_p = null),
	(cc.TableView.create = function (t, e, i) {
		return new cc.TableView(t, e, i);
	}),
	(function () {
		cc.ScrollView.WebGLRenderCmd = function (t) {
			cc.Layer.WebGLRenderCmd.call(this, t),
				(this._needDraw = !1),
				(this.startCmd = new cc.CustomRenderCmd(this, this._startCmd)),
				(this.endCmd = new cc.CustomRenderCmd(this, this._endCmd));
		};
		var t = (cc.ScrollView.WebGLRenderCmd.prototype = Object.create(
			cc.Layer.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.ScrollView.WebGLRenderCmd),
			(t._startCmd = function () {
				var t,
					e,
					i,
					n = this._node,
					r = cc.view,
					o = n._getViewRect();
				r.isScissorEnabled()
					? ((n._scissorRestored = !0),
					  (n._parentScissorRect = r.getScissorRect()),
					  cc.rectIntersection(o, n._parentScissorRect) &&
							((e = n._parentScissorRect),
							(t = Math.max(o.x, e.x)),
							(i = Math.max(o.y, e.y)),
							(n = Math.min(o.x + o.width, e.x + e.width)),
							(e = Math.min(o.y + o.height, e.y + e.height)),
							r.setScissorInPoints(t, i, n - t, e - i)))
					: ((i = cc._renderContext).enable(i.SCISSOR_TEST),
					  r.setScissorInPoints(o.x, o.y, o.width, o.height));
			}),
			(t._endCmd = function () {
				var t,
					e = this._node;
				e._scissorRestored
					? ((t = e._parentScissorRect),
					  cc.view.setScissorInPoints(t.x, t.y, t.width, t.height))
					: (t = cc._renderContext).disable(t.SCISSOR_TEST);
			}),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible) {
					var i,
						n,
						r,
						o = e._children;
					if (
						(this._syncStatus(t),
						e._clippingToBounds &&
							cc.renderer.pushRenderCommand(this.startCmd),
						o && 0 < o.length)
					) {
						for (
							r = o.length, i = 0;
							i < r && (n = o[i]) && n._localZOrder < 0;
							i++
						)
							n._renderCmd.visit();
						for (; i < r; i++) o[i]._renderCmd.visit();
					}
					e._clippingToBounds &&
						cc.renderer.pushRenderCommand(this.endCmd),
						(this._dirtyFlag = 0);
				}
			});
	})();
var PROPERTY_POSITION = 'position',
	PROPERTY_CONTENTSIZE = 'contentSize',
	PROPERTY_SKEW = 'skew',
	PROPERTY_ANCHORPOINT = 'anchorPoint',
	PROPERTY_SCALE = 'scale',
	PROPERTY_ROTATION = 'rotation',
	PROPERTY_TAG = 'tag',
	PROPERTY_IGNOREANCHORPOINTFORPOSITION = 'ignoreAnchorPointForPosition',
	PROPERTY_VISIBLE = 'visible',
	ASSERT_FAIL_UNEXPECTED_PROPERTY = function (t) {
		cc.log("Unexpected property: '" + t + "'!");
	},
	ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE = function (t) {
		cc.log("Unexpected property type: '" + t + "'!");
	};
function BlockData(t, e) {
	(this.selMenuHander = t), (this.target = e);
}
function BlockCCControlData(t, e, i) {
	(this.selCCControlHandler = t), (this.target = e), (this.controlEvents = i);
}
(cc.NodeLoader = cc.Class.extend({
	_customProperties: null,
	ctor: function () {
		this._customProperties = new cc._Dictionary();
	},
	loadCCNode: function (t, e) {
		return this._createCCNode(t, e);
	},
	parseProperties: function (t, e, i) {
		for (var n = i.readInt(!1), r = n + i.readInt(!1), o = 0; o < r; o++) {
			var s = n <= o,
				c = i.readInt(!1),
				a = i.readCachedString(),
				l = !1,
				h = i.readByte();
			switch (
				((h !== CCB_PLATFORM_ALL &&
					h !== CCB_PLATFORM_IOS &&
					h !== CCB_PLATFORM_MAC) ||
					(l = !0),
				t instanceof cc.BuilderFile
					? t.getCCBFileNode() &&
					  s &&
					  (l =
							-1 !==
							(t = t.getCCBFileNode()).userObject.indexOf(a))
					: s &&
					  t === i.getAnimationManager().getRootNode() &&
					  ((s = t.userObject) || ((s = []), (t.userObject = s)),
					  s.push(a)),
				c)
			) {
				case CCB_PROPTYPE_POSITION:
					var u = this.parsePropTypePosition(t, e, i, a);
					l && this.onHandlePropTypePosition(t, e, a, u, i);
					break;
				case CCB_PROPTYPE_POINT:
					u = this.parsePropTypePoint(t, e, i);
					l && this.onHandlePropTypePoint(t, e, a, u, i);
					break;
				case CCB_PROPTYPE_POINTLOCK:
					var _ = this.parsePropTypePointLock(t, e, i);
					l && this.onHandlePropTypePointLock(t, e, a, _, i);
					break;
				case CCB_PROPTYPE_SIZE:
					_ = this.parsePropTypeSize(t, e, i);
					l && this.onHandlePropTypeSize(t, e, a, _, i);
					break;
				case CCB_PROPTYPE_SCALELOCK:
					var d = this.parsePropTypeScaleLock(t, e, i, a);
					l && this.onHandlePropTypeScaleLock(t, e, a, d, i);
					break;
				case CCB_PROPTYPE_FLOATXY:
					d = this.parsePropTypeFloatXY(t, e, i);
					l && this.onHandlePropTypeFloatXY(t, e, a, d, i);
					break;
				case CCB_PROPTYPE_FLOAT:
					var p = this.parsePropTypeFloat(t, e, i);
					l && this.onHandlePropTypeFloat(t, e, a, p, i);
					break;
				case CCB_PROPTYPE_DEGREES:
					p = this.parsePropTypeDegrees(t, e, i, a);
					l && this.onHandlePropTypeDegrees(t, e, a, p, i);
					break;
				case CCB_PROPTYPE_FLOATSCALE:
					var f = this.parsePropTypeFloatScale(t, e, i);
					l && this.onHandlePropTypeFloatScale(t, e, a, f, i);
					break;
				case CCB_PROPTYPE_INTEGER:
					f = this.parsePropTypeInteger(t, e, i);
					l && this.onHandlePropTypeInteger(t, e, a, f, i);
					break;
				case CCB_PROPTYPE_INTEGERLABELED:
					var m = this.parsePropTypeIntegerLabeled(t, e, i);
					l && this.onHandlePropTypeIntegerLabeled(t, e, a, m, i);
					break;
				case CCB_PROPTYPE_FLOATVAR:
					m = this.parsePropTypeFloatVar(t, e, i);
					l && this.onHandlePropTypeFloatVar(t, e, a, m, i);
					break;
				case CCB_PROPTYPE_CHECK:
					var g = this.parsePropTypeCheck(t, e, i, a);
					l && this.onHandlePropTypeCheck(t, e, a, g, i);
					break;
				case CCB_PROPTYPE_SPRITEFRAME:
					g = this.parsePropTypeSpriteFrame(t, e, i, a);
					l && this.onHandlePropTypeSpriteFrame(t, e, a, g, i);
					break;
				case CCB_PROPTYPE_ANIMATION:
					var y = this.parsePropTypeAnimation(t, e, i);
					l && this.onHandlePropTypeAnimation(t, e, a, y, i);
					break;
				case CCB_PROPTYPE_TEXTURE:
					y = this.parsePropTypeTexture(t, e, i);
					l && this.onHandlePropTypeTexture(t, e, a, y, i);
					break;
				case CCB_PROPTYPE_BYTE:
					var T = this.parsePropTypeByte(t, e, i, a);
					l && this.onHandlePropTypeByte(t, e, a, T, i);
					break;
				case CCB_PROPTYPE_COLOR3:
					T = this.parsePropTypeColor3(t, e, i, a);
					l && this.onHandlePropTypeColor3(t, e, a, T, i);
					break;
				case CCB_PROPTYPE_COLOR4VAR:
					var S = this.parsePropTypeColor4FVar(t, e, i);
					l && this.onHandlePropTypeColor4FVar(t, e, a, S, i);
					break;
				case CCB_PROPTYPE_FLIP:
					S = this.parsePropTypeFlip(t, e, i);
					l && this.onHandlePropTypeFlip(t, e, a, S, i);
					break;
				case CCB_PROPTYPE_BLENDMODE:
					var C = this.parsePropTypeBlendFunc(t, e, i);
					l && this.onHandlePropTypeBlendFunc(t, e, a, C, i);
					break;
				case CCB_PROPTYPE_FNTFILE:
					C = i.getCCBRootPath() + this.parsePropTypeFntFile(t, e, i);
					l && this.onHandlePropTypeFntFile(t, e, a, C, i);
					break;
				case CCB_PROPTYPE_FONTTTF:
					var x = this.parsePropTypeFontTTF(t, e, i);
					l && this.onHandlePropTypeFontTTF(t, e, a, x, i);
					break;
				case CCB_PROPTYPE_STRING:
					x = this.parsePropTypeString(t, e, i);
					l && this.onHandlePropTypeString(t, e, a, x, i);
					break;
				case CCB_PROPTYPE_TEXT:
					var v = this.parsePropTypeText(t, e, i);
					l && this.onHandlePropTypeText(t, e, a, v, i);
					break;
				case CCB_PROPTYPE_BLOCK:
					v = this.parsePropTypeBlock(t, e, i);
					l && this.onHandlePropTypeBlock(t, e, a, v, i);
					break;
				case CCB_PROPTYPE_BLOCKCCCONTROL:
					var E = this.parsePropTypeBlockCCControl(t, e, i);
					l &&
						null != E &&
						this.onHandlePropTypeBlockCCControl(t, e, a, E, i);
					break;
				case CCB_PROPTYPE_CCBFILE:
					E = this.parsePropTypeCCBFile(t, e, i);
					l && this.onHandlePropTypeCCBFile(t, e, a, E, i);
					break;
				default:
					ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE(c);
			}
		}
	},
	getCustomProperties: function () {
		return this._customProperties;
	},
	_createCCNode: function (t, e) {
		return new cc.Node();
	},
	parsePropTypePosition: function (t, e, i, n) {
		var r = i.readFloat(),
			o = i.readFloat(),
			s = i.readInt(!1),
			c = i.getAnimationManager().getContainerSize(e),
			e = cc._getAbsolutePosition(r, o, s, c, n);
		return (
			t.setPosition(cc.getAbsolutePosition(e, s, c, n)),
			-1 < i.getAnimatedProperties().indexOf(n) &&
				((s = [r, o, s]),
				i.getAnimationManager().setBaseValue(s, t, n)),
			e
		);
	},
	parsePropTypePoint: function (t, e, i) {
		var n = i.readFloat(),
			i = i.readFloat();
		return cc.p(n, i);
	},
	parsePropTypePointLock: function (t, e, i) {
		var n = i.readFloat(),
			i = i.readFloat();
		return cc.p(n, i);
	},
	parsePropTypeSize: function (t, e, i) {
		var n = i.readFloat(),
			r = i.readFloat(),
			o = i.readInt(!1),
			s = i.getAnimationManager().getContainerSize(e);
		switch (o) {
			case CCB_SIZETYPE_ABSOLUTE:
				break;
			case CCB_SIZETYPE_RELATIVE_CONTAINER:
				(n = s.width - n), (r = s.height - r);
				break;
			case CCB_SIZETYPE_PERCENT:
				(n = (s.width * n) / 100), (r = (s.height * r) / 100);
				break;
			case CCB_SIZETYPE_HORIZONTAL_PERCENT:
				n = (s.width * n) / 100;
				break;
			case CCB_SIZETYPE_VERTICAL_PERCENT:
				r = (s.height * r) / 100;
				break;
			case CCB_SIZETYPE_MULTIPLY_RESOLUTION:
				var c = cc.BuilderReader.getResolutionScale();
				(n *= c), (r *= c);
				break;
			default:
				cc.log('Unknown CCB type.');
		}
		return cc.size(n, r);
	},
	parsePropTypeScaleLock: function (t, e, i, n) {
		var r = i.readFloat(),
			o = i.readFloat(),
			s = i.readInt(!1);
		return (
			cc.setRelativeScale(t, r, o, s, n),
			-1 < i.getAnimatedProperties().indexOf(n) &&
				i.getAnimationManager().setBaseValue([r, o, s], t, n),
			s === CCB_SCALETYPE_MULTIPLY_RESOLUTION &&
				((r *= cc.BuilderReader.getResolutionScale()),
				(o *= cc.BuilderReader.getResolutionScale())),
			[r, o]
		);
	},
	parsePropTypeFloat: function (t, e, i) {
		return i.readFloat();
	},
	parsePropTypeDegrees: function (t, e, i, n) {
		var r = i.readFloat();
		return (
			-1 < i.getAnimatedProperties().indexOf(n) &&
				i.getAnimationManager().setBaseValue(r, t, n),
			r
		);
	},
	parsePropTypeFloatScale: function (t, e, i) {
		var n = i.readFloat();
		return (
			i.readInt(!1) === CCB_SCALETYPE_MULTIPLY_RESOLUTION &&
				(n *= cc.BuilderReader.getResolutionScale()),
			n
		);
	},
	parsePropTypeInteger: function (t, e, i) {
		return i.readInt(!0);
	},
	parsePropTypeIntegerLabeled: function (t, e, i) {
		return i.readInt(!0);
	},
	parsePropTypeFloatVar: function (t, e, i) {
		return [i.readFloat(), i.readFloat()];
	},
	parsePropTypeCheck: function (t, e, i, n) {
		var r = i.readBool();
		return (
			-1 < i.getAnimatedProperties().indexOf(n) &&
				i.getAnimationManager().setBaseValue(r, t, n),
			r
		);
	},
	parsePropTypeSpriteFrame: function (t, e, i, n) {
		var r,
			o,
			s,
			c = i.readCachedString(),
			a = i.readCachedString();
		return (
			null != a &&
				0 !== a.length &&
				((s =
					0 === c.length
						? ((a = i.getCCBRootPath() + a),
						  (o = (r =
								cc.textureCache.addImage(a)).getContentSize()),
						  (o = cc.rect(0, 0, o.width, o.height)),
						  new cc.SpriteFrame(r, o))
						: ((s = cc.spriteFrameCache),
						  (c = i.getCCBRootPath() + c),
						  -1 === i.getLoadedSpriteSheet().indexOf(c) &&
								(s.addSpriteFrames(c),
								i.getLoadedSpriteSheet().push(c)),
						  s.getSpriteFrame(a))),
				-1 < i.getAnimatedProperties().indexOf(n) &&
					i.getAnimationManager().setBaseValue(s, t, n)),
			s
		);
	},
	parsePropTypeAnimation: function (t, e, i) {
		var n = i.getCCBRootPath() + i.readCachedString(),
			r = i.readCachedString(),
			o = null,
			r = cc.BuilderReader.lastPathComponent(r),
			n = cc.BuilderReader.lastPathComponent(n);
		return (
			null != r &&
				'' !== r &&
				((i = cc.animationCache).addAnimations(n),
				(o = i.getAnimation(r))),
			o
		);
	},
	parsePropTypeTexture: function (t, e, i) {
		i = i.getCCBRootPath() + i.readCachedString();
		return '' !== i ? cc.textureCache.addImage(i) : null;
	},
	parsePropTypeByte: function (t, e, i, n) {
		var r = i.readByte();
		return (
			-1 < i.getAnimatedProperties().indexOf(n) &&
				i.getAnimationManager().setBaseValue(r, t, n),
			r
		);
	},
	parsePropTypeColor3: function (t, e, i, n) {
		var r = { r: i.readByte(), g: i.readByte(), b: i.readByte() };
		return (
			-1 < i.getAnimatedProperties().indexOf(n) &&
				i
					.getAnimationManager()
					.setBaseValue(cc.Color3BWapper.create(r), t, n),
			r
		);
	},
	parsePropTypeColor4FVar: function (t, e, i) {
		var n = 0 | (255 * i.readFloat()),
			r = 0 | (255 * i.readFloat()),
			o = 0 | (255 * i.readFloat()),
			s = (s = i.readFloat()) <= 1 ? 0 | (255 * s) : s,
			c = 0 | (255 * i.readFloat()),
			a = 0 | (255 * i.readFloat()),
			l = 0 | (255 * i.readFloat()),
			h = (h = i.readFloat()) <= 1 ? 0 | (255 * h) : h,
			i = [];
		return (
			(i[0] = { r: n, g: r, b: o, a: s }),
			(i[1] = { r: c, g: a, b: l, a: h }),
			i
		);
	},
	parsePropTypeFlip: function (t, e, i) {
		return [i.readBool(), i.readBool()];
	},
	parsePropTypeBlendFunc: function (t, e, i) {
		var n = i.readInt(!1),
			i = i.readInt(!1);
		return new cc.BlendFunc(n, i);
	},
	parsePropTypeFntFile: function (t, e, i) {
		return i.readCachedString();
	},
	parsePropTypeString: function (t, e, i) {
		return i.readCachedString();
	},
	parsePropTypeText: function (t, e, i) {
		return i.readCachedString();
	},
	parsePropTypeFontTTF: function (t, e, i) {
		return i.readCachedString();
	},
	parsePropTypeBlock: function (t, e, i) {
		var n = i.readCachedString(),
			r = i.readInt(!1);
		if (r !== CCB_TARGETTYPE_NONE) {
			var o = null;
			if (i.isJSControlled())
				r === CCB_TARGETTYPE_DOCUMENTROOT
					? (i.addDocumentCallbackNode(t),
					  i.addDocumentCallbackName(n),
					  i.addDocumentCallbackControlEvents(0))
					: (i.addOwnerCallbackNode(t),
					  i.addOwnerCallbackName(n),
					  i.addOwnerCallbackControlEvents(0));
			else if (
				(r === CCB_TARGETTYPE_DOCUMENTROOT
					? (o = i.getAnimationManager().getRootNode())
					: r === CCB_TARGETTYPE_OWNER && (o = i.getOwner()),
				null !== o)
			)
				if (0 < n.length) {
					r = 0;
					if (
						(o.onResolveCCBCCMenuItemSelector &&
							(r = o.onResolveCCBCCMenuItemSelector(o, n)),
						0 !== r ||
							(null != (i = i.getCCBSelectorResolver()) &&
								(r = i.onResolveCCBCCMenuItemSelector(o, n))),
						0 !== r)
					)
						return new BlockData(r, o);
					cc.log(
						"Skipping selector '" +
							n +
							"' since no CCBSelectorResolver is present."
					);
				} else cc.log('Unexpected empty selector.');
			else cc.log('Unexpected NULL target for selector.');
		}
		return null;
	},
	parsePropTypeBlockCCControl: function (t, e, i) {
		var n = i.readCachedString(),
			r = i.readInt(!1),
			o = i.readInt(!1);
		if (r !== CCB_TARGETTYPE_NONE)
			if (i.isJSControlled())
				r === CCB_TARGETTYPE_DOCUMENTROOT
					? (i.addDocumentCallbackNode(t),
					  i.addDocumentCallbackName(n),
					  i.addDocumentCallbackControlEvents(o))
					: (i.addOwnerCallbackNode(t),
					  i.addOwnerCallbackName(n),
					  i.addOwnerCallbackControlEvents(o));
			else {
				t = null;
				if (
					(r === CCB_TARGETTYPE_DOCUMENTROOT
						? (t = i.getAnimationManager().getRootNode())
						: r === CCB_TARGETTYPE_OWNER && (t = i.getOwner()),
					null !== t)
				)
					if (0 < n.length) {
						r = 0;
						if (
							(t.onResolveCCBCCControlSelector &&
								(r = t.onResolveCCBCCControlSelector(t, n)),
							0 !== r ||
								(null != (i = i.getCCBSelectorResolver()) &&
									(r = i.onResolveCCBCCControlSelector(
										t,
										n
									))),
							0 !== r)
						)
							return new BlockCCControlData(r, t, o);
						cc.log(
							"Skipping selector '" +
								n +
								"' since no CCBSelectorResolver is present."
						);
					} else cc.log('Unexpected empty selector.');
				else cc.log('Unexpected NULL target for selector.');
			}
		return null;
	},
	parsePropTypeCCBFile: function (t, e, i) {
		var n,
			r = i.getCCBRootPath() + i.readCachedString(),
			r = cc.BuilderReader.deletePathExtension(r) + '.ccbi',
			o = new cc.BuilderReader(i),
			s = cc.loader.getRes(r);
		s ||
			((n = cc.loader.getUrl(r)),
			(s = cc.loader.loadBinarySync(n)),
			(cc.loader.cache[r] = s)),
			o.initWithData(s, i.getOwner()),
			o.getAnimationManager().setRootContainerSize(e.getContentSize()),
			o.setAnimationManagers(i.getAnimationManagers()),
			o.getAnimationManager().setOwner(i.getOwner());
		e = o.readFileWithCleanUp(!1);
		return (
			i.setAnimationManagers(o.getAnimationManagers()),
			e &&
				-1 !== o.getAnimationManager().getAutoPlaySequenceId() &&
				o
					.getAnimationManager()
					.runAnimations(
						o.getAnimationManager().getAutoPlaySequenceId(),
						0
					),
			e
		);
	},
	parsePropTypeFloatXY: function (t, e, i) {
		return [i.readFloat(), i.readFloat()];
	},
	onHandlePropTypePosition: function (t, e, i, n, r) {
		i === PROPERTY_POSITION
			? t.setPosition(n)
			: ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypePoint: function (t, e, i, n, r) {
		i === PROPERTY_ANCHORPOINT
			? t.setAnchorPoint(n)
			: ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypePointLock: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeSize: function (t, e, i, n, r) {
		i === PROPERTY_CONTENTSIZE
			? t.setContentSize(n)
			: ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeScaleLock: function (t, e, i, n, r) {
		i === PROPERTY_SCALE
			? (t.setScaleX(n[0]), t.setScaleY(n[1]))
			: ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeFloatXY: function (t, e, i, n, r) {
		var o, s;
		i === PROPERTY_SKEW
			? (t.setSkewX(n[0]), t.setSkewY(n[1]))
			: ((s = i + 'Y'),
			  (t[(o = i + 'X')] && t[s]) || ASSERT_FAIL_UNEXPECTED_PROPERTY(i),
			  t[o](n[0]),
			  t[s](n[1]));
	},
	onHandlePropTypeFloat: function (t, e, i, n, r) {
		this._customProperties.setObject(n, i);
	},
	onHandlePropTypeDegrees: function (t, e, i, n, r) {
		i === PROPERTY_ROTATION
			? t.setRotation(n)
			: ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeFloatScale: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeInteger: function (t, e, i, n, r) {
		i === PROPERTY_TAG ? t.setTag(n) : ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeIntegerLabeled: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeFloatVar: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeCheck: function (t, e, i, n, r) {
		i === PROPERTY_VISIBLE
			? t.setVisible(n)
			: i === PROPERTY_IGNOREANCHORPOINTFORPOSITION
			? t.ignoreAnchorPointForPosition(n)
			: ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeSpriteFrame: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeAnimation: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeTexture: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeByte: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeColor3: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeColor4FVar: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeFlip: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeFntFile: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeString: function (t, e, i, n, r) {
		this._customProperties.setObject(n, i);
	},
	onHandlePropTypeText: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeFontTTF: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeBlock: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeBlockCCControl: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
	onHandlePropTypeCCBFile: function (t, e, i, n, r) {
		ASSERT_FAIL_UNEXPECTED_PROPERTY(i);
	},
})),
	(cc.NodeLoader.loader = function () {
		return new cc.NodeLoader();
	}),
	(cc.NodeLoaderListener = cc.Class.extend({
		onNodeLoaded: function (t, e) {},
	})),
	(cc.BuilderSelectorResolver = cc.Class.extend({
		onResolveCCBCCMenuItemSelector: function (t, e) {},
		onResolveCCBCCCallFuncSelector: function (t, e) {},
		onResolveCCBCCControlSelector: function (t, e) {},
	})),
	(cc.BuilderScriptOwnerProtocol = cc.Class.extend({
		createNew: function () {},
	})),
	(cc.BuilderMemberVariableAssigner = cc.Class.extend({
		onAssignCCBMemberVariable: function (t, e, i) {
			return !1;
		},
		onAssignCCBCustomProperty: function (t, e, i) {
			return !1;
		},
	}));
var PROPERTY_CCBFILE = 'ccbFile';
(cc.BuilderFileLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		return cc.BuilderFile.create();
	},
	onHandlePropTypeCCBFile: function (t, e, i, n, r) {
		i === PROPERTY_CCBFILE
			? t.setCCBFileNode(n)
			: cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.BuilderFileLoader.loader = function () {
		return new cc.BuilderFileLoader();
	});
var PROPERTY_ENABLED = 'enabled',
	PROPERTY_SELECTED = 'selected',
	PROPERTY_CCCONTROL = 'ccControl';
cc.ControlLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {},
	onHandlePropTypeBlockCCControl: function (t, e, i, n, r) {
		i === PROPERTY_CCCONTROL
			? t.addTargetWithActionForControlEvents(
					n.target,
					n.selCCControlHandler,
					n.controlEvents
			  )
			: cc.NodeLoader.prototype.onHandlePropTypeBlockCCControl.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeCheck: function (t, e, i, n, r) {
		i === PROPERTY_ENABLED
			? t.setEnabled(n)
			: i === PROPERTY_SELECTED
			? t.setSelected(n)
			: cc.NodeLoader.prototype.onHandlePropTypeCheck.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
});
var PROPERTY_ZOOMONTOUCHDOWN = 'zoomOnTouchDown',
	PROPERTY_TITLE_NORMAL = 'title|1',
	PROPERTY_TITLE_HIGHLIGHTED = 'title|2',
	PROPERTY_TITLE_DISABLED = 'title|3',
	PROPERTY_TITLECOLOR_NORMAL = 'titleColor|1',
	PROPERTY_TITLECOLOR_HIGHLIGHTED = 'titleColor|2',
	PROPERTY_TITLECOLOR_DISABLED = 'titleColor|3',
	PROPERTY_TITLETTF_NORMAL = 'titleTTF|1',
	PROPERTY_TITLETTF_HIGHLIGHTED = 'titleTTF|2',
	PROPERTY_TITLETTF_DISABLED = 'titleTTF|3',
	PROPERTY_TITLETTFSIZE_NORMAL = 'titleTTFSize|1',
	PROPERTY_TITLETTFSIZE_HIGHLIGHTED = 'titleTTFSize|2',
	PROPERTY_TITLETTFSIZE_DISABLED = 'titleTTFSize|4',
	PROPERTY_LABELANCHORPOINT = 'labelAnchorPoint',
	PROPERTY_PREFEREDSIZE = 'preferedSize',
	PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL = 'backgroundSpriteFrame|1',
	PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED = 'backgroundSpriteFrame|2',
	PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED = 'backgroundSpriteFrame|3';
(cc.ControlButtonLoader = cc.ControlLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.ControlButton();
	},
	onHandlePropTypeCheck: function (t, e, i, n, r) {
		i === PROPERTY_ZOOMONTOUCHDOWN
			? t.setZoomOnTouchDown(n)
			: cc.ControlLoader.prototype.onHandlePropTypeCheck.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeString: function (t, e, i, n, r) {
		i === PROPERTY_TITLE_NORMAL
			? t.setTitleForState(n, cc.CONTROL_STATE_NORMAL)
			: i === PROPERTY_TITLE_HIGHLIGHTED
			? t.setTitleForState(n, cc.CONTROL_STATE_HIGHLIGHTED)
			: i === PROPERTY_TITLE_DISABLED
			? t.setTitleForState(n, cc.CONTROL_STATE_DISABLED)
			: cc.ControlLoader.prototype.onHandlePropTypeString.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFontTTF: function (t, e, i, n, r) {
		i === PROPERTY_TITLETTF_NORMAL
			? t.setTitleTTFForState(n, cc.CONTROL_STATE_NORMAL)
			: i === PROPERTY_TITLETTF_HIGHLIGHTED
			? t.setTitleTTFForState(n, cc.CONTROL_STATE_HIGHLIGHTED)
			: i === PROPERTY_TITLETTF_DISABLED
			? t.setTitleTTFForState(n, cc.CONTROL_STATE_DISABLED)
			: cc.ControlLoader.prototype.onHandlePropTypeFontTTF.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFloatScale: function (t, e, i, n, r) {
		i === PROPERTY_TITLETTFSIZE_NORMAL
			? t.setTitleTTFSizeForState(n, cc.CONTROL_STATE_NORMAL)
			: i === PROPERTY_TITLETTFSIZE_HIGHLIGHTED
			? t.setTitleTTFSizeForState(n, cc.CONTROL_STATE_HIGHLIGHTED)
			: i === PROPERTY_TITLETTFSIZE_DISABLED
			? t.setTitleTTFSizeForState(n, cc.CONTROL_STATE_DISABLED)
			: cc.ControlLoader.prototype.onHandlePropTypeFloatScale.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypePoint: function (t, e, i, n, r) {
		i === PROPERTY_LABELANCHORPOINT
			? t.setLabelAnchorPoint(n)
			: cc.ControlLoader.prototype.onHandlePropTypePoint.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeSize: function (t, e, i, n, r) {
		i === PROPERTY_PREFEREDSIZE
			? t.setPreferredSize(n)
			: cc.ControlLoader.prototype.onHandlePropTypeSize.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeSpriteFrame: function (t, e, i, n, r) {
		i === PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL
			? null != n &&
			  t.setBackgroundSpriteFrameForState(n, cc.CONTROL_STATE_NORMAL)
			: i === PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED
			? null != n &&
			  t.setBackgroundSpriteFrameForState(
					n,
					cc.CONTROL_STATE_HIGHLIGHTED
			  )
			: i === PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED
			? null != n &&
			  t.setBackgroundSpriteFrameForState(n, cc.CONTROL_STATE_DISABLED)
			: cc.ControlLoader.prototype.onHandlePropTypeSpriteFrame.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeColor3: function (t, e, i, n, r) {
		i === PROPERTY_TITLECOLOR_NORMAL
			? t.setTitleColorForState(n, cc.CONTROL_STATE_NORMAL)
			: i === PROPERTY_TITLECOLOR_HIGHLIGHTED
			? t.setTitleColorForState(n, cc.CONTROL_STATE_HIGHLIGHTED)
			: i === PROPERTY_TITLECOLOR_DISABLED
			? t.setTitleColorForState(n, cc.CONTROL_STATE_DISABLED)
			: cc.ControlLoader.prototype.onHandlePropTypeColor3.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.ControlButtonLoader.loader = function () {
		return new cc.ControlButtonLoader();
	});
var PROPERTY_CONTAINER = 'container',
	PROPERTY_DIRECTION = 'direction',
	PROPERTY_CLIPSTOBOUNDS = 'clipsToBounds',
	PROPERTY_BOUNCES = 'bounces',
	PROPERTY_SCALE = 'scale';
(cc.ScrollViewLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.ScrollView();
	},
	onHandlePropTypeSize: function (t, e, i, n, r) {
		i === PROPERTY_CONTENTSIZE
			? t.setViewSize(n)
			: cc.NodeLoader.prototype.onHandlePropTypeSize.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeCCBFile: function (t, e, i, n, r) {
		i === PROPERTY_CONTAINER
			? (t.setContainer(n), t.updateInset())
			: cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeCheck: function (t, e, i, n, r) {
		i === PROPERTY_CLIPSTOBOUNDS
			? t.setClippingToBounds(n)
			: i === PROPERTY_BOUNCES
			? t.setBounceable(n)
			: cc.NodeLoader.prototype.onHandlePropTypeCheck.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFloat: function (t, e, i, n, r) {
		i === PROPERTY_SCALE
			? t.setScale(n)
			: cc.NodeLoader.prototype.onHandlePropTypeFloat.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeIntegerLabeled: function (t, e, i, n, r) {
		i === PROPERTY_DIRECTION
			? t.setDirection(n)
			: cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.ScrollViewLoader.loader = function () {
		return new cc.ScrollViewLoader();
	});
var PROPERTY_CONTENTSIZE = 'contentSize',
	PROPERTY_SPRITEFRAME = 'spriteFrame',
	PROPERTY_COLOR = 'color',
	PROPERTY_OPACITY = 'opacity',
	PROPERTY_BLENDFUNC = 'blendFunc',
	PROPERTY_INSETLEFT = 'insetLeft',
	PROPERTY_INSETTOP = 'insetTop',
	PROPERTY_INSETRIGHT = 'insetRight',
	PROPERTY_INSETBOTTOM = 'insetBottom';
(cc.Scale9SpriteLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		var i = new cc.Scale9Sprite();
		return i.setAnchorPoint(0, 0), i;
	},
	onHandlePropTypeColor3: function (t, e, i, n, r) {
		i === PROPERTY_COLOR
			? (255 === n.r && 255 === n.g && 255 === n.b) || t.setColor(n)
			: cc.NodeLoader.prototype.onHandlePropTypeColor3.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeByte: function (t, e, i, n, r) {
		i === PROPERTY_OPACITY
			? t.setOpacity(n)
			: cc.NodeLoader.prototype.onHandlePropTypeByte.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
		i === PROPERTY_BLENDFUNC ||
			cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(
				this,
				t,
				e,
				i,
				n,
				r
			);
	},
	onHandlePropTypeSpriteFrame: function (t, e, i, n, r) {
		i === PROPERTY_SPRITEFRAME
			? t.setSpriteFrame(n)
			: cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeSize: function (t, e, i, n, r) {
		i === PROPERTY_CONTENTSIZE ||
			(i === PROPERTY_PREFEREDSIZE
				? t.setPreferredSize(n)
				: cc.NodeLoader.prototype.onHandlePropTypeSize.call(
						this,
						t,
						e,
						i,
						n,
						r
				  ));
	},
	onHandlePropTypeFloat: function (t, e, i, n, r) {
		i === PROPERTY_INSETLEFT
			? t.setInsetLeft(n)
			: i === PROPERTY_INSETTOP
			? t.setInsetTop(n)
			: i === PROPERTY_INSETRIGHT
			? t.setInsetRight(n)
			: i === PROPERTY_INSETBOTTOM
			? t.setInsetBottom(n)
			: cc.NodeLoader.prototype.onHandlePropTypeFloat.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.Scale9SpriteLoader.loader = function () {
		return new cc.Scale9SpriteLoader();
	});
var PROPERTY_FLIP = 'flip',
	PROPERTY_DISPLAYFRAME = 'displayFrame',
	PROPERTY_COLOR = 'color',
	PROPERTY_OPACITY = 'opacity',
	PROPERTY_BLENDFUNC = 'blendFunc';
(cc.SpriteLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.Sprite();
	},
	onHandlePropTypeColor3: function (t, e, i, n, r) {
		i === PROPERTY_COLOR
			? (255 === n.r && 255 === n.g && 255 === n.b) || t.setColor(n)
			: cc.NodeLoader.prototype.onHandlePropTypeColor3.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeByte: function (t, e, i, n, r) {
		i === PROPERTY_OPACITY
			? t.setOpacity(n)
			: cc.NodeLoader.prototype.onHandlePropTypeByte.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
		i === PROPERTY_BLENDFUNC
			? t.setBlendFunc(n)
			: cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeSpriteFrame: function (t, e, i, n, r) {
		i === PROPERTY_DISPLAYFRAME
			? n
				? t.setSpriteFrame(n)
				: cc.log('ERROR: SpriteFrame is null')
			: cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFlip: function (t, e, i, n, r) {
		i === PROPERTY_FLIP
			? (t.setFlippedX(n[0]), t.setFlippedY(n[1]))
			: cc.NodeLoader.prototype.onHandlePropTypeFlip.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.SpriteLoader.loader = function () {
		return new cc.SpriteLoader();
	});
var PROPERTY_TOUCH_ENABLED = 'touchEnabled',
	PROPERTY_IS_TOUCH_ENABLED = 'isTouchEnabled',
	PROPERTY_ACCELEROMETER_ENABLED = 'accelerometerEnabled',
	PROPERTY_IS_ACCELEROMETER_ENABLED = 'isAccelerometerEnabled',
	PROPERTY_IS_MOUSE_ENABLED = 'isMouseEnabled',
	PROPERTY_MOUSE_ENABLED = 'mouseEnabled',
	PROPERTY_KEYBOARD_ENABLED = 'keyboardEnabled',
	PROPERTY_IS_KEYBOARD_ENABLED = 'isKeyboardEnabled';
(cc.LayerLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		var i = new cc.Layer();
		return i.setContentSize(0, 0), i;
	},
	onHandlePropTypeCheck: function (t, e, i, n, r) {
		i === PROPERTY_TOUCH_ENABLED ||
			i === PROPERTY_IS_TOUCH_ENABLED ||
			i === PROPERTY_ACCELEROMETER_ENABLED ||
			i === PROPERTY_IS_ACCELEROMETER_ENABLED ||
			i === PROPERTY_MOUSE_ENABLED ||
			i === PROPERTY_IS_MOUSE_ENABLED ||
			(i === PROPERTY_KEYBOARD_ENABLED ||
			i === PROPERTY_IS_KEYBOARD_ENABLED
				? t.setKeyboardEnabled && !cc.sys.isNative
					? t.setKeyboardEnabled(n)
					: cc.log(
							"The property '" +
								PROPERTY_IS_KEYBOARD_ENABLED +
								"' is not supported!"
					  )
				: cc.NodeLoader.prototype.onHandlePropTypeCheck.call(
						this,
						t,
						e,
						i,
						n,
						r
				  ));
	},
})),
	(cc.LayerLoader.loader = function () {
		return new cc.LayerLoader();
	}),
	(cc.LayerColorLoader = cc.LayerLoader.extend({
		_createCCNode: function (t, e) {
			return new cc.LayerColor();
		},
		onHandlePropTypeColor3: function (t, e, i, n, r) {
			i === PROPERTY_COLOR
				? t.setColor(n)
				: cc.LayerLoader.prototype.onHandlePropTypeColor3.call(
						this,
						t,
						e,
						i,
						n,
						r
				  );
		},
		onHandlePropTypeByte: function (t, e, i, n, r) {
			i === PROPERTY_OPACITY
				? t.setOpacity(n)
				: cc.LayerLoader.prototype.onHandlePropTypeByte.call(
						this,
						t,
						e,
						i,
						n,
						r
				  );
		},
		onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
			i === PROPERTY_BLENDFUNC
				? t.setBlendFunc(n)
				: cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(
						this,
						t,
						e,
						i,
						n,
						r
				  );
		},
	})),
	(cc.LayerColorLoader.loader = function () {
		return new cc.LayerColorLoader();
	});
var PROPERTY_STARTCOLOR = 'startColor',
	PROPERTY_ENDCOLOR = 'endColor',
	PROPERTY_STARTOPACITY = 'startOpacity',
	PROPERTY_ENDOPACITY = 'endOpacity',
	PROPERTY_VECTOR = 'vector';
(cc.LayerGradientLoader = cc.LayerLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.LayerGradient();
	},
	onHandlePropTypeColor3: function (t, e, i, n, r) {
		i === PROPERTY_STARTCOLOR
			? t.setStartColor(n)
			: i === PROPERTY_ENDCOLOR
			? t.setEndColor(n)
			: cc.LayerLoader.prototype.onHandlePropTypeColor3.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeByte: function (t, e, i, n, r) {
		i === PROPERTY_STARTOPACITY
			? t.setStartOpacity(n)
			: i === PROPERTY_ENDOPACITY
			? t.setEndOpacity(n)
			: cc.LayerLoader.prototype.onHandlePropTypeByte.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypePoint: function (t, e, i, n, r) {
		i === PROPERTY_VECTOR
			? t.setVector(n)
			: cc.LayerLoader.prototype.onHandlePropTypePoint.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
		i === PROPERTY_BLENDFUNC
			? t.setBlendFunc(n)
			: cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.LayerGradientLoader.loader = function () {
		return new cc.LayerGradientLoader();
	}),
	(cc.MenuLoader = cc.LayerLoader.extend({
		_createCCNode: function (t, e) {
			var i = new cc.Menu();
			return i.setContentSize(0, 0), i;
		},
	})),
	(cc.MenuLoader.loader = function () {
		return new cc.MenuLoader();
	});
var PROPERTY_BLOCK = 'block',
	PROPERTY_ISENABLED = 'isEnabled';
cc.MenuItemLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		return null;
	},
	onHandlePropTypeBlock: function (t, e, i, n, r) {
		i === PROPERTY_BLOCK
			? null != n && t.setTarget(n.selMenuHander, n.target)
			: cc.NodeLoader.prototype.onHandlePropTypeBlock.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeCheck: function (t, e, i, n, r) {
		i === PROPERTY_ISENABLED
			? t.setEnabled(n)
			: cc.NodeLoader.prototype.onHandlePropTypeCheck.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
});
var PROPERTY_NORMALDISPLAYFRAME = 'normalSpriteFrame',
	PROPERTY_SELECTEDDISPLAYFRAME = 'selectedSpriteFrame',
	PROPERTY_DISABLEDDISPLAYFRAME = 'disabledSpriteFrame';
(cc.MenuItemImageLoader = cc.MenuItemLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.MenuItemImage();
	},
	onHandlePropTypeSpriteFrame: function (t, e, i, n, r) {
		i === PROPERTY_NORMALDISPLAYFRAME
			? null != n && t.setNormalSpriteFrame(n)
			: i === PROPERTY_SELECTEDDISPLAYFRAME
			? null != n && t.setSelectedSpriteFrame(n)
			: i === PROPERTY_DISABLEDDISPLAYFRAME
			? null != n && t.setDisabledSpriteFrame(n)
			: cc.MenuItemLoader.prototype.onHandlePropTypeSpriteFrame.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.MenuItemImageLoader.loader = function () {
		return new cc.MenuItemImageLoader();
	});
var PROPERTY_FONTNAME = 'fontName',
	PROPERTY_FONTSIZE = 'fontSize',
	PROPERTY_HORIZONTALALIGNMENT = 'horizontalAlignment',
	PROPERTY_VERTICALALIGNMENT = 'verticalAlignment',
	PROPERTY_STRING = 'string',
	PROPERTY_DIMENSIONS = 'dimensions';
(cc.LabelTTFLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.LabelTTF();
	},
	onHandlePropTypeColor3: function (t, e, i, n, r) {
		i === PROPERTY_COLOR
			? (255 === n.r && 255 === n.g && 255 === n.b) || t.setColor(n)
			: cc.NodeLoader.prototype.onHandlePropTypeColor3.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeByte: function (t, e, i, n, r) {
		i === PROPERTY_OPACITY
			? t.setOpacity(n)
			: cc.NodeLoader.prototype.onHandlePropTypeByte.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
		i === PROPERTY_BLENDFUNC
			? t.setBlendFunc(n)
			: cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFontTTF: function (t, e, i, n, r) {
		i === PROPERTY_FONTNAME
			? t.setFontName(n)
			: cc.NodeLoader.prototype.onHandlePropTypeFontTTF.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeText: function (t, e, i, n, r) {
		i === PROPERTY_STRING
			? t.setString(n)
			: cc.NodeLoader.prototype.onHandlePropTypeText.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFloatScale: function (t, e, i, n, r) {
		i === PROPERTY_FONTSIZE
			? t.setFontSize(n)
			: cc.NodeLoader.prototype.onHandlePropTypeFloatScale.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeIntegerLabeled: function (t, e, i, n, r) {
		i === PROPERTY_HORIZONTALALIGNMENT
			? t.setHorizontalAlignment(n)
			: i === PROPERTY_VERTICALALIGNMENT
			? t.setVerticalAlignment(n)
			: cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeSize: function (t, e, i, n, r) {
		i === PROPERTY_DIMENSIONS
			? t.setDimensions(n)
			: cc.NodeLoader.prototype.onHandlePropTypeSize.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.LabelTTFLoader.loader = function () {
		return new cc.LabelTTFLoader();
	});
var PROPERTY_FNTFILE = 'fntFile';
(cc.LabelBMFontLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.LabelBMFont();
	},
	onHandlePropTypeColor3: function (t, e, i, n, r) {
		i === PROPERTY_COLOR
			? (255 === n.r && 255 === n.g && 255 === n.b) || t.setColor(n)
			: cc.NodeLoader.prototype.onHandlePropTypeColor3.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeByte: function (t, e, i, n, r) {
		i === PROPERTY_OPACITY
			? t.setOpacity(n)
			: cc.NodeLoader.prototype.onHandlePropTypeByte.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
		i === PROPERTY_BLENDFUNC
			? t.setBlendFunc(n)
			: cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFntFile: function (t, e, i, n, r) {
		i === PROPERTY_FNTFILE
			? t.setFntFile(n)
			: cc.NodeLoader.prototype.onHandlePropTypeFntFile.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeText: function (t, e, i, n, r) {
		i === PROPERTY_STRING
			? t.setString(n)
			: cc.NodeLoader.prototype.onHandlePropTypeText.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.LabelBMFontLoader.loader = function () {
		return new cc.LabelBMFontLoader();
	});
var PROPERTY_EMITERMODE = 'emitterMode',
	PROPERTY_POSVAR = 'posVar',
	PROPERTY_EMISSIONRATE = 'emissionRate',
	PROPERTY_DURATION = 'duration',
	PROPERTY_TOTALPARTICLES = 'totalParticles',
	PROPERTY_LIFE = 'life',
	PROPERTY_STARTSIZE = 'startSize',
	PROPERTY_ENDSIZE = 'endSize',
	PROPERTY_STARTSPIN = 'startSpin',
	PROPERTY_ENDSPIN = 'endSpin',
	PROPERTY_ANGLE = 'angle',
	PROPERTY_GRAVITY = 'gravity',
	PROPERTY_SPEED = 'speed',
	PROPERTY_TANGENTIALACCEL = 'tangentialAccel',
	PROPERTY_RADIALACCEL = 'radialAccel',
	PROPERTY_TEXTURE = 'texture',
	PROPERTY_STARTRADIUS = 'startRadius',
	PROPERTY_ENDRADIUS = 'endRadius',
	PROPERTY_ROTATEPERSECOND = 'rotatePerSecond';
(cc.ParticleSystemLoader = cc.NodeLoader.extend({
	_createCCNode: function (t, e) {
		return new cc.ParticleSystem();
	},
	onHandlePropTypeIntegerLabeled: function (t, e, i, n, r) {
		i === PROPERTY_EMITERMODE
			? t.setEmitterMode(n)
			: cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypePoint: function (t, e, i, n, r) {
		i === PROPERTY_POSVAR
			? t.setPosVar(n)
			: i === PROPERTY_GRAVITY
			? t.setGravity(n)
			: cc.NodeLoader.prototype.onHandlePropTypePoint.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFloat: function (t, e, i, n, r) {
		i === PROPERTY_EMISSIONRATE
			? t.setEmissionRate(n)
			: i === PROPERTY_DURATION
			? t.setDuration(n)
			: cc.NodeLoader.prototype.onHandlePropTypeFloat.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeInteger: function (t, e, i, n, r) {
		i === PROPERTY_TOTALPARTICLES
			? t.setTotalParticles(n)
			: cc.NodeLoader.prototype.onHandlePropTypeInteger.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeFloatVar: function (t, e, i, n, r) {
		i === PROPERTY_LIFE
			? (t.setLife(n[0]), t.setLifeVar(n[1]))
			: i === PROPERTY_STARTSIZE
			? (t.setStartSize(n[0]), t.setStartSizeVar(n[1]))
			: i === PROPERTY_ENDSIZE
			? (t.setEndSize(n[0]), t.setEndSizeVar(n[1]))
			: i === PROPERTY_STARTSPIN
			? (t.setStartSpin(n[0]), t.setStartSpinVar(n[1]))
			: i === PROPERTY_ENDSPIN
			? (t.setEndSpin(n[0]), t.setEndSpinVar(n[1]))
			: i === PROPERTY_ANGLE
			? (t.setAngle(n[0]), t.setAngleVar(n[1]))
			: i === PROPERTY_SPEED
			? (t.setSpeed(n[0]), t.setSpeedVar(n[1]))
			: i === PROPERTY_TANGENTIALACCEL
			? (t.setTangentialAccel(n[0]), t.setTangentialAccelVar(n[1]))
			: i === PROPERTY_RADIALACCEL
			? (t.setRadialAccel(n[0]), t.setRadialAccelVar(n[1]))
			: i === PROPERTY_STARTRADIUS
			? (t.setStartRadius(n[0]), t.setStartRadiusVar(n[1]))
			: i === PROPERTY_ENDRADIUS
			? (t.setEndRadius(n[0]), t.setEndRadiusVar(n[1]))
			: i === PROPERTY_ROTATEPERSECOND
			? (t.setRotatePerSecond(n[0]), t.setRotatePerSecondVar(n[1]))
			: cc.NodeLoader.prototype.onHandlePropTypeFloatVar.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeColor4FVar: function (t, e, i, n, r) {
		i === PROPERTY_STARTCOLOR
			? (t.setStartColor(n[0]), t.setStartColorVar(n[1]))
			: i === PROPERTY_ENDCOLOR
			? (t.setEndColor(n[0]), t.setEndColorVar(n[1]))
			: cc.NodeLoader.prototype.onHandlePropTypeColor4FVar.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeBlendFunc: function (t, e, i, n, r) {
		i === PROPERTY_BLENDFUNC
			? t.setBlendFunc(n)
			: cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
	onHandlePropTypeTexture: function (t, e, i, n, r) {
		i === PROPERTY_TEXTURE
			? t.setTexture(n)
			: cc.NodeLoader.prototype.onHandlePropTypeTexture.call(
					this,
					t,
					e,
					i,
					n,
					r
			  );
	},
})),
	(cc.ParticleSystemLoader.loader = function () {
		return new cc.ParticleSystemLoader();
	}),
	(cc.NodeLoaderLibrary = cc.Class.extend({
		_ccNodeLoaders: null,
		ctor: function () {
			this._ccNodeLoaders = {};
		},
		registerDefaultCCNodeLoaders: function () {
			this.registerCCNodeLoader('CCNode', cc.NodeLoader.loader()),
				this.registerCCNodeLoader('CCLayer', cc.LayerLoader.loader()),
				this.registerCCNodeLoader(
					'CCLayerColor',
					cc.LayerColorLoader.loader()
				),
				this.registerCCNodeLoader(
					'CCLayerGradient',
					cc.LayerGradientLoader.loader()
				),
				this.registerCCNodeLoader('CCSprite', cc.SpriteLoader.loader()),
				this.registerCCNodeLoader(
					'CCLabelBMFont',
					cc.LabelBMFontLoader.loader()
				),
				this.registerCCNodeLoader(
					'CCLabelTTF',
					cc.LabelTTFLoader.loader()
				),
				this.registerCCNodeLoader(
					'CCScale9Sprite',
					cc.Scale9SpriteLoader.loader()
				),
				this.registerCCNodeLoader(
					'CCScrollView',
					cc.ScrollViewLoader.loader()
				),
				this.registerCCNodeLoader(
					'CCBFile',
					cc.BuilderFileLoader.loader()
				),
				this.registerCCNodeLoader('CCMenu', cc.MenuLoader.loader()),
				this.registerCCNodeLoader(
					'CCMenuItemImage',
					cc.MenuItemImageLoader.loader()
				),
				this.registerCCNodeLoader(
					'CCControlButton',
					cc.ControlButtonLoader.loader()
				),
				this.registerCCNodeLoader(
					'CCParticleSystemQuad',
					cc.ParticleSystemLoader.loader()
				);
		},
		registerCCNodeLoader: function (t, e) {
			this._ccNodeLoaders[t] = e;
		},
		unregisterCCNodeLoader: function (t) {
			this._ccNodeLoaders[t] && delete this._ccNodeLoaders[t];
		},
		getCCNodeLoader: function (t) {
			return this._ccNodeLoaders[t] || null;
		},
		purge: function (t) {
			if (t)
				for (var e in this._ccNodeLoaders)
					delete this._ccNodeLoaders[e];
			this._ccNodeLoaders = {};
		},
	})),
	(cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary = null),
	(cc.NodeLoaderLibrary.library = function () {
		return new cc.NodeLoaderLibrary();
	}),
	(cc.NodeLoaderLibrary.sharedCCNodeLoaderLibrary = function () {
		return (
			null == cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary &&
				((cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary =
					new cc.NodeLoaderLibrary()),
				cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary.registerDefaultCCNodeLoaders()),
			cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary
		);
	}),
	(cc.NodeLoaderLibrary.purgeSharedCCNodeLoaderLibrary = function () {
		cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary = null;
	}),
	(cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary = function () {
		var t = cc.NodeLoaderLibrary.library();
		return t.registerDefaultCCNodeLoaders(), t;
	});
var CCB_VERSION = 5,
	CCB_PROPTYPE_POSITION = 0,
	CCB_PROPTYPE_SIZE = 1,
	CCB_PROPTYPE_POINT = 2,
	CCB_PROPTYPE_POINTLOCK = 3,
	CCB_PROPTYPE_SCALELOCK = 4,
	CCB_PROPTYPE_DEGREES = 5,
	CCB_PROPTYPE_INTEGER = 6,
	CCB_PROPTYPE_FLOAT = 7,
	CCB_PROPTYPE_FLOATVAR = 8,
	CCB_PROPTYPE_CHECK = 9,
	CCB_PROPTYPE_SPRITEFRAME = 10,
	CCB_PROPTYPE_TEXTURE = 11,
	CCB_PROPTYPE_BYTE = 12,
	CCB_PROPTYPE_COLOR3 = 13,
	CCB_PROPTYPE_COLOR4VAR = 14,
	CCB_PROPTYPE_FLIP = 15,
	CCB_PROPTYPE_BLENDMODE = 16,
	CCB_PROPTYPE_FNTFILE = 17,
	CCB_PROPTYPE_TEXT = 18,
	CCB_PROPTYPE_FONTTTF = 19,
	CCB_PROPTYPE_INTEGERLABELED = 20,
	CCB_PROPTYPE_BLOCK = 21,
	CCB_PROPTYPE_ANIMATION = 22,
	CCB_PROPTYPE_CCBFILE = 23,
	CCB_PROPTYPE_STRING = 24,
	CCB_PROPTYPE_BLOCKCCCONTROL = 25,
	CCB_PROPTYPE_FLOATSCALE = 26,
	CCB_PROPTYPE_FLOATXY = 27,
	CCB_FLOAT0 = 0,
	CCB_FLOAT1 = 1,
	CCB_FLOAT_MINUS1 = 2,
	CCB_FLOAT05 = 3,
	CCB_FLOAT_INTEGER = 4,
	CCB_FLOAT_FULL = 5,
	CCB_PLATFORM_ALL = 0,
	CCB_PLATFORM_IOS = 1,
	CCB_PLATFORM_MAC = 2,
	CCB_TARGETTYPE_NONE = 0,
	CCB_TARGETTYPE_DOCUMENTROOT = 1,
	CCB_TARGETTYPE_OWNER = 2,
	CCB_KEYFRAME_EASING_INSTANT = 0,
	CCB_KEYFRAME_EASING_LINEAR = 1,
	CCB_KEYFRAME_EASING_CUBIC_IN = 2,
	CCB_KEYFRAME_EASING_CUBIC_OUT = 3,
	CCB_KEYFRAME_EASING_CUBIC_INOUT = 4,
	CCB_KEYFRAME_EASING_ELASTIC_IN = 5,
	CCB_KEYFRAME_EASING_ELASTIC_OUT = 6,
	CCB_KEYFRAME_EASING_ELASTIC_INOUT = 7,
	CCB_KEYFRAME_EASING_BOUNCE_IN = 8,
	CCB_KEYFRAME_EASING_BOUNCE_OUT = 9,
	CCB_KEYFRAME_EASING_BOUNCE_INOUT = 10,
	CCB_KEYFRAME_EASING_BACK_IN = 11,
	CCB_KEYFRAME_EASING_BACK_OUT = 12,
	CCB_KEYFRAME_EASING_BACK_INOUT = 13,
	CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT = 0,
	CCB_POSITIONTYPE_RELATIVE_TOP_LEFT = 1,
	CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT = 2,
	CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT = 3,
	CCB_POSITIONTYPE_PERCENT = 4,
	CCB_POSITIONTYPE_MULTIPLY_RESOLUTION = 5,
	CCB_SIZETYPE_ABSOLUTE = 0,
	CCB_SIZETYPE_PERCENT = 1,
	CCB_SIZETYPE_RELATIVE_CONTAINER = 2,
	CCB_SIZETYPE_HORIZONTAL_PERCENT = 3,
	CCB_SIZETYPE_VERTICAL_PERCENT = 4,
	CCB_SIZETYPE_MULTIPLY_RESOLUTION = 5,
	CCB_SCALETYPE_ABSOLUTE = 0,
	CCB_SCALETYPE_MULTIPLY_RESOLUTION = 1;
(cc.BuilderFile = cc.Node.extend({
	_ccbFileNode: null,
	getCCBFileNode: function () {
		return this._ccbFileNode;
	},
	setCCBFileNode: function (t) {
		this._ccbFileNode = t;
	},
})),
	(cc.BuilderFile.create = function () {
		return new cc.BuilderFile();
	}),
	(cc.BuilderReader = cc.Class.extend({
		_jsControlled: !1,
		_data: null,
		_ccbRootPath: '',
		_bytes: 0,
		_currentByte: 0,
		_currentBit: 0,
		_stringCache: null,
		_loadedSpriteSheets: null,
		_owner: null,
		_animationManager: null,
		_animationManagers: null,
		_animatedProps: null,
		_ccNodeLoaderLibrary: null,
		_ccNodeLoaderListener: null,
		_ccbMemberVariableAssigner: null,
		_ccbSelectorResolver: null,
		_ownerOutletNames: null,
		_ownerOutletNodes: null,
		_nodesWithAnimationManagers: null,
		_animationManagerForNodes: null,
		_ownerCallbackNames: null,
		_ownerCallbackNodes: null,
		_ownerCallbackEvents: null,
		_readNodeGraphFromData: !1,
		ctor: function (t, e, i, n) {
			var r;
			(this._stringCache = []),
				(this._loadedSpriteSheets = []),
				(this._currentBit = -1),
				(this._currentByte = -1),
				0 !== arguments.length &&
					(t instanceof cc.BuilderReader
						? ((r = t),
						  (this._loadedSpriteSheets = r._loadedSpriteSheets),
						  (this._ccNodeLoaderLibrary = r._ccNodeLoaderLibrary),
						  (this._ccbMemberVariableAssigner =
								r._ccbMemberVariableAssigner),
						  (this._ccbSelectorResolver = r._ccbSelectorResolver),
						  (this._ccNodeLoaderListener =
								r._ccNodeLoaderListener),
						  (this._ownerCallbackNames = r._ownerCallbackNames),
						  (this._ownerCallbackNodes = r._ownerCallbackNodes),
						  (this._ownerCallbackEvents = r._ownerCallbackEvents),
						  (this._ownerOutletNames = r._ownerOutletNames),
						  (this._ownerOutletNodes = r._ownerOutletNodes),
						  (this._ccbRootPath = r._ccbRootPath))
						: ((this._ccNodeLoaderLibrary = t),
						  (this._ccbMemberVariableAssigner = e),
						  (this._ccbSelectorResolver = i),
						  (this._ccNodeLoaderListener = n)));
		},
		getCCBRootPath: function () {
			return this._ccbRootPath;
		},
		setCCBRootPath: function (t) {
			this._ccbRootPath = t;
		},
		initWithData: function (t, e) {
			return (
				(this._animationManager = new cc.BuilderAnimationManager()),
				(this._data = t),
				(this._bytes = t.length),
				(this._currentBit = 0),
				(this._currentByte = 0),
				(this._owner = e),
				this._animationManager.setRootContainerSize(
					cc.director.getWinSize()
				),
				!0
			);
		},
		_loadBinarySync: function (t) {
			var e = this.getXMLHttpRequest(),
				i = 'load ' + t + ' failed!';
			e.open('GET', t, !1);
			var n = null;
			if (
				/msie/i.test(navigator.userAgent) &&
				!/opera/i.test(navigator.userAgent)
			) {
				if (
					(e.setRequestHeader('Accept-Charset', 'x-user-defined'),
					e.send(null),
					200 !== e.status)
				)
					return cc.log(i), null;
				var r = cc._convertResponseBodyToText(e.responseBody);
				r &&
					((n = this._stringConvertToArray(r)),
					(this._fileDataCache[t] = n));
			} else {
				if (
					(e.overrideMimeType &&
						e.overrideMimeType(
							'text/plain; charset=x-user-defined'
						),
					e.send(null),
					200 !== e.status)
				)
					return cc.log(i), null;
				(n = this._stringConvertToArray(e.responseText)),
					(this._fileDataCache[t] = n);
			}
			return n;
		},
		readNodeGraphFromFile: function (t, e, i, n) {
			null == i
				? (i = cc.director.getWinSize())
				: i instanceof cc.BuilderAnimationManager &&
				  ((n = i), (i = cc.director.getWinSize()));
			var r,
				o = cc.loader.getRes(t);
			return (
				o ||
					((r = cc.loader.getUrl(t)),
					(o = cc.loader.loadBinarySync(r)),
					(cc.loader.cache[t] = o)),
				this.readNodeGraphFromData(o, e, i, n)
			);
		},
		readNodeGraphFromData: function (t, e, i) {
			this.initWithData(t, e);
			t = this._animationManager;
			t.setRootContainerSize(i),
				t.setOwner(e),
				(this._ownerOutletNames = []),
				(this._ownerOutletNodes = []),
				(this._ownerCallbackNames = []),
				(this._ownerCallbackNodes = []),
				(this._ownerCallbackEvents = []),
				(this._animationManagers = new cc._Dictionary());
			e = this.readFileWithCleanUp(!0);
			if (
				(e &&
					-1 !== t.getAutoPlaySequenceId() &&
					t.runAnimations(t.getAutoPlaySequenceId(), 0),
				this._jsControlled)
			) {
				for (
					var n = [],
						r = [],
						o = this._animationManagers,
						s = o.allKeys(),
						c = 0;
					c < s.length;
					c++
				)
					n.push(s[c]), r.push(o.objectForKey(s[c]));
				(this._nodesWithAnimationManagers = n),
					(this._animationManagerForNodes = r);
			}
			return e;
		},
		createSceneWithNodeGraphFromFile: function (t, e, i, n) {
			(i = this.readNodeGraphFromFile(t, e, i, n)), (n = new cc.Scene());
			return n.addChild(i), n;
		},
		getCCBMemberVariableAssigner: function () {
			return this._ccbMemberVariableAssigner;
		},
		getCCBSelectorResolver: function () {
			return this._ccbSelectorResolver;
		},
		getAnimationManager: function () {
			return this._animationManager;
		},
		setAnimationManager: function (t) {
			this._animationManager = t;
		},
		getAnimatedProperties: function () {
			return this._animatedProps;
		},
		getLoadedSpriteSheet: function () {
			return this._loadedSpriteSheets;
		},
		getOwner: function () {
			return this._owner;
		},
		readInt: function (t) {
			for (var e = 0; !this._getBit(); ) e++;
			for (var i = 0, n = e - 1; 0 <= n; n--)
				this._getBit() && (i |= 1 << n);
			return (
				(i |= 1 << e),
				(t = t ? (i % 2 ? 0 | (i / 2) : 0 | (-i / 2)) : i - 1),
				this._alignBits(),
				t
			);
		},
		readByte: function () {
			var t = this._data[this._currentByte];
			return this._currentByte++, t;
		},
		readBool: function () {
			return 0 !== this.readByte();
		},
		readFloat: function () {
			switch (this.readByte()) {
				case CCB_FLOAT0:
					return 0;
				case CCB_FLOAT1:
					return 1;
				case CCB_FLOAT_MINUS1:
					return -1;
				case CCB_FLOAT05:
					return 0.5;
				case CCB_FLOAT_INTEGER:
					return this.readInt(!0);
				default:
					return this._decodeFloat(23, 8);
			}
		},
		_decodeFloat: function (t, e) {
			var i = t + e + 1,
				n = i >> 3;
			this._checkSize(i);
			var r = Math.pow(2, e - 1) - 1,
				i = this._readBitsOnly(t + e, 1, n),
				e = this._readBitsOnly(t, e, n),
				o = 0,
				s = 2,
				c = 0;
			do {
				for (
					var a = this._readByteOnly(++c, n),
						l = t % 8 || 8,
						h = 1 << l;
					(h >>= 1);

				)
					a & h && (o += 1 / s), (s *= 2);
			} while ((t -= l));
			return (
				(this._currentByte += n),
				e === 1 + (r << 1)
					? o
						? NaN
						: i
						? -1 / 0
						: 1 / 0
					: (1 + -2 * i) *
					  (e || o
							? e
								? Math.pow(2, e - r) * (1 + o)
								: Math.pow(2, 1 - r) * o
							: 0)
			);
		},
		_readBitsOnly: function (t, e, i) {
			var n = (t + e) % 8,
				r = t % 8,
				o = i - (t >> 3) - 1,
				s = i + (-(t + e) >> 3),
				c = o - s,
				a =
					(this._readByteOnly(o, i) >> r) &
					((1 << (c ? 8 - r : e)) - 1);
			for (
				c &&
				n &&
				(a +=
					(this._readByteOnly(s++, i) & ((1 << n) - 1)) <<
					((c-- << 3) - r));
				c;

			)
				a += this._shl(this._readByteOnly(s++, i), (c-- << 3) - r);
			return a;
		},
		_readByteOnly: function (t, e) {
			return this._data[this._currentByte + e - t - 1];
		},
		_shl: function (t, e) {
			for (
				++e;
				--e;
				t =
					1073741824 == (1073741824 & (t %= 2147483648))
						? 2 * t
						: 2 * (t - 1073741824) + 2147483647 + 1
			);
			return t;
		},
		_checkSize: function (t) {
			if (!(this._currentByte + Math.ceil(t / 8) < this._data.length))
				throw new Error('Index out of bound');
		},
		readCachedString: function () {
			return this._stringCache[this.readInt(!1)];
		},
		isJSControlled: function () {
			return this._jsControlled;
		},
		getOwnerCallbackNames: function () {
			return this._ownerCallbackNames;
		},
		getOwnerCallbackNodes: function () {
			return this._ownerCallbackNodes;
		},
		getOwnerCallbackControlEvents: function () {
			return this._ownerCallbackEvents;
		},
		getOwnerOutletNames: function () {
			return this._ownerOutletNames;
		},
		getOwnerOutletNodes: function () {
			return this._ownerOutletNodes;
		},
		getNodesWithAnimationManagers: function () {
			return this._nodesWithAnimationManagers;
		},
		getAnimationManagersForNodes: function () {
			return this._animationManagerForNodes;
		},
		getAnimationManagers: function () {
			return this._animationManagers;
		},
		setAnimationManagers: function (t) {
			this._animationManagers = t;
		},
		addOwnerCallbackName: function (t) {
			this._ownerCallbackNames.push(t);
		},
		addOwnerCallbackNode: function (t) {
			this._ownerCallbackNodes.push(t);
		},
		addOwnerCallbackControlEvents: function (t) {
			this._ownerCallbackEvents.push(t);
		},
		addDocumentCallbackName: function (t) {
			this._animationManager.addDocumentCallbackName(t);
		},
		addDocumentCallbackNode: function (t) {
			this._animationManager.addDocumentCallbackNode(t);
		},
		addDocumentCallbackControlEvents: function (t) {
			this._animationManager.addDocumentCallbackControlEvents(t);
		},
		readFileWithCleanUp: function (t) {
			if (!this._readHeader()) return null;
			if (!this._readStringCache()) return null;
			if (!this._readSequences()) return null;
			var e = this._readNodeGraph();
			return (
				this._animationManagers.setObject(this._animationManager, e),
				t && this._cleanUpNodeGraph(e),
				e
			);
		},
		addOwnerOutletName: function (t) {
			this._ownerOutletNames.push(t);
		},
		addOwnerOutletNode: function (t) {
			null != t && this._ownerOutletNodes.push(t);
		},
		_cleanUpNodeGraph: function (t) {
			t.userObject = null;
			for (var e = t.getChildren(), i = 0, n = e.length; i < n; i++)
				this._cleanUpNodeGraph(e[i]);
		},
		_readCallbackKeyframesForSeq: function (t) {
			var e = this.readInt(!1);
			if (!e) return !0;
			for (
				var i = new cc.BuilderSequenceProperty(),
					n = this._jsControlled,
					r = this._animationManager,
					o = i.getKeyframes(),
					s = 0;
				s < e;
				s++
			) {
				var c = this.readFloat(),
					a = this.readCachedString(),
					l = this.readInt(!1),
					h = [a, l],
					u = new cc.BuilderKeyframe();
				u.setTime(c),
					u.setValue(h),
					n && r.getKeyframeCallbacks().push(l + ':' + a),
					o.push(u);
			}
			return t.setCallbackChannel(i), !0;
		},
		_readSoundKeyframesForSeq: function (t) {
			var e = this.readInt(!1);
			if (!e) return !0;
			for (
				var i = new cc.BuilderSequenceProperty(),
					n = i.getKeyframes(),
					r = 0;
				r < e;
				r++
			) {
				var o = this.readFloat(),
					s = [
						this.readCachedString(),
						this.readFloat(),
						this.readFloat(),
						this.readFloat(),
					],
					c = new cc.BuilderKeyframe();
				c.setTime(o), c.setValue(s), n.push(c);
			}
			return t.setSoundChannel(i), !0;
		},
		_readSequences: function () {
			for (
				var t = this._animationManager.getSequences(),
					e = this.readInt(!1),
					i = 0;
				i < e;
				i++
			) {
				var n = new cc.BuilderSequence();
				if (
					(n.setDuration(this.readFloat()),
					n.setName(this.readCachedString()),
					n.setSequenceId(this.readInt(!1)),
					n.setChainedSequenceId(this.readInt(!0)),
					!this._readCallbackKeyframesForSeq(n))
				)
					return !1;
				if (!this._readSoundKeyframesForSeq(n)) return !1;
				t.push(n);
			}
			return (
				this._animationManager.setAutoPlaySequenceId(this.readInt(!0)),
				!0
			);
		},
		readKeyframe: function (t) {
			var e = new cc.BuilderKeyframe();
			e.setTime(this.readFloat());
			var i,
				n,
				r = this.readInt(!1),
				o = 0,
				s = null;
			return (
				(r !== CCB_KEYFRAME_EASING_CUBIC_IN &&
					r !== CCB_KEYFRAME_EASING_CUBIC_OUT &&
					r !== CCB_KEYFRAME_EASING_CUBIC_INOUT &&
					r !== CCB_KEYFRAME_EASING_ELASTIC_IN &&
					r !== CCB_KEYFRAME_EASING_ELASTIC_OUT &&
					r !== CCB_KEYFRAME_EASING_ELASTIC_INOUT) ||
					(o = this.readFloat()),
				e.setEasingType(r),
				e.setEasingOpt(o),
				t === CCB_PROPTYPE_CHECK
					? (s = this.readBool())
					: t === CCB_PROPTYPE_BYTE
					? (s = this.readByte())
					: t === CCB_PROPTYPE_COLOR3
					? ((i = cc.color(
							this.readByte(),
							this.readByte(),
							this.readByte()
					  )),
					  (s = cc.Color3BWapper.create(i)))
					: t === CCB_PROPTYPE_FLOATXY
					? (s = [this.readFloat(), this.readFloat()])
					: t === CCB_PROPTYPE_DEGREES
					? (s = this.readFloat())
					: t === CCB_PROPTYPE_SCALELOCK ||
					  t === CCB_PROPTYPE_POSITION ||
					  t === CCB_PROPTYPE_FLOATXY
					? (s = [this.readFloat(), this.readFloat()])
					: t === CCB_PROPTYPE_SPRITEFRAME &&
					  ((o = this.readCachedString()),
					  (i = this.readCachedString()),
					  (s =
							'' === o
								? ((i = this._ccbRootPath + i),
								  (n = (t =
										cc.textureCache.addImage(
											i
										)).getContentSize()),
								  (n = cc.rect(0, 0, n.width, n.height)),
								  new cc.SpriteFrame(t, n))
								: ((o = this._ccbRootPath + o),
								  (n = cc.spriteFrameCache),
								  -1 === this._loadedSpriteSheets.indexOf(o) &&
										(n.addSpriteFrames(o),
										this._loadedSpriteSheets.push(o)),
								  n.getSpriteFrame(i)))),
				e.setValue(s),
				e
			);
		},
		_readHeader: function () {
			if (!this._data) return !1;
			var t = this._readStringFromBytes(this._currentByte, 4, !0);
			if (((this._currentByte += 4), 'ccbi' !== t)) return !1;
			t = this.readInt(!1);
			return t !== CCB_VERSION
				? (cc.log(
						'WARNING! Incompatible ccbi file version (file: ' +
							t +
							' reader: ' +
							CCB_VERSION +
							')'
				  ),
				  !1)
				: ((this._jsControlled = this.readBool()),
				  (this._animationManager._jsControlled = this._jsControlled),
				  !0);
		},
		_readStringFromBytes: function (t, e, i) {
			i = i || !1;
			var n,
				r = '',
				o = this._data,
				s = this._currentByte;
			if (i)
				for (n = e - 1; 0 <= n; n--) r += String.fromCharCode(o[s + n]);
			else for (n = 0; n < e; n++) r += String.fromCharCode(o[s + n]);
			return r;
		},
		_readStringCache: function () {
			for (var t = this.readInt(!1), e = 0; e < t; e++)
				this._readStringCacheEntry();
			return !0;
		},
		_readStringCacheEntry: function () {
			for (
				var t = (this.readByte() << 8) | this.readByte(),
					e = '',
					i = this._data,
					n = this._currentByte,
					r = 0;
				r < t;
				r++
			) {
				var o = i[n + r].toString('16').toUpperCase();
				e += '%' + (o = 1 < o.length ? o : '0' + o);
			}
			(e = decodeURIComponent(e)),
				(this._currentByte += t),
				this._stringCache.push(e);
		},
		_readNodeGraph: function (t) {
			var e = this.readCachedString(),
				i = this._jsControlled,
				n = this._animationManager;
			i && (T = this.readCachedString());
			var r,
				o = this.readInt(!1);
			o !== CCB_TARGETTYPE_NONE && (r = this.readCachedString());
			var e = this._ccNodeLoaderLibrary.getCCNodeLoader(e),
				s = (e =
					e ||
					this._ccNodeLoaderLibrary.getCCNodeLoader(
						'CCNode'
					)).loadCCNode(t, this);
			n.getRootNode() || n.setRootNode(s),
				i && s === n.getRootNode() && n.setDocumentControllerName(T);
			var c = new cc._Dictionary();
			this._animatedProps = [];
			var a = this._animatedProps,
				l = this.readInt(!1);
			for (E = 0; E < l; ++E) {
				for (
					var h = this.readInt(!1),
						u = new cc._Dictionary(),
						_ = this.readInt(!1),
						d = 0;
					d < _;
					++d
				) {
					var p = new cc.BuilderSequenceProperty();
					p.setName(this.readCachedString()),
						p.setType(this.readInt(!1)),
						a.push(p.getName());
					for (
						var f = this.readInt(!1), m = p.getKeyframes(), g = 0;
						g < f;
						++g
					) {
						var y = this.readKeyframe(p.getType());
						m.push(y);
					}
					u.setObject(p, p.getName());
				}
				c.setObject(u, h);
			}
			0 < c.count() && n.addNode(s, c), e.parseProperties(s, t, this);
			var T = s instanceof cc.BuilderFile;
			T &&
				((t = s.getCCBFileNode()).setPosition(s.getPosition()),
				t.setRotation(s.getRotation()),
				t.setScaleX(s.getScaleX()),
				t.setScaleY(s.getScaleY()),
				t.setTag(s.getTag()),
				t.setVisible(!0),
				n.moveAnimationsFromNode(s, t),
				s.setCCBFileNode(null),
				(s = t));
			var S = null,
				C = null;
			if (
				(o !== CCB_TARGETTYPE_NONE &&
					(i
						? o === CCB_TARGETTYPE_DOCUMENTROOT
							? (n.addDocumentOutletName(r),
							  n.addDocumentOutletNode(s))
							: (this._ownerOutletNames.push(r),
							  this._ownerOutletNodes.push(s))
						: (o === CCB_TARGETTYPE_DOCUMENTROOT
								? (S = n.getRootNode())
								: o === CCB_TARGETTYPE_OWNER &&
								  (S = this._owner),
						  S ||
								((o = !1),
								S.onAssignCCBMemberVariable &&
									(o = S.onAssignCCBMemberVariable(S, r, s)),
								(C = this._ccbMemberVariableAssigner),
								!o &&
									null != C &&
									C.onAssignCCBMemberVariable &&
									C.onAssignCCBMemberVariable(S, r, s)))),
				0 < e.getCustomProperties().length)
			)
				if (
					!i &&
					null != (S = s) &&
					null != S.onAssignCCBCustomProperty
				)
					for (
						var x = e.getCustomProperties(), v = x.allKeys(), E = 0;
						E < v.length;
						E++
					) {
						var A = x.objectForKey(v[E]),
							b = S.onAssignCCBCustomProperty(S, v[E], A),
							C = this._ccbMemberVariableAssigner;
						b ||
							null == C ||
							null == C.onAssignCCBCustomProperty ||
							C.onAssignCCBCustomProperty(S, v[E], A);
					}
			this._animatedProps = null;
			var R = this.readInt(!1);
			for (E = 0; E < R; E++) {
				var P = this._readNodeGraph(s);
				s.addChild(P);
			}
			return (
				T ||
					(null != s && s.onNodeLoaded
						? s.onNodeLoaded(s, e)
						: null != this._ccNodeLoaderListener &&
						  this._ccNodeLoaderListener.onNodeLoaded(s, e)),
				s
			);
		},
		_getBit: function () {
			var t =
				0 != (this._data[this._currentByte] & (1 << this._currentBit));
			if (
				(this._currentBit++,
				8 <= this._currentBit &&
					((this._currentBit = 0),
					this._currentByte++,
					this._currentByte > this._data.length))
			)
				throw new Error('out of the data bound');
			return t;
		},
		_alignBits: function () {
			this._currentBit && ((this._currentBit = 0), this._currentByte++);
		},
		_readUTF8: function () {},
	})),
	(cc.BuilderReader._ccbResolutionScale = 1),
	(cc.BuilderReader.setResolutionScale = function (t) {
		cc.BuilderReader._ccbResolutionScale = t;
	}),
	(cc.BuilderReader.getResolutionScale = function () {
		return cc.BuilderReader._ccbResolutionScale;
	}),
	(cc.BuilderReader.loadAsScene = function (t, e, i, n) {
		n = n || cc.BuilderReader.getResourcePath();
		(i = cc.BuilderReader.load(t, e, i, n)), (n = new cc.Scene());
		return n.addChild(i), n;
	}),
	(cc.BuilderReader._controllerClassCache = {}),
	(cc.BuilderReader.registerController = function (t, e) {
		cc.BuilderReader._controllerClassCache[t] = cc.Class.extend(e);
	}),
	(cc.BuilderReader.load = function (t, e, i, n) {
		n = n || cc.BuilderReader.getResourcePath();
		var r = new cc.BuilderReader(
			cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary()
		);
		r.setCCBRootPath(n),
			(t.length < 5 ||
				t.toLowerCase().lastIndexOf('.ccbi') !== t.length - 5) &&
				(t += '.ccbi');
		var o,
			s,
			c,
			a,
			l,
			i = r.readNodeGraphFromFile(t, e, i);
		if (e) {
			for (
				var h = r.getOwnerCallbackNames(),
					u = r.getOwnerCallbackNodes(),
					_ = r.getOwnerCallbackControlEvents(),
					d = 0;
				d < h.length;
				d++
			)
				(o = h[d]),
					(s = u[d]),
					(c = _[d]),
					s instanceof cc.ControlButton
						? s.addTargetWithActionForControlEvents(e, e[o], c)
						: s.setCallback(e[o], e);
			var p = r.getOwnerOutletNames(),
				f = r.getOwnerOutletNodes();
			for (d = 0; d < p.length; d++) (a = p[d]), (l = f[d]), (e[a] = l);
		}
		var m = r.getNodesWithAnimationManagers(),
			g = r.getAnimationManagersForNodes();
		if (!m || !g) return i;
		var y = cc.BuilderReader._controllerClassCache;
		for (d = 0; d < m.length; d++) {
			var T = m[d],
				S = g[d],
				C = (T.animationManager = S).getDocumentControllerName();
			if (C) {
				var x = y[C];
				if (!x) throw new Error('Can not find controller : ' + C);
				var v = new x();
				(v.controllerName = C), ((T.controller = v).rootNode = T);
				for (
					var E = S.getDocumentCallbackNames(),
						A = S.getDocumentCallbackNodes(),
						b = S.getDocumentCallbackControlEvents(),
						R = 0;
					R < E.length;
					R++
				)
					(o = E[R]),
						(s = A[R]),
						(c = b[R]),
						s instanceof cc.ControlButton
							? s.addTargetWithActionForControlEvents(v, v[o], c)
							: s.setCallback(v[o], v);
				var P = S.getDocumentOutletNames(),
					I = S.getDocumentOutletNodes();
				for (R = 0; R < P.length; R++)
					(a = P[R]), (l = I[R]), (v[a] = l);
				v.onDidLoadFromCCB &&
					cc.isFunction(v.onDidLoadFromCCB) &&
					v.onDidLoadFromCCB();
				var w = S.getKeyframeCallbacks();
				for (R = 0; R < w.length; R++) {
					var D = w[R].split(':'),
						L = D[0],
						D = D[1];
					1 == L
						? S.setCallFunc(cc.callFunc(v[D], v), w[R])
						: 2 == L &&
						  e &&
						  S.setCallFunc(cc.callFunc(e[D], e), w[R]);
				}
			}
		}
		return S.runAnimations(S.getAutoPlaySequenceId(), 0), i;
	}),
	(cc.BuilderReader._resourcePath = ''),
	(cc.BuilderReader.setResourcePath = function (t) {
		cc.BuilderReader._resourcePath = t;
	}),
	(cc.BuilderReader.getResourcePath = function () {
		return cc.BuilderReader._resourcePath;
	}),
	(cc.BuilderReader.lastPathComponent = function (t) {
		var e = t.lastIndexOf('/');
		return -1 !== e ? t.substring(e + 1, t.length - e) : t;
	}),
	(cc.BuilderReader.deletePathExtension = function (t) {
		var e = t.lastIndexOf('.');
		return -1 !== e ? t.substring(0, e) : t;
	}),
	(cc.BuilderReader.toLowerCase = function (t) {
		return t.toLowerCase();
	}),
	(cc.BuilderReader.endsWith = function (t, e) {
		return t.length >= e.length && 0 === t.lastIndexOf(e);
	}),
	(cc.BuilderReader.concat = function (t, e) {
		return t + e;
	}),
	cc.loader.register(['ccbi'], cc._binaryLoader),
	(cc.INT_VALUE = 0),
	(cc.FLOAT_VALUE = 1),
	(cc.POINTER_VALUE = 2),
	(cc.BOOL_VALUE = 3),
	(cc.UNSIGNEDCHAR_VALUE = 4),
	(cc.Color3BWapper = cc.Class.extend({
		_color: null,
		ctor: function () {
			this._color = cc.color(0, 0, 0);
		},
		getColor: function () {
			return this._color;
		},
	})),
	(cc.Color3BWapper.create = function (t) {
		var e = new cc.Color3BWapper();
		return (
			e && ((e._color.r = t.r), (e._color.g = t.g), (e._color.b = t.b)), e
		);
	}),
	(cc.BuilderValue = cc.Class.extend({
		_value: null,
		_type: 0,
		getIntValue: function () {},
		getFloatValue: function () {},
		getBoolValue: function () {},
		getByteValue: function () {},
		getPointer: function () {},
		getValue: function () {
			return this._value;
		},
	})),
	(cc.BuilderValue.create = function (t) {
		return new cc.BuilderValue();
	}),
	(cc.BuilderKeyframe = cc.Class.extend({
		_value: null,
		_time: 0,
		_easingType: 0,
		_easingOpt: 0,
		getValue: function () {
			return this._value;
		},
		setValue: function (t) {
			this._value = t;
		},
		getTime: function () {
			return this._time;
		},
		setTime: function (t) {
			this._time = t;
		},
		getEasingType: function () {
			return this._easingType;
		},
		setEasingType: function (t) {
			this._easingType = t;
		},
		getEasingOpt: function () {
			return this._easingOpt;
		},
		setEasingOpt: function (t) {
			this._easingOpt = t;
		},
	})),
	(cc.BuilderSequence = cc.Class.extend({
		_duration: 0,
		_name: '',
		_sequenceId: 0,
		_chainedSequenceId: 0,
		_callbackChannel: null,
		_soundChannel: null,
		ctor: function () {
			this._name = '';
		},
		getDuration: function () {
			return this._duration;
		},
		setDuration: function (t) {
			this._duration = t;
		},
		getName: function () {
			return this._name;
		},
		setName: function (t) {
			this._name = t;
		},
		getSequenceId: function () {
			return this._sequenceId;
		},
		setSequenceId: function (t) {
			this._sequenceId = t;
		},
		getChainedSequenceId: function () {
			return this._chainedSequenceId;
		},
		setChainedSequenceId: function (t) {
			this._chainedSequenceId = t;
		},
		getCallbackChannel: function () {
			return this._callbackChannel;
		},
		setCallbackChannel: function (t) {
			this._callbackChannel = t;
		},
		getSoundChannel: function () {
			return this._soundChannel;
		},
		setSoundChannel: function (t) {
			this._soundChannel = t;
		},
	})),
	(cc.BuilderSequenceProperty = cc.Class.extend({
		_name: null,
		_type: 0,
		_keyFrames: null,
		ctor: function () {
			this.init();
		},
		init: function () {
			(this._keyFrames = []), (this._name = '');
		},
		getName: function () {
			return this._name;
		},
		setName: function (t) {
			this._name = t;
		},
		getType: function () {
			return this._type;
		},
		setType: function (t) {
			this._type = t;
		},
		getKeyframes: function () {
			return this._keyFrames;
		},
	})),
	(cc.getAbsolutePosition = function (t, e, i, n) {
		var r = cc.p(0, 0);
		return (
			e === CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT
				? (r = t)
				: e === CCB_POSITIONTYPE_RELATIVE_TOP_LEFT
				? ((r.x = t.x), (r.y = i.height - t.y))
				: e === CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT
				? ((r.x = i.width - t.x), (r.y = i.height - t.y))
				: e === CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT
				? ((r.x = i.width - t.x), (r.y = t.y))
				: e === CCB_POSITIONTYPE_PERCENT
				? ((r.x = (i.width * t.x) / 100),
				  (r.y = (i.height * t.y) / 100))
				: e === CCB_POSITIONTYPE_MULTIPLY_RESOLUTION &&
				  ((e = cc.BuilderReader.getResolutionScale()),
				  (r.x = t.x * e),
				  (r.y = t.y * e)),
			r
		);
	}),
	(cc._getAbsolutePosition = function (t, e, i, n, r) {
		var o = cc.p(0, 0);
		return (
			i === CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT
				? ((o.x = t), (o.y = e))
				: i === CCB_POSITIONTYPE_RELATIVE_TOP_LEFT
				? ((o.x = t), (o.y = n.height - e))
				: i === CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT
				? ((o.x = n.width - t), (o.y = n.height - e))
				: i === CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT
				? ((o.x = n.width - t), (o.y = e))
				: i === CCB_POSITIONTYPE_PERCENT
				? ((o.x = (n.width * t) / 100), (o.y = (n.height * e) / 100))
				: i === CCB_POSITIONTYPE_MULTIPLY_RESOLUTION &&
				  ((i = cc.BuilderReader.getResolutionScale()),
				  (o.x = t * i),
				  (o.y = e * i)),
			o
		);
	}),
	(cc.setRelativeScale = function (t, e, i, n, r) {
		if (!t)
			throw new Error('cc.setRelativeScale(): node should be non-null');
		n === CCB_POSITIONTYPE_MULTIPLY_RESOLUTION &&
			((e *= n = cc.BuilderReader.getResolutionScale()), (i *= n)),
			t.setScaleX(e),
			t.setScaleY(i);
	}),
	(cc.BuilderAnimationManagerDelegate = cc.Class.extend({
		completedAnimationSequenceNamed: function (t) {},
	})),
	(cc.BuilderAnimationManager = cc.Class.extend({
		_sequences: null,
		_nodeSequences: null,
		_baseValues: null,
		_autoPlaySequenceId: 0,
		_rootNode: null,
		_owner: null,
		_rootContainerSize: null,
		_delegate: null,
		_runningSequence: null,
		_documentOutletNames: null,
		_documentOutletNodes: null,
		_documentCallbackNames: null,
		_documentCallbackNodes: null,
		_documentCallbackControlEvents: null,
		_documentControllerName: '',
		_lastCompletedSequenceName: '',
		_keyframeCallbacks: null,
		_keyframeCallFuncs: null,
		_animationCompleteCallbackFunc: null,
		_target: null,
		_jsControlled: !1,
		ctor: function () {
			(this._rootContainerSize = cc.size(0, 0)), this.init();
		},
		init: function () {
			return (
				(this._sequences = []),
				(this._nodeSequences = new cc._Dictionary()),
				(this._baseValues = new cc._Dictionary()),
				(this._documentOutletNames = []),
				(this._documentOutletNodes = []),
				(this._documentCallbackNames = []),
				(this._documentCallbackNodes = []),
				(this._documentCallbackControlEvents = []),
				(this._keyframeCallbacks = []),
				(this._keyframeCallFuncs = {}),
				!0
			);
		},
		getSequences: function () {
			return this._sequences;
		},
		setSequences: function (t) {
			this._sequences = t;
		},
		getAutoPlaySequenceId: function () {
			return this._autoPlaySequenceId;
		},
		setAutoPlaySequenceId: function (t) {
			this._autoPlaySequenceId = t;
		},
		getRootNode: function () {
			return this._rootNode;
		},
		setRootNode: function (t) {
			this._rootNode = t;
		},
		getOwner: function () {
			return this._owner;
		},
		setOwner: function (t) {
			this._owner = t;
		},
		addDocumentCallbackNode: function (t) {
			this._documentCallbackNodes.push(t);
		},
		addDocumentCallbackName: function (t) {
			this._documentCallbackNames.push(t);
		},
		addDocumentCallbackControlEvents: function (t) {
			this._documentCallbackControlEvents.push(t);
		},
		addDocumentOutletNode: function (t) {
			this._documentOutletNodes.push(t);
		},
		addDocumentOutletName: function (t) {
			this._documentOutletNames.push(t);
		},
		setDocumentControllerName: function (t) {
			this._documentControllerName = t;
		},
		getDocumentControllerName: function () {
			return this._documentControllerName;
		},
		getDocumentCallbackNames: function () {
			return this._documentCallbackNames;
		},
		getDocumentCallbackNodes: function () {
			return this._documentCallbackNodes;
		},
		getDocumentCallbackControlEvents: function () {
			return this._documentCallbackControlEvents;
		},
		getDocumentOutletNames: function () {
			return this._documentOutletNames;
		},
		getDocumentOutletNodes: function () {
			return this._documentOutletNodes;
		},
		getLastCompletedSequenceName: function () {
			return this._lastCompletedSequenceName;
		},
		getKeyframeCallbacks: function () {
			return this._keyframeCallbacks;
		},
		getRootContainerSize: function () {
			return this._rootContainerSize;
		},
		setRootContainerSize: function (t) {
			this._rootContainerSize = cc.size(t.width, t.height);
		},
		getDelegate: function () {
			return this._delegate;
		},
		setDelegate: function (t) {
			this._delegate = t;
		},
		getRunningSequenceName: function () {
			return this._runningSequence
				? this._runningSequence.getName()
				: null;
		},
		getContainerSize: function (t) {
			return t ? t.getContentSize() : this._rootContainerSize;
		},
		addNode: function (t, e) {
			this._nodeSequences.setObject(e, t);
		},
		setBaseValue: function (t, e, i) {
			var n = this._baseValues.objectForKey(e);
			n || ((n = new cc._Dictionary()), this._baseValues.setObject(n, e)),
				n.setObject(t, i);
		},
		moveAnimationsFromNode: function (t, e) {
			var i = this._baseValues,
				n = i.objectForKey(t);
			null !== n && (i.setObject(n, e), i.removeObjectForKey(t));
			(n = this._nodeSequences), (i = n.objectForKey(t));
			null != i && (n.setObject(i, e), n.removeObjectForKey(t));
		},
		getActionForCallbackChannel: function (t) {
			for (
				var e = 0, i = [], n = t.getKeyframes(), r = n.length, o = 0;
				o < r;
				++o
			) {
				var s = n[o],
					c = s.getTime() - e,
					e = s.getTime();
				0 < c && i.push(cc.delayTime(c));
				var a,
					l = s.getValue(),
					c = l[0],
					s = l[1];
				this._jsControlled
					? ((l = s + ':' + c),
					  null != (l = this._keyframeCallFuncs[l]) && i.push(l))
					: (s === CCB_TARGETTYPE_DOCUMENTROOT
							? (a = this._rootNode)
							: s === CCB_TARGETTYPE_OWNER && (a = this._owner),
					  null != a &&
							(0 < c.length
								? ((s = 0),
								  null != a.onResolveCCBCCCallFuncSelector &&
										(s = a.onResolveCCBCCCallFuncSelector(
											a,
											c
										)),
								  0 === s
										? cc.log(
												"Skipping selector '" +
													c +
													"' since no CCBSelectorResolver is present."
										  )
										: i.push(cc.callFunc(s, a)))
								: cc.log('Unexpected empty selector.')));
			}
			return i.length < 1 ? null : cc.sequence(i);
		},
		getActionForSoundChannel: function (t) {
			for (
				var e = 0, i = [], n = t.getKeyframes(), r = n.length, o = 0;
				o < r;
				++o
			) {
				var s = n[o],
					c = s.getTime() - e,
					e = s.getTime();
				0 < c && i.push(cc.delayTime(c));
				var a = s.getValue(),
					l = cc.BuilderReader.getResourcePath() + a[0],
					c = parseFloat(a[1]),
					s = parseFloat(a[2]),
					a = parseFloat(a[3]);
				i.push(cc.BuilderSoundEffect.create(l, c, s, a));
			}
			return i.length < 1 ? null : cc.sequence(i);
		},
		runAnimationsForSequenceNamed: function (t) {
			this.runAnimationsForSequenceIdTweenDuration(
				this._getSequenceId(t),
				0
			);
		},
		runAnimationsForSequenceNamedTweenDuration: function (t, e) {
			this.runAnimationsForSequenceIdTweenDuration(
				this._getSequenceId(t),
				e
			);
		},
		runAnimationsForSequenceIdTweenDuration: function (t, e) {
			if (-1 === t)
				throw new Error(
					'cc.BuilderAnimationManager.runAnimationsForSequenceIdTweenDuration(): Sequence id should not be -1'
				);
			(e = e || 0), this._rootNode.stopAllActions();
			for (
				var i = this._nodeSequences.allKeys(), n = 0, r = i.length;
				n < r;
				n++
			) {
				var o = i[n];
				o.stopAllActions();
				var s = this._nodeSequences.objectForKey(o).objectForKey(t),
					c = [];
				if (s)
					for (var a = s.allKeys(), l = 0; l < a.length; l++) {
						var h = a[l],
							u = s.objectForKey(h);
						c.push(h),
							this._setFirstFrame(o, u, e),
							this._runAction(o, u, e);
					}
				var _ = this._baseValues.objectForKey(o);
				if (_) {
					var d = _.allKeys();
					for (l = 0; l < d.length; l++) {
						var p,
							f = d[l];
						-1 !== c.indexOf(f) ||
							(null != (p = _.objectForKey(f)) &&
								this._setAnimatedProperty(f, o, p, e));
					}
				}
			}
			var m,
				g = this._getSequence(t),
				y = cc.sequence(
					cc.delayTime(g.getDuration() + e),
					cc.callFunc(this._sequenceCompleted, this)
				);
			this._rootNode.runAction(y),
				g.getCallbackChannel() &&
					(m = this.getActionForCallbackChannel(
						g.getCallbackChannel()
					)) &&
					this._rootNode.runAction(m),
				g.getSoundChannel() &&
					(m = this.getActionForSoundChannel(g.getSoundChannel())) &&
					this._rootNode.runAction(m),
				(this._runningSequence = this._getSequence(t));
		},
		runAnimations: function (t, e) {
			(e = e || 0),
				(t = cc.isString(t) ? this._getSequenceId(t) : t),
				this.runAnimationsForSequenceIdTweenDuration(t, e);
		},
		setAnimationCompletedCallback: function (t, e) {
			(this._target = t), (this._animationCompleteCallbackFunc = e);
		},
		setCompletedAnimationCallback: function (t, e) {
			this.setAnimationCompletedCallback(t, e);
		},
		setCallFunc: function (t, e) {
			this._keyframeCallFuncs[e] = t;
		},
		debug: function () {},
		_getBaseValue: function (t, e) {
			t = this._baseValues.objectForKey(t);
			return t ? t.objectForKey(e) : null;
		},
		_getSequenceId: function (t) {
			for (
				var e = null, i = this._sequences, n = 0, r = i.length;
				n < r;
				n++
			)
				if ((e = i[n]) && e.getName() === t) return e.getSequenceId();
			return -1;
		},
		_getSequence: function (t) {
			for (
				var e = null, i = this._sequences, n = 0, r = i.length;
				n < r;
				n++
			)
				if ((e = i[n]) && e.getSequenceId() === t) return e;
			return null;
		},
		_getAction: function (t, e, i, n) {
			t = e.getTime() - (t ? t.getTime() : 0);
			if ('rotation' === i)
				return cc.BuilderRotateTo.create(t, e.getValue());
			if ('rotationX' === i)
				return cc.BuilderRotateXTo.create(t, e.getValue());
			if ('rotationY' === i)
				return cc.BuilderRotateYTo.create(t, e.getValue());
			if ('opacity' === i) return cc.fadeTo(t, e.getValue());
			if ('color' === i) {
				var r = e.getValue().getColor();
				return cc.tintTo(t, r.r, r.g, r.b);
			}
			if ('visible' === i)
				return e.getValue()
					? cc.sequence(cc.delayTime(t), cc.show())
					: cc.sequence(cc.delayTime(t), cc.hide());
			if ('displayFrame' === i)
				return cc.sequence(
					cc.delayTime(t),
					cc.BuilderSetSpriteFrame.create(e.getValue())
				);
			if ('position' === i) {
				(s = this._getBaseValue(n, i)[2]),
					(c = (o = e.getValue())[0]),
					(a = o[1]);
				(r = this.getContainerSize(n.getParent())),
					(r = cc._getAbsolutePosition(c, a, s, r, i));
				return cc.moveTo(t, r);
			}
			if ('scale' !== i)
				return 'skew' === i
					? ((c = (o = e.getValue())[0]),
					  (a = o[1]),
					  cc.skewTo(t, c, a))
					: (cc.log(
							'BuilderReader: Failed to create animation for property: ' +
								i
					  ),
					  null);
			var o,
				s = this._getBaseValue(n, i)[2],
				c = (o = e.getValue())[0],
				a = o[1];
			return (
				s === CCB_SCALETYPE_MULTIPLY_RESOLUTION &&
					((c *= s = cc.BuilderReader.getResolutionScale()),
					(a *= s)),
				cc.scaleTo(t, c, a)
			);
		},
		_setAnimatedProperty: function (t, e, i, n) {
			var r, o, s, c;
			0 < n
				? ((r = new cc.BuilderKeyframe()).setValue(i),
				  r.setTime(n),
				  r.setEasingType(CCB_KEYFRAME_EASING_LINEAR),
				  (r = this._getAction(null, r, t, e)),
				  e.runAction(r))
				: 'position' === t
				? ((o = this._getBaseValue(e, t)[2]),
				  (s = i[0]),
				  (c = i[1]),
				  e.setPosition(
						cc._getAbsolutePosition(
							s,
							c,
							o,
							this.getContainerSize(e.getParent()),
							t
						)
				  ))
				: 'scale' === t
				? ((o = this._getBaseValue(e, t)[2]),
				  (s = i[0]),
				  (c = i[1]),
				  cc.setRelativeScale(e, s, c, o, t))
				: 'skew' === t
				? ((s = i[0]), (c = i[1]), e.setSkewX(s), e.setSkewY(c))
				: 'rotation' === t
				? e.setRotation(i)
				: 'rotationX' === t
				? e.setRotationSkewX(i)
				: 'rotationY' === t
				? e.setRotationSkewY(i)
				: 'opacity' === t
				? e.setOpacity(i)
				: 'displayFrame' === t
				? e.setSpriteFrame(i)
				: 'color' === t
				? (255 === (c = i.getColor()).r &&
						255 === c.g &&
						255 === c.b) ||
				  e.setColor(c)
				: 'visible' === t
				? ((i = i || !1), e.setVisible(i))
				: cc.log('unsupported property name is ' + t);
		},
		_setFirstFrame: function (t, e, i) {
			var n,
				r = e.getKeyframes();
			0 === r.length
				? ((n = this._getBaseValue(t, e.getName())) ||
						cc.log(
							'cc.BuilderAnimationManager._setFirstFrame(): No baseValue found for property'
						),
				  this._setAnimatedProperty(e.getName(), t, n, i))
				: ((r = r[0]),
				  this._setAnimatedProperty(e.getName(), t, r.getValue(), i));
		},
		_getEaseAction: function (t, e, i) {
			return e === CCB_KEYFRAME_EASING_LINEAR ||
				e === CCB_KEYFRAME_EASING_INSTANT
				? t
				: e === CCB_KEYFRAME_EASING_CUBIC_IN
				? t.easing(cc.easeIn(i))
				: e === CCB_KEYFRAME_EASING_CUBIC_OUT
				? t.easing(cc.easeOut(i))
				: e === CCB_KEYFRAME_EASING_CUBIC_INOUT
				? t.easing(cc.easeInOut(i))
				: e === CCB_KEYFRAME_EASING_BACK_IN
				? t.easing(cc.easeBackIn())
				: e === CCB_KEYFRAME_EASING_BACK_OUT
				? t.easing(cc.easeBackOut())
				: e === CCB_KEYFRAME_EASING_BACK_INOUT
				? t.easing(cc.easeBackInOut())
				: e === CCB_KEYFRAME_EASING_BOUNCE_IN
				? t.easing(cc.easeBounceIn())
				: e === CCB_KEYFRAME_EASING_BOUNCE_OUT
				? t.easing(cc.easeBounceOut())
				: e === CCB_KEYFRAME_EASING_BOUNCE_INOUT
				? t.easing(cc.easeBounceInOut())
				: e === CCB_KEYFRAME_EASING_ELASTIC_IN
				? t.easing(cc.easeElasticIn(i))
				: e === CCB_KEYFRAME_EASING_ELASTIC_OUT
				? t.easing(cc.easeElasticOut(i))
				: e === CCB_KEYFRAME_EASING_ELASTIC_INOUT
				? t.easing(cc.easeElasticInOut(i))
				: (cc.log('BuilderReader: Unknown easing type ' + e), t);
		},
		_runAction: function (t, e, i) {
			var n = e.getKeyframes(),
				r = n.length;
			if (1 < r) {
				var o = [],
					i = n[0].getTime() + i;
				0 < i && o.push(cc.delayTime(i));
				for (var s = 0; s < r - 1; ++s) {
					var c = n[s],
						a = n[s + 1],
						a = this._getAction(c, a, e.getName(), t);
					a &&
						((a = this._getEaseAction(
							a,
							c.getEasingType(),
							c.getEasingOpt()
						)),
						o.push(a));
				}
				t.runAction(cc.sequence(o));
			}
		},
		_sequenceCompleted: function () {
			var t = this._runningSequence,
				e = t.getName();
			this._lastCompletedSequenceName != t.getName() &&
				(this._lastCompletedSequenceName = t.getName());
			t = t.getChainedSequenceId();
			(this._runningSequence = null),
				-1 !== t && this.runAnimations(t, 0),
				this._delegate &&
					this._delegate.completedAnimationSequenceNamed(e),
				this._target &&
					this._animationCompleteCallbackFunc &&
					this._animationCompleteCallbackFunc.call(this._target);
		},
	})),
	(cc.BuilderSetSpriteFrame = cc.ActionInstant.extend({
		_spriteFrame: null,
		initWithSpriteFrame: function (t) {
			return (this._spriteFrame = t), !0;
		},
		update: function (t) {
			this.target.setSpriteFrame(this._spriteFrame);
		},
	})),
	(cc.BuilderSetSpriteFrame.create = function (t) {
		var e = new cc.BuilderSetSpriteFrame();
		return e && e.initWithSpriteFrame(t) ? e : null;
	}),
	(cc.BuilderRotateTo = cc.ActionInterval.extend({
		_startAngle: 0,
		_dstAngle: 0,
		_diffAngle: 0,
		initWithDuration: function (t, e) {
			return (
				!!cc.ActionInterval.prototype.initWithDuration.call(this, t) &&
				((this._dstAngle = e), !0)
			);
		},
		update: function (t) {
			this.target.setRotation(this._startAngle + this._diffAngle * t);
		},
		startWithTarget: function (t) {
			cc.ActionInterval.prototype.startWithTarget.call(this, t),
				(this._startAngle = this.target.getRotation()),
				(this._diffAngle = this._dstAngle - this._startAngle);
		},
	})),
	(cc.BuilderRotateTo.create = function (t, e) {
		var i = new cc.BuilderRotateTo();
		return i && i.initWithDuration(t, e) ? i : null;
	}),
	(cc.BuilderRotateXTo = cc.ActionInterval.extend({})),
	(cc.BuilderRotateXTo.create = function (t, e) {
		throw new Error('rotationX has not been implemented in cocos2d-html5');
	}),
	(cc.BuilderRotateYTo = cc.ActionInterval.extend({})),
	(cc.BuilderRotateYTo.create = function (t, e) {
		throw new Error('rotationY has not been implemented in cocos2d-html5');
	}),
	(cc.BuilderSoundEffect = cc.ActionInstant.extend({
		init: function (t) {
			return (this._file = t), !0;
		},
		update: function (t) {
			cc.audioEngine.playEffect(this._file);
		},
	})),
	(cc.BuilderSoundEffect.create = function (t, e, i, n) {
		var r = new cc.BuilderSoundEffect();
		return r && r.init(t) ? r : null;
	}),
	(cc.DOM = {}),
	(cc.DOM._addMethods = function (t) {
		for (var e in cc.DOM.methods) t[e] = cc.DOM.methods[e];
		cc.defineGetterSetter(t, 'x', t.getPositionX, t.setPositionX),
			cc.defineGetterSetter(t, 'y', t.getPositionY, t.setPositionY),
			cc.defineGetterSetter(t, 'width', t._getWidth, t._setWidth),
			cc.defineGetterSetter(t, 'height', t._getHeight, t._setHeight),
			cc.defineGetterSetter(t, 'anchorX', t._getAnchorX, t._setAnchorX),
			cc.defineGetterSetter(t, 'anchorY', t._getAnchorY, t._setAnchorY),
			cc.defineGetterSetter(t, 'scale', t.getScale, t.setScale),
			cc.defineGetterSetter(t, 'scaleX', t.getScaleX, t.setScaleX),
			cc.defineGetterSetter(t, 'scaleY', t.getScaleY, t.setScaleY),
			cc.defineGetterSetter(t, 'rotation', t.getRotation, t.setRotation),
			cc.defineGetterSetter(t, 'skewX', t.getSkewX, t.setSkewX),
			cc.defineGetterSetter(t, 'skewY', t.getSkewY, t.setSkewY),
			cc.defineGetterSetter(t, 'visible', t.isVisible, t.setVisible),
			cc.defineGetterSetter(t, 'parent', t.getParent, t.setParent),
			cc.defineGetterSetter(t, 'opacity', t.getOpacity, t.setOpacity);
	}),
	(cc.DOM.methods = {
		setPosition: function (t, e) {
			void 0 === e
				? ((this._position.x = t.x), (this._position.y = t.y))
				: ((this._position.x = t), (this._position.y = e)),
				this.setNodeDirty(),
				this.dom.translates(this._position.x, -this._position.y);
		},
		setPositionY: function (t) {
			(this._position.y = t),
				this.setNodeDirty(),
				this.dom.translates(this._position.x, -this._position.y);
		},
		setPositionX: function (t) {
			(this._position.x = t),
				this.setNodeDirty(),
				this.dom.translates(this._position.x, -this._position.y);
		},
		setScale: function (t, e) {
			(this._scaleX = t),
				(this._scaleY = e || t),
				this.setNodeDirty(),
				this.dom.resize(this._scaleX, this._scaleY);
		},
		setScaleX: function (t) {
			(this._scaleX = t),
				this.setNodeDirty(),
				this.dom.resize(this._scaleX, this._scaleY);
		},
		setScaleY: function (t) {
			(this._scaleY = t),
				this.setNodeDirty(),
				this.dom.resize(this._scaleX, this._scaleY);
		},
		setAnchorPoint: function (t, e) {
			var i = this._renderCmd,
				n = this._anchorPoint;
			void 0 === e ? ((n.x = t.x), (n.y = t.y)) : ((n.x = t), (n.y = e));
			(e = i._anchorPointInPoints), (i = this._contentSize);
			(e.x = i.width * n.x),
				(e.y = i.height * n.y),
				(this.dom.style[cc.$.pfx + 'TransformOrigin'] =
					e.x + 'px ' + -e.y + 'px'),
				this.ignoreAnchor
					? ((this.dom.style.marginLeft = 0),
					  (this.dom.style.marginBottom = 0))
					: ((this.dom.style.marginLeft = this.isToggler
							? 0
							: -e.x + 'px'),
					  (this.dom.style.marginBottom = -e.y + 'px')),
				this.setNodeDirty();
		},
		_setAnchorX: function (t) {
			var e = this._anchorPoint,
				i = this._renderCmd;
			t !== e.x &&
				((e.x = t),
				(t = i._anchorPointInPoints),
				(i = this._contentSize),
				(t.x = i.width * e.x),
				(this.dom.style[cc.$.pfx + 'TransformOrigin'] =
					t.x + 'px ' + -t.y + 'px'),
				this.ignoreAnchor
					? ((this.dom.style.marginLeft = 0),
					  (this.dom.style.marginBottom = 0))
					: (this.dom.style.marginLeft = this.isToggler
							? 0
							: -t.x + 'px'),
				this.setNodeDirty());
		},
		_setAnchorY: function (t) {
			var e = this._anchorPoint,
				i = this._renderCmd;
			t !== e.y &&
				((e.y = t),
				(t = i._anchorPointInPoints),
				(i = this._contentSize),
				(t.y = i.height * e.y),
				(this.dom.style[cc.$.pfx + 'TransformOrigin'] =
					t.x + 'px ' + -t.y + 'px'),
				this.ignoreAnchor
					? ((this.dom.style.marginLeft = 0),
					  (this.dom.style.marginBottom = 0))
					: (this.dom.style.marginBottom = -t.y + 'px'),
				this.setNodeDirty());
		},
		setContentSize: function (t, e) {
			var i = this._renderCmd,
				n = this._contentSize;
			void 0 === e
				? ((n.width = t.width), (n.height = t.height))
				: ((n.width = t), (n.height = e));
			(e = i._anchorPointInPoints), (i = this._anchorPoint);
			(e.x = n.width * i.x),
				(e.y = n.height * i.y),
				(this.dom.width = n.width),
				(this.dom.height = n.height),
				this.setAnchorPoint(this.getAnchorPoint()),
				this.canvas &&
					((this.canvas.width = n.width),
					(this.canvas.height = n.height)),
				this.setNodeDirty(),
				this.redraw();
		},
		_setWidth: function (t) {
			var e = this._contentSize,
				i = this._renderCmd;
			t !== e.width &&
				((e.width = t),
				(t = i._anchorPointInPoints),
				(i = this._anchorPoint),
				(t.x = e.width * i.x),
				(this.dom.width = e.width),
				(this.anchorX = i.x),
				this.canvas && (this.canvas.width = e.width),
				this.setNodeDirty(),
				this.redraw());
		},
		_setHeight: function (t) {
			var e = this._contentSize,
				i = this._renderCmd;
			t !== e.height &&
				((e.height = t),
				(t = i._anchorPointInPoints),
				(i = this._anchorPoint),
				(t.y = e.height * i.y),
				(this.dom.height = e.height),
				(this.anchorY = i.y),
				this.canvas && (this.canvas.height = e.height),
				this.setNodeDirty(),
				this.redraw());
		},
		setRotation: function (t) {
			this._rotation !== t &&
				((this._rotationX = this._rotationY = t),
				this.setNodeDirty(),
				this.dom.rotate(t));
		},
		setSkewX: function (t) {
			(this._skewX = t),
				this.setNodeDirty(),
				this.dom.setSkew(this._skewX, this._skewY);
		},
		setSkewY: function (t) {
			(this._skewY = t),
				this.setNodeDirty(),
				this.dom.setSkew(this._skewX, this._skewY);
		},
		setVisible: function (t) {
			(this._visible = t),
				this.setNodeDirty(),
				this.dom && (this.dom.style.display = t ? 'block' : 'none');
		},
		_setLocalZOrder: function (t) {
			(this._localZOrder = t),
				this.setNodeDirty(),
				this.dom && (this.dom.zIndex = t);
		},
		setParent: function (t) {
			null !== (this._parent = t) &&
				(t.setAnchorPoint(t.getAnchorPoint()),
				this.setNodeDirty(),
				cc.DOM.parentDOM(this));
		},
		resume: function () {
			this.getScheduler().resumeTarget(this),
				this.getActionManager().resumeTarget(this),
				cc.eventManager.resumeTarget(this),
				this.dom &&
					!this.dom.parentNode &&
					(this.getParent()
						? cc.DOM.parentDOM(this)
						: '' === this.dom.id
						? cc.DOM._createEGLViewDiv(this)
						: this.dom.appendTo(cc.container)),
				this.dom && (this.dom.style.visibility = 'visible');
		},
		pause: function () {
			this.getScheduler().pauseTarget(this),
				this.getActionManager().pauseTarget(this),
				cc.eventManager.pauseTarget(this),
				this.dom && (this.dom.style.visibility = 'hidden');
		},
		cleanup: function () {
			this.stopAllActions(),
				this.unscheduleAllCallbacks(),
				cc.eventManager.removeListeners(this),
				this._arrayMakeObjectsPerformSelector(
					this._children,
					cc.Node._stateCallbackType.cleanup
				),
				this.dom && this.dom.remove();
		},
		setOpacity: function (t) {
			(this._opacity = t), (this.dom.style.opacity = t / 255);
		},
		redraw: function () {
			var t;
			this.isSprite
				? ((t = this._children),
				  (this._children = []),
				  cc.Sprite.prototype.visit.call(this, this.ctx),
				  (this._children = t))
				: cc.Sprite.prototype.visit.call(this, this.ctx);
		},
	}),
	(cc.DOM._resetEGLViewDiv = function () {
		var t,
			e,
			i,
			n,
			r,
			o,
			s,
			c,
			a,
			l = cc.$('#EGLViewDiv');
		l &&
			((e = (t = cc.view).getDesignResolutionSize()),
			(i = t.getViewPortRect()),
			(n = t.getFrameSize()),
			(r = t.getDevicePixelRatio()),
			(o = e.width),
			(s = e.height),
			(c = parseInt(cc.container.style.paddingLeft)),
			(a = parseInt(cc.container.style.paddingBottom)),
			0 === e.width && 0 === e.height && ((o = n.width), (s = n.height)),
			i.width,
			0 === i.width && 0 === i.height && n.width,
			(l.style.position = 'absolute'),
			(l.style.width = o + 'px'),
			(l.style.maxHeight = s + 'px'),
			(l.style.margin = 0),
			l.resize(t.getScaleX() / r, t.getScaleY() / r),
			l.translates(c, -a),
			t.getResolutionPolicy() === t._rpNoBorder
				? ((l.style.left = (t.getFrameSize().width - o) / 2 + 'px'),
				  (l.style.bottom =
						(t.getFrameSize().height - (s * t.getScaleY()) / r) /
							2 +
						'px'))
				: ((l.style.left = ((o * t.getScaleX()) / r - o) / 2 + 'px'),
				  (l.style.bottom = '0px')));
	}),
	(cc.DOM.parentDOM = function (t) {
		var e = t.getParent();
		return (
			!(!e || !t.dom) &&
			(e.dom ||
				(cc.DOM.placeHolder(e),
				(e.setParent = cc.DOM.methods.setParent)),
			t.dom.appendTo(e.dom),
			e.setAnchorPoint(e.getAnchorPoint()),
			e.getParent()
				? cc.DOM.parentDOM(e)
				: e.isRunning() &&
				  ((t = cc.$('#EGLViewDiv'))
						? e.dom.appendTo(t)
						: cc.DOM._createEGLViewDiv(e)),
			!0)
		);
	}),
	(cc.DOM._createEGLViewDiv = function (t) {
		var e = cc.$('#EGLViewDiv');
		e || ((e = cc.$new('div')).id = 'EGLViewDiv');
		var i = cc.view,
			n = i.getDesignResolutionSize(),
			r = i.getViewPortRect(),
			o = i.getFrameSize(),
			s = i.getDevicePixelRatio(),
			c = n.width,
			a = n.height,
			l = parseInt(cc.container.style.paddingLeft),
			h = parseInt(cc.container.style.paddingBottom);
		0 === n.width && 0 === n.height && ((c = o.width), (a = o.height));
		r.width;
		0 === r.width && 0 === r.height && o.width,
			(e.style.position = 'absolute'),
			(e.style.width = c + 'px'),
			(e.style.maxHeight = a + 'px'),
			(e.style.margin = 0),
			e.resize(i.getScaleX() / s, i.getScaleY() / s),
			e.translates(l, -h),
			i.getResolutionPolicy() === i._rpNoBorder
				? ((e.style.left = (o.width - c) / 2 + 'px'),
				  (e.style.bottom =
						(o.height - (a * i.getScaleY()) / s) / 2 + 'px'))
				: ((e.style.left = ((c * i.getScaleX()) / s - c) / 2 + 'px'),
				  (e.style.bottom = '0px')),
			t.dom.appendTo(e),
			e.appendTo(cc.container);
	}),
	(cc.DOM.setTransform = function (t) {
		var e;
		t.ctx &&
			(t.ctx.translate(
				t.getAnchorPointInPoints().x,
				t.getAnchorPointInPoints().y
			),
			t.isSprite
				? ((e = t._children),
				  (t._children = []),
				  cc.Sprite.prototype.visit.call(t),
				  (t._children = e))
				: cc.Sprite.prototype.visit.call(t)),
			t.dom &&
				((t.dom.position.x = t.getPositionX()),
				(t.dom.position.y = -t.getPositionY()),
				(t.dom.rotation = t.getRotation()),
				(t.dom.scale = { x: t.getScaleX(), y: t.getScaleY() }),
				(t.dom.skew = { x: t.getSkewX(), y: t.getSkewY() }),
				t.setAnchorPoint && t.setAnchorPoint(t.getAnchorPoint()),
				t.dom.transforms());
	}),
	(cc.DOM.forSprite = function (t) {
		(t.dom = cc.$new('div')), (t.canvas = cc.$new('canvas'));
		var e = t.getContentSize();
		(t.canvas.width = e.width),
			(t.canvas.height = e.height),
			(t.dom.style.position = 'absolute'),
			(t.dom.style.bottom = 0),
			(t.ctx = t.canvas.getContext('2d')),
			t.dom.appendChild(t.canvas),
			t.getParent() && cc.DOM.parentDOM(t),
			(t.isSprite = !0);
	}),
	(cc.DOM.placeHolder = function (t) {
		(t.dom = cc.$new('div')),
			(t.placeholder = !0),
			(t.dom.style.position = 'absolute'),
			(t.dom.style.bottom = 0),
			(t.dom.style.width =
				(t.getContentSize().width || cc.director.getWinSize().width) +
				'px'),
			(t.dom.style.maxHeight =
				(t.getContentSize().height || cc.director.getWinSize().height) +
				'px'),
			(t.dom.style.margin = 0),
			cc.DOM.setTransform(t),
			t.dom.transforms(),
			cc.DOM._addMethods(t);
	}),
	(cc.DOM.convert = function (t) {
		if (1 < arguments.length) cc.DOM.convert(arguments);
		else if (1 !== arguments.length || t.length)
			for (var e = t, i = 0; i < e.length; i++)
				e[i] instanceof cc.Sprite
					? e[i].dom || cc.DOM.forSprite(e[i])
					: cc.log(
							'DOM converter only supports sprite and menuitems yet'
					  ),
					cc.DOM._addMethods(e[i]),
					(e[i].visit = function () {}),
					(e[i].transform = function () {}),
					cc.DOM.setTransform(e[i]),
					e[i].setVisible(e[i].isVisible());
		else cc.DOM.convert([t]);
	}),
	(cc.KEYBOARD_RETURNTYPE_DEFAULT = 0),
	(cc.KEYBOARD_RETURNTYPE_DONE = 1),
	(cc.KEYBOARD_RETURNTYPE_SEND = 2),
	(cc.KEYBOARD_RETURNTYPE_SEARCH = 3),
	(cc.KEYBOARD_RETURNTYPE_GO = 4),
	(cc.EDITBOX_INPUT_MODE_ANY = 0),
	(cc.EDITBOX_INPUT_MODE_EMAILADDR = 1),
	(cc.EDITBOX_INPUT_MODE_NUMERIC = 2),
	(cc.EDITBOX_INPUT_MODE_PHONENUMBER = 3),
	(cc.EDITBOX_INPUT_MODE_URL = 4),
	(cc.EDITBOX_INPUT_MODE_DECIMAL = 5),
	(cc.EDITBOX_INPUT_MODE_SINGLELINE = 6),
	(cc.EDITBOX_INPUT_FLAG_PASSWORD = 0),
	(cc.EDITBOX_INPUT_FLAG_SENSITIVE = 1),
	(cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD = 2),
	(cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE = 3),
	(cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS = 4),
	(cc.EditBoxDelegate = cc.Class.extend({
		editBoxEditingDidBegin: function (t) {},
		editBoxEditingDidEnd: function (t) {},
		editBoxTextChanged: function (t, e) {},
		editBoxReturn: function (t) {},
	})),
	(cc.EditBox = cc.ControlButton.extend({
		_domInputSprite: null,
		_delegate: null,
		_editBoxInputMode: cc.EDITBOX_INPUT_MODE_ANY,
		_editBoxInputFlag: cc.EDITBOX_INPUT_FLAG_SENSITIVE,
		_keyboardReturnType: cc.KEYBOARD_RETURNTYPE_DEFAULT,
		_text: '',
		_placeholderText: '',
		_textColor: null,
		_placeholderColor: null,
		_maxLength: 50,
		_adjustHeight: 18,
		_edTxt: null,
		_edFontSize: 14,
		_edFontName: 'Arial',
		_placeholderFontName: '',
		_placeholderFontSize: 14,
		_tooltip: !1,
		_className: 'EditBox',
		_onCanvasClick: null,
		_inputEvent: null,
		_keyPressEvent: null,
		_focusEvent: null,
		_blurEvent: null,
		ctor: function (t, e, i, n) {
			cc.ControlButton.prototype.ctor.call(this),
				(this._textColor = cc.color.WHITE),
				(this._placeholderColor = cc.color.GRAY),
				this.setContentSize(t);
			var r = (this._domInputSprite = new cc.Sprite());
			(r.draw = function () {}), this.addChild(r);
			var o = (this._edTxt = document.createElement('input'));
			(o.type = 'text'),
				(o.style.fontSize = this._edFontSize + 'px'),
				(o.style.color = '#000000'),
				(o.style.border = 0),
				(o.style.background = 'transparent'),
				(o.style.width = '100%'),
				(o.style.height = '100%'),
				(o.style.active = 0),
				(o.style.outline = 'medium'),
				(o.style.padding = '0');
			this._onCanvasClick = function () {
				this._edTxt.blur();
			}.bind(this);
			this._inputEvent = function () {
				this._delegate &&
					this._delegate.editBoxTextChanged &&
					this._delegate.editBoxTextChanged(this, this._edTxt.value);
			}.bind(this);
			this._keyPressEvent = function (t) {
				t.keyCode === cc.KEY.enter &&
					(t.stopPropagation(),
					t.preventDefault(),
					this._delegate &&
						this._delegate.editBoxReturn &&
						this._delegate.editBoxReturn(this),
					cc._canvas.focus());
			}.bind(this);
			this._focusEvent = function () {
				this._edTxt.value === this._placeholderText &&
					((this._edTxt.value = ''),
					(this._edTxt.style.fontSize = this._edFontSize + 'px'),
					(this._edTxt.style.color = cc.colorToHex(this._textColor)),
					this._editBoxInputFlag === cc.EDITBOX_INPUT_FLAG_PASSWORD
						? (this._edTxt.type = 'password')
						: (this._edTxt.type = 'text')),
					this._delegate &&
						this._delegate.editBoxEditingDidBegin &&
						this._delegate.editBoxEditingDidBegin(this),
					cc._canvas.addEventListener('click', this._onCanvasClick);
			}.bind(this);
			(this._blurEvent = function () {
				'' === this._edTxt.value &&
					((this._edTxt.value = this._placeholderText),
					(this._edTxt.style.fontSize =
						this._placeholderFontSize + 'px'),
					(this._edTxt.style.color = cc.colorToHex(
						this._placeholderColor
					)),
					(this._edTxt.type = 'text')),
					this._delegate &&
						this._delegate.editBoxEditingDidEnd &&
						this._delegate.editBoxEditingDidEnd(this),
					cc._canvas.removeEventListener(
						'click',
						this._onCanvasClick
					);
			}.bind(this)),
				o.addEventListener('input', this._inputEvent),
				o.addEventListener('keypress', this._keyPressEvent),
				o.addEventListener('focus', this._focusEvent),
				o.addEventListener('blur', this._blurEvent),
				cc.DOM.convert(r),
				r.dom.appendChild(o),
				(r.dom.showTooltipDiv = !1),
				(r.dom.style.width = t.width - 6 + 'px'),
				(r.dom.style.height = t.height - 6 + 'px'),
				r.canvas.remove(),
				this.initWithSizeAndBackgroundSprite(t, e) &&
					(i &&
						this.setBackgroundSpriteForState(
							i,
							cc.CONTROL_STATE_HIGHLIGHTED
						),
					n &&
						this.setBackgroundSpriteForState(
							n,
							cc.CONTROL_STATE_DISABLED
						));
		},
		setFont: function (t, e) {
			(this._edFontSize = e),
				(this._edFontName = t),
				this._setFontToEditBox();
		},
		_setFont: function (t) {
			t = cc.LabelTTF._fontStyleRE.exec(t);
			t &&
				((this._edFontSize = parseInt(t[1])),
				(this._edFontName = t[2]),
				this._setFontToEditBox());
		},
		setFontName: function (t) {
			(this._edFontName = t), this._setFontToEditBox();
		},
		setFontSize: function (t) {
			(this._edFontSize = t), this._setFontToEditBox();
		},
		_setFontToEditBox: function () {
			this._edTxt.value !== this._placeholderText &&
				((this._edTxt.style.fontFamily = this._edFontName),
				(this._edTxt.style.fontSize = this._edFontSize + 'px'),
				this._editBoxInputFlag === cc.EDITBOX_INPUT_FLAG_PASSWORD
					? (this._edTxt.type = 'password')
					: (this._edTxt.type = 'text'));
		},
		setText: function (t) {
			cc.log('Please use the setString'), this.setString(t);
		},
		setString: function (t) {
			null != t &&
				('' === t
					? ((this._edTxt.value = this._placeholderText),
					  (this._edTxt.style.color = cc.colorToHex(
							this._placeholderColor
					  )),
					  (this._edTxt.type = 'text'))
					: ((this._edTxt.value = t),
					  (this._edTxt.style.color = cc.colorToHex(
							this._textColor
					  )),
					  this._editBoxInputFlag === cc.EDITBOX_INPUT_FLAG_PASSWORD
							? (this._edTxt.type = 'password')
							: (this._edTxt.type = 'text')));
		},
		setFontColor: function (t) {
			(this._textColor = t),
				this._edTxt.value !== this._placeholderText &&
					(this._edTxt.style.color = cc.colorToHex(t));
		},
		setMaxLength: function (t) {
			!isNaN(t) &&
				0 < t &&
				((this._maxLength = t), (this._edTxt.maxLength = t));
		},
		getMaxLength: function () {
			return this._maxLength;
		},
		setPlaceHolder: function (t) {
			var e;
			null != t &&
				((e = this._placeholderText),
				(this._placeholderText = t),
				this._edTxt.value === e &&
					((this._edTxt.value = t),
					(this._edTxt.style.color = cc.colorToHex(
						this._placeholderColor
					)),
					this._setPlaceholderFontToEditText()));
		},
		setPlaceholderFont: function (t, e) {
			(this._placeholderFontName = t),
				(this._placeholderFontSize = e),
				this._setPlaceholderFontToEditText();
		},
		_setPlaceholderFont: function (t) {
			t = cc.LabelTTF._fontStyleRE.exec(t);
			t &&
				((this._placeholderFontName = t[2]),
				(this._placeholderFontSize = parseInt(t[1])),
				this._setPlaceholderFontToEditText());
		},
		setPlaceholderFontName: function (t) {
			(this._placeholderFontName = t),
				this._setPlaceholderFontToEditText();
		},
		setPlaceholderFontSize: function (t) {
			(this._placeholderFontSize = t),
				this._setPlaceholderFontToEditText();
		},
		_setPlaceholderFontToEditText: function () {
			this._edTxt.value === this._placeholderText &&
				((this._edTxt.style.fontFamily = this._placeholderFontName),
				(this._edTxt.style.fontSize = this._placeholderFontSize + 'px'),
				(this._edTxt.type = 'text'));
		},
		setPlaceholderFontColor: function (t) {
			(this._placeholderColor = t),
				this._edTxt.value === this._placeholderText &&
					(this._edTxt.style.color = cc.colorToHex(t));
		},
		setInputFlag: function (t) {
			(this._editBoxInputFlag = t),
				this._edTxt.value !== this._placeholderText &&
				t === cc.EDITBOX_INPUT_FLAG_PASSWORD
					? (this._edTxt.type = 'password')
					: (this._edTxt.type = 'text');
		},
		getText: function () {
			return cc.log('Please use the getString'), this._edTxt.value;
		},
		getString: function () {
			return this._edTxt.value === this._placeholderText
				? ''
				: this._edTxt.value;
		},
		initWithSizeAndBackgroundSprite: function (t, e) {
			return (
				!!this.initWithBackgroundSprite(e) &&
				((this._domInputSprite.x = 3),
				(this._domInputSprite.y = 3),
				this.setZoomOnTouchDown(!1),
				this.setPreferredSize(t),
				(this.x = 0),
				(this.y = 0),
				this._addTargetWithActionForControlEvent(
					this,
					this.touchDownAction,
					cc.CONTROL_EVENT_TOUCH_UP_INSIDE
				),
				!0)
			);
		},
		setDelegate: function (t) {
			this._delegate = t;
		},
		getPlaceHolder: function () {
			return this._placeholderText;
		},
		setInputMode: function (t) {
			this._editBoxInputMode = t;
		},
		setReturnType: function (t) {
			this._keyboardReturnType = t;
		},
		keyboardWillShow: function (t) {
			var e = cc.EditBox.getRect(this);
			(e.y -= 4),
				e.intersectsRect(t.end)
					? (this._adjustHeight = t.end.getMaxY() - e.getMinY())
					: cc.log("needn't to adjust view layout.");
		},
		keyboardDidShow: function (t) {},
		keyboardWillHide: function (t) {},
		keyboardDidHide: function (t) {},
		touchDownAction: function (t, e) {},
		initWithBackgroundColor: function (t, e) {
			(this._edWidth = t.width),
				(this.dom.style.width = this._edWidth.toString() + 'px'),
				(this._edHeight = t.height),
				(this.dom.style.height = this._edHeight.toString() + 'px'),
				(this.dom.style.backgroundColor = cc.colorToHex(e));
		},
		cleanup: function () {
			this._edTxt.removeEventListener('input', this._inputEvent),
				this._edTxt.removeEventListener(
					'keypress',
					this._keyPressEvent
				),
				this._edTxt.removeEventListener('focus', this._focusEvent),
				this._edTxt.removeEventListener('blur', this._blurEvent),
				cc._canvas.removeEventListener('click', this._onCanvasClick),
				this._super();
		},
	}));
var _p = cc.EditBox.prototype;
_p.font,
	cc.defineGetterSetter(_p, 'font', null, _p._setFont),
	_p.fontName,
	cc.defineGetterSetter(_p, 'fontName', null, _p.setFontName),
	_p.fontSize,
	cc.defineGetterSetter(_p, 'fontSize', null, _p.setFontSize),
	_p.fontColor,
	cc.defineGetterSetter(_p, 'fontColor', null, _p.setFontColor),
	_p.string,
	cc.defineGetterSetter(_p, 'string', _p.getString, _p.setString),
	_p.maxLength,
	cc.defineGetterSetter(_p, 'maxLength', _p.getMaxLength, _p.setMaxLength),
	_p.placeHolder,
	cc.defineGetterSetter(
		_p,
		'placeHolder',
		_p.getPlaceHolder,
		_p.setPlaceHolder
	),
	_p.placeHolderFont,
	cc.defineGetterSetter(_p, 'placeHolderFont', null, _p._setPlaceholderFont),
	_p.placeHolderFontName,
	cc.defineGetterSetter(
		_p,
		'placeHolderFontName',
		null,
		_p.setPlaceholderFontName
	),
	_p.placeHolderFontSize,
	cc.defineGetterSetter(
		_p,
		'placeHolderFontSize',
		null,
		_p.setPlaceholderFontSize
	),
	_p.placeHolderFontColor,
	cc.defineGetterSetter(
		_p,
		'placeHolderFontColor',
		null,
		_p.setPlaceholderFontColor
	),
	_p.inputFlag,
	cc.defineGetterSetter(_p, 'inputFlag', null, _p.setInputFlag),
	_p.delegate,
	cc.defineGetterSetter(_p, 'delegate', null, _p.setDelegate),
	_p.inputMode,
	cc.defineGetterSetter(_p, 'inputMode', null, _p.setInputMode),
	_p.returnType,
	cc.defineGetterSetter(_p, 'returnType', null, _p.setReturnType),
	(_p = null),
	(cc.EditBox.getRect = function (t) {
		var e = t.getContentSize(),
			e = cc.rect(0, 0, e.width, e.height);
		return cc.rectApplyAffineTransform(e, t.getNodeToWorldTransform());
	}),
	(cc.EditBox.create = function (t, e, i, n) {
		return new cc.EditBox(t, e, i, n);
	}),
	(cc.ProtectedNode = cc.Node.extend({
		_protectedChildren: null,
		_reorderProtectedChildDirty: !1,
		_insertProtectedChild: function (t, e) {
			(this._reorderProtectedChildDirty = !0),
				this._protectedChildren.push(t),
				t._setLocalZOrder(e);
		},
		ctor: function () {
			cc.Node.prototype.ctor.call(this), (this._protectedChildren = []);
		},
		addProtectedChild: function (t, e, i) {
			cc.assert(null != t, 'child must be non-nil'),
				cc.assert(
					!t.parent,
					"child already added. It can't be added again"
				),
				(e = e || t.getLocalZOrder()),
				i && t.setTag(i),
				this._insertProtectedChild(t, e),
				t.setParent(this),
				t.setOrderOfArrival(cc.s_globalOrderOfArrival),
				this._running &&
					(t.onEnter(),
					this._isTransitionFinished &&
						t.onEnterTransitionDidFinish()),
				this._cascadeColorEnabled &&
					this._renderCmd.setCascadeColorEnabledDirty(),
				this._cascadeOpacityEnabled &&
					this._renderCmd.setCascadeOpacityEnabledDirty();
		},
		getProtectedChildByTag: function (t) {
			cc.assert(t !== cc.NODE_TAG_INVALID, 'Invalid tag');
			for (
				var e = this._protectedChildren, i = 0, n = e.length;
				i < n;
				i++
			)
				if (e.getTag() === t) return e[i];
			return null;
		},
		removeProtectedChild: function (t, e) {
			null == e && (e = !0);
			var i,
				n = this._protectedChildren;
			0 === n.length ||
				(-1 < (i = n.indexOf(t)) &&
					(this._running &&
						(t.onExitTransitionDidStart(), t.onExit()),
					e && t.cleanup(),
					t.setParent(null),
					n.splice(i, 1)));
		},
		removeProtectedChildByTag: function (t, e) {
			cc.assert(t !== cc.NODE_TAG_INVALID, 'Invalid tag'),
				null == e && (e = !0);
			var i = this.getProtectedChildByTag(t);
			null == i
				? cc.log(
						'cocos2d: removeChildByTag(tag = %d): child not found!',
						t
				  )
				: this.removeProtectedChild(i, e);
		},
		removeAllProtectedChildren: function () {
			this.removeAllProtectedChildrenWithCleanup(!0);
		},
		removeAllProtectedChildrenWithCleanup: function (t) {
			null == t && (t = !0);
			for (
				var e = this._protectedChildren, i = 0, n = e.length;
				i < n;
				i++
			) {
				var r = e[i];
				this._running && (r.onExitTransitionDidStart(), r.onExit()),
					t && r.cleanup(),
					r.setParent(null);
			}
			e.length = 0;
		},
		reorderProtectedChild: function (t, e) {
			cc.assert(null != t, 'Child must be non-nil'),
				(this._reorderProtectedChildDirty = !0),
				t.setOrderOfArrival(cc.s_globalOrderOfArrival++),
				t._setLocalZOrder(e);
		},
		sortAllProtectedChildren: function () {
			if (this._reorderProtectedChildDirty) {
				for (
					var t, e, i = this._protectedChildren, n = i.length, r = 1;
					r < n;
					r++
				) {
					for (e = i[r], t = r - 1; 0 <= t; ) {
						if (e._localZOrder < i[t]._localZOrder) i[t + 1] = i[t];
						else {
							if (
								!(
									e._localZOrder === i[t]._localZOrder &&
									e.arrivalOrder < i[t].arrivalOrder
								)
							)
								break;
							i[t + 1] = i[t];
						}
						t--;
					}
					i[t + 1] = e;
				}
				this._reorderProtectedChildDirty = !1;
			}
		},
		_changePosition: function () {},
		cleanup: function () {
			cc.Node.prototype.cleanup.call(this);
			for (
				var t = this._protectedChildren, e = 0, i = t.length;
				e < i;
				e++
			)
				t[e].cleanup();
		},
		onEnter: function () {
			cc.Node.prototype.onEnter.call(this);
			for (
				var t = this._protectedChildren, e = 0, i = t.length;
				e < i;
				e++
			)
				t[e].onEnter();
		},
		onEnterTransitionDidFinish: function () {
			cc.Node.prototype.onEnterTransitionDidFinish.call(this);
			for (
				var t = this._protectedChildren, e = 0, i = t.length;
				e < i;
				e++
			)
				t[e].onEnterTransitionDidFinish();
		},
		onExit: function () {
			cc.Node.prototype.onExit.call(this);
			for (
				var t = this._protectedChildren, e = 0, i = t.length;
				e < i;
				e++
			)
				t[e].onExit();
		},
		onExitTransitionDidStart: function () {
			cc.Node.prototype.onExitTransitionDidStart.call(this);
			for (
				var t = this._protectedChildren, e = 0, i = t.length;
				e < i;
				e++
			)
				t[e].onExitTransitionDidStart();
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.ProtectedNode.CanvasRenderCmd
					: cc.ProtectedNode.WebGLRenderCmd
			)(this);
		},
	})),
	(cc.ProtectedNode.create = function () {
		return new cc.ProtectedNode();
	}),
	(function () {
		(cc.ProtectedNode.RenderCmd = {
			_updateDisplayColor: function (t) {
				var e,
					i,
					n = this._node,
					r = this._displayedColor,
					o = n._realColor;
				if (this._cascadeColorEnabledDirty && !n._cascadeColorEnabled) {
					(r.r = o.r), (r.g = o.g), (r.b = o.b);
					for (
						var s,
							c = new cc.Color(255, 255, 255, 255),
							a = 0,
							l = (s = n._children).length;
						a < l;
						a++
					)
						(e = s[a]) &&
							e._renderCmd &&
							e._renderCmd._updateDisplayColor(c);
					this._cascadeColorEnabledDirty = !1;
				} else {
					if (
						(void 0 === t &&
							(t =
								(i = n._parent) && i._cascadeColorEnabled
									? i.getDisplayedColor()
									: cc.color.WHITE),
						(r.r = 0 | ((o.r * t.r) / 255)),
						(r.g = 0 | ((o.g * t.g) / 255)),
						(r.b = 0 | ((o.b * t.b) / 255)),
						n._cascadeColorEnabled)
					)
						for (a = 0, l = (s = n._children).length; a < l; a++)
							(e = s[a]) &&
								e._renderCmd &&
								(e._renderCmd._updateDisplayColor(r),
								e._renderCmd._updateColor());
					for (
						a = 0, l = (s = n._protectedChildren).length;
						a < l;
						a++
					)
						(e = s[a]) &&
							e._renderCmd &&
							(e._renderCmd._updateDisplayColor(r),
							e._renderCmd._updateColor());
				}
				this._dirtyFlag =
					(this._dirtyFlag & cc.Node._dirtyFlags.colorDirty) ^
					this._dirtyFlag;
			},
			_updateDisplayOpacity: function (t) {
				var e,
					i,
					n,
					r,
					o,
					s = this._node;
				if (
					this._cascadeOpacityEnabledDirty &&
					!s._cascadeOpacityEnabled
				) {
					for (
						this._displayedOpacity = s._realOpacity,
							e = 0,
							i = (n = s._children).length;
						e < i;
						e++
					)
						(r = n[e]) &&
							r._renderCmd &&
							r._renderCmd._updateDisplayOpacity(255);
					this._cascadeOpacityEnabledDirty = !1;
				} else {
					if (
						(void 0 === t &&
							((t = 255),
							(o = s._parent) &&
								o._cascadeOpacityEnabled &&
								(t = o.getDisplayedOpacity())),
						(this._displayedOpacity = (s._realOpacity * t) / 255),
						s._cascadeOpacityEnabled)
					)
						for (e = 0, i = (n = s._children).length; e < i; e++)
							(r = n[e]) &&
								r._renderCmd &&
								(r._renderCmd._updateDisplayOpacity(
									this._displayedOpacity
								),
								r._renderCmd._updateColor());
					for (
						e = 0, i = (n = s._protectedChildren).length;
						e < i;
						e++
					)
						(r = n[e]) &&
							r._renderCmd &&
							(r._renderCmd._updateDisplayOpacity(
								this._displayedOpacity
							),
							r._renderCmd._updateColor());
				}
				this._dirtyFlag =
					(this._dirtyFlag & cc.Node._dirtyFlags.opacityDirty) ^
					this._dirtyFlag;
			},
			_changeProtectedChild: function (t) {
				var e = t._renderCmd,
					i = e._dirtyFlag,
					n = cc.Node._dirtyFlags;
				this._dirtyFlag & n.colorDirty && (i |= n.colorDirty),
					this._dirtyFlag & n.opacityDirty && (i |= n.opacityDirty);
				(t = i & n.colorDirty), (n = i & n.opacityDirty);
				t && e._updateDisplayColor(this._displayedColor),
					n && e._updateDisplayOpacity(this._displayedOpacity),
					(t || n) && e._updateColor();
			},
		}),
			(cc.ProtectedNode.CanvasRenderCmd = function (t) {
				cc.Node.CanvasRenderCmd.call(this, t),
					(this._cachedParent = null),
					(this._cacheDirty = !1);
			});
		var t = (cc.ProtectedNode.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		cc.inject(cc.ProtectedNode.RenderCmd, t),
			(t.constructor = cc.ProtectedNode.CanvasRenderCmd),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible) {
					var i,
						n,
						r,
						o,
						s = e._children,
						c = e._children,
						a = e._protectedChildren,
						l = c.length,
						h = a.length;
					for (
						this._syncStatus(t),
							e.sortAllChildren(),
							e.sortAllProtectedChildren(),
							i = 0;
						i < l && (r = s[i])._localZOrder < 0;
						i++
					)
						r.visit(this);
					for (n = 0; n < h && (o = a[n]) && o._localZOrder < 0; n++)
						this._changeProtectedChild(o), o.visit(this);
					for (cc.renderer.pushRenderCommand(this); i < l; i++)
						s[i] && s[i].visit(this);
					for (; n < h; n++)
						(o = a[n]) &&
							(this._changeProtectedChild(o), o.visit(this));
					(this._dirtyFlag = 0), (this._cacheDirty = !1);
				}
			}),
			(t.transform = function (t, e) {
				var i = this._node;
				i._changePosition && i._changePosition(),
					this.originTransform(t, e);
				var n,
					r,
					o = i._protectedChildren;
				if (e && o && 0 !== o.length)
					for (n = 0, r = o.length; n < r; n++)
						o[n]._renderCmd.transform(this, e);
			}),
			(t.pNodeVisit = t.visit),
			(t.pNodeTransform = t.transform);
	})(),
	(function () {
		var t;
		cc.Node.WebGLRenderCmd &&
			((cc.ProtectedNode.WebGLRenderCmd = function (t) {
				cc.Node.WebGLRenderCmd.call(this, t);
			}),
			(t = cc.ProtectedNode.WebGLRenderCmd.prototype =
				Object.create(cc.Node.WebGLRenderCmd.prototype)),
			cc.inject(cc.ProtectedNode.RenderCmd, t),
			(t.constructor = cc.ProtectedNode.WebGLRenderCmd),
			(t.visit = function (t) {
				var e,
					i,
					n = this._node;
				if (n._visible) {
					this._syncStatus(t);
					t = n.grid;
					t && t._active && t.beforeDraw();
					var r,
						o = n._children,
						s = n._protectedChildren,
						c = o.length,
						a = s.length;
					for (
						n.sortAllChildren(),
							n.sortAllProtectedChildren(),
							e = 0;
						e < c && o[e] && o[e]._localZOrder < 0;
						e++
					)
						o[e].visit(this);
					for (i = 0; i < a && (r = s[i]) && r._localZOrder < 0; i++)
						this._changeProtectedChild(r), r.visit(this);
					for (cc.renderer.pushRenderCommand(this); e < c; e++)
						o[e] && o[e].visit(this);
					for (; i < a; i++)
						(r = s[i]) &&
							(this._changeProtectedChild(r), r.visit(this));
					t && t._active && t.afterDraw(n), (this._dirtyFlag = 0);
				}
			}),
			(t.transform = function (t, e) {
				this.originTransform(t, e);
				var i,
					n,
					r = this._node._protectedChildren;
				if (e && r && 0 !== r.length)
					for (i = 0, n = r.length; i < n; i++)
						r[i]._renderCmd.transform(this, e);
			}),
			(t.pNodeVisit = t.visit),
			(t.pNodeTransform = t.transform));
	})();
var ccui = ccui || {};
(ccui.Class = ccui.Class || cc.Class),
	(ccui.Class.extend = ccui.Class.extend || cc.Class.extend),
	(ccui.Node = ccui.Node || cc.Node),
	(ccui.Node.extend = ccui.Node.extend || cc.Node.extend),
	(ccui.ProtectedNode = ccui.ProtectedNode || cc.ProtectedNode),
	(ccui.ProtectedNode.extend =
		ccui.ProtectedNode.extend || cc.ProtectedNode.extend),
	(ccui.cocosGUIVersion = 'CocosGUI v1.0.0.0'),
	(ccui._FocusNavigationController = cc.Class.extend({
		_keyboardListener: null,
		_firstFocusedWidget: null,
		_enableFocusNavigation: !1,
		_keyboardEventPriority: 1,
		enableFocusNavigation: function (t) {
			this._enableFocusNavigation !== t &&
				((this._enableFocusNavigation = t)
					? this._addKeyboardEventListener()
					: this._removeKeyboardEventListener());
		},
		_setFirstFocsuedWidget: function (t) {
			this._firstFocusedWidget = t;
		},
		_onKeyPressed: function (t, e) {
			this._enableFocusNavigation &&
				this._firstFocusedWidget &&
				(t === cc.KEY.dpadDown &&
					(this._firstFocusedWidget =
						this._firstFocusedWidget.findNextFocusedWidget(
							ccui.Widget.DOWN,
							this._firstFocusedWidget
						)),
				t === cc.KEY.dpadUp &&
					(this._firstFocusedWidget =
						this._firstFocusedWidget.findNextFocusedWidget(
							ccui.Widget.UP,
							this._firstFocusedWidget
						)),
				t === cc.KEY.dpadLeft &&
					(this._firstFocusedWidget =
						this._firstFocusedWidget.findNextFocusedWidget(
							ccui.Widget.LEFT,
							this._firstFocusedWidget
						)),
				t === cc.KEY.dpadRight &&
					(this._firstFocusedWidget =
						this._firstFocusedWidget.findNextFocusedWidget(
							ccui.Widget.RIGHT,
							this._firstFocusedWidget
						)));
		},
		_addKeyboardEventListener: function () {
			this._keyboardListener ||
				((this._keyboardListener = cc.EventListener.create({
					event: cc.EventListener.KEYBOARD,
					onKeyReleased: this._onKeyPressed.bind(this),
				})),
				cc.eventManager.addListener(
					this._keyboardListener,
					this._keyboardEventPriority
				));
		},
		_removeKeyboardEventListener: function () {
			this._keyboardListener &&
				(cc.eventManager.removeEventListener(this._keyboardListener),
				(this._keyboardListener = null));
		},
	})),
	(ccui.__LAYOUT_COMPONENT_NAME = '__ui_layout'),
	(ccui.Widget = ccui.ProtectedNode.extend({
		_enabled: !0,
		_bright: !0,
		_touchEnabled: !1,
		_brightStyle: null,
		_touchBeganPosition: null,
		_touchMovePosition: null,
		_touchEndPosition: null,
		_touchEventListener: null,
		_touchEventSelector: null,
		_name: 'default',
		_widgetType: null,
		_actionTag: 0,
		_customSize: null,
		_layoutParameterDictionary: null,
		_layoutParameterType: 0,
		_focused: !1,
		_focusEnabled: !0,
		_ignoreSize: !1,
		_affectByClipping: !1,
		_sizeType: null,
		_sizePercent: null,
		_positionType: null,
		_positionPercent: null,
		_hit: !1,
		_nodes: null,
		_touchListener: null,
		_className: 'Widget',
		_flippedX: !1,
		_flippedY: !1,
		_opacity: 255,
		_highlight: !1,
		_touchEventCallback: null,
		_clickEventListener: null,
		_propagateTouchEvents: !0,
		_unifySize: !1,
		_callbackName: null,
		_callbackType: null,
		_usingLayoutComponent: !1,
		_inViewRect: !0,
		ctor: function () {
			cc.ProtectedNode.prototype.ctor.call(this),
				(this._brightStyle = ccui.Widget.BRIGHT_STYLE_NONE),
				(this._touchBeganPosition = cc.p(0, 0)),
				(this._touchMovePosition = cc.p(0, 0)),
				(this._touchEndPosition = cc.p(0, 0)),
				(this._widgetType = ccui.Widget.TYPE_WIDGET),
				(this._customSize = cc.size(0, 0)),
				(this._layoutParameterDictionary = {}),
				(this._sizeType = ccui.Widget.SIZE_ABSOLUTE),
				(this._sizePercent = cc.p(0, 0)),
				(this._positionType = ccui.Widget.POSITION_ABSOLUTE),
				(this._positionPercent = cc.p(0, 0)),
				(this._nodes = []),
				(this._layoutParameterType = ccui.LayoutParameter.NONE),
				ccui.Widget.prototype.init.call(this);
		},
		init: function () {
			return (
				!!cc.ProtectedNode.prototype.init.call(this) &&
				((this._layoutParameterDictionary = {}),
				this._initRenderer(),
				this.setBright(!0),
				(this.onFocusChanged = this.onFocusChange),
				(this.onNextFocusedWidget = null),
				this.setAnchorPoint(cc.p(0.5, 0.5)),
				this.ignoreContentAdaptWithSize(!0),
				!0)
			);
		},
		onEnter: function () {
			var t = this._touchListener;
			t &&
				!t._isRegistered() &&
				this._touchEnabled &&
				cc.eventManager.addListener(t, this),
				this._usingLayoutComponent || this.updateSizeAndPosition(),
				cc.ProtectedNode.prototype.onEnter.call(this);
		},
		onExit: function () {
			this.unscheduleUpdate(),
				cc.ProtectedNode.prototype.onExit.call(this);
		},
		_getOrCreateLayoutComponent: function () {
			var t = this.getComponent(ccui.__LAYOUT_COMPONENT_NAME);
			return (
				null == t &&
					((t = new ccui.LayoutComponent()), this.addComponent(t)),
				t
			);
		},
		getWidgetParent: function () {
			var t = this.getParent();
			return t instanceof ccui.Widget ? t : null;
		},
		_updateContentSizeWithTextureSize: function (t) {
			this._unifySize
				? this.setContentSize(t)
				: this.setContentSize(this._ignoreSize ? t : this._customSize);
		},
		_isAncestorsEnabled: function () {
			var t = this._getAncensterWidget(this);
			return (
				null == t || (!(t && !t.isEnabled()) && t._isAncestorsEnabled())
			);
		},
		setPropagateTouchEvents: function (t) {
			this._propagateTouchEvents = t;
		},
		isPropagateTouchEvents: function () {
			return this._propagateTouchEvents;
		},
		setSwallowTouches: function (t) {
			this._touchListener && this._touchListener.setSwallowTouches(t);
		},
		isSwallowTouches: function () {
			return (
				!!this._touchListener && this._touchListener.isSwallowTouches()
			);
		},
		_getAncensterWidget: function (t) {
			if (null == t) return null;
			t = t.getParent();
			return null == t
				? null
				: t instanceof ccui.Widget
				? t
				: this._getAncensterWidget(t.getParent());
		},
		_isAncestorsVisible: function (t) {
			if (null == t) return !0;
			t = t.getParent();
			return !(t && !t.isVisible()) && this._isAncestorsVisible(t);
		},
		_cleanupWidget: function () {
			this._eventDispatcher.removeEventListener(this._touchListener),
				(this._touchEnabled = !1),
				(this._touchListener = null),
				ccui.Widget._focusedWidget === this &&
					((ccui.Widget._focusedWidget = null),
					(ccui.Widget._focusNavigationController = null));
		},
		setEnabled: function (t) {
			this._enabled = t;
		},
		_initRenderer: function () {},
		setContentSize: function (t, e) {
			var i = void 0 === e ? t.width : t,
				t = void 0 === e ? t.height : e;
			cc.Node.prototype.setContentSize.call(this, i, t),
				(this._customSize.width = i),
				(this._customSize.height = t),
				this._unifySize ||
					(this._ignoreSize &&
						(this._contentSize = this.getVirtualRendererSize())),
				!this._usingLayoutComponent &&
					this._running &&
					((e = (
						this.getWidgetParent() || this._parent
					).getContentSize()),
					(this._sizePercent.x = 0 < e.width ? i / e.width : 0),
					(this._sizePercent.y = 0 < e.height ? t / e.height : 0)),
				this._onSizeChanged();
		},
		_setWidth: function (t) {
			cc.Node.prototype._setWidth.call(this, t),
				(this._customSize.width = t),
				this._unifySize ||
					(this._ignoreSize &&
						(this._contentSize = this.getVirtualRendererSize())),
				!this._usingLayoutComponent &&
					this._running &&
					((t = (this.getWidgetParent() || this._parent).width),
					(this._sizePercent.x =
						0 < t ? this._customSize.width / t : 0)),
				this._onSizeChanged();
		},
		_setHeight: function (t) {
			cc.Node.prototype._setHeight.call(this, t),
				(this._customSize.height = t),
				this._unifySize ||
					(this._ignoreSize &&
						(this._contentSize = this.getVirtualRendererSize())),
				!this._usingLayoutComponent &&
					this._running &&
					((t = (this.getWidgetParent() || this._parent).height),
					(this._sizePercent.y =
						0 < t ? this._customSize.height / t : 0)),
				this._onSizeChanged();
		},
		setSizePercent: function (t) {
			if (this._usingLayoutComponent) {
				var e = this._getOrCreateLayoutComponent();
				return (
					e.setUsingPercentContentSize(!0),
					e.setPercentContentSize(t),
					void e.refreshLayout()
				);
			}
			(this._sizePercent.x = t.x), (this._sizePercent.y = t.y);
			var i = this._customSize.width,
				n = this._customSize.height;
			this._running &&
				(n = (e = this.getWidgetParent())
					? ((i = e.width * t.x), e.height * t.y)
					: ((i = this._parent.width * t.x),
					  this._parent.height * t.y)),
				this._ignoreSize
					? this.setContentSize(this.getVirtualRendererSize())
					: this.setContentSize(i, n),
				(this._customSize.width = i),
				(this._customSize.height = n);
		},
		_setWidthPercent: function (t) {
			this._sizePercent.x = t;
			var e = this._customSize.width;
			this._running &&
				(e = (this.getWidgetParent() || this._parent).width * t),
				this._ignoreSize
					? this._setWidth(this.getVirtualRendererSize().width)
					: this._setWidth(e),
				(this._customSize.width = e);
		},
		_setHeightPercent: function (t) {
			this._sizePercent.y = t;
			var e = this._customSize.height;
			this._running &&
				(e = (this.getWidgetParent() || this._parent).height * t),
				this._ignoreSize
					? this._setHeight(this.getVirtualRendererSize().height)
					: this._setHeight(e),
				(this._customSize.height = e);
		},
		updateSizeAndPosition: function (t) {
			switch (
				(t ||
					(t = (n = this.getWidgetParent())
						? n.getLayoutSize()
						: this._parent.getContentSize()),
				this._sizeType)
			) {
				case ccui.Widget.SIZE_ABSOLUTE:
					this._ignoreSize
						? this.setContentSize(this.getVirtualRendererSize())
						: this.setContentSize(this._customSize),
						(this._sizePercent.x =
							0 < t.width ? this._customSize.width / t.width : 0),
						(this._sizePercent.y =
							0 < t.height
								? this._customSize.height / t.height
								: 0);
					break;
				case ccui.Widget.SIZE_PERCENT:
					var e = cc.size(
						t.width * this._sizePercent.x,
						t.height * this._sizePercent.y
					);
					this._ignoreSize
						? this.setContentSize(this.getVirtualRendererSize())
						: this.setContentSize(e),
						(this._customSize.width = e.width),
						(this._customSize.height = e.height);
			}
			this._onSizeChanged();
			var i = this.getPosition();
			switch (this._positionType) {
				case ccui.Widget.POSITION_ABSOLUTE:
					t.width <= 0 || t.height <= 0
						? (this._positionPercent.x = this._positionPercent.y =
								0)
						: ((this._positionPercent.x = i.x / t.width),
						  (this._positionPercent.y = i.y / t.height));
					break;
				case ccui.Widget.POSITION_PERCENT:
					i = cc.p(
						t.width * this._positionPercent.x,
						t.height * this._positionPercent.y
					);
			}
			if (this._parent instanceof ccui.ImageView) {
				var n = this._parent._imageRenderer;
				if (n && !n._textureLoaded) return;
			}
			this.setPosition(i);
		},
		setSizeType: function (t) {
			(this._sizeType = t),
				this._usingLayoutComponent &&
					this._getOrCreateLayoutComponent().setUsingPercentContentSize(
						this._sizeType === ccui.SIZE_PERCENT
					);
		},
		getSizeType: function () {
			return this._sizeType;
		},
		ignoreContentAdaptWithSize: function (t) {
			this._unifySize
				? this.setContentSize(this._customSize)
				: this._ignoreSize !== t &&
				  ((this._ignoreSize = t),
				  this.setContentSize(
						t ? this.getVirtualRendererSize() : this._customSize
				  ));
		},
		isIgnoreContentAdaptWithSize: function () {
			return this._ignoreSize;
		},
		getCustomSize: function () {
			return cc.size(this._customSize);
		},
		getLayoutSize: function () {
			return cc.size(this._contentSize);
		},
		getSizePercent: function () {
			var t;
			return (
				this._usingLayoutComponent &&
					((t = this._getOrCreateLayoutComponent()),
					(this._sizePercent = t.getPercentContentSize())),
				this._sizePercent
			);
		},
		_getWidthPercent: function () {
			return this._sizePercent.x;
		},
		_getHeightPercent: function () {
			return this._sizePercent.y;
		},
		getWorldPosition: function () {
			return this.convertToWorldSpace(
				cc.p(
					this._anchorPoint.x * this._contentSize.width,
					this._anchorPoint.y * this._contentSize.height
				)
			);
		},
		getVirtualRenderer: function () {
			return this;
		},
		getVirtualRendererSize: function () {
			return cc.size(this._contentSize);
		},
		_onSizeChanged: function () {
			if (!this._usingLayoutComponent)
				for (
					var t = this.getChildren(), e = 0, i = t.length;
					e < i;
					e++
				) {
					var n = t[e];
					n instanceof ccui.Widget && n.updateSizeAndPosition();
				}
		},
		setTouchEnabled: function (t) {
			this._touchEnabled !== t &&
				((this._touchEnabled = t),
				this._touchEnabled
					? (this._touchListener ||
							(this._touchListener = cc.EventListener.create({
								event: cc.EventListener.TOUCH_ONE_BY_ONE,
								swallowTouches: !0,
								onTouchBegan: this.onTouchBegan.bind(this),
								onTouchMoved: this.onTouchMoved.bind(this),
								onTouchEnded: this.onTouchEnded.bind(this),
							})),
					  cc.eventManager.addListener(this._touchListener, this))
					: cc.eventManager.removeListener(this._touchListener));
		},
		isTouchEnabled: function () {
			return this._touchEnabled;
		},
		isHighlighted: function () {
			return this._highlight;
		},
		setHighlighted: function (t) {
			t !== this._highlight &&
				((this._highlight = t),
				this._bright
					? this._highlight
						? this.setBrightStyle(
								ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT
						  )
						: this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL)
					: this._onPressStateChangedToDisabled());
		},
		isFocused: function () {
			return this._focused;
		},
		setFocused: function (t) {
			(this._focused = t) &&
				((ccui.Widget._focusedWidget = this),
				ccui.Widget._focusNavigationController &&
					ccui.Widget._focusNavigationController._setFirstFocsuedWidget(
						this
					));
		},
		isFocusEnabled: function () {
			return this._focusEnabled;
		},
		setFocusEnabled: function (t) {
			this._focusEnabled = t;
		},
		findNextFocusedWidget: function (t, e) {
			if (
				null === this.onNextFocusedWidget ||
				null == this.onNextFocusedWidget(t)
			) {
				var i = e instanceof ccui.Layout;
				if (this.isFocused() || i) {
					var n = this.getParent();
					return null !== n && n instanceof ccui.Layout
						? n.findNextFocusedWidget(t, e)
						: i
						? e.findNextFocusedWidget(t, e)
						: e;
				}
				return e;
			}
			t = this.onNextFocusedWidget(t);
			return this.dispatchFocusEvent(this, t), t;
		},
		requestFocus: function () {
			this !== ccui.Widget._focusedWidget &&
				this.dispatchFocusEvent(ccui.Widget._focusedWidget, this);
		},
		getCurrentFocusedWidget: function () {
			return ccui.Widget._focusedWidget;
		},
		onFocusChanged: null,
		onNextFocusedWidget: null,
		interceptTouchEvent: function (t, e, i) {
			var n = this.getWidgetParent();
			n && n.interceptTouchEvent(t, e, i);
		},
		onFocusChange: function (t, e) {
			t && t.setFocused(!1), e && e.setFocused(!0);
		},
		dispatchFocusEvent: function (t, e) {
			t && !t.isFocused() && (t = ccui.Widget._focusedWidget),
				e !== t &&
					(e && e.onFocusChanged && e.onFocusChanged(t, e),
					t && e.onFocusChanged && t.onFocusChanged(t, e),
					cc.eventManager.dispatchEvent(new cc.EventFocus(t, e)));
		},
		setBright: function (t) {
			(this._bright = t),
				this._bright
					? ((this._brightStyle = ccui.Widget.BRIGHT_STYLE_NONE),
					  this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL))
					: this._onPressStateChangedToDisabled();
		},
		setBrightStyle: function (t) {
			if (this._brightStyle !== t)
				switch (
					((t = t || ccui.Widget.BRIGHT_STYLE_NORMAL),
					(this._brightStyle = t),
					this._brightStyle)
				) {
					case ccui.Widget.BRIGHT_STYLE_NORMAL:
						this._onPressStateChangedToNormal();
						break;
					case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:
						this._onPressStateChangedToPressed();
				}
		},
		_onPressStateChangedToNormal: function () {},
		_onPressStateChangedToPressed: function () {},
		_onPressStateChangedToDisabled: function () {},
		_updateChildrenDisplayedRGBA: function () {
			this.setColor(this.getColor()), this.setOpacity(this.getOpacity());
		},
		didNotSelectSelf: function () {},
		onTouchBegan: function (t, e) {
			var i;
			return (
				(this._hit = !1),
				this.isVisible() &&
					this.isEnabled() &&
					this._isAncestorsEnabled() &&
					this._isAncestorsVisible(this) &&
					((i = t.getLocation()),
					(this._touchBeganPosition.x = i.x),
					(this._touchBeganPosition.y = i.y),
					this.hitTest(this._touchBeganPosition) &&
						this.isClippingParentContainsPoint(
							this._touchBeganPosition
						) &&
						(this._hit = !0)),
				!!this._hit &&
					(this.setHighlighted(!0),
					this._propagateTouchEvents &&
						this.propagateTouchEvent(
							ccui.Widget.TOUCH_BEGAN,
							this,
							t
						),
					this._pushDownEvent(),
					!0)
			);
		},
		propagateTouchEvent: function (t, e, i) {
			var n = this.getWidgetParent();
			n && n.interceptTouchEvent(t, e, i);
		},
		onTouchMoved: function (t, e) {
			var i = t.getLocation();
			(this._touchMovePosition.x = i.x),
				(this._touchMovePosition.y = i.y),
				this.setHighlighted(this.hitTest(i)),
				this._propagateTouchEvents &&
					this.propagateTouchEvent(ccui.Widget.TOUCH_MOVED, this, t),
				this._moveEvent();
		},
		onTouchEnded: function (t, e) {
			var i = t.getLocation();
			(this._touchEndPosition.x = i.x),
				(this._touchEndPosition.y = i.y),
				this._propagateTouchEvents &&
					this.propagateTouchEvent(ccui.Widget.TOUCH_ENDED, this, t);
			t = this._highlight;
			this.setHighlighted(!1),
				t ? this._releaseUpEvent() : this._cancelUpEvent();
		},
		onTouchCancelled: function (t) {
			this.setHighlighted(!1), this._cancelUpEvent();
		},
		onTouchLongClicked: function (t) {
			this.longClickEvent();
		},
		_pushDownEvent: function () {
			this._touchEventCallback &&
				this._touchEventCallback(this, ccui.Widget.TOUCH_BEGAN),
				this._touchEventListener &&
					this._touchEventSelector &&
					this._touchEventSelector.call(
						this._touchEventListener,
						this,
						ccui.Widget.TOUCH_BEGAN
					);
		},
		_moveEvent: function () {
			this._touchEventCallback &&
				this._touchEventCallback(this, ccui.Widget.TOUCH_MOVED),
				this._touchEventListener &&
					this._touchEventSelector &&
					this._touchEventSelector.call(
						this._touchEventListener,
						this,
						ccui.Widget.TOUCH_MOVED
					);
		},
		_releaseUpEvent: function () {
			this._touchEventCallback &&
				this._touchEventCallback(this, ccui.Widget.TOUCH_ENDED),
				this._touchEventListener &&
					this._touchEventSelector &&
					this._touchEventSelector.call(
						this._touchEventListener,
						this,
						ccui.Widget.TOUCH_ENDED
					),
				this._clickEventListener && this._clickEventListener(this);
		},
		_cancelUpEvent: function () {
			this._touchEventCallback &&
				this._touchEventCallback(this, ccui.Widget.TOUCH_CANCELED),
				this._touchEventListener &&
					this._touchEventSelector &&
					this._touchEventSelector.call(
						this._touchEventListener,
						this,
						ccui.Widget.TOUCH_CANCELED
					);
		},
		longClickEvent: function () {},
		addTouchEventListener: function (t, e) {
			void 0 === e
				? (this._touchEventCallback = t)
				: ((this._touchEventSelector = t),
				  (this._touchEventListener = e));
		},
		addClickEventListener: function (t) {
			this._clickEventListener = t;
		},
		hitTest: function (t) {
			var e = cc.rect(
				0,
				0,
				this._contentSize.width,
				this._contentSize.height
			);
			return cc.rectContainsPoint(e, this.convertToNodeSpace(t));
		},
		isClippingParentContainsPoint: function (t) {
			this._affectByClipping = !1;
			for (var e = this.getParent(), i = null; e; ) {
				if (e instanceof ccui.Layout && e.isClippingEnabled()) {
					(this._affectByClipping = !0), (i = e);
					break;
				}
				e = e.getParent();
			}
			return (
				!this._affectByClipping ||
				!i ||
				(!!i.hitTest(t) && i.isClippingParentContainsPoint(t))
			);
		},
		checkChildInfo: function (t, e, i) {
			var n = this.getWidgetParent();
			n && n.checkChildInfo(t, e, i);
		},
		setPosition: function (t, e) {
			var i;
			this._usingLayoutComponent ||
				!this._running ||
				((i = this.getWidgetParent()) &&
					((i = i.getContentSize()).width <= 0 || i.height <= 0
						? ((this._positionPercent.x = 0),
						  (this._positionPercent.y = 0))
						: void 0 === e
						? ((this._positionPercent.x = t.x / i.width),
						  (this._positionPercent.y = t.y / i.height))
						: ((this._positionPercent.x = t / i.width),
						  (this._positionPercent.y = e / i.height)))),
				cc.Node.prototype.setPosition.call(this, t, e);
		},
		setPositionX: function (t) {
			var e;
			!this._running ||
				((e = this.getWidgetParent()) &&
					((e = e.width),
					(this._positionPercent.x = e <= 0 ? 0 : t / e))),
				cc.Node.prototype.setPositionX.call(this, t);
		},
		setPositionY: function (t) {
			var e;
			!this._running ||
				((e = this.getWidgetParent()) &&
					((e = e.height),
					(this._positionPercent.y = e <= 0 ? 0 : t / e))),
				cc.Node.prototype.setPositionY.call(this, t);
		},
		setPositionPercent: function (t) {
			if (this._usingLayoutComponent) {
				var e = this._getOrCreateLayoutComponent();
				return (
					e.setPositionPercentX(t.x),
					e.setPositionPercentY(t.y),
					void e.refreshLayout()
				);
			}
			this._setXPercent(t.x),
				this._setYPercent(t.y),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		_setXPercent: function (t) {
			if (this._usingLayoutComponent) {
				var e = this._getOrCreateLayoutComponent();
				return e.setPositionPercentX(t.x), void e.refreshLayout();
			}
			this._positionPercent.x = t;
		},
		_setYPercent: function (t) {
			if (this._usingLayoutComponent) {
				var e = this._getOrCreateLayoutComponent();
				return e.setPositionPercentY(t.x), void e.refreshLayout();
			}
			this._positionPercent.y = t;
		},
		getPositionPercent: function () {
			var t;
			return (
				this._usingLayoutComponent &&
					((t = this._getOrCreateLayoutComponent()),
					(this._positionPercent.x = t.getPositionPercentX()),
					(this._positionPercent.y = t.getPositionPercentY())),
				cc.p(this._positionPercent)
			);
		},
		_getXPercent: function () {
			var t;
			return (
				this._usingLayoutComponent &&
					((t = this._getOrCreateLayoutComponent()),
					(this._positionPercent.x = t.getPositionPercentX()),
					(this._positionPercent.y = t.getPositionPercentY())),
				this._positionPercent.x
			);
		},
		_getYPercent: function () {
			var t;
			return (
				this._usingLayoutComponent &&
					((t = this._getOrCreateLayoutComponent()),
					(this._positionPercent.x = t.getPositionPercentX()),
					(this._positionPercent.y = t.getPositionPercentY())),
				this._positionPercent.y
			);
		},
		setPositionType: function (t) {
			var e;
			(this._positionType = t),
				this._usingLayoutComponent &&
					((e = this._getOrCreateLayoutComponent()),
					t === ccui.POSITION_ABSOLUTE
						? (e.setPositionPercentXEnabled(!1),
						  e.setPositionPercentYEnabled(!1))
						: (e.setPositionPercentXEnabled(!0),
						  e.setPositionPercentYEnabled(!0))),
				this._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		getPositionType: function () {
			return this._positionType;
		},
		setFlippedX: function (t) {
			var e = this.getScaleX();
			(this._flippedX = t), this.setScaleX(e);
		},
		isFlippedX: function () {
			return this._flippedX;
		},
		setFlippedY: function (t) {
			var e = this.getScaleY();
			(this._flippedY = t), this.setScaleY(e);
		},
		isFlippedY: function () {
			return this._flippedY;
		},
		_adaptRenderers: function () {},
		isBright: function () {
			return this._bright;
		},
		isEnabled: function () {
			return this._enabled;
		},
		getLeftBoundary: function () {
			return (
				this.getPositionX() -
				this._getAnchorX() * this._contentSize.width
			);
		},
		getBottomBoundary: function () {
			return (
				this.getPositionY() -
				this._getAnchorY() * this._contentSize.height
			);
		},
		getRightBoundary: function () {
			return this.getLeftBoundary() + this._contentSize.width;
		},
		getTopBoundary: function () {
			return this.getBottomBoundary() + this._contentSize.height;
		},
		getTouchBeganPosition: function () {
			return cc.p(this._touchBeganPosition);
		},
		getTouchMovePosition: function () {
			return cc.p(this._touchMovePosition);
		},
		getTouchEndPosition: function () {
			return cc.p(this._touchEndPosition);
		},
		getWidgetType: function () {
			return this._widgetType;
		},
		setLayoutParameter: function (t) {
			t &&
				((this._layoutParameterDictionary[t.getLayoutType()] = t),
				(this._layoutParameterType = t.getLayoutType()));
		},
		getLayoutParameter: function (t) {
			return (
				(t = t || this._layoutParameterType),
				this._layoutParameterDictionary[t]
			);
		},
		getDescription: function () {
			return 'Widget';
		},
		clone: function () {
			var t = this._createCloneInstance();
			return (
				t._copyProperties(this), t._copyClonedWidgetChildren(this), t
			);
		},
		_createCloneInstance: function () {
			return new ccui.Widget();
		},
		_copyClonedWidgetChildren: function (t) {
			for (var e = t.getChildren(), i = 0; i < e.length; i++) {
				var n = e[i];
				n instanceof ccui.Widget && this.addChild(n.clone());
			}
		},
		_copySpecialProperties: function (t) {},
		_copyProperties: function (t) {
			for (var e in (this.setEnabled(t.isEnabled()),
			this.setVisible(t.isVisible()),
			this.setBright(t.isBright()),
			this.setTouchEnabled(t.isTouchEnabled()),
			this.setLocalZOrder(t.getLocalZOrder()),
			this.setTag(t.getTag()),
			this.setName(t.getName()),
			this.setActionTag(t.getActionTag()),
			(this._ignoreSize = t._ignoreSize),
			this.setContentSize(t._contentSize),
			(this._customSize.width = t._customSize.width),
			(this._customSize.height = t._customSize.height),
			this._copySpecialProperties(t),
			(this._sizeType = t.getSizeType()),
			(this._sizePercent.x = t._sizePercent.x),
			(this._sizePercent.y = t._sizePercent.y),
			(this._positionType = t._positionType),
			(this._positionPercent.x = t._positionPercent.x),
			(this._positionPercent.y = t._positionPercent.y),
			this.setPosition(t.getPosition()),
			this.setAnchorPoint(t.getAnchorPoint()),
			this.setScaleX(t.getScaleX()),
			this.setScaleY(t.getScaleY()),
			this.setRotation(t.getRotation()),
			this.setRotationX(t.getRotationX()),
			this.setRotationY(t.getRotationY()),
			this.setFlippedX(t.isFlippedX()),
			this.setFlippedY(t.isFlippedY()),
			this.setColor(t.getColor()),
			this.setOpacity(t.getOpacity()),
			(this._touchEventCallback = t._touchEventCallback),
			(this._touchEventListener = t._touchEventListener),
			(this._touchEventSelector = t._touchEventSelector),
			(this._clickEventListener = t._clickEventListener),
			(this._focused = t._focused),
			(this._focusEnabled = t._focusEnabled),
			(this._propagateTouchEvents = t._propagateTouchEvents),
			t._layoutParameterDictionary)) {
				var i = t._layoutParameterDictionary[e];
				i && this.setLayoutParameter(i.clone());
			}
			this._onSizeChanged();
		},
		setActionTag: function (t) {
			this._actionTag = t;
		},
		getActionTag: function () {
			return this._actionTag;
		},
		getLeftInParent: function () {
			return (
				cc.log(
					'getLeftInParent is deprecated. Please use getLeftBoundary instead.'
				),
				this.getLeftBoundary()
			);
		},
		getBottomInParent: function () {
			return (
				cc.log(
					'getBottomInParent is deprecated. Please use getBottomBoundary instead.'
				),
				this.getBottomBoundary()
			);
		},
		getRightInParent: function () {
			return (
				cc.log(
					'getRightInParent is deprecated. Please use getRightBoundary instead.'
				),
				this.getRightBoundary()
			);
		},
		getTopInParent: function () {
			return (
				cc.log(
					'getTopInParent is deprecated. Please use getTopBoundary instead.'
				),
				this.getTopBoundary()
			);
		},
		getTouchEndPos: function () {
			return (
				cc.log(
					'getTouchEndPos is deprecated. Please use getTouchEndPosition instead.'
				),
				this.getTouchEndPosition()
			);
		},
		getTouchMovePos: function () {
			return (
				cc.log(
					'getTouchMovePos is deprecated. Please use getTouchMovePosition instead.'
				),
				this.getTouchMovePosition()
			);
		},
		clippingParentAreaContainPoint: function (t) {
			cc.log(
				'clippingParentAreaContainPoint is deprecated. Please use isClippingParentContainsPoint instead.'
			),
				this.isClippingParentContainsPoint(t);
		},
		getTouchStartPos: function () {
			return (
				cc.log(
					'getTouchStartPos is deprecated. Please use getTouchBeganPosition instead.'
				),
				this.getTouchBeganPosition()
			);
		},
		setSize: function (t) {
			this.setContentSize(t);
		},
		getSize: function () {
			return this.getContentSize();
		},
		addNode: function (t, e, i) {
			t instanceof ccui.Widget
				? cc.log('Please use addChild to add a Widget.')
				: (cc.Node.prototype.addChild.call(this, t, e, i),
				  this._nodes.push(t));
		},
		getNodeByTag: function (t) {
			for (var e = this._nodes, i = 0; i < e.length; i++) {
				var n = e[i];
				if (n && n.getTag() === t) return n;
			}
			return null;
		},
		getNodes: function () {
			return this._nodes;
		},
		removeNode: function (t, e) {
			cc.Node.prototype.removeChild.call(this, t, e),
				cc.arrayRemoveObject(this._nodes, t);
		},
		removeNodeByTag: function (t, e) {
			var i = this.getChildByTag(t);
			i
				? this.removeChild(i, e)
				: cc.log(
						'cocos2d: removeNodeByTag(tag = %d): child not found!',
						t
				  );
		},
		removeAllNodes: function () {
			for (var t = 0; t < this._nodes.length; t++) {
				var e = this._nodes[t];
				cc.Node.prototype.removeChild.call(this, e);
			}
			this._nodes.length = 0;
		},
		_findLayout: function () {
			cc.renderer.childrenOrderDirty = !0;
			for (var t = this._parent; t; ) {
				if (t._doLayout) {
					t._doLayoutDirty = !0;
					break;
				}
				t = t._parent;
			}
		},
		isUnifySizeEnabled: function () {
			return this._unifySize;
		},
		setUnifySizeEnabled: function (t) {
			this._unifySize = t;
		},
		_ccEventCallback: null,
		addCCSEventListener: function (t) {
			this._ccEventCallback = t;
		},
		setScaleX: function (t) {
			this._flippedX && (t *= -1),
				cc.Node.prototype.setScaleX.call(this, t);
		},
		setScaleY: function (t) {
			this._flippedY && (t *= -1),
				cc.Node.prototype.setScaleY.call(this, t);
		},
		setScale: function (t, e) {
			void 0 === e && (e = t), this.setScaleX(t), this.setScaleY(e);
		},
		getScaleX: function () {
			var t = cc.Node.prototype.getScaleX.call(this);
			return this._flippedX && (t *= -1), t;
		},
		getScaleY: function () {
			var t = cc.Node.prototype.getScaleY.call(this);
			return this._flippedY && (t *= -1), t;
		},
		getScale: function () {
			return (
				this.getScaleX() !== this.getScaleY() &&
					cc.log(
						"Widget#scale. ScaleX != ScaleY. Don't know which one to return"
					),
				this.getScaleX()
			);
		},
		setCallbackName: function (t) {
			this._callbackName = t;
		},
		getCallbackName: function () {
			return this._callbackName;
		},
		setCallbackType: function (t) {
			this._callbackType = t;
		},
		getCallbackType: function () {
			return this._callbackType;
		},
		setLayoutComponentEnabled: function (t) {
			this._usingLayoutComponent = t;
		},
		isLayoutComponentEnabled: function () {
			return this._usingLayoutComponent;
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? ccui.Widget.WebGLRenderCmd
					: ccui.Widget.CanvasRenderCmd
			)(this);
		},
	}));
var _p = ccui.Widget.prototype;
_p.xPercent,
	cc.defineGetterSetter(_p, 'xPercent', _p._getXPercent, _p._setXPercent),
	_p.yPercent,
	cc.defineGetterSetter(_p, 'yPercent', _p._getYPercent, _p._setYPercent),
	_p.widthPercent,
	cc.defineGetterSetter(
		_p,
		'widthPercent',
		_p._getWidthPercent,
		_p._setWidthPercent
	),
	_p.heightPercent,
	cc.defineGetterSetter(
		_p,
		'heightPercent',
		_p._getHeightPercent,
		_p._setHeightPercent
	),
	_p.widgetParent,
	cc.defineGetterSetter(_p, 'widgetParent', _p.getWidgetParent),
	_p.enabled,
	cc.defineGetterSetter(_p, 'enabled', _p.isEnabled, _p.setEnabled),
	_p.focused,
	cc.defineGetterSetter(_p, 'focused', _p.isFocused, _p.setFocused),
	_p.sizeType,
	cc.defineGetterSetter(_p, 'sizeType', _p.getSizeType, _p.setSizeType),
	_p.widgetType,
	cc.defineGetterSetter(_p, 'widgetType', _p.getWidgetType),
	_p.touchEnabled,
	cc.defineGetterSetter(
		_p,
		'touchEnabled',
		_p.isTouchEnabled,
		_p.setTouchEnabled
	),
	_p.updateEnabled,
	cc.defineGetterSetter(
		_p,
		'updateEnabled',
		_p.isUpdateEnabled,
		_p.setUpdateEnabled
	),
	_p.bright,
	cc.defineGetterSetter(_p, 'bright', _p.isBright, _p.setBright),
	_p.name,
	cc.defineGetterSetter(_p, 'name', _p.getName, _p.setName),
	_p.actionTag,
	cc.defineGetterSetter(_p, 'actionTag', _p.getActionTag, _p.setActionTag),
	_p.opacity,
	cc.defineGetterSetter(_p, 'opacity', _p.getOpacity, _p.setOpacity),
	(_p = null),
	(ccui.Widget.create = function () {
		return new ccui.Widget();
	}),
	(ccui.Widget._focusedWidget = null),
	(ccui.Widget._focusNavigationController = null),
	(ccui.Widget.enableDpadNavigation = function (t) {
		t
			? (null == ccui.Widget._focusNavigationController &&
					((ccui.Widget._focusNavigationController =
						new ccui._FocusNavigationController()),
					ccui.Widget._focusedWidget &&
						ccui.Widget._focusNavigationController._setFirstFocsuedWidget(
							ccui.Widget._focusedWidget
						)),
			  ccui.Widget._focusNavigationController.enableFocusNavigation(!0))
			: ccui.Widget._focusNavigationController &&
			  (ccui.Widget._focusNavigationController.enableFocusNavigation(!1),
			  (ccui.Widget._focusNavigationController = null));
	}),
	(ccui.Widget.getCurrentFocusedWidget = function () {
		return ccui.Widget._focusedWidget;
	}),
	(ccui.Widget.BRIGHT_STYLE_NONE = -1),
	(ccui.Widget.BRIGHT_STYLE_NORMAL = 0),
	(ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT = 1),
	(ccui.Widget.TYPE_WIDGET = 0),
	(ccui.Widget.TYPE_CONTAINER = 1),
	(ccui.Widget.LEFT = 0),
	(ccui.Widget.RIGHT = 1),
	(ccui.Widget.UP = 2),
	(ccui.Widget.DOWN = 3),
	(ccui.Widget.LOCAL_TEXTURE = 0),
	(ccui.Widget.PLIST_TEXTURE = 1),
	(ccui.Widget.TOUCH_BEGAN = 0),
	(ccui.Widget.TOUCH_MOVED = 1),
	(ccui.Widget.TOUCH_ENDED = 2),
	(ccui.Widget.TOUCH_CANCELED = 3),
	(ccui.Widget.SIZE_ABSOLUTE = 0),
	(ccui.Widget.SIZE_PERCENT = 1),
	(ccui.Widget.POSITION_ABSOLUTE = 0),
	(ccui.Widget.POSITION_PERCENT = 1),
	cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED, function () {
		var t;
		cc._renderType === cc.game.RENDER_TYPE_CANVAS
			? ((ccui.Widget.CanvasRenderCmd = function (t) {
					cc.ProtectedNode.CanvasRenderCmd.call(this, t),
						(this._needDraw = !1);
			  }),
			  ((t = ccui.Widget.CanvasRenderCmd.prototype =
					Object.create(
						cc.ProtectedNode.CanvasRenderCmd.prototype
					)).constructor = ccui.Widget.CanvasRenderCmd),
			  (t.visit = function (t) {
					var e = this._node;
					e._visible && (e._adaptRenderers(), this.pNodeVisit(t));
			  }),
			  (t.transform = function (t, e) {
					var i,
						n = this._node;
					n._visible &&
						n._running &&
						(n._adaptRenderers(),
						this._usingLayoutComponent ||
							!(i = n.getWidgetParent()) ||
							(0 !== (i = i.getContentSize()).width &&
								0 !== i.height &&
								((n._position.x =
									i.width * n._positionPercent.x),
								(n._position.y =
									i.height * n._positionPercent.y))),
						this.pNodeTransform(t, e));
			  }))
			: ((ccui.Widget.WebGLRenderCmd = function (t) {
					cc.ProtectedNode.WebGLRenderCmd.call(this, t),
						(this._needDraw = !1);
			  }),
			  ((t = ccui.Widget.WebGLRenderCmd.prototype =
					Object.create(
						cc.ProtectedNode.WebGLRenderCmd.prototype
					)).constructor = ccui.Widget.WebGLRenderCmd),
			  (t.visit = function (t) {
					var e = this._node;
					e._visible && (e._adaptRenderers(), this.pNodeVisit(t));
			  }),
			  (t.transform = function (t, e) {
					var i,
						n = this._node;
					n._visible &&
						n._running &&
						(n._adaptRenderers(),
						this._usingLayoutComponent ||
							!(i = n.getWidgetParent()) ||
							(0 !== (i = i.getContentSize()).width &&
								0 !== i.height &&
								((n._position.x =
									i.width * n._positionPercent.x),
								(n._position.y =
									i.height * n._positionPercent.y))),
						this.pNodeTransform(t, e));
			  })),
			(t.widgetVisit = t.visit),
			(t.widgetTransform = t.transform);
	}),
	(ccui.Scale9Sprite = cc.Scale9Sprite =
		cc.Node.extend({
			_spriteRect: null,
			_capInsetsInternal: null,
			_positionsAreDirty: !1,
			_scale9Image: null,
			_topLeft: null,
			_top: null,
			_topRight: null,
			_left: null,
			_centre: null,
			_right: null,
			_bottomLeft: null,
			_bottom: null,
			_bottomRight: null,
			_scale9Enabled: !0,
			_brightState: 0,
			_renderers: null,
			_opacityModifyRGB: !1,
			_originalSize: null,
			_preferredSize: null,
			_opacity: 0,
			_color: null,
			_capInsets: null,
			_insetLeft: 0,
			_insetTop: 0,
			_insetRight: 0,
			_insetBottom: 0,
			_spriteFrameRotated: !1,
			_textureLoaded: !1,
			_className: 'Scale9Sprite',
			_flippedX: !1,
			_flippedY: !1,
			textureLoaded: function () {
				return this._textureLoaded;
			},
			addLoadedEventListener: function (t, e) {
				this.addEventListener('load', t, e);
			},
			_updateCapInset: function () {
				var t = this._insetLeft,
					e = this._insetTop,
					i = this._insetRight,
					n = this._spriteRect,
					r = this._insetBottom,
					r =
						0 === t && 0 === e && 0 === i && 0 === r
							? cc.rect(0, 0, 0, 0)
							: this._spriteFrameRotated
							? cc.rect(r, t, n.width - i - t, n.height - e - r)
							: cc.rect(t, e, n.width - t - i, n.height - e - r);
				this.setCapInsets(r);
			},
			_updatePositions: function () {
				var t, e, i, n, r, o, s, c, a, l, h, u, _, d, p, f, m, g;
				this._topLeft &&
					this._topRight &&
					this._bottomRight &&
					this._bottomLeft &&
					this._centre &&
					((d = this._contentSize),
					(t = this._topLeft),
					(e = this._topRight),
					(i = this._bottomRight),
					(n = this._bottomLeft),
					(r = this._left),
					(o = this._right),
					(s = this._top),
					(c = this._bottom),
					(a = this._centre),
					(l = this._centre.getContentSize()),
					(p = t.getContentSize()),
					(g = n.getContentSize()),
					(f = d.width - p.width - e.getContentSize().width),
					(m = d.height - p.height - i.getContentSize().height),
					(h = f / l.width),
					(u = m / l.height),
					(_ = l.width * h),
					(d = l.height * u),
					(p = g.width),
					(f = g.height),
					(m = cc.p(this._offset.x * h, this._offset.y * u)),
					cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
						(_ !== (g = Math.round(_)) && (h = (_ = g) / l.width),
						d !== (g = Math.round(d)) && (u = (d = g) / l.height)),
					a.setScaleX(h),
					a.setScaleY(u),
					n.setAnchorPoint(1, 1),
					n.setPosition(p, f),
					i.setAnchorPoint(0, 1),
					i.setPosition(p + _, f),
					t.setAnchorPoint(1, 0),
					t.setPosition(p, f + d),
					e.setAnchorPoint(0, 0),
					e.setPosition(p + _, f + d),
					r.setAnchorPoint(1, 0.5),
					r.setPosition(p, f + d / 2 + m.y),
					r.setScaleY(u),
					o.setAnchorPoint(0, 0.5),
					o.setPosition(p + _, f + d / 2 + m.y),
					o.setScaleY(u),
					s.setAnchorPoint(0.5, 0),
					s.setPosition(p + _ / 2 + m.x, f + d),
					s.setScaleX(h),
					c.setAnchorPoint(0.5, 1),
					c.setPosition(p + _ / 2 + m.x, f),
					c.setScaleX(h),
					a.setAnchorPoint(0.5, 0.5),
					a.setPosition(p + _ / 2 + m.x, f + d / 2 + m.y),
					a.setScaleX(h),
					a.setScaleY(u));
			},
			ctor: function (t, e, i) {
				var n;
				cc.Node.prototype.ctor.call(this),
					(this._loader = new cc.Sprite.LoadManager()),
					(this._spriteRect = cc.rect(0, 0, 0, 0)),
					(this._capInsetsInternal = cc.rect(0, 0, 0, 0)),
					(this._originalSize = cc.size(0, 0)),
					(this._preferredSize = cc.size(0, 0)),
					(this._capInsets = cc.rect(0, 0, 0, 0)),
					(this._renderers = []),
					void 0 !== t
						? t instanceof cc.SpriteFrame
							? this.initWithSpriteFrame(t, e)
							: (n = cc.spriteFrameCache.getSpriteFrame(t))
							? this.initWithSpriteFrame(n, e)
							: this.initWithFile(t, e, i)
						: (this.init(),
						  this.setCascadeColorEnabled(!0),
						  this.setCascadeOpacityEnabled(!0),
						  this.setAnchorPoint(0.5, 0.5),
						  (this._positionsAreDirty = !0));
			},
			getSprite: function () {
				return this._scale9Image;
			},
			getOriginalSize: function () {
				return cc.size(this._originalSize);
			},
			getPreferredSize: function () {
				return cc.size(this._preferredSize);
			},
			_getPreferredWidth: function () {
				return this._preferredSize.width;
			},
			_getPreferredHeight: function () {
				return this._preferredSize.height;
			},
			_asyncSetPreferredSize: function () {
				this.removeEventListener(
					'load',
					this._asyncSetPreferredSize,
					this
				),
					this.setPreferredSize(this._cachePreferredSize),
					(this._cachePreferredSize = null);
			},
			setPreferredSize: function (t) {
				if (t) {
					if (!this._textureLoaded)
						return (
							(this._cachePreferredSize = t),
							this.removeEventListener(
								'load',
								this._asyncSetPreferredSize,
								this
							),
							this.addEventListener(
								'load',
								this._asyncSetPreferredSize,
								this
							),
							!1
						);
					this.setContentSize(t),
						(this._preferredSize = t),
						this._positionsAreDirty &&
							(this._updatePositions(),
							(this._positionsAreDirty = !1),
							this._renderCmd.setDirtyFlag(
								cc.Node._dirtyFlags.cacheDirty
							));
				}
			},
			_setPreferredWidth: function (t) {
				this._setWidth(t), (this._preferredSize.width = t);
			},
			_setPreferredHeight: function (t) {
				this._setHeight(t), (this._preferredSize.height = t);
			},
			setOpacity: function (t) {
				if (
					(cc.Node.prototype.setOpacity.call(this, t),
					this._scale9Enabled)
				)
					for (var e = this._renderers, i = 0; i < e.length; i++)
						e[i].setOpacity(t);
				else this._scale9Image && this._scale9Image.setOpacity(t);
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty);
			},
			setColor: function (t) {
				if (
					(cc.Node.prototype.setColor.call(this, t),
					this._scale9Enabled)
				)
					for (var e = this._renderers, i = 0; i < e.length; i++) {
						var n = e[i];
						n && n.setColor(t);
					}
				else this._scale9Image && this._scale9Image.setColor(t);
				this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty);
			},
			getCapInsets: function () {
				return cc.rect(this._capInsets);
			},
			_asyncSetCapInsets: function () {
				this.removeEventListener('load', this._asyncSetCapInsets, this),
					this.setCapInsets(this._cacheCapInsets),
					(this._cacheCapInsets = null);
			},
			setCapInsets: function (t) {
				var e = this._contentSize,
					i = e.width,
					e = e.height;
				if (!this._textureLoaded)
					return (
						(this._cacheCapInsets = t),
						this.removeEventListener(
							'load',
							this._asyncSetCapInsets,
							this
						),
						this.addEventListener(
							'load',
							this._asyncSetCapInsets,
							this
						),
						!1
					);
				this.updateWithSprite(
					this._scale9Image,
					this._spriteRect,
					this._spriteFrameRotated,
					this._offset,
					this._originalSize,
					t
				),
					(this._insetLeft = t.x),
					(this._insetTop = t.y),
					(this._insetRight =
						this._originalSize.width - this._insetLeft - t.width),
					(this._insetBottom =
						this._originalSize.height - this._insetTop - t.height),
					this.setContentSize(i, e);
			},
			getInsetLeft: function () {
				return this._insetLeft;
			},
			setInsetLeft: function (t) {
				(this._insetLeft = t), this._updateCapInset();
			},
			getInsetTop: function () {
				return this._insetTop;
			},
			setInsetTop: function (t) {
				(this._insetTop = t), this._updateCapInset();
			},
			getInsetRight: function () {
				return this._insetRight;
			},
			setInsetRight: function (t) {
				(this._insetRight = t), this._updateCapInset();
			},
			getInsetBottom: function () {
				return this._insetBottom;
			},
			setInsetBottom: function (t) {
				(this._insetBottom = t), this._updateCapInset();
			},
			setContentSize: function (t, e) {
				cc.Node.prototype.setContentSize.call(this, t, e),
					(this._positionsAreDirty = !0);
			},
			setAnchorPoint: function (t, e) {
				cc.Node.prototype.setAnchorPoint.call(this, t, e),
					this._scale9Enabled ||
						(this._scale9Image &&
							(this._scale9Image.setAnchorPoint(t, e),
							(this._positionsAreDirty = !0)));
			},
			_setWidth: function (t) {
				cc.Node.prototype._setWidth.call(this, t),
					(this._positionsAreDirty = !0);
			},
			_setHeight: function (t) {
				cc.Node.prototype._setHeight.call(this, t),
					(this._positionsAreDirty = !0);
			},
			init: function () {
				return this.initWithBatchNode(
					null,
					cc.rect(0, 0, 0, 0),
					!1,
					cc.rect(0, 0, 0, 0)
				);
			},
			initWithBatchNode: function (t, e, i, n) {
				return (
					!!t &&
					(void 0 === n && ((n = i), (i = !1)),
					this.updateWithBatchNode(t, e, i, n),
					this.setCascadeColorEnabled(!0),
					this.setCascadeOpacityEnabled(!0),
					this.setAnchorPoint(0.5, 0.5),
					(this._positionsAreDirty = !0))
				);
			},
			initWithFile: function (t, e, i) {
				if (
					(t instanceof cc.Rect
						? ((t = arguments[1]),
						  (i = arguments[0]),
						  (e = cc.rect(0, 0, 0, 0)))
						: ((e = e || cc.rect(0, 0, 0, 0)),
						  (i = i || cc.rect(0, 0, 0, 0))),
					!t)
				)
					throw new Error(
						'ccui.Scale9Sprite.initWithFile(): file should be non-null'
					);
				var n = cc.textureCache.getTextureForKey(t),
					r = (n = n || cc.textureCache.addImage(t)).isLoaded();
				return (
					(this._textureLoaded = r),
					this._loader.clear(),
					r
						? this.initWithBatchNode(
								new cc.SpriteBatchNode(t, 9),
								e,
								!1,
								i
						  )
						: (this._loader.once(
								n,
								function () {
									this.initWithFile(t, e, i),
										this.dispatchEvent('load');
								},
								this
						  ),
						  !1)
				);
			},
			initWithSpriteFrame: function (t, e) {
				if (!t || !t.getTexture())
					throw new Error(
						'ccui.Scale9Sprite.initWithSpriteFrame(): spriteFrame should be non-null and its texture should be non-null'
					);
				e = e || cc.rect(0, 0, 0, 0);
				var i = t.getTexture(),
					n = (this._textureLoaded = i.isLoaded());
				if ((this._loader.clear(), !n))
					return (
						this._loader.once(
							i,
							function () {
								this.initWithSpriteFrame(t, e),
									this.dispatchEvent('load');
							},
							this
						),
						!1
					);
				i = new cc.SpriteBatchNode(t.getTexture(), 9);
				return (
					this.initWithBatchNode(
						i,
						t.getRect(),
						cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
							t.isRotated(),
						e
					),
					!0
				);
			},
			initWithSpriteFrameName: function (t, e) {
				if (!t)
					throw new Error(
						'ccui.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null'
					);
				e = e || cc.rect(0, 0, 0, 0);
				t = cc.spriteFrameCache.getSpriteFrame(t);
				return null == t
					? (cc.log(
							"ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"
					  ),
					  !1)
					: this.initWithSpriteFrame(t, e);
			},
			resizableSpriteWithCapInsets: function (t) {
				var e = new ccui.Scale9Sprite();
				return e &&
					e.initWithBatchNode(
						this._scale9Image,
						this._spriteRect,
						!1,
						t
					)
					? e
					: null;
			},
			setOpacityModifyRGB: function (t) {
				if (this._scale9Image) {
					this._opacityModifyRGB = t;
					var e = this._scale9Image.getChildren();
					if (e)
						for (var i = 0, n = e.length; i < n; i++)
							e[i].setOpacityModifyRGB(t);
					this._renderCmd.setDirtyFlag(
						cc.Node._dirtyFlags.cacheDirty
					);
				}
			},
			isOpacityModifyRGB: function () {
				return this._opacityModifyRGB;
			},
			createSlicedSprites: function () {
				var t = this._originalSize.width,
					e = this._originalSize.height,
					i = this._spriteRect,
					n = Math.floor(this._offset.x + (t - i.width) / 2),
					r = Math.floor(this._offset.y + (e - i.height) / 2),
					o = i.x,
					s = i.y,
					c = this._capInsetsInternal,
					a = this._scale9Image.getTexture(),
					l = this._spriteFrameRotated,
					h = cc.rect(i.x, i.y, i.width, i.height);
				cc._rectEqualToZero(c) &&
					(c = cc.rect(t / 3, e / 3, t / 3, e / 3)),
					this._spriteFrameRotated
						? ((o -= r), (s -= n))
						: ((o -= n), (s -= r)),
					(i = cc.rect(o, s, t, e));
				var u = c.x,
					_ = c.width,
					d = i.width - (u + _),
					p = c.y,
					f = c.height,
					m = i.height - (p + f),
					g = 0,
					y = 0,
					T = cc.rect(0, 0, (u + 0.5) | 0, (p + 0.5) | 0),
					S = T;
				g += u;
				var C = cc.rect((g + 0.5) | 0, 0, (_ + 0.5) | 0, (p + 0.5) | 0);
				g += _;
				var x = cc.rect((g + 0.5) | 0, 0, (0.5 + d) | 0, (p + 0.5) | 0),
					g = 0,
					y = 0;
				y += p;
				var v = cc.rect(0, (y + 0.5) | 0, (u + 0.5) | 0, (f + 0.5) | 0);
				g += u;
				var E = cc.rect(
						(g + 0.5) | 0,
						(y + 0.5) | 0,
						(_ + 0.5) | 0,
						(f + 0.5) | 0
					),
					A = E;
				g += _;
				var b = cc.rect(
					(g + 0.5) | 0,
					(y + 0.5) | 0,
					(0.5 + d) | 0,
					(f + 0.5) | 0
				);
				(y = g = 0), (y += p), (y += f);
				var R = cc.rect(0, (y + 0.5) | 0, (u + 0.5) | 0, (0.5 + m) | 0);
				g += u;
				n = cc.rect(
					(g + 0.5) | 0,
					(y + 0.5) | 0,
					(_ + 0.5) | 0,
					(0.5 + m) | 0
				);
				g += _;
				(r = cc.rect(
					(g + 0.5) | 0,
					(y + 0.5) | 0,
					(0.5 + d) | 0,
					(0.5 + m) | 0
				)),
					(o = r),
					(s = T),
					(t = E),
					(e = r),
					(c = A),
					(i = o),
					(p = R),
					(f = x),
					(u = S),
					(_ = b),
					(g = v),
					(y = n),
					(d = C),
					(m = cc.affineTransformMakeIdentity());
				l
					? ((m = cc.affineTransformTranslate(
							m,
							h.height + h.x,
							h.y
					  )),
					  (m = cc.affineTransformRotate(m, 1.57079633)),
					  (T = cc.rectApplyAffineTransform(T, m)),
					  (E = cc.rectApplyAffineTransform(E, m)),
					  (r = cc.rectApplyAffineTransform(r, m)),
					  (A = cc.rectApplyAffineTransform(A, m)),
					  (o = cc.rectApplyAffineTransform(o, m)),
					  (R = cc.rectApplyAffineTransform(R, m)),
					  (x = cc.rectApplyAffineTransform(x, m)),
					  (S = cc.rectApplyAffineTransform(S, m)),
					  (b = cc.rectApplyAffineTransform(b, m)),
					  (v = cc.rectApplyAffineTransform(v, m)),
					  (n = cc.rectApplyAffineTransform(n, m)),
					  (C = cc.rectApplyAffineTransform(C, m)),
					  (s.x = T.x),
					  (t.x = E.x),
					  (e.x = r.x),
					  (c.x = A.x),
					  (i.x = o.x),
					  (p.x = R.x),
					  (f.x = x.x),
					  (u.x = S.x),
					  (_.x = b.x),
					  (g.x = v.x),
					  (y.x = n.x),
					  (d.x = C.x),
					  (s.y = T.y),
					  (t.y = E.y),
					  (e.y = r.y),
					  (c.y = A.y),
					  (i.y = o.y),
					  (p.y = R.y),
					  (f.y = x.y),
					  (u.y = S.y),
					  (_.y = b.y),
					  (g.y = v.y),
					  (y.y = n.y),
					  (d.y = C.y))
					: ((m = cc.affineTransformTranslate(m, h.x, h.y)),
					  (s = cc.rectApplyAffineTransform(s, m)),
					  (t = cc.rectApplyAffineTransform(t, m)),
					  (e = cc.rectApplyAffineTransform(e, m)),
					  (c = cc.rectApplyAffineTransform(c, m)),
					  (i = cc.rectApplyAffineTransform(i, m)),
					  (p = cc.rectApplyAffineTransform(p, m)),
					  (f = cc.rectApplyAffineTransform(f, m)),
					  (u = cc.rectApplyAffineTransform(u, m)),
					  (_ = cc.rectApplyAffineTransform(_, m)),
					  (g = cc.rectApplyAffineTransform(g, m)),
					  (y = cc.rectApplyAffineTransform(y, m)),
					  (d = cc.rectApplyAffineTransform(d, m))),
					this._centre || (this._centre = new cc.Sprite()),
					this._centre.initWithTexture(a, c, l),
					0 < c.width &&
						0 < c.height &&
						this._renderers.push(this._centre),
					this._top || (this._top = new cc.Sprite()),
					this._top.initWithTexture(a, d, l),
					0 < d.width &&
						0 < d.height &&
						this._renderers.push(this._top),
					this._bottom || (this._bottom = new cc.Sprite()),
					this._bottom.initWithTexture(a, y, l),
					0 < y.width &&
						0 < y.height &&
						this._renderers.push(this._bottom),
					this._left || (this._left = new cc.Sprite()),
					this._left.initWithTexture(a, g, l),
					0 < g.width &&
						0 < g.height &&
						this._renderers.push(this._left),
					this._right || (this._right = new cc.Sprite()),
					this._right.initWithTexture(a, _, l),
					0 < _.width &&
						0 < _.height &&
						this._renderers.push(this._right),
					this._topLeft || (this._topLeft = new cc.Sprite()),
					this._topLeft.initWithTexture(a, u, l),
					0 < u.width &&
						0 < u.height &&
						this._renderers.push(this._topLeft),
					this._topRight || (this._topRight = new cc.Sprite()),
					this._topRight.initWithTexture(a, f, l),
					0 < f.width &&
						0 < f.height &&
						this._renderers.push(this._topRight),
					this._bottomLeft || (this._bottomLeft = new cc.Sprite()),
					this._bottomLeft.initWithTexture(a, p, l),
					0 < p.width &&
						0 < p.height &&
						this._renderers.push(this._bottomLeft),
					this._bottomRight || (this._bottomRight = new cc.Sprite()),
					this._bottomRight.initWithTexture(a, i, l),
					0 < i.width &&
						0 < i.height &&
						this._renderers.push(this._bottomRight);
			},
			updateWithSprite: function (t, e, i, n, r, o) {
				if (!t) return !1;
				if (
					(this._loader.clear(),
					(this._textureLoaded = t._textureLoaded),
					!t._textureLoaded)
				)
					return (
						this._loader.once(
							t,
							function () {
								this.updateWithSprite(t, e, i, n, r, o),
									this.dispatchEvent('load');
							},
							this
						),
						!1
					);
				if (((this._scale9Image = t), !this._scale9Image)) return !1;
				var s = this._scale9Image.getTexture();
				this._textureLoaded = s && s.isLoaded();
				var c = t.getSpriteFrame();
				cc._renderType === cc.game.RENDER_TYPE_CANVAS &&
					c &&
					s._htmlElementObj instanceof window.HTMLCanvasElement &&
					((i = !1),
					(e = { x: 0, y: 0, height: e.height, width: e.width }));
				var a = this.getOpacity(),
					l = this.getColor();
				this._renderers.length = 0;
				var h = e,
					u = r;
				return (
					cc._rectEqualToZero(h) &&
						((c = s.getContentSize()),
						(h = cc.rect(0, 0, c.width, c.height))),
					0 === u.width &&
						0 === u.height &&
						(u = cc.size(h.width, h.height)),
					(this._capInsets = o),
					(this._spriteRect = h),
					(this._offset = n),
					(this._spriteFrameRotated = i),
					(this._originalSize = u),
					(this._preferredSize = u),
					(this._capInsetsInternal = o),
					this._scale9Enabled
						? this.createSlicedSprites()
						: this._scale9Image.initWithTexture(
								s,
								this._spriteRect,
								this._spriteFrameRotated
						  ),
					this.setState(this._brightState),
					this.setContentSize(u),
					this.setOpacity(a),
					this.setColor(l),
					!0
				);
			},
			updateWithBatchNode: function (t, e, i, n) {
				if (!t) return !1;
				var r = t.getTexture();
				if (
					(this._loader.clear(),
					!(this._textureLoaded = r.isLoaded()))
				)
					return (
						this._loader.once(
							r,
							function () {
								this.updateWithBatchNode(t, e, i, n),
									this.dispatchEvent('load');
							},
							this
						),
						!1
					);
				var o = new cc.Sprite(r),
					s = cc.p(0, 0),
					r = cc.size(e.width, e.height);
				return this.updateWithSprite(o, e, i, s, r, n);
			},
			setSpriteFrame: function (t, e) {
				e = e || cc.rect();
				var i = t.getTexture();
				if (
					((this._textureLoaded = i._textureLoaded),
					this._loader.clear(),
					!i._textureLoaded)
				)
					return (
						this._loader.once(
							t,
							function () {
								this.setSpriteFrame(t, e),
									this.dispatchEvent('load');
							},
							this
						),
						!1
					);
				i = new cc.Sprite(t.getTexture());
				this.updateWithSprite(
					i,
					t.getRect(),
					t.isRotated(),
					t.getOffset(),
					t.getOriginalSize(),
					e
				),
					(this._insetLeft = e.x),
					(this._insetTop = e.y),
					(this._insetRight =
						this._originalSize.width - this._insetLeft - e.width),
					(this._insetBottom =
						this._originalSize.height - this._insetTop - e.height);
			},
			setState: function (t) {
				(t !== ccui.Scale9Sprite.state.NORMAL &&
					t !== ccui.Scale9Sprite.state.GRAY) ||
					((this._brightState = t), this._renderCmd.setState(t));
			},
			setScale9Enabled: function (t) {
				this._scale9Enabled !== t &&
					((this._scale9Enabled = t),
					(this._renderers.length = 0),
					(cc.Node.transformDirty = !0),
					this._scale9Enabled &&
						this._scale9Image &&
						this.updateWithSprite(
							this._scale9Image,
							this._spriteRect,
							this._spriteFrameRotated,
							this._offset,
							this._originalSize,
							this._capInsets
						),
					(this._positionsAreDirty = !0));
			},
			_setRenderersPosition: function () {
				this._positionsAreDirty &&
					(this._updatePositions(),
					this._adjustScale9ImagePosition(),
					(this._positionsAreDirty = !1));
			},
			_adjustScale9ImagePosition: function () {
				var t = this._scale9Image,
					e = this._contentSize;
				t &&
					((t.x = e.width * t.getAnchorPoint().x),
					(t.y = e.height * t.getAnchorPoint().y));
			},
			_adjustScale9ImageScale: function () {
				var t = this._scale9Image,
					e = this._contentSize;
				t && t.setScale(e.width / t.width, e.height / t.height);
			},
			setFlippedX: function (t) {
				var e = this.getScaleX();
				(this._flippedX = t),
					this.setScaleX(e),
					this._renderCmd.setDirtyFlag(
						cc.Node._dirtyFlags.cacheDirty
					);
			},
			isFlippedX: function () {
				return this._flippedX;
			},
			setFlippedY: function (t) {
				var e = this.getScaleY();
				(this._flippedY = t),
					this.setScaleY(e),
					this._renderCmd.setDirtyFlag(
						cc.Node._dirtyFlags.cacheDirty
					);
			},
			isFlippedY: function () {
				return this._flippedY;
			},
			setScaleX: function (t) {
				this._flippedX && (t *= -1),
					cc.Node.prototype.setScaleX.call(this, t),
					this._renderCmd.setDirtyFlag(
						cc.Node._dirtyFlags.cacheDirty
					);
			},
			setScaleY: function (t) {
				this._flippedY && (t *= -1),
					cc.Node.prototype.setScaleY.call(this, t),
					this._renderCmd.setDirtyFlag(
						cc.Node._dirtyFlags.cacheDirty
					);
			},
			setScale: function (t, e) {
				void 0 === e && (e = t), this.setScaleX(t), this.setScaleY(e);
			},
			getScaleX: function () {
				var t = cc.Node.prototype.getScaleX.call(this);
				return this._flippedX && (t *= -1), t;
			},
			getScaleY: function () {
				var t = cc.Node.prototype.getScaleY.call(this);
				return this._flippedY && (t *= -1), t;
			},
			getScale: function () {
				return (
					this.getScaleX() !== this.getScaleY() &&
						cc.log(
							"Scale9Sprite#scale. ScaleX != ScaleY. Don't know which one to return"
						),
					this.getScaleX()
				);
			},
			_createRenderCmd: function () {
				return new (
					cc._renderType === cc.game.RENDER_TYPE_CANVAS
						? ccui.Scale9Sprite.CanvasRenderCmd
						: ccui.Scale9Sprite.WebGLRenderCmd
				)(this);
			},
		}));
var _p = ccui.Scale9Sprite.prototype;
cc.EventHelper.prototype.apply(_p),
	_p.preferredSize,
	cc.defineGetterSetter(
		_p,
		'preferredSize',
		_p.getPreferredSize,
		_p.setPreferredSize
	),
	_p.capInsets,
	cc.defineGetterSetter(_p, 'capInsets', _p.getCapInsets, _p.setCapInsets),
	_p.insetLeft,
	cc.defineGetterSetter(_p, 'insetLeft', _p.getInsetLeft, _p.setInsetLeft),
	_p.insetTop,
	cc.defineGetterSetter(_p, 'insetTop', _p.getInsetTop, _p.setInsetTop),
	_p.insetRight,
	cc.defineGetterSetter(_p, 'insetRight', _p.getInsetRight, _p.setInsetRight),
	_p.insetBottom,
	cc.defineGetterSetter(
		_p,
		'insetBottom',
		_p.getInsetBottom,
		_p.setInsetBottom
	),
	(_p = null),
	(ccui.Scale9Sprite.create = function (t, e, i) {
		return new ccui.Scale9Sprite(t, e, i);
	}),
	(ccui.Scale9Sprite.createWithSpriteFrame = function (t, e) {
		return new ccui.Scale9Sprite(t, e);
	}),
	(ccui.Scale9Sprite.createWithSpriteFrameName = function (t, e) {
		return new ccui.Scale9Sprite(t, e);
	}),
	(ccui.Scale9Sprite.POSITIONS_CENTRE = 0),
	(ccui.Scale9Sprite.POSITIONS_TOP = 1),
	(ccui.Scale9Sprite.POSITIONS_LEFT = 2),
	(ccui.Scale9Sprite.POSITIONS_RIGHT = 3),
	(ccui.Scale9Sprite.POSITIONS_BOTTOM = 4),
	(ccui.Scale9Sprite.POSITIONS_TOPRIGHT = 5),
	(ccui.Scale9Sprite.POSITIONS_TOPLEFT = 6),
	(ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT = 7),
	(ccui.Scale9Sprite.state = { NORMAL: 0, GRAY: 1 }),
	(function () {
		ccui.Scale9Sprite.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._cachedParent = null),
				(this._cacheDirty = !1),
				(this._state = ccui.Scale9Sprite.state.NORMAL);
			var e = this._node,
				i = (this._cacheCanvas = document.createElement('canvas'));
			(i.width = 1),
				(i.height = 1),
				(this._cacheContext = new cc.CanvasContextWrapper(
					i.getContext('2d')
				));
			t = this._cacheTexture = new cc.Texture2D();
			t.initWithElement(i),
				t.handleLoadedTexture(),
				(this._cacheSprite = new cc.Sprite(t)),
				this._cacheSprite.setAnchorPoint(0, 0),
				e.addChild(this._cacheSprite);
		};
		var t = (ccui.Scale9Sprite.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = ccui.Scale9Sprite.CanvasRenderCmd),
			(t.visit = function (t) {
				var e = this._node;
				e._visible &&
					(e._positionsAreDirty &&
						(e._updatePositions(), (e._positionsAreDirty = !1)),
					this.originVisit(t));
			}),
			(t.transform = function (t) {
				var e = this._node;
				cc.Node.CanvasRenderCmd.prototype.transform.call(this, t),
					e._positionsAreDirty &&
						(e._updatePositions(), (e._positionsAreDirty = !1));
				for (var i = e._children, n = 0; n < i.length; n++)
					i[n].transform(this, !0);
			}),
			(t._updateDisplayColor = function (t) {
				cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(
					this,
					t
				);
				var e = this._node;
				if (e) {
					var i = e._renderers;
					if (e._scale9Enabled)
						for (var n = i.length, r = 0; r < n; r++) {
							var o = i[r];
							if (!o) break;
							o._renderCmd._updateDisplayColor(t),
								o._renderCmd._updateColor();
						}
					else
						e._scale9Image &&
							(e._scale9Image._renderCmd._updateDisplayColor(t),
							e._scale9Image._renderCmd._updateColor());
				}
			}),
			(t.updateStatus = function () {
				var t = cc.Node._dirtyFlags,
					e = this._dirtyFlag;
				cc.Node.RenderCmd.prototype.updateStatus.call(this),
					e & t.cacheDirty &&
						(this._cacheScale9Sprite(),
						(this._dirtyFlag =
							(this._dirtyFlag & t.cacheDirty) ^
							this._dirtyFlag));
			}),
			(t._syncStatus = function (t) {
				var e = cc.Node._dirtyFlags,
					i = this._dirtyFlag;
				cc.Node.RenderCmd.prototype._syncStatus.call(this, t),
					i & e.cacheDirty &&
						(this._cacheScale9Sprite(),
						(this._dirtyFlag =
							(this._dirtyFlag & e.cacheDirty) ^
							this._dirtyFlag));
			}),
			(t._cacheScale9Sprite = function () {
				var t = this._node;
				if (t._scale9Image) {
					var e = cc.contentScaleFactor(),
						i = t._contentSize,
						n = cc.size(i.width * e, i.height * e),
						r = this._cacheCanvas,
						o = this._cacheContext,
						s = o.getContext(),
						c = !1;
					if (
						((r.width === n.width && r.height === n.height) ||
							((r.width = n.width),
							(r.height = n.height),
							(c = !0)),
						cc.renderer._turnToCacheMode(t.__instanceId),
						t._scale9Enabled)
					) {
						var a = t._renderers;
						t._setRenderersPosition();
						for (var l = a.length, h = 0; h < l; h++) {
							var u = a[h];
							if (!u) break;
							(_ = u._renderCmd).updateStatus(),
								cc.renderer.pushRenderCommand(_);
						}
					} else {
						var _ = t._scale9Image._renderCmd;
						t._adjustScale9ImagePosition(),
							t._adjustScale9ImageScale(),
							_.updateStatus(),
							cc.renderer.pushRenderCommand(
								t._scale9Image._renderCmd
							);
					}
					r = t._scale9Image.getTexture();
					r &&
						this._state === ccui.Scale9Sprite.state.GRAY &&
						r._switchToGray(!0),
						s.setTransform(1, 0, 0, 1, 0, 0),
						s.clearRect(0, 0, n.width, n.height),
						cc.renderer._renderingToCacheCanvas(
							o,
							t.__instanceId,
							e,
							e
						),
						cc.renderer._turnToNormalMode(),
						r &&
							this._state === ccui.Scale9Sprite.state.GRAY &&
							r._switchToGray(!1),
						c &&
							this._cacheSprite.setTextureRect(
								cc.rect(0, 0, i.width, i.height)
							),
						this._cacheSprite.getParent() ||
							t.addChild(this._cacheSprite, -1),
						this._cacheSprite._renderCmd._updateColor();
				}
			}),
			(t.setState = function (t) {
				this._node._scale9Image &&
					((this._state = t),
					this.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty));
			});
	})(),
	(function () {
		var t;
		cc.Node.WebGLRenderCmd &&
			((ccui.Scale9Sprite.WebGLRenderCmd = function (t) {
				cc.Node.WebGLRenderCmd.call(this, t),
					(this._cachedParent = null),
					(this._cacheDirty = !1);
			}),
			((t = ccui.Scale9Sprite.WebGLRenderCmd.prototype =
				Object.create(cc.Node.WebGLRenderCmd.prototype)).constructor =
				ccui.Scale9Sprite.WebGLRenderCmd),
			(t.setShaderProgram = function (t) {
				var e = this._node;
				if (e._scale9Enabled)
					for (var i = e._renderers, n = i.length, r = 0; r < n; r++)
						i[r] && (i[r]._renderCmd._shaderProgram = t);
				else e._scale9Image._renderCmd._shaderProgram = t;
				this._shaderProgram = t;
			}),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible && e._scale9Image) {
					if (
						(e._positionsAreDirty &&
							(e._updatePositions(), (e._positionsAreDirty = !1)),
						(t = t || this.getParentRenderCmd()),
						e._parent &&
							e._parent._renderCmd &&
							(this._curLevel =
								e._parent._renderCmd._curLevel + 1),
						this._syncStatus(t),
						e._scale9Enabled)
					)
						for (
							var i = e._renderers, n = i.length, r = 0;
							r < n;
							r++
						) {
							var o = i[r];
							if (!o) break;
							o._renderCmd.visit(this);
						}
					else
						e._adjustScale9ImageScale(),
							e._adjustScale9ImagePosition(),
							e._scale9Image._renderCmd.visit(this);
					(this._dirtyFlag = 0), this.originVisit(t);
				}
			}),
			(t.transform = function (t, e) {
				var i = this._node;
				if (
					((t = t || this.getParentRenderCmd()),
					this.originTransform(t, e),
					i._positionsAreDirty &&
						(i._updatePositions(), (i._positionsAreDirty = !1)),
					i._scale9Enabled)
				)
					for (
						var n = i._renderers,
							r = n.length,
							o = cc.Node._dirtyFlags,
							s = 0;
						s < r;
						s++
					) {
						var c = n[s];
						if (!c) break;
						c._vertexZ = t._node._vertexZ;
						c = c._renderCmd;
						c.transform(this, !0),
							(c._dirtyFlag =
								(c._dirtyFlag & o.transformDirty) ^
								c._dirtyFlag);
					}
				else
					i._adjustScale9ImageScale(),
						i._adjustScale9ImagePosition(),
						i._scale9Image._renderCmd.transform(this, !0);
			}),
			(t.setDirtyFlag = function (t, e) {
				t === cc.Node._dirtyFlags.cacheDirty &&
					(t = cc.Node._dirtyFlags.transformDirty),
					cc.Node.RenderCmd.prototype.setDirtyFlag.call(this, t, e);
			}),
			(t._syncStatus = function (t) {
				cc.Node.WebGLRenderCmd.prototype._syncStatus.call(this, t),
					this._updateDisplayColor(this._displayedColor),
					this._updateDisplayOpacity(this._displayedOpacity);
			}),
			(t._updateDisplayColor = function (t) {
				cc.Node.WebGLRenderCmd.prototype._updateDisplayColor.call(
					this,
					t
				);
				var e = this._node,
					i = e._scale9Image;
				if (((t = this._displayedColor), e._scale9Enabled))
					for (var n = e._renderers, r = 0; r < n.length; r++)
						n[r]._renderCmd._updateDisplayColor(t),
							n[r]._renderCmd._updateColor();
				else
					i._renderCmd._updateDisplayColor(t),
						i._renderCmd._updateColor();
			}),
			(t._updateDisplayOpacity = function (t) {
				cc.Node.WebGLRenderCmd.prototype._updateDisplayOpacity.call(
					this,
					t
				);
				var e = this._node,
					i = e._scale9Image;
				if (((t = this._displayedOpacity), e._scale9Enabled))
					for (var n = e._renderers, r = 0; r < n.length; r++)
						n[r]._renderCmd._updateDisplayOpacity(t),
							n[r]._renderCmd._updateColor();
				else
					i._renderCmd._updateDisplayOpacity(t),
						i._renderCmd._updateColor();
			}),
			(t.setState = function (t) {
				t === ccui.Scale9Sprite.state.NORMAL
					? this.setShaderProgram(
							cc.shaderCache.programForKey(
								cc.SHADER_SPRITE_POSITION_TEXTURECOLOR
							)
					  )
					: t === ccui.Scale9Sprite.state.GRAY &&
					  this.setShaderProgram(
							ccui.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram()
					  );
			}),
			(ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram = null),
			(ccui.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram =
				function () {
					var t = ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram;
					return (
						t ||
						((t = new cc.GLProgram()).initWithVertexShaderByteArray(
							cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,
							ccui.Scale9Sprite.WebGLRenderCmd._grayShaderFragment
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_POSITION,
							cc.VERTEX_ATTRIB_POSITION
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_COLOR,
							cc.VERTEX_ATTRIB_COLOR
						),
						t.addAttribute(
							cc.ATTRIBUTE_NAME_TEX_COORD,
							cc.VERTEX_ATTRIB_TEX_COORDS
						),
						t.link(),
						t.updateUniforms(),
						(ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram =
							t))
					);
				}),
			(ccui.Scale9Sprite.WebGLRenderCmd._grayShaderFragment =
				'precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    gl_FragColor.xyz = vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b); \n     gl_FragColor.w = c.w ; \n}'));
	})(),
	(ccui.Layout = ccui.Widget.extend({
		_clippingEnabled: !1,
		_backGroundScale9Enabled: null,
		_backGroundImage: null,
		_backGroundImageFileName: null,
		_backGroundImageCapInsets: null,
		_colorType: null,
		_bgImageTexType: ccui.Widget.LOCAL_TEXTURE,
		_colorRender: null,
		_gradientRender: null,
		_color: null,
		_startColor: null,
		_endColor: null,
		_alongVector: null,
		_opacity: 255,
		_backGroundImageTextureSize: null,
		_layoutType: null,
		_doLayoutDirty: !0,
		_clippingRectDirty: !0,
		_clippingType: null,
		_clippingStencil: null,
		_scissorRectDirty: !1,
		_clippingRect: null,
		_clippingParent: null,
		_className: 'Layout',
		_backGroundImageColor: null,
		_finalPositionX: 0,
		_finalPositionY: 0,
		_backGroundImageOpacity: 0,
		_loopFocus: !1,
		__passFocusToChild: !0,
		_isFocusPassing: !1,
		_isInterceptTouch: !1,
		ctor: function () {
			(this._layoutType = ccui.Layout.ABSOLUTE),
				(this._widgetType = ccui.Widget.TYPE_CONTAINER),
				(this._clippingType = ccui.Layout.CLIPPING_SCISSOR),
				(this._colorType = ccui.Layout.BG_COLOR_NONE),
				ccui.Widget.prototype.ctor.call(this),
				this.ignoreContentAdaptWithSize(!1),
				this.setContentSize(cc.size(0, 0)),
				this.setAnchorPoint(0, 0),
				(this.onPassFocusToChild =
					this._findNearestChildWidgetIndex.bind(this)),
				(this._backGroundImageCapInsets = cc.rect(0, 0, 0, 0)),
				(this._color = cc.color(255, 255, 255, 255)),
				(this._startColor = cc.color(255, 255, 255, 255)),
				(this._endColor = cc.color(255, 255, 255, 255)),
				(this._alongVector = cc.p(0, -1)),
				(this._backGroundImageTextureSize = cc.size(0, 0)),
				(this._clippingRect = cc.rect(0, 0, 0, 0)),
				(this._backGroundImageColor = cc.color(255, 255, 255, 255));
		},
		onEnter: function () {
			ccui.Widget.prototype.onEnter.call(this),
				this._clippingStencil && this._clippingStencil.onEnter(),
				(this._doLayoutDirty = !0),
				(this._clippingRectDirty = !0);
		},
		onExit: function () {
			ccui.Widget.prototype.onExit.call(this),
				this._clippingStencil && this._clippingStencil.onExit();
		},
		setLoopFocus: function (t) {
			this._loopFocus = t;
		},
		isLoopFocus: function () {
			return this._loopFocus;
		},
		setPassFocusToChild: function (t) {
			this.__passFocusToChild = t;
		},
		isPassFocusToChild: function () {
			return this.__passFocusToChild;
		},
		findNextFocusedWidget: function (t, e) {
			if (this._isFocusPassing || this.isFocused()) {
				var i = this.getParent();
				if (((this._isFocusPassing = !1), this.__passFocusToChild)) {
					var n = this._passFocusToChild(t, e);
					return n instanceof ccui.Layout && i
						? ((i._isFocusPassing = !0),
						  i.findNextFocusedWidget(t, this))
						: n;
				}
				return null != i && i instanceof ccui.Layout
					? ((i._isFocusPassing = !0),
					  i.findNextFocusedWidget(t, this))
					: this;
			}
			if (!(e.isFocused() || e instanceof ccui.Layout)) return e;
			if (this._layoutType === ccui.Layout.LINEAR_HORIZONTAL)
				switch (t) {
					case ccui.Widget.LEFT:
						return this._getPreviousFocusedWidget(t, e);
					case ccui.Widget.RIGHT:
						return this._getNextFocusedWidget(t, e);
					case ccui.Widget.DOWN:
					case ccui.Widget.UP:
						return !this._isLastWidgetInContainer(this, t) ||
							this._isWidgetAncestorSupportLoopFocus(e, t)
							? ccui.Widget.prototype.findNextFocusedWidget.call(
									this,
									t,
									this
							  )
							: e;
					default:
						return cc.assert(0, 'Invalid Focus Direction'), e;
				}
			else {
				if (this._layoutType !== ccui.Layout.LINEAR_VERTICAL)
					return (
						cc.assert(
							0,
							'Un Supported Layout type, please use VBox and HBox instead!!!'
						),
						e
					);
				switch (t) {
					case ccui.Widget.LEFT:
					case ccui.Widget.RIGHT:
						return !this._isLastWidgetInContainer(this, t) ||
							this._isWidgetAncestorSupportLoopFocus(e, t)
							? ccui.Widget.prototype.findNextFocusedWidget.call(
									this,
									t,
									this
							  )
							: e;
					case ccui.Widget.DOWN:
						return this._getNextFocusedWidget(t, e);
					case ccui.Widget.UP:
						return this._getPreviousFocusedWidget(t, e);
					default:
						return cc.assert(0, 'Invalid Focus Direction'), e;
				}
			}
		},
		onPassFocusToChild: null,
		addChild: function (t, e, i) {
			t instanceof ccui.Widget &&
				this._supplyTheLayoutParameterLackToChild(t),
				ccui.Widget.prototype.addChild.call(this, t, e, i),
				(this._doLayoutDirty = !0);
		},
		removeChild: function (t, e) {
			ccui.Widget.prototype.removeChild.call(this, t, e),
				(this._doLayoutDirty = !0);
		},
		removeAllChildren: function (t) {
			ccui.Widget.prototype.removeAllChildren.call(this, t),
				(this._doLayoutDirty = !0);
		},
		removeAllChildrenWithCleanup: function (t) {
			ccui.Widget.prototype.removeAllChildrenWithCleanup.call(this, t),
				(this._doLayoutDirty = !0);
		},
		isClippingEnabled: function () {
			return this._clippingEnabled;
		},
		visit: function (t) {
			if (this._visible)
				if (
					(this._adaptRenderers(),
					this._doLayout(),
					this._clippingEnabled)
				)
					switch (this._clippingType) {
						case ccui.Layout.CLIPPING_STENCIL:
							this._renderCmd.stencilClippingVisit(t);
							break;
						case ccui.Layout.CLIPPING_SCISSOR:
							this._renderCmd.scissorClippingVisit(t);
					}
				else ccui.Widget.prototype.visit.call(this, t);
		},
		setClippingEnabled: function (t) {
			if (t !== this._clippingEnabled)
				switch (((this._clippingEnabled = t), this._clippingType)) {
					case ccui.Layout.CLIPPING_SCISSOR:
					case ccui.Layout.CLIPPING_STENCIL:
						t
							? ((this._clippingStencil = new cc.DrawNode()),
							  this._renderCmd.rebindStencilRendering(
									this._clippingStencil
							  ),
							  this._running && this._clippingStencil.onEnter(),
							  this._setStencilClippingSize(this._contentSize))
							: (this._running &&
									this._clippingStencil &&
									this._clippingStencil.onExit(),
							  (this._clippingStencil = null));
				}
		},
		setClippingType: function (t) {
			var e;
			t !== this._clippingType &&
				((e = this.isClippingEnabled()),
				this.setClippingEnabled(!1),
				(this._clippingType = t),
				this.setClippingEnabled(e));
		},
		getClippingType: function () {
			return this._clippingType;
		},
		_setStencilClippingSize: function (t) {
			var e, i;
			this._clippingEnabled &&
				(((e = [])[0] = cc.p(0, 0)),
				(e[1] = cc.p(t.width, 0)),
				(e[2] = cc.p(t.width, t.height)),
				(e[3] = cc.p(0, t.height)),
				(i = cc.color.GREEN),
				this._clippingStencil.clear(),
				this._clippingStencil.setLocalBB &&
					this._clippingStencil.setLocalBB(0, 0, t.width, t.height),
				this._clippingStencil.drawPoly(e, 4, i, 0, i));
		},
		_getClippingRect: function () {
			if (this._clippingRectDirty) {
				for (
					var t,
						e = this.convertToWorldSpace(cc.p(0, 0)),
						i = this.getNodeToWorldTransform(),
						n = this._contentSize.width * i.a,
						r = this._contentSize.height * i.d,
						o = this;
					o;

				)
					if (
						(o = o.getParent()) &&
						o instanceof ccui.Layout &&
						o.isClippingEnabled()
					) {
						this._clippingParent = o;
						break;
					}
				this._clippingParent
					? ((t = this._clippingParent._getClippingRect()),
					  (this._clippingRect.x = Math.max(e.x, t.x)),
					  (this._clippingRect.y = Math.max(e.y, t.y)),
					  (i = Math.min(e.x + n, t.x + t.width)),
					  (t = Math.min(e.y + r, t.y + t.height)),
					  (this._clippingRect.width = Math.max(
							0,
							i - this._clippingRect.x
					  )),
					  (this._clippingRect.height = Math.max(
							0,
							t - this._clippingRect.y
					  )))
					: ((this._clippingRect.x = e.x),
					  (this._clippingRect.y = e.y),
					  (this._clippingRect.width = n),
					  (this._clippingRect.height = r)),
					(this._clippingRectDirty = !1);
			}
			return this._clippingRect;
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this);
			var t = this._contentSize;
			this._setStencilClippingSize(t),
				(this._doLayoutDirty = !0),
				(this._clippingRectDirty = !0),
				this._backGroundImage &&
					(this._backGroundImage.setPosition(
						0.5 * t.width,
						0.5 * t.height
					),
					this._backGroundScale9Enabled &&
						this._backGroundImage instanceof ccui.Scale9Sprite &&
						this._backGroundImage.setPreferredSize(t)),
				this._colorRender && this._colorRender.setContentSize(t),
				this._gradientRender && this._gradientRender.setContentSize(t);
		},
		setBackGroundImageScale9Enabled: function (t) {
			this._backGroundScale9Enabled !== t &&
				(this.removeProtectedChild(this._backGroundImage),
				(this._backGroundImage = null),
				(this._backGroundScale9Enabled = t),
				this._addBackGroundImage(),
				this.setBackGroundImage(
					this._backGroundImageFileName,
					this._bgImageTexType
				),
				this.setBackGroundImageCapInsets(
					this._backGroundImageCapInsets
				));
		},
		isBackGroundImageScale9Enabled: function () {
			return this._backGroundScale9Enabled;
		},
		setBackGroundImage: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					null === this._backGroundImage &&
						(this._addBackGroundImage(),
						this.setBackGroundImageScale9Enabled(
							this._backGroundScale9Enabled
						)),
					(this._backGroundImageFileName = t),
					(this._bgImageTexType = e);
				var i = this._backGroundImage;
				switch (this._bgImageTexType) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._backGroundScale9Enabled &&
					i.setPreferredSize(this._contentSize),
					(this._backGroundImageTextureSize = i.getContentSize()),
					i.setPosition(
						0.5 * this._contentSize.width,
						0.5 * this._contentSize.height
					),
					this._updateBackGroundImageColor();
			}
		},
		setBackGroundImageCapInsets: function (t) {
			var e;
			t &&
				(((e = this._backGroundImageCapInsets).x = t.x),
				(e.y = t.y),
				(e.width = t.width),
				(e.height = t.height),
				this._backGroundScale9Enabled &&
					this._backGroundImage.setCapInsets(t));
		},
		getBackGroundImageCapInsets: function () {
			return cc.rect(this._backGroundImageCapInsets);
		},
		_supplyTheLayoutParameterLackToChild: function (t) {
			if (t)
				switch (this._layoutType) {
					case ccui.Layout.ABSOLUTE:
						break;
					case ccui.Layout.LINEAR_HORIZONTAL:
					case ccui.Layout.LINEAR_VERTICAL:
						t.getLayoutParameter(ccui.LayoutParameter.LINEAR) ||
							t.setLayoutParameter(
								new ccui.LinearLayoutParameter()
							);
						break;
					case ccui.Layout.RELATIVE:
						t.getLayoutParameter(ccui.LayoutParameter.RELATIVE) ||
							t.setLayoutParameter(
								new ccui.RelativeLayoutParameter()
							);
				}
		},
		_addBackGroundImage: function () {
			var t = this._contentSize;
			this._backGroundScale9Enabled
				? ((this._backGroundImage = new ccui.Scale9Sprite()),
				  this._backGroundImage.setPreferredSize(t))
				: (this._backGroundImage = new cc.Sprite()),
				this.addProtectedChild(
					this._backGroundImage,
					ccui.Layout.BACKGROUND_IMAGE_ZORDER,
					-1
				),
				this._backGroundImage.setPosition(
					0.5 * t.width,
					0.5 * t.height
				);
		},
		removeBackGroundImage: function () {
			this._backGroundImage &&
				(this.removeProtectedChild(this._backGroundImage),
				(this._backGroundImage = null),
				(this._backGroundImageFileName = ''),
				(this._backGroundImageTextureSize.width = 0),
				(this._backGroundImageTextureSize.height = 0));
		},
		setBackGroundColorType: function (t) {
			if (this._colorType !== t) {
				switch (this._colorType) {
					case ccui.Layout.BG_COLOR_NONE:
						this._colorRender &&
							(this.removeProtectedChild(this._colorRender),
							(this._colorRender = null)),
							this._gradientRender &&
								(this.removeProtectedChild(
									this._gradientRender
								),
								(this._gradientRender = null));
						break;
					case ccui.Layout.BG_COLOR_SOLID:
						this._colorRender &&
							(this.removeProtectedChild(this._colorRender),
							(this._colorRender = null));
						break;
					case ccui.Layout.BG_COLOR_GRADIENT:
						this._gradientRender &&
							(this.removeProtectedChild(this._gradientRender),
							(this._gradientRender = null));
				}
				switch (((this._colorType = t), this._colorType)) {
					case ccui.Layout.BG_COLOR_NONE:
						break;
					case ccui.Layout.BG_COLOR_SOLID:
						(this._colorRender = new cc.LayerColor()),
							this._colorRender.setContentSize(this._contentSize),
							this._colorRender.setOpacity(this._opacity),
							this._colorRender.setColor(this._color),
							this.addProtectedChild(
								this._colorRender,
								ccui.Layout.BACKGROUND_RENDERER_ZORDER,
								-1
							);
						break;
					case ccui.Layout.BG_COLOR_GRADIENT:
						(this._gradientRender = new cc.LayerGradient(
							cc.color(255, 0, 0, 255),
							cc.color(0, 255, 0, 255)
						)),
							this._gradientRender.setContentSize(
								this._contentSize
							),
							this._gradientRender.setOpacity(this._opacity),
							this._gradientRender.setStartColor(
								this._startColor
							),
							this._gradientRender.setEndColor(this._endColor),
							this._gradientRender.setVector(this._alongVector),
							this.addProtectedChild(
								this._gradientRender,
								ccui.Layout.BACKGROUND_RENDERER_ZORDER,
								-1
							);
				}
			}
		},
		getBackGroundColorType: function () {
			return this._colorType;
		},
		setBackGroundColor: function (t, e) {
			e
				? ((this._startColor.r = t.r),
				  (this._startColor.g = t.g),
				  (this._startColor.b = t.b),
				  this._gradientRender && this._gradientRender.setStartColor(t),
				  (this._endColor.r = e.r),
				  (this._endColor.g = e.g),
				  (this._endColor.b = e.b),
				  this._gradientRender && this._gradientRender.setEndColor(e))
				: ((this._color.r = t.r),
				  (this._color.g = t.g),
				  (this._color.b = t.b),
				  this._colorRender && this._colorRender.setColor(t));
		},
		getBackGroundColor: function () {
			var t = this._color;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		getBackGroundStartColor: function () {
			var t = this._startColor;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		getBackGroundEndColor: function () {
			var t = this._endColor;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		setBackGroundColorOpacity: function (t) {
			switch (((this._opacity = t), this._colorType)) {
				case ccui.Layout.BG_COLOR_NONE:
					break;
				case ccui.Layout.BG_COLOR_SOLID:
					this._colorRender.setOpacity(t);
					break;
				case ccui.Layout.BG_COLOR_GRADIENT:
					this._gradientRender.setOpacity(t);
			}
		},
		getBackGroundColorOpacity: function () {
			return this._opacity;
		},
		setBackGroundColorVector: function (t) {
			(this._alongVector.x = t.x),
				(this._alongVector.y = t.y),
				this._gradientRender && this._gradientRender.setVector(t);
		},
		getBackGroundColorVector: function () {
			return this._alongVector;
		},
		setBackGroundImageColor: function (t) {
			(this._backGroundImageColor.r = t.r),
				(this._backGroundImageColor.g = t.g),
				(this._backGroundImageColor.b = t.b),
				this._updateBackGroundImageColor();
		},
		setBackGroundImageOpacity: function (t) {
			(this._backGroundImageColor.a = t), this.getBackGroundImageColor();
		},
		getBackGroundImageColor: function () {
			var t = this._backGroundImageColor;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		getBackGroundImageOpacity: function () {
			return this._backGroundImageColor.a;
		},
		_updateBackGroundImageColor: function () {
			this._backGroundImage &&
				this._backGroundImage.setColor(this._backGroundImageColor);
		},
		getBackGroundImageTextureSize: function () {
			return this._backGroundImageTextureSize;
		},
		setLayoutType: function (t) {
			this._layoutType = t;
			for (var e, i = this._children, n = 0; n < i.length; n++)
				(e = i[n]) instanceof ccui.Widget &&
					this._supplyTheLayoutParameterLackToChild(e);
			this._doLayoutDirty = !0;
		},
		getLayoutType: function () {
			return this._layoutType;
		},
		requestDoLayout: function () {
			this._doLayoutDirty = !0;
		},
		_doLayout: function () {
			var t;
			this._doLayoutDirty &&
				(this.sortAllChildren(),
				(t = ccui.getLayoutManager(this._layoutType)) &&
					t._doLayout(this),
				(this._doLayoutDirty = !1));
		},
		_getLayoutContentSize: function () {
			return this.getContentSize();
		},
		_getLayoutElements: function () {
			return this.getChildren();
		},
		_updateBackGroundImageOpacity: function () {
			this._backGroundImage &&
				this._backGroundImage.setOpacity(this._backGroundImageOpacity);
		},
		_updateBackGroundImageRGBA: function () {
			this._backGroundImage &&
				(this._backGroundImage.setColor(this._backGroundImageColor),
				this._backGroundImage.setOpacity(this._backGroundImageOpacity));
		},
		_getLayoutAccumulatedSize: function () {
			for (
				var t = this.getChildren(),
					e = cc.size(0, 0),
					i = 0,
					n = 0,
					r = t.length;
				n < r;
				n++
			) {
				var o,
					s,
					c = t[n];
				null !== c && c instanceof ccui.Layout
					? ((s = c._getLayoutAccumulatedSize()),
					  (e.width += s.width),
					  (e.height += s.height))
					: c instanceof ccui.Widget &&
					  (i++,
					  (o = c.getLayoutParameter().getMargin()),
					  (s = c.getContentSize()),
					  (e.width += s.width + 0.5 * (o.right + o.left)),
					  (e.height += s.height + 0.5 * (o.top + o.bottom)));
			}
			var a = this.getLayoutType();
			return (
				a === ccui.Layout.LINEAR_HORIZONTAL &&
					(e.height = e.height - (e.height / i) * (i - 1)),
				a === ccui.Layout.LINEAR_VERTICAL &&
					(e.width = e.width - (e.width / i) * (i - 1)),
				e
			);
		},
		_findNearestChildWidgetIndex: function (t, e) {
			if (null == e || e === this)
				return this._findFirstFocusEnabledWidgetIndex();
			var i,
				n = 0,
				r = this.getChildren(),
				o = r.length,
				s = cc.FLT_MAX,
				c = 0;
			if (
				t !== ccui.Widget.LEFT &&
				t !== ccui.Widget.RIGHT &&
				t !== ccui.Widget.DOWN &&
				t !== ccui.Widget.UP
			)
				return cc.log('invalid focus direction!'), 0;
			for (i = this._getWorldCenterPoint(e); n < o; ) {
				var a = r[n];
				a &&
					a instanceof ccui.Widget &&
					a.isFocusEnabled() &&
					(a =
						a instanceof ccui.Layout
							? a._calculateNearestDistance(e)
							: cc.pLength(
									cc.pSub(this._getWorldCenterPoint(a), i)
							  )) < s &&
					((c = n), (s = a)),
					n++;
			}
			return c;
		},
		_findFarthestChildWidgetIndex: function (t, e) {
			if (null == e || e === this)
				return this._findFirstFocusEnabledWidgetIndex();
			var i = 0,
				n = this.getChildren(),
				r = n.length,
				o = -cc.FLT_MAX,
				s = 0;
			if (
				t !== ccui.Widget.LEFT &&
				t !== ccui.Widget.RIGHT &&
				t !== ccui.Widget.DOWN &&
				t !== ccui.Widget.UP
			)
				return cc.log('invalid focus direction!!!'), 0;
			for (var c = this._getWorldCenterPoint(e); i < r; ) {
				var a = n[i];
				a &&
					a instanceof ccui.Widget &&
					a.isFocusEnabled() &&
					o <
						(a =
							a instanceof ccui.Layout
								? a._calculateFarthestDistance(e)
								: cc.pLength(
										cc.pSub(this._getWorldCenterPoint(a), c)
								  )) &&
					((s = i), (o = a)),
					i++;
			}
			return s;
		},
		_calculateNearestDistance: function (t) {
			for (
				var e = cc.FLT_MAX,
					i = this._getWorldCenterPoint(t),
					n = this._children,
					r = 0,
					o = n.length;
				r < o;
				r++
			) {
				var s,
					c = n[r];
				if (c instanceof ccui.Layout)
					s = c._calculateNearestDistance(t);
				else {
					if (!(c instanceof ccui.Widget && c.isFocusEnabled()))
						continue;
					s = cc.pLength(cc.pSub(this._getWorldCenterPoint(c), i));
				}
				s < e && (e = s);
			}
			return e;
		},
		_calculateFarthestDistance: function (t) {
			for (
				var e = -cc.FLT_MAX,
					i = this._getWorldCenterPoint(t),
					n = this._children,
					r = 0,
					o = n.length;
				r < o;
				r++
			) {
				var s = n[r];
				if (s instanceof ccui.Layout)
					c = s._calculateFarthestDistance(t);
				else {
					if (!(s instanceof ccui.Widget && s.isFocusEnabled()))
						continue;
					var s = this._getWorldCenterPoint(s),
						c = cc.pLength(cc.pSub(s, i));
				}
				e < c && (e = c);
			}
			return e;
		},
		_findProperSearchingFunctor: function (t, e) {
			var i;
			void 0 !== e &&
				((i = this._getWorldCenterPoint(e)),
				(e = this._getWorldCenterPoint(
					this._findFirstNonLayoutWidget()
				)),
				t === ccui.Widget.LEFT
					? (this.onPassFocusToChild =
							i.x > e.x
								? this._findNearestChildWidgetIndex
								: this._findFarthestChildWidgetIndex)
					: t === ccui.Widget.RIGHT
					? (this.onPassFocusToChild =
							i.x > e.x
								? this._findFarthestChildWidgetIndex
								: this._findNearestChildWidgetIndex)
					: t === ccui.Widget.DOWN
					? (this.onPassFocusToChild =
							i.y > e.y
								? this._findNearestChildWidgetIndex
								: this._findFarthestChildWidgetIndex)
					: t === ccui.Widget.UP
					? (this.onPassFocusToChild =
							i.y < e.y
								? this._findNearestChildWidgetIndex
								: this._findFarthestChildWidgetIndex)
					: cc.log('invalid direction!'));
		},
		_findFirstNonLayoutWidget: function () {
			for (var t = this._children, e = 0, i = t.length; e < i; e++) {
				var n = t[e];
				if (n instanceof ccui.Layout) {
					var r = n._findFirstNonLayoutWidget();
					if (r) return r;
				} else if (n instanceof ccui.Widget) return n;
			}
			return null;
		},
		_findFirstFocusEnabledWidgetIndex: function () {
			for (var t = 0, e = this.getChildren(), i = e.length; t < i; ) {
				var n = e[t];
				if (n && n instanceof ccui.Widget && n.isFocusEnabled())
					return t;
				t++;
			}
			return 0;
		},
		_findFocusEnabledChildWidgetByIndex: function (t) {
			var e = this._getChildWidgetByIndex(t);
			return e
				? e.isFocusEnabled()
					? e
					: ((t += 1), this._findFocusEnabledChildWidgetByIndex(t))
				: null;
		},
		_getWorldCenterPoint: function (t) {
			var e =
				t instanceof ccui.Layout
					? t._getLayoutAccumulatedSize()
					: t.getContentSize();
			return t.convertToWorldSpace(cc.p(e.width / 2, e.height / 2));
		},
		_getNextFocusedWidget: function (t, e) {
			var i = null,
				n = this._children,
				r = n.indexOf(e);
			return (r += 1) < n.length
				? (i = this._getChildWidgetByIndex(r))
					? i.isFocusEnabled()
						? i instanceof ccui.Layout
							? ((i._isFocusPassing = !0),
							  i.findNextFocusedWidget(t, i))
							: (this.dispatchFocusEvent(e, i), i)
						: this._getNextFocusedWidget(t, i)
					: e
				: this._loopFocus
				? this._checkFocusEnabledChild()
					? ((r = 0),
					  (i = this._getChildWidgetByIndex(r)).isFocusEnabled()
							? i instanceof ccui.Layout
								? ((i._isFocusPassing = !0),
								  i.findNextFocusedWidget(t, i))
								: (this.dispatchFocusEvent(e, i), i)
							: this._getNextFocusedWidget(t, i))
					: e instanceof ccui.Layout
					? e
					: ccui.Widget._focusedWidget
				: !this._isLastWidgetInContainer(e, t) ||
				  this._isWidgetAncestorSupportLoopFocus(this, t)
				? ccui.Widget.prototype.findNextFocusedWidget.call(
						this,
						t,
						this
				  )
				: e instanceof ccui.Layout
				? e
				: ccui.Widget._focusedWidget;
		},
		_getPreviousFocusedWidget: function (t, e) {
			var i = null,
				n = this._children,
				r = n.indexOf(e);
			return 0 <= --r
				? (i = this._getChildWidgetByIndex(r)).isFocusEnabled()
					? i instanceof ccui.Layout
						? ((i._isFocusPassing = !0),
						  i.findNextFocusedWidget(t, i))
						: (this.dispatchFocusEvent(e, i), i)
					: this._getPreviousFocusedWidget(t, i)
				: this._loopFocus
				? this._checkFocusEnabledChild()
					? ((r = n.length - 1),
					  (i = this._getChildWidgetByIndex(r)).isFocusEnabled()
							? i instanceof ccui.Layout
								? ((i._isFocusPassing = !0),
								  i.findNextFocusedWidget(t, i))
								: (this.dispatchFocusEvent(e, i), i)
							: this._getPreviousFocusedWidget(t, i))
					: e instanceof ccui.Layout
					? e
					: ccui.Widget._focusedWidget
				: !this._isLastWidgetInContainer(e, t) ||
				  this._isWidgetAncestorSupportLoopFocus(this, t)
				? ccui.Widget.prototype.findNextFocusedWidget.call(
						this,
						t,
						this
				  )
				: e instanceof ccui.Layout
				? e
				: ccui.Widget._focusedWidget;
		},
		_getChildWidgetByIndex: function (t) {
			for (var e = this._children, i = e.length, n = t; t < i; ) {
				var r = e[t];
				if (r && r instanceof ccui.Widget) return r;
				t++;
			}
			for (var o = 0; o < n; ) {
				var s = e[o];
				if (s && s instanceof ccui.Widget) return s;
				o++;
			}
			return null;
		},
		_isLastWidgetInContainer: function (t, e) {
			var i = t.getParent();
			if (null == i || !(i instanceof ccui.Layout)) return !0;
			var n = i.getChildren(),
				t = n.indexOf(t);
			return i.getLayoutType() === ccui.Layout.LINEAR_HORIZONTAL
				? e === ccui.Widget.LEFT
					? 0 === t && this._isLastWidgetInContainer(i, e)
					: e === ccui.Widget.RIGHT
					? t === n.length - 1 && this._isLastWidgetInContainer(i, e)
					: e === ccui.Widget.DOWN || e === ccui.Widget.UP
					? this._isLastWidgetInContainer(i, e)
					: void 0
				: i.getLayoutType() === ccui.Layout.LINEAR_VERTICAL
				? e === ccui.Widget.UP
					? 0 === t && this._isLastWidgetInContainer(i, e)
					: e === ccui.Widget.DOWN
					? t === n.length - 1 && this._isLastWidgetInContainer(i, e)
					: e === ccui.Widget.LEFT || e === ccui.Widget.RIGHT
					? this._isLastWidgetInContainer(i, e)
					: void 0
				: (cc.log('invalid layout Type'), !1);
		},
		_isWidgetAncestorSupportLoopFocus: function (t, e) {
			var i = t.getParent();
			if (null == i || !(i instanceof ccui.Layout)) return !1;
			if (i.isLoopFocus()) {
				t = i.getLayoutType();
				return t === ccui.Layout.LINEAR_HORIZONTAL
					? e === ccui.Widget.LEFT ||
							e === ccui.Widget.RIGHT ||
							this._isWidgetAncestorSupportLoopFocus(i, e)
					: t === ccui.Layout.LINEAR_VERTICAL
					? e === ccui.Widget.DOWN ||
					  e === ccui.Widget.UP ||
					  this._isWidgetAncestorSupportLoopFocus(i, e)
					: (cc.assert(0, 'invalid layout type'), !1);
			}
			return this._isWidgetAncestorSupportLoopFocus(i, e);
		},
		_passFocusToChild: function (t, e) {
			if (this._checkFocusEnabledChild()) {
				var i = ccui.Widget.getCurrentFocusedWidget();
				this._findProperSearchingFunctor(t, i);
				(i = this.onPassFocusToChild(t, i)),
					(i = this._getChildWidgetByIndex(i));
				return i instanceof ccui.Layout
					? ((i._isFocusPassing = !0), i.findNextFocusedWidget(t, i))
					: (this.dispatchFocusEvent(e, i), i);
			}
			return this;
		},
		_checkFocusEnabledChild: function () {
			for (var t = this._children, e = 0, i = t.length; e < i; e++) {
				var n = t[e];
				if (n && n instanceof ccui.Widget && n.isFocusEnabled())
					return !0;
			}
			return !1;
		},
		getDescription: function () {
			return 'Layout';
		},
		_createCloneInstance: function () {
			return new ccui.Layout();
		},
		_copyClonedWidgetChildren: function (t) {
			ccui.Widget.prototype._copyClonedWidgetChildren.call(this, t);
		},
		_copySpecialProperties: function (t) {
			t instanceof ccui.Layout &&
				(this.setBackGroundImageScale9Enabled(
					t._backGroundScale9Enabled
				),
				this.setBackGroundImage(
					t._backGroundImageFileName,
					t._bgImageTexType
				),
				this.setBackGroundImageCapInsets(t._backGroundImageCapInsets),
				this.setBackGroundColorType(t._colorType),
				this.setBackGroundColor(t._color),
				this.setBackGroundColor(t._startColor, t._endColor),
				this.setBackGroundColorOpacity(t._opacity),
				this.setBackGroundColorVector(t._alongVector),
				this.setLayoutType(t._layoutType),
				this.setClippingEnabled(t._clippingEnabled),
				this.setClippingType(t._clippingType),
				(this._loopFocus = t._loopFocus),
				(this.__passFocusToChild = t.__passFocusToChild),
				(this._isInterceptTouch = t._isInterceptTouch));
		},
		forceDoLayout: function () {
			this.requestDoLayout(), this._doLayout();
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? ccui.Layout.WebGLRenderCmd
					: ccui.Layout.CanvasRenderCmd
			)(this);
		},
	}));
var _p = ccui.Layout.prototype;
_p.clippingEnabled,
	cc.defineGetterSetter(
		_p,
		'clippingEnabled',
		_p.isClippingEnabled,
		_p.setClippingEnabled
	),
	_p.clippingType,
	cc.defineGetterSetter(_p, 'clippingType', null, _p.setClippingType),
	_p.layoutType,
	cc.defineGetterSetter(_p, 'layoutType', _p.getLayoutType, _p.setLayoutType),
	(_p = null),
	(ccui.Layout.create = function () {
		return new ccui.Layout();
	}),
	(ccui.Layout.BG_COLOR_NONE = 0),
	(ccui.Layout.BG_COLOR_SOLID = 1),
	(ccui.Layout.BG_COLOR_GRADIENT = 2),
	(ccui.Layout.ABSOLUTE = 0),
	(ccui.Layout.LINEAR_VERTICAL = 1),
	(ccui.Layout.LINEAR_HORIZONTAL = 2),
	(ccui.Layout.RELATIVE = 3),
	(ccui.Layout.CLIPPING_STENCIL = 0),
	(ccui.Layout.CLIPPING_SCISSOR = 1),
	(ccui.Layout.BACKGROUND_IMAGE_ZORDER = -1),
	(ccui.Layout.BACKGROUND_RENDERER_ZORDER = -2),
	(function () {
		ccui.Layout.CanvasRenderCmd = function (t) {
			ccui.ProtectedNode.CanvasRenderCmd.call(this, t),
				(this._needDraw = !1),
				(this._rendererSaveCmd = new cc.CustomRenderCmd(
					this,
					this._onRenderSaveCmd
				)),
				(this._rendererClipCmd = new cc.CustomRenderCmd(
					this,
					this._onRenderClipCmd
				)),
				(this._rendererRestoreCmd = new cc.CustomRenderCmd(
					this,
					this._onRenderRestoreCmd
				)),
				(this._rendererSaveCmd._canUseDirtyRegion = !0),
				(this._rendererClipCmd._canUseDirtyRegion = !0),
				(this._rendererRestoreCmd._canUseDirtyRegion = !0);
		};
		var t = (ccui.Layout.CanvasRenderCmd.prototype = Object.create(
			ccui.ProtectedNode.CanvasRenderCmd.prototype
		));
		(t.constructor = ccui.Layout.CanvasRenderCmd),
			cc.game.addEventListener(
				cc.game.EVENT_RENDERER_INITED,
				function () {
					ccui.Widget.CanvasRenderCmd &&
						(ccui.Layout.CanvasRenderCmd.prototype.widgetVisit =
							ccui.Widget.CanvasRenderCmd.prototype.widgetVisit);
				}
			),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible)
					if (
						(e._adaptRenderers(), e._doLayout(), e._clippingEnabled)
					)
						switch (e._clippingType) {
							case ccui.Layout.CLIPPING_STENCIL:
								this.stencilClippingVisit(t);
								break;
							case ccui.Layout.CLIPPING_SCISSOR:
								this.scissorClippingVisit(t);
						}
					else this.widgetVisit(t);
			}),
			(t.layoutVisit = t.visit),
			(t._onRenderSaveCmd = function (t, e, i) {
				var t = t || cc._renderContext,
					n = t.getContext();
				t.save(), t.save(), t.setTransform(this._worldTransform, e, i);
				for (
					var r = this._node._clippingStencil._renderCmd._buffer,
						o = 0,
						s = r.length;
					o < s;
					o++
				) {
					var c = r[o].verts,
						a = c[0];
					n.beginPath(), n.moveTo(a.x, -a.y);
					for (var l = 1, h = c.length; l < h; l++)
						n.lineTo(c[l].x, -c[l].y);
					n.closePath();
				}
			}),
			(t._onRenderClipCmd = function (t) {
				var e = t || cc._renderContext,
					t = e.getContext();
				e.restore(), t.clip();
			}),
			(t._onRenderRestoreCmd = function (t) {
				(t = t || cc._renderContext), t.getContext();
				t.restore();
			}),
			(t.rebindStencilRendering = function (t) {
				(t._renderCmd.rendering = this.__stencilDraw),
					(t._renderCmd._canUseDirtyRegion = !0);
			}),
			(t.__stencilDraw = function (t, e, i) {}),
			(t.stencilClippingVisit = t.scissorClippingVisit =
				function (t) {
					var e = this._node;
					if (e._clippingStencil && e._clippingStencil.isVisible()) {
						this._syncStatus(t),
							cc.renderer.pushRenderCommand(
								this._rendererSaveCmd
							),
							e._clippingStencil.visit(this),
							cc.renderer.pushRenderCommand(
								this._rendererClipCmd
							),
							e.sortAllChildren(),
							e.sortAllProtectedChildren();
						for (
							var i,
								n = e._children,
								r = 0,
								o = e._protectedChildren,
								s = 0,
								c = n.length,
								a = o.length;
							s < c && (i = n[s]) && i.getLocalZOrder() < 0;
							s++
						)
							i.visit(this);
						for (
							;
							r < a && (i = o[r]) && i.getLocalZOrder() < 0;
							r++
						)
							i.visit(this);
						for (; s < c; s++) n[s].visit(this);
						for (; r < a; r++) o[r].visit(this);
						cc.renderer.pushRenderCommand(this._rendererRestoreCmd),
							(this._dirtyFlag = 0);
					}
				}),
			(ccui.Layout.CanvasRenderCmd._getSharedCache = function () {
				return (
					cc.ClippingNode._sharedCache ||
					(cc.ClippingNode._sharedCache =
						document.createElement('canvas'))
				);
			});
	})(),
	(function () {
		var t;
		ccui.ProtectedNode.WebGLRenderCmd &&
			((ccui.Layout.WebGLRenderCmd = function (t) {
				ccui.ProtectedNode.WebGLRenderCmd.call(this, t),
					(this._needDraw = !1),
					(this._currentStencilEnabled = 0),
					(this._scissorOldState = !1),
					(this._clippingOldRect = null),
					(this._mask_layer_le = 0),
					(this._beforeVisitCmdStencil = new cc.CustomRenderCmd(
						this,
						this._onBeforeVisitStencil
					)),
					(this._afterDrawStencilCmd = new cc.CustomRenderCmd(
						this,
						this._onAfterDrawStencil
					)),
					(this._afterVisitCmdStencil = new cc.CustomRenderCmd(
						this,
						this._onAfterVisitStencil
					)),
					(this._beforeVisitCmdScissor = new cc.CustomRenderCmd(
						this,
						this._onBeforeVisitScissor
					)),
					(this._afterVisitCmdScissor = new cc.CustomRenderCmd(
						this,
						this._onAfterVisitScissor
					));
			}),
			((t = ccui.Layout.WebGLRenderCmd.prototype =
				Object.create(
					ccui.ProtectedNode.WebGLRenderCmd.prototype
				)).constructor = ccui.Layout.WebGLRenderCmd),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible)
					if (
						(t &&
							t._dirtyFlag & cc.Node._dirtyFlags.transformDirty &&
							(e._clippingRectDirty = !0),
						e._adaptRenderers(),
						e._doLayout(),
						e._clippingEnabled)
					)
						switch (e._clippingType) {
							case ccui.Layout.CLIPPING_STENCIL:
								this.stencilClippingVisit(t);
								break;
							case ccui.Layout.CLIPPING_SCISSOR:
								this.scissorClippingVisit(t);
						}
					else this.pNodeVisit(t);
			}),
			(t.layoutVisit = t.visit),
			(t._onBeforeVisitStencil = function (t) {
				var e = t || cc._renderContext;
				ccui.Layout.WebGLRenderCmd._layer++;
				var i = 1 << ccui.Layout.WebGLRenderCmd._layer,
					t = i - 1;
				(this._mask_layer_le = i | t),
					(this._currentStencilEnabled = e.isEnabled(e.STENCIL_TEST)),
					e.clear(e.DEPTH_BUFFER_BIT),
					e.enable(e.STENCIL_TEST),
					e.depthMask(!1),
					e.stencilFunc(e.NEVER, i, i),
					e.stencilOp(e.REPLACE, e.KEEP, e.KEEP),
					e.stencilMask(i),
					e.clear(e.STENCIL_BUFFER_BIT);
			}),
			(t._onAfterDrawStencil = function (t) {
				t = t || cc._renderContext;
				t.depthMask(!0),
					t.stencilFunc(
						t.EQUAL,
						this._mask_layer_le,
						this._mask_layer_le
					),
					t.stencilOp(t.KEEP, t.KEEP, t.KEEP);
			}),
			(t._onAfterVisitStencil = function (t) {
				var e,
					i = t || cc._renderContext;
				ccui.Layout.WebGLRenderCmd._layer--,
					this._currentStencilEnabled
						? ((t =
								(e = 1 << ccui.Layout.WebGLRenderCmd._layer) |
								(e - 1)),
						  i.stencilMask(e),
						  i.stencilFunc(i.EQUAL, t, t))
						: i.disable(i.STENCIL_TEST);
			}),
			(t._onBeforeVisitScissor = function (t) {
				this._node._clippingRectDirty = !0;
				var e = this._node._getClippingRect(),
					t = t || cc._renderContext;
				(this._scissorOldState = t.isEnabled(t.SCISSOR_TEST)),
					this._scissorOldState
						? ((this._clippingOldRect = cc.view.getScissorRect()),
						  cc.rectEqualToRect(this._clippingOldRect, e) ||
								cc.view.setScissorInPoints(
									e.x,
									e.y,
									e.width,
									e.height
								))
						: (t.enable(t.SCISSOR_TEST),
						  cc.view.setScissorInPoints(
								e.x,
								e.y,
								e.width,
								e.height
						  ));
			}),
			(t._onAfterVisitScissor = function (t) {
				t = t || cc._renderContext;
				this._scissorOldState
					? cc.rectEqualToRect(
							this._clippingOldRect,
							this._node._clippingRect
					  ) ||
					  cc.view.setScissorInPoints(
							this._clippingOldRect.x,
							this._clippingOldRect.y,
							this._clippingOldRect.width,
							this._clippingOldRect.height
					  )
					: t.disable(t.SCISSOR_TEST);
			}),
			(t.rebindStencilRendering = function (t) {}),
			(t.transform = function (t, e) {
				var i = this._node;
				this.pNodeTransform(t, e),
					i._clippingStencil &&
						i._clippingStencil._renderCmd.transform(this, e);
			}),
			(t.stencilClippingVisit = function (t) {
				var e = this._node;
				if (e._clippingStencil && e._clippingStencil.isVisible()) {
					if (
						ccui.Layout.WebGLRenderCmd._layer + 1 ===
						cc.stencilBits
					)
						return (
							(ccui.Layout.WebGLRenderCmd._visit_once = !0),
							ccui.Layout.WebGLRenderCmd._visit_once &&
								(cc.log(
									'Nesting more than ' +
										cc.stencilBits +
										'stencils is not supported. Everything will be drawn without stencil for this node and its childs.'
								),
								(ccui.Layout.WebGLRenderCmd._visit_once = !1)),
							void cc.Node.prototype.visit.call(e, t)
						);
					cc.renderer.pushRenderCommand(this._beforeVisitCmdStencil);
					var i = cc.current_stack;
					i.stack.push(i.top),
						this._syncStatus(t),
						(this._dirtyFlag = 0),
						(i.top = this._stackMatrix),
						e._clippingStencil.visit(this),
						cc.renderer.pushRenderCommand(
							this._afterDrawStencilCmd
						);
					var n = 0,
						r = 0;
					e.sortAllChildren(), e.sortAllProtectedChildren();
					for (
						var o,
							s = e._children,
							c = e._protectedChildren,
							a = s.length,
							l = c.length;
						n < a && (o = s[n]) && o.getLocalZOrder() < 0;
						n++
					)
						o.visit(this);
					for (; r < l && (o = c[r]) && o.getLocalZOrder() < 0; r++)
						o.visit(this);
					for (; n < a; n++) s[n].visit(this);
					for (; r < l; r++) c[r].visit(this);
					cc.renderer.pushRenderCommand(this._afterVisitCmdStencil),
						(i.top = i.stack.pop());
				}
			}),
			(t.scissorClippingVisit = function (t) {
				cc.renderer.pushRenderCommand(this._beforeVisitCmdScissor),
					this.pNodeVisit(t),
					cc.renderer.pushRenderCommand(this._afterVisitCmdScissor);
			}),
			(ccui.Layout.WebGLRenderCmd._layer = -1),
			(ccui.Layout.WebGLRenderCmd._visit_once = null));
	})(),
	(ccui.Margin = ccui.Class.extend({
		left: 0,
		top: 0,
		right: 0,
		bottom: 0,
		ctor: function (t, e, i, n) {
			void 0 !== t &&
				void 0 === e &&
				((this.left = t.left),
				(this.top = t.top),
				(this.right = t.right),
				(this.bottom = t.bottom)),
				void 0 !== n &&
					((this.left = t),
					(this.top = e),
					(this.right = i),
					(this.bottom = n));
		},
		setMargin: function (t, e, i, n) {
			(this.left = t),
				(this.top = e),
				(this.right = i),
				(this.bottom = n);
		},
		equals: function (t) {
			return (
				this.left === t.left &&
				this.top === t.top &&
				this.right === t.right &&
				this.bottom === t.bottom
			);
		},
	})),
	(ccui.MarginZero = function () {
		return new ccui.Margin(0, 0, 0, 0);
	}),
	(ccui.LayoutParameter = ccui.Class.extend({
		_margin: null,
		_layoutParameterType: null,
		ctor: function () {
			(this._margin = new ccui.Margin()),
				(this._layoutParameterType = ccui.LayoutParameter.NONE);
		},
		setMargin: function (t) {
			cc.isObject(t)
				? ((this._margin.left = t.left),
				  (this._margin.top = t.top),
				  (this._margin.right = t.right),
				  (this._margin.bottom = t.bottom))
				: ((this._margin.left = t),
				  (this._margin.top = arguments[1]),
				  (this._margin.right = arguments[2]),
				  (this._margin.bottom = arguments[3]));
		},
		getMargin: function () {
			return this._margin;
		},
		getLayoutType: function () {
			return this._layoutParameterType;
		},
		clone: function () {
			var t = this._createCloneInstance();
			return t._copyProperties(this), t;
		},
		_createCloneInstance: function () {
			return new ccui.LayoutParameter();
		},
		_copyProperties: function (t) {
			(this._margin.bottom = t._margin.bottom),
				(this._margin.left = t._margin.left),
				(this._margin.right = t._margin.right),
				(this._margin.top = t._margin.top);
		},
	})),
	(ccui.LayoutParameter.create = function () {
		return new ccui.LayoutParameter();
	}),
	(ccui.LayoutParameter.NONE = 0),
	(ccui.LayoutParameter.LINEAR = 1),
	(ccui.LayoutParameter.RELATIVE = 2),
	(ccui.LinearLayoutParameter = ccui.LayoutParameter.extend({
		_linearGravity: null,
		ctor: function () {
			ccui.LayoutParameter.prototype.ctor.call(this),
				(this._linearGravity = ccui.LinearLayoutParameter.NONE),
				(this._layoutParameterType = ccui.LayoutParameter.LINEAR);
		},
		setGravity: function (t) {
			this._linearGravity = t;
		},
		getGravity: function () {
			return this._linearGravity;
		},
		_createCloneInstance: function () {
			return new ccui.LinearLayoutParameter();
		},
		_copyProperties: function (t) {
			ccui.LayoutParameter.prototype._copyProperties.call(this, t),
				t instanceof ccui.LinearLayoutParameter &&
					this.setGravity(t._linearGravity);
		},
	})),
	(ccui.LinearLayoutParameter.create = function () {
		return new ccui.LinearLayoutParameter();
	}),
	(ccui.LinearLayoutParameter.NONE = 0),
	(ccui.LinearLayoutParameter.LEFT = 1),
	(ccui.LinearLayoutParameter.TOP = 2),
	(ccui.LinearLayoutParameter.RIGHT = 3),
	(ccui.LinearLayoutParameter.BOTTOM = 4),
	(ccui.LinearLayoutParameter.CENTER_VERTICAL = 5),
	(ccui.LinearLayoutParameter.CENTER_HORIZONTAL = 6),
	(ccui.RelativeLayoutParameter = ccui.LayoutParameter.extend({
		_relativeAlign: null,
		_relativeWidgetName: '',
		_relativeLayoutName: '',
		_put: !1,
		ctor: function () {
			ccui.LayoutParameter.prototype.ctor.call(this),
				(this._relativeAlign = ccui.RelativeLayoutParameter.NONE),
				(this._relativeWidgetName = ''),
				(this._relativeLayoutName = ''),
				(this._put = !1),
				(this._layoutParameterType = ccui.LayoutParameter.RELATIVE);
		},
		setAlign: function (t) {
			this._relativeAlign = t;
		},
		getAlign: function () {
			return this._relativeAlign;
		},
		setRelativeToWidgetName: function (t) {
			this._relativeWidgetName = t;
		},
		getRelativeToWidgetName: function () {
			return this._relativeWidgetName;
		},
		setRelativeName: function (t) {
			this._relativeLayoutName = t;
		},
		getRelativeName: function () {
			return this._relativeLayoutName;
		},
		_createCloneInstance: function () {
			return new ccui.RelativeLayoutParameter();
		},
		_copyProperties: function (t) {
			ccui.LayoutParameter.prototype._copyProperties.call(this, t),
				t instanceof ccui.RelativeLayoutParameter &&
					(this.setAlign(t._relativeAlign),
					this.setRelativeToWidgetName(t._relativeWidgetName),
					this.setRelativeName(t._relativeLayoutName));
		},
	})),
	(ccui.RelativeLayoutParameter.create = function () {
		return new ccui.RelativeLayoutParameter();
	}),
	(ccui.RelativeLayoutParameter.NONE = 0),
	(ccui.RelativeLayoutParameter.PARENT_TOP_LEFT = 1),
	(ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL = 2),
	(ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT = 3),
	(ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL = 4),
	(ccui.RelativeLayoutParameter.CENTER_IN_PARENT = 5),
	(ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL = 6),
	(ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM = 7),
	(ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL = 8),
	(ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM = 9),
	(ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN = 10),
	(ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER = 11),
	(ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN = 12),
	(ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN = 13),
	(ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER = 14),
	(ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN = 15),
	(ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN = 16),
	(ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER = 17),
	(ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN = 18),
	(ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN = 19),
	(ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER = 20),
	(ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN = 21),
	(ccui.LINEAR_GRAVITY_NONE = 0),
	(ccui.LINEAR_GRAVITY_LEFT = 1),
	(ccui.LINEAR_GRAVITY_TOP = 2),
	(ccui.LINEAR_GRAVITY_RIGHT = 3),
	(ccui.LINEAR_GRAVITY_BOTTOM = 4),
	(ccui.LINEAR_GRAVITY_CENTER_VERTICAL = 5),
	(ccui.LINEAR_GRAVITY_CENTER_HORIZONTAL = 6),
	(ccui.RELATIVE_ALIGN_NONE = 0),
	(ccui.RELATIVE_ALIGN_PARENT_TOP_LEFT = 1),
	(ccui.RELATIVE_ALIGN_PARENT_TOP_CENTER_HORIZONTAL = 2),
	(ccui.RELATIVE_ALIGN_PARENT_TOP_RIGHT = 3),
	(ccui.RELATIVE_ALIGN_PARENT_LEFT_CENTER_VERTICAL = 4),
	(ccui.RELATIVE_ALIGN_PARENT_CENTER = 5),
	(ccui.RELATIVE_ALIGN_PARENT_RIGHT_CENTER_VERTICAL = 6),
	(ccui.RELATIVE_ALIGN_PARENT_LEFT_BOTTOM = 7),
	(ccui.RELATIVE_ALIGN_PARENT_BOTTOM_CENTER_HORIZONTAL = 8),
	(ccui.RELATIVE_ALIGN_PARENT_RIGHT_BOTTOM = 9),
	(ccui.RELATIVE_ALIGN_LOCATION_ABOVE_LEFT = 10),
	(ccui.RELATIVE_ALIGN_LOCATION_ABOVE_CENTER = 11),
	(ccui.RELATIVE_ALIGN_LOCATION_ABOVE_RIGHT = 12),
	(ccui.RELATIVE_ALIGN_LOCATION_LEFT_TOP = 13),
	(ccui.RELATIVE_ALIGN_LOCATION_LEFT_CENTER = 14),
	(ccui.RELATIVE_ALIGN_LOCATION_LEFT_BOTTOM = 15),
	(ccui.RELATIVE_ALIGN_LOCATION_RIGHT_TOP = 16),
	(ccui.RELATIVE_ALIGN_LOCATION_RIGHT_CENTER = 17),
	(ccui.RELATIVE_ALIGN_LOCATION_RIGHT_BOTTOM = 18),
	(ccui.RELATIVE_ALIGN_LOCATION_BELOW_TOP = 19),
	(ccui.RELATIVE_ALIGN_LOCATION_BELOW_CENTER = 20),
	(ccui.RELATIVE_ALIGN_LOCATION_BELOW_BOTTOM = 21),
	(ccui.getLayoutManager = function (t) {
		switch (t) {
			case ccui.Layout.LINEAR_VERTICAL:
				return ccui.linearVerticalLayoutManager;
			case ccui.Layout.LINEAR_HORIZONTAL:
				return ccui.linearHorizontalLayoutManager;
			case ccui.Layout.RELATIVE:
				return ccui.relativeLayoutManager;
		}
		return null;
	}),
	(ccui.linearVerticalLayoutManager = {
		_doLayout: function (t) {
			for (
				var e = t._getLayoutContentSize(),
					i = t._getLayoutElements(),
					n = e.height,
					r = 0,
					o = i.length;
				r < o;
				r++
			) {
				var s = i[r];
				if (s) {
					var c = s.getLayoutParameter();
					if (c) {
						var a = c.getGravity(),
							l = s.getAnchorPoint(),
							h = s.getContentSize(),
							u = l.x * h.width,
							_ = n - (1 - l.y) * h.height;
						switch (a) {
							case ccui.LinearLayoutParameter.NONE:
							case ccui.LinearLayoutParameter.LEFT:
								break;
							case ccui.LinearLayoutParameter.RIGHT:
								u = e.width - (1 - l.x) * h.width;
								break;
							case ccui.LinearLayoutParameter.CENTER_HORIZONTAL:
								u = e.width / 2 - h.width * (0.5 - l.x);
						}
						c = c.getMargin();
						(u += c.left),
							(_ -= c.top),
							s.setPosition(u, _),
							(n = s.getPositionY() - l.y * h.height - c.bottom);
					}
				}
			}
		},
	}),
	(ccui.linearHorizontalLayoutManager = {
		_doLayout: function (t) {
			for (
				var e = t._getLayoutContentSize(),
					i = t._getLayoutElements(),
					n = 0,
					r = 0,
					o = i.length;
				r < o;
				r++
			) {
				var s = i[r];
				if (s) {
					var c = s.getLayoutParameter();
					if (c) {
						var a = c.getGravity(),
							l = s.getAnchorPoint(),
							h = s.getContentSize(),
							u = n + l.x * h.width,
							_ = e.height - (1 - l.y) * h.height;
						switch (a) {
							case ccui.LinearLayoutParameter.NONE:
							case ccui.LinearLayoutParameter.TOP:
								break;
							case ccui.LinearLayoutParameter.BOTTOM:
								_ = l.y * h.height;
								break;
							case ccui.LinearLayoutParameter.CENTER_VERTICAL:
								_ = e.height / 2 - h.height * (0.5 - l.y);
						}
						c = c.getMargin();
						(u += c.left),
							(_ -= c.top),
							s.setPosition(u, _),
							(n = s.getRightBoundary() + c.right);
					}
				}
			}
		},
	}),
	(ccui.relativeLayoutManager = {
		_unlayoutChildCount: 0,
		_widgetChildren: [],
		_widget: null,
		_finalPositionX: 0,
		_finalPositionY: 0,
		_relativeWidgetLP: null,
		_doLayout: function (t) {
			this._widgetChildren = this._getAllWidgets(t);
			for (var e = this._widgetChildren; 0 < this._unlayoutChildCount; ) {
				for (var i = 0, n = e.length; i < n; i++) {
					this._widget = e[i];
					var r = this._widget.getLayoutParameter();
					r &&
						(r._put ||
							(this._calculateFinalPositionWithRelativeWidget(
								t
							) &&
								(this._calculateFinalPositionWithRelativeAlign(),
								this._widget.setPosition(
									this._finalPositionX,
									this._finalPositionY
								),
								(r._put = !0))));
				}
				this._unlayoutChildCount--;
			}
			this._widgetChildren.length = 0;
		},
		_getAllWidgets: function (t) {
			for (
				var e = t._getLayoutElements(),
					i = this._widgetChildren,
					n = (i.length = 0),
					r = e.length;
				n < r;
				n++
			) {
				var o = e[n];
				o &&
					o instanceof ccui.Widget &&
					((o.getLayoutParameter()._put = !1),
					this._unlayoutChildCount++,
					i.push(o));
			}
			return i;
		},
		_getRelativeWidget: function (t) {
			var e = null,
				i = t.getLayoutParameter().getRelativeToWidgetName();
			if (i && 0 !== i.length)
				for (
					var n = this._widgetChildren, r = 0, o = n.length;
					r < o;
					r++
				) {
					var s = n[r];
					if (s) {
						var c = s.getLayoutParameter();
						if (c && c.getRelativeName() === i) {
							(e = s), (this._relativeWidgetLP = c);
							break;
						}
					}
				}
			return e;
		},
		_calculateFinalPositionWithRelativeWidget: function (t) {
			var e = this._widget,
				i = e.getAnchorPoint(),
				n = e.getContentSize();
			(this._finalPositionX = 0), (this._finalPositionY = 0);
			var r = this._getRelativeWidget(e),
				e = e.getLayoutParameter().getAlign(),
				o = t._getLayoutContentSize();
			switch (e) {
				case ccui.RelativeLayoutParameter.NONE:
				case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:
					(this._finalPositionX = i.x * n.width),
						(this._finalPositionY =
							o.height - (1 - i.y) * n.height);
					break;
				case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:
					(this._finalPositionX =
						0.5 * o.width - n.width * (0.5 - i.x)),
						(this._finalPositionY =
							o.height - (1 - i.y) * n.height);
					break;
				case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:
					(this._finalPositionX = o.width - (1 - i.x) * n.width),
						(this._finalPositionY =
							o.height - (1 - i.y) * n.height);
					break;
				case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:
					(this._finalPositionX = i.x * n.width),
						(this._finalPositionY =
							0.5 * o.height - n.height * (0.5 - i.y));
					break;
				case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:
					(this._finalPositionX =
						0.5 * o.width - n.width * (0.5 - i.x)),
						(this._finalPositionY =
							0.5 * o.height - n.height * (0.5 - i.y));
					break;
				case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:
					(this._finalPositionX = o.width - (1 - i.x) * n.width),
						(this._finalPositionY =
							0.5 * o.height - n.height * (0.5 - i.y));
					break;
				case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:
					(this._finalPositionX = i.x * n.width),
						(this._finalPositionY = i.y * n.height);
					break;
				case ccui.RelativeLayoutParameter
					.PARENT_BOTTOM_CENTER_HORIZONTAL:
					(this._finalPositionX =
						0.5 * o.width - n.width * (0.5 - i.x)),
						(this._finalPositionY = i.y * n.height);
					break;
				case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:
					(this._finalPositionX = o.width - (1 - i.x) * n.width),
						(this._finalPositionY = i.y * n.height);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getTopBoundary() + i.y * n.height),
							(this._finalPositionX =
								r.getLeftBoundary() + i.x * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						var s = r.getContentSize();
						(this._finalPositionY =
							r.getTopBoundary() + i.y * n.height),
							(this._finalPositionX =
								r.getLeftBoundary() +
								0.5 * s.width +
								i.x * n.width -
								0.5 * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getTopBoundary() + i.y * n.height),
							(this._finalPositionX =
								r.getRightBoundary() - (1 - i.x) * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getTopBoundary() - (1 - i.y) * n.height),
							(this._finalPositionX =
								r.getLeftBoundary() - (1 - i.x) * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						s = r.getContentSize();
						(this._finalPositionX =
							r.getLeftBoundary() - (1 - i.x) * n.width),
							(this._finalPositionY =
								r.getBottomBoundary() +
								0.5 * s.height +
								i.y * n.height -
								0.5 * n.height);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getBottomBoundary() + i.y * n.height),
							(this._finalPositionX =
								r.getLeftBoundary() - (1 - i.x) * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getTopBoundary() - (1 - i.y) * n.height),
							(this._finalPositionX =
								r.getRightBoundary() + i.x * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						var s = r.getContentSize(),
							c = r.getRightBoundary();
						(this._finalPositionX = c + i.x * n.width),
							(this._finalPositionY =
								r.getBottomBoundary() +
								0.5 * s.height +
								i.y * n.height -
								0.5 * n.height);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getBottomBoundary() + i.y * n.height),
							(this._finalPositionX =
								r.getRightBoundary() + i.x * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getBottomBoundary() - (1 - i.y) * n.height),
							(this._finalPositionX =
								r.getLeftBoundary() + i.x * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						s = r.getContentSize();
						(this._finalPositionY =
							r.getBottomBoundary() - (1 - i.y) * n.height),
							(this._finalPositionX =
								r.getLeftBoundary() +
								0.5 * s.width +
								i.x * n.width -
								0.5 * n.width);
					}
					break;
				case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:
					if (r) {
						if (
							this._relativeWidgetLP &&
							!this._relativeWidgetLP._put
						)
							return !1;
						(this._finalPositionY =
							r.getBottomBoundary() - (1 - i.y) * n.height),
							(this._finalPositionX =
								r.getRightBoundary() - (1 - i.x) * n.width);
					}
			}
			return !0;
		},
		_calculateFinalPositionWithRelativeAlign: function () {
			var t = this._widget.getLayoutParameter(),
				e = t.getMargin();
			switch (t.getAlign()) {
				case ccui.RelativeLayoutParameter.NONE:
				case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:
					(this._finalPositionX += e.left),
						(this._finalPositionY -= e.top);
					break;
				case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:
					this._finalPositionY -= e.top;
					break;
				case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:
					(this._finalPositionX -= e.right),
						(this._finalPositionY -= e.top);
					break;
				case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:
					this._finalPositionX += e.left;
					break;
				case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:
					break;
				case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:
					this._finalPositionX -= e.right;
					break;
				case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:
					(this._finalPositionX += e.left),
						(this._finalPositionY += e.bottom);
					break;
				case ccui.RelativeLayoutParameter
					.PARENT_BOTTOM_CENTER_HORIZONTAL:
					this._finalPositionY += e.bottom;
					break;
				case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:
					(this._finalPositionX -= e.right),
						(this._finalPositionY += e.bottom);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:
					(this._finalPositionY += e.bottom),
						(this._finalPositionX += e.left);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:
					(this._finalPositionY += e.bottom),
						(this._finalPositionX -= e.right);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:
					this._finalPositionY += e.bottom;
					break;
				case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:
					(this._finalPositionX -= e.right),
						(this._finalPositionY -= e.top);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:
					(this._finalPositionX -= e.right),
						(this._finalPositionY += e.bottom);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:
					this._finalPositionX -= e.right;
					break;
				case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:
					(this._finalPositionX += e.left),
						(this._finalPositionY -= e.top);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:
					(this._finalPositionX += e.left),
						(this._finalPositionY += e.bottom);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:
					this._finalPositionX += e.left;
					break;
				case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:
					(this._finalPositionY -= e.top),
						(this._finalPositionX += e.left);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:
					(this._finalPositionY -= e.top),
						(this._finalPositionX -= e.right);
					break;
				case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:
					this._finalPositionY -= e.top;
			}
		},
	}),
	(ccui.HBox = ccui.Layout.extend({
		ctor: function (t) {
			ccui.Layout.prototype.ctor.call(this),
				this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL),
				t && this.setContentSize(t);
		},
	})),
	(ccui.HBox.create = function (t) {
		return new ccui.HBox(t);
	}),
	(ccui.RelativeBox = ccui.Layout.extend({
		ctor: function (t) {
			ccui.Layout.prototype.ctor.call(this),
				this.setLayoutType(ccui.Layout.RELATIVE),
				t && this.setContentSize(t);
		},
	})),
	(ccui.RelativeBox.create = function (t) {
		return new ccui.RelativeBox(t);
	}),
	(ccui.VBox = ccui.Layout.extend({
		ctor: function (t) {
			ccui.Layout.prototype.ctor.call(this),
				this.setLayoutType(ccui.Layout.LINEAR_VERTICAL),
				t && this.setContentSize(t);
		},
		initWithSize: function (t) {
			return !!this.init();
		},
	})),
	(ccui.VBox.create = function (t) {
		return new ccui.VBox(t);
	}),
	(ccui.helper = {
		seekWidgetByTag: function (t, e) {
			if (!t) return null;
			if (t.getTag() === e) return t;
			for (var i = t.getChildren(), n = i.length, r = 0; r < n; r++) {
				var o = i[r],
					o = ccui.helper.seekWidgetByTag(o, e);
				if (null !== o) return o;
			}
			return null;
		},
		seekWidgetByName: function (t, e) {
			if (!t) return null;
			if (t.getName() === e) return t;
			for (var i = t.getChildren(), n = i.length, r = 0; r < n; r++) {
				var o = i[r],
					o = ccui.helper.seekWidgetByName(o, e);
				if (null !== o) return o;
			}
			return null;
		},
		seekWidgetByRelativeName: function (t, e) {
			if (!t) return null;
			for (var i = t.getChildren(), n = i.length, r = 0; r < n; r++) {
				var o = i[r],
					s = o.getLayoutParameter(ccui.LayoutParameter.RELATIVE);
				if (s && s.getRelativeName() === e) return o;
			}
			return null;
		},
		seekActionWidgetByActionTag: function (t, e) {
			if (!t) return null;
			if (t.getActionTag() === e) return t;
			for (var i = t.getChildren(), n = 0; n < i.length; n++) {
				var r = i[n],
					r = ccui.helper.seekActionWidgetByActionTag(r, e);
				if (null !== r) return r;
			}
			return null;
		},
		_activeLayout: !0,
		doLayout: function (t) {
			if (this._activeLayout)
				for (var e = t.getChildren(), i = 0, n = e.length; i < n; i++) {
					var r = (o = e[i]).getComponent(ccui.LayoutComponent.NAME),
						o = o.getParent();
					null != r &&
						null !== o &&
						r.refreshLayout &&
						r.refreshLayout();
				}
		},
		changeLayoutSystemActiveState: function (t) {
			this._activeLayout = t;
		},
		restrictCapInsetRect: function (t, e) {
			var i = t.x,
				n = t.y,
				r = t.width,
				t = t.height;
			return (
				e.width < r && (r = i = 0),
				e.height < t && (t = n = 0),
				cc.rect(i, n, r, t)
			);
		},
		_createSpriteFromBase64: function (t, e) {
			var i,
				n = cc.textureCache.getTextureForKey(e);
			return (
				n ||
					(((i = new Image()).src = t),
					cc.textureCache.cacheImage(e, i),
					(n = cc.textureCache.getTextureForKey(e))),
				new cc.Sprite(n)
			);
		},
	}),
	(ccui.Button = ccui.Widget.extend({
		_buttonNormalRenderer: null,
		_buttonClickedRenderer: null,
		_buttonDisableRenderer: null,
		_titleRenderer: null,
		_normalFileName: '',
		_clickedFileName: '',
		_disabledFileName: '',
		_prevIgnoreSize: !0,
		_scale9Enabled: !1,
		_capInsetsNormal: null,
		_capInsetsPressed: null,
		_capInsetsDisabled: null,
		_normalTexType: ccui.Widget.LOCAL_TEXTURE,
		_pressedTexType: ccui.Widget.LOCAL_TEXTURE,
		_disabledTexType: ccui.Widget.LOCAL_TEXTURE,
		_normalTextureSize: null,
		_pressedTextureSize: null,
		_disabledTextureSize: null,
		pressedActionEnabled: !1,
		_titleColor: null,
		_normalTextureScaleXInSize: 1,
		_normalTextureScaleYInSize: 1,
		_pressedTextureScaleXInSize: 1,
		_pressedTextureScaleYInSize: 1,
		_zoomScale: 0.1,
		_normalTextureLoaded: !1,
		_pressedTextureLoaded: !1,
		_disabledTextureLoaded: !1,
		_className: 'Button',
		_normalTextureAdaptDirty: !0,
		_pressedTextureAdaptDirty: !0,
		_disabledTextureAdaptDirty: !0,
		_fontName: 'Thonburi',
		_fontSize: 12,
		_type: 0,
		ctor: function (t, e, i, n) {
			(this._capInsetsNormal = cc.rect(0, 0, 0, 0)),
				(this._capInsetsPressed = cc.rect(0, 0, 0, 0)),
				(this._capInsetsDisabled = cc.rect(0, 0, 0, 0)),
				(this._normalTextureSize = cc.size(0, 0)),
				(this._pressedTextureSize = cc.size(0, 0)),
				(this._disabledTextureSize = cc.size(0, 0)),
				(this._titleColor = cc.color.WHITE),
				ccui.Widget.prototype.ctor.call(this),
				this.setTouchEnabled(!0),
				t && this.loadTextures(t, e, i, n);
		},
		_initRenderer: function () {
			(this._buttonNormalRenderer = new cc.Sprite()),
				(this._buttonClickedRenderer = new cc.Sprite()),
				(this._buttonDisableRenderer = new cc.Sprite()),
				(this._titleRenderer = new cc.LabelTTF('')),
				this._titleRenderer.setAnchorPoint(0.5, 0.5),
				this.addProtectedChild(
					this._buttonNormalRenderer,
					ccui.Button.NORMAL_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._buttonClickedRenderer,
					ccui.Button.PRESSED_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._buttonDisableRenderer,
					ccui.Button.DISABLED_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._titleRenderer,
					ccui.Button.TITLE_RENDERER_ZORDER,
					-1
				);
		},
		setScale9Enabled: function (t) {
			this._scale9Enabled !== t &&
				((this._brightStyle = ccui.Widget.BRIGHT_STYLE_NONE),
				(this._scale9Enabled = t),
				this.removeProtectedChild(this._buttonNormalRenderer),
				this.removeProtectedChild(this._buttonClickedRenderer),
				this.removeProtectedChild(this._buttonDisableRenderer),
				this._scale9Enabled
					? ((this._buttonNormalRenderer = new ccui.Scale9Sprite()),
					  (this._buttonClickedRenderer = new ccui.Scale9Sprite()),
					  (this._buttonDisableRenderer = new ccui.Scale9Sprite()))
					: ((this._buttonNormalRenderer = new cc.Sprite()),
					  (this._buttonClickedRenderer = new cc.Sprite()),
					  (this._buttonDisableRenderer = new cc.Sprite())),
				this._buttonClickedRenderer.setVisible(!1),
				this._buttonDisableRenderer.setVisible(!1),
				this.loadTextureNormal(
					this._normalFileName,
					this._normalTexType
				),
				this.loadTexturePressed(
					this._clickedFileName,
					this._pressedTexType
				),
				this.loadTextureDisabled(
					this._disabledFileName,
					this._disabledTexType
				),
				this.addProtectedChild(
					this._buttonNormalRenderer,
					ccui.Button.NORMAL_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._buttonClickedRenderer,
					ccui.Button.PRESSED_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._buttonDisableRenderer,
					ccui.Button.DISABLED_RENDERER_ZORDER,
					-1
				),
				this._scale9Enabled
					? ((t = this._ignoreSize),
					  this.ignoreContentAdaptWithSize(!1),
					  (this._prevIgnoreSize = t))
					: this.ignoreContentAdaptWithSize(this._prevIgnoreSize),
				this.setCapInsetsNormalRenderer(this._capInsetsNormal),
				this.setCapInsetsPressedRenderer(this._capInsetsPressed),
				this.setCapInsetsDisabledRenderer(this._capInsetsDisabled),
				this.setBright(this._bright),
				(this._normalTextureAdaptDirty = !0),
				(this._pressedTextureAdaptDirty = !0),
				(this._disabledTextureAdaptDirty = !0));
		},
		isScale9Enabled: function () {
			return this._scale9Enabled;
		},
		ignoreContentAdaptWithSize: function (t) {
			this._unifySize
				? this._updateContentSize()
				: (this._scale9Enabled && (!this._scale9Enabled || t)) ||
				  (ccui.Widget.prototype.ignoreContentAdaptWithSize.call(
						this,
						t
				  ),
				  (this._prevIgnoreSize = t));
		},
		getVirtualRendererSize: function () {
			return this._unifySize
				? this._getNormalSize()
				: !this._normalTextureLoaded &&
				  0 < this._titleRenderer.getString().length
				? this._titleRenderer.getContentSize()
				: cc.size(this._normalTextureSize);
		},
		loadTextures: function (t, e, i, n) {
			this.loadTextureNormal(t, n),
				this.loadTexturePressed(e, n),
				this.loadTextureDisabled(i, n);
		},
		loadTextureNormal: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._normalFileName = t),
					(this._normalTexType = e);
				var i = this,
					n = this._buttonNormalRenderer;
				switch (
					(n._textureLoaded ||
						n.addEventListener('load', function () {
							i.loadTextureNormal(
								i._normalFileName,
								i._normalTexType
							);
						}),
					this._normalTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						n.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						n.initWithSpriteFrameName(t);
				}
				(this._normalTextureLoaded = n._textureLoaded),
					(this._normalTextureSize =
						this._buttonNormalRenderer.getContentSize()),
					this._updateChildrenDisplayedRGBA(),
					this._unifySize
						? this._scale9Enabled &&
						  (n.setCapInsets(this._capInsetsNormal),
						  this._updateContentSizeWithTextureSize(
								this._getNormalSize()
						  ))
						: this._updateContentSizeWithTextureSize(
								this._normalTextureSize
						  ),
					(this._normalTextureAdaptDirty = !0),
					this._findLayout();
			}
		},
		loadTexturePressed: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._clickedFileName = t),
					(this._pressedTexType = e);
				var i = this,
					n = this._buttonClickedRenderer;
				switch (
					(n._textureLoaded ||
						n.addEventListener('load', function () {
							i.loadTexturePressed(
								i._clickedFileName,
								i._pressedTexType
							);
						}),
					this._pressedTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						n.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						n.initWithSpriteFrameName(t);
				}
				this._scale9Enabled && n.setCapInsets(this._capInsetsPressed),
					(this._pressedTextureSize =
						this._buttonClickedRenderer.getContentSize()),
					this._updateChildrenDisplayedRGBA(),
					(this._pressedTextureLoaded = !0),
					(this._pressedTextureAdaptDirty = !0),
					this._findLayout();
			}
		},
		loadTextureDisabled: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._disabledFileName = t),
					(this._disabledTexType = e);
				var i = this,
					n = this._buttonDisableRenderer;
				switch (
					(n._textureLoaded ||
						n.addEventListener('load', function () {
							i.loadTextureDisabled(
								i._disabledFileName,
								i._disabledTexType
							);
						}),
					this._disabledTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						n.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						n.initWithSpriteFrameName(t);
				}
				this._scale9Enabled && n.setCapInsets(this._capInsetsDisabled),
					(this._disabledTextureSize =
						this._buttonDisableRenderer.getContentSize()),
					this._updateChildrenDisplayedRGBA(),
					(this._disabledTextureLoaded = !0),
					(this._disabledTextureAdaptDirty = !0),
					this._findLayout();
			}
		},
		setCapInsets: function (t) {
			this.setCapInsetsNormalRenderer(t),
				this.setCapInsetsPressedRenderer(t),
				this.setCapInsetsDisabledRenderer(t);
		},
		setCapInsetsNormalRenderer: function (t) {
			var e, i, n, r;
			t &&
				((e = t.x),
				(i = t.y),
				(n = t.width),
				(r = t.height),
				this._normalTextureSize.width < n && (n = e = 0),
				this._normalTextureSize.height < r && (r = i = 0),
				((t = this._capInsetsNormal).x = e),
				(t.y = i),
				(t.width = n),
				(t.height = r),
				this._scale9Enabled &&
					this._buttonNormalRenderer.setCapInsets(t));
		},
		getCapInsetsNormalRenderer: function () {
			return cc.rect(this._capInsetsNormal);
		},
		setCapInsetsPressedRenderer: function (t) {
			var e, i, n, r;
			t &&
				this._scale9Enabled &&
				((e = t.x),
				(i = t.y),
				(n = t.width),
				(r = t.height),
				this._pressedTextureSize.width < n && (n = e = 0),
				this._pressedTextureSize.height < r && (r = i = 0),
				((t = this._capInsetsPressed).x = e),
				(t.y = i),
				(t.width = n),
				(t.height = r),
				this._buttonClickedRenderer.setCapInsets(t));
		},
		getCapInsetsPressedRenderer: function () {
			return cc.rect(this._capInsetsPressed);
		},
		setCapInsetsDisabledRenderer: function (t) {
			var e, i, n, r;
			t &&
				this._scale9Enabled &&
				((e = t.x),
				(i = t.y),
				(n = t.width),
				(r = t.height),
				this._disabledTextureSize.width < n && (n = e = 0),
				this._disabledTextureSize.height < r && (r = i = 0),
				((t = this._capInsetsDisabled).x = e),
				(t.y = i),
				(t.width = n),
				(t.height = r),
				this._buttonDisableRenderer.setCapInsets(t));
		},
		getCapInsetsDisabledRenderer: function () {
			return cc.rect(this._capInsetsDisabled);
		},
		_onPressStateChangedToNormal: function () {
			var t;
			this._buttonNormalRenderer.setVisible(!0),
				this._buttonClickedRenderer.setVisible(!1),
				this._buttonDisableRenderer.setVisible(!1),
				this._scale9Enabled &&
					this._buttonNormalRenderer.setState(
						ccui.Scale9Sprite.state.NORMAL
					),
				this._pressedTextureLoaded
					? this.pressedActionEnabled &&
					  (this._buttonNormalRenderer.stopAllActions(),
					  this._buttonClickedRenderer.stopAllActions(),
					  this._buttonNormalRenderer.setScale(
							this._normalTextureScaleXInSize,
							this._normalTextureScaleYInSize
					  ),
					  this._buttonClickedRenderer.setScale(
							this._pressedTextureScaleXInSize,
							this._pressedTextureScaleYInSize
					  ),
					  this._titleRenderer.stopAllActions(),
					  this._unifySize
							? ((t = cc.scaleTo(
									ccui.Button.ZOOM_ACTION_TIME_STEP,
									1,
									1
							  )),
							  this._titleRenderer.runAction(t))
							: (this._titleRenderer.setScaleX(1),
							  this._titleRenderer.setScaleY(1)))
					: (this._buttonNormalRenderer.stopAllActions(),
					  this._buttonNormalRenderer.setScale(
							this._normalTextureScaleXInSize,
							this._normalTextureScaleYInSize
					  ),
					  this._titleRenderer.stopAllActions(),
					  this._scale9Enabled &&
							this._buttonNormalRenderer.setColor(cc.color.WHITE),
					  this._titleRenderer.setScaleX(1),
					  this._titleRenderer.setScaleY(1));
		},
		_onPressStateChangedToPressed: function () {
			var t,
				e = this._buttonNormalRenderer;
			this._scale9Enabled && e.setState(ccui.Scale9Sprite.state.NORMAL),
				this._pressedTextureLoaded
					? (e.setVisible(!1),
					  this._buttonClickedRenderer.setVisible(!0),
					  this._buttonDisableRenderer.setVisible(!1),
					  this.pressedActionEnabled &&
							(e.stopAllActions(),
							this._buttonClickedRenderer.stopAllActions(),
							(t = cc.scaleTo(
								ccui.Button.ZOOM_ACTION_TIME_STEP,
								this._pressedTextureScaleXInSize +
									this._zoomScale,
								this._pressedTextureScaleYInSize +
									this._zoomScale
							)),
							this._buttonClickedRenderer.runAction(t),
							e.setScale(
								this._pressedTextureScaleXInSize +
									this._zoomScale,
								this._pressedTextureScaleYInSize +
									this._zoomScale
							),
							this._titleRenderer.stopAllActions(),
							this._titleRenderer.runAction(
								cc.scaleTo(
									ccui.Button.ZOOM_ACTION_TIME_STEP,
									1 + this._zoomScale,
									1 + this._zoomScale
								)
							)))
					: (e.setVisible(!0),
					  this._buttonClickedRenderer.setVisible(!0),
					  this._buttonDisableRenderer.setVisible(!1),
					  e.stopAllActions(),
					  e.setScale(
							this._normalTextureScaleXInSize + this._zoomScale,
							this._normalTextureScaleYInSize + this._zoomScale
					  ),
					  this._titleRenderer.stopAllActions(),
					  this._titleRenderer.setScaleX(1 + this._zoomScale),
					  this._titleRenderer.setScaleY(1 + this._zoomScale));
		},
		_onPressStateChangedToDisabled: function () {
			this._disabledTextureLoaded
				? (this._buttonNormalRenderer.setVisible(!1),
				  this._buttonDisableRenderer.setVisible(!0))
				: this._normalTextureLoaded &&
				  this._scale9Enabled &&
				  this._buttonNormalRenderer.setState(
						ccui.Scale9Sprite.state.GRAY
				  ),
				this._buttonClickedRenderer.setVisible(!1),
				this._buttonNormalRenderer.setScale(
					this._normalTextureScaleXInSize,
					this._normalTextureScaleYInSize
				),
				this._buttonClickedRenderer.setScale(
					this._pressedTextureScaleXInSize,
					this._pressedTextureScaleYInSize
				);
		},
		_updateContentSize: function () {
			var t;
			if (this._unifySize)
				return (
					this._scale9Enabled
						? ccui.ProtectedNode.setContentSize(this._customSize)
						: ((t = this._getNormalSize()),
						  ccui.ProtectedNode.setContentSize(t)),
					void this._onSizeChanged()
				);
			this._ignoreSize &&
				this.setContentSize(this.getVirtualRendererSize());
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				this._updateTitleLocation(),
				(this._normalTextureAdaptDirty = !0),
				(this._pressedTextureAdaptDirty = !0),
				(this._disabledTextureAdaptDirty = !0);
		},
		getVirtualRenderer: function () {
			if (!this._bright) return this._buttonDisableRenderer;
			switch (this._brightStyle) {
				case ccui.Widget.BRIGHT_STYLE_NORMAL:
					return this._buttonNormalRenderer;
				case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:
					return this._buttonClickedRenderer;
				default:
					return null;
			}
		},
		_normalTextureScaleChangedWithSize: function () {
			if (this._ignoreSize && !this._unifySize)
				this._scale9Enabled ||
					(this._buttonNormalRenderer.setScale(1),
					(this._normalTextureScaleXInSize =
						this._normalTextureScaleYInSize =
							1));
			else if (this._scale9Enabled)
				this._buttonNormalRenderer.setPreferredSize(this._contentSize),
					(this._normalTextureScaleXInSize =
						this._normalTextureScaleYInSize =
							1),
					this._buttonNormalRenderer.setScale(
						this._normalTextureScaleXInSize,
						this._normalTextureScaleYInSize
					);
			else {
				var t = this._normalTextureSize;
				if (t.width <= 0 || t.height <= 0)
					return void this._buttonNormalRenderer.setScale(1);
				var e = this._contentSize.width / t.width,
					t = this._contentSize.height / t.height;
				this._buttonNormalRenderer.setScaleX(e),
					this._buttonNormalRenderer.setScaleY(t),
					(this._normalTextureScaleXInSize = e),
					(this._normalTextureScaleYInSize = t);
			}
			this._buttonNormalRenderer.setPosition(
				this._contentSize.width / 2,
				this._contentSize.height / 2
			);
		},
		_pressedTextureScaleChangedWithSize: function () {
			if (this._ignoreSize && !this._unifySize)
				this._scale9Enabled ||
					(this._buttonClickedRenderer.setScale(1),
					(this._pressedTextureScaleXInSize =
						this._pressedTextureScaleYInSize =
							1));
			else if (this._scale9Enabled)
				this._buttonClickedRenderer.setPreferredSize(this._contentSize),
					(this._pressedTextureScaleXInSize =
						this._pressedTextureScaleYInSize =
							1),
					this._buttonClickedRenderer.setScale(
						this._pressedTextureScaleXInSize,
						this._pressedTextureScaleYInSize
					);
			else {
				var t = this._pressedTextureSize;
				if (t.width <= 0 || t.height <= 0)
					return void this._buttonClickedRenderer.setScale(1);
				var e = this._contentSize.width / t.width,
					t = this._contentSize.height / t.height;
				this._buttonClickedRenderer.setScaleX(e),
					this._buttonClickedRenderer.setScaleY(t),
					(this._pressedTextureScaleXInSize = e),
					(this._pressedTextureScaleYInSize = t);
			}
			this._buttonClickedRenderer.setPosition(
				this._contentSize.width / 2,
				this._contentSize.height / 2
			);
		},
		_disabledTextureScaleChangedWithSize: function () {
			if (this._ignoreSize && !this._unifySize)
				this._scale9Enabled && this._buttonDisableRenderer.setScale(1);
			else if (this._scale9Enabled)
				this._buttonDisableRenderer.setScale(1),
					this._buttonDisableRenderer.setPreferredSize(
						this._contentSize
					);
			else {
				var t = this._disabledTextureSize;
				if (t.width <= 0 || t.height <= 0)
					return void this._buttonDisableRenderer.setScale(1);
				var e = this._contentSize.width / t.width,
					t = this._contentSize.height / t.height;
				this._buttonDisableRenderer.setScaleX(e),
					this._buttonDisableRenderer.setScaleY(t);
			}
			this._buttonDisableRenderer.setPosition(
				this._contentSize.width / 2,
				this._contentSize.height / 2
			);
		},
		_adaptRenderers: function () {
			this._normalTextureAdaptDirty &&
				(this._normalTextureScaleChangedWithSize(),
				(this._normalTextureAdaptDirty = !1)),
				this._pressedTextureAdaptDirty &&
					(this._pressedTextureScaleChangedWithSize(),
					(this._pressedTextureAdaptDirty = !1)),
				this._disabledTextureAdaptDirty &&
					(this._disabledTextureScaleChangedWithSize(),
					(this._disabledTextureAdaptDirty = !1));
		},
		_updateTitleLocation: function () {
			this._titleRenderer.setPosition(
				0.5 * this._contentSize.width,
				0.5 * this._contentSize.height
			);
		},
		setPressedActionEnabled: function (t) {
			this.pressedActionEnabled = t;
		},
		setTitleText: function (t) {
			t !== this.getTitleText() &&
				(this._titleRenderer.setString(t),
				this._ignoreSize
					? ((t = this.getVirtualRendererSize()),
					  this.setContentSize(t))
					: this._titleRenderer._renderCmd._updateTTF());
		},
		getTitleText: function () {
			return this._titleRenderer.getString();
		},
		setTitleColor: function (t) {
			this._titleRenderer.setFontFillColor(t);
		},
		getTitleColor: function () {
			return this._titleRenderer._getFillStyle();
		},
		setTitleFontSize: function (t) {
			this._titleRenderer.setFontSize(t), (this._fontSize = t);
		},
		getTitleFontSize: function () {
			return this._titleRenderer.getFontSize();
		},
		setZoomScale: function (t) {
			this._zoomScale = t;
		},
		getZoomScale: function () {
			return this._zoomScale;
		},
		getNormalTextureSize: function () {
			return this._normalTextureSize;
		},
		setTitleFontName: function (t) {
			this._titleRenderer.setFontName(t), (this._fontName = t);
		},
		getTitleRenderer: function () {
			return this._titleRenderer;
		},
		getTitleFontName: function () {
			return this._titleRenderer.getFontName();
		},
		_setTitleFont: function (t) {
			this._titleRenderer.font = t;
		},
		_getTitleFont: function () {
			return this._titleRenderer.font;
		},
		getDescription: function () {
			return 'Button';
		},
		_createCloneInstance: function () {
			return new ccui.Button();
		},
		_copySpecialProperties: function (t) {
			(this._prevIgnoreSize = t._prevIgnoreSize),
				this.setScale9Enabled(t._scale9Enabled),
				this.loadTextureNormal(t._normalFileName, t._normalTexType),
				this.loadTexturePressed(t._clickedFileName, t._pressedTexType),
				this.loadTextureDisabled(
					t._disabledFileName,
					t._disabledTexType
				),
				this.setCapInsetsNormalRenderer(t._capInsetsNormal),
				this.setCapInsetsPressedRenderer(t._capInsetsPressed),
				this.setCapInsetsDisabledRenderer(t._capInsetsDisabled),
				this.setTitleText(t.getTitleText()),
				this.setTitleFontName(t.getTitleFontName()),
				this.setTitleFontSize(t.getTitleFontSize()),
				this.setTitleColor(t.getTitleColor()),
				this.setPressedActionEnabled(t.pressedActionEnabled),
				this.setZoomScale(t._zoomScale);
		},
		_getNormalSize: function () {
			var t;
			null !== this._titleRenderer &&
				(t = this._titleRenderer.getContentSize()),
				null !== this._buttonNormalRenderer &&
					(i = this._buttonNormalRenderer.getContentSize());
			var e = (t.width > i.width ? t : i).width,
				i = (t.height > i.height ? t : i).height;
			return cc.size(e, i);
		},
	}));
var _p = ccui.Button.prototype;
_p.titleText,
	cc.defineGetterSetter(_p, 'titleText', _p.getTitleText, _p.setTitleText),
	_p.titleFont,
	cc.defineGetterSetter(_p, 'titleFont', _p._getTitleFont, _p._setTitleFont),
	_p.titleFontSize,
	cc.defineGetterSetter(
		_p,
		'titleFontSize',
		_p.getTitleFontSize,
		_p.setTitleFontSize
	),
	_p.titleFontName,
	cc.defineGetterSetter(
		_p,
		'titleFontName',
		_p.getTitleFontName,
		_p.setTitleFontName
	),
	_p.titleColor,
	cc.defineGetterSetter(_p, 'titleColor', _p.getTitleColor, _p.setTitleColor),
	(_p = null),
	(ccui.Button.create = function (t, e, i, n) {
		return new ccui.Button(t, e, i, n);
	}),
	(ccui.Button.NORMAL_RENDERER_ZORDER = -2),
	(ccui.Button.PRESSED_RENDERER_ZORDER = -2),
	(ccui.Button.DISABLED_RENDERER_ZORDER = -2),
	(ccui.Button.TITLE_RENDERER_ZORDER = -1),
	(ccui.Button.ZOOM_ACTION_TIME_STEP = 0.05),
	(ccui.Button.SYSTEM = 0),
	(ccui.Button.TTF = 1),
	(ccui.CheckBox = ccui.Widget.extend({
		_backGroundBoxRenderer: null,
		_backGroundSelectedBoxRenderer: null,
		_frontCrossRenderer: null,
		_backGroundBoxDisabledRenderer: null,
		_frontCrossDisabledRenderer: null,
		_isSelected: !0,
		_checkBoxEventListener: null,
		_checkBoxEventSelector: null,
		_backGroundTexType: ccui.Widget.LOCAL_TEXTURE,
		_backGroundSelectedTexType: ccui.Widget.LOCAL_TEXTURE,
		_frontCrossTexType: ccui.Widget.LOCAL_TEXTURE,
		_backGroundDisabledTexType: ccui.Widget.LOCAL_TEXTURE,
		_frontCrossDisabledTexType: ccui.Widget.LOCAL_TEXTURE,
		_backGroundFileName: '',
		_backGroundSelectedFileName: '',
		_frontCrossFileName: '',
		_backGroundDisabledFileName: '',
		_frontCrossDisabledFileName: '',
		_className: 'CheckBox',
		_zoomScale: 0.1,
		_backgroundTextureScaleX: 0.1,
		_backgroundTextureScaleY: 0.1,
		_backGroundBoxRendererAdaptDirty: !0,
		_backGroundSelectedBoxRendererAdaptDirty: !0,
		_frontCrossRendererAdaptDirty: !0,
		_backGroundBoxDisabledRendererAdaptDirty: !0,
		_frontCrossDisabledRendererAdaptDirty: !0,
		ctor: function (t, e, i, n, r, o) {
			ccui.Widget.prototype.ctor.call(this), this.setTouchEnabled(!0);
			for (var s = 0, c = 0; c < arguments.length; c++) {
				var a = typeof arguments[c];
				'string' == a
					? isNaN(+arguments[c])
						? s++
						: ((o = arguments[c]), (arguments[c] = void 0))
					: 'number' == a && s++;
			}
			2 === s && ((o = i), (i = e), (e = void 0)),
				(o = void 0 === o ? 0 : o),
				(this._isSelected = !0),
				this.setSelected(!1),
				this.loadTextures(t, e, i, n, r, o);
		},
		_initRenderer: function () {
			(this._backGroundBoxRenderer = new cc.Sprite()),
				(this._backGroundSelectedBoxRenderer = new cc.Sprite()),
				(this._frontCrossRenderer = new cc.Sprite()),
				(this._backGroundBoxDisabledRenderer = new cc.Sprite()),
				(this._frontCrossDisabledRenderer = new cc.Sprite()),
				this.addProtectedChild(
					this._backGroundBoxRenderer,
					ccui.CheckBox.BOX_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._backGroundSelectedBoxRenderer,
					ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._frontCrossRenderer,
					ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._backGroundBoxDisabledRenderer,
					ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._frontCrossDisabledRenderer,
					ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER,
					-1
				);
		},
		loadTextures: function (t, e, i, n, r, o) {
			t && this.loadTextureBackGround(t, o),
				e && this.loadTextureBackGroundSelected(e, o),
				i && this.loadTextureFrontCross(i, o),
				n && this.loadTextureBackGroundDisabled(n, o),
				r && this.loadTextureFrontCrossDisabled(r, o);
		},
		loadTextureBackGround: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._backGroundFileName = t),
					(this._backGroundTexType = e);
				var i = this._backGroundBoxRenderer;
				switch (
					(i._textureLoaded
						? this._backGroundBoxRenderer.setContentSize(
								this._customSize
						  )
						: i.addEventListener(
								'load',
								function () {
									this._updateContentSizeWithTextureSize(
										this._backGroundBoxRenderer.getContentSize()
									),
										this.loadTextureBackGround(
											this._backGroundFileName,
											this._backGroundTexType
										);
								},
								this
						  ),
					this._backGroundTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(),
					this._updateContentSizeWithTextureSize(
						this._backGroundBoxRenderer.getContentSize()
					),
					(this._backGroundBoxRendererAdaptDirty = !0),
					this._findLayout();
			}
		},
		loadTextureBackGroundSelected: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._backGroundSelectedFileName = t),
					(this._backGroundSelectedTexType = e);
				var i = this._backGroundSelectedBoxRenderer;
				switch (
					(i._textureLoaded ||
						i.addEventListener(
							'load',
							function () {
								this.loadTextureBackGroundSelected(
									this._backGroundSelectedFileName,
									this._backGroundSelectedTexType
								);
							},
							this
						),
					this._backGroundSelectedTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(),
					(this._backGroundSelectedBoxRendererAdaptDirty = !0),
					this._findLayout();
			}
		},
		loadTextureFrontCross: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._frontCrossFileName = t),
					(this._frontCrossTexType = e);
				var i = this._frontCrossRenderer;
				switch (
					(i._textureLoaded ||
						i.addEventListener(
							'load',
							function () {
								this.loadTextureFrontCross(
									this._frontCrossFileName,
									this._frontCrossTexType
								);
							},
							this
						),
					this._frontCrossTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(),
					(this._frontCrossRendererAdaptDirty = !0),
					this._findLayout();
			}
		},
		loadTextureBackGroundDisabled: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._backGroundDisabledFileName = t),
					(this._backGroundDisabledTexType = e);
				var i = this._backGroundBoxDisabledRenderer;
				switch (
					(i._textureLoaded ||
						i.addEventListener(
							'load',
							function () {
								this.loadTextureBackGroundDisabled(
									this._backGroundDisabledFileName,
									this._backGroundDisabledTexType
								);
							},
							this
						),
					this._backGroundDisabledTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(),
					(this._backGroundBoxDisabledRendererAdaptDirty = !0),
					this._findLayout();
			}
		},
		loadTextureFrontCrossDisabled: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._frontCrossDisabledFileName = t),
					(this._frontCrossDisabledTexType = e);
				var i = this._frontCrossDisabledRenderer;
				switch (
					(i._textureLoaded ||
						i.addEventListener(
							'load',
							function () {
								this.loadTextureFrontCrossDisabled(
									this._frontCrossDisabledFileName,
									this._frontCrossDisabledTexType
								);
							},
							this
						),
					this._frontCrossDisabledTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(),
					(this._frontCrossDisabledRendererAdaptDirty = !0),
					this._findLayout();
			}
		},
		_onPressStateChangedToNormal: function () {
			this._backGroundBoxRenderer.setVisible(!0),
				this._backGroundSelectedBoxRenderer.setVisible(!1),
				this._backGroundBoxDisabledRenderer.setVisible(!1),
				this._frontCrossDisabledRenderer.setVisible(!1),
				this._backGroundBoxRenderer.setScale(
					this._backgroundTextureScaleX,
					this._backgroundTextureScaleY
				),
				this._frontCrossRenderer.setScale(
					this._backgroundTextureScaleX,
					this._backgroundTextureScaleY
				),
				this._isSelected &&
					(this._frontCrossRenderer.setVisible(!0),
					(this._frontCrossRendererAdaptDirty = !0));
		},
		_onPressStateChangedToPressed: function () {
			this._backGroundSelectedFileName
				? (this._backGroundBoxRenderer.setVisible(!1),
				  this._backGroundSelectedBoxRenderer.setVisible(!0),
				  this._backGroundBoxDisabledRenderer.setVisible(!1),
				  this._frontCrossDisabledRenderer.setVisible(!1))
				: (this._backGroundBoxRenderer.setScale(
						this._backgroundTextureScaleX + this._zoomScale,
						this._backgroundTextureScaleY + this._zoomScale
				  ),
				  this._frontCrossRenderer.setScale(
						this._backgroundTextureScaleX + this._zoomScale,
						this._backgroundTextureScaleY + this._zoomScale
				  ));
		},
		_onPressStateChangedToDisabled: function () {
			this._backGroundDisabledFileName &&
				this._frontCrossDisabledFileName &&
				(this._backGroundBoxRenderer.setVisible(!1),
				this._backGroundBoxDisabledRenderer.setVisible(!0)),
				this._backGroundSelectedBoxRenderer.setVisible(!1),
				this._frontCrossRenderer.setVisible(!1),
				this._backGroundBoxRenderer.setScale(
					this._backgroundTextureScaleX,
					this._backgroundTextureScaleY
				),
				this._frontCrossRenderer.setScale(
					this._backgroundTextureScaleX,
					this._backgroundTextureScaleY
				),
				this._isSelected &&
					(this._frontCrossDisabledRenderer.setVisible(!0),
					(this._frontCrossDisabledRendererAdaptDirty = !0));
		},
		setZoomScale: function (t) {
			this._zoomScale = t;
		},
		getZoomScale: function () {
			return this._zoomScale;
		},
		setSelectedState: function (t) {
			this.setSelected(t);
		},
		setSelected: function (t) {
			t !== this._isSelected &&
				((this._isSelected = t),
				this._frontCrossRenderer.setVisible(this._isSelected));
		},
		getSelectedState: function () {
			return this.isSelected();
		},
		isSelected: function () {
			return this._isSelected;
		},
		_selectedEvent: function () {
			this._checkBoxEventSelector &&
				(this._checkBoxEventListener
					? this._checkBoxEventSelector.call(
							this._checkBoxEventListener,
							this,
							ccui.CheckBox.EVENT_SELECTED
					  )
					: this._checkBoxEventSelector(
							this,
							ccui.CheckBox.EVENT_SELECTED
					  ));
		},
		_unSelectedEvent: function () {
			this._checkBoxEventSelector &&
				(this._checkBoxEventListener
					? this._checkBoxEventSelector.call(
							this._checkBoxEventListener,
							this,
							ccui.CheckBox.EVENT_UNSELECTED
					  )
					: this._checkBoxEventSelector(
							this,
							ccui.CheckBox.EVENT_UNSELECTED
					  ));
		},
		_releaseUpEvent: function () {
			ccui.Widget.prototype._releaseUpEvent.call(this),
				this._isSelected
					? (this.setSelected(!1), this._unSelectedEvent())
					: (this.setSelected(!0), this._selectedEvent());
		},
		addEventListenerCheckBox: function (t, e) {
			this.addEventListener(t, e);
		},
		addEventListener: function (t, e) {
			(this._checkBoxEventSelector = t),
				(this._checkBoxEventListener = e);
		},
		getVirtualRendererSize: function () {
			return this._backGroundBoxRenderer.getContentSize();
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				(this._backGroundBoxRendererAdaptDirty = !0),
				(this._backGroundSelectedBoxRendererAdaptDirty = !0),
				(this._frontCrossRendererAdaptDirty = !0),
				(this._backGroundBoxDisabledRendererAdaptDirty = !0),
				(this._frontCrossDisabledRendererAdaptDirty = !0);
		},
		getVirtualRenderer: function () {
			return this._backGroundBoxRenderer;
		},
		_backGroundTextureScaleChangedWithSize: function () {
			var t = this._backGroundBoxRenderer,
				e = this._contentSize;
			if (this._ignoreSize)
				t.setScale(1),
					(this._backgroundTextureScaleX =
						this._backgroundTextureScaleY =
							1);
			else {
				var i = t.getContentSize();
				if (i.width <= 0 || i.height <= 0)
					return (
						t.setScale(1),
						void (this._backgroundTextureScaleX =
							this._backgroundTextureScaleY =
								1)
					);
				var n = e.width / i.width,
					i = e.height / i.height;
				(this._backgroundTextureScaleX = n),
					(this._backgroundTextureScaleY = i),
					t.setScaleX(n),
					t.setScaleY(i);
			}
			t.setPosition(0.5 * e.width, 0.5 * e.height);
		},
		_backGroundSelectedTextureScaleChangedWithSize: function () {
			var t = this._backGroundSelectedBoxRenderer,
				e = this._contentSize;
			if (this._ignoreSize) t.setScale(1);
			else {
				var i = t.getContentSize();
				if (i.width <= 0 || i.height <= 0) return void t.setScale(1);
				var n = e.width / i.width,
					i = e.height / i.height;
				t.setScaleX(n), t.setScaleY(i);
			}
			t.setPosition(0.5 * e.width, 0.5 * e.height);
		},
		_frontCrossTextureScaleChangedWithSize: function () {
			var t = this._frontCrossRenderer,
				e = this._contentSize;
			if (this._ignoreSize) t.setScale(1);
			else {
				var i = t.getContentSize();
				if (i.width <= 0 || i.height <= 0) return void t.setScale(1);
				var n = e.width / i.width,
					i = e.height / i.height;
				t.setScaleX(n), t.setScaleY(i);
			}
			t.setPosition(0.5 * e.width, 0.5 * e.height);
		},
		_backGroundDisabledTextureScaleChangedWithSize: function () {
			var t = this._backGroundBoxDisabledRenderer,
				e = this._contentSize;
			if (this._ignoreSize) t.setScale(1);
			else {
				var i = t.getContentSize();
				if (i.width <= 0 || i.height <= 0) return void t.setScale(1);
				var n = e.width / i.width,
					i = e.height / i.height;
				t.setScaleX(n), t.setScaleY(i);
			}
			t.setPosition(0.5 * e.width, 0.5 * e.height);
		},
		_frontCrossDisabledTextureScaleChangedWithSize: function () {
			var t = this._frontCrossDisabledRenderer,
				e = this._contentSize;
			if (this._ignoreSize) t.setScale(1);
			else {
				var i = t.getContentSize();
				if (i.width <= 0 || i.height <= 0) return void t.setScale(1);
				var n = e.width / i.width,
					i = e.height / i.height;
				t.setScaleX(n), t.setScaleY(i);
			}
			t.setPosition(0.5 * e.width, 0.5 * e.height);
		},
		getDescription: function () {
			return 'CheckBox';
		},
		_createCloneInstance: function () {
			return new ccui.CheckBox();
		},
		_copySpecialProperties: function (t) {
			t instanceof ccui.CheckBox &&
				(this.loadTextureBackGround(
					t._backGroundFileName,
					t._backGroundTexType
				),
				this.loadTextureBackGroundSelected(
					t._backGroundSelectedFileName,
					t._backGroundSelectedTexType
				),
				this.loadTextureFrontCross(
					t._frontCrossFileName,
					t._frontCrossTexType
				),
				this.loadTextureBackGroundDisabled(
					t._backGroundDisabledFileName,
					t._backGroundDisabledTexType
				),
				this.loadTextureFrontCrossDisabled(
					t._frontCrossDisabledFileName,
					t._frontCrossDisabledTexType
				),
				this.setSelected(t._isSelected),
				(this._checkBoxEventListener = t._checkBoxEventListener),
				(this._checkBoxEventSelector = t._checkBoxEventSelector),
				(this._ccEventCallback = t._ccEventCallback),
				(this._zoomScale = t._zoomScale),
				(this._backgroundTextureScaleX = t._backgroundTextureScaleX),
				(this._backgroundTextureScaleY = t._backgroundTextureScaleY));
		},
		_adaptRenderers: function () {
			this._backGroundBoxRendererAdaptDirty &&
				(this._backGroundTextureScaleChangedWithSize(),
				(this._backGroundBoxRendererAdaptDirty = !1)),
				this._backGroundSelectedBoxRendererAdaptDirty &&
					(this._backGroundSelectedTextureScaleChangedWithSize(),
					(this._backGroundSelectedBoxRendererAdaptDirty = !1)),
				this._frontCrossRendererAdaptDirty &&
					(this._frontCrossTextureScaleChangedWithSize(),
					(this._frontCrossRendererAdaptDirty = !1)),
				this._backGroundBoxDisabledRendererAdaptDirty &&
					(this._backGroundDisabledTextureScaleChangedWithSize(),
					(this._backGroundBoxDisabledRendererAdaptDirty = !1)),
				this._frontCrossDisabledRendererAdaptDirty &&
					(this._frontCrossDisabledTextureScaleChangedWithSize(),
					(this._frontCrossDisabledRendererAdaptDirty = !1));
		},
	}));
var _p = ccui.CheckBox.prototype;
_p.selected,
	cc.defineGetterSetter(_p, 'selected', _p.isSelected, _p.setSelected),
	(_p = null),
	(ccui.CheckBox.create = function (t, e, i, n, r, o) {
		return new ccui.CheckBox(t, e, i, n, r, o);
	}),
	(ccui.CheckBox.EVENT_SELECTED = 0),
	(ccui.CheckBox.EVENT_UNSELECTED = 1),
	(ccui.CheckBox.BOX_RENDERER_ZORDER = -1),
	(ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER = -1),
	(ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER = -1),
	(ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER = -1),
	(ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER = -1),
	(ccui.ImageView = ccui.Widget.extend({
		_scale9Enabled: !1,
		_prevIgnoreSize: !0,
		_capInsets: null,
		_imageRenderer: null,
		_textureFile: '',
		_imageTexType: ccui.Widget.LOCAL_TEXTURE,
		_imageTextureSize: null,
		_className: 'ImageView',
		_imageRendererAdaptDirty: !0,
		ctor: function (t, e) {
			(this._capInsets = cc.rect(0, 0, 0, 0)),
				(this._imageTextureSize = cc.size(
					this._capInsets.width,
					this._capInsets.height
				)),
				ccui.Widget.prototype.ctor.call(this),
				(e = void 0 === e ? 0 : e),
				t
					? this.loadTexture(t, e)
					: (this._imageTexType = ccui.Widget.LOCAL_TEXTURE);
		},
		_initRenderer: function () {
			(this._imageRenderer = new cc.Sprite()),
				this.addProtectedChild(
					this._imageRenderer,
					ccui.ImageView.RENDERER_ZORDER,
					-1
				);
		},
		loadTexture: function (t, e) {
			if (t) {
				var i = this;
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._textureFile = t),
					(this._imageTexType = e);
				var n = i._imageRenderer;
				switch (
					(n._textureLoaded ||
						n.addEventListener('load', function () {
							i.loadTexture(i._textureFile, i._imageTexType);
						}),
					i._imageTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i._scale9Enabled
							? (n.initWithFile(t), n.setCapInsets(i._capInsets))
							: n.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i._scale9Enabled
							? (n.initWithSpriteFrameName(t),
							  n.setCapInsets(i._capInsets))
							: n.initWithSpriteFrameName(t);
				}
				(i._imageTextureSize = n.getContentSize()),
					this._updateChildrenDisplayedRGBA(),
					i._updateContentSizeWithTextureSize(i._imageTextureSize),
					(i._imageRendererAdaptDirty = !0),
					i._findLayout();
			}
		},
		setTextureRect: function (t) {
			this._scale9Enabled || this._imageRenderer.setTextureRect(t);
		},
		setScale9Enabled: function (t) {
			this._scale9Enabled !== t &&
				((this._scale9Enabled = t),
				this.removeProtectedChild(this._imageRenderer),
				(this._imageRenderer = null),
				this._scale9Enabled
					? (this._imageRenderer = new ccui.Scale9Sprite())
					: (this._imageRenderer = new cc.Sprite()),
				this.loadTexture(this._textureFile, this._imageTexType),
				this.addProtectedChild(
					this._imageRenderer,
					ccui.ImageView.RENDERER_ZORDER,
					-1
				),
				this._scale9Enabled
					? ((t = this._ignoreSize),
					  this.ignoreContentAdaptWithSize(!1),
					  (this._prevIgnoreSize = t))
					: this.ignoreContentAdaptWithSize(this._prevIgnoreSize),
				this.setCapInsets(this._capInsets),
				(this._imageRendererAdaptDirty = !0));
		},
		isScale9Enabled: function () {
			return this._scale9Enabled;
		},
		ignoreContentAdaptWithSize: function (t) {
			(this._scale9Enabled && (!this._scale9Enabled || t)) ||
				(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, t),
				(this._prevIgnoreSize = t));
		},
		setCapInsets: function (t) {
			var e;
			t &&
				(((e = this._capInsets).x = t.x),
				(e.y = t.y),
				(e.width = t.width),
				(e.height = t.height),
				this._scale9Enabled && this._imageRenderer.setCapInsets(t));
		},
		getCapInsets: function () {
			return cc.rect(this._capInsets);
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				(this._imageRendererAdaptDirty = !0);
		},
		_adaptRenderers: function () {
			this._imageRendererAdaptDirty &&
				(this._imageTextureScaleChangedWithSize(),
				(this._imageRendererAdaptDirty = !1));
		},
		getVirtualRendererSize: function () {
			return cc.size(this._imageTextureSize);
		},
		getVirtualRenderer: function () {
			return this._imageRenderer;
		},
		_imageTextureScaleChangedWithSize: function () {
			if (this._ignoreSize)
				this._scale9Enabled || this._imageRenderer.setScale(1);
			else if (this._scale9Enabled)
				this._imageRenderer.setPreferredSize(this._contentSize),
					this._imageRenderer.setScale(1);
			else {
				var t = this._imageTextureSize;
				if (t.width <= 0 || t.height <= 0)
					return void this._imageRenderer.setScale(1);
				this._imageRenderer.setScaleX(
					this._contentSize.width / t.width
				),
					this._imageRenderer.setScaleY(
						this._contentSize.height / t.height
					);
			}
			this._imageRenderer.setPosition(
				this._contentSize.width / 2,
				this._contentSize.height / 2
			);
		},
		getDescription: function () {
			return 'ImageView';
		},
		_createCloneInstance: function () {
			return new ccui.ImageView();
		},
		_copySpecialProperties: function (t) {
			t instanceof ccui.ImageView &&
				((this._prevIgnoreSize = t._prevIgnoreSize),
				this.setScale9Enabled(t._scale9Enabled),
				this.loadTexture(t._textureFile, t._imageTexType),
				this.setCapInsets(t._capInsets));
		},
		setContentSize: function (t, e) {
			null != e && (t = cc.size(t, e)),
				ccui.Widget.prototype.setContentSize.call(this, t),
				this._scale9Enabled
					? this._imageRenderer.setContentSize(t)
					: ((e = this._imageRenderer.getContentSize()),
					  this._imageRenderer.setScaleX(t.width / e.width),
					  this._imageRenderer.setScaleY(t.height / e.height));
		},
	})),
	(ccui.ImageView.create = function (t, e) {
		return new ccui.ImageView(t, e);
	}),
	(ccui.ImageView.RENDERER_ZORDER = -1),
	(ccui.LoadingBar = ccui.Widget.extend({
		_direction: null,
		_percent: 100,
		_totalLength: 0,
		_barRenderer: null,
		_renderBarTexType: ccui.Widget.LOCAL_TEXTURE,
		_barRendererTextureSize: null,
		_scale9Enabled: !1,
		_prevIgnoreSize: !0,
		_capInsets: null,
		_textureFile: '',
		_isTextureLoaded: !1,
		_className: 'LoadingBar',
		_barRendererAdaptDirty: !0,
		ctor: function (t, e) {
			(this._direction = ccui.LoadingBar.TYPE_LEFT),
				(this._barRendererTextureSize = cc.size(0, 0)),
				(this._capInsets = cc.rect(0, 0, 0, 0)),
				ccui.Widget.prototype.ctor.call(this),
				void 0 !== t && this.loadTexture(t),
				void 0 !== e && this.setPercent(e);
		},
		_initRenderer: function () {
			(this._barRenderer = new cc.Sprite()),
				this.addProtectedChild(
					this._barRenderer,
					ccui.LoadingBar.RENDERER_ZORDER,
					-1
				),
				this._barRenderer.setAnchorPoint(0, 0.5);
		},
		setDirection: function (t) {
			if (this._direction !== t)
				switch (((this._direction = t), this._direction)) {
					case ccui.LoadingBar.TYPE_LEFT:
						this._barRenderer.setAnchorPoint(0, 0.5),
							this._barRenderer.setPosition(
								0,
								0.5 * this._contentSize.height
							),
							this._scale9Enabled ||
								this._barRenderer.setFlippedX(!1);
						break;
					case ccui.LoadingBar.TYPE_RIGHT:
						this._barRenderer.setAnchorPoint(1, 0.5),
							this._barRenderer.setPosition(
								this._totalLength,
								0.5 * this._contentSize.height
							),
							this._scale9Enabled ||
								this._barRenderer.setFlippedX(!0);
				}
		},
		getDirection: function () {
			return this._direction;
		},
		loadTexture: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._renderBarTexType = e),
					(this._textureFile = t);
				var i = this._barRenderer,
					n = this;
				switch (
					(i._textureLoaded ||
						i.addEventListener('load', function () {
							n.loadTexture(n._textureFile, n._renderBarTexType),
								n._setPercent(n._percent);
						}),
					this._renderBarTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				e = i.getContentSize();
				switch (
					((this._barRendererTextureSize.width = e.width),
					(this._barRendererTextureSize.height = e.height),
					this._direction)
				) {
					case ccui.LoadingBar.TYPE_LEFT:
						i.setAnchorPoint(0, 0.5),
							this._scale9Enabled || i.setFlippedX(!1);
						break;
					case ccui.LoadingBar.TYPE_RIGHT:
						i.setAnchorPoint(1, 0.5),
							this._scale9Enabled || i.setFlippedX(!0);
				}
				this._scale9Enabled && i.setCapInsets(this._capInsets),
					this._updateChildrenDisplayedRGBA(),
					this._barRendererScaleChangedWithSize(),
					this._updateContentSizeWithTextureSize(
						this._barRendererTextureSize
					),
					(this._barRendererAdaptDirty = !0),
					this._findLayout();
			}
		},
		setScale9Enabled: function (t) {
			this._scale9Enabled !== t &&
				((this._scale9Enabled = t),
				this.removeProtectedChild(this._barRenderer),
				(this._barRenderer = new (
					this._scale9Enabled ? ccui.Scale9Sprite : cc.Sprite
				)()),
				this.loadTexture(this._textureFile, this._renderBarTexType),
				this.addProtectedChild(
					this._barRenderer,
					ccui.LoadingBar.RENDERER_ZORDER,
					-1
				),
				this._scale9Enabled
					? ((t = this._ignoreSize),
					  this.ignoreContentAdaptWithSize(!1),
					  (this._prevIgnoreSize = t))
					: this.ignoreContentAdaptWithSize(this._prevIgnoreSize),
				this.setCapInsets(this._capInsets),
				this.setPercent(this._percent),
				(this._barRendererAdaptDirty = !0));
		},
		isScale9Enabled: function () {
			return this._scale9Enabled;
		},
		setCapInsets: function (t) {
			var e;
			t &&
				(((e = this._capInsets).x = t.x),
				(e.y = t.y),
				(e.width = t.width),
				(e.height = t.height),
				this._scale9Enabled && this._barRenderer.setCapInsets(t));
		},
		getCapInsets: function () {
			return cc.rect(this._capInsets);
		},
		setPercent: function (t) {
			100 < t && (t = 100),
				t < 0 && (t = 0),
				t !== this._percent &&
					((this._percent = t), this._setPercent(t));
		},
		_setPercent: function () {
			var t, e, i, n;
			this._totalLength <= 0 ||
				((t = this._percent / 100),
				this._scale9Enabled
					? this._setScale9Scale()
					: ((i = this._barRenderer),
					  (n = this._barRendererTextureSize),
					  ((e = i.getTextureRect()).width = n.width * t),
					  i.setTextureRect(
							cc.rect(e.x, e.y, n.width * t, n.height),
							i._rectRotated
					  )));
		},
		setContentSize: function (t, e) {
			ccui.Widget.prototype.setContentSize.call(this, t, e),
				(this._totalLength = void 0 === e ? t.width : t);
		},
		getPercent: function () {
			return this._percent;
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				(this._barRendererAdaptDirty = !0);
		},
		_adaptRenderers: function () {
			this._barRendererAdaptDirty &&
				(this._barRendererScaleChangedWithSize(),
				(this._barRendererAdaptDirty = !1));
		},
		ignoreContentAdaptWithSize: function (t) {
			(this._scale9Enabled && (!this._scale9Enabled || t)) ||
				(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, t),
				(this._prevIgnoreSize = t));
		},
		getVirtualRendererSize: function () {
			return cc.size(this._barRendererTextureSize);
		},
		getVirtualRenderer: function () {
			return this._barRenderer;
		},
		_barRendererScaleChangedWithSize: function () {
			var t = this._barRenderer,
				e = this._contentSize;
			if (this._unifySize)
				(this._totalLength = this._contentSize.width),
					this.setPercent(this._percent);
			else if (this._ignoreSize)
				this._scale9Enabled ||
					((this._totalLength = this._barRendererTextureSize.width),
					t.setScale(1));
			else if (((this._totalLength = e.width), this._scale9Enabled))
				this._setScale9Scale(), t.setScale(1);
			else {
				var i = this._barRendererTextureSize;
				if (i.width <= 0 || i.height <= 0) return void t.setScale(1);
				var n = e.width / i.width,
					i = e.height / i.height;
				t.setScaleX(n), t.setScaleY(i);
			}
			switch (this._direction) {
				case ccui.LoadingBar.TYPE_LEFT:
					t.setPosition(0, 0.5 * e.height);
					break;
				case ccui.LoadingBar.TYPE_RIGHT:
					t.setPosition(this._totalLength, 0.5 * e.height);
			}
		},
		_setScale9Scale: function () {
			var t = (this._percent / 100) * this._totalLength;
			this._barRenderer.setPreferredSize(
				cc.size(t, this._contentSize.height)
			);
		},
		getDescription: function () {
			return 'LoadingBar';
		},
		_createCloneInstance: function () {
			return new ccui.LoadingBar();
		},
		_copySpecialProperties: function (t) {
			t instanceof ccui.LoadingBar &&
				((this._prevIgnoreSize = t._prevIgnoreSize),
				this.setScale9Enabled(t._scale9Enabled),
				this.loadTexture(t._textureFile, t._renderBarTexType),
				this.setCapInsets(t._capInsets),
				this.setPercent(t._percent),
				this.setDirection(t._direction));
		},
	}));
var _p = ccui.LoadingBar.prototype;
_p.direction,
	cc.defineGetterSetter(_p, 'direction', _p.getDirection, _p.setDirection),
	_p.percent,
	cc.defineGetterSetter(_p, 'percent', _p.getPercent, _p.setPercent),
	(_p = null),
	(ccui.LoadingBar.create = function (t, e) {
		return new ccui.LoadingBar(t, e);
	}),
	(ccui.LoadingBar.TYPE_LEFT = 0),
	(ccui.LoadingBar.TYPE_RIGHT = 1),
	(ccui.LoadingBar.RENDERER_ZORDER = -1),
	(ccui.Slider = ccui.Widget.extend({
		_barRenderer: null,
		_progressBarRenderer: null,
		_barTextureSize: null,
		_progressBarTextureSize: null,
		_slidBallNormalRenderer: null,
		_slidBallPressedRenderer: null,
		_slidBallDisabledRenderer: null,
		_slidBallRenderer: null,
		_barLength: 0,
		_percent: 0,
		_scale9Enabled: !1,
		_prevIgnoreSize: !0,
		_textureFile: '',
		_progressBarTextureFile: '',
		_slidBallNormalTextureFile: '',
		_slidBallPressedTextureFile: '',
		_slidBallDisabledTextureFile: '',
		_capInsetsBarRenderer: null,
		_capInsetsProgressBarRenderer: null,
		_sliderEventListener: null,
		_sliderEventSelector: null,
		_barTexType: ccui.Widget.LOCAL_TEXTURE,
		_progressBarTexType: ccui.Widget.LOCAL_TEXTURE,
		_ballNTexType: ccui.Widget.LOCAL_TEXTURE,
		_ballPTexType: ccui.Widget.LOCAL_TEXTURE,
		_ballDTexType: ccui.Widget.LOCAL_TEXTURE,
		_isTextureLoaded: !1,
		_className: 'Slider',
		_barRendererAdaptDirty: !0,
		_progressBarRendererDirty: !0,
		_unifySize: !1,
		_zoomScale: 0.1,
		_sliderBallNormalTextureScaleX: 1,
		_sliderBallNormalTextureScaleY: 1,
		ctor: function (t, e, i) {
			(this._barTextureSize = cc.size(0, 0)),
				(this._progressBarTextureSize = cc.size(0, 0)),
				(this._capInsetsBarRenderer = cc.rect(0, 0, 0, 0)),
				(this._capInsetsProgressBarRenderer = cc.rect(0, 0, 0, 0)),
				ccui.Widget.prototype.ctor.call(this),
				(i = i || 0),
				this.setTouchEnabled(!0),
				t && this.loadBarTexture(t, i),
				e && this.loadSlidBallTextures(e, i);
		},
		_initRenderer: function () {
			(this._barRenderer = new cc.Sprite()),
				(this._progressBarRenderer = new cc.Sprite()),
				this._progressBarRenderer.setAnchorPoint(0, 0.5),
				this.addProtectedChild(
					this._barRenderer,
					ccui.Slider.BASEBAR_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._progressBarRenderer,
					ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,
					-1
				),
				(this._slidBallNormalRenderer = new cc.Sprite()),
				(this._slidBallPressedRenderer = new cc.Sprite()),
				this._slidBallPressedRenderer.setVisible(!1),
				(this._slidBallDisabledRenderer = new cc.Sprite()),
				this._slidBallDisabledRenderer.setVisible(!1),
				(this._slidBallRenderer = new cc.Node()),
				this._slidBallRenderer.addChild(this._slidBallNormalRenderer),
				this._slidBallRenderer.addChild(this._slidBallPressedRenderer),
				this._slidBallRenderer.addChild(this._slidBallDisabledRenderer),
				this._slidBallRenderer.setCascadeColorEnabled(!0),
				this._slidBallRenderer.setCascadeOpacityEnabled(!0),
				this.addProtectedChild(
					this._slidBallRenderer,
					ccui.Slider.BALL_RENDERER_ZORDER,
					-1
				);
		},
		loadBarTexture: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._textureFile = t),
					(this._barTexType = e);
				var i = this._barRenderer,
					n = this;
				switch (
					(i._textureLoaded ||
						i.addEventListener('load', function () {
							n.loadBarTexture(n._textureFile, n._barTexType);
						}),
					this._barTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(),
					(this._barRendererAdaptDirty = !0),
					(this._progressBarRendererDirty = !0),
					this._updateContentSizeWithTextureSize(
						this._barRenderer.getContentSize()
					),
					this._findLayout(),
					(this._barTextureSize = this._barRenderer.getContentSize());
			}
		},
		loadProgressBarTexture: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._progressBarTextureFile = t),
					(this._progressBarTexType = e);
				var i = this._progressBarRenderer,
					n = this;
				switch (
					(i._textureLoaded ||
						i.addEventListener('load', function () {
							n.loadProgressBarTexture(
								n._progressBarTextureFile,
								n._progressBarTexType
							);
						}),
					this._progressBarTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						i.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						i.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(),
					this._progressBarRenderer.setAnchorPoint(cc.p(0, 0.5));
				e = this._progressBarRenderer.getContentSize();
				(this._progressBarTextureSize = {
					width: e.width,
					height: e.height,
				}),
					(this._progressBarRendererDirty = !0),
					this._findLayout();
			}
		},
		setScale9Enabled: function (t) {
			this._scale9Enabled !== t &&
				((this._scale9Enabled = t),
				this.removeProtectedChild(this._barRenderer, !0),
				this.removeProtectedChild(this._progressBarRenderer, !0),
				(this._barRenderer = null),
				(this._progressBarRenderer = null),
				this._scale9Enabled
					? ((this._barRenderer = new ccui.Scale9Sprite()),
					  (this._progressBarRenderer = new ccui.Scale9Sprite()))
					: ((this._barRenderer = new cc.Sprite()),
					  (this._progressBarRenderer = new cc.Sprite())),
				this.loadBarTexture(this._textureFile, this._barTexType),
				this.loadProgressBarTexture(
					this._progressBarTextureFile,
					this._progressBarTexType
				),
				this.addProtectedChild(
					this._barRenderer,
					ccui.Slider.BASEBAR_RENDERER_ZORDER,
					-1
				),
				this.addProtectedChild(
					this._progressBarRenderer,
					ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,
					-1
				),
				this._scale9Enabled
					? ((t = this._ignoreSize),
					  this.ignoreContentAdaptWithSize(!1),
					  (this._prevIgnoreSize = t))
					: this.ignoreContentAdaptWithSize(this._prevIgnoreSize),
				this.setCapInsetsBarRenderer(this._capInsetsBarRenderer),
				this.setCapInsetProgressBarRenderer(
					this._capInsetsProgressBarRenderer
				),
				(this._barRendererAdaptDirty = !0),
				(this._progressBarRendererDirty = !0));
		},
		isScale9Enabled: function () {
			return this._scale9Enabled;
		},
		ignoreContentAdaptWithSize: function (t) {
			(this._scale9Enabled && (!this._scale9Enabled || t)) ||
				(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, t),
				(this._prevIgnoreSize = t));
		},
		setCapInsets: function (t) {
			this.setCapInsetsBarRenderer(t),
				this.setCapInsetProgressBarRenderer(t);
		},
		setCapInsetsBarRenderer: function (t) {
			var e;
			t &&
				(((e = this._capInsetsBarRenderer).x = t.x),
				(e.y = t.y),
				(e.width = t.width),
				(e.height = t.height),
				this._scale9Enabled && this._barRenderer.setCapInsets(t));
		},
		getCapInsetsBarRenderer: function () {
			return cc.rect(this._capInsetsBarRenderer);
		},
		setCapInsetProgressBarRenderer: function (t) {
			var e;
			t &&
				(((e = this._capInsetsProgressBarRenderer).x = t.x),
				(e.y = t.y),
				(e.width = t.width),
				(e.height = t.height),
				this._scale9Enabled &&
					this._progressBarRenderer.setCapInsets(t));
		},
		getCapInsetsProgressBarRenderer: function () {
			return cc.rect(this._capInsetsProgressBarRenderer);
		},
		loadSlidBallTextures: function (t, e, i, n) {
			this.loadSlidBallTextureNormal(t, n),
				this.loadSlidBallTexturePressed(e, n),
				this.loadSlidBallTextureDisabled(i, n);
		},
		loadSlidBallTextureNormal: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._slidBallNormalTextureFile = t),
					(this._ballNTexType = e);
				var i = this;
				switch (
					(this._slidBallNormalRenderer._textureLoaded ||
						this._slidBallNormalRenderer.addEventListener(
							'load',
							function () {
								i.loadSlidBallTextureNormal(
									i._slidBallNormalTextureFile,
									i._ballNTexType
								);
							}
						),
					this._ballNTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						this._slidBallNormalRenderer.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						this._slidBallNormalRenderer.initWithSpriteFrameName(t);
				}
				this._updateChildrenDisplayedRGBA(), this._findLayout();
			}
		},
		loadSlidBallTexturePressed: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._slidBallPressedTextureFile = t),
					(this._ballPTexType = e);
				var i = this;
				switch (
					(this._slidBallPressedRenderer._textureLoaded ||
						this._slidBallPressedRenderer.addEventListener(
							'load',
							function () {
								i.loadSlidBallTexturePressed(
									i._slidBallPressedTextureFile,
									i._ballPTexType
								);
							}
						),
					this._ballPTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						this._slidBallPressedRenderer.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						this._slidBallPressedRenderer.initWithSpriteFrameName(
							t
						);
				}
				this._updateChildrenDisplayedRGBA(), this._findLayout();
			}
		},
		loadSlidBallTextureDisabled: function (t, e) {
			if (t) {
				(e = e || ccui.Widget.LOCAL_TEXTURE),
					(this._slidBallDisabledTextureFile = t),
					(this._ballDTexType = e);
				var i = this;
				switch (
					(this._slidBallDisabledRenderer._textureLoaded ||
						this._slidBallDisabledRenderer.addEventListener(
							'load',
							function () {
								i.loadSlidBallTextureDisabled(
									i._slidBallDisabledTextureFile,
									i._ballDTexType
								);
							}
						),
					this._ballDTexType)
				) {
					case ccui.Widget.LOCAL_TEXTURE:
						this._slidBallDisabledRenderer.initWithFile(t);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						this._slidBallDisabledRenderer.initWithSpriteFrameName(
							t
						);
				}
				this._updateChildrenDisplayedRGBA(), this._findLayout();
			}
		},
		setPercent: function (t) {
			100 < t && (t = 100), t < 0 && (t = 0);
			var e = (this._percent = t) / 100,
				i = this._barLength * e;
			this._slidBallRenderer.setPosition(i, this._contentSize.height / 2),
				this._scale9Enabled
					? this._progressBarRenderer.setPreferredSize(
							cc.size(i, this._contentSize.height)
					  )
					: ((e = (t = this._progressBarRenderer).getTextureRect()),
					  t.setTextureRect(
							cc.rect(e.x, e.y, i / t._scaleX, e.height),
							t.isTextureRectRotated()
					  ));
		},
		hitTest: function (t) {
			var e = this._slidBallNormalRenderer.convertToNodeSpace(t),
				t = this._slidBallNormalRenderer.getContentSize(),
				t = cc.rect(0, 0, t.width, t.height);
			return (
				e.x >= t.x &&
				e.x <= t.x + t.width &&
				e.y >= t.y &&
				e.y <= t.y + t.height
			);
		},
		onTouchBegan: function (t, e) {
			t = ccui.Widget.prototype.onTouchBegan.call(this, t, e);
			return (
				this._hit &&
					((e = this.convertToNodeSpace(this._touchBeganPosition)),
					this.setPercent(this._getPercentWithBallPos(e.x)),
					this._percentChangedEvent()),
				t
			);
		},
		onTouchMoved: function (t, e) {
			(t = t.getLocation()), (t = this.convertToNodeSpace(t));
			this.setPercent(this._getPercentWithBallPos(t.x)),
				this._percentChangedEvent();
		},
		onTouchEnded: function (t, e) {
			ccui.Widget.prototype.onTouchEnded.call(this, t, e);
		},
		onTouchCancelled: function (t, e) {
			ccui.Widget.prototype.onTouchCancelled.call(this, t, e);
		},
		_getPercentWithBallPos: function (t) {
			return (t / this._barLength) * 100;
		},
		addEventListenerSlider: function (t, e) {
			this.addEventListener(t, e);
		},
		addEventListener: function (t, e) {
			(this._sliderEventSelector = t), (this._sliderEventListener = e);
		},
		_percentChangedEvent: function () {
			this._sliderEventSelector &&
				(this._sliderEventListener
					? this._sliderEventSelector.call(
							this._sliderEventListener,
							this,
							ccui.Slider.EVENT_PERCENT_CHANGED
					  )
					: this._sliderEventSelector(
							this,
							ccui.Slider.EVENT_PERCENT_CHANGED
					  )),
				this._ccEventCallback &&
					this._ccEventCallback(
						this,
						ccui.Slider.EVENT_PERCENT_CHANGED
					);
		},
		getPercent: function () {
			return this._percent;
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				(this._barRendererAdaptDirty = !0),
				(this._progressBarRendererDirty = !0);
		},
		_adaptRenderers: function () {
			this._barRendererAdaptDirty &&
				(this._barRendererScaleChangedWithSize(),
				(this._barRendererAdaptDirty = !1)),
				this._progressBarRendererDirty &&
					(this._progressBarRendererScaleChangedWithSize(),
					(this._progressBarRendererDirty = !1));
		},
		getVirtualRendererSize: function () {
			return this._barRenderer.getContentSize();
		},
		getVirtualRenderer: function () {
			return this._barRenderer;
		},
		_barRendererScaleChangedWithSize: function () {
			var t, e;
			this._unifySize
				? ((this._barLength = this._contentSize.width),
				  this._barRenderer.setPreferredSize(this._contentSize))
				: this._ignoreSize
				? (this._barRenderer.setScale(1),
				  (this._barLength = this._contentSize.width))
				: ((this._barLength = this._contentSize.width),
				  this._scale9Enabled
						? (this._barRenderer.setPreferredSize(
								this._contentSize
						  ),
						  this._barRenderer.setScale(1))
						: (e = this._barTextureSize).width <= 0 || e.height <= 0
						? this._barRenderer.setScale(1)
						: ((t = this._contentSize.width / e.width),
						  (e = this._contentSize.height / e.height),
						  this._barRenderer.setScaleX(t),
						  this._barRenderer.setScaleY(e))),
				this._barRenderer.setPosition(
					this._contentSize.width / 2,
					this._contentSize.height / 2
				),
				this.setPercent(this._percent);
		},
		_progressBarRendererScaleChangedWithSize: function () {
			if (this._unifySize)
				this._progressBarRenderer.setPreferredSize(this._contentSize);
			else if (this._ignoreSize)
				this._scale9Enabled ||
					((t = this._progressBarTextureSize),
					(e = this._contentSize.width / t.width),
					(i = this._contentSize.height / t.height),
					this._progressBarRenderer.setScaleX(e),
					this._progressBarRenderer.setScaleY(i));
			else if (this._scale9Enabled)
				this._progressBarRenderer.setPreferredSize(this._contentSize),
					this._progressBarRenderer.setScale(1);
			else {
				var t;
				if (
					(t = this._progressBarTextureSize).width <= 0 ||
					t.height <= 0
				)
					return void this._progressBarRenderer.setScale(1);
				var e = this._contentSize.width / t.width,
					i = this._contentSize.height / t.height;
				this._progressBarRenderer.setScaleX(e),
					this._progressBarRenderer.setScaleY(i);
			}
			this._progressBarRenderer.setPosition(
				0,
				this._contentSize.height / 2
			),
				this.setPercent(this._percent);
		},
		_onPressStateChangedToNormal: function () {
			this._slidBallNormalRenderer.setVisible(!0),
				this._slidBallPressedRenderer.setVisible(!1),
				this._slidBallDisabledRenderer.setVisible(!1),
				this._slidBallNormalRenderer.setScale(
					this._sliderBallNormalTextureScaleX,
					this._sliderBallNormalTextureScaleY
				);
		},
		_onPressStateChangedToPressed: function () {
			this._slidBallPressedTextureFile
				? (this._slidBallNormalRenderer.setVisible(!1),
				  this._slidBallPressedRenderer.setVisible(!0),
				  this._slidBallDisabledRenderer.setVisible(!1))
				: this._slidBallNormalRenderer.setScale(
						this._sliderBallNormalTextureScaleX + this._zoomScale,
						this._sliderBallNormalTextureScaleY + this._zoomScale
				  );
		},
		_onPressStateChangedToDisabled: function () {
			this._slidBallDisabledTextureFile &&
				(this._slidBallNormalRenderer.setVisible(!1),
				this._slidBallDisabledRenderer.setVisible(!0)),
				this._slidBallNormalRenderer.setScale(
					this._sliderBallNormalTextureScaleX,
					this._sliderBallNormalTextureScaleY
				),
				this._slidBallPressedRenderer.setVisible(!1);
		},
		setZoomScale: function (t) {
			this._zoomScale = t;
		},
		getZoomScale: function () {
			return this._zoomScale;
		},
		getDescription: function () {
			return 'Slider';
		},
		_createCloneInstance: function () {
			return new ccui.Slider();
		},
		_copySpecialProperties: function (t) {
			(this._prevIgnoreSize = t._prevIgnoreSize),
				this.setScale9Enabled(t._scale9Enabled),
				this.loadBarTexture(t._textureFile, t._barTexType),
				this.loadProgressBarTexture(
					t._progressBarTextureFile,
					t._progressBarTexType
				),
				this.loadSlidBallTextureNormal(
					t._slidBallNormalTextureFile,
					t._ballNTexType
				),
				this.loadSlidBallTexturePressed(
					t._slidBallPressedTextureFile,
					t._ballPTexType
				),
				this.loadSlidBallTextureDisabled(
					t._slidBallDisabledTextureFile,
					t._ballDTexType
				),
				this.setPercent(t.getPercent()),
				(this._sliderEventListener = t._sliderEventListener),
				(this._sliderEventSelector = t._sliderEventSelector),
				(this._zoomScale = t._zoomScale),
				(this._ccEventCallback = t._ccEventCallback);
		},
	}));
var _p = ccui.Slider.prototype;
_p.percent,
	cc.defineGetterSetter(_p, 'percent', _p.getPercent, _p.setPercent),
	(_p = null),
	(ccui.Slider.create = function (t, e, i) {
		return new ccui.Slider(t, e, i);
	}),
	(ccui.Slider.EVENT_PERCENT_CHANGED = 0),
	(ccui.Slider.BASEBAR_RENDERER_ZORDER = -3),
	(ccui.Slider.PROGRESSBAR_RENDERER_ZORDER = -2),
	(ccui.Slider.BALL_RENDERER_ZORDER = -1),
	(ccui.Text = ccui.Widget.extend({
		_touchScaleChangeEnabled: !1,
		_normalScaleValueX: 1,
		_normalScaleValueY: 1,
		_fontName: 'Arial',
		_fontSize: 16,
		_onSelectedScaleOffset: 0.5,
		_labelRenderer: null,
		_textAreaSize: null,
		_textVerticalAlignment: 0,
		_textHorizontalAlignment: 0,
		_className: 'Text',
		_type: null,
		_labelRendererAdaptDirty: !0,
		ctor: function (t, e, i) {
			(this._type = ccui.Text.Type.SYSTEM),
				(this._textAreaSize = cc.size(0, 0)),
				ccui.Widget.prototype.ctor.call(this),
				void 0 !== i
					? (this.setFontName(e),
					  this.setFontSize(i),
					  this.setString(t))
					: this.setFontName(this._fontName);
		},
		_initRenderer: function () {
			(this._labelRenderer = new cc.LabelTTF()),
				this.addProtectedChild(
					this._labelRenderer,
					ccui.Text.RENDERER_ZORDER,
					-1
				);
		},
		setText: function (t) {
			cc.log('Please use the setString'), this.setString(t);
		},
		setString: function (t) {
			t !== this._labelRenderer.getString() &&
				(this._labelRenderer.setString(t),
				this._updateContentSizeWithTextureSize(
					this._labelRenderer.getContentSize()
				),
				(this._labelRendererAdaptDirty = !0));
		},
		getStringValue: function () {
			return (
				cc.log('Please use the getString'),
				this._labelRenderer.getString()
			);
		},
		getString: function () {
			return this._labelRenderer.getString();
		},
		getStringLength: function () {
			return this._labelRenderer.getStringLength();
		},
		setFontSize: function (t) {
			this._labelRenderer.setFontSize(t),
				(this._fontSize = t),
				this._updateContentSizeWithTextureSize(
					this._labelRenderer.getContentSize()
				),
				(this._labelRendererAdaptDirty = !0);
		},
		getFontSize: function () {
			return this._fontSize;
		},
		setFontName: function (t) {
			(this._fontName = t),
				this._labelRenderer.setFontName(t),
				this._updateContentSizeWithTextureSize(
					this._labelRenderer.getContentSize()
				),
				(this._labelRendererAdaptDirty = !0);
		},
		getFontName: function () {
			return this._fontName;
		},
		_setFont: function (t) {
			var e = cc.LabelTTF._fontStyleRE.exec(t);
			e &&
				((this._fontSize = parseInt(e[1])),
				(this._fontName = e[2]),
				this._labelRenderer._setFont(t),
				this._labelScaleChangedWithSize());
		},
		_getFont: function () {
			return this._labelRenderer._getFont();
		},
		getType: function () {
			return this._type;
		},
		setTextAreaSize: function (t) {
			this._labelRenderer.setDimensions(t),
				this._ignoreSize || (this._customSize = t),
				this._updateContentSizeWithTextureSize(
					this._labelRenderer.getContentSize()
				),
				(this._labelRendererAdaptDirty = !0);
		},
		getTextAreaSize: function () {
			return this._labelRenderer.getDimensions();
		},
		setTextHorizontalAlignment: function (t) {
			this._labelRenderer.setHorizontalAlignment(t),
				this._updateContentSizeWithTextureSize(
					this._labelRenderer.getContentSize()
				),
				(this._labelRendererAdaptDirty = !0);
		},
		getTextHorizontalAlignment: function () {
			return this._labelRenderer.getHorizontalAlignment();
		},
		setTextVerticalAlignment: function (t) {
			this._labelRenderer.setVerticalAlignment(t),
				this._updateContentSizeWithTextureSize(
					this._labelRenderer.getContentSize()
				),
				(this._labelRendererAdaptDirty = !0);
		},
		getTextVerticalAlignment: function () {
			return this._labelRenderer.getVerticalAlignment();
		},
		setTouchScaleChangeEnabled: function (t) {
			this._touchScaleChangeEnabled = t;
		},
		isTouchScaleChangeEnabled: function () {
			return this._touchScaleChangeEnabled;
		},
		_onPressStateChangedToNormal: function () {
			this._touchScaleChangeEnabled &&
				(this._labelRenderer.setScaleX(this._normalScaleValueX),
				this._labelRenderer.setScaleY(this._normalScaleValueY));
		},
		_onPressStateChangedToPressed: function () {
			this._touchScaleChangeEnabled &&
				(this._labelRenderer.setScaleX(
					this._normalScaleValueX + this._onSelectedScaleOffset
				),
				this._labelRenderer.setScaleY(
					this._normalScaleValueY + this._onSelectedScaleOffset
				));
		},
		_onPressStateChangedToDisabled: function () {},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				(this._labelRendererAdaptDirty = !0);
		},
		_adaptRenderers: function () {
			this._labelRendererAdaptDirty &&
				(this._labelScaleChangedWithSize(),
				(this._labelRendererAdaptDirty = !1));
		},
		getVirtualRendererSize: function () {
			return this._labelRenderer.getContentSize();
		},
		getVirtualRenderer: function () {
			return this._labelRenderer;
		},
		getAutoRenderSize: function () {
			var t = this._labelRenderer.getContentSize();
			return (
				this._ignoreSize ||
					(this._labelRenderer.setDimensions(0, 0),
					(t = this._labelRenderer.getContentSize()),
					this._labelRenderer.setDimensions(
						this._contentSize.width,
						this._contentSize.height
					)),
				t
			);
		},
		_labelScaleChangedWithSize: function () {
			var t = this._contentSize;
			if (this._ignoreSize)
				this._labelRenderer.setDimensions(0, 0),
					this._labelRenderer.setScale(1),
					(this._normalScaleValueX = this._normalScaleValueY = 1);
			else {
				this._labelRenderer.setDimensions(cc.size(t.width, t.height));
				var e = this._labelRenderer.getContentSize();
				if (e.width <= 0 || e.height <= 0)
					return void this._labelRenderer.setScale(1);
				var i = t.width / e.width,
					e = t.height / e.height;
				this._labelRenderer.setScaleX(i),
					this._labelRenderer.setScaleY(e),
					(this._normalScaleValueX = i),
					(this._normalScaleValueY = e);
			}
			this._labelRenderer.setPosition(t.width / 2, t.height / 2);
		},
		getDescription: function () {
			return 'Label';
		},
		enableShadow: function (t, e, i) {
			this._labelRenderer.enableShadow(t, e, i);
		},
		enableOutline: function (t, e) {
			this._labelRenderer.enableStroke(t, e);
		},
		enableGlow: function (t) {
			this._type === ccui.Text.Type.TTF &&
				this._labelRenderer.enableGlow(t);
		},
		disableEffect: function () {
			this._labelRenderer.disableEffect &&
				this._labelRenderer.disableEffect();
		},
		_createCloneInstance: function () {
			return new ccui.Text();
		},
		_copySpecialProperties: function (t) {
			t instanceof ccui.Text &&
				(this.setFontName(t._fontName),
				this.setFontSize(t.getFontSize()),
				this.setString(t.getString()),
				this.setTouchScaleChangeEnabled(t.touchScaleEnabled),
				this.setTextAreaSize(t._textAreaSize),
				this.setTextHorizontalAlignment(
					t._labelRenderer.getHorizontalAlignment()
				),
				this.setTextVerticalAlignment(
					t._labelRenderer.getVerticalAlignment()
				),
				this.setContentSize(t.getContentSize()),
				this.setTextColor(t.getTextColor()));
		},
		_setBoundingWidth: function (t) {
			(this._textAreaSize.width = t),
				this._labelRenderer._setBoundingWidth(t),
				this._labelScaleChangedWithSize();
		},
		_setBoundingHeight: function (t) {
			(this._textAreaSize.height = t),
				this._labelRenderer._setBoundingHeight(t),
				this._labelScaleChangedWithSize();
		},
		_getBoundingWidth: function () {
			return this._textAreaSize.width;
		},
		_getBoundingHeight: function () {
			return this._textAreaSize.height;
		},
		_changePosition: function () {
			this._adaptRenderers();
		},
		setColor: function (t) {
			cc.ProtectedNode.prototype.setColor.call(this, t),
				this._labelRenderer.setColor(t);
		},
		setTextColor: function (t) {
			this._labelRenderer.setFontFillColor(t);
		},
		getTextColor: function () {
			return this._labelRenderer._getFillStyle();
		},
	}));
var _p = ccui.Text.prototype;
_p.boundingWidth,
	cc.defineGetterSetter(
		_p,
		'boundingWidth',
		_p._getBoundingWidth,
		_p._setBoundingWidth
	),
	_p.boundingHeight,
	cc.defineGetterSetter(
		_p,
		'boundingHeight',
		_p._getBoundingHeight,
		_p._setBoundingHeight
	),
	_p.string,
	cc.defineGetterSetter(_p, 'string', _p.getString, _p.setString),
	_p.stringLength,
	cc.defineGetterSetter(_p, 'stringLength', _p.getStringLength),
	_p.font,
	cc.defineGetterSetter(_p, 'font', _p._getFont, _p._setFont),
	_p.fontSize,
	cc.defineGetterSetter(_p, 'fontSize', _p.getFontSize, _p.setFontSize),
	_p.fontName,
	cc.defineGetterSetter(_p, 'fontName', _p.getFontName, _p.setFontName),
	_p.textAlign,
	cc.defineGetterSetter(
		_p,
		'textAlign',
		_p.getTextHorizontalAlignment,
		_p.setTextHorizontalAlignment
	),
	_p.verticalAlign,
	cc.defineGetterSetter(
		_p,
		'verticalAlign',
		_p.getTextVerticalAlignment,
		_p.setTextVerticalAlignment
	),
	(_p = null),
	(ccui.Label = ccui.Text.create =
		function (t, e, i) {
			return new ccui.Text(t, e, i);
		}),
	(ccui.Text.RENDERER_ZORDER = -1),
	(ccui.Text.Type = { SYSTEM: 0, TTF: 1 }),
	(ccui.TextAtlas = ccui.Widget.extend({
		_labelAtlasRenderer: null,
		_stringValue: '',
		_charMapFileName: '',
		_itemWidth: 0,
		_itemHeight: 0,
		_startCharMap: '',
		_className: 'TextAtlas',
		_labelAtlasRendererAdaptDirty: null,
		ctor: function (t, e, i, n, r) {
			ccui.Widget.prototype.ctor.call(this),
				void 0 !== r && this.setProperty(t, e, i, n, r);
		},
		_initRenderer: function () {
			(this._labelAtlasRenderer = new cc.LabelAtlas()),
				this._labelAtlasRenderer.setAnchorPoint(cc.p(0.5, 0.5)),
				this.addProtectedChild(
					this._labelAtlasRenderer,
					ccui.TextAtlas.RENDERER_ZORDER,
					-1
				);
		},
		setProperty: function (t, e, i, n, r) {
			(this._stringValue = t),
				(this._charMapFileName = e),
				(this._itemWidth = i),
				(this._itemHeight = n),
				(this._startCharMap = r),
				this._labelAtlasRenderer.initWithString(
					t,
					this._charMapFileName,
					this._itemWidth,
					this._itemHeight,
					this._startCharMap[0]
				),
				this._updateContentSizeWithTextureSize(
					this._labelAtlasRenderer.getContentSize()
				),
				(this._labelAtlasRendererAdaptDirty = !0);
		},
		setString: function (t) {
			t !== this._labelAtlasRenderer.getString() &&
				((this._stringValue = t),
				this._labelAtlasRenderer.setString(t),
				this._updateContentSizeWithTextureSize(
					this._labelAtlasRenderer.getContentSize()
				),
				(this._labelAtlasRendererAdaptDirty = !0));
		},
		setStringValue: function (t) {
			cc.log('Please use the setString'), this.setString(t);
		},
		getStringValue: function () {
			return cc.log('Please use the getString'), this.getString();
		},
		getString: function () {
			return this._labelAtlasRenderer.getString();
		},
		getStringLength: function () {
			return this._labelAtlasRenderer.getStringLength();
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				(this._labelAtlasRendererAdaptDirty = !0);
		},
		_adaptRenderers: function () {
			this._labelAtlasRendererAdaptDirty &&
				(this._labelAtlasScaleChangedWithSize(),
				(this._labelAtlasRendererAdaptDirty = !1));
		},
		getVirtualRendererSize: function () {
			return this._labelAtlasRenderer.getContentSize();
		},
		getVirtualRenderer: function () {
			return this._labelAtlasRenderer;
		},
		_labelAtlasScaleChangedWithSize: function () {
			var t = this._labelAtlasRenderer;
			if (this._ignoreSize) t.setScale(1);
			else {
				var e = t.getContentSize();
				if (e.width <= 0 || e.height <= 0) return void t.setScale(1);
				t.setScaleX(this._contentSize.width / e.width),
					t.setScaleY(this._contentSize.height / e.height);
			}
			t.setPosition(
				this._contentSize.width / 2,
				this._contentSize.height / 2
			);
		},
		getDescription: function () {
			return 'LabelAtlas';
		},
		_copySpecialProperties: function (t) {
			t &&
				this.setProperty(
					t._stringValue,
					t._charMapFileName,
					t._itemWidth,
					t._itemHeight,
					t._startCharMap
				);
		},
		_createCloneInstance: function () {
			return new ccui.TextAtlas();
		},
	}));
var _p = ccui.TextAtlas.prototype;
_p.string,
	cc.defineGetterSetter(_p, 'string', _p.getString, _p.setString),
	(_p = null),
	(ccui.TextAtlas.create = function (t, e, i, n, r) {
		return new ccui.TextAtlas(t, e, i, n, r);
	}),
	(ccui.TextAtlas.RENDERER_ZORDER = -1),
	(ccui.LabelBMFont = ccui.TextBMFont =
		ccui.Widget.extend({
			_labelBMFontRenderer: null,
			_fntFileHasInit: !1,
			_fntFileName: '',
			_stringValue: '',
			_className: 'TextBMFont',
			_labelBMFontRendererAdaptDirty: !0,
			ctor: function (t, e) {
				ccui.Widget.prototype.ctor.call(this),
					void 0 !== e && (this.setFntFile(e), this.setString(t));
			},
			_initRenderer: function () {
				(this._labelBMFontRenderer = new cc.LabelBMFont()),
					this.addProtectedChild(
						this._labelBMFontRenderer,
						ccui.TextBMFont.RENDERER_ZORDER,
						-1
					);
			},
			setFntFile: function (t) {
				var e;
				t &&
					((this._fntFileName = t),
					(this._fntFileHasInit = !0),
					this._labelBMFontRenderer.initWithString(
						this._stringValue,
						t
					),
					this._updateContentSizeWithTextureSize(
						this._labelBMFontRenderer.getContentSize()
					),
					(this._labelBMFontRendererAdaptDirty = !0),
					(t = (e = this)._labelBMFontRenderer)._textureLoaded ||
						t.addEventListener('load', function () {
							e.setFntFile(e._fntFileName);
							for (var t = e.parent; t; ) {
								if (t.requestDoLayout) {
									t.requestDoLayout();
									break;
								}
								t = t.parent;
							}
						}));
			},
			setText: function (t) {
				cc.log('Please use the setString'), this.setString(t);
			},
			setString: function (t) {
				t !== this._labelBMFontRenderer.getString() &&
					((this._stringValue = t),
					this._labelBMFontRenderer.setString(t),
					this._fntFileHasInit &&
						(this._updateContentSizeWithTextureSize(
							this._labelBMFontRenderer.getContentSize()
						),
						(this._labelBMFontRendererAdaptDirty = !0)));
			},
			getString: function () {
				return this._stringValue;
			},
			getStringLength: function () {
				return this._labelBMFontRenderer.getStringLength();
			},
			_onSizeChanged: function () {
				ccui.Widget.prototype._onSizeChanged.call(this),
					(this._labelBMFontRendererAdaptDirty = !0);
			},
			_adaptRenderers: function () {
				this._labelBMFontRendererAdaptDirty &&
					(this._labelBMFontScaleChangedWithSize(),
					(this._labelBMFontRendererAdaptDirty = !1));
			},
			getVirtualRendererSize: function () {
				return this._labelBMFontRenderer.getContentSize();
			},
			getVirtualRenderer: function () {
				return this._labelBMFontRenderer;
			},
			_labelBMFontScaleChangedWithSize: function () {
				var t = this._labelBMFontRenderer;
				if (this._ignoreSize) t.setScale(1);
				else {
					var e = t.getContentSize();
					if (e.width <= 0 || e.height <= 0)
						return void t.setScale(1);
					t.setScaleX(this._contentSize.width / e.width),
						t.setScaleY(this._contentSize.height / e.height);
				}
				t.setPosition(
					this._contentSize.width / 2,
					this._contentSize.height / 2
				);
			},
			getDescription: function () {
				return 'TextBMFont';
			},
			_createCloneInstance: function () {
				return new ccui.TextBMFont();
			},
			_copySpecialProperties: function (t) {
				this.setFntFile(t._fntFileName), this.setString(t._stringValue);
			},
		}));
var _p = ccui.TextBMFont.prototype;
_p.string,
	cc.defineGetterSetter(_p, 'string', _p.getString, _p.setString),
	(_p = null),
	(ccui.TextBMFont.create = function (t, e) {
		return new ccui.TextBMFont(t, e);
	}),
	(ccui.TextBMFont.RENDERER_ZORDER = -1),
	(ccui._TextFieldRenderer = cc.TextFieldTTF.extend({
		_maxLengthEnabled: !1,
		_maxLength: 0,
		_passwordEnabled: !1,
		_passwordStyleText: '',
		_attachWithIME: !1,
		_detachWithIME: !1,
		_insertText: !1,
		_deleteBackward: !1,
		_className: '_TextFieldRenderer',
		ctor: function () {
			cc.TextFieldTTF.prototype.ctor.call(this),
				(this._maxLengthEnabled = !1),
				(this._maxLength = 0),
				(this._passwordEnabled = !1),
				(this._passwordStyleText = '*'),
				(this._attachWithIME = !1),
				(this._detachWithIME = !1),
				(this._insertText = !1),
				(this._deleteBackward = !1);
		},
		onEnter: function () {
			cc.TextFieldTTF.prototype.onEnter.call(this),
				cc.TextFieldTTF.prototype.setDelegate.call(this, this);
		},
		onTextFieldAttachWithIME: function (t) {
			return this.setAttachWithIME(!0), !1;
		},
		onTextFieldInsertText: function (t, e, i) {
			return (
				(1 !== i || '\n' !== e) &&
				(this.setInsertText(!0),
				this._maxLengthEnabled &&
					cc.TextFieldTTF.prototype.getCharCount.call(this) >=
						this._maxLength)
			);
		},
		onTextFieldDeleteBackward: function (t, e, i) {
			return this.setDeleteBackward(!0), !1;
		},
		onTextFieldDetachWithIME: function (t) {
			return this.setDetachWithIME(!0), !1;
		},
		insertText: function (t, e) {
			var i = t;
			if (
				'\n' !== t &&
				this._maxLengthEnabled &&
				this.getString().length >= this._maxLength
			)
				return void (
					this._passwordEnabled &&
					this.setPasswordText(this.getString())
				);
			cc.TextFieldTTF.prototype.insertText.call(this, i, e),
				this._passwordEnabled &&
					0 < cc.TextFieldTTF.prototype.getCharCount.call(this) &&
					this.setPasswordText(this.getString());
		},
		deleteBackward: function () {
			cc.TextFieldTTF.prototype.deleteBackward.call(this),
				0 < cc.TextFieldTTF.prototype.getCharCount.call(this) &&
					this._passwordEnabled &&
					this.setPasswordText(this._inputText);
		},
		openIME: function () {
			cc.TextFieldTTF.prototype.attachWithIME.call(this);
		},
		closeIME: function () {
			cc.TextFieldTTF.prototype.detachWithIME.call(this);
		},
		setMaxLengthEnabled: function (t) {
			this._maxLengthEnabled = t;
		},
		isMaxLengthEnabled: function () {
			return this._maxLengthEnabled;
		},
		setMaxLength: function (t) {
			this._maxLength = t;
		},
		getMaxLength: function () {
			return this._maxLength;
		},
		getCharCount: function () {
			return cc.TextFieldTTF.prototype.getCharCount.call(this);
		},
		setPasswordEnabled: function (t) {
			this._passwordEnabled = t;
		},
		isPasswordEnabled: function () {
			return this._passwordEnabled;
		},
		setPasswordStyleText: function (t) {
			var e;
			1 < t.length ||
				(e = t.charCodeAt(0)) < 33 ||
				126 < e ||
				(this._passwordStyleText = t);
		},
		setPasswordText: function (t) {
			var e = '',
				t = t.length,
				i = t;
			this._maxLengthEnabled &&
				t > this._maxLength &&
				(i = this._maxLength);
			for (var n = 0; n < i; ++n) e += this._passwordStyleText;
			cc.LabelTTF.prototype.setString.call(this, e);
		},
		setAttachWithIME: function (t) {
			this._attachWithIME = t;
		},
		getAttachWithIME: function () {
			return this._attachWithIME;
		},
		setDetachWithIME: function (t) {
			this._detachWithIME = t;
		},
		getDetachWithIME: function () {
			return this._detachWithIME;
		},
		setInsertText: function (t) {
			this._insertText = t;
		},
		getInsertText: function () {
			return this._insertText;
		},
		setDeleteBackward: function (t) {
			this._deleteBackward = t;
		},
		getDeleteBackward: function () {
			return this._deleteBackward;
		},
		onDraw: function (t) {
			return !1;
		},
	})),
	(ccui._TextFieldRenderer.create = function (t, e, i) {
		var n = new ccui._TextFieldRenderer();
		return n && n.initWithString('', e, i)
			? (t && n.setPlaceHolder(t), n)
			: null;
	}),
	(ccui.TextField = ccui.Widget.extend({
		_textFieldRenderer: null,
		_touchWidth: 0,
		_touchHeight: 0,
		_useTouchArea: !1,
		_textFieldEventListener: null,
		_textFieldEventSelector: null,
		_passwordStyleText: '',
		_textFieldRendererAdaptDirty: !0,
		_fontName: '',
		_fontSize: 12,
		_ccEventCallback: null,
		ctor: function (t, e, i) {
			ccui.Widget.prototype.ctor.call(this),
				this.setTouchEnabled(!0),
				e && this.setFontName(e),
				i && this.setFontSize(i),
				t && this.setPlaceHolder(t);
		},
		onEnter: function () {
			ccui.Widget.prototype.onEnter.call(this), this.scheduleUpdate();
		},
		_initRenderer: function () {
			(this._textFieldRenderer = ccui._TextFieldRenderer.create(
				'input words here',
				'Thonburi',
				20
			)),
				this.addProtectedChild(
					this._textFieldRenderer,
					ccui.TextField.RENDERER_ZORDER,
					-1
				);
		},
		setTouchSize: function (t) {
			(this._touchWidth = t.width), (this._touchHeight = t.height);
		},
		setTouchAreaEnabled: function (t) {
			this._useTouchArea = t;
		},
		hitTest: function (t) {
			if (this._useTouchArea) {
				var e = this.convertToNodeSpace(t),
					i = cc.rect(
						-this._touchWidth * this._anchorPoint.x,
						-this._touchHeight * this._anchorPoint.y,
						this._touchWidth,
						this._touchHeight
					);
				return (
					e.x >= i.x &&
					e.x <= i.x + i.width &&
					e.y >= i.y &&
					e.y <= i.y + i.height
				);
			}
			return ccui.Widget.prototype.hitTest.call(this, t);
		},
		getTouchSize: function () {
			return cc.size(this._touchWidth, this._touchHeight);
		},
		setText: function (t) {
			cc.log('Please use the setString'), this.setString(t);
		},
		setString: function (t) {
			null != t &&
				((t = String(t)),
				this.isMaxLengthEnabled() &&
					(t = t.substr(0, this.getMaxLength())),
				this.isPasswordEnabled()
					? (this._textFieldRenderer.setPasswordText(t),
					  this._textFieldRenderer.setString(''),
					  this._textFieldRenderer.insertText(t, t.length))
					: this._textFieldRenderer.setString(t),
				(this._textFieldRendererAdaptDirty = !0),
				this._updateContentSizeWithTextureSize(
					this._textFieldRenderer.getContentSize()
				));
		},
		setPlaceHolder: function (t) {
			this._textFieldRenderer.setPlaceHolder(t),
				(this._textFieldRendererAdaptDirty = !0),
				this._updateContentSizeWithTextureSize(
					this._textFieldRenderer.getContentSize()
				);
		},
		getPlaceHolder: function () {
			return this._textFieldRenderer.getPlaceHolder();
		},
		getPlaceHolderColor: function () {
			return this._textFieldRenderer.getPlaceHolderColor();
		},
		setPlaceHolderColor: function (t) {
			this._textFieldRenderer.setColorSpaceHolder(t);
		},
		setTextColor: function (t) {
			this._textFieldRenderer.setTextColor(t);
		},
		setFontSize: function (t) {
			this._textFieldRenderer.setFontSize(t),
				(this._fontSize = t),
				(this._textFieldRendererAdaptDirty = !0),
				this._updateContentSizeWithTextureSize(
					this._textFieldRenderer.getContentSize()
				);
		},
		getFontSize: function () {
			return this._fontSize;
		},
		setFontName: function (t) {
			this._textFieldRenderer.setFontName(t),
				(this._fontName = t),
				(this._textFieldRendererAdaptDirty = !0),
				this._updateContentSizeWithTextureSize(
					this._textFieldRenderer.getContentSize()
				);
		},
		getFontName: function () {
			return this._fontName;
		},
		didNotSelectSelf: function () {
			this._textFieldRenderer.detachWithIME();
		},
		getStringValue: function () {
			return cc.log('Please use the getString'), this.getString();
		},
		getString: function () {
			return this._textFieldRenderer.getString();
		},
		getStringLength: function () {
			return this._textFieldRenderer.getStringLength();
		},
		onTouchBegan: function (t, e) {
			var i = this,
				e = ccui.Widget.prototype.onTouchBegan.call(i, t, e);
			return (
				i._hit
					? setTimeout(function () {
							i._textFieldRenderer.attachWithIME();
					  }, 0)
					: setTimeout(function () {
							i._textFieldRenderer.detachWithIME();
					  }, 0),
				e
			);
		},
		setMaxLengthEnabled: function (t) {
			this._textFieldRenderer.setMaxLengthEnabled(t);
		},
		isMaxLengthEnabled: function () {
			return this._textFieldRenderer.isMaxLengthEnabled();
		},
		setMaxLength: function (t) {
			this._textFieldRenderer.setMaxLength(t),
				this.setString(this.getString());
		},
		getMaxLength: function () {
			return this._textFieldRenderer.getMaxLength();
		},
		setPasswordEnabled: function (t) {
			this._textFieldRenderer.setPasswordEnabled(t);
		},
		isPasswordEnabled: function () {
			return this._textFieldRenderer.isPasswordEnabled();
		},
		setPasswordStyleText: function (t) {
			this._textFieldRenderer.setPasswordStyleText(t),
				(this._passwordStyleText = t),
				this.setString(this.getString());
		},
		getPasswordStyleText: function () {
			return this._passwordStyleText;
		},
		update: function (t) {
			this.getDetachWithIME() &&
				(this._detachWithIMEEvent(), this.setDetachWithIME(!1)),
				this.getAttachWithIME() &&
					(this._attachWithIMEEvent(), this.setAttachWithIME(!1)),
				this.getInsertText() &&
					((this._textFieldRendererAdaptDirty = !0),
					this._updateContentSizeWithTextureSize(
						this._textFieldRenderer.getContentSize()
					),
					this._insertTextEvent(),
					this.setInsertText(!1)),
				this.getDeleteBackward() &&
					((this._textFieldRendererAdaptDirty = !0),
					this._updateContentSizeWithTextureSize(
						this._textFieldRenderer.getContentSize()
					),
					this._deleteBackwardEvent(),
					this.setDeleteBackward(!1));
		},
		getAttachWithIME: function () {
			return this._textFieldRenderer.getAttachWithIME();
		},
		setAttachWithIME: function (t) {
			this._textFieldRenderer.setAttachWithIME(t);
		},
		getDetachWithIME: function () {
			return this._textFieldRenderer.getDetachWithIME();
		},
		setDetachWithIME: function (t) {
			this._textFieldRenderer.setDetachWithIME(t);
		},
		getInsertText: function () {
			return this._textFieldRenderer.getInsertText();
		},
		setInsertText: function (t) {
			this._textFieldRenderer.setInsertText(t);
		},
		getDeleteBackward: function () {
			return this._textFieldRenderer.getDeleteBackward();
		},
		setDeleteBackward: function (t) {
			this._textFieldRenderer.setDeleteBackward(t);
		},
		_attachWithIMEEvent: function () {
			this._textFieldEventSelector &&
				(this._textFieldEventListener
					? this._textFieldEventSelector.call(
							this._textFieldEventListener,
							this,
							ccui.TextField.EVENT_ATTACH_WITH_IME
					  )
					: this._textFieldEventSelector(
							this,
							ccui.TextField.EVENT_ATTACH_WITH_IME
					  )),
				this._ccEventCallback &&
					this._ccEventCallback(
						this,
						ccui.TextField.EVENT_ATTACH_WITH_IME
					);
		},
		_detachWithIMEEvent: function () {
			this._textFieldEventSelector &&
				(this._textFieldEventListener
					? this._textFieldEventSelector.call(
							this._textFieldEventListener,
							this,
							ccui.TextField.EVENT_DETACH_WITH_IME
					  )
					: this._textFieldEventSelector(
							this,
							ccui.TextField.EVENT_DETACH_WITH_IME
					  )),
				this._ccEventCallback &&
					this._ccEventCallback(
						this,
						ccui.TextField.EVENT_DETACH_WITH_IME
					);
		},
		_insertTextEvent: function () {
			this._textFieldEventSelector &&
				(this._textFieldEventListener
					? this._textFieldEventSelector.call(
							this._textFieldEventListener,
							this,
							ccui.TextField.EVENT_INSERT_TEXT
					  )
					: this._textFieldEventSelector(
							this,
							ccui.TextField.EVENT_INSERT_TEXT
					  )),
				this._ccEventCallback &&
					this._ccEventCallback(
						this,
						ccui.TextField.EVENT_INSERT_TEXT
					);
		},
		_deleteBackwardEvent: function () {
			this._textFieldEventSelector &&
				(this._textFieldEventListener
					? this._textFieldEventSelector.call(
							this._textFieldEventListener,
							this,
							ccui.TextField.EVENT_DELETE_BACKWARD
					  )
					: this._textFieldEventSelector(
							this,
							ccui.TextField.EVENT_DELETE_BACKWARD
					  )),
				this._ccEventCallback &&
					this._ccEventCallback(
						this,
						ccui.TextField.EVENT_DELETE_BACKWARD
					);
		},
		addEventListenerTextField: function (t, e) {
			this.addEventListener(t, e);
		},
		addEventListener: function (t, e) {
			(this._textFieldEventSelector = t),
				(this._textFieldEventListener = e);
		},
		_onSizeChanged: function () {
			ccui.Widget.prototype._onSizeChanged.call(this),
				(this._textFieldRendererAdaptDirty = !0);
		},
		_adaptRenderers: function () {
			this._textFieldRendererAdaptDirty &&
				(this._textfieldRendererScaleChangedWithSize(),
				(this._textFieldRendererAdaptDirty = !1));
		},
		_textfieldRendererScaleChangedWithSize: function () {
			this._ignoreSize ||
				this._textFieldRenderer.setDimensions(this._contentSize),
				this._textFieldRenderer.setPosition(
					this._contentSize.width / 2,
					this._contentSize.height / 2
				);
		},
		getAutoRenderSize: function () {
			var t = this._textFieldRenderer.getContentSize();
			return (
				this._ignoreSize ||
					(this._textFieldRenderer.setDimensions(0, 0),
					(t = this._textFieldRenderer.getContentSize()),
					this._textFieldRenderer.setDimensions(
						this._contentSize.width,
						this._contentSize.height
					)),
				t
			);
		},
		getVirtualRendererSize: function () {
			return this._textFieldRenderer.getContentSize();
		},
		getVirtualRenderer: function () {
			return this._textFieldRenderer;
		},
		getDescription: function () {
			return 'TextField';
		},
		attachWithIME: function () {
			this._textFieldRenderer.attachWithIME();
		},
		_createCloneInstance: function () {
			return new ccui.TextField();
		},
		_copySpecialProperties: function (t) {
			this.setString(t._textFieldRenderer.getString()),
				this.setPlaceHolder(t.getString()),
				this.setFontSize(t._textFieldRenderer.getFontSize()),
				this.setFontName(t._textFieldRenderer.getFontName()),
				this.setMaxLengthEnabled(t.isMaxLengthEnabled()),
				this.setMaxLength(t.getMaxLength()),
				this.setPasswordEnabled(t.isPasswordEnabled()),
				this.setPasswordStyleText(t._passwordStyleText),
				this.setAttachWithIME(t.getAttachWithIME()),
				this.setDetachWithIME(t.getDetachWithIME()),
				this.setInsertText(t.getInsertText()),
				this.setDeleteBackward(t.getDeleteBackward()),
				(this._ccEventCallback = t._ccEventCallback),
				(this._textFieldEventListener = t._textFieldEventListener),
				(this._textFieldEventSelector = t._textFieldEventSelector);
		},
		setTextAreaSize: function (t) {
			this.setContentSize(t);
		},
		setTextHorizontalAlignment: function (t) {
			this._textFieldRenderer.setHorizontalAlignment(t);
		},
		setTextVerticalAlignment: function (t) {
			this._textFieldRenderer.setVerticalAlignment(t);
		},
		_setFont: function (t) {
			this._textFieldRenderer._setFont(t),
				(this._textFieldRendererAdaptDirty = !0);
		},
		_getFont: function () {
			return this._textFieldRenderer._getFont();
		},
		_changePosition: function () {
			this._adaptRenderers();
		},
	})),
	(ccui.TextField.create = function (t, e, i) {
		return new ccui.TextField(t, e, i);
	});
var _p = ccui.TextField.prototype;
_p.string,
	cc.defineGetterSetter(_p, 'string', _p.getString, _p.setString),
	_p.placeHolder,
	cc.defineGetterSetter(
		_p,
		'placeHolder',
		_p.getPlaceHolder,
		_p.setPlaceHolder
	),
	_p.font,
	cc.defineGetterSetter(_p, 'font', _p._getFont, _p._setFont),
	_p.fontSize,
	cc.defineGetterSetter(_p, 'fontSize', _p.getFontSize, _p.setFontSize),
	_p.fontName,
	cc.defineGetterSetter(_p, 'fontName', _p.getFontName, _p.setFontName),
	_p.maxLengthEnabled,
	cc.defineGetterSetter(
		_p,
		'maxLengthEnabled',
		_p.isMaxLengthEnabled,
		_p.setMaxLengthEnabled
	),
	_p.maxLength,
	cc.defineGetterSetter(_p, 'maxLength', _p.getMaxLength, _p.setMaxLength),
	_p.passwordEnabled,
	cc.defineGetterSetter(
		_p,
		'passwordEnabled',
		_p.isPasswordEnabled,
		_p.setPasswordEnabled
	),
	(_p = null),
	(ccui.TextField.EVENT_ATTACH_WITH_IME = 0),
	(ccui.TextField.EVENT_DETACH_WITH_IME = 1),
	(ccui.TextField.EVENT_INSERT_TEXT = 2),
	(ccui.TextField.EVENT_DELETE_BACKWARD = 3),
	(ccui.TextField.RENDERER_ZORDER = -1),
	(ccui.RichElement = ccui.Class.extend({
		_type: 0,
		_tag: 0,
		_color: null,
		_opacity: 0,
		ctor: function (t, e, i) {
			(this._type = 0),
				(this._tag = t || 0),
				(this._color = cc.color(255, 255, 255, 255)),
				e &&
					((this._color.r = e.r),
					(this._color.g = e.g),
					(this._color.b = e.b)),
				(this._opacity = i || 0),
				(this._color.a = void 0 === i ? e.a : i);
		},
	})),
	(ccui.RichElementText = ccui.RichElement.extend({
		_text: '',
		_fontName: '',
		_fontSize: 0,
		_fontDefinition: null,
		ctor: function (t, e, i, n, r, o) {
			var s = e;
			e &&
				e instanceof cc.FontDefinition &&
				((s = e.fillStyle),
				(r = e.fontName),
				(o = e.fontSize),
				(this._fontDefinition = e)),
				ccui.RichElement.prototype.ctor.call(this, t, s, i),
				(this._type = ccui.RichElement.TEXT),
				(this._text = n),
				(this._fontName = r),
				(this._fontSize = o);
		},
	})),
	(ccui.RichElementText.create = function (t, e, i, n, r, o) {
		return new ccui.RichElementText(t, e, i, n, r, o);
	}),
	(ccui.RichElementImage = ccui.RichElement.extend({
		_filePath: '',
		_textureRect: null,
		_textureType: 0,
		ctor: function (t, e, i, n) {
			ccui.RichElement.prototype.ctor.call(this, t, e, i),
				(this._type = ccui.RichElement.IMAGE),
				(this._filePath = n || ''),
				(this._textureRect = cc.rect(0, 0, 0, 0)),
				(this._textureType = 0);
		},
	})),
	(ccui.RichElementImage.create = function (t, e, i, n) {
		return new ccui.RichElementImage(t, e, i, n);
	}),
	(ccui.RichElementCustomNode = ccui.RichElement.extend({
		_customNode: null,
		ctor: function (t, e, i, n) {
			ccui.RichElement.prototype.ctor.call(this, t, e, i),
				(this._type = ccui.RichElement.CUSTOM),
				(this._customNode = n || null);
		},
	})),
	(ccui.RichElementCustomNode.create = function (t, e, i, n) {
		return new ccui.RichElementCustomNode(t, e, i, n);
	}),
	(ccui.RichText = ccui.Widget.extend({
		_formatTextDirty: !1,
		_richElements: null,
		_elementRenders: null,
		_leftSpaceWidth: 0,
		_verticalSpace: 0,
		_elementRenderersContainer: null,
		_lineBreakOnSpace: !1,
		_textHorizontalAlignment: null,
		_textVerticalAlignment: null,
		ctor: function () {
			ccui.Widget.prototype.ctor.call(this),
				(this._formatTextDirty = !1),
				(this._richElements = []),
				(this._elementRenders = []),
				(this._leftSpaceWidth = 0),
				(this._verticalSpace = 0),
				(this._textHorizontalAlignment = cc.TEXT_ALIGNMENT_LEFT),
				(this._textVerticalAlignment = cc.VERTICAL_TEXT_ALIGNMENT_TOP);
		},
		_initRenderer: function () {
			(this._elementRenderersContainer = new cc.Node()),
				this._elementRenderersContainer.setAnchorPoint(0.5, 0.5),
				this.addProtectedChild(this._elementRenderersContainer, 0, -1);
		},
		insertElement: function (t, e) {
			this._richElements.splice(e, 0, t), (this._formatTextDirty = !0);
		},
		pushBackElement: function (t) {
			this._richElements.push(t), (this._formatTextDirty = !0);
		},
		removeElement: function (t) {
			cc.isNumber(t)
				? this._richElements.splice(t, 1)
				: cc.arrayRemoveObject(this._richElements, t),
				(this._formatTextDirty = !0);
		},
		formatText: function () {
			if (this._formatTextDirty) {
				this._elementRenderersContainer.removeAllChildren(),
					(this._elementRenders.length = 0);
				var t,
					e,
					i = this._richElements;
				if (this._ignoreSize)
					for (this._addNewLine(), t = 0; t < i.length; t++) {
						var n = null;
						switch ((e = i[t])._type) {
							case ccui.RichElement.TEXT:
								n = e._fontDefinition
									? new cc.LabelTTF(
											e._text,
											e._fontDefinition
									  )
									: new cc.LabelTTF(
											e._text,
											e._fontName,
											e._fontSize
									  );
								break;
							case ccui.RichElement.IMAGE:
								n = new cc.Sprite(e._filePath);
								break;
							case ccui.RichElement.CUSTOM:
								n = e._customNode;
						}
						n.setColor(e._color),
							n.setOpacity(e._color.a),
							this._pushToContainer(n);
					}
				else
					for (this._addNewLine(), t = 0; t < i.length; t++)
						switch ((e = i[t])._type) {
							case ccui.RichElement.TEXT:
								e._fontDefinition
									? this._handleTextRenderer(
											e._text,
											e._fontDefinition,
											e._fontDefinition.fontSize,
											e._fontDefinition.fillStyle
									  )
									: this._handleTextRenderer(
											e._text,
											e._fontName,
											e._fontSize,
											e._color
									  );
								break;
							case ccui.RichElement.IMAGE:
								this._handleImageRenderer(
									e._filePath,
									e._color,
									e._color.a
								);
								break;
							case ccui.RichElement.CUSTOM:
								this._handleCustomRenderer(e._customNode);
						}
				this.formatRenderers(), (this._formatTextDirty = !1);
			}
		},
		_handleTextRenderer: function (t, e, i, n) {
			var r, o, s, c, a, l;
			'' !== t &&
				('\n' !== t
					? ((l = (r =
							e instanceof cc.FontDefinition
								? new cc.LabelTTF(t, e)
								: new cc.LabelTTF(t, e, i)).getContentSize()
							.width),
					  (this._leftSpaceWidth -= l),
					  this._leftSpaceWidth < 0
							? ((c = -this._leftSpaceWidth / l),
							  (a = (o = t).length * (1 - c)),
							  (s = o.substr(0, a)),
							  (l = o.substr(a, o.length - 1)),
							  (t = 0 < a),
							  this._lineBreakOnSpace &&
									((a =
										-1 === (c = s.lastIndexOf(' '))
											? a
											: c + 1),
									(l = o.substr(a, o.length - 1)),
									(t = 0 < a && ' ' !== l)),
							  t &&
									((t = null),
									e instanceof cc.FontDefinition
										? (t = new cc.LabelTTF(
												s.substr(0, a),
												e
										  )).setOpacity(e.fillStyle.a)
										: ((t = new cc.LabelTTF(
												s.substr(0, a),
												e,
												i
										  )).setColor(n),
										  t.setOpacity(n.a)),
									this._pushToContainer(t)),
							  this._addNewLine(),
							  this._handleTextRenderer(l, e, i, n))
							: (e instanceof cc.FontDefinition
									? r.setOpacity(e.fillStyle.a)
									: (r.setColor(n), r.setOpacity(n.a)),
							  this._pushToContainer(r)))
					: this._addNewLine());
		},
		_handleImageRenderer: function (t, e, i) {
			t = new cc.Sprite(t);
			this._handleCustomRenderer(t);
		},
		_handleCustomRenderer: function (t) {
			var e = t.getContentSize();
			(this._leftSpaceWidth -= e.width),
				this._leftSpaceWidth < 0
					? (this._addNewLine(),
					  this._pushToContainer(t),
					  (this._leftSpaceWidth -= e.width))
					: this._pushToContainer(t);
		},
		_addNewLine: function () {
			(this._leftSpaceWidth = this._customSize.width),
				this._elementRenders.push([]);
		},
		formatRenderers: function () {
			var t,
				e,
				i,
				n = 0,
				r = this._elementRenderersContainer,
				o = this._elementRenders;
			if (this._ignoreSize) {
				for (var s = 0, c = o[0], a = 0, l = 0; l < c.length; l++) {
					(t = c[l]).setAnchorPoint(cc.p(0, 0)),
						t.setPosition(a, 0),
						r.addChild(t, 1, l),
						(e = t.getLineHeight ? t.getLineHeight() : n);
					var h = t.getContentSize();
					(s += h.width),
						(n = Math.max(Math.min(n, e), h.height)),
						(a += h.width);
				}
				if (this._textHorizontalAlignment !== cc.TEXT_ALIGNMENT_LEFT)
					for (
						i = 0,
							this._textHorizontalAlignment ===
							cc.TEXT_ALIGNMENT_RIGHT
								? (i = this._contentSize.width - a)
								: this._textHorizontalAlignment ===
										cc.TEXT_ALIGNMENT_CENTER &&
								  (i = (this._contentSize.width - a) / 2),
							l = 0;
						l < c.length;
						l++
					)
						c[l].x += i;
				r.setContentSize(s, n);
			} else {
				for (var u = [], _ = 0; _ < o.length; _++) {
					c = o[_];
					var d = 0;
					for (l = 0; l < c.length; l++)
						(e = (t = c[l]).getLineHeight
							? t.getLineHeight()
							: t.getContentSize().height),
							(d = Math.max(
								Math.min(t.getContentSize().height, e),
								d
							));
					(u[_] = d), (n += u[_]);
				}
				var p = this._customSize.height;
				for (_ = 0; _ < o.length; _++) {
					for (
						c = o[_], a = 0, p -= u[_] + this._verticalSpace, l = 0;
						l < c.length;
						l++
					)
						(t = c[l]).setAnchorPoint(cc.p(0, 0)),
							t.setPosition(cc.p(a, p)),
							r.addChild(t, 1),
							(a += t.getContentSize().width);
					if (
						this._textHorizontalAlignment !==
							cc.TEXT_ALIGNMENT_LEFT ||
						this._textVerticalAlignment !==
							cc.VERTICAL_TEXT_ALIGNMENT_TOP
					) {
						(i = 0),
							this._textHorizontalAlignment ===
							cc.TEXT_ALIGNMENT_RIGHT
								? (i = this._contentSize.width - a)
								: this._textHorizontalAlignment ===
										cc.TEXT_ALIGNMENT_CENTER &&
								  (i = (this._contentSize.width - a) / 2);
						var f = 0;
						for (
							this._textVerticalAlignment ===
							cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM
								? (f = this._customSize.height - n)
								: this._textVerticalAlignment ===
										cc.VERTICAL_TEXT_ALIGNMENT_CENTER &&
								  (f = (this._customSize.height - n) / 2),
								l = 0;
							l < c.length;
							l++
						)
							((t = c[l]).x += i), (t.y -= f);
					}
				}
				r.setContentSize(this._contentSize);
			}
			var m = o.length;
			for (_ = 0; _ < m; _++) o[_].length = 0;
			(this._elementRenders.length = 0),
				this.setContentSize(
					this._ignoreSize
						? this.getVirtualRendererSize()
						: this._customSize
				),
				this._updateContentSizeWithTextureSize(this._contentSize),
				r.setPosition(
					0.5 * this._contentSize.width,
					0.5 * this._contentSize.height
				);
		},
		_pushToContainer: function (t) {
			this._elementRenders.length <= 0 ||
				this._elementRenders[this._elementRenders.length - 1].push(t);
		},
		_adaptRenderers: function () {
			this.formatText();
		},
		setVerticalSpace: function (t) {
			this._verticalSpace = t;
		},
		setAnchorPoint: function (t) {
			ccui.Widget.prototype.setAnchorPoint.call(this, t),
				this._elementRenderersContainer.setAnchorPoint(t);
		},
		_setAnchorX: function (t) {
			ccui.Widget.prototype._setAnchorX.call(this, t),
				this._elementRenderersContainer._setAnchorX(t);
		},
		_setAnchorY: function (t) {
			ccui.Widget.prototype._setAnchorY.call(this, t),
				this._elementRenderersContainer._setAnchorY(t);
		},
		getVirtualRendererSize: function () {
			return this._elementRenderersContainer.getContentSize();
		},
		ignoreContentAdaptWithSize: function (t) {
			this._ignoreSize !== t &&
				((this._formatTextDirty = !0),
				ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this, t));
		},
		getContentSize: function () {
			return (
				this.formatText(), cc.Node.prototype.getContentSize.call(this)
			);
		},
		_getWidth: function () {
			return this.formatText(), cc.Node.prototype._getWidth.call(this);
		},
		_getHeight: function () {
			return this.formatText(), cc.Node.prototype._getHeight.call(this);
		},
		setContentSize: function (t, e) {
			var i = void 0 === e ? t.width : t,
				e = void 0 === e ? t.height : e;
			ccui.Widget.prototype.setContentSize.call(this, i, e),
				(this._formatTextDirty = !0);
		},
		getDescription: function () {
			return 'RichText';
		},
		setCascadeOpacityEnabled: function (t) {
			this._super(t),
				this._elementRenderersContainer.setCascadeOpacityEnabled(t);
		},
		setLineBreakOnSpace: function (t) {
			(this._lineBreakOnSpace = t),
				(this._formatTextDirty = !0),
				this.formatText();
		},
		setTextHorizontalAlignment: function (t) {
			t !== this._textHorizontalAlignment &&
				((this._textHorizontalAlignment = t), this.formatText());
		},
		setTextVerticalAlignment: function (t) {
			t !== this._textVerticalAlignment &&
				((this._textVerticalAlignment = t), this.formatText());
		},
	})),
	(ccui.RichText.create = function () {
		return new ccui.RichText();
	}),
	(ccui.RichElement.TEXT = 0),
	(ccui.RichElement.IMAGE = 1),
	(ccui.RichElement.CUSTOM = 2),
	(ccui.ScrollViewBar = ccui.ProtectedNode.extend({
		_parentScroll: null,
		_direction: null,
		_upperHalfCircle: null,
		_lowerHalfCircle: null,
		_body: null,
		_opacity: 255,
		_marginFromBoundary: 0,
		_marginForLength: 0,
		_touching: !1,
		_autoHideEnabled: !0,
		autoHideTime: 0,
		_autoHideRemainingTime: 0,
		_className: 'ScrollViewBar',
		ctor: function (t, e) {
			cc.ProtectedNode.prototype.ctor.call(this),
				(this._direction = e),
				(this._parentScroll = t),
				(this._marginFromBoundary = ccui.ScrollViewBar.DEFAULT_MARGIN),
				(this._marginForLength = ccui.ScrollViewBar.DEFAULT_MARGIN),
				(this.opacity =
					255 * ccui.ScrollViewBar.DEFAULT_SCROLLBAR_OPACITY),
				(this.autoHideTime = ccui.ScrollViewBar.DEFAULT_AUTO_HIDE_TIME),
				(this._autoHideEnabled = !0),
				ccui.ScrollViewBar.prototype.init.call(this),
				this.setCascadeColorEnabled(!0),
				this.setCascadeOpacityEnabled(!0);
		},
		init: function () {
			(this._upperHalfCircle = ccui.helper._createSpriteFromBase64(
				ccui.ScrollViewBar.HALF_CIRCLE_IMAGE,
				ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY
			)),
				this._upperHalfCircle.setAnchorPoint(cc.p(0.5, 0)),
				(this._lowerHalfCircle = ccui.helper._createSpriteFromBase64(
					ccui.ScrollViewBar.HALF_CIRCLE_IMAGE,
					ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY
				)),
				this._lowerHalfCircle.setAnchorPoint(cc.p(0.5, 0)),
				this._lowerHalfCircle.setScaleY(-1),
				this.addProtectedChild(this._upperHalfCircle),
				this.addProtectedChild(this._lowerHalfCircle),
				(this._body = ccui.helper._createSpriteFromBase64(
					ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT,
					ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT_KEY
				)),
				this._body.setAnchorPoint(cc.p(0.5, 0)),
				this.addProtectedChild(this._body),
				this.setColor(ccui.ScrollViewBar.DEFAULT_COLOR),
				this.onScrolled(cc.p(0, 0)),
				cc.ProtectedNode.prototype.setOpacity.call(this, 0),
				(this._autoHideRemainingTime = 0),
				this._direction === ccui.ScrollView.DIR_HORIZONTAL &&
					this.setRotation(90);
		},
		setPositionFromCorner: function (t) {
			this._direction === ccui.ScrollView.DIR_VERTICAL
				? ((this._marginForLength = t.y),
				  (this._marginFromBoundary = t.x))
				: ((this._marginForLength = t.x),
				  (this._marginFromBoundary = t.y));
		},
		onEnter: function () {
			cc.ProtectedNode.prototype.onEnter.call(this),
				this.scheduleUpdate();
		},
		getPositionFromCorner: function () {
			return this._direction === ccui.ScrollView.DIR_VERTICAL
				? cc.p(this._marginFromBoundary, this._marginForLength)
				: cc.p(this._marginForLength, this._marginFromBoundary);
		},
		setWidth: function (t) {
			t /= this._body.width;
			this._body.setScaleX(t),
				this._upperHalfCircle.setScale(t),
				this._lowerHalfCircle.setScale(-t);
		},
		getWidth: function () {
			return this._body.getBoundingBox().width;
		},
		setAutoHideEnabled: function (t) {
			(this._autoHideEnabled = t),
				!this._autoHideEnabled &&
				!this._touching &&
				this._autoHideRemainingTime <= 0
					? cc.ProtectedNode.prototype.setOpacity.call(
							this,
							this.opacity
					  )
					: cc.ProtectedNode.prototype.setOpacity.call(this, 0);
		},
		isAutoHideEnabled: function () {
			return this._autoHideEnabled;
		},
		setOpacity: function (t) {
			this._opacity = t;
		},
		getOpacity: function () {
			return this._opacity;
		},
		_updateLength: function (t) {
			var e = t / this._body.getTextureRect().height;
			this._body.setScaleY(e),
				this._upperHalfCircle.setPositionY(
					this._body.getPositionY() + t
				);
		},
		_processAutoHide: function (t) {
			!this._autoHideEnabled ||
				this._autoHideRemainingTime <= 0 ||
				this._touching ||
				((this._autoHideRemainingTime -= t),
				this._autoHideRemainingTime <= this.autoHideTime &&
					((this._autoHideRemainingTime = Math.max(
						0,
						this._autoHideRemainingTime
					)),
					cc.ProtectedNode.prototype.setOpacity.call(
						this,
						this._opacity *
							(this._autoHideRemainingTime / this.autoHideTime)
					)));
		},
		update: function (t) {
			this._processAutoHide(t);
		},
		onTouchBegan: function () {
			this._autoHideEnabled && (this._touching = !0);
		},
		onTouchEnded: function () {
			this._autoHideEnabled &&
				((this._touching = !1),
				this._autoHideRemainingTime <= 0 ||
					(this._autoHideRemainingTime = this.autoHideTime));
		},
		onScrolled: function (t) {
			this._autoHideEnabled &&
				((this._autoHideRemainingTime = this.autoHideTime),
				cc.ProtectedNode.prototype.setOpacity.call(this, this.opacity));
			var e = this._parentScroll.getInnerContainer(),
				i = 0,
				n = 0,
				r = 0,
				o = 0;
			this._direction === ccui.ScrollView.DIR_VERTICAL
				? ((i = e.height),
				  (n = this._parentScroll.height),
				  (r = t.y),
				  (o = -e.getPositionY()))
				: this._direction === ccui.ScrollView.DIR_HORIZONTAL &&
				  ((i = e.width),
				  (n = this._parentScroll.width),
				  (r = t.x),
				  (o = -e.getPositionX()));
			(e = this._calculateLength(i, n, r)),
				(r = this._calculatePosition(i, n, o, r, e));
			this._updateLength(e), this.setPosition(r);
		},
		_calculateLength: function (t, e, i) {
			0 !== i && (t += 20 * (0 < i ? i : -i));
			t = e / t;
			return Math.abs(e - 2 * this._marginForLength) * t;
		},
		_calculatePosition: function (t, e, i, n, r) {
			t -= e;
			0 !== n && (t += Math.abs(n));
			n = 0;
			0 !== t &&
				((n = i / t), (n = Math.max(n, 0)), (n = Math.min(n, 1)));
			n = (e - r - 2 * this._marginForLength) * n + this._marginForLength;
			return this._direction === ccui.ScrollView.DIR_VERTICAL
				? cc.p(this._parentScroll.width - this._marginFromBoundary, n)
				: cc.p(n, this._marginFromBoundary);
		},
	}));
var _p = ccui.ScrollViewBar.prototype;
_p.opacity,
	cc.defineGetterSetter(_p, 'opacity', _p.getOpacity, _p.setOpacity),
	_p.autoHideEnabled,
	cc.defineGetterSetter(
		_p,
		'autoHideEnabled',
		_p.isAutoHideEnabled,
		_p.setAutoHideEnabled
	),
	(ccui.ScrollViewBar.DEFAULT_COLOR = cc.color(52, 65, 87)),
	(ccui.ScrollViewBar.DEFAULT_MARGIN = 20),
	(ccui.ScrollViewBar.DEFAULT_AUTO_HIDE_TIME = 0.2),
	(ccui.ScrollViewBar.DEFAULT_SCROLLBAR_OPACITY = 0.4),
	(ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY = '/__half_circle_image'),
	(ccui.ScrollViewBar.HALF_CIRCLE_IMAGE =
		'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAGCAMAAADAMI+zAAAAJ1BMVEX///////////////////////////////////////////////////9Ruv0SAAAADHRSTlMABgcbbW7Hz9Dz+PmlcJP5AAAAMElEQVR4AUXHwQ2AQAhFwYcLH1H6r1djzDK3ASxUpTBeK/uTCyz7dx54b44m4p5cD1MwAooEJyk3AAAAAElFTkSuQmCC'),
	(ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT_KEY = '/__body_image_height'),
	(ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT =
		'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAABCAMAAADdNb8LAAAAA1BMVEX///+nxBvIAAAACklEQVR4AWNABgAADQABYc2cpAAAAABJRU5ErkJggg=='),
	(ccui.ScrollView = ccui.Layout.extend({
		_innerContainer: null,
		_direction: null,
		_topBoundary: 0,
		_bottomBoundary: 0,
		_leftBoundary: 0,
		_rightBoundary: 0,
		_touchMoveDisplacements: null,
		_touchMoveTimeDeltas: null,
		_touchMovePreviousTimestamp: 0,
		_touchTotalTimeThreshold: 0.5,
		_autoScrolling: !1,
		_autoScrollTargetDelta: null,
		_autoScrollAttenuate: !0,
		_autoScrollStartPosition: null,
		_autoScrollTotalTime: 0,
		_autoScrollAccumulatedTime: 0,
		_autoScrollCurrentlyOutOfBoundary: !1,
		_autoScrollBraking: !1,
		_autoScrollBrakingStartPosition: null,
		_bePressed: !1,
		_childFocusCancelOffset: 0,
		bounceEnabled: !1,
		_outOfBoundaryAmount: null,
		_outOfBoundaryAmountDirty: !0,
		inertiaScrollEnabled: !1,
		_scrollBarEnabled: !0,
		_verticalScrollBar: null,
		_horizontalScrollBar: null,
		_scrollViewEventListener: null,
		_scrollViewEventSelector: null,
		_className: 'ScrollView',
		ctor: function () {
			ccui.Layout.prototype.ctor.call(this),
				this.setClippingEnabled(!0),
				this._innerContainer.setTouchEnabled(!1),
				(this._direction = ccui.ScrollView.DIR_NONE),
				(this._childFocusCancelOffset = 5),
				(this.inertiaScrollEnabled = !0),
				(this._outOfBoundaryAmount = cc.p(0, 0)),
				(this._autoScrollTargetDelta = cc.p(0, 0)),
				(this._autoScrollStartPosition = cc.p(0, 0)),
				(this._autoScrollBrakingStartPosition = cc.p(0, 0)),
				(this._touchMoveDisplacements = []),
				(this._touchMoveTimeDeltas = []),
				(this._touchMovePreviousTimestamp = 0),
				(this._scrollBarEnabled = !0),
				this._initScrollBar(),
				this.setTouchEnabled(!0);
		},
		onEnter: function () {
			ccui.Layout.prototype.onEnter.call(this), this.scheduleUpdate();
		},
		onExit: function () {
			cc.renderer._removeCache(this.__instanceId),
				ccui.Layout.prototype.onExit.call(this);
		},
		visit: function (t) {
			var e = this._renderCmd,
				i = t ? t._renderCmd : null;
			if (this._visible) {
				this._adaptRenderers(), this._doLayout();
				var n = cc.renderer;
				e.visit(i),
					n.pushRenderCommand(e),
					e instanceof ccui.ScrollView.WebGLRenderCmd &&
						((r = this.__instanceId), n._turnToCacheMode(r));
				var t =
						this._clippingEnabled &&
						this._clippingType === ccui.Layout.CLIPPING_STENCIL,
					r =
						this._clippingEnabled &&
						this._clippingType === ccui.Layout.CLIPPING_SCISSOR;
				t ? e.stencilClippingVisit(i) : r && e.scissorClippingVisit(i);
				var o,
					s,
					c,
					a,
					l = this._children,
					h = l.length,
					u = this._protectedChildren,
					_ = u.length;
				for (
					this._reorderChildDirty && this.sortAllChildren(),
						this._reorderProtectedChildDirty &&
							this.sortAllProtectedChildren(),
						o = 0;
					o < h;
					o++
				)
					(s = l[o]) && s._visible && s.visit(this);
				for (c = 0; c < _; c++)
					(a = u[c]) &&
						a._visible &&
						(e._changeProtectedChild(a), a.visit(this));
				t ? e.postStencilVisit() : r && e.postScissorVisit(),
					e instanceof ccui.ScrollView.WebGLRenderCmd &&
						n._turnToNormalMode(),
					this.updateChildren(),
					(e._dirtyFlag = 0);
			} else e._propagateFlagsDown(i);
		},
		findNextFocusedWidget: function (t, e) {
			return this.getLayoutType() === ccui.Layout.LINEAR_VERTICAL ||
				this.getLayoutType() === ccui.Layout.LINEAR_HORIZONTAL
				? this._innerContainer.findNextFocusedWidget(t, e)
				: ccui.Widget.prototype.findNextFocusedWidget.call(this, t, e);
		},
		_initRenderer: function () {
			ccui.Layout.prototype._initRenderer.call(this),
				(this._innerContainer = new ccui.Layout()),
				this._innerContainer.setColor(cc.color(255, 255, 255)),
				this._innerContainer.setOpacity(255),
				this._innerContainer.setCascadeColorEnabled(!0),
				this._innerContainer.setCascadeOpacityEnabled(!0),
				this.addProtectedChild(this._innerContainer, 1, 1);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? ccui.ScrollView.WebGLRenderCmd
					: ccui.ScrollView.CanvasRenderCmd
			)(this);
		},
		_onSizeChanged: function () {
			ccui.Layout.prototype._onSizeChanged.call(this);
			var t = this._contentSize;
			(this._topBoundary = t.height), (this._rightBoundary = t.width);
			var e = this._innerContainer.getContentSize();
			this._innerContainer.setContentSize(
				cc.size(
					Math.max(e.width, t.width),
					Math.max(e.height, t.height)
				)
			),
				this._innerContainer.setPosition(
					0,
					t.height - this._innerContainer.getContentSize().height
				),
				this._verticalScrollBar &&
					this._verticalScrollBar.onScrolled(
						this._getHowMuchOutOfBoundary()
					),
				this._horizontalScrollBar &&
					this._horizontalScrollBar.onScrolled(
						this._getHowMuchOutOfBoundary()
					);
		},
		setInnerContainerSize: function (t) {
			var e = this._innerContainer,
				i = this._contentSize,
				n = i.width,
				r = i.height;
			t.width < i.width
				? cc.log(
						'Inner width <= ScrollView width, it will be force sized!'
				  )
				: (n = t.width),
				t.height < i.height
					? cc.log(
							'Inner height <= ScrollView height, it will be force sized!'
					  )
					: (r = t.height),
				e.setContentSize(cc.size(n, r));
			(t = this._innerContainer.getPosition()),
				(e = this._innerContainer.getAnchorPoint());
			0 != this._innerContainer.getLeftBoundary() && (t.x = e.x * n),
				this._innerContainer.getTopBoundary() !=
					this._contentSize.height &&
					(t.y = this._contentSize.height - (1 - e.y) * r),
				this.setInnerContainerPosition(t),
				this._updateScrollBar(cc.p(0, 0));
		},
		_setInnerWidth: function (t) {
			var e,
				i = this._contentSize.width,
				n = i,
				r = this._innerContainer,
				o = r.width;
			switch (
				(t < i
					? cc.log(
							'Inner width <= scrollview width, it will be force sized!'
					  )
					: (n = t),
				(r.width = n),
				this._direction)
			) {
				case ccui.ScrollView.DIR_HORIZONTAL:
				case ccui.ScrollView.DIR_BOTH:
					r.getRightBoundary() <= i &&
						((e = o - r.width), this._scrollChildren(e, 0));
			}
			t = r.anchorX;
			0 < r.getLeftBoundary() && (r.x = t * n),
				r.getRightBoundary() < i && (r.x = i - (1 - t) * n);
		},
		_setInnerHeight: function (t) {
			var e = this._contentSize.height,
				i = e,
				n = this._innerContainer,
				r = n.height;
			switch (
				(t < e
					? cc.log(
							'Inner height <= scrollview height, it will be force sized!'
					  )
					: (i = t),
				(n.height = i),
				this._direction)
			) {
				case ccui.ScrollView.DIR_VERTICAL:
				case ccui.ScrollView.DIR_BOTH:
					var o = r - i;
					this._scrollChildren(0, o);
			}
			t = n.anchorY;
			0 < n.getLeftBoundary() && (n.y = t * i),
				n.getRightBoundary() < e && (n.y = e - (1 - t) * i);
		},
		setInnerContainerPosition: function (t) {
			if (
				t.x !== this._innerContainer.getPositionX() ||
				t.y !== this._innerContainer.getPositionY()
			) {
				if (
					(this._innerContainer.setPosition(t),
					(this._outOfBoundaryAmountDirty = !0),
					this.bounceEnabled)
				)
					for (
						var e = ccui.ScrollView.MOVEDIR_TOP;
						e < ccui.ScrollView.MOVEDIR_RIGHT;
						++e
					)
						this._isOutOfBoundary(e) &&
							this._processScrollEvent(e, !0);
				this._dispatchEvent(ccui.ScrollView.EVENT_CONTAINER_MOVED);
			}
		},
		getInnerContainerPosition: function () {
			return this._innerContainer.getPosition();
		},
		getInnerContainerSize: function () {
			return this._innerContainer.getContentSize();
		},
		_getInnerWidth: function () {
			return this._innerContainer.width;
		},
		_getInnerHeight: function () {
			return this._innerContainer.height;
		},
		_isInContainer: function (t) {
			if (!this._clippingEnabled) return !0;
			var e,
				i = t._position,
				n = t._contentSize,
				r = t._anchorPoint,
				o = this._customSize,
				s = this._innerContainer._position,
				t = 0;
			return !(
				(e = i.y - r.y * n.height) >= o.height - s.y ||
				e + n.height <= -s.y ||
				(t = i.x - r.x * n.width) >= o.width - s.x ||
				t + n.width <= -s.x
			);
		},
		updateChildren: function () {
			for (
				var t, e = this._innerContainer._children, i = 0, n = e.length;
				i < n;
				i++
			)
				!0 === (t = e[i])._inViewRect && !1 === this._isInContainer(t)
					? (t._inViewRect = !1)
					: !1 === t._inViewRect &&
					  !0 === this._isInContainer(t) &&
					  (t._inViewRect = !0);
		},
		addChild: function (t, e, i) {
			return (
				!!t &&
				(!1 === this._isInContainer(t) && (t._inViewRect = !1),
				(e = e || t.getLocalZOrder()),
				(i = i || t.getTag()),
				this._innerContainer.addChild(t, e, i))
			);
		},
		removeAllChildren: function () {
			this.removeAllChildrenWithCleanup(!0);
		},
		removeAllChildrenWithCleanup: function (t) {
			this._innerContainer.removeAllChildrenWithCleanup(t);
		},
		removeChild: function (t, e) {
			return this._innerContainer.removeChild(t, e);
		},
		getChildren: function () {
			return this._innerContainer.getChildren();
		},
		getChildrenCount: function () {
			return this._innerContainer.getChildrenCount();
		},
		getChildByTag: function (t) {
			return this._innerContainer.getChildByTag(t);
		},
		getChildByName: function (t) {
			return this._innerContainer.getChildByName(t);
		},
		_flattenVectorByDirection: function (t) {
			var e = cc.p(0, 0);
			return (
				(e.x =
					this._direction === ccui.ScrollView.DIR_VERTICAL ? 0 : t.x),
				(e.y =
					this._direction === ccui.ScrollView.DIR_HORIZONTAL
						? 0
						: t.y),
				e
			);
		},
		_getHowMuchOutOfBoundary: function (t) {
			if (
				(void 0 === t && (t = cc.p(0, 0)),
				0 === t.x && 0 === t.y && !this._outOfBoundaryAmountDirty)
			)
				return this._outOfBoundaryAmount;
			var e = cc.p(0, 0);
			return (
				this._innerContainer.getLeftBoundary() + t.x >
				this._leftBoundary
					? (e.x =
							this._leftBoundary -
							(this._innerContainer.getLeftBoundary() + t.x))
					: this._innerContainer.getRightBoundary() + t.x <
							this._rightBoundary &&
					  (e.x =
							this._rightBoundary -
							(this._innerContainer.getRightBoundary() + t.x)),
				this._innerContainer.getTopBoundary() + t.y < this._topBoundary
					? (e.y =
							this._topBoundary -
							(this._innerContainer.getTopBoundary() + t.y))
					: this._innerContainer.getBottomBoundary() + t.y >
							this._bottomBoundary &&
					  (e.y =
							this._bottomBoundary -
							(this._innerContainer.getBottomBoundary() + t.y)),
				0 === t.x &&
					0 === t.y &&
					((this._outOfBoundaryAmount = e),
					(this._outOfBoundaryAmountDirty = !1)),
				e
			);
		},
		_isOutOfBoundary: function (t) {
			var e = this._getHowMuchOutOfBoundary();
			if (void 0 === t) return !this._fltEqualZero(e);
			switch (t) {
				case ccui.ScrollView.MOVEDIR_TOP:
					return 0 < e.y;
				case ccui.ScrollView.MOVEDIR_BOTTOM:
					return e.y < 0;
				case ccui.ScrollView.MOVEDIR_LEFT:
					return e.x < 0;
				case ccui.ScrollView.MOVEDIR_RIGHT:
					return 0 < e.x;
			}
			return !1;
		},
		_moveInnerContainer: function (t, e) {
			t = this._flattenVectorByDirection(t);
			this.setInnerContainerPosition(
				cc.pAdd(this.getInnerContainerPosition(), t)
			);
			t = this._getHowMuchOutOfBoundary();
			this._updateScrollBar(t),
				this.bounceEnabled && e && this._startBounceBackIfNeeded();
		},
		_updateScrollBar: function (t) {
			this._verticalScrollBar && this._verticalScrollBar.onScrolled(t),
				this._horizontalScrollBar &&
					this._horizontalScrollBar.onScrolled(t);
		},
		_calculateTouchMoveVelocity: function () {
			for (var t = 0, e = 0; e < this._touchMoveTimeDeltas.length; ++e)
				t += this._touchMoveTimeDeltas[e];
			if (0 == t || t >= this._touchTotalTimeThreshold) return cc.p(0, 0);
			for (
				var i = cc.p(0, 0), e = 0;
				e < this._touchMoveDisplacements.length;
				++e
			)
				(i.x += this._touchMoveDisplacements[e].x),
					(i.y += this._touchMoveDisplacements[e].y);
			return cc.pMult(i, 1 / t);
		},
		setTouchTotalTimeThreshold: function (t) {
			this._touchTotalTimeThreshold = t;
		},
		getTouchTotalTimeThreshold: function () {
			return this._touchTotalTimeThreshold;
		},
		_startInertiaScroll: function (t) {
			var e = cc.pMult(t, 0.7);
			this._startAttenuatingAutoScroll(e, t);
		},
		_startBounceBackIfNeeded: function () {
			if (!this.bounceEnabled) return !1;
			var t = this._getHowMuchOutOfBoundary();
			if (this._fltEqualZero(t)) return !1;
			return this._startAutoScroll(t, 1, !0), !0;
		},
		_startAutoScrollToDestination: function (t, e, i) {
			this._startAutoScroll(
				cc.pSub(t, this._innerContainer.getPosition()),
				e,
				i
			);
		},
		_calculateAutoScrollTimeByInitialSpeed: function (t) {
			return Math.sqrt(Math.sqrt(t / 5));
		},
		_startAttenuatingAutoScroll: function (t, e) {
			e = this._calculateAutoScrollTimeByInitialSpeed(cc.pLength(e));
			this._startAutoScroll(t, e, !0);
		},
		_startAutoScroll: function (t, e, i) {
			t = this._flattenVectorByDirection(t);
			(this._autoScrolling = !0),
				(this._autoScrollTargetDelta = t),
				(this._autoScrollAttenuate = i),
				(this._autoScrollStartPosition =
					this._innerContainer.getPosition()),
				(this._autoScrollTotalTime = e),
				(this._autoScrollAccumulatedTime = 0),
				(this._autoScrollBraking = !1),
				(this._autoScrollBrakingStartPosition = cc.p(0, 0));
			e = this._getHowMuchOutOfBoundary();
			this._fltEqualZero(e) ||
				((this._autoScrollCurrentlyOutOfBoundary = !0),
				(t = this._getHowMuchOutOfBoundary(t)),
				(0 < e.x * t.x || 0 < e.y * t.y) &&
					(this._autoScrollBraking = !0));
		},
		stopAutoScroll: function () {
			(this._autoScrolling = !1),
				(this._autoScrollAttenuate = !0),
				(this._autoScrollTotalTime = 0),
				(this._autoScrollAccumulatedTime = 0);
		},
		_isNecessaryAutoScrollBrake: function () {
			if (this._autoScrollBraking) return !0;
			if (this._isOutOfBoundary()) {
				if (!this._autoScrollCurrentlyOutOfBoundary)
					return (
						(this._autoScrollCurrentlyOutOfBoundary = !0),
						(this._autoScrollBraking = !0),
						(this._autoScrollBrakingStartPosition =
							this.getInnerContainerPosition()),
						!0
					);
			} else this._autoScrollCurrentlyOutOfBoundary = !1;
			return !1;
		},
		_getAutoScrollStopEpsilon: function () {
			return 1e-4;
		},
		_fltEqualZero: function (t) {
			return Math.abs(t.x) <= 1e-4 && Math.abs(t.y) <= 1e-4;
		},
		_processAutoScrolling: function (t) {
			var e = this._isNecessaryAutoScrollBrake() ? 0.05 : 1;
			this._autoScrollAccumulatedTime += t * (1 / e);
			var i = Math.min(
				1,
				this._autoScrollAccumulatedTime / this._autoScrollTotalTime
			);
			this._autoScrollAttenuate && (i = --i * i * i * i * i + 1);
			(t = cc.pAdd(
				this._autoScrollStartPosition,
				cc.pMult(this._autoScrollTargetDelta, i)
			)),
				(i = Math.abs(i - 1) <= this._getAutoScrollStopEpsilon());
			this.bounceEnabled
				? (t = cc.pAdd(
						this._autoScrollBrakingStartPosition,
						cc.pMult(
							cc.pSub(t, this._autoScrollBrakingStartPosition),
							e
						)
				  ))
				: ((e = cc.pSub(t, this.getInnerContainerPosition())),
				  (e = this._getHowMuchOutOfBoundary(e)),
				  this._fltEqualZero(e) ||
						((t.x += e.x), (t.y += e.y), (i = !0))),
				i &&
					((this._autoScrolling = !1),
					this._dispatchEvent(
						ccui.ScrollView.EVENT_AUTOSCROLL_ENDED
					)),
				this._moveInnerContainer(
					cc.pSub(t, this.getInnerContainerPosition()),
					i
				);
		},
		_jumpToDestination: function (t, e) {
			void 0 === t.x && (t = cc.p(t, e)),
				(this._autoScrolling = !1),
				this._moveInnerContainer(
					cc.pSub(t, this.getInnerContainerPosition()),
					!0
				);
		},
		_scrollChildren: function (t) {
			var e = t;
			this.bounceEnabled &&
				((r = this._getHowMuchOutOfBoundary()),
				(e.x *= 0 == r.x ? 1 : 0.5),
				(e.y *= 0 == r.y ? 1 : 0.5)),
				this.bounceEnabled ||
					((r = this._getHowMuchOutOfBoundary(e)),
					(e.x += r.x),
					(e.y += r.y));
			var i = !1,
				n = !1,
				t = !1,
				r = !1;
			0 < e.y
				? this._innerContainer.getBottomBoundary() + e.y >=
						this._bottomBoundary && (r = !0)
				: e.y < 0 &&
				  this._innerContainer.getTopBoundary() + e.y <=
						this._topBoundary &&
				  (t = !0),
				e.x < 0
					? this._innerContainer.getRightBoundary() + e.x <=
							this._rightBoundary && (n = !0)
					: 0 < e.x &&
					  this._innerContainer.getLeftBoundary() + e.x >=
							this._leftBoundary &&
					  (i = !0),
				this._moveInnerContainer(e, !1),
				(0 == e.x && 0 == e.y) || this._processScrollingEvent(),
				r &&
					this._processScrollEvent(
						ccui.ScrollView.MOVEDIR_BOTTOM,
						!1
					),
				t && this._processScrollEvent(ccui.ScrollView.MOVEDIR_TOP, !1),
				i && this._processScrollEvent(ccui.ScrollView.MOVEDIR_LEFT, !1),
				n &&
					this._processScrollEvent(ccui.ScrollView.MOVEDIR_RIGHT, !1);
		},
		scrollToBottom: function (t, e) {
			this._startAutoScrollToDestination(
				cc.p(this._innerContainer.getPositionX(), 0),
				t,
				e
			);
		},
		scrollToTop: function (t, e) {
			this._startAutoScrollToDestination(
				cc.p(
					this._innerContainer.getPositionX(),
					this._contentSize.height -
						this._innerContainer.getContentSize().height
				),
				t,
				e
			);
		},
		scrollToLeft: function (t, e) {
			this._startAutoScrollToDestination(
				cc.p(0, this._innerContainer.getPositionY()),
				t,
				e
			);
		},
		scrollToRight: function (t, e) {
			this._startAutoScrollToDestination(
				cc.p(
					this._contentSize.width -
						this._innerContainer.getContentSize().width,
					this._innerContainer.getPositionY()
				),
				t,
				e
			);
		},
		scrollToTopLeft: function (t, e) {
			this._direction === ccui.ScrollView.DIR_BOTH
				? this._startAutoScrollToDestination(
						cc.p(
							0,
							this._contentSize.height -
								this._innerContainer.getContentSize().height
						),
						t,
						e
				  )
				: cc.log('Scroll direction is not both!');
		},
		scrollToTopRight: function (t, e) {
			var i;
			this._direction === ccui.ScrollView.DIR_BOTH
				? ((i = this._innerContainer.getContentSize()),
				  this._startAutoScrollToDestination(
						cc.p(
							this._contentSize.width - i.width,
							this._contentSize.height - i.height
						),
						t,
						e
				  ))
				: cc.log('Scroll direction is not both!');
		},
		scrollToBottomLeft: function (t, e) {
			this._direction === ccui.ScrollView.DIR_BOTH
				? this._startAutoScrollToDestination(cc.p(0, 0), t, e)
				: cc.log('Scroll direction is not both!');
		},
		scrollToBottomRight: function (t, e) {
			this._direction === ccui.ScrollView.DIR_BOTH
				? this._startAutoScrollToDestination(
						cc.p(
							this._contentSize.width -
								this._innerContainer.getContentSize().width,
							0
						),
						t,
						e
				  )
				: cc.log('Scroll direction is not both!');
		},
		scrollToPercentVertical: function (t, e, i) {
			var n =
					this._contentSize.height -
					this._innerContainer.getContentSize().height,
				r = -n;
			this._startAutoScrollToDestination(
				cc.p(this._innerContainer.getPositionX(), n + (t * r) / 100),
				e,
				i
			);
		},
		scrollToPercentHorizontal: function (t, e, i) {
			var n =
				this._innerContainer.getContentSize().width -
				this._contentSize.width;
			this._startAutoScrollToDestination(
				cc.p((-t * n) / 100, this._innerContainer.getPositionY()),
				e,
				i
			);
		},
		scrollToPercentBothDirection: function (t, e, i) {
			var n, r, o;
			this._direction === ccui.ScrollView.DIR_BOTH &&
				((r = -(n =
					this._contentSize.height -
					this._innerContainer.getContentSize().height)),
				(o =
					this._innerContainer.getContentSize().width -
					this._contentSize.width),
				this._startAutoScrollToDestination(
					cc.p((-t.x * o) / 100, n + (t.y * r) / 100),
					e,
					i
				));
		},
		jumpToBottom: function () {
			this._jumpToDestination(this._innerContainer.getPositionX(), 0);
		},
		jumpToTop: function () {
			this._jumpToDestination(
				this._innerContainer.getPositionX(),
				this._contentSize.height -
					this._innerContainer.getContentSize().height
			);
		},
		jumpToLeft: function () {
			this._jumpToDestination(0, this._innerContainer.getPositionY());
		},
		jumpToRight: function () {
			this._jumpToDestination(
				this._contentSize.width -
					this._innerContainer.getContentSize().width,
				this._innerContainer.getPositionY()
			);
		},
		jumpToTopLeft: function () {
			this._direction === ccui.ScrollView.DIR_BOTH
				? this._jumpToDestination(
						0,
						this._contentSize.height -
							this._innerContainer.getContentSize().height
				  )
				: cc.log('Scroll _direction is not both!');
		},
		jumpToTopRight: function () {
			var t;
			this._direction === ccui.ScrollView.DIR_BOTH
				? ((t = this._innerContainer.getContentSize()),
				  this._jumpToDestination(
						this._contentSize.width - t.width,
						this._contentSize.height - t.height
				  ))
				: cc.log('Scroll _direction is not both!');
		},
		jumpToBottomLeft: function () {
			this._direction === ccui.ScrollView.DIR_BOTH
				? this._jumpToDestination(0, 0)
				: cc.log('Scroll _direction is not both!');
		},
		jumpToBottomRight: function () {
			this._direction === ccui.ScrollView.DIR_BOTH
				? this._jumpToDestination(
						this._contentSize.width -
							this._innerContainer.getContentSize().width,
						0
				  )
				: cc.log('Scroll _direction is not both!');
		},
		jumpToPercentVertical: function (t) {
			var e =
					this._contentSize.height -
					this._innerContainer.getContentSize().height,
				i = -e;
			this._jumpToDestination(
				this._innerContainer.getPositionX(),
				e + (t * i) / 100
			);
		},
		jumpToPercentHorizontal: function (t) {
			var e =
				this._innerContainer.getContentSize().width -
				this._contentSize.width;
			this._jumpToDestination(
				(-t * e) / 100,
				this._innerContainer.getPositionY()
			);
		},
		jumpToPercentBothDirection: function (t) {
			var e, i, n;
			this._direction === ccui.ScrollView.DIR_BOTH &&
				((n = this._innerContainer.getContentSize()),
				(i = -(e = this._contentSize.height - n.height)),
				(n = n.width - this._contentSize.width),
				this._jumpToDestination((-t.x * n) / 100, e + (t.y * i) / 100));
		},
		_gatherTouchMove: function (t) {
			for (; 5 <= this._touchMoveDisplacements.length; )
				this._touchMoveDisplacements.splice(0, 1),
					this._touchMoveTimeDeltas.splice(0, 1);
			this._touchMoveDisplacements.push(t);
			t = new Date().getTime();
			this._touchMoveTimeDeltas.push(
				(t - this._touchMovePreviousTimestamp) / 1e3
			),
				(this._touchMovePreviousTimestamp = t);
		},
		_handlePressLogic: function (t) {
			(this._bePressed = !0),
				(this._autoScrolling = !1),
				(this._touchMovePreviousTimestamp = new Date().getTime()),
				(this._touchMoveDisplacements.length = 0),
				(this._touchMoveTimeDeltas.length = 0),
				this._verticalScrollBar &&
					this._verticalScrollBar.onTouchBegan(),
				this._horizontalScrollBar &&
					this._horizontalScrollBar.onTouchBegan();
		},
		_handleMoveLogic: function (t) {
			var e = this.convertToNodeSpace(t.getLocation()),
				t = this.convertToNodeSpace(t.getPreviousLocation()),
				t = cc.pSub(e, t);
			this._scrollChildren(t), this._gatherTouchMove(t);
		},
		_handleReleaseLogic: function (t) {
			var e = this.convertToNodeSpace(t.getLocation()),
				t = this.convertToNodeSpace(t.getPreviousLocation()),
				t = cc.pSub(e, t);
			this._gatherTouchMove(t),
				(this._bePressed = !1),
				!this._startBounceBackIfNeeded() &&
					this.inertiaScrollEnabled &&
					((0 === (t = this._calculateTouchMoveVelocity()).x &&
						0 === t.y) ||
						this._startInertiaScroll(t)),
				this._verticalScrollBar &&
					this._verticalScrollBar.onTouchEnded(),
				this._horizontalScrollBar &&
					this._horizontalScrollBar.onTouchEnded();
		},
		onTouchBegan: function (t, e) {
			e = ccui.Layout.prototype.onTouchBegan.call(this, t, e);
			return (
				this._isInterceptTouch ||
					(this._hit && this._handlePressLogic(t)),
				e
			);
		},
		onTouchMoved: function (t, e) {
			ccui.Layout.prototype.onTouchMoved.call(this, t, e),
				this._isInterceptTouch || this._handleMoveLogic(t);
		},
		onTouchEnded: function (t, e) {
			ccui.Layout.prototype.onTouchEnded.call(this, t, e),
				this._isInterceptTouch || this._handleReleaseLogic(t),
				(this._isInterceptTouch = !1);
		},
		onTouchCancelled: function (t, e) {
			ccui.Layout.prototype.onTouchCancelled.call(this, t, e),
				this._isInterceptTouch || this._handleReleaseLogic(t),
				(this._isInterceptTouch = !1);
		},
		update: function (t) {
			this._autoScrolling && this._processAutoScrolling(t);
		},
		interceptTouchEvent: function (t, e, i) {
			if (this._touchEnabled) {
				if (this._direction !== ccui.ScrollView.DIR_NONE) {
					var n = i.getLocation();
					switch (t) {
						case ccui.Widget.TOUCH_BEGAN:
							(this._isInterceptTouch = !0),
								(this._touchBeganPosition.x = n.x),
								(this._touchBeganPosition.y = n.y),
								this._handlePressLogic(i);
							break;
						case ccui.Widget.TOUCH_MOVED:
							var r = cc.pLength(
								cc.pSub(e.getTouchBeganPosition(), n)
							);
							(this._touchMovePosition.x = n.x),
								(this._touchMovePosition.y = n.y),
								r > this._childFocusCancelOffset &&
									(e.setHighlighted(!1),
									this._handleMoveLogic(i));
							break;
						case ccui.Widget.TOUCH_CANCELED:
						case ccui.Widget.TOUCH_ENDED:
							(this._touchEndPosition.x = n.x),
								(this._touchEndPosition.y = n.y),
								this._handleReleaseLogic(i),
								e.isSwallowTouches() &&
									(this._isInterceptTouch = !1);
					}
				}
			} else
				ccui.Layout.prototype.interceptTouchEvent.call(this, t, e, i);
		},
		_processScrollEvent: function (t, e) {
			var i = 0;
			switch (t) {
				case ccui.ScrollView.MOVEDIR_TOP:
					i = e
						? ccui.ScrollView.EVENT_BOUNCE_TOP
						: ccui.ScrollView.EVENT_SCROLL_TO_TOP;
					break;
				case ccui.ScrollView.MOVEDIR_BOTTOM:
					i = e
						? ccui.ScrollView.EVENT_BOUNCE_BOTTOM
						: ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM;
					break;
				case ccui.ScrollView.MOVEDIR_LEFT:
					i = e
						? ccui.ScrollView.EVENT_BOUNCE_LEFT
						: ccui.ScrollView.EVENT_SCROLL_TO_LEFT;
					break;
				case ccui.ScrollView.MOVEDIR_RIGHT:
					i = e
						? ccui.ScrollView.EVENT_BOUNCE_RIGHT
						: ccui.ScrollView.EVENT_SCROLL_TO_RIGHT;
			}
			this._dispatchEvent(i);
		},
		_processScrollingEvent: function () {
			this._dispatchEvent(ccui.ScrollView.EVENT_SCROLLING);
		},
		_dispatchEvent: function (t) {
			this._scrollViewEventSelector &&
				(this._scrollViewEventListener
					? this._scrollViewEventSelector.call(
							this._scrollViewEventListener,
							this,
							t
					  )
					: this._scrollViewEventSelector(this, t)),
				this._ccEventCallback && this._ccEventCallback(this, t);
		},
		addEventListenerScrollView: function (t, e) {
			(this._scrollViewEventSelector = t),
				(this._scrollViewEventListener = e);
		},
		addEventListener: function (t) {
			this._ccEventCallback = t;
		},
		setDirection: function (t) {
			(this._direction = t),
				this._scrollBarEnabled &&
					(this._removeScrollBar(), this._initScrollBar());
		},
		getDirection: function () {
			return this._direction;
		},
		setBounceEnabled: function (t) {
			this.bounceEnabled = t;
		},
		isBounceEnabled: function () {
			return this.bounceEnabled;
		},
		setInertiaScrollEnabled: function (t) {
			this.inertiaScrollEnabled = t;
		},
		isInertiaScrollEnabled: function () {
			return this.inertiaScrollEnabled;
		},
		setScrollBarEnabled: function (t) {
			this._scrollBarEnabled !== t &&
				(this._scrollBarEnabled && this._removeScrollBar(),
				(this._scrollBarEnabled = t),
				this._scrollBarEnabled && this._initScrollBar());
		},
		isScrollBarEnabled: function () {
			return this._scrollBarEnabled;
		},
		setScrollBarPositionFromCorner: function (t) {
			this._direction !== ccui.ScrollView.DIR_HORIZONTAL &&
				this.setScrollBarPositionFromCornerForVertical(t),
				this._direction !== ccui.ScrollView.DIR_VERTICAL &&
					this.setScrollBarPositionFromCornerForHorizontal(t);
		},
		setScrollBarPositionFromCornerForVertical: function (t) {
			cc.assert(this._scrollBarEnabled, 'Scroll bar should be enabled!'),
				cc.assert(
					this._direction !== ccui.ScrollView.DIR_HORIZONTAL,
					"Scroll view doesn't have a vertical scroll bar!"
				),
				this._verticalScrollBar.setPositionFromCorner(t);
		},
		getScrollBarPositionFromCornerForVertical: function () {
			return (
				cc.assert(
					this._scrollBarEnabled,
					'Scroll bar should be enabled!'
				),
				cc.assert(
					this._direction !== ccui.ScrollView.DIR_HORIZONTAL,
					"Scroll view doesn't have a vertical scroll bar!"
				),
				this._verticalScrollBar.getPositionFromCorner()
			);
		},
		setScrollBarPositionFromCornerForHorizontal: function (t) {
			cc.assert(this._scrollBarEnabled, 'Scroll bar should be enabled!'),
				cc.assert(
					this._direction !== ccui.ScrollView.DIR_VERTICAL,
					"Scroll view doesn't have a horizontal scroll bar!"
				),
				this._horizontalScrollBar.setPositionFromCorner(t);
		},
		getScrollBarPositionFromCornerForHorizontal: function () {
			return (
				cc.assert(
					this._scrollBarEnabled,
					'Scroll bar should be enabled!'
				),
				cc.assert(
					this._direction !== ccui.ScrollView.DIR_VERTICAL,
					"Scroll view doesn't have a horizontal scroll bar!"
				),
				this._horizontalScrollBar.getPositionFromCorner()
			);
		},
		setScrollBarWidth: function (t) {
			cc.assert(this._scrollBarEnabled, 'Scroll bar should be enabled!'),
				this._verticalScrollBar && this._verticalScrollBar.setWidth(t),
				this._horizontalScrollBar &&
					this._horizontalScrollBar.setWidth(t);
		},
		getScrollBarWidth: function () {
			return (
				cc.assert(
					this._scrollBarEnabled,
					'Scroll bar should be enabled!'
				),
				this._verticalScrollBar
					? this._verticalScrollBar.getWidth()
					: this._horizontalScrollBar
					? this._horizontalScrollBar.getWidth()
					: 0
			);
		},
		setScrollBarColor: function (t) {
			cc.assert(this._scrollBarEnabled, 'Scroll bar should be enabled!'),
				this._verticalScrollBar && this._verticalScrollBar.setColor(t),
				this._horizontalScrollBar &&
					this._horizontalScrollBar.setColor(t);
		},
		getScrollBarColor: function () {
			return (
				cc.assert(
					this._scrollBarEnabled,
					'Scroll bar should be enabled!'
				),
				this._verticalScrollBar && this._verticalScrollBar.getColor(),
				this._horizontalScrollBar &&
					this._horizontalScrollBar.getColor(),
				cc.color.WHITE
			);
		},
		setScrollBarOpacity: function (t) {
			cc.assert(this._scrollBarEnabled, 'Scroll bar should be enabled!'),
				this._verticalScrollBar &&
					(this._verticalScrollBar.opacity = t),
				this._horizontalScrollBar &&
					(this._horizontalScrollBar.opacity = t);
		},
		getScrollBarOpacity: function () {
			return (
				cc.assert(
					this._scrollBarEnabled,
					'Scroll bar should be enabled!'
				),
				this._verticalScrollBar
					? this._verticalScrollBar.opacity
					: this._horizontalScrollBar
					? this._horizontalScrollBar.opacity
					: -1
			);
		},
		setScrollBarAutoHideEnabled: function (t) {
			cc.assert(this._scrollBarEnabled, 'Scroll bar should be enabled!'),
				this._verticalScrollBar &&
					(this._verticalScrollBar.autoHideEnabled = t),
				this._horizontalScrollBar &&
					(this._horizontalScrollBar.autoHideEnabled = t);
		},
		isScrollBarAutoHideEnabled: function () {
			return (
				cc.assert(
					this._scrollBarEnabled,
					'Scroll bar should be enabled!'
				),
				this._verticalScrollBar
					? this._verticalScrollBar.autoHideEnabled
					: !!this._horizontalScrollBar &&
					  this._horizontalScrollBar.autoHideEnabled
			);
		},
		setScrollBarAutoHideTime: function (t) {
			cc.assert(this._scrollBarEnabled, 'Scroll bar should be enabled!'),
				this._verticalScrollBar &&
					(this._verticalScrollBar.autoHideTime = t),
				this._horizontalScrollBar &&
					(this._horizontalScrollBar.autoHideTime = t);
		},
		getScrollBarAutoHideTime: function () {
			return (
				cc.assert(
					this._scrollBarEnabled,
					'Scroll bar should be enabled!'
				),
				this._verticalScrollBar
					? this._verticalScrollBar.autoHideTime
					: this._horizontalScrollBar
					? this._horizontalScrollBar.autoHideTime
					: 0
			);
		},
		getInnerContainer: function () {
			return this._innerContainer;
		},
		setLayoutType: function (t) {
			this._innerContainer.setLayoutType(t);
		},
		getLayoutType: function () {
			return this._innerContainer.getLayoutType();
		},
		_doLayout: function () {
			this._doLayoutDirty && (this._doLayoutDirty = !1);
		},
		getDescription: function () {
			return 'ScrollView';
		},
		_createCloneInstance: function () {
			return new ccui.ScrollView();
		},
		_copyClonedWidgetChildren: function (t) {
			ccui.Layout.prototype._copyClonedWidgetChildren.call(this, t);
		},
		_copySpecialProperties: function (t) {
			t instanceof ccui.ScrollView &&
				(ccui.Layout.prototype._copySpecialProperties.call(this, t),
				this.setInnerContainerSize(t.getInnerContainerSize()),
				this.setInnerContainerPosition(t.getInnerContainerPosition()),
				this.setDirection(t._direction),
				(this._topBoundary = t._topBoundary),
				(this._bottomBoundary = t._bottomBoundary),
				(this._leftBoundary = t._leftBoundary),
				(this._rightBoundary = t._rightBoundary),
				(this._bePressed = t._bePressed),
				(this._childFocusCancelOffset = t._childFocusCancelOffset),
				(this._touchMoveDisplacements = t._touchMoveDisplacements),
				(this._touchMoveTimeDeltas = t._touchMoveTimeDeltas),
				(this._touchMovePreviousTimestamp =
					t._touchMovePreviousTimestamp),
				(this._autoScrolling = t._autoScrolling),
				(this._autoScrollAttenuate = t._autoScrollAttenuate),
				(this._autoScrollStartPosition = t._autoScrollStartPosition),
				(this._autoScrollTargetDelta = t._autoScrollTargetDelta),
				(this._autoScrollTotalTime = t._autoScrollTotalTime),
				(this._autoScrollAccumulatedTime =
					t._autoScrollAccumulatedTime),
				(this._autoScrollCurrentlyOutOfBoundary =
					t._autoScrollCurrentlyOutOfBoundary),
				(this._autoScrollBraking = t._autoScrollBraking),
				(this._autoScrollBrakingStartPosition =
					t._autoScrollBrakingStartPosition),
				this.setBounceEnabled(t.bounceEnabled),
				this.setInertiaScrollEnabled(t.inertiaScrollEnabled),
				(this._scrollViewEventListener = t._scrollViewEventListener),
				(this._scrollViewEventSelector = t._scrollViewEventSelector),
				(this._ccEventCallback = t._ccEventCallback),
				this.setScrollBarEnabled(t.isScrollBarEnabled()),
				this.isScrollBarEnabled() &&
					(this._direction !== ccui.ScrollView.DIR_HORIZONTAL &&
						this.setScrollBarPositionFromCornerForVertical(
							t.getScrollBarPositionFromCornerForVertical()
						),
					this._direction !== ccui.ScrollView.DIR_VERTICAL &&
						this.setScrollBarPositionFromCornerForHorizontal(
							t.getScrollBarPositionFromCornerForHorizontal()
						),
					this.setScrollBarWidth(t.getScrollBarWidth()),
					this.setScrollBarColor(t.getScrollBarColor()),
					this.setScrollBarAutoHideEnabled(
						t.isScrollBarAutoHideEnabled()
					),
					this.setScrollBarAutoHideTime(
						t.getScrollBarAutoHideTime()
					)));
		},
		_initScrollBar: function () {
			this._direction === ccui.ScrollView.DIR_HORIZONTAL ||
				this._verticalScrollBar ||
				((this._verticalScrollBar = new ccui.ScrollViewBar(
					this,
					ccui.ScrollView.DIR_VERTICAL
				)),
				this.addProtectedChild(this._verticalScrollBar, 2)),
				this._direction === ccui.ScrollView.DIR_VERTICAL ||
					this._horizontalScrollBar ||
					((this._horizontalScrollBar = new ccui.ScrollViewBar(
						this,
						ccui.ScrollView.DIR_HORIZONTAL
					)),
					this.addProtectedChild(this._horizontalScrollBar, 2));
		},
		_removeScrollBar: function () {
			this._verticalScrollBar &&
				(this.removeProtectedChild(this._verticalScrollBar),
				(this._verticalScrollBar = null)),
				this._horizontalScrollBar &&
					(this.removeProtectedChild(this._horizontalScrollBar),
					(this._horizontalScrollBar = null));
		},
		getNodeByTag: function (t) {
			return this._innerContainer.getNodeByTag(t);
		},
		getNodes: function () {
			return this._innerContainer.getNodes();
		},
		removeNode: function (t) {
			this._innerContainer.removeNode(t);
		},
		removeNodeByTag: function (t) {
			this._innerContainer.removeNodeByTag(t);
		},
		removeAllNodes: function () {
			this._innerContainer.removeAllNodes();
		},
		addNode: function (t, e, i) {
			this._innerContainer.addNode(t, e, i);
		},
	}));
var _p = ccui.ScrollView.prototype;
_p.innerWidth,
	cc.defineGetterSetter(
		_p,
		'innerWidth',
		_p._getInnerWidth,
		_p._setInnerWidth
	),
	_p.innerHeight,
	cc.defineGetterSetter(
		_p,
		'innerHeight',
		_p._getInnerHeight,
		_p._setInnerHeight
	),
	_p.direction,
	cc.defineGetterSetter(_p, 'direction', _p.getDirection, _p.setDirection),
	_p.touchTotalTimeThreshold,
	cc.defineGetterSetter(
		_p,
		'touchTotalTimeThreshold',
		_p.getTouchTotalTimeThreshold,
		_p.setTouchTotalTimeThreshold
	),
	(_p = null),
	(ccui.ScrollView.create = function () {
		return new ccui.ScrollView();
	}),
	(ccui.ScrollView.DIR_NONE = 0),
	(ccui.ScrollView.DIR_VERTICAL = 1),
	(ccui.ScrollView.DIR_HORIZONTAL = 2),
	(ccui.ScrollView.DIR_BOTH = 3),
	(ccui.ScrollView.EVENT_SCROLL_TO_TOP = 0),
	(ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM = 1),
	(ccui.ScrollView.EVENT_SCROLL_TO_LEFT = 2),
	(ccui.ScrollView.EVENT_SCROLL_TO_RIGHT = 3),
	(ccui.ScrollView.EVENT_SCROLLING = 4),
	(ccui.ScrollView.EVENT_BOUNCE_TOP = 5),
	(ccui.ScrollView.EVENT_BOUNCE_BOTTOM = 6),
	(ccui.ScrollView.EVENT_BOUNCE_LEFT = 7),
	(ccui.ScrollView.EVENT_BOUNCE_RIGHT = 8),
	(ccui.ScrollView.EVENT_CONTAINER_MOVED = 9),
	(ccui.ScrollView.EVENT_AUTOSCROLL_ENDED = 10),
	(ccui.ScrollView.MOVEDIR_TOP = 0),
	(ccui.ScrollView.MOVEDIR_BOTTOM = 1),
	(ccui.ScrollView.MOVEDIR_LEFT = 2),
	(ccui.ScrollView.MOVEDIR_RIGHT = 3),
	(function () {
		var t;
		ccui.ProtectedNode.CanvasRenderCmd &&
			((ccui.ScrollView.CanvasRenderCmd = function (t) {
				ccui.Layout.CanvasRenderCmd.call(this, t), (this._dirty = !1);
			}),
			((t = ccui.ScrollView.CanvasRenderCmd.prototype =
				Object.create(
					ccui.Layout.CanvasRenderCmd.prototype
				)).constructor = ccui.ScrollView.CanvasRenderCmd),
			(t.visit = function (t) {
				var e = this._node;
				e._visible &&
					(e.__instanceId,
					cc.renderer.pushRenderCommand(this),
					this.layoutVisit(t),
					(this._dirtyFlag = 0));
			}),
			(t.rendering = function (t) {
				var e,
					i,
					n = this._node.__instanceId,
					r = cc.renderer._cacheToCanvasCmds[n],
					o = cc.view.getScaleX(),
					s = cc.view.getScaleY(),
					c = t || cc._renderContext;
				for (
					c.computeRealOffsetY(),
						this._node.updateChildren(),
						e = 0,
						i = r.length;
					e < i;
					e++
				) {
					var a = r[e]._node;
					a instanceof ccui.ScrollView ||
						(a && a._parent && !1 === a._parent._inViewRect) ||
						r[e].rendering(c, o, s);
				}
			}));
	})(),
	(function () {
		var t;
		ccui.ProtectedNode.WebGLRenderCmd &&
			((ccui.ScrollView.WebGLRenderCmd = function (t) {
				ccui.Layout.WebGLRenderCmd.call(this, t),
					(this._needDraw = !0),
					(this._dirty = !1);
			}),
			((t = ccui.ScrollView.WebGLRenderCmd.prototype =
				Object.create(
					ccui.Layout.WebGLRenderCmd.prototype
				)).constructor = ccui.ScrollView.WebGLRenderCmd),
			(t.visit = function (t) {
				var e,
					i = this._node;
				i._visible &&
					((e = this._node.__instanceId),
					cc.renderer.pushRenderCommand(this),
					cc.renderer._turnToCacheMode(e),
					this.layoutVisit(t),
					i.updateChildren(),
					(this._dirtyFlag = 0),
					cc.renderer._turnToNormalMode());
			}),
			(t.rendering = function (t) {
				var e,
					i,
					n,
					r,
					o = this._node.__instanceId,
					s = cc.renderer._cacheToBufferCmds[o],
					c = t || cc._renderContext;
				if (s)
					for (
						this._node.updateChildren(),
							c.bindBuffer(gl.ARRAY_BUFFER, null),
							e = 0,
							i = s.length;
						e < i;
						e++
					)
						(n = (r = s[e])._node) instanceof ccui.ScrollView ||
							(n && n._parent && !1 === n._parent._inViewRect) ||
							(r.uploadData
								? cc.renderer._uploadBufferData(r)
								: (0 < r._batchingSize &&
										cc.renderer._batchRendering(),
								  r.rendering(c)),
							cc.renderer._batchRendering());
			}));
	})(),
	(ccui.ListView = ccui.ScrollView.extend({
		_model: null,
		_items: null,
		_gravity: null,
		_itemsMargin: 0,
		_curSelectedIndex: 0,
		_refreshViewDirty: !0,
		_listViewEventListener: null,
		_listViewEventSelector: null,
		_ccListViewEventCallback: null,
		_magneticAllowedOutOfBoundary: !0,
		_magneticType: 0,
		_className: 'ListView',
		ctor: function () {
			(this._items = []),
				ccui.ScrollView.prototype.ctor.call(this),
				(this._gravity = ccui.ListView.GRAVITY_CENTER_VERTICAL),
				this.setTouchEnabled(!0),
				this.setDirection(ccui.ScrollView.DIR_VERTICAL);
		},
		setItemModel: function (t) {
			t ? (this._model = t) : cc.log("Can't set a null to item model!");
		},
		_handleReleaseLogic: function (t) {
			ccui.ScrollView.prototype._handleReleaseLogic.call(this, t),
				this._autoScrolling || this._startMagneticScroll();
		},
		_onItemListChanged: function () {
			this._outOfBoundaryAmountDirty = !0;
		},
		_updateInnerContainerSize: function () {
			var t,
				e = this._items;
			switch (this.direction) {
				case ccui.ScrollView.DIR_VERTICAL:
					for (
						var i = ((t = e.length) - 1) * this._itemsMargin, n = 0;
						n < t;
						n++
					)
						i += e[n].getContentSize().height;
					this.setInnerContainerSize(
						cc.size(this._contentSize.width, i)
					);
					break;
				case ccui.ScrollView.DIR_HORIZONTAL:
					var r = ((t = e.length) - 1) * this._itemsMargin;
					for (n = 0; n < t; n++) r += e[n].getContentSize().width;
					this.setInnerContainerSize(
						cc.size(r, this._contentSize.height)
					);
			}
		},
		_remedyLayoutParameter: function (t) {
			cc.assert(null != t, "ListView Item can't be nil!");
			var e = t.getLayoutParameter(ccui.LayoutParameter.LINEAR),
				i = !0;
			e || ((e = new ccui.LinearLayoutParameter()), (i = !1));
			var n = this.getIndex(t);
			switch (this.direction) {
				case ccui.ScrollView.DIR_VERTICAL:
					this._remedyVerticalLayoutParameter(e, n);
					break;
				case ccui.ScrollView.DIR_HORIZONTAL:
					this._remedyHorizontalLayoutParameter(e, n);
			}
			i || t.setLayoutParameter(e);
		},
		_remedyVerticalLayoutParameter: function (t, e) {
			switch (
				(cc.assert(null != t, "Layout parameter can't be nil!"),
				this._gravity)
			) {
				case ccui.ListView.GRAVITY_LEFT:
					t.setGravity(ccui.LinearLayoutParameter.LEFT);
					break;
				case ccui.ListView.GRAVITY_RIGHT:
					t.setGravity(ccui.LinearLayoutParameter.RIGHT);
					break;
				case ccui.ListView.GRAVITY_CENTER_HORIZONTAL:
					t.setGravity(ccui.LinearLayoutParameter.CENTER_HORIZONTAL);
			}
			0 === e
				? t.setMargin(ccui.MarginZero())
				: t.setMargin(new ccui.Margin(0, this._itemsMargin, 0, 0));
		},
		_remedyHorizontalLayoutParameter: function (t, e) {
			switch (
				(cc.assert(null != t, "Layout parameter can't be nil!"),
				this._gravity)
			) {
				case ccui.ListView.GRAVITY_TOP:
					t.setGravity(ccui.LinearLayoutParameter.TOP);
					break;
				case ccui.ListView.GRAVITY_BOTTOM:
					t.setGravity(ccui.LinearLayoutParameter.BOTTOM);
					break;
				case ccui.ListView.GRAVITY_CENTER_VERTICAL:
					t.setGravity(ccui.LinearLayoutParameter.CENTER_VERTICAL);
			}
			0 === e
				? t.setMargin(ccui.MarginZero())
				: t.setMargin(new ccui.Margin(this._itemsMargin, 0, 0, 0));
		},
		pushBackDefaultItem: function () {
			var t;
			null != this._model &&
				((t = this._model.clone()),
				this._remedyLayoutParameter(t),
				this.addChild(t),
				(this._refreshViewDirty = !0));
		},
		insertDefaultItem: function (t) {
			var e;
			null != this._model &&
				((e = this._model.clone()),
				this._items.splice(t, 0, e),
				ccui.ScrollView.prototype.addChild.call(this, e),
				this._remedyLayoutParameter(e),
				(this._refreshViewDirty = !0));
		},
		pushBackCustomItem: function (t) {
			this._remedyLayoutParameter(t),
				this.addChild(t),
				(this._refreshViewDirty = !0);
		},
		addChild: function (t, e, i) {
			t &&
				((e = e || t.getLocalZOrder()),
				(i = i || t.getName()),
				ccui.ScrollView.prototype.addChild.call(this, t, e, i),
				t instanceof ccui.Widget &&
					(this._items.push(t), this._onItemListChanged()));
		},
		removeChild: function (t, e) {
			var i;
			t &&
				(-1 < (i = this._items.indexOf(t)) && this._items.splice(i, 1),
				this._onItemListChanged(),
				ccui.ScrollView.prototype.removeChild.call(this, t, e));
		},
		removeAllChildren: function () {
			this.removeAllChildrenWithCleanup(!0);
		},
		removeAllChildrenWithCleanup: function (t) {
			ccui.ScrollView.prototype.removeAllChildrenWithCleanup.call(
				this,
				t
			),
				(this._items = []),
				this._onItemListChanged();
		},
		insertCustomItem: function (t, e) {
			this._items.splice(e, 0, t),
				this._onItemListChanged(),
				ccui.ScrollView.prototype.addChild.call(this, t),
				this._remedyLayoutParameter(t),
				(this._refreshViewDirty = !0);
		},
		removeItem: function (t) {
			t = this.getItem(t);
			null != t &&
				(this.removeChild(t, !0), (this._refreshViewDirty = !0));
		},
		removeLastItem: function () {
			this.removeItem(this._items.length - 1);
		},
		removeAllItems: function () {
			this.removeAllChildren();
		},
		getItem: function (t) {
			return t < 0 || t >= this._items.length ? null : this._items[t];
		},
		getItems: function () {
			return this._items;
		},
		getIndex: function (t) {
			return null == t ? -1 : this._items.indexOf(t);
		},
		setGravity: function (t) {
			this._gravity !== t &&
				((this._gravity = t), (this._refreshViewDirty = !0));
		},
		setMagneticType: function (t) {
			(this._magneticType = t),
				this._onItemListChanged(),
				this._startMagneticScroll();
		},
		getMagneticType: function () {
			return this._magneticType;
		},
		setMagneticAllowedOutOfBoundary: function (t) {
			this._magneticAllowedOutOfBoundary = t;
		},
		getMagneticAllowedOutOfBoundary: function () {
			return this._magneticAllowedOutOfBoundary;
		},
		setItemsMargin: function (t) {
			this._itemsMargin !== t &&
				((this._itemsMargin = t), (this._refreshViewDirty = !0));
		},
		getItemsMargin: function () {
			return this._itemsMargin;
		},
		setDirection: function (t) {
			switch (t) {
				case ccui.ScrollView.DIR_VERTICAL:
					this.setLayoutType(ccui.Layout.LINEAR_VERTICAL);
					break;
				case ccui.ScrollView.DIR_HORIZONTAL:
					this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL);
					break;
				case ccui.ScrollView.DIR_BOTH:
				default:
					return;
			}
			ccui.ScrollView.prototype.setDirection.call(this, t);
		},
		_getHowMuchOutOfBoundary: function (t) {
			if (
				(void 0 === t && (t = cc.p(0, 0)),
				!this._magneticAllowedOutOfBoundary || 0 === this._items.length)
			)
				return ccui.ScrollView.prototype._getHowMuchOutOfBoundary.call(
					this,
					t
				);
			if (
				this._magneticType === ccui.ListView.MAGNETIC_NONE ||
				this._magneticType === ccui.ListView.MAGNETIC_BOTH_END
			)
				return ccui.ScrollView.prototype._getHowMuchOutOfBoundary.call(
					this,
					t
				);
			if (0 === t.x && 0 === t.y && !this._outOfBoundaryAmountDirty)
				return this._outOfBoundaryAmount;
			var e = this._leftBoundary,
				i = this._rightBoundary,
				n = this._topBoundary,
				r = this._bottomBoundary,
				o = this._items.length - 1,
				s = this.getContentSize(),
				c = cc.p(0, 0),
				a = cc.p(0, 0);
			switch (this._magneticType) {
				case ccui.ListView.MAGNETIC_CENTER:
					(c.x = (s.width - this._items[0].width) / 2),
						(c.y = (s.height - this._items[0].height) / 2),
						(a.x = (s.width - this._items[o].width) / 2),
						(a.y = (s.height - this._items[o].height) / 2);
					break;
				case ccui.ListView.MAGNETIC_LEFT:
				case ccui.ListView.MAGNETIC_TOP:
					(a.x = s.width - this._items[o].width),
						(a.y = s.height - this._items[o].height);
					break;
				case ccui.ListView.MAGNETIC_RIGHT:
				case ccui.ListView.MAGNETIC_BOTTOM:
					(c.x = s.width - this._items[0].width),
						(c.y = s.height - this._items[0].height);
			}
			(e += c.x), (i -= a.x), (n -= c.y), (r += a.y);
			var l = cc.p(0, 0);
			return (
				this._innerContainer.getLeftBoundary() + t.x > e
					? (l.x = e - (this._innerContainer.getLeftBoundary() + t.x))
					: this._innerContainer.getRightBoundary() + t.x < i &&
					  (l.x =
							i -
							(this._innerContainer.getRightBoundary() + t.x)),
				this._innerContainer.getTopBoundary() + t.y < n
					? (l.y = n - (this._innerContainer.getTopBoundary() + t.y))
					: this._innerContainer.getBottomBoundary() + t.y > r &&
					  (l.y =
							r -
							(this._innerContainer.getBottomBoundary() + t.y)),
				0 === t.x &&
					0 === t.y &&
					((this._outOfBoundaryAmount = l),
					(this._outOfBoundaryAmountDirty = !1)),
				l
			);
		},
		_calculateItemPositionWithAnchor: function (t, e) {
			var i = cc.p(t.getLeftBoundary(), t.getBottomBoundary()),
				t = t.getContentSize();
			return cc.p(i.x + t.width * e.x, i.y + t.height * e.y);
		},
		_findClosestItem: function (t, e, i, n, r, o, s) {
			if ((cc.assert(0 <= n && o < e.length && n <= o, ''), n === o))
				return e[n];
			if (o - n == 1) return r <= s ? e[n] : e[o];
			var c = Math.floor((n + o) / 2),
				a = this._calculateItemPositionWithAnchor(e[c], i),
				a = cc.pLength(cc.pSub(t, a));
			return r <= s
				? this._findClosestItem(t, e, i, n, r, c, a)
				: this._findClosestItem(t, e, i, c, a, o, s);
		},
		getClosestItemToPosition: function (t, e) {
			if (0 === this._items.length) return null;
			var i = this._calculateItemPositionWithAnchor(this._items[0], e),
				n = cc.pLength(cc.pSub(t, i)),
				r = this._items.length - 1,
				i = this._calculateItemPositionWithAnchor(this._items[r], e),
				i = cc.pLength(cc.pSub(t, i));
			return this._findClosestItem(t, this._items, e, 0, n, r, i);
		},
		getClosestItemToPositionInCurrentView: function (t, e) {
			var i = this.getContentSize(),
				n = cc.pMult(this._innerContainer.getPosition(), -1);
			return (
				(n.x += i.width * t.x),
				(n.y += i.height * t.y),
				this.getClosestItemToPosition(n, e)
			);
		},
		getCenterItemInCurrentView: function () {
			return this.getClosestItemToPositionInCurrentView(
				cc.p(0.5, 0.5),
				cc.p(0.5, 0.5)
			);
		},
		getLeftmostItemInCurrentView: function () {
			return this._direction === ccui.ScrollView.DIR_HORIZONTAL
				? this.getClosestItemToPositionInCurrentView(
						cc.p(0, 0.5),
						cc.p(0.5, 0.5)
				  )
				: null;
		},
		getRightmostItemInCurrentView: function () {
			return this._direction === ccui.ScrollView.DIR_HORIZONTAL
				? this.getClosestItemToPositionInCurrentView(
						cc.p(1, 0.5),
						cc.p(0.5, 0.5)
				  )
				: null;
		},
		getTopmostItemInCurrentView: function () {
			return this._direction === ccui.ScrollView.DIR_VERTICAL
				? this.getClosestItemToPositionInCurrentView(
						cc.p(0.5, 1),
						cc.p(0.5, 0.5)
				  )
				: null;
		},
		getBottommostItemInCurrentView: function () {
			return this._direction === ccui.ScrollView.DIR_VERTICAL
				? this.getClosestItemToPositionInCurrentView(
						cc.p(0.5, 0),
						cc.p(0.5, 0.5)
				  )
				: null;
		},
		_calculateItemDestination: function (t, e, i) {
			var n = this.getContentSize(),
				r = cc.p(0, 0);
			(r.x += n.width * t.x), (r.y += n.height * t.y);
			i = this._calculateItemPositionWithAnchor(e, i);
			return cc.pMult(cc.pSub(i, r), -1);
		},
		jumpToBottom: function () {
			this.doLayout(), ccui.ScrollView.prototype.jumpToBottom.call(this);
		},
		jumpToTop: function () {
			this.doLayout(), ccui.ScrollView.prototype.jumpToTop.call(this);
		},
		jumpToLeft: function () {
			this.doLayout(), ccui.ScrollView.prototype.jumpToLeft.call(this);
		},
		jumpToRight: function () {
			this.doLayout(), ccui.ScrollView.prototype.jumpToRight.call(this);
		},
		jumpToTopLeft: function () {
			this.doLayout(), ccui.ScrollView.prototype.jumpToTopLeft.call(this);
		},
		jumpToTopRight: function () {
			this.doLayout(),
				ccui.ScrollView.prototype.jumpToTopRight.call(this);
		},
		jumpToBottomLeft: function () {
			this.doLayout(),
				ccui.ScrollView.prototype.jumpToBottomLeft.call(this);
		},
		jumpToBottomRight: function () {
			this.doLayout(),
				ccui.ScrollView.prototype.jumpToBottomRight.call(this);
		},
		jumpToPercentVertical: function (t) {
			this.doLayout(),
				ccui.ScrollView.prototype.jumpToPercentVertical.call(this, t);
		},
		jumpToPercentHorizontal: function (t) {
			this.doLayout(),
				ccui.ScrollView.prototype.jumpToPercentHorizontal.call(this, t);
		},
		jumpToPercentBothDirection: function (t) {
			this.doLayout(),
				ccui.ScrollView.prototype.jumpToPercentBothDirection.call(
					this,
					t
				);
		},
		jumpToItem: function (t, e, i) {
			t = this.getItem(t);
			t &&
				(this.doLayout(),
				(t = this._calculateItemDestination(e, t, i)),
				this.bounceEnabled ||
					((i = cc.pSub(t, this._innerContainer.getPosition())),
					(i = this._getHowMuchOutOfBoundary(i)),
					(t.x += i.x),
					(t.y += i.y)),
				this._jumpToDestination(t));
		},
		scrollToItem: function (t, e, i, n) {
			void 0 === n && (n = 1);
			t = this.getItem(t);
			t &&
				((i = this._calculateItemDestination(e, t, i)),
				this._startAutoScrollToDestination(i, n, !0));
		},
		requestRefreshView: function () {
			this._refreshViewDirty = !0;
		},
		refreshView: function () {
			this.forceDoLayout();
		},
		doLayout: function () {
			this._doLayout();
		},
		requestDoLayout: function () {
			this._refreshViewDirty = !0;
		},
		_doLayout: function () {
			if (this._refreshViewDirty) {
				for (var t = this._items, e = 0; e < t.length; e++) {
					var i = t[e];
					i.setLocalZOrder(e), this._remedyLayoutParameter(i);
				}
				this._updateInnerContainerSize(),
					this._innerContainer.forceDoLayout(),
					(this._refreshViewDirty = !1);
			}
		},
		addEventListenerListView: function (t, e) {
			(this._listViewEventListener = e),
				(this._listViewEventSelector = t);
		},
		addEventListener: function (t) {
			this._ccListViewEventCallback = t;
		},
		_selectedItemEvent: function (t) {
			t =
				t === ccui.Widget.TOUCH_BEGAN
					? ccui.ListView.ON_SELECTED_ITEM_START
					: ccui.ListView.ON_SELECTED_ITEM_END;
			this._listViewEventSelector &&
				(this._listViewEventListener
					? this._listViewEventSelector.call(
							this._listViewEventListener,
							this,
							t
					  )
					: this._listViewEventSelector(this, t)),
				this._ccListViewEventCallback &&
					this._ccListViewEventCallback(this, t);
		},
		interceptTouchEvent: function (t, e, i) {
			if (
				(ccui.ScrollView.prototype.interceptTouchEvent.call(
					this,
					t,
					e,
					i
				),
				this._touchEnabled && t !== ccui.Widget.TOUCH_MOVED)
			) {
				for (var n = e; n; ) {
					if (n && n.getParent() === this._innerContainer) {
						this._curSelectedIndex = this.getIndex(n);
						break;
					}
					n = n.getParent();
				}
				e.isHighlighted() && this._selectedItemEvent(t);
			}
		},
		getCurSelectedIndex: function () {
			return this._curSelectedIndex;
		},
		_onSizeChanged: function () {
			ccui.ScrollView.prototype._onSizeChanged.call(this),
				(this._refreshViewDirty = !0);
		},
		getDescription: function () {
			return 'ListView';
		},
		_createCloneInstance: function () {
			return new ccui.ListView();
		},
		_copyClonedWidgetChildren: function (t) {
			for (var e = t.getItems(), i = 0; i < e.length; i++) {
				var n = e[i];
				this.pushBackCustomItem(n.clone());
			}
		},
		_copySpecialProperties: function (t) {
			t instanceof ccui.ListView &&
				(ccui.ScrollView.prototype._copySpecialProperties.call(this, t),
				this.setItemModel(t._model),
				this.setItemsMargin(t._itemsMargin),
				this.setGravity(t._gravity),
				(this._listViewEventListener = t._listViewEventListener),
				(this._listViewEventSelector = t._listViewEventSelector));
		},
		_startAttenuatingAutoScroll: function (t, e) {
			var i,
				n,
				r = t;
			0 !== this._items.length &&
				this._magneticType !== ccui.ListView.MAGNETIC_NONE &&
				((r = this._flattenVectorByDirection(r)),
				0 === (i = this._getHowMuchOutOfBoundary(r)).x &&
					0 === i.y &&
					((n = this._magneticType) ===
						ccui.ListView.MAGNETIC_BOTH_END &&
						(this._direction === ccui.ScrollView.DIR_HORIZONTAL
							? (n =
									0 < r.x
										? ccui.ListView.MAGNETIC_LEFT
										: ccui.ListView.MAGNETIC_RIGHT)
							: this._direction ===
									ccui.ScrollView.DIR_VERTICAL &&
							  (n =
									0 < r.y
										? ccui.ListView.MAGNETIC_BOTTOM
										: ccui.ListView.MAGNETIC_TOP)),
					(t = this._getAnchorPointByMagneticType(n)),
					((i = cc.pMult(this._innerContainer.getPosition(), -1)).x +=
						this.width * t.x),
					(i.y += this.height * t.y),
					(n = this.getClosestItemToPosition(cc.pSub(i, r), t)),
					(t = this._calculateItemPositionWithAnchor(n, t)),
					(r = cc.pSub(i, t)))),
				ccui.ScrollView.prototype._startAttenuatingAutoScroll.call(
					this,
					r,
					e
				);
		},
		_getAnchorPointByMagneticType: function (t) {
			switch (t) {
				case ccui.ListView.MAGNETIC_NONE:
					return cc.p(0, 0);
				case ccui.ListView.MAGNETIC_BOTH_END:
					return cc.p(0, 1);
				case ccui.ListView.MAGNETIC_CENTER:
					return cc.p(0.5, 0.5);
				case ccui.ListView.MAGNETIC_LEFT:
					return cc.p(0, 0.5);
				case ccui.ListView.MAGNETIC_RIGHT:
					return cc.p(1, 0.5);
				case ccui.ListView.MAGNETIC_TOP:
					return cc.p(0.5, 1);
				case ccui.ListView.MAGNETIC_BOTTOM:
					return cc.p(0.5, 0);
			}
			return cc.p(0, 0);
		},
		_startMagneticScroll: function () {
			var t, e;
			0 !== this._items.length &&
				this._magneticType !== ccui.ListView.MAGNETIC_NONE &&
				((t = this._getAnchorPointByMagneticType(this._magneticType)),
				((e = cc.pMult(this._innerContainer.getPosition(), -1)).x +=
					this.width * t.x),
				(e.y += this.height * t.y),
				(e = this.getClosestItemToPosition(e, t)),
				this.scrollToItem(this.getIndex(e), t, t));
		},
	})),
	(ccui.ListView.create = function () {
		return new ccui.ListView();
	}),
	(ccui.ListView.EVENT_SELECTED_ITEM = 0),
	(ccui.ListView.ON_SELECTED_ITEM_START = 0),
	(ccui.ListView.ON_SELECTED_ITEM_END = 1),
	(ccui.ListView.GRAVITY_LEFT = 0),
	(ccui.ListView.GRAVITY_RIGHT = 1),
	(ccui.ListView.GRAVITY_CENTER_HORIZONTAL = 2),
	(ccui.ListView.GRAVITY_TOP = 3),
	(ccui.ListView.GRAVITY_BOTTOM = 4),
	(ccui.ListView.GRAVITY_CENTER_VERTICAL = 5),
	(ccui.ListView.MAGNETIC_NONE = 0),
	(ccui.ListView.MAGNETIC_CENTER = 1),
	(ccui.ListView.MAGNETIC_BOTH_END = 2),
	(ccui.ListView.MAGNETIC_LEFT = 3),
	(ccui.ListView.MAGNETIC_RIGHT = 4),
	(ccui.ListView.MAGNETIC_TOP = 5),
	(ccui.ListView.MAGNETIC_BOTTOM = 6),
	(ccui.PageView = ccui.ListView.extend({
		_curPageIdx: 0,
		_childFocusCancelOffset: 0,
		_pageViewEventListener: null,
		_pageViewEventSelector: null,
		_className: 'PageView',
		_indicator: null,
		_indicatorPositionAsAnchorPoint: null,
		ctor: function () {
			ccui.ListView.prototype.ctor.call(this),
				(this._childFocusCancelOffset = 5),
				(this._indicatorPositionAsAnchorPoint = cc.p(0.5, 0.1)),
				(this._pageViewEventListener = null),
				(this._pageViewEventSelector = null),
				this.setDirection(ccui.ScrollView.DIR_HORIZONTAL),
				this.setMagneticType(ccui.ListView.MAGNETIC_CENTER),
				this.setScrollBarEnabled(!1);
		},
		addWidgetToPage: function (t, e, i) {
			this.insertCustomItem(t, e);
		},
		addPage: function (t) {
			this.pushBackCustomItem(t);
		},
		insertPage: function (t, e) {
			this.insertCustomItem(t, e);
		},
		removePage: function (t) {
			this.removeItem(this.getIndex(t));
		},
		removePageAtIndex: function (t) {
			this.removeItem(t);
		},
		removeAllPages: function () {
			this.removeAllItems();
		},
		scrollToItem: function (t) {
			ccui.ListView.prototype.scrollToItem.call(
				this,
				t,
				cc.p(0.5, 0.5),
				cc.p(0.5, 0.5)
			);
		},
		scrollToPage: function (t) {
			this.scrollToItem(t);
		},
		_doLayout: function () {
			var t;
			this._refreshViewDirty &&
				(ccui.ListView.prototype._doLayout.call(this),
				this._indicator &&
					((t = this.getIndex(this.getCenterItemInCurrentView())),
					this._indicator.indicate(t)),
				(this._refreshViewDirty = !1));
		},
		setDirection: function (t) {
			ccui.ListView.prototype.setDirection.call(this, t),
				t === ccui.ScrollView.DIR_HORIZONTAL
					? (this._indicatorPositionAsAnchorPoint = cc.p(0.5, 0.1))
					: t === ccui.ScrollView.DIR_VERTICAL &&
					  (this._indicatorPositionAsAnchorPoint = cc.p(0.1, 0.5)),
				this._indicator &&
					(this._indicator.setDirection(t),
					this._refreshIndicatorPosition());
		},
		setCustomScrollThreshold: function (t) {},
		getCustomScrollThreshold: function () {
			return 0;
		},
		setUsingCustomScrollThreshold: function (t) {},
		isUsingCustomScrollThreshold: function () {
			return !1;
		},
		_moveInnerContainer: function (t, e) {
			ccui.ListView.prototype._moveInnerContainer.call(this, t, e),
				(this._curPageIdx = this.getIndex(
					this.getCenterItemInCurrentView()
				)),
				this._indicator && this._indicator.indicate(this._curPageIdx);
		},
		_onItemListChanged: function () {
			ccui.ListView.prototype._onItemListChanged.call(this),
				this._indicator && this._indicator.reset(this._items.length);
		},
		_onSizeChanged: function () {
			ccui.ListView.prototype._onSizeChanged.call(this),
				this._refreshIndicatorPosition();
		},
		_remedyLayoutParameter: function (t) {
			t.setContentSize(this.getContentSize()),
				ccui.ListView.prototype._remedyLayoutParameter.call(this, t);
		},
		_refreshIndicatorPosition: function () {
			var t, e;
			this._indicator &&
				((t =
					(e = this.getContentSize()).width *
					this._indicatorPositionAsAnchorPoint.x),
				(e = e.height * this._indicatorPositionAsAnchorPoint.y),
				this._indicator.setPosition(cc.p(t, e)));
		},
		_handleReleaseLogic: function (t) {
			var e;
			ccui.ScrollView.prototype._handleReleaseLogic.call(this, t),
				this._items.length <= 0 ||
					((e = this._flattenVectorByDirection(
						this._calculateTouchMoveVelocity()
					)),
					cc.pLength(e) < 500
						? this._startMagneticScroll()
						: ((t = this.getItem(this._curPageIdx)),
						  (t = this._calculateItemDestination(
								cc.p(0.5, 0.5),
								t,
								cc.p(0.5, 0.5)
						  )),
						  (t = cc.pSub(t, this.getInnerContainerPosition())),
						  (t = this._flattenVectorByDirection(t)),
						  0 < e.x * t.x || 0 < e.y * t.y
								? this._startMagneticScroll()
								: (e.x < 0 || 0 < e.y
										? ++this._curPageIdx
										: --this._curPageIdx,
								  (this._curPageIdx = Math.min(
										this._curPageIdx,
										this._items.length
								  )),
								  (this._curPageIdx = Math.max(
										this._curPageIdx,
										0
								  )),
								  this.scrollToItem(this._curPageIdx))));
		},
		_getAutoScrollStopEpsilon: function () {
			return 0.001;
		},
		_pageTurningEvent: function () {
			this._pageViewEventSelector &&
				(this._pageViewEventListener
					? this._pageViewEventSelector.call(
							this._pageViewEventListener,
							this,
							ccui.PageView.EVENT_TURNING
					  )
					: this._pageViewEventSelector(
							this,
							ccui.PageView.EVENT_TURNING
					  )),
				this._ccEventCallback &&
					this._ccEventCallback(this, ccui.PageView.EVENT_TURNING);
		},
		addEventListenerPageView: function (t, e) {
			(this._pageViewEventSelector = t),
				(this._pageViewEventListener = e);
		},
		addEventListener: function (i) {
			this._ccEventCallback = function (t, e) {
				e == ccui.ScrollView.EVENT_AUTOSCROLL_ENDED && i(this, e);
			};
		},
		setCurrentPageIndex: function (t) {
			this.jumpToItem(t, cc.p(0.5, 0.5), cc.p(0.5, 0.5));
		},
		setCurPageIndex: function (t) {
			this.setCurrentPageIndex(t);
		},
		getCurrentPageIndex: function () {
			return this._curPageIdx;
		},
		getCurPageIndex: function () {
			var t = this.getCenterItemInCurrentView();
			return this.getIndex(t);
		},
		getPages: function () {
			return this.getItems();
		},
		getPage: function (t) {
			return this.getItem(t);
		},
		getDescription: function () {
			return 'PageView';
		},
		_createCloneInstance: function () {
			return new ccui.PageView();
		},
		_copyClonedWidgetChildren: function (t) {
			for (var e = t.getPages(), i = 0; i < e.length; i++) {
				var n = e[i];
				this.addPage(n.clone());
			}
		},
		_copySpecialProperties: function (t) {
			ccui.ListView.prototype._copySpecialProperties.call(this, t),
				(this._ccEventCallback = t._ccEventCallback),
				(this._pageViewEventListener = t._pageViewEventListener),
				(this._pageViewEventSelector = t._pageViewEventSelector),
				(this._customScrollThreshold = t._customScrollThreshold);
		},
		setIndicatorEnabled: function (t) {
			t != (null !== this._indicator) &&
				(t
					? ((this._indicator = new ccui.PageViewIndicator()),
					  this._indicator.setDirection(this.getDirection()),
					  this.addProtectedChild(this._indicator, 1e4),
					  this.setIndicatorSelectedIndexColor(
							cc.color(100, 100, 255)
					  ),
					  this._refreshIndicatorPosition())
					: (this.removeProtectedChild(this._indicator),
					  (this._indicator = null)));
		},
		getIndicatorEnabled: function () {
			return null !== this._indicator;
		},
		setIndicatorPositionAsAnchorPoint: function (t) {
			(this._indicatorPositionAsAnchorPoint = t),
				this._refreshIndicatorPosition();
		},
		getIndicatorPositionAsAnchorPoint: function () {
			return this._indicatorPositionAsAnchorPoint;
		},
		setIndicatorPosition: function (t) {
			var e;
			this._indicator &&
				((e = this.getContentSize()),
				(this._indicatorPositionAsAnchorPoint.x = t.x / e.width),
				(this._indicatorPositionAsAnchorPoint.y = t.y / e.height),
				this._indicator.setPosition(t));
		},
		getIndicatorPosition: function () {
			return (
				cc.assert(null !== this._indicator, ''),
				this._indicator.getPosition()
			);
		},
		setIndicatorSpaceBetweenIndexNodes: function (t) {
			this._indicator && this._indicator.setSpaceBetweenIndexNodes(t);
		},
		getIndicatorSpaceBetweenIndexNodes: function () {
			return (
				cc.assert(null !== this._indicator, ''),
				this._indicator.getSpaceBetweenIndexNodes()
			);
		},
		setIndicatorSelectedIndexColor: function (t) {
			this._indicator && this._indicator.setSelectedIndexColor(t);
		},
		getIndicatorSelectedIndexColor: function () {
			return (
				cc.assert(null !== this._indicator, ''),
				this._indicator.getSelectedIndexColor()
			);
		},
		setIndicatorIndexNodesColor: function (t) {
			this._indicator && this._indicator.setIndexNodesColor(t);
		},
		getIndicatorIndexNodesColor: function () {
			return (
				cc.assert(null !== this._indicator, ''),
				this._indicator.getIndexNodesColor()
			);
		},
		setIndicatorIndexNodesScale: function (t) {
			this._indicator &&
				(this._indicator.setIndexNodesScale(t),
				this._indicator.indicate(this._curPageIdx));
		},
		getIndicatorIndexNodesScale: function () {
			return (
				cc.assert(null !== this._indicator, ''),
				this._indicator.getIndexNodesScale()
			);
		},
		setIndicatorIndexNodesTexture: function (t, e) {
			this._indicator &&
				(this._indicator.setIndexNodesTexture(t, e),
				this._indicator.indicate(this._curPageIdx));
		},
	})),
	(ccui.PageView.create = function () {
		return new ccui.PageView();
	}),
	(ccui.PageView.EVENT_TURNING = 0),
	(ccui.PageView.TOUCH_DIR_LEFT = 0),
	(ccui.PageView.TOUCH_DIR_RIGHT = 1),
	(ccui.PageView.DIRECTION_LEFT = 0),
	(ccui.PageView.DIRECTION_RIGHT = 1),
	(ccui.PageViewIndicator = ccui.ProtectedNode.extend({
		_direction: null,
		_indexNodes: null,
		_currentIndexNode: null,
		_spaceBetweenIndexNodes: 0,
		_indexNodesScale: 1,
		_indexNodesColor: null,
		_useDefaultTexture: !0,
		_indexNodesTextureFile: '',
		_indexNodesTexType: ccui.Widget.LOCAL_TEXTURE,
		_className: 'PageViewIndicator',
		ctor: function () {
			cc.ProtectedNode.prototype.ctor.call(this),
				(this._direction = ccui.ScrollView.DIR_HORIZONTAL),
				(this._indexNodes = []),
				(this._spaceBetweenIndexNodes =
					ccui.PageViewIndicator.SPACE_BETWEEN_INDEX_NODES_DEFAULT),
				(this._indexNodesColor = cc.color.WHITE),
				(this._currentIndexNode = ccui.helper._createSpriteFromBase64(
					ccui.PageViewIndicator.CIRCLE_IMAGE,
					ccui.PageViewIndicator.CIRCLE_IMAGE_KEY
				)),
				this._currentIndexNode.setVisible(!1),
				this.addProtectedChild(this._currentIndexNode, 1);
		},
		setDirection: function (t) {
			(this._direction = t), this._rearrange();
		},
		reset: function (t) {
			for (; this._indexNodes.length < t; ) this._increaseNumberOfPages();
			for (; this._indexNodes.length > t; ) this._decreaseNumberOfPages();
			this._rearrange(),
				this._currentIndexNode.setVisible(0 < this._indexNodes.length);
		},
		indicate: function (t) {
			t < 0 ||
				t >= this._indexNodes.length ||
				this._currentIndexNode.setPosition(
					this._indexNodes[t].getPosition()
				);
		},
		_rearrange: function () {
			if (0 !== this._indexNodes.length)
				for (
					var t = this._direction === ccui.ScrollView.DIR_HORIZONTAL,
						e = this._indexNodes[0].getContentSize(),
						i = t ? e.width : e.height,
						n = this._indexNodes.length,
						r =
							-(i * n + this._spaceBetweenIndexNodes * (n - 1)) /
								2 +
							i / 2,
						o = 0;
					o < this._indexNodes.length;
					++o
				) {
					var s = t ? cc.p(r, e.height / 2) : cc.p(e.width / 2, -r);
					this._indexNodes[o].setPosition(s),
						(r += i + this._spaceBetweenIndexNodes);
				}
		},
		setSpaceBetweenIndexNodes: function (t) {
			this._spaceBetweenIndexNodes !== t &&
				((this._spaceBetweenIndexNodes = t), this._rearrange());
		},
		getSpaceBetweenIndexNodes: function () {
			return this._spaceBetweenIndexNodes;
		},
		setSelectedIndexColor: function (t) {
			this._currentIndexNode.setColor(t);
		},
		getSelectedIndexColor: function () {
			return this._currentIndexNode.getColor();
		},
		setIndexNodesColor: function (t) {
			this._indexNodesColor = t;
			for (var e = 0; e < this._indexNodes.length; ++e)
				this._indexNodes[e].setColor(t);
		},
		getIndexNodesColor: function () {
			var t = this._indexNodesColor;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		setIndexNodesScale: function (t) {
			if (this._indexNodesScale !== t) {
				(this._indexNodesScale = t), this._currentIndexNode.setScale(t);
				for (var e = 0; e < this._indexNodes.length; ++e)
					this._indexNodes[e].setScale(this, _indexNodesScale);
				this._rearrange();
			}
		},
		getIndexNodesScale: function () {
			return this._indexNodesScale;
		},
		setIndexNodesTexture: function (t, e) {
			switch (
				(void 0 === e && (e = ccui.Widget.LOCAL_TEXTURE),
				(this._useDefaultTexture = !1),
				(this._indexNodesTextureFile = t),
				(this._indexNodesTexType = e))
			) {
				case ccui.Widget.LOCAL_TEXTURE:
					this._currentIndexNode.setTexture(t);
					for (var i = 0; i < this._indexNodes.length; ++i)
						this._indexNodes[i].setTexture(t);
					break;
				case ccui.Widget.PLIST_TEXTURE:
					this._currentIndexNode.setSpriteFrame(t);
					for (i = 0; i < this._indexNodes.length; ++i)
						this._indexNodes[i].setSpriteFrame(t);
			}
			this._rearrange();
		},
		_increaseNumberOfPages: function () {
			var t;
			if (this._useDefaultTexture)
				t = ccui.helper._createSpriteFromBase64(
					ccui.PageViewIndicator.CIRCLE_IMAGE,
					ccui.PageViewIndicator.CIRCLE_IMAGE_KEY
				);
			else
				switch (((t = new cc.Sprite()), this._indexNodesTexType)) {
					case ccui.Widget.LOCAL_TEXTURE:
						t.initWithFile(this._indexNodesTextureFile);
						break;
					case ccui.Widget.PLIST_TEXTURE:
						t.initWithSpriteFrameName(this._indexNodesTextureFile);
				}
			t.setColor(this._indexNodesColor),
				t.setScale(this._indexNodesScale),
				this.addProtectedChild(t),
				this._indexNodes.push(t);
		},
		_decreaseNumberOfPages: function () {
			0 !== this._indexNodes.length &&
				(this.removeProtectedChild(this._indexNodes[0]),
				this._indexNodes.splice(0, 1));
		},
		clear: function () {
			for (var t = 0; t < this._indexNodes.length; ++t)
				this.removeProtectedChild(this._indexNodes[t]);
			(this._indexNodes.length = 0),
				this._currentIndexNode.setVisible(!1);
		},
	}));
var _p = ccui.PageViewIndicator.prototype;
_p.spaceBetweenIndexNodes,
	cc.defineGetterSetter(
		_p,
		'spaceBetweenIndexNodes',
		_p.getSpaceBetweenIndexNodes,
		_p.setSpaceBetweenIndexNodes
	),
	(ccui.PageViewIndicator.SPACE_BETWEEN_INDEX_NODES_DEFAULT = 23),
	(ccui.PageViewIndicator.CIRCLE_IMAGE_KEY = '/__circle_image'),
	(ccui.PageViewIndicator.CIRCLE_IMAGE =
		'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAA8ElEQVRIx62VyRGCQBBF+6gWRCEmYDIQkhiBCgHhSclC8YqWzOV5oVzKAYZp3r1/9fpbxAIBMTsKrjx5cqVgR0wgLhCRUWOjJiPqD56xoaGPhpRZV/iSEy6crHmw5oIrF9b/lVeMofrJgjlnxlIy/wik+JB+mme8BExbBhm+5CJC2LE2LtSEQoyGWDioBA5CoRIohJtK4CYDxzNEM4GAugR1E9VjVC+SZpXvhCJCrjomESLvc17pDGX7bWmlh6UtpjPVCWy9zaJ0TD7qfm3pwERMz2trRVZk3K3BD/L34AY+dEDCniMVBkPFkT2J/b2/AIV+dRpFLOYoAAAAAElFTkSuQmCC'),
	(ccui.VideoPlayer = ccui.Widget.extend({
		_played: !1,
		_playing: !1,
		_stopped: !0,
		ctor: function (t) {
			ccui.Widget.prototype.ctor.call(this),
				(this._EventList = {}),
				t && this.setURL(t);
		},
		_createRenderCmd: function () {
			return new ccui.VideoPlayer.RenderCmd(this);
		},
		setURL: function (t) {
			this._renderCmd.updateURL(t);
		},
		getURL: function () {
			return this._renderCmd._url;
		},
		play: function () {
			var t = this,
				e = this._renderCmd._video;
			e &&
				((this._played = !0),
				e.pause(),
				(!1 === this._stopped &&
					!1 === this._playing &&
					!0 === this._played) ||
					(e.currentTime = 0),
				ccui.VideoPlayer._polyfill.autoplayAfterOperation
					? setTimeout(function () {
							e.play(), (t._playing = !0), (t._stopped = !1);
					  }, 20)
					: (e.play(), (this._playing = !0), (this._stopped = !1)));
		},
		pause: function () {
			var t = this._renderCmd._video;
			t &&
				!0 === this._playing &&
				!1 === this._stopped &&
				(t.pause(), (this._playing = !1));
		},
		resume: function () {
			!1 === this._stopped &&
				!1 === this._playing &&
				!0 === this._played &&
				this.play();
		},
		stop: function () {
			var t = this,
				e = this._renderCmd._video;
			e &&
				(e.pause(),
				(e.currentTime = 0),
				(this._playing = !1),
				(this._stopped = !0)),
				setTimeout(function () {
					t._dispatchEvent(ccui.VideoPlayer.EventType.STOPPED);
				}, 0);
		},
		seekTo: function (t) {
			var e = this._renderCmd._video;
			e &&
				((e.currentTime = t),
				ccui.VideoPlayer._polyfill.autoplayAfterOperation &&
					this.isPlaying() &&
					setTimeout(function () {
						e.play();
					}, 20));
		},
		isPlaying: function () {
			return (
				ccui.VideoPlayer._polyfill.autoplayAfterOperation &&
					this._playing &&
					setTimeout(function () {
						video.play();
					}, 20),
				this._playing
			);
		},
		setKeepAspectRatioEnabled: function (t) {
			cc.log('On the web is always keep the aspect ratio');
		},
		isKeepAspectRatioEnabled: function () {
			return !1;
		},
		setFullScreenEnabled: function (t) {
			var e = this._renderCmd._video;
			e &&
				(t
					? cc.screen.requestFullScreen(e)
					: cc.screen.exitFullScreen(e));
		},
		isFullScreenEnabled: function () {
			cc.log("Can't know status");
		},
		setEventListener: function (t, e) {
			this._EventList[t] = e;
		},
		removeEventListener: function (t) {
			this._EventList[t] = null;
		},
		_dispatchEvent: function (t) {
			t = this._EventList[t];
			t && t.call(this, this, this._renderCmd._video.src);
		},
		onPlayEvent: function () {
			var t = this._EventList[ccui.VideoPlayer.EventType.PLAYING];
			if (t)
				for (var e = 0; e < t.length; e++)
					t[e].call(this, this, this._renderCmd._video.src);
		},
		setContentSize: function (t, e) {
			ccui.Widget.prototype.setContentSize.call(this, t, e),
				void 0 === e && ((e = t.height), (t = t.width)),
				this._renderCmd.changeSize(t, e);
		},
		cleanup: function () {
			this._renderCmd.removeDom(),
				this.stopAllActions(),
				this.unscheduleAllCallbacks();
		},
		onEnter: function () {
			ccui.Widget.prototype.onEnter.call(this);
			var t = ccui.VideoPlayer.elements;
			-1 === t.indexOf(this) && t.push(this);
		},
		onExit: function () {
			ccui.Widget.prototype.onExit.call(this);
			var t = ccui.VideoPlayer.elements,
				e = t.indexOf(this);
			-1 !== e && t.splice(e, 1);
		},
	})),
	(ccui.VideoPlayer.elements = []),
	(ccui.VideoPlayer.pauseElements = []),
	cc.eventManager.addCustomListener(cc.game.EVENT_HIDE, function () {
		for (var t, e = ccui.VideoPlayer.elements, i = 0; i < e.length; i++)
			(t = e[i]),
				e[i]._playing &&
					(t.pause(), ccui.VideoPlayer.pauseElements.push(t));
	}),
	cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, function () {
		for (var t = ccui.VideoPlayer.pauseElements, e = t.pop(); e; )
			e.play(), (e = t.pop());
	}),
	(ccui.VideoPlayer.EventType = {
		PLAYING: 'play',
		PAUSED: 'pause',
		STOPPED: 'stop',
		COMPLETED: 'complete',
	}),
	(function (t) {
		var e;
		(t._polyfill = {
			devicePixelRatio: !1,
			event: 'canplay',
			canPlayType: [],
		}),
			(e = document.createElement('video')).canPlayType('video/ogg') &&
				(t._polyfill.canPlayType.push('.ogg'),
				t._polyfill.canPlayType.push('.ogv')),
			e.canPlayType('video/mp4') && t._polyfill.canPlayType.push('.mp4'),
			e.canPlayType('video/webm') &&
				t._polyfill.canPlayType.push('.webm'),
			cc.sys.OS_IOS === cc.sys.os &&
				((t._polyfill.devicePixelRatio = !0),
				(t._polyfill.event = 'progress')),
			cc.sys.browserType === cc.sys.BROWSER_TYPE_FIREFOX &&
				(t._polyfill.autoplayAfterOperation = !0),
			((t = document.createElement('style')).innerHTML =
				'.cocosVideo:-moz-full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:-webkit-full-screen{transform:matrix(1,0,0,1,0,0) !important;}'),
			document.head.appendChild(t);
	})(ccui.VideoPlayer),
	(function (l) {
		var e = null,
			e =
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? cc.Node.WebGLRenderCmd
					: cc.Node.CanvasRenderCmd;
		ccui.VideoPlayer.RenderCmd = function (t) {
			e.call(this, t),
				(this._listener = null),
				(this._url = ''),
				this.initStyle();
		};
		var t = (ccui.VideoPlayer.RenderCmd.prototype = Object.create(
			e.prototype
		));
		(t.constructor = ccui.VideoPlayer.RenderCmd),
			(t.visit = function () {
				var t = this,
					e = cc.container,
					i = cc.eventManager;
				this._node._visible
					? (e.appendChild(this._video),
					  null === this._listener &&
							(this._listener = cc.eventManager.addCustomListener(
								cc.game.EVENT_RESIZE,
								function () {
									t.resize();
								}
							)))
					: (('contains' in e
							? e.contains(this._video)
							: e.compareDocumentPosition(this._video) % 16) &&
							e.removeChild(this._video),
					  i.removeListener(this._listener),
					  (this._listener = null)),
					this.updateStatus();
			}),
			(t.transform = function (t, e) {
				this.originTransform(t, e),
					this.updateMatrix(
						this._worldTransform,
						cc.view._scaleX,
						cc.view._scaleY
					);
			}),
			(t.updateStatus = function () {
				l.devicePixelRatio = cc.view.isRetinaEnabled();
				var t = cc.Node._dirtyFlags,
					e = this._dirtyFlag;
				e & t.transformDirty &&
					(this.transform(this.getParentRenderCmd(), !0),
					this.updateMatrix(
						this._worldTransform,
						cc.view._scaleX,
						cc.view._scaleY
					),
					(this._dirtyFlag =
						(this._dirtyFlag & cc.Node._dirtyFlags.transformDirty) ^
						this._dirtyFlag)),
					e & t.orderDirty &&
						(this._dirtyFlag =
							(this._dirtyFlag & t.orderDirty) ^ this._dirtyFlag);
			}),
			(t.resize = function (t) {
				t = t || cc.view;
				var e = this._node,
					i = cc.eventManager;
				e._parent && e._visible
					? this.updateMatrix(
							this._worldTransform,
							t._scaleX,
							t._scaleY
					  )
					: (i.removeListener(this._listener),
					  (this._listener = null));
			}),
			(t.updateMatrix = function (t, e, i) {
				var n,
					r,
					o = this._node;
				l.devicePixelRatio &&
					((e /= r = cc.view.getDevicePixelRatio()), (i /= r)),
					!1 !== this._loaded &&
						((n = o._contentSize.width),
						(r = o._contentSize.height),
						(i =
							'matrix(' +
							t.a * e +
							',' +
							t.b +
							',' +
							t.c +
							',' +
							t.d * i +
							',' +
							(t.tx * e - n / 2 + ((n * o._scaleX) / 2) * e) +
							',' +
							-(t.ty * i - r / 2 + ((r * o._scaleY) / 2) * i) +
							')'),
						(this._video.style.transform = i),
						(this._video.style['-webkit-transform'] = i));
			}),
			(t.updateURL = function (t) {
				var e,
					i,
					n,
					r,
					o = this._node;
				if (this._url != t) {
					(this._url = t),
						cc.loader.resPath &&
							!/^http/.test(t) &&
							(t = cc.path.join(cc.loader.resPath, t)),
						('contains' in (n = cc.container)
							? n.contains(this._video)
							: n.compareDocumentPosition(this._video) % 16) &&
							n.removeChild(this._video),
						(this._video = document.createElement('video')),
						(i = this._video),
						this.bindEvent();
					var s = this,
						c = function () {
							1 != s._loaded &&
								((s._loaded = !0),
								s.changeSize(),
								s.setDirtyFlag(
									cc.Node._dirtyFlags.transformDirty
								),
								i.removeEventListener(l.event, c),
								(i.currentTime = 0),
								(i.style.visibility = 'visible'),
								i.play(),
								o._played || (i.pause(), (i.currentTime = 0)));
						};
					i.addEventListener(l.event, c),
						(i.preload = 'metadata'),
						(i.style.visibility = 'hidden'),
						(this._loaded = !1),
						(o._played = !1),
						(o._playing = !1),
						(o._stopped = !0),
						this.initStyle(),
						this.visit(),
						((e = document.createElement('source')).src = t),
						i.appendChild(e),
						(r = cc.path.extname(t));
					for (var a = 0; a < l.canPlayType.length; a++)
						r !== l.canPlayType[a] &&
							(((e = document.createElement('source')).src =
								t.replace(r, l.canPlayType[a])),
							i.appendChild(e));
				}
			}),
			(t.bindEvent = function () {
				var t = this,
					e = this._node,
					i = this._video;
				i.addEventListener('ended', function () {
					e._renderCmd.updateMatrix(
						t._worldTransform,
						cc.view._scaleX,
						cc.view._scaleY
					),
						(e._playing = !1),
						e._dispatchEvent(ccui.VideoPlayer.EventType.COMPLETED);
				}),
					i.addEventListener('play', function () {
						e._dispatchEvent(ccui.VideoPlayer.EventType.PLAYING);
					}),
					i.addEventListener('pause', function () {
						e._dispatchEvent(ccui.VideoPlayer.EventType.PAUSED);
					});
			}),
			(t.initStyle = function () {
				var t;
				this._video &&
					(((t = this._video).style.position = 'absolute'),
					(t.style.bottom = '0px'),
					(t.style.left = '0px'),
					(t.className = 'cocosVideo'));
			}),
			(t.changeSize = function (t, e) {
				var i = this._node._contentSize;
				(t = t || i.width), (e = e || i.height);
				i = this._video;
				i && (0 !== t && (i.width = t), 0 !== e && (i.height = e));
			}),
			(t.removeDom = function () {
				var t = this._video;
				!t ||
					(('contains' in cc.container
						? cc.container.contains(t)
						: cc.container.compareDocumentPosition(t) % 16) &&
						cc.container.removeChild(t));
			});
	})(ccui.VideoPlayer._polyfill),
	(ccui.WebView = ccui.Widget.extend({
		ctor: function (t) {
			ccui.Widget.prototype.ctor.call(this),
				(this._EventList = {}),
				t && this.loadURL(t);
		},
		setJavascriptInterfaceScheme: function (t) {},
		loadData: function (t, e, i, n) {},
		loadHTMLString: function (t, e) {},
		loadURL: function (t) {
			this._renderCmd.updateURL(t),
				this._dispatchEvent(ccui.WebView.EventType.LOADING);
		},
		stopLoading: function () {
			cc.log('Web does not support loading');
		},
		reload: function () {
			var t = this._renderCmd._iframe;
			!t || ((t = t.contentWindow) && t.location && t.location.reload());
		},
		canGoBack: function () {
			return cc.log('Web does not support query history'), !0;
		},
		canGoForward: function () {
			return cc.log('Web does not support query history'), !0;
		},
		goBack: function () {
			try {
				if (ccui.WebView._polyfill.closeHistory)
					return cc.log(
						'The current browser does not support the GoBack'
					);
				var t = this._renderCmd._iframe;
				if (t) {
					var e = t.contentWindow;
					if (e && e.location)
						try {
							e.history.back.call(e);
						} catch (t) {
							e.history.back();
						}
				}
			} catch (t) {
				cc.log(t);
			}
		},
		goForward: function () {
			try {
				if (ccui.WebView._polyfill.closeHistory)
					return cc.log(
						'The current browser does not support the GoForward'
					);
				var t = this._renderCmd._iframe;
				if (t) {
					var e = t.contentWindow;
					if (e && e.location)
						try {
							e.history.forward.call(e);
						} catch (t) {
							e.history.forward();
						}
				}
			} catch (t) {
				cc.log(t);
			}
		},
		evaluateJS: function (t) {
			var e = this._renderCmd._iframe;
			if (e) {
				var i = e.contentWindow;
				try {
					i.eval(t),
						this._dispatchEvent(
							ccui.WebView.EventType.JS_EVALUATED
						);
				} catch (t) {
					console.error(t);
				}
			}
		},
		setScalesPageToFit: function () {
			cc.log('Web does not support zoom');
		},
		setEventListener: function (t, e) {
			this._EventList[t] = e;
		},
		removeEventListener: function (t) {
			this._EventList[t] = null;
		},
		_dispatchEvent: function (t) {
			t = this._EventList[t];
			t && t.call(this, this, this._renderCmd._iframe.src);
		},
		_createRenderCmd: function () {
			return new ccui.WebView.RenderCmd(this);
		},
		setContentSize: function (t, e) {
			ccui.Widget.prototype.setContentSize.call(this, t, e),
				void 0 === e && ((e = t.height), (t = t.width)),
				this._renderCmd.changeSize(t, e);
		},
		cleanup: function () {
			this._renderCmd.removeDom(),
				this.stopAllActions(),
				this.unscheduleAllCallbacks();
		},
	})),
	(ccui.WebView.EventType = {
		LOADING: 'loading',
		LOADED: 'load',
		ERROR: 'error',
		JS_EVALUATED: 'js',
	}),
	(function () {
		var t = (ccui.WebView._polyfill = {
			devicePixelRatio: !1,
			enableDiv: !1,
		});
		cc.sys.os === cc.sys.OS_IOS && (t.enableDiv = !0),
			cc.sys.isMobile
				? cc.sys.browserType === cc.sys.BROWSER_TYPE_FIREFOX &&
				  (t.enableBG = !0)
				: cc.sys.browserType === cc.sys.BROWSER_TYPE_IE &&
				  (t.closeHistory = !0);
	})(),
	(function (s) {
		var e = null,
			e =
				cc._renderType === cc.game.RENDER_TYPE_WEBGL
					? cc.Node.WebGLRenderCmd
					: cc.Node.CanvasRenderCmd;
		ccui.WebView.RenderCmd = function (t) {
			e.call(this, t),
				(this._div = null),
				(this._iframe = null),
				s.enableDiv
					? ((this._div = document.createElement('div')),
					  (this._div.style['-webkit-overflow'] = 'auto'),
					  (this._div.style['-webkit-overflow-scrolling'] = 'touch'),
					  (this._iframe = document.createElement('iframe')),
					  (this._iframe.style.width = '100%'),
					  (this._iframe.style.height = '100%'),
					  this._div.appendChild(this._iframe))
					: (this._div = this._iframe =
							document.createElement('iframe')),
				s.enableBG && (this._div.style.background = '#FFF'),
				this._iframe.addEventListener('load', function () {
					t._dispatchEvent(ccui.WebView.EventType.LOADED);
				}),
				this._iframe.addEventListener('error', function () {
					t._dispatchEvent(ccui.WebView.EventType.ERROR);
				}),
				(this._div.style.background = '#FFF'),
				(this._div.style.height = '200px'),
				(this._div.style.width = '300px'),
				(this._div.style.overflow = 'scroll'),
				(this._listener = null),
				this.initStyle();
		};
		var t = (ccui.WebView.RenderCmd.prototype = Object.create(e.prototype));
		(t.constructor = ccui.WebView.RenderCmd),
			(t.transform = function (t, e) {
				this.originTransform(t, e),
					this.updateMatrix(
						this._worldTransform,
						cc.view._scaleX,
						cc.view._scaleY
					);
			}),
			(t.updateStatus = function () {
				s.devicePixelRatio = cc.view.isRetinaEnabled();
				var t = cc.Node._dirtyFlags,
					e = this._dirtyFlag;
				e & t.transformDirty &&
					(this.transform(this.getParentRenderCmd(), !0),
					this.updateMatrix(
						this._worldTransform,
						cc.view._scaleX,
						cc.view._scaleY
					),
					(this._dirtyFlag =
						(this._dirtyFlag & cc.Node._dirtyFlags.transformDirty) ^
						this._dirtyFlag)),
					e & t.orderDirty &&
						(this._dirtyFlag =
							(this._dirtyFlag & t.orderDirty) ^ this._dirtyFlag);
			}),
			(t.visit = function () {
				var t = this,
					e = cc.container,
					i = cc.eventManager;
				this._node._visible
					? (e.appendChild(this._div),
					  null === this._listener &&
							(this._listener = i.addCustomListener(
								cc.game.EVENT_RESIZE,
								function () {
									t.resize();
								}
							)))
					: (('contains' in e
							? e.contains(this._div)
							: e.compareDocumentPosition(this._div) % 16) &&
							e.removeChild(this._div),
					  (e =
							i._listenersMap[
								cc.game.EVENT_RESIZE
							].getFixedPriorityListeners()),
					  i._removeListenerInVector(e, this._listener),
					  (this._listener = null)),
					this.updateStatus(),
					this.resize(cc.view);
			}),
			(t.resize = function (t) {
				t = t || cc.view;
				var e = this._node,
					i = cc.eventManager;
				e._parent && e._visible
					? this.updateMatrix(
							this._worldTransform,
							t._scaleX,
							t._scaleY
					  )
					: ((t =
							i._listenersMap[
								cc.game.EVENT_RESIZE
							].getFixedPriorityListeners()),
					  i._removeListenerInVector(t, this._listener),
					  (this._listener = null));
			}),
			(t.updateMatrix = function (t, e, i) {
				var n,
					r,
					o = this._node;
				s.devicePixelRatio &&
					1 !== e &&
					1 !== e &&
					((e /= r = cc.view.getDevicePixelRatio()), (i /= r)),
					!1 !== this._loaded &&
						((n = o._contentSize.width),
						(r = o._contentSize.height),
						(i =
							'matrix(' +
							t.a * e +
							',' +
							t.b +
							',' +
							t.c +
							',' +
							t.d * i +
							',' +
							(t.tx * e - n / 2 + ((n * o._scaleX) / 2) * e) +
							',' +
							-(t.ty * i - r / 2 + ((r * o._scaleY) / 2) * i) +
							')'),
						(this._div.style.transform = i),
						(this._div.style['-webkit-transform'] = i));
			}),
			(t.initStyle = function () {
				var t;
				this._div &&
					(((t = this._div).style.position = 'absolute'),
					(t.style.bottom = '0px'),
					(t.style.left = '0px'));
			}),
			(t.updateURL = function (t) {
				var e = this._iframe;
				e.src = t;
				var i = this,
					n = function () {
						(i._loaded = !0), e.removeEventListener('load', n);
					};
				e.addEventListener('load', n);
			}),
			(t.changeSize = function (t, e) {
				var i = this._div;
				i && ((i.style.width = t + 'px'), (i.style.height = e + 'px'));
			}),
			(t.removeDom = function () {
				var t = this._div;
				!t ||
					(('contains' in cc.container
						? cc.container.contains(t)
						: cc.container.compareDocumentPosition(t) % 16) &&
						cc.container.removeChild(t));
			});
	})(ccui.WebView._polyfill),
	(cc.Component = cc.Class.extend({
		_owner: null,
		_name: '',
		_enabled: !0,
		ctor: function () {
			(this._owner = null), (this._name = ''), (this._enabled = !0);
		},
		init: function () {
			return !0;
		},
		onEnter: function () {},
		onExit: function () {},
		update: function (t) {},
		serialize: function (t) {},
		isEnabled: function () {
			return this._enabled;
		},
		setEnabled: function (t) {
			this._enabled = t;
		},
		getName: function () {
			return this._name;
		},
		setName: function (t) {
			this._name = t;
		},
		setOwner: function (t) {
			this._owner = t;
		},
		getOwner: function () {
			return this._owner;
		},
	})),
	(cc.Component.create = function () {
		return new cc.Component();
	}),
	(ccui.LayoutComponent_ReferencePoint = {
		BOTTOM_LEFT: 0,
		TOP_LEFT: 1,
		BOTTOM_RIGHT: 2,
		TOP_RIGHT: 3,
	}),
	(ccui.LayoutComponent_PositionType = {
		Position: 0,
		RelativePosition: 1,
		PreRelativePosition: 2,
		PreRelativePositionEnable: 3,
	}),
	(ccui.LayoutComponent_SizeType = { Size: 0, PreSize: 1, PreSizeEnable: 2 }),
	(ccui.LayoutComponent = cc.Component.extend({
		_horizontalEdge: 0,
		_verticalEdge: 0,
		_leftMargin: 0,
		_rightMargin: 0,
		_bottomMargin: 0,
		_topMargin: 0,
		_usingPositionPercentX: !1,
		_positionPercentX: 0,
		_usingPositionPercentY: !1,
		_positionPercentY: 0,
		_usingStretchWidth: !1,
		_usingStretchHeight: !1,
		_percentWidth: 0,
		_usingPercentWidth: !1,
		_percentHeight: 0,
		_usingPercentHeight: !1,
		_actived: !0,
		_isPercentOnly: !1,
		ctor: function () {
			this._name = ccui.LayoutComponent.NAME;
		},
		init: function () {
			return !!cc.Component.prototype.init.call(this);
		},
		getPercentContentSize: function () {
			return cc.p(this._percentWidth, this._percentHeight);
		},
		setPercentContentSize: function (t) {
			this.setPercentWidth(t.x), this.setPercentHeight(t.y);
		},
		setUsingPercentContentSize: function (t) {
			this._usingPercentWidth = this._usingPercentHeight = t;
		},
		SetActiveEnable: function (t) {
			this._actived = t;
		},
		getUsingPercentContentSize: function () {
			return this._usingPercentWidth && this._usingPercentHeight;
		},
		getAnchorPosition: function () {
			return this._owner.getAnchorPoint();
		},
		setAnchorPosition: function (t, e) {
			var i = this._owner.getBoundingBox();
			this._owner.setAnchorPoint(t, e);
			(t = this._owner.getBoundingBox()),
				(e = i.x - t.x),
				(i = i.y - t.y),
				(t = this._owner.getPosition());
			(t.x += e), (t.y += i), this.setPosition(t);
		},
		getPosition: function () {
			return this._owner.getPosition();
		},
		setPosition: function (t, e) {
			var i,
				n = this._getOwnerParent();
			null != n
				? (void 0 === e ? ((i = t.x), (e = t.y)) : (i = t),
				  0 !== (n = n.getContentSize()).width
						? (this._positionPercentX = i / n.width)
						: ((this._positionPercentX = 0),
						  this._usingPositionPercentX && (i = 0)),
				  0 !== n.height
						? (this._positionPercentY = e / n.height)
						: ((this._positionPercentY = 0),
						  this._usingPositionPercentY && (e = 0)),
				  this._owner.setPosition(i, e),
				  this._refreshHorizontalMargin(),
				  this._refreshVerticalMargin())
				: this._owner.setPosition(t, e);
		},
		isPositionPercentXEnabled: function () {
			return this._usingPositionPercentX;
		},
		setPositionPercentXEnabled: function (t) {
			(this._usingPositionPercentX = t),
				this._usingPositionPercentX &&
					(this._horizontalEdge =
						ccui.LayoutComponent.horizontalEdge.NONE);
		},
		getPositionPercentX: function () {
			return this._positionPercentX;
		},
		setPositionPercentX: function (t) {
			this._positionPercentX = t;
			t = this._getOwnerParent();
			null !== t &&
				(this._owner.setPositionX(t.width * this._positionPercentX),
				this._refreshHorizontalMargin());
		},
		isPositionPercentYEnabled: function () {
			return this._usingPositionPercentY;
		},
		setPositionPercentYEnabled: function (t) {
			(this._usingPositionPercentY = t),
				this._usingPositionPercentY &&
					(this._verticalEdge =
						ccui.LayoutComponent.verticalEdge.NONE);
		},
		getPositionPercentY: function () {
			return this._positionPercentY;
		},
		setPositionPercentY: function (t) {
			this._positionPercentY = t;
			t = this._getOwnerParent();
			null !== t &&
				(this._owner.setPositionY(t.height * this._positionPercentY),
				this._refreshVerticalMargin());
		},
		getHorizontalEdge: function () {
			return this._horizontalEdge;
		},
		setHorizontalEdge: function (t) {
			(this._horizontalEdge = t),
				this._horizontalEdge !==
					ccui.LayoutComponent.horizontalEdge.NONE &&
					(this._usingPositionPercentX = !1);
			var e = this._getOwnerParent();
			null !== e &&
				((t = this._owner.getPosition()),
				0 !== (e = e.getContentSize()).width
					? (this._positionPercentX = t.x / e.width)
					: ((this._positionPercentX = 0),
					  (t.x = 0),
					  this._usingPositionPercentX &&
							this._owner.setPosition(t)),
				this._refreshHorizontalMargin());
		},
		getVerticalEdge: function () {
			return this._verticalEdge;
		},
		setVerticalEdge: function (t) {
			(this._verticalEdge = t),
				this._verticalEdge !== ccui.LayoutComponent.verticalEdge.NONE &&
					(this._usingPositionPercentY = !1);
			var e = this._getOwnerParent();
			null !== e &&
				((t = this._owner.getPosition()),
				0 !== (e = e.getContentSize()).height
					? (this._positionPercentY = t.y / e.height)
					: ((this._positionPercentY = 0),
					  (t.y = 0),
					  this._usingPositionPercentY &&
							this._owner.setPosition(t)),
				this._refreshVerticalMargin());
		},
		getLeftMargin: function () {
			return this._leftMargin;
		},
		setLeftMargin: function (t) {
			this._leftMargin = t;
		},
		getRightMargin: function () {
			return this._rightMargin;
		},
		setRightMargin: function (t) {
			this._rightMargin = t;
		},
		getTopMargin: function () {
			return this._topMargin;
		},
		setTopMargin: function (t) {
			this._topMargin = t;
		},
		getBottomMargin: function () {
			return this._bottomMargin;
		},
		setBottomMargin: function (t) {
			this._bottomMargin = t;
		},
		getSize: function () {
			return this.getOwner().getContentSize();
		},
		setSize: function (t) {
			var e,
				i = this._getOwnerParent();
			null !== i
				? ((e = t),
				  0 !== (i = i.getContentSize()).width
						? (this._percentWidth = e.width / i.width)
						: ((this._percentWidth = 0),
						  this._usingPercentWidth && (e.width = 0)),
				  0 !== i.height
						? (this._percentHeight = e.height / i.height)
						: ((this._percentHeight = 0),
						  this._usingPercentHeight && (e.height = 0)),
				  this._owner.setContentSize(e),
				  this._refreshHorizontalMargin(),
				  this._refreshVerticalMargin())
				: this._owner.setContentSize(t);
		},
		isPercentWidthEnabled: function () {
			return this._usingPercentWidth;
		},
		setPercentWidthEnabled: function (t) {
			(this._usingPercentWidth = t),
				this._usingPercentWidth && (this._usingStretchWidth = !1);
		},
		getSizeWidth: function () {
			return this._owner.width;
		},
		setSizeWidth: function (t) {
			var e = this._owner.getContentSize();
			e.width = t;
			t = this._getOwnerParent();
			null !== t
				? (0 !== (t = t.getContentSize()).width
						? (this._percentWidth = e.width / t.width)
						: ((this._percentWidth = 0),
						  this._usingPercentWidth && (e.width = 0)),
				  this._owner.setContentSize(e),
				  this._refreshHorizontalMargin())
				: this._owner.setContentSize(e);
		},
		getPercentWidth: function () {
			return this._percentWidth;
		},
		setPercentWidth: function (t) {
			this._percentWidth = t;
			var e = this._getOwnerParent();
			null !== e &&
				(((t = this._owner.getContentSize()).width =
					e.width * this._percentWidth),
				this._owner.setContentSize(t),
				this._refreshHorizontalMargin());
		},
		isPercentHeightEnabled: function () {
			return this._usingPercentHeight;
		},
		setPercentHeightEnabled: function (t) {
			(this._usingPercentHeight = t),
				this._usingPercentHeight && (this._usingStretchHeight = !1);
		},
		getSizeHeight: function () {
			return this._owner.height;
		},
		setSizeHeight: function (t) {
			var e = this._owner.getContentSize();
			e.height = t;
			t = this._getOwnerParent();
			null !== t
				? (0 !== (t = t.getContentSize()).height
						? (this._percentHeight = e.height / t.height)
						: ((this._percentHeight = 0),
						  this._usingPercentHeight && (e.height = 0)),
				  this._owner.setContentSize(e),
				  this._refreshVerticalMargin())
				: this._owner.setContentSize(e);
		},
		getPercentHeight: function () {
			return this._percentHeight;
		},
		setPercentHeight: function (t) {
			this._percentHeight = t;
			var e = this._getOwnerParent();
			null !== e &&
				(((t = this._owner.getContentSize()).height =
					e.height * this._percentHeight),
				this._owner.setContentSize(t),
				this._refreshVerticalMargin());
		},
		isStretchWidthEnabled: function () {
			return this._usingStretchWidth;
		},
		setStretchWidthEnabled: function (t) {
			(this._usingStretchWidth = t),
				this._usingStretchWidth && (this._usingPercentWidth = !1);
		},
		isStretchHeightEnabled: function () {
			return this._usingStretchHeight;
		},
		setStretchHeightEnabled: function (t) {
			(this._usingStretchHeight = t),
				this._usingStretchHeight && (this._usingPercentHeight = !1);
		},
		setPercentOnlyEnabled: function (t) {
			this._isPercentOnly = t;
		},
		setActiveEnabled: function (t) {
			this._actived = t;
		},
		refreshLayout: function () {
			if (this._actived) {
				var t = this._getOwnerParent();
				if (null !== t) {
					var e = t.getContentSize(),
						t = this._owner,
						i = t.getAnchorPoint(),
						n = t.getContentSize(),
						r = t.getPosition();
					switch (this._horizontalEdge) {
						case ccui.LayoutComponent.horizontalEdge.NONE:
							this._usingStretchWidth && !this._isPercentOnly
								? ((n.width = e.width * this._percentWidth),
								  (r.x = this._leftMargin + i.x * n.width))
								: (this._usingPositionPercentX &&
										(r.x =
											e.width * this._positionPercentX),
								  this._usingPercentWidth &&
										(n.width =
											e.width * this._percentWidth));
							break;
						case ccui.LayoutComponent.horizontalEdge.LEFT:
							if (this._isPercentOnly) break;
							(this._usingPercentWidth ||
								this._usingStretchWidth) &&
								(n.width = e.width * this._percentWidth),
								(r.x = this._leftMargin + i.x * n.width);
							break;
						case ccui.LayoutComponent.horizontalEdge.RIGHT:
							if (this._isPercentOnly) break;
							(this._usingPercentWidth ||
								this._usingStretchWidth) &&
								(n.width = e.width * this._percentWidth),
								(r.x =
									e.width -
									(this._rightMargin + (1 - i.x) * n.width));
							break;
						case ccui.LayoutComponent.horizontalEdge.CENTER:
							if (this._isPercentOnly) break;
							this._usingStretchWidth
								? ((n.width =
										e.width -
										this._leftMargin -
										this._rightMargin),
								  n.width < 0 && (n.width = 0),
								  (r.x = this._leftMargin + i.x * n.width))
								: (this._usingPercentWidth &&
										(n.width =
											e.width * this._percentWidth),
								  (r.x = e.width * this._positionPercentX));
					}
					switch (this._verticalEdge) {
						case ccui.LayoutComponent.verticalEdge.NONE:
							this._usingStretchHeight && !this._isPercentOnly
								? ((n.height = e.height * this._percentHeight),
								  (r.y = this._bottomMargin + i.y * n.height))
								: (this._usingPositionPercentY &&
										(r.y =
											e.height * this._positionPercentY),
								  this._usingPercentHeight &&
										(n.height =
											e.height * this._percentHeight));
							break;
						case ccui.LayoutComponent.verticalEdge.BOTTOM:
							if (this._isPercentOnly) break;
							(this._usingPercentHeight ||
								this._usingStretchHeight) &&
								(n.height = e.height * this._percentHeight),
								(r.y = this._bottomMargin + i.y * n.height);
							break;
						case ccui.LayoutComponent.verticalEdge.TOP:
							if (this._isPercentOnly) break;
							(this._usingPercentHeight ||
								this._usingStretchHeight) &&
								(n.height = e.height * this._percentHeight),
								(r.y =
									e.height -
									(this._topMargin + (1 - i.y) * n.height));
							break;
						case ccui.LayoutComponent.verticalEdge.CENTER:
							if (this._isPercentOnly) break;
							this._usingStretchHeight
								? ((n.height =
										e.height -
										this._topMargin -
										this._bottomMargin),
								  n.height < 0 && (n.height = 0),
								  (r.y = this._bottomMargin + i.y * n.height))
								: (this._usingPercentHeight &&
										(n.height =
											e.height * this._percentHeight),
								  (r.y = e.height * this._positionPercentY));
					}
					if (
						(t.setPosition(r),
						t.setContentSize(n),
						t instanceof ccui.PageView)
					) {
						t.forceDoLayout();
						for (var o = t.getPages(), s = 0; s < o.length; s++)
							ccui.helper.doLayout(o[s]);
					} else ccui.helper.doLayout(t);
				}
			}
		},
		_getOwnerParent: function () {
			return this._owner ? this._owner.getParent() : null;
		},
		_refreshHorizontalMargin: function () {
			var t,
				e,
				i,
				n = this._getOwnerParent();
			null !== n &&
				((t = this._owner.getPosition()),
				(e = this._owner.getAnchorPoint()),
				(i = this._owner.getContentSize()),
				(n = n.getContentSize()),
				(this._leftMargin = t.x - e.x * i.width),
				(this._rightMargin = n.width - (t.x + (1 - e.x) * i.width)));
		},
		_refreshVerticalMargin: function () {
			var t,
				e,
				i,
				n = this._getOwnerParent();
			null !== n &&
				((t = this._owner.getPosition()),
				(e = this._owner.getAnchorPoint()),
				(i = this._owner.getContentSize()),
				(n = n.getContentSize()),
				(this._bottomMargin = t.y - e.y * i.height),
				(this._topMargin = n.height - (t.y + (1 - e.y) * i.height)));
		},
	})),
	(ccui.LayoutComponent.horizontalEdge = {
		NONE: 0,
		LEFT: 1,
		RIGHT: 2,
		CENTER: 3,
	}),
	(ccui.LayoutComponent.verticalEdge = {
		NONE: 0,
		BOTTOM: 1,
		TOP: 2,
		CENTER: 3,
	}),
	(ccui.LayoutComponent.NAME = '__ui_layout'),
	(ccui.LayoutComponent.bindLayoutComponent = function (t) {
		var e = t.getComponent(ccui.LayoutComponent.NAME);
		return (
			void 0 !== e ||
				((e = new ccui.LayoutComponent()).init(),
				t.addComponent(e),
				t instanceof ccui.Widget ||
					(t.addEventListener &&
						t.addEventListener(
							'load',
							function () {
								e.refreshLayout();
							},
							this
						))),
			e
		);
	}),
	(cc.ComponentContainer = cc.Class.extend({
		_components: null,
		_owner: null,
		ctor: function (t) {
			(this._components = null), (this._owner = t);
		},
		getComponent: function (t) {
			if (!t)
				throw new Error(
					'cc.ComponentContainer.getComponent(): name should be non-null'
				);
			return (
				(t = t.trim()),
				this._components || (this._components = {}),
				this._components[t]
			);
		},
		add: function (t) {
			if (!t)
				throw new Error(
					'cc.ComponentContainer.add(): component should be non-null'
				);
			return t.getOwner()
				? (cc.log(
						"cc.ComponentContainer.add(): Component already added. It can't be added again"
				  ),
				  !1)
				: (null == this._components &&
						((this._components = {}), this._owner.scheduleUpdate()),
				  this._components[t.getName()]
						? (cc.log(
								"cc.ComponentContainer.add(): Component already added. It can't be added again"
						  ),
						  !1)
						: (t.setOwner(this._owner),
						  (this._components[t.getName()] = t).onEnter(),
						  !0));
		},
		remove: function (t) {
			if (!t)
				throw new Error(
					'cc.ComponentContainer.remove(): name should be non-null'
				);
			return (
				!!this._components &&
				(t instanceof cc.Component
					? this._removeByComponent(t)
					: ((t = t.trim()),
					  this._removeByComponent(this._components[t])))
			);
		},
		_removeByComponent: function (t) {
			return (
				!!t &&
				(t.onExit(),
				t.setOwner(null),
				delete this._components[t.getName()],
				!0)
			);
		},
		removeAll: function () {
			if (this._components) {
				var t,
					e = this._components;
				for (t in e) {
					var i = e[t];
					i.onExit(), i.setOwner(null), delete e[t];
				}
				this._owner.unscheduleUpdate(), (this._components = null);
			}
		},
		_alloc: function () {
			this._components = {};
		},
		visit: function (t) {
			if (this._components) {
				var e,
					i = this._components;
				for (e in i) i[e].update(t);
			}
		},
		isEmpty: function () {
			return !this._components || 0 === this._components.length;
		},
	}));
var ccs = ccs || {};
(ccs.Class = ccs.Class || cc.Class),
	(ccs.Class.extend = ccs.Class.extend || cc.Class.extend),
	(ccs.Node = ccs.Node || cc.Node),
	(ccs.Node.extend = ccs.Node.extend || cc.Node.extend),
	(ccs.Sprite = ccs.Sprite || cc.Sprite),
	(ccs.Sprite.extend = ccs.Sprite.extend || cc.Sprite.extend),
	(ccs.Component = ccs.Component || cc.Component),
	(ccs.Component.extend = ccs.Component.extend || cc.Component.extend),
	(ccs.cocostudioVersion = 'v1.3.0.0'),
	(ccs.VERSION_COMBINED = 0.3),
	(ccs.VERSION_CHANGE_ROTATION_RANGE = 1),
	(ccs.VERSION_COLOR_READING = 1.1),
	(ccs.MAX_VERTEXZ_VALUE = 5e6),
	(ccs.ARMATURE_MAX_CHILD = 50),
	(ccs.ARMATURE_MAX_ZORDER = 100),
	(ccs.ARMATURE_MAX_COUNT =
		ccs.MAX_VERTEXZ_VALUE /
		ccs.ARMATURE_MAX_CHILD /
		ccs.ARMATURE_MAX_ZORDER),
	(ccs.AUTO_ADD_SPRITE_FRAME_NAME_PREFIX = !1),
	(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT = !1),
	(ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX = !1),
	(ccs.armatureVersion = function () {
		return 'v1.1.0.0';
	}),
	(ccs.CONST_VERSION = 'version'),
	(ccs.CONST_VERSION_2_0 = 2),
	(ccs.CONST_VERSION_COMBINED = 0.3),
	(ccs.CONST_ARMATURES = 'armatures'),
	(ccs.CONST_ARMATURE = 'armature'),
	(ccs.CONST_BONE = 'b'),
	(ccs.CONST_DISPLAY = 'd'),
	(ccs.CONST_ANIMATIONS = 'animations'),
	(ccs.CONST_ANIMATION = 'animation'),
	(ccs.CONST_MOVEMENT = 'mov'),
	(ccs.CONST_FRAME = 'f'),
	(ccs.CONST_TEXTURE_ATLAS = 'TextureAtlas'),
	(ccs.CONST_SUB_TEXTURE = 'SubTexture'),
	(ccs.CONST_SKELETON = 'skeleton'),
	(ccs.CONST_A_NAME = 'name'),
	(ccs.CONST_A_DURATION = 'dr'),
	(ccs.CONST_A_FRAME_INDEX = 'fi'),
	(ccs.CONST_A_DURATION_TO = 'to'),
	(ccs.CONST_A_DURATION_TWEEN = 'drTW'),
	(ccs.CONST_A_LOOP = 'lp'),
	(ccs.CONST_A_MOVEMENT_SCALE = 'sc'),
	(ccs.CONST_A_MOVEMENT_DELAY = 'dl'),
	(ccs.CONST_A_DISPLAY_INDEX = 'dI'),
	(ccs.CONST_A_PLIST = 'plist'),
	(ccs.CONST_A_PARENT = 'parent'),
	(ccs.CONST_A_SKEW_X = 'kX'),
	(ccs.CONST_A_SKEW_Y = 'kY'),
	(ccs.CONST_A_SCALE_X = 'cX'),
	(ccs.CONST_A_SCALE_Y = 'cY'),
	(ccs.CONST_A_Z = 'z'),
	(ccs.CONST_A_EVENT = 'evt'),
	(ccs.CONST_A_SOUND = 'sd'),
	(ccs.CONST_A_SOUND_EFFECT = 'sdE'),
	(ccs.CONST_A_TWEEN_EASING = 'twE'),
	(ccs.CONST_A_EASING_PARAM = 'twEP'),
	(ccs.CONST_A_TWEEN_ROTATE = 'twR'),
	(ccs.CONST_A_IS_ARMATURE = 'isArmature'),
	(ccs.CONST_A_DISPLAY_TYPE = 'displayType'),
	(ccs.CONST_A_MOVEMENT = 'mov'),
	(ccs.CONST_A_X = 'x'),
	(ccs.CONST_A_Y = 'y'),
	(ccs.CONST_A_COCOS2DX_X = 'cocos2d_x'),
	(ccs.CONST_A_COCOS2DX_Y = 'cocos2d_y'),
	(ccs.CONST_A_WIDTH = 'width'),
	(ccs.CONST_A_HEIGHT = 'height'),
	(ccs.CONST_A_PIVOT_X = 'pX'),
	(ccs.CONST_A_PIVOT_Y = 'pY'),
	(ccs.CONST_A_COCOS2D_PIVOT_X = 'cocos2d_pX'),
	(ccs.CONST_A_COCOS2D_PIVOT_Y = 'cocos2d_pY'),
	(ccs.CONST_A_BLEND_TYPE = 'bd'),
	(ccs.CONST_A_BLEND_SRC = 'bd_src'),
	(ccs.CONST_A_BLEND_DST = 'bd_dst'),
	(ccs.CONST_A_ALPHA = 'a'),
	(ccs.CONST_A_RED = 'r'),
	(ccs.CONST_A_GREEN = 'g'),
	(ccs.CONST_A_BLUE = 'b'),
	(ccs.CONST_A_ALPHA_OFFSET = 'aM'),
	(ccs.CONST_A_RED_OFFSET = 'rM'),
	(ccs.CONST_A_GREEN_OFFSET = 'gM'),
	(ccs.CONST_A_BLUE_OFFSET = 'bM'),
	(ccs.CONST_A_COLOR_TRANSFORM = 'colorTransform'),
	(ccs.CONST_A_TWEEN_FRAME = 'tweenFrame'),
	(ccs.CONST_CONTOUR = 'con'),
	(ccs.CONST_CONTOUR_VERTEX = 'con_vt'),
	(ccs.CONST_FL_NAN = 'NaN'),
	(ccs.CONST_FRAME_DATA = 'frame_data'),
	(ccs.CONST_MOVEMENT_BONE_DATA = 'mov_bone_data'),
	(ccs.CONST_MOVEMENT_DATA = 'mov_data'),
	(ccs.CONST_ANIMATION_DATA = 'animation_data'),
	(ccs.CONST_DISPLAY_DATA = 'display_data'),
	(ccs.CONST_SKIN_DATA = 'skin_data'),
	(ccs.CONST_BONE_DATA = 'bone_data'),
	(ccs.CONST_ARMATURE_DATA = 'armature_data'),
	(ccs.CONST_CONTOUR_DATA = 'contour_data'),
	(ccs.CONST_TEXTURE_DATA = 'texture_data'),
	(ccs.CONST_VERTEX_POINT = 'vertex'),
	(ccs.CONST_COLOR_INFO = 'color'),
	(ccs.CONST_CONFIG_FILE_PATH = 'config_file_path'),
	(ccs.CONST_CONTENT_SCALE = 'content_scale'),
	(ccs.DataInfo = function () {
		(this.asyncStruct = null),
			(this.configFileQueue = []),
			(this.contentScale = 1),
			(this.filename = ''),
			(this.baseFilePath = ''),
			(this.flashToolVersion = 0),
			(this.cocoStudioVersion = 0);
	}),
	(ccs.dataReaderHelper = {
		ConfigType: {
			DragonBone_XML: 0,
			CocoStudio_JSON: 1,
			CocoStudio_Binary: 2,
		},
		_configFileList: [],
		_flashToolVersion: ccs.CONST_VERSION_2_0,
		_positionReadScale: 1,
		_asyncRefCount: 0,
		_asyncRefTotalCount: 0,
		_dataQueue: null,
		setPositionReadScale: function (t) {
			this._positionReadScale = t;
		},
		getPositionReadScale: function () {
			return this._positionReadScale;
		},
		addDataFromFile: function (t) {
			var e, i, n;
			-1 === this._configFileList.indexOf(t) &&
				(this._configFileList.push(t),
				(e = this._initBaseFilePath(t)),
				(i = cc.path.extname(t).toLowerCase()),
				((n = new ccs.DataInfo()).filename = t),
				(n.basefilePath = e),
				'.xml' === i
					? ccs.dataReaderHelper.addDataFromXML(t, n)
					: '.json' === i || '.exportjson' === i
					? ccs.dataReaderHelper.addDataFromJson(t, n)
					: '.csb' === i &&
					  ccs.dataReaderHelper.addDataFromBinaryCache(t, n));
		},
		addDataFromFileAsync: function (t, e, i, n, r) {
			var o;
			-1 === this._configFileList.indexOf(i)
				? (this._asyncRefTotalCount++,
				  this._asyncRefCount++,
				  (o = this),
				  cc.director.getScheduler().schedule(
						function () {
							o.addDataFromFile(i),
								o._asyncRefCount--,
								o._asyncCallBack(
									n,
									r,
									(o._asyncRefTotalCount - o._asyncRefCount) /
										o._asyncRefTotalCount
								);
						},
						this,
						0.1,
						!1,
						0,
						!1,
						'armatrueDataHelper'
				  ))
				: r &&
				  n &&
				  (0 === this._asyncRefTotalCount && 0 === this._asyncRefCount
						? this._asyncCallBack(n, r, 1)
						: this._asyncCallBack(
								n,
								r,
								(this._asyncRefTotalCount -
									this._asyncRefCount) /
									this._asyncRefTotalCount
						  ));
		},
		removeConfigFile: function (t) {
			for (
				var e = this._configFileList, i = e.length, n = e[i], r = 0;
				r < i;
				r++
			)
				e[r] === t && (n = r);
			n !== e[i] && cc.arrayRemoveObject(e, t);
		},
		addDataFromCache: function (t, e) {
			if (t) {
				e.flashToolVersion = parseFloat(
					t.getAttribute(ccs.CONST_VERSION)
				);
				for (
					var i = t.querySelectorAll(
							ccs.CONST_SKELETON +
								' > ' +
								ccs.CONST_ARMATURES +
								' >  ' +
								ccs.CONST_ARMATURE
						),
						n = ccs.armatureDataManager,
						r = 0;
					r < i.length;
					r++
				) {
					var o = this.decodeArmature(i[r], e);
					n.addArmatureData(o.name, o, e.filename);
				}
				var s = t.querySelectorAll(
					ccs.CONST_SKELETON +
						' > ' +
						ccs.CONST_ANIMATIONS +
						' >  ' +
						ccs.CONST_ANIMATION
				);
				for (r = 0; r < s.length; r++) {
					var c = this.decodeAnimation(s[r], e);
					n.addAnimationData(c.name, c, e.filename);
				}
				var a = t.querySelectorAll(
					ccs.CONST_SKELETON +
						' > ' +
						ccs.CONST_TEXTURE_ATLAS +
						' >  ' +
						ccs.CONST_SUB_TEXTURE
				);
				for (r = 0; r < a.length; r++) {
					var l = this.decodeTexture(a[r], e);
					n.addTextureData(l.name, l, e.filename);
				}
			} else cc.log('XML error  or  XML is empty.');
		},
		decodeArmature: function (t, e) {
			var i = new ccs.ArmatureData();
			i.init(), (i.name = t.getAttribute(ccs.CONST_A_NAME));
			for (
				var n = t.querySelectorAll(
						ccs.CONST_ARMATURE + ' > ' + ccs.CONST_BONE
					),
					r = 0;
				r < n.length;
				r++
			) {
				var o = n[r],
					s = o.getAttribute(ccs.CONST_A_PARENT),
					c = null;
				if (s)
					for (
						var a = 0;
						a < n.length &&
						((c = n[a]), s != n[a].getAttribute(ccs.CONST_A_NAME));
						a++
					);
				o = this.decodeBone(o, c, e);
				i.addBoneData(o);
			}
			return i;
		},
		decodeArmatureFromJSON: function (t, e) {
			var i = new ccs.ArmatureData();
			i.init();
			var n = t[ccs.CONST_A_NAME];
			n && (i.name = n),
				(e.cocoStudioVersion = i.dataVersion =
					t[ccs.CONST_VERSION] || 0.1);
			for (var r = t[ccs.CONST_BONE_DATA], o = 0; o < r.length; o++) {
				var s = this.decodeBoneFromJson(r[o], e);
				i.addBoneData(s);
			}
			return i;
		},
		decodeBone: function (t, e, i) {
			var n = new ccs.BoneData();
			n.init(),
				(n.name = t.getAttribute(ccs.CONST_A_NAME)),
				(n.parentName = t.getAttribute(ccs.CONST_A_PARENT) || ''),
				(n.zOrder = parseInt(t.getAttribute(ccs.CONST_A_Z)) || 0);
			for (
				var r = t.querySelectorAll(
						ccs.CONST_BONE + ' > ' + ccs.CONST_DISPLAY
					),
					o = 0;
				o < r.length;
				o++
			) {
				var s = r[o],
					s = this.decodeBoneDisplay(s, i);
				n.addDisplayData(s);
			}
			return n;
		},
		decodeBoneFromJson: function (t, e) {
			var i = new ccs.BoneData();
			i.init(),
				this.decodeNodeFromJson(i, t, e),
				(i.name = t[ccs.CONST_A_NAME] || ''),
				(i.parentName = t[ccs.CONST_A_PARENT] || '');
			for (
				var n = t[ccs.CONST_DISPLAY_DATA] || [], r = 0;
				r < n.length;
				r++
			) {
				var o = this.decodeBoneDisplayFromJson(n[r], e);
				i.addDisplayData(o);
			}
			return i;
		},
		decodeBoneDisplay: function (t, e) {
			var i = null;
			1 === (parseFloat(t.getAttribute(ccs.CONST_A_IS_ARMATURE)) || 0)
				? ((i = new ccs.ArmatureDisplayData()).displayType =
						ccs.DISPLAY_TYPE_ARMATURE)
				: ((i = new ccs.SpriteDisplayData()).displayType =
						ccs.DISPLAY_TYPE_SPRITE);
			t = t.getAttribute(ccs.CONST_A_NAME) || '';
			return t && (i.displayName = t), i;
		},
		decodeBoneDisplayFromJson: function (t, e) {
			var i = t[ccs.CONST_A_DISPLAY_TYPE] || ccs.DISPLAY_TYPE_SPRITE,
				n = null;
			switch (i) {
				case ccs.DISPLAY_TYPE_SPRITE:
					n = new ccs.SpriteDisplayData();
					null != (s = t[ccs.CONST_A_NAME]) && (n.displayName = s);
					var r,
						o = (t[ccs.CONST_SKIN_DATA] || [])[0];
					o &&
						(((r = n.skinData).x =
							o[ccs.CONST_A_X] * this._positionReadScale),
						(r.y = o[ccs.CONST_A_Y] * this._positionReadScale),
						(r.scaleX =
							null == o[ccs.CONST_A_SCALE_X]
								? 1
								: o[ccs.CONST_A_SCALE_X]),
						(r.scaleY =
							null == o[ccs.CONST_A_SCALE_Y]
								? 1
								: o[ccs.CONST_A_SCALE_Y]),
						(r.skewX =
							null == o[ccs.CONST_A_SKEW_X]
								? 1
								: o[ccs.CONST_A_SKEW_X]),
						(r.skewY =
							null == o[ccs.CONST_A_SKEW_Y]
								? 1
								: o[ccs.CONST_A_SKEW_Y]),
						(r.x *= e.contentScale),
						(r.y *= e.contentScale));
					break;
				case ccs.DISPLAY_TYPE_ARMATURE:
					(n = new ccs.ArmatureDisplayData()),
						null != (s = t[ccs.CONST_A_NAME]) &&
							(n.displayName = t[ccs.CONST_A_NAME]);
					break;
				case ccs.DISPLAY_TYPE_PARTICLE:
					n = new ccs.ParticleDisplayData();
					var s = t[ccs.CONST_A_PLIST];
					null != s &&
						(e.asyncStruct
							? (n.displayName = e.asyncStruct.basefilePath + s)
							: (n.displayName = e.basefilePath + s));
					break;
				default:
					n = new ccs.SpriteDisplayData();
			}
			return (n.displayType = i), n;
		},
		decodeAnimation: function (t, e) {
			var i = new ccs.AnimationData(),
				n = t.getAttribute(ccs.CONST_A_NAME),
				r = ccs.armatureDataManager.getArmatureData(n);
			i.name = n;
			for (
				var o,
					s = t.querySelectorAll(
						ccs.CONST_ANIMATION + ' > ' + ccs.CONST_MOVEMENT
					),
					c = 0;
				c < s.length;
				c++
			) {
				o = s[c];
				var a = this.decodeMovement(o, r, e);
				i.addMovement(a);
			}
			return i;
		},
		decodeAnimationFromJson: function (t, e) {
			var i = new ccs.AnimationData();
			t[ccs.CONST_A_NAME] && (i.name = t[ccs.CONST_A_NAME]);
			for (
				var n = t[ccs.CONST_MOVEMENT_DATA] || [], r = 0;
				r < n.length;
				r++
			) {
				var o = this.decodeMovementFromJson(n[r], e);
				i.addMovement(o);
			}
			return i;
		},
		decodeMovement: function (t, e, i) {
			var n = new ccs.MovementData();
			n.name = t.getAttribute(ccs.CONST_A_NAME);
			var r,
				o = t.getAttribute(ccs.CONST_A_DURATION);
			(n.duration = null == o ? 0 : parseFloat(o)),
				(o = t.getAttribute(ccs.CONST_A_DURATION_TO)),
				(n.durationTo = null == o ? 0 : parseFloat(o)),
				(o = t.getAttribute(ccs.CONST_A_DURATION_TWEEN)),
				(n.durationTween = null == o ? 0 : parseFloat(o)),
				(o = t.getAttribute(ccs.CONST_A_LOOP)),
				(n.loop = !o || Boolean(parseFloat(o)));
			o = t.getAttribute(ccs.CONST_A_TWEEN_EASING);
			o &&
				(o != ccs.CONST_FL_NAN
					? ((r = null == o ? 0 : parseFloat(o)),
					  (n.tweenEasing =
							2 === r ? ccs.TweenType.SINE_EASEINOUT : r))
					: (n.tweenEasing = ccs.TweenType.LINEAR));
			for (
				var s = t.querySelectorAll(
						ccs.CONST_MOVEMENT + ' > ' + ccs.CONST_BONE
					),
					c = null,
					a = 0;
				a < s.length;
				a++
			) {
				var l = (c = s[a]).getAttribute(ccs.CONST_A_NAME);
				if (!n.getMovementBoneData(l)) {
					var l = e.getBoneData(l),
						h = l.parentName,
						u = null;
					if ('' !== h)
						for (
							var _ = 0;
							_ < s.length &&
							h !== (u = s[_]).getAttribute(ccs.CONST_A_NAME);
							_++
						);
					l = this.decodeMovementBone(c, u, l, i);
					n.addMovementBoneData(l);
				}
			}
			return n;
		},
		decodeMovementFromJson: function (t, e) {
			var i = new ccs.MovementData();
			(i.loop = null != t[ccs.CONST_A_LOOP] && t[ccs.CONST_A_LOOP]),
				(i.durationTween = t[ccs.CONST_A_DURATION_TWEEN] || 0),
				(i.durationTo = t[ccs.CONST_A_DURATION_TO] || 0),
				(i.duration = t[ccs.CONST_A_DURATION] || 0),
				null == t[ccs.CONST_A_DURATION]
					? (i.scale = 1)
					: (i.scale =
							null == t[ccs.CONST_A_MOVEMENT_SCALE]
								? 1
								: t[ccs.CONST_A_MOVEMENT_SCALE]),
				(i.tweenEasing =
					null == t[ccs.CONST_A_TWEEN_EASING]
						? ccs.TweenType.LINEAR
						: t[ccs.CONST_A_TWEEN_EASING]);
			var n = t[ccs.CONST_A_NAME];
			n && (i.name = n);
			for (
				var r = t[ccs.CONST_MOVEMENT_BONE_DATA] || [], o = 0;
				o < r.length;
				o++
			) {
				var s = this.decodeMovementBoneFromJson(r[o], e);
				i.addMovementBoneData(s);
			}
			return i;
		},
		decodeMovementBone: function (t, e, i, n) {
			var r,
				o = new ccs.MovementBoneData();
			o.init(),
				t &&
					((r =
						parseFloat(
							t.getAttribute(ccs.CONST_A_MOVEMENT_SCALE)
						) || 0),
					(o.scale = r),
					0 <
						(r =
							parseFloat(
								t.getAttribute(ccs.CONST_A_MOVEMENT_DELAY)
							) || 0) && --r,
					(o.delay = r));
			var s = 0,
				c = 0,
				a = 0,
				l = null,
				h = [];
			if (null != e) {
				for (
					var u = e.querySelectorAll(
							ccs.CONST_BONE + ' > ' + ccs.CONST_FRAME
						),
						_ = 0;
					_ < u.length;
					_++
				)
					h.push(u[_]);
				s = h.length;
			}
			o.name = t.getAttribute(ccs.CONST_A_NAME);
			for (
				var d = t.querySelectorAll(
						ccs.CONST_BONE + ' > ' + ccs.CONST_FRAME
					),
					p = 0,
					f = 0,
					m = 0;
				m < d.length;
				m++
			) {
				var g = d[m];
				if (e)
					for (; p < s && (!l || f < c || c + a <= f); )
						(l = h[p]),
							(c += a),
							(a = parseFloat(
								l.getAttribute(ccs.CONST_A_DURATION)
							)),
							p++;
				g = this.decodeFrame(g, l, i, n);
				o.addFrameData(g),
					(g.frameID = f),
					(f += g.duration),
					(o.duration = f);
			}
			for (
				var y, T, S = o.frameList, C = Math.PI, _ = S.length - 1;
				0 <= _;
				_--
			)
				0 < _ &&
					((y = S[_].skewX - S[_ - 1].skewX),
					(T = S[_].skewY - S[_ - 1].skewY),
					(y < -C || C < y) &&
						(S[_ - 1].skewX =
							y < 0
								? S[_ - 1].skewX - 2 * C
								: S[_ - 1].skewX + 2 * C),
					(T < -C || C < T) &&
						(S[_ - 1].skewY =
							T < 0
								? S[_ - 1].skewY - 2 * C
								: S[_ - 1].skewY + 2 * C));
			t = new ccs.FrameData();
			return (
				t.copy(o.frameList[o.frameList.length - 1]),
				(t.frameID = o.duration),
				o.addFrameData(t),
				o
			);
		},
		decodeMovementBoneFromJson: function (t, e) {
			var i = new ccs.MovementBoneData();
			i.init(), (i.delay = t[ccs.CONST_A_MOVEMENT_DELAY] || 0);
			var n = t[ccs.CONST_A_NAME];
			n && (i.name = n);
			for (
				var r = (t[ccs.CONST_FRAME_DATA] || []).length, o = 0;
				o < r;
				o++
			) {
				var s = t[ccs.CONST_FRAME_DATA][o],
					c = this.decodeFrameFromJson(s, e);
				i.addFrameData(c),
					e.cocoStudioVersion < ccs.CONST_VERSION_COMBINED &&
						((c.frameID = i.duration), (i.duration += c.duration));
			}
			if (e.cocoStudioVersion < ccs.VERSION_CHANGE_ROTATION_RANGE)
				for (
					var a, l, h = i.frameList, u = Math.PI, o = h.length - 1;
					0 <= o;
					o--
				)
					0 < o &&
						((a = h[o].skewX - h[o - 1].skewX),
						(l = h[o].skewY - h[o - 1].skewY),
						(a < -u || u < a) &&
							(h[o - 1].skewX =
								a < 0
									? h[o - 1].skewX - 2 * u
									: h[o - 1].skewX + 2 * u),
						(l < -u || u < l) &&
							(h[o - 1].skewY =
								l < 0
									? h[o - 1].skewY - 2 * u
									: h[o - 1].skewY + 2 * u));
			return (
				e.cocoStudioVersion < ccs.CONST_VERSION_COMBINED &&
					0 < i.frameList.length &&
					((c = new ccs.FrameData()).copy(
						i.frameList[i.frameList.length - 1]
					),
					i.addFrameData(c),
					(c.frameID = i.duration)),
				i
			);
		},
		decodeFrame: function (t, e, i, n) {
			var r,
				o,
				s = 0,
				c = 0,
				a = 0,
				l = 0,
				h = 0,
				u = 0,
				_ = 0,
				d = 0,
				p = 0,
				f = 0,
				m = new ccs.FrameData();
			(m.strMovement = t.getAttribute(ccs.CONST_A_MOVEMENT) || ''),
				(m.movement = m.strMovement),
				(m.strEvent = t.getAttribute(ccs.CONST_A_EVENT) || ''),
				(m.event = m.strEvent),
				(m.strSound = t.getAttribute(ccs.CONST_A_SOUND) || ''),
				(m.sound = m.strSound),
				(m.strSoundEffect =
					t.getAttribute(ccs.CONST_A_SOUND_EFFECT) || ''),
				(m.soundEffect = m.strSoundEffect);
			var g = t.getAttribute(ccs.CONST_A_TWEEN_FRAME);
			if (
				((m.isTween = !(void 0 !== g && ('false' === g || '0' === g))),
				n.flashToolVersion >= ccs.CONST_VERSION_2_0
					? ((s = t.getAttribute(ccs.CONST_A_COCOS2DX_X)) &&
							((m.x = parseFloat(s)),
							(m.x *= this._positionReadScale)),
					  (c = t.getAttribute(ccs.CONST_A_COCOS2DX_Y)) &&
							((m.y = -parseFloat(c)),
							(m.y *= this._positionReadScale)))
					: ((s = t.getAttribute(ccs.CONST_A_X)) &&
							((m.x = parseFloat(s)),
							(m.x *= this._positionReadScale)),
					  (c = t.getAttribute(ccs.CONST_A_Y)) &&
							((m.y = -parseFloat(c)),
							(m.y *= this._positionReadScale))),
				null != (r = t.getAttribute(ccs.CONST_A_SCALE_X)) &&
					(m.scaleX = parseFloat(r)),
				null != (o = t.getAttribute(ccs.CONST_A_SCALE_Y)) &&
					(m.scaleY = parseFloat(o)),
				null != (a = t.getAttribute(ccs.CONST_A_SKEW_X)) &&
					(m.skewX = cc.degreesToRadians(parseFloat(a))),
				null != (l = t.getAttribute(ccs.CONST_A_SKEW_Y)) &&
					(m.skewY = cc.degreesToRadians(-parseFloat(l))),
				null != (u = t.getAttribute(ccs.CONST_A_DURATION)) &&
					(m.duration = parseFloat(u)),
				null != (_ = t.getAttribute(ccs.CONST_A_DISPLAY_INDEX)) &&
					(m.displayIndex = parseFloat(_)),
				null != (d = t.getAttribute(ccs.CONST_A_Z)) &&
					(m.zOrder = parseInt(d)),
				null != (h = t.getAttribute(ccs.CONST_A_TWEEN_ROTATE)) &&
					(m.tweenRotate = parseFloat(h)),
				null != (f = t.getAttribute(ccs.CONST_A_BLEND_TYPE)))
			) {
				var y = m.blendFunc;
				switch (f) {
					case ccs.BLEND_TYPE_NORMAL:
						(y.src = cc.BLEND_SRC), (y.dst = cc.BLEND_DST);
						break;
					case ccs.BLEND_TYPE_ADD:
						(y.src = cc.SRC_ALPHA), (y.dst = cc.ONE);
						break;
					case ccs.BLEND_TYPE_MULTIPLY:
						(y.src = cc.DST_COLOR),
							(y.dst = cc.ONE_MINUS_SRC_ALPHA);
						break;
					case ccs.BLEND_TYPE_SCREEN:
						(y.src = cc.ONE), (y.dst = cc.ONE_MINUS_DST_COLOR);
						break;
					default:
						(m.blendFunc.src = cc.BLEND_SRC),
							(m.blendFunc.dst = cc.BLEND_DST);
				}
			}
			a = t.querySelectorAll(
				ccs.CONST_FRAME + ' > ' + ccs.CONST_A_COLOR_TRANSFORM
			);
			a &&
				0 < a.length &&
				((a = a[0]),
				(l = parseFloat(a.getAttribute(ccs.CONST_A_ALPHA)) || 0),
				(u = parseFloat(a.getAttribute(ccs.CONST_A_RED)) || 0),
				(_ = parseFloat(a.getAttribute(ccs.CONST_A_GREEN)) || 0),
				(T = parseFloat(a.getAttribute(ccs.CONST_A_BLUE)) || 0),
				(d = parseFloat(a.getAttribute(ccs.CONST_A_ALPHA_OFFSET)) || 0),
				(h = parseFloat(a.getAttribute(ccs.CONST_A_RED_OFFSET)) || 0),
				(f = parseFloat(a.getAttribute(ccs.CONST_A_GREEN_OFFSET)) || 0),
				(a = parseFloat(a.getAttribute(ccs.CONST_A_BLUE_OFFSET)) || 0),
				(m.a = 2.55 * d + l),
				(m.r = 2.55 * h + u),
				(m.g = 2.55 * f + _),
				(m.b = 2.55 * a + T),
				(m.isUseColorInfo = !0));
			var T = t.getAttribute(ccs.CONST_A_TWEEN_EASING);
			return (
				null != T &&
					(T != ccs.CONST_FL_NAN
						? (p = t.getAttribute(ccs.CONST_A_TWEEN_EASING)) &&
						  (m.tweenEasing =
								2 === p ? ccs.TweenType.SINE_EASEINOUT : p)
						: (m.tweenEasing = ccs.TweenType.LINEAR)),
				e &&
					((p = new ccs.BaseData()),
					n.flashToolVersion >= ccs.CONST_VERSION_2_0
						? ((p.x = parseFloat(
								e.getAttribute(ccs.CONST_A_COCOS2DX_X)
						  )),
						  (p.y = parseFloat(
								e.getAttribute(ccs.CONST_A_COCOS2DX_Y)
						  )))
						: ((p.x = parseFloat(e.getAttribute(ccs.CONST_A_X))),
						  (p.y = parseFloat(e.getAttribute(ccs.CONST_A_Y)))),
					(p.skewX = parseFloat(e.getAttribute(ccs.CONST_A_SKEW_X))),
					(p.skewY = parseFloat(e.getAttribute(ccs.CONST_A_SKEW_Y))),
					(p.y = -p.y),
					(p.skewX = cc.degreesToRadians(p.skewX)),
					(p.skewY = cc.degreesToRadians(-p.skewY)),
					ccs.TransformHelp.transformFromParent(m, p)),
				m
			);
		},
		decodeFrameFromJson: function (t, e) {
			var i = new ccs.FrameData();
			this.decodeNodeFromJson(i, t, e),
				(i.tweenEasing =
					t[ccs.CONST_A_TWEEN_EASING] || ccs.TweenType.LINEAR),
				(i.displayIndex = t[ccs.CONST_A_DISPLAY_INDEX]);
			var n =
					null == t[ccs.CONST_A_BLEND_SRC]
						? cc.BLEND_SRC
						: t[ccs.CONST_A_BLEND_SRC],
				r =
					null == t[ccs.CONST_A_BLEND_DST]
						? cc.BLEND_DST
						: t[ccs.CONST_A_BLEND_DST];
			(i.blendFunc.src = n),
				(i.blendFunc.dst = r),
				(i.isTween =
					null == t[ccs.CONST_A_TWEEN_FRAME] ||
					t[ccs.CONST_A_TWEEN_FRAME]);
			r = t[ccs.CONST_A_EVENT];
			null != r && ((i.strEvent = r), (i.event = r)),
				e.cocoStudioVersion < ccs.CONST_VERSION_COMBINED
					? (i.duration =
							null == t[ccs.CONST_A_DURATION]
								? 1
								: t[ccs.CONST_A_DURATION])
					: (i.frameID = t[ccs.CONST_A_FRAME_INDEX]);
			for (
				var o = t[ccs.CONST_A_EASING_PARAM] || [], s = 0;
				s < o.length;
				s++
			)
				i.easingParams[s] = o[s];
			return i;
		},
		decodeTexture: function (t, e) {
			var i,
				n,
				r = new ccs.TextureData();
			r.init(),
				t.getAttribute(ccs.CONST_A_NAME) &&
					(r.name = t.getAttribute(ccs.CONST_A_NAME)),
				(n =
					e.flashToolVersion >= ccs.CONST_VERSION_2_0
						? ((i =
								parseFloat(
									t.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_X)
								) || 0),
						  parseFloat(
								t.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_Y)
						  ) || 0)
						: ((i =
								parseFloat(
									t.getAttribute(ccs.CONST_A_PIVOT_X)
								) || 0),
						  parseFloat(t.getAttribute(ccs.CONST_A_PIVOT_Y)) ||
								0));
			var o = parseFloat(t.getAttribute(ccs.CONST_A_WIDTH)) || 0,
				s = parseFloat(t.getAttribute(ccs.CONST_A_HEIGHT)) || 0,
				o = i / o,
				s = (s - n) / s;
			(r.pivotX = o), (r.pivotY = s);
			for (
				var c = t.querySelectorAll(
						ccs.CONST_SUB_TEXTURE + ' > ' + ccs.CONST_CONTOUR
					),
					a = 0;
				a < c.length;
				a++
			)
				r.addContourData(this.decodeContour(c[a], e));
			return r;
		},
		decodeTextureFromJson: function (t) {
			var e = new ccs.TextureData();
			e.init();
			var i = t[ccs.CONST_A_NAME];
			null != i && (e.name = i),
				(e.width = t[ccs.CONST_A_WIDTH] || 0),
				(e.height = t[ccs.CONST_A_HEIGHT] || 0),
				(e.pivotX = t[ccs.CONST_A_PIVOT_X] || 0),
				(e.pivotY = t[ccs.CONST_A_PIVOT_Y] || 0);
			for (
				var n = t[ccs.CONST_CONTOUR_DATA] || [], r = 0;
				r < n.length;
				r++
			)
				e.contourDataList.push(this.decodeContourFromJson(n[r]));
			return e;
		},
		decodeContour: function (t, e) {
			var i = new ccs.ContourData();
			i.init();
			for (
				var n,
					r = t.querySelectorAll(
						ccs.CONST_CONTOUR + ' > ' + ccs.CONST_CONTOUR_VERTEX
					),
					o = 0;
				o < r.length;
				o++
			) {
				n = r[o];
				var s = cc.p(0, 0);
				(s.x = parseFloat(n.getAttribute(ccs.CONST_A_X)) || 0),
					(s.y = parseFloat(n.getAttribute(ccs.CONST_A_Y)) || 0),
					(s.y = -s.y),
					i.vertexList.push(s);
			}
			return i;
		},
		decodeContourFromJson: function (t) {
			var e = new ccs.ContourData();
			e.init();
			for (
				var i = t[ccs.CONST_VERTEX_POINT] || [], n = i.length, r = 0;
				r < n;
				r++
			) {
				var o = i[r],
					s = cc.p(0, 0);
				(s.x = o[ccs.CONST_A_X] || 0),
					(s.y = o[ccs.CONST_A_Y] || 0),
					e.vertexList.push(s);
			}
			return e;
		},
		addDataFromJsonCache: function (t, e) {
			e.contentScale =
				null == t[ccs.CONST_CONTENT_SCALE]
					? 1
					: t[ccs.CONST_CONTENT_SCALE];
			var i,
				n = t[ccs.CONST_ARMATURE_DATA] || [];
			for (u = 0; u < n.length; u++)
				(i = this.decodeArmatureFromJSON(n[u], e)),
					ccs.armatureDataManager.addArmatureData(
						i.name,
						i,
						e.filename
					);
			var r,
				o = t[ccs.CONST_ANIMATION_DATA] || [];
			for (u = 0; u < o.length; u++)
				(r = this.decodeAnimationFromJson(o[u], e)),
					ccs.armatureDataManager.addAnimationData(
						r.name,
						r,
						e.filename
					);
			var s,
				c = t[ccs.CONST_TEXTURE_DATA] || [];
			for (u = 0; u < c.length; u++)
				(s = this.decodeTextureFromJson(c[u], e)),
					ccs.armatureDataManager.addTextureData(
						s.name,
						s,
						e.filename
					);
			if (
				null == e.asyncStruct
					? ccs.armatureDataManager.isAutoLoadSpriteFile()
					: e.asyncStruct.autoLoadSpriteFile
			)
				for (
					var a, l, h = t[ccs.CONST_CONFIG_FILE_PATH] || [], u = 0;
					u < h.length;
					u++
				)
					(a = (l = h[u]).lastIndexOf('.')),
						(l = l.substring(0, a)),
						(a = e.basefilePath + l + '.plist'),
						(l = e.basefilePath + l + '.png'),
						ccs.armatureDataManager.addSpriteFrameFromFile(
							a,
							l,
							e.filename
						);
			r = i = null;
		},
		decodeNodeFromJson: function (t, e, i) {
			var n;
			(t.x = e[ccs.CONST_A_X] * this._positionReadScale),
				(t.y = e[ccs.CONST_A_Y] * this._positionReadScale),
				(t.x *= i.contentScale),
				(t.y *= i.contentScale),
				(t.zOrder = e[ccs.CONST_A_Z]),
				(t.skewX = e[ccs.CONST_A_SKEW_X] || 0),
				(t.skewY = e[ccs.CONST_A_SKEW_Y] || 0),
				(t.scaleX =
					null == e[ccs.CONST_A_SCALE_X]
						? 1
						: e[ccs.CONST_A_SCALE_X]),
				(t.scaleY =
					null == e[ccs.CONST_A_SCALE_Y]
						? 1
						: e[ccs.CONST_A_SCALE_Y]),
				i.cocoStudioVersion < ccs.VERSION_COLOR_READING
					? (n = e[0]) &&
					  ((t.a =
							null == n[ccs.CONST_A_ALPHA]
								? 255
								: n[ccs.CONST_A_ALPHA]),
					  (t.r =
							null == n[ccs.CONST_A_RED]
								? 255
								: n[ccs.CONST_A_RED]),
					  (t.g =
							null == n[ccs.CONST_A_GREEN]
								? 255
								: n[ccs.CONST_A_GREEN]),
					  (t.b =
							null == n[ccs.CONST_A_BLUE]
								? 255
								: n[ccs.CONST_A_BLUE]),
					  (t.isUseColorInfo = !0))
					: (n = e[ccs.CONST_COLOR_INFO] || null) &&
					  ((t.a =
							null == n[ccs.CONST_A_ALPHA]
								? 255
								: n[ccs.CONST_A_ALPHA]),
					  (t.r =
							null == n[ccs.CONST_A_RED]
								? 255
								: n[ccs.CONST_A_RED]),
					  (t.g =
							null == n[ccs.CONST_A_GREEN]
								? 255
								: n[ccs.CONST_A_GREEN]),
					  (t.b =
							null == n[ccs.CONST_A_BLUE]
								? 255
								: n[ccs.CONST_A_BLUE]),
					  (t.isUseColorInfo = !0));
		},
		clear: function () {
			(this._configFileList = []),
				(this._asyncRefCount = 0),
				(this._asyncRefTotalCount = 0);
		},
		_asyncCallBack: function (t, e, i) {
			t && cc.isFunction(t) && t.call(e, i),
				e && t && 'string' == typeof t && e[t](i);
		},
		_initBaseFilePath: function (t) {
			var e = t,
				t = e.lastIndexOf('/');
			return (e = -1 < t ? e.substr(0, t + 1) : '');
		},
		addDataFromXML: function (t, e) {
			var i = cc.loader.getRes(t);
			if (!i) throw new Error('Please load the resource first : ' + t);
			i = cc.saxParser.parse(i).documentElement;
			i && this.addDataFromCache(i, e);
		},
		addDataFromJson: function (t, e) {
			t = cc.loader.getRes(t);
			this.addDataFromJsonCache(t, e);
		},
	}),
	(ccs.spriteFrameCacheHelper = {
		_textureAtlasDic: {},
		_imagePaths: [],
		addSpriteFrameFromFile: function (t, e) {
			cc.spriteFrameCache.addSpriteFrames(t, e);
		},
		getTextureAtlasWithTexture: function (t) {
			return null;
		},
		clear: function () {
			(this._textureAtlasDic = {}), (this._imagePaths = []);
		},
	}),
	(ccs.TransformHelp = ccs.TransformHelp || ccs.Class.extend({})),
	(ccs.TransformHelp.helpMatrix1 = cc.affineTransformMake(1, 0, 0, 1, 0, 0)),
	(ccs.TransformHelp.helpMatrix2 = cc.affineTransformMake(1, 0, 0, 1, 0, 0)),
	(ccs.TransformHelp.helpPoint1 = cc.p(0, 0)),
	(ccs.TransformHelp.helpPoint2 = cc.p(0, 0)),
	(ccs.TransformHelp.helpParentNode = {}),
	(ccs.TransformHelp.transformFromParent = function (t, e) {
		this.nodeToMatrix(t, this.helpMatrix1),
			this.nodeToMatrix(e, this.helpMatrix2),
			(this.helpMatrix2 = cc.affineTransformInvert(this.helpMatrix2)),
			(this.helpMatrix1 = cc.affineTransformConcat(
				this.helpMatrix1,
				this.helpMatrix2
			)),
			this.matrixToNode(this.helpMatrix1, t);
	}),
	(ccs.TransformHelp.transformToParent = function (t, e) {
		this.nodeToMatrix(t, this.helpMatrix1),
			this.nodeToMatrix(e, this.helpMatrix2),
			(this.helpMatrix1 = cc.affineTransformConcat(
				this.helpMatrix1,
				this.helpMatrix2
			)),
			this.matrixToNode(this.helpMatrix1, t);
	}),
	(ccs.TransformHelp.transformFromParentWithoutScale = function (t, e) {
		for (var i in e) this.helpParentNode[i] = e[i];
		(this.helpParentNode.scaleX = 1),
			(this.helpParentNode.scaleY = 1),
			this.nodeToMatrix(t, this.helpMatrix1),
			this.nodeToMatrix(this.helpParentNode, this.helpMatrix2),
			(this.helpMatrix2 = cc.affineTransformInvert(this.helpMatrix2)),
			(this.helpMatrix1 = cc.affineTransformConcat(
				this.helpMatrix1,
				this.helpMatrix2
			)),
			this.matrixToNode(this.helpMatrix1, t);
	}),
	(ccs.TransformHelp.transformToParentWithoutScale = function (t, e) {
		for (var i in e) this.helpParentNode[i] = e[i];
		(this.helpParentNode.scaleX = 1),
			(this.helpParentNode.scaleY = 1),
			this.nodeToMatrix(t, this.helpMatrix1),
			this.nodeToMatrix(this.helpParentNode, this.helpMatrix2),
			(this.helpMatrix1 = cc.affineTransformConcat(
				this.helpMatrix1,
				this.helpMatrix2
			)),
			this.matrixToNode(this.helpMatrix1, t);
	}),
	(ccs.TransformHelp.nodeToMatrix = function (t, e) {
		var i, n;
		t.skewX === -t.skewY
			? ((i = Math.sin(t.skewX)),
			  (n = Math.cos(t.skewX)),
			  (e.a = t.scaleX * n),
			  (e.b = t.scaleX * -i),
			  (e.c = t.scaleY * i),
			  (e.d = t.scaleY * n))
			: ((e.a = t.scaleX * Math.cos(t.skewY)),
			  (e.b = t.scaleX * Math.sin(t.skewY)),
			  (e.c = t.scaleY * Math.sin(t.skewX)),
			  (e.d = t.scaleY * Math.cos(t.skewX))),
			(e.tx = t.x),
			(e.ty = t.y);
	}),
	(ccs.TransformHelp.matrixToNode = function (t, e) {
		(this.helpPoint1.x = 0),
			(this.helpPoint1.y = 1),
			(this.helpPoint1 = cc.pointApplyAffineTransform(
				this.helpPoint1,
				t
			)),
			(this.helpPoint1.x -= t.tx),
			(this.helpPoint1.y -= t.ty),
			(this.helpPoint2.x = 1),
			(this.helpPoint2.y = 0),
			(this.helpPoint2 = cc.pointApplyAffineTransform(
				this.helpPoint2,
				t
			)),
			(this.helpPoint2.x -= t.tx),
			(this.helpPoint2.y -= t.ty),
			(e.skewX = -(
				Math.atan2(this.helpPoint1.y, this.helpPoint1.x) - 1.5707964
			)),
			(e.skewY = Math.atan2(this.helpPoint2.y, this.helpPoint2.x)),
			(e.scaleX = Math.sqrt(t.a * t.a + t.b * t.b)),
			(e.scaleY = Math.sqrt(t.c * t.c + t.d * t.d)),
			(e.x = t.tx),
			(e.y = t.ty);
	}),
	(ccs.TransformHelp.nodeConcat = function (t, e) {
		(t.x += e.x),
			(t.y += e.y),
			(t.skewX += e.skewX),
			(t.skewY += e.skewY),
			(t.scaleX += e.scaleX),
			(t.scaleY += e.scaleY);
	}),
	(ccs.TransformHelp.nodeSub = function (t, e) {
		(t.x -= e.x),
			(t.y -= e.y),
			(t.skewX -= e.skewX),
			(t.skewY -= e.skewY),
			(t.scaleX -= e.scaleX),
			(t.scaleY -= e.scaleY);
	}),
	(ccs.TweenType = {
		CUSTOM_EASING: -1,
		LINEAR: 0,
		SINE_EASEIN: 1,
		SINE_EASEOUT: 2,
		SINE_EASEINOUT: 3,
		QUAD_EASEIN: 4,
		QUAD_EASEOUT: 5,
		QUAD_EASEINOUT: 6,
		CUBIC_EASEIN: 7,
		CUBIC_EASEOUT: 8,
		CUBIC_EASEINOUT: 9,
		QUART_EASEIN: 10,
		QUART_EASEOUT: 11,
		QUART_EASEINOUT: 12,
		QUINT_EASEIN: 13,
		QUINT_EASEOUT: 14,
		QUINT_EASEINOUT: 15,
		EXPO_EASEIN: 16,
		EXPO_EASEOUT: 17,
		EXPO_EASEINOUT: 18,
		CIRC_EASEIN: 19,
		CIRC_EASEOUT: 20,
		CIRC_EASEINOUT: 21,
		ELASTIC_EASEIN: 22,
		ELASTIC_EASEOUT: 23,
		ELASTIC_EASEINOUT: 24,
		BACK_EASEIN: 25,
		BACK_EASEOUT: 26,
		BACK_EASEINOUT: 27,
		BOUNCE_EASEIN: 28,
		BOUNCE_EASEOUT: 29,
		BOUNCE_EASEINOUT: 30,
		TWEEN_EASING_MAX: 1e4,
	}),
	(ccs.TweenFunction = ccs.TweenFunction || ccs.Class.extend({})),
	(ccs.DOUBLE_PI = ccs.M_PI_X_2 = 2 * Math.PI),
	(ccs.HALF_PI = ccs.M_PI_2 = Math.PI / 2),
	(ccs.M_PI = Math.PI),
	(ccs.TweenFunction.tweenTo = function (t, e, i) {
		var n = 0;
		switch (e) {
			case ccs.TweenType.CUSTOM_EASING:
				n = this.customEase(t, i);
				break;
			case ccs.TweenType.LINEAR:
				n = this.linear(t);
				break;
			case ccs.TweenType.SINE_EASEIN:
				n = this.sineEaseIn(t);
				break;
			case ccs.TweenType.SINE_EASEOUT:
				n = this.sineEaseOut(t);
				break;
			case ccs.TweenType.SINE_EASEINOUT:
				n = this.sineEaseInOut(t);
				break;
			case ccs.TweenType.QUAD_EASEIN:
				n = this.quadEaseIn(t);
				break;
			case ccs.TweenType.QUAD_EASEOUT:
				n = this.quadEaseOut(t);
				break;
			case ccs.TweenType.QUAD_EASEINOUT:
				n = this.quadEaseInOut(t);
				break;
			case ccs.TweenType.CUBIC_EASEIN:
				n = this.cubicEaseIn(t);
				break;
			case ccs.TweenType.CUBIC_EASEOUT:
				n = this.cubicEaseOut(t);
				break;
			case ccs.TweenType.CUBIC_EASEINOUT:
				n = this.cubicEaseInOut(t);
				break;
			case ccs.TweenType.QUART_EASEIN:
				n = this.quartEaseIn(t);
				break;
			case ccs.TweenType.QUART_EASEOUT:
				n = this.quartEaseOut(t);
				break;
			case ccs.TweenType.QUART_EASEINOUT:
				n = this.quartEaseInOut(t);
				break;
			case ccs.TweenType.QUINT_EASEIN:
				n = this.quintEaseIn(t);
				break;
			case ccs.TweenType.QUINT_EASEOUT:
				n = this.quintEaseOut(t);
				break;
			case ccs.TweenType.QUINT_EASEINOUT:
				n = this.quintEaseInOut(t);
				break;
			case ccs.TweenType.EXPO_EASEIN:
				n = this.expoEaseIn(t);
				break;
			case ccs.TweenType.EXPO_EASEOUT:
				n = this.expoEaseOut(t);
				break;
			case ccs.TweenType.EXPO_EASEINOUT:
				n = this.expoEaseInOut(t);
				break;
			case ccs.TweenType.CIRC_EASEIN:
				n = this.circEaseIn(t);
				break;
			case ccs.TweenType.CIRC_EASEOUT:
				n = this.circEaseOut(t);
				break;
			case ccs.TweenType.CIRC_EASEINOUT:
				n = this.circEaseInOut(t);
				break;
			case ccs.TweenType.ELASTIC_EASEIN:
				var r = 0.3;
				null != i && 0 < i.length && (r = i[0]),
					(n = this.elasticEaseIn(t, r));
				break;
			case ccs.TweenType.ELASTIC_EASEOUT:
				r = 0.3;
				null != i && 0 < i.length && (r = i[0]),
					(n = this.elasticEaseOut(t, r));
				break;
			case ccs.TweenType.ELASTIC_EASEINOUT:
				r = 0.3;
				null != i && 0 < i.length && (r = i[0]),
					(n = this.elasticEaseInOut(t, r));
				break;
			case ccs.TweenType.BACK_EASEIN:
				n = this.backEaseIn(t);
				break;
			case ccs.TweenType.BACK_EASEOUT:
				n = this.backEaseOut(t);
				break;
			case ccs.TweenType.BACK_EASEINOUT:
				n = this.backEaseInOut(t);
				break;
			case ccs.TweenType.BOUNCE_EASEIN:
				n = this.bounceEaseIn(t);
				break;
			case ccs.TweenType.BOUNCE_EASEOUT:
				n = this.bounceEaseOut(t);
				break;
			case ccs.TweenType.BOUNCE_EASEINOUT:
				n = this.bounceEaseInOut(t);
				break;
			default:
				n = this.sineEaseInOut(t);
		}
		return n;
	}),
	(ccs.TweenFunction.linear = function (t) {
		return t;
	}),
	(ccs.TweenFunction.sineEaseIn = function (t) {
		return -1 * Math.cos(t * ccs.HALF_PI) + 1;
	}),
	(ccs.TweenFunction.sineEaseOut = function (t) {
		return Math.sin(t * ccs.HALF_PI);
	}),
	(ccs.TweenFunction.sineEaseInOut = function (t) {
		return -0.5 * (Math.cos(ccs.M_PI * t) - 1);
	}),
	(ccs.TweenFunction.quadEaseIn = function (t) {
		return t * t;
	}),
	(ccs.TweenFunction.quadEaseOut = function (t) {
		return -1 * t * (t - 2);
	}),
	(ccs.TweenFunction.quadEaseInOut = function (t) {
		return (t *= 2) < 1 ? 0.5 * t * t : -0.5 * (--t * (t - 2) - 1);
	}),
	(ccs.TweenFunction.cubicEaseIn = function (t) {
		return t * t * t;
	}),
	(ccs.TweenFunction.cubicEaseOut = function (t) {
		return --t * t * t + 1;
	}),
	(ccs.TweenFunction.cubicEaseInOut = function (t) {
		return (t *= 2) < 1 ? 0.5 * t * t * t : 0.5 * ((t -= 2) * t * t + 2);
	}),
	(ccs.TweenFunction.quartEaseIn = function (t) {
		return t * t * t * t;
	}),
	(ccs.TweenFunction.quartEaseOut = function (t) {
		return -(--t * t * t * t - 1);
	}),
	(ccs.TweenFunction.quartEaseInOut = function (t) {
		return (t *= 2) < 1
			? 0.5 * t * t * t * t
			: -0.5 * ((t -= 2) * t * t * t - 2);
	}),
	(ccs.TweenFunction.quintEaseIn = function (t) {
		return t * t * t * t * t;
	}),
	(ccs.TweenFunction.quintEaseOut = function (t) {
		return --t * t * t * t * t + 1;
	}),
	(ccs.TweenFunction.quintEaseInOut = function (t) {
		return (t *= 2) < 1
			? 0.5 * t * t * t * t * t
			: 0.5 * ((t -= 2) * t * t * t * t + 2);
	}),
	(ccs.TweenFunction.expoEaseIn = function (t) {
		return 0 === t ? 0 : Math.pow(2, 10 * (t - 1)) - 0.001;
	}),
	(ccs.TweenFunction.expoEaseOut = function (t) {
		return 1 === t ? 1 : 1 - Math.pow(2, -10 * t);
	}),
	(ccs.TweenFunction.expoEaseInOut = function (t) {
		return (t =
			(t /= 0.5) < 1
				? 0.5 * Math.pow(2, 10 * (t - 1))
				: 0.5 * (2 - Math.pow(2, -10 * (t - 1))));
	}),
	(ccs.TweenFunction.circEaseIn = function (t) {
		return -1 * (Math.sqrt(1 - t * t) - 1);
	}),
	(ccs.TweenFunction.circEaseOut = function (t) {
		return --t, Math.sqrt(1 - t * t);
	}),
	(ccs.TweenFunction.circEaseInOut = function (t) {
		return (t *= 2) < 1
			? -0.5 * (Math.sqrt(1 - t * t) - 1)
			: ((t -= 2), 0.5 * (Math.sqrt(1 - t * t) + 1));
	}),
	(ccs.TweenFunction.elasticEaseIn = function (t, e) {
		var i = 0.3;
		0 < e.length && (i = e[0]);
		return 0 === t || 1 === t
			? t
			: ((e = i / 4),
			  --t,
			  -Math.pow(2, 10 * t) * Math.sin(((t - e) * ccs.DOUBLE_PI) / i));
	}),
	(ccs.TweenFunction.elasticEaseOut = function (t, e) {
		var i = 0.3;
		0 < e.length && (i = e[0]);
		return 0 === t || 1 === t
			? t
			: ((e = i / 4),
			  Math.pow(2, -10 * t) * Math.sin(((t - e) * ccs.DOUBLE_PI) / i) +
					1);
	}),
	(ccs.TweenFunction.elasticEaseInOut = function (t, e) {
		var i = 0.3;
		0 < e.length && (i = e[0]);
		return 0 === t || 1 === t
			? t
			: ((t *= 2),
			  (e = (i = i || 0.3 * 1.5) / 4),
			  --t < 0
					? -0.5 *
					  Math.pow(2, 10 * t) *
					  Math.sin(((t - e) * ccs.DOUBLE_PI) / i)
					: Math.pow(2, -10 * t) *
							Math.sin(((t - e) * ccs.DOUBLE_PI) / i) *
							0.5 +
					  1);
	}),
	(ccs.TweenFunction.backEaseIn = function (t) {
		return t * t * (2.70158 * t - 1.70158);
	}),
	(ccs.TweenFunction.backEaseOut = function (t) {
		return --t * t * (2.70158 * t + 1.70158) + 1;
	}),
	(ccs.TweenFunction.backEaseInOut = function (t) {
		var e = 2.5949095;
		return (t *= 2) < 1
			? (t * t * ((1 + e) * t - e)) / 2
			: ((t -= 2) * t * ((1 + e) * t + e)) / 2 + 1;
	}),
	(ccs.bounceTime = function (t) {
		return t < 1 / 2.75
			? 7.5625 * t * t
			: t < 2 / 2.75
			? 7.5625 * (t -= 1.5 / 2.75) * t + 0.75
			: t < 2.5 / 2.75
			? 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375
			: 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375;
	}),
	(ccs.TweenFunction.bounceEaseIn = function (t) {
		return 1 - ccs.bounceTime(1 - t);
	}),
	(ccs.TweenFunction.bounceEaseOut = function (t) {
		return ccs.bounceTime(t);
	}),
	(ccs.TweenFunction.bounceEaseInOut = function (t) {
		return t < 0.5
			? ((t *= 2), 0.5 * (1 - ccs.bounceTime(1 - t)))
			: 0.5 * ccs.bounceTime(2 * t - 1) + 0.5;
	}),
	(ccs.TweenFunction.customEase = function (t, e) {
		if (0 < e.length) {
			var i = 1 - t;
			return (
				e[1] * i * i * i +
				3 * e[3] * t * i * i +
				3 * e[5] * t * t * i +
				e[7] * t * t * t
			);
		}
		return t;
	}),
	(ccs.TweenFunction.easeIn = function (t, e) {
		return Math.pow(t, e);
	}),
	(ccs.TweenFunction.easeOut = function (t, e) {
		return Math.pow(t, 1 / e);
	}),
	(ccs.TweenFunction.easeInOut = function (t, e) {
		return (t *= 2) < 1
			? 0.5 * Math.pow(t, e)
			: 1 - 0.5 * Math.pow(2 - t, e);
	}),
	(ccs.TweenFunction.quadraticIn = function (t) {
		return Math.pow(t, 2);
	}),
	(ccs.TweenFunction.quadraticOut = function (t) {
		return -t * (t - 2);
	}),
	(ccs.TweenFunction.bezieratFunction = function (t, e, i, n, r) {
		return (
			Math.pow(1 - r, 3) * t +
			3 * r * Math.pow(1 - r, 2) * e +
			3 * Math.pow(r, 2) * (1 - r) * i +
			Math.pow(r, 3) * n
		);
	});
var ENABLE_PHYSICS_DETECT = !1;
ccs.fmodf = function (t, e) {
	for (; e < t; ) t -= e;
	return t;
};
var CC_SAFE_RELEASE = function (t) {
	t && t.release && t.release();
};
(ccs.isSpriteContainPoint = function (t, e, i) {
	e = t.convertToNodeSpace(e);
	i && ((i.x = e.x), (i.y = e.y));
	t = t.getContentSize();
	return cc.rectContainsPoint(cc.rect(0, 0, t.width, t.height), e);
}),
	(ccs.SPRITE_CONTAIN_POINT = ccs.isSpriteContainPoint),
	(ccs.SPRITE_CONTAIN_POINT_WITH_RETURN = ccs.isSpriteContainPoint),
	(ccs.extBezierTo = function (t, e, i, n, r) {
		var o = cc.p(0, 0);
		return (
			n &&
				!r &&
				((o.x =
					Math.pow(1 - t, 2) * e.x +
					2 * t * (1 - t) * i.x +
					Math.pow(t, 2) * n.x),
				(o.y =
					Math.pow(1 - t, 2) * e.y +
					2 * t * (1 - t) * i.y +
					Math.pow(t, 2) * n.y)),
			r &&
				((o.x =
					e.x * Math.pow(1 - t, 3) +
					3 * t * i.x * Math.pow(1 - t, 2) +
					3 * n.x * Math.pow(t, 2) * (1 - t) +
					r.x * Math.pow(t, 3)),
				(o.y =
					e.y * Math.pow(1 - t, 3) +
					3 * t * i.y * Math.pow(1 - t, 2) +
					3 * n.y * Math.pow(t, 2) * (1 - t) +
					r.y * Math.pow(t, 3))),
			o
		);
	}),
	(ccs.extCircleTo = function (t, e, i, n, r) {
		var o = cc.p(0, 0);
		return (
			(o.x = e.x + i * Math.cos(n + r * t)),
			(o.y = e.y + i * Math.sin(n + r * t)),
			o
		);
	}),
	(ccs.RelativeData = function () {
		(this.plistFiles = []),
			(this.armatures = []),
			(this.animations = []),
			(this.textures = []);
	}),
	(ccs.armatureDataManager = {
		_animationDatas: {},
		_armatureDatas: {},
		_textureDatas: {},
		_autoLoadSpriteFile: !1,
		_relativeDatas: {},
		s_sharedArmatureDataManager: null,
		removeArmatureFileInfo: function (t) {
			var e = this.getRelativeData(t);
			if (e) {
				for (var i, n = 0; n < e.armatures.length; n++)
					(i = e.armatures[n]), this.removeArmatureData(i);
				for (n = 0; n < e.animations.length; n++)
					(i = e.animations[n]), this.removeAnimationData(i);
				for (n = 0; n < e.textures.length; n++)
					(i = e.textures[n]), this.removeTextureData(i);
				for (n = 0; n < e.plistFiles.length; n++)
					(i = e.plistFiles[n]),
						cc.spriteFrameCache.removeSpriteFramesFromFile(i);
				delete this._relativeDatas[t],
					ccs.dataReaderHelper.removeConfigFile(t);
			}
		},
		addArmatureData: function (t, e, i) {
			i = this.getRelativeData(i);
			i && i.armatures.push(t), (this._armatureDatas[t] = e);
		},
		getArmatureData: function (t) {
			var e = null;
			return this._armatureDatas && (e = this._armatureDatas[t]), e;
		},
		removeArmatureData: function (t) {
			this._armatureDatas[t] && delete this._armatureDatas[t];
		},
		addAnimationData: function (t, e, i) {
			i = this.getRelativeData(i);
			i && i.animations.push(t), (this._animationDatas[t] = e);
		},
		getAnimationData: function (t) {
			var e = null;
			return this._animationDatas[t] && (e = this._animationDatas[t]), e;
		},
		removeAnimationData: function (t) {
			this._animationDatas[t] && delete this._animationDatas[t];
		},
		addTextureData: function (t, e, i) {
			i = this.getRelativeData(i);
			i && i.textures.push(t), (this._textureDatas[t] = e);
		},
		getTextureData: function (t) {
			var e = null;
			return this._textureDatas && (e = this._textureDatas[t]), e;
		},
		removeTextureData: function (t) {
			this._textureDatas[t] && delete this._textureDatas[t];
		},
		addArmatureFileInfo: function () {
			var t, e, i;
			switch (arguments.length) {
				case 1:
					(i = arguments[0]),
						this.addRelativeData(i),
						(this._autoLoadSpriteFile = !0),
						ccs.dataReaderHelper.addDataFromFile(i);
					break;
				case 3:
					(t = arguments[0]),
						(e = arguments[1]),
						(i = arguments[2]),
						this.addRelativeData(i),
						(this._autoLoadSpriteFile = !1),
						ccs.dataReaderHelper.addDataFromFile(i),
						this.addSpriteFrameFromFile(e, t);
			}
		},
		addArmatureFileInfoAsync: function () {
			var t, e, i, n, r;
			switch (arguments.length) {
				case 3:
					(i = arguments[0]),
						(n = arguments[2]),
						(r = arguments[1]),
						this.addRelativeData(i),
						(this._autoLoadSpriteFile = !0),
						ccs.dataReaderHelper.addDataFromFileAsync(
							'',
							'',
							i,
							r,
							n
						);
					break;
				case 5:
					(t = arguments[0]),
						(e = arguments[1]),
						(i = arguments[2]),
						(n = arguments[4]),
						(r = arguments[3]),
						this.addRelativeData(i),
						(this._autoLoadSpriteFile = !1),
						ccs.dataReaderHelper.addDataFromFileAsync(
							t,
							e,
							i,
							r,
							n
						),
						this.addSpriteFrameFromFile(e, t);
			}
		},
		addSpriteFrameFromFile: function (t, e, i) {
			i = this.getRelativeData(i);
			i && i.plistFiles.push(t),
				ccs.spriteFrameCacheHelper.addSpriteFrameFromFile(t, e);
		},
		isAutoLoadSpriteFile: function () {
			return this._autoLoadSpriteFile;
		},
		getArmatureDatas: function () {
			return this._armatureDatas;
		},
		getAnimationDatas: function () {
			return this._animationDatas;
		},
		getTextureDatas: function () {
			return this._textureDatas;
		},
		addRelativeData: function (t) {
			this._relativeDatas[t] ||
				(this._relativeDatas[t] = new ccs.RelativeData());
		},
		getRelativeData: function (t) {
			return this._relativeDatas[t];
		},
		clear: function () {
			for (var t in this._relativeDatas) this.removeArmatureFileInfo(t);
			(this._animationDatas = {}),
				(this._armatureDatas = {}),
				(this._textureDatas = {}),
				(this._relativeDatas = {}),
				ccs.spriteFrameCacheHelper.clear(),
				ccs.dataReaderHelper.clear();
		},
	}),
	(ccs.BLEND_TYPE_NORMAL = 0),
	(ccs.BLEND_TYPE_LAYER = 1),
	(ccs.BLEND_TYPE_DARKEN = 2),
	(ccs.BLEND_TYPE_MULTIPLY = 3),
	(ccs.BLEND_TYPE_LIGHTEN = 4),
	(ccs.BLEND_TYPE_SCREEN = 5),
	(ccs.BLEND_TYPE_OVERLAY = 6),
	(ccs.BLEND_TYPE_HIGHLIGHT = 7),
	(ccs.BLEND_TYPE_ADD = 8),
	(ccs.BLEND_TYPE_SUBTRACT = 9),
	(ccs.BLEND_TYPE_DIFFERENCE = 10),
	(ccs.BLEND_TYPE_INVERT = 11),
	(ccs.BLEND_TYPE_ALPHA = 12),
	(ccs.BLEND_TYPE_ERASE = 13),
	(ccs.DISPLAY_TYPE_SPRITE = 0),
	(ccs.DISPLAY_TYPE_ARMATURE = 1),
	(ccs.DISPLAY_TYPE_PARTICLE = 2),
	(ccs.DISPLAY_TYPE_MAX = 3),
	(ccs.BaseData = ccs.Class.extend({
		x: 0,
		y: 0,
		zOrder: 0,
		skewX: 0,
		skewY: 0,
		scaleX: 1,
		scaleY: 1,
		tweenRotate: 0,
		isUseColorInfo: !1,
		r: 255,
		g: 255,
		b: 255,
		a: 255,
		ctor: function () {
			(this.x = 0),
				(this.y = 0),
				(this.zOrder = 0),
				(this.skewX = 0),
				(this.skewY = 0),
				(this.scaleX = 1),
				(this.scaleY = 1),
				(this.tweenRotate = 0),
				(this.isUseColorInfo = !1),
				(this.r = 255),
				(this.g = 255),
				(this.b = 255),
				(this.a = 255);
		},
		copy: function (t) {
			(this.x = t.x),
				(this.y = t.y),
				(this.zOrder = t.zOrder),
				(this.scaleX = t.scaleX),
				(this.scaleY = t.scaleY),
				(this.skewX = t.skewX),
				(this.skewY = t.skewY),
				(this.tweenRotate = t.tweenRotate),
				(this.isUseColorInfo = t.isUseColorInfo),
				(this.r = t.r),
				(this.g = t.g),
				(this.b = t.b),
				(this.a = t.a);
		},
		setColor: function (t) {
			(this.r = t.r), (this.g = t.g), (this.b = t.b), (this.a = t.a);
		},
		getColor: function () {
			return cc.color(this.r, this.g, this.b, this.a);
		},
		subtract: function (t, e, i) {
			(this.x = e.x - t.x),
				(this.y = e.y - t.y),
				(this.scaleX = e.scaleX - t.scaleX),
				(this.scaleY = e.scaleY - t.scaleY),
				(this.skewX = e.skewX - t.skewX),
				(this.skewY = e.skewY - t.skewY),
				this.isUseColorInfo || t.isUseColorInfo || e.isUseColorInfo
					? ((this.a = e.a - t.a),
					  (this.r = e.r - t.r),
					  (this.g = e.g - t.g),
					  (this.b = e.b - t.b),
					  (this.isUseColorInfo = !0))
					: ((this.a = this.r = this.g = this.b = 0),
					  (this.isUseColorInfo = !1)),
				i &&
					(this.skewX > ccs.M_PI && (this.skewX -= ccs.DOUBLE_PI),
					this.skewX < -ccs.M_PI && (this.skewX += ccs.DOUBLE_PI),
					this.skewY > ccs.M_PI && (this.skewY -= ccs.DOUBLE_PI),
					this.skewY < -ccs.M_PI && (this.skewY += ccs.DOUBLE_PI)),
				e.tweenRotate &&
					((this.skewX += e.tweenRotate * ccs.PI * 2),
					(this.skewY -= e.tweenRotate * ccs.PI * 2));
		},
	})),
	(ccs.DisplayData = ccs.Class.extend({
		displayType: ccs.DISPLAY_TYPE_MAX,
		displayName: '',
		ctor: function () {
			this.displayType = ccs.DISPLAY_TYPE_MAX;
		},
		changeDisplayToTexture: function (t) {
			var e = t,
				t = e.lastIndexOf('.');
			return -1 !== t && (e = e.substring(0, t)), e;
		},
		copy: function (t) {
			(this.displayName = t.displayName),
				(this.displayType = t.displayType);
		},
	})),
	(ccs.SpriteDisplayData = ccs.DisplayData.extend({
		skinData: null,
		ctor: function () {
			(this.skinData = new ccs.BaseData()),
				(this.displayType = ccs.DISPLAY_TYPE_SPRITE);
		},
		copy: function (t) {
			ccs.DisplayData.prototype.copy.call(this, t),
				(this.skinData = t.skinData);
		},
	})),
	(ccs.ArmatureDisplayData = ccs.DisplayData.extend({
		ctor: function () {
			(this.displayName = ''),
				(this.displayType = ccs.DISPLAY_TYPE_ARMATURE);
		},
	})),
	(ccs.ParticleDisplayData = ccs.DisplayData.extend({
		ctor: function () {
			this.displayType = ccs.DISPLAY_TYPE_PARTICLE;
		},
	})),
	(ccs.BoneData = ccs.BaseData.extend({
		displayDataList: null,
		name: '',
		parentName: '',
		boneDataTransform: null,
		ctor: function () {
			(this.displayDataList = []),
				(this.name = ''),
				(this.parentName = ''),
				(this.boneDataTransform = null);
		},
		init: function () {
			return !(this.displayDataList.length = 0);
		},
		addDisplayData: function (t) {
			this.displayDataList.push(t);
		},
		getDisplayData: function (t) {
			return this.displayDataList[t];
		},
	})),
	(ccs.ArmatureData = ccs.Class.extend({
		boneDataDic: null,
		name: '',
		dataVersion: 0.1,
		ctor: function () {
			(this.boneDataDic = {}), (this.name = ''), (this.dataVersion = 0.1);
		},
		init: function () {
			return !0;
		},
		addBoneData: function (t) {
			this.boneDataDic[t.name] = t;
		},
		getBoneDataDic: function () {
			return this.boneDataDic;
		},
		getBoneData: function (t) {
			return this.boneDataDic[t];
		},
	})),
	(ccs.FrameData = ccs.BaseData.extend({
		duration: 0,
		tweenEasing: 0,
		easingParamNumber: 0,
		easingParams: null,
		displayIndex: -1,
		movement: '',
		event: '',
		sound: '',
		soundEffect: '',
		blendFunc: null,
		frameID: 0,
		isTween: !0,
		ctor: function () {
			ccs.BaseData.prototype.ctor.call(this),
				(this.duration = 1),
				(this.tweenEasing = ccs.TweenType.LINEAR),
				(this.easingParamNumber = 0),
				(this.easingParams = []),
				(this.displayIndex = 0),
				(this.movement = ''),
				(this.event = ''),
				(this.sound = ''),
				(this.soundEffect = ''),
				(this.blendFunc = new cc.BlendFunc(cc.BLEND_SRC, cc.BLEND_DST)),
				(this.frameID = 0),
				(this.isTween = !0);
		},
		copy: function (t) {
			if (
				(ccs.BaseData.prototype.copy.call(this, t),
				(this.duration = t.duration),
				(this.displayIndex = t.displayIndex),
				(this.tweenEasing = t.tweenEasing),
				(this.easingParamNumber = t.easingParamNumber),
				0 !== this.easingParamNumber)
			)
				for (
					var e = (this.easingParams.length = 0);
					e < this.easingParamNumber;
					e++
				)
					this.easingParams[e] = t.easingParams[e];
			(this.blendFunc = t.blendFunc), (this.isTween = t.isTween);
		},
	})),
	(ccs.MovementBoneData = ccs.Class.extend({
		delay: 0,
		scale: 1,
		duration: 0,
		frameList: null,
		name: '',
		ctor: function () {
			(this.delay = 0),
				(this.scale = 1),
				(this.duration = 0),
				(this.frameList = []),
				(this.name = '');
		},
		init: function () {
			return !0;
		},
		addFrameData: function (t) {
			this.frameList.push(t);
		},
		getFrameData: function (t) {
			return this.frameList[t];
		},
	})),
	(ccs.MovementData = function () {
		(this.name = ''),
			(this.duration = 0),
			(this.scale = 1),
			(this.durationTo = 0),
			(this.durationTween = 0),
			(this.loop = !0),
			(this.tweenEasing = ccs.TweenType.LINEAR),
			(this.movBoneDataDic = {});
	}),
	(ccs.MovementData.prototype.addMovementBoneData = function (t) {
		this.movBoneDataDic[t.name] = t;
	}),
	(ccs.MovementData.prototype.getMovementBoneData = function (t) {
		return this.movBoneDataDic[t];
	}),
	(ccs.AnimationData = function () {
		(this.movementDataDic = {}),
			(this.movementNames = []),
			(this.name = '');
	}),
	(ccs.AnimationData.prototype.addMovement = function (t) {
		(this.movementDataDic[t.name] = t), this.movementNames.push(t.name);
	}),
	(ccs.AnimationData.prototype.getMovement = function (t) {
		return this.movementDataDic[t];
	}),
	(ccs.AnimationData.prototype.getMovementCount = function () {
		return Object.keys(this.movementDataDic).length;
	}),
	(ccs.ContourVertex2 = function (t, e) {
		(this.x = t || 0), (this.y = e || 0);
	}),
	(ccs.ContourData = function () {
		this.vertexList = [];
	}),
	(ccs.ContourData.prototype.init = function () {
		return !(this.vertexList.length = 0);
	}),
	(ccs.ContourData.prototype.addVertex = function (t) {
		this.vertexList.push(t);
	}),
	(ccs.TextureData = function () {
		(this.height = 0),
			(this.width = 0),
			(this.pivotX = 0.5),
			(this.pivotY = 0.5),
			(this.name = ''),
			(this.contourDataList = []);
	}),
	(ccs.TextureData.prototype.init = function () {
		this.contourDataList.length = 0;
	}),
	(ccs.TextureData.prototype.addContourData = function (t) {
		this.contourDataList.push(t);
	}),
	(ccs.TextureData.prototype.getContourData = function (t) {
		return this.contourDataList[t];
	}),
	(ccs.DecorativeDisplay = ccs.Class.extend({
		_display: null,
		_colliderDetector: null,
		_displayData: null,
		ctor: function () {
			(this._display = null),
				(this._colliderDetector = null),
				(this._displayData = null);
		},
		init: function () {
			return !0;
		},
		setDisplay: function (t) {
			t._parent && (t._parent.removeChild(t), delete t._parent),
				(this._display = t);
		},
		getDisplay: function () {
			return this._display;
		},
		setColliderDetector: function (t) {
			this._colliderDetector = t;
		},
		getColliderDetector: function () {
			return this._colliderDetector;
		},
		setDisplayData: function (t) {
			this._displayData = t;
		},
		getDisplayData: function () {
			return this._displayData;
		},
		release: function () {
			(this._display = null),
				(this._displayData = null),
				(this._colliderDetector = null);
		},
	})),
	(ccs.DecorativeDisplay.create = function () {
		return new ccs.DecorativeDisplay();
	}),
	(ccs.displayFactory = {
		addDisplay: function (t, e, i) {
			switch (i.displayType) {
				case ccs.DISPLAY_TYPE_SPRITE:
					this.addSpriteDisplay(t, e, i);
					break;
				case ccs.DISPLAY_TYPE_PARTICLE:
					this.addParticleDisplay(t, e, i);
					break;
				case ccs.DISPLAY_TYPE_ARMATURE:
					this.addArmatureDisplay(t, e, i);
			}
		},
		createDisplay: function (t, e) {
			switch (e.getDisplayData().displayType) {
				case ccs.DISPLAY_TYPE_SPRITE:
					this.createSpriteDisplay(t, e);
					break;
				case ccs.DISPLAY_TYPE_PARTICLE:
					this.createParticleDisplay(t, e);
					break;
				case ccs.DISPLAY_TYPE_ARMATURE:
					this.createArmatureDisplay(t, e);
			}
		},
		_helpTransform: { a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 },
		updateDisplay: function (t, e, i) {
			var n,
				r,
				o,
				s,
				c = t.getDisplayRenderNode();
			if (c) {
				switch (t.getDisplayRenderNodeType()) {
					case ccs.DISPLAY_TYPE_SPRITE:
						i &&
							(c._renderCmd.setDirtyFlag(
								cc.Node._dirtyFlags.transformDirty
							),
							c.updateArmatureTransform());
						break;
					case ccs.DISPLAY_TYPE_PARTICLE:
						this.updateParticleDisplay(t, c, e);
						break;
					case ccs.DISPLAY_TYPE_ARMATURE:
						this.updateArmatureDisplay(t, c, e);
						break;
					default:
						var a = t.getNodeToArmatureTransform();
						c.setAdditionalTransform(a);
				}
				(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT ||
					ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX) &&
					(!i ||
						((n = (s = t
							.getDisplayManager()
							.getCurrentDecorativeDisplay()).getColliderDetector()) &&
							((r = (o =
								s.getDisplay()).getNodeToParentTransform()),
							((s = this._helpTransform).a = r.a),
							(s.b = r.b),
							(s.c = r.c),
							(s.d = r.d),
							(s.tx = r.tx),
							(s.ty = r.ty),
							(o = cc.pointApplyAffineTransform(
								o.getAnchorPointInPoints(),
								s
							)),
							(s.tx = o.x),
							(s.ty = o.y),
							(s = cc.affineTransformConcat(
								s,
								t.getArmature().getNodeToParentTransform()
							)),
							n.updateTransform(s))));
			}
		},
		addSpriteDisplay: function (t, e, i) {
			var n = new ccs.SpriteDisplayData();
			n.copy(i), e.setDisplayData(n), this.createSpriteDisplay(t, e);
		},
		createSpriteDisplay: function (t, e) {
			var i = null,
				n = e.getDisplayData(),
				r = n.displayName,
				o = r.lastIndexOf('.');
			-1 !== o && (r = r.substring(0, o)),
				(i =
					'' === r ? new ccs.Skin() : new ccs.Skin('#' + r + '.png')),
				e.setDisplay(i),
				i.setBone(t),
				this.initSpriteDisplay(t, e, n.displayName, i);
			e = t.getArmature();
			e &&
				(e.getArmatureData().dataVersion >= ccs.CONST_VERSION_COMBINED
					? i.setSkinData(n.skinData)
					: i.setSkinData(t.boneData));
		},
		initSpriteDisplay: function (t, e, i, n) {
			var r = i,
				i = r.lastIndexOf('.');
			-1 !== i && (r = r.substring(0, i));
			r = ccs.armatureDataManager.getTextureData(r);
			r && n.setAnchorPoint(cc.p(r.pivotX, r.pivotY)),
				(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT ||
					ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX) &&
					r &&
					0 < r.contourDataList.length &&
					((t = new ccs.ColliderDetector(t)).addContourDataList(
						r.contourDataList
					),
					e.setColliderDetector(t));
		},
		addArmatureDisplay: function (t, e, i) {
			var n = new ccs.ArmatureDisplayData();
			n.copy(i), e.setDisplayData(n), this.createArmatureDisplay(t, e);
		},
		createArmatureDisplay: function (t, e) {
			var i = e.getDisplayData(),
				t = new ccs.Armature(i.displayName, t);
			e.setDisplay(t);
		},
		updateArmatureDisplay: function (t, e, i) {
			e && (e.sortAllChildren(), e.update(i));
		},
		addParticleDisplay: function (t, e, i) {
			var n = new ccs.ParticleDisplayData();
			n.copy(i), e.setDisplayData(n), this.createParticleDisplay(t, e);
		},
		createParticleDisplay: function (t, e) {
			var i = e.getDisplayData(),
				i = new cc.ParticleSystem(i.displayName);
			i.removeFromParent(),
				i.cleanup(),
				t.getArmature() && i.setParent(t.getArmature()),
				e.setDisplay(i);
		},
		updateParticleDisplay: function (t, e, i) {
			var n = new ccs.BaseData();
			ccs.TransformHelp.matrixToNode(t.nodeToArmatureTransform(), n),
				e.setPosition(n.x, n.y),
				e.setScaleX(n.scaleX),
				e.setScaleY(n.scaleY),
				e.update(i);
		},
	}),
	(ccs.DisplayManager = ccs.Class.extend({
		_decoDisplayList: null,
		_currentDecoDisplay: null,
		_displayRenderNode: null,
		_displayIndex: null,
		_forceChangeDisplay: !1,
		_bone: null,
		_visible: !0,
		_displayType: null,
		ctor: function (t) {
			(this._decoDisplayList = []),
				(this._currentDecoDisplay = null),
				(this._displayRenderNode = null),
				(this._displayIndex = null),
				(this._forceChangeDisplay = !1),
				(this._bone = null),
				(this._visible = !0),
				(this._displayType = ccs.DISPLAY_TYPE_MAX),
				t && ccs.DisplayManager.prototype.init.call(this, t);
		},
		init: function (t) {
			return (this._bone = t), this.initDisplayList(t.getBoneData()), !0;
		},
		addDisplay: function (t, e) {
			var i,
				n = this._decoDisplayList;
			if (
				(0 <= e && e < n.length
					? (i = n[e])
					: ((i = new ccs.DecorativeDisplay()), n.push(i)),
				t instanceof ccs.DisplayData)
			)
				return (
					ccs.displayFactory.addDisplay(this._bone, i, t),
					void (
						e === this._displayIndex &&
						((this._displayIndex = -1),
						this.changeDisplayWithIndex(e, !1))
					)
				);
			var r = null;
			if (t instanceof ccs.Skin) {
				t.setBone(this._bone),
					(r = new ccs.SpriteDisplayData()),
					ccs.displayFactory.initSpriteDisplay(
						this._bone,
						i,
						t.getDisplayName(),
						t
					);
				var o = i.getDisplayData();
				if (o instanceof ccs.SpriteDisplayData)
					t.setSkinData(o.skinData), (r.skinData = o.skinData);
				else {
					for (var s = !1, c = n.length - 2; 0 <= c; c--) {
						var a = n[c].getDisplayData();
						if (a instanceof ccs.SpriteDisplayData) {
							(s = !0),
								t.setSkinData(a.skinData),
								(r.skinData = a.skinData);
							break;
						}
					}
					s || t.setSkinData(new ccs.BaseData());
				}
			} else
				t instanceof cc.ParticleSystem
					? ((r = new ccs.ParticleDisplayData()),
					  t.removeFromParent(),
					  t.cleanup(),
					  (o = this._bone.getArmature()) && t.setParent(o))
					: t instanceof ccs.Armature
					? (((r = new ccs.ArmatureDisplayData()).displayName =
							t.getName()),
					  t.setParentBone(this._bone))
					: (r = new ccs.DisplayData());
			i.setDisplay(t),
				i.setDisplayData(r),
				e === this._displayIndex &&
					((this._displayIndex = -1),
					this.changeDisplayWithIndex(e, !1));
		},
		_addDisplayOther: function (t, e) {
			var i = null;
			if (e instanceof ccs.Skin) {
				var n = e;
				n.setBone(this._bone),
					((i = new ccs.SpriteDisplayData()).displayName =
						n.getDisplayName()),
					ccs.displayFactory.initSpriteDisplay(
						this._bone,
						t,
						n.getDisplayName(),
						n
					);
				var r = t.getDisplayData();
				if (r instanceof ccs.SpriteDisplayData)
					n.setSkinData(r.skinData);
				else {
					for (
						var o = !1, s = this._decoDisplayList.length - 2;
						0 <= s;
						s--
					) {
						var c = this._decoDisplayList[s].getDisplayData();
						if (c) {
							(o = !0),
								n.setSkinData(c.skinData),
								(i.skinData = c.skinData);
							break;
						}
					}
					o || n.setSkinData(new ccs.BaseData()),
						n.setSkinData(new ccs.BaseData());
				}
			} else
				e instanceof cc.ParticleSystem
					? ((i = new ccs.ParticleDisplayData()).displayName =
							e._plistFile)
					: e instanceof ccs.Armature
					? (((i = new ccs.ArmatureDisplayData()).displayName =
							e.getName()),
					  e.setParentBone(this._bone))
					: (i = new ccs.DisplayData());
			t.setDisplay(e), t.setDisplayData(i);
		},
		removeDisplay: function (t) {
			this._decoDisplayList.splice(t, 1),
				t === this._displayIndex &&
					(this.setCurrentDecorativeDisplay(null),
					(this._displayIndex = -1));
		},
		getDecorativeDisplayList: function () {
			return this._decoDisplayList;
		},
		changeDisplayWithIndex: function (t, e) {
			t >= this._decoDisplayList.length
				? cc.log('the index value is out of range')
				: ((this._forceChangeDisplay = e),
				  this._displayIndex !== t &&
						((this._displayIndex = t) < 0
							? this._displayRenderNode &&
							  (this._displayRenderNode.removeFromParent(!0),
							  this.setCurrentDecorativeDisplay(null))
							: this.setCurrentDecorativeDisplay(
									this._decoDisplayList[t]
							  )));
		},
		changeDisplayWithName: function (t, e) {
			for (var i = this._decoDisplayList, n = 0; n < i.length; n++)
				if (i[n].getDisplayData().displayName === t) {
					this.changeDisplayWithIndex(n, e);
					break;
				}
		},
		setCurrentDecorativeDisplay: function (t) {
			var e = this._currentDecoDisplay;
			(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT ||
				ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX) &&
				e &&
				e.getColliderDetector() &&
				e.getColliderDetector().setActive(!1),
				(this._currentDecoDisplay = t),
				(e = this._currentDecoDisplay),
				(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT ||
					ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX) &&
					e &&
					e.getColliderDetector() &&
					e.getColliderDetector().setActive(!0);
			var i = e ? e.getDisplay() : null,
				t = this._displayRenderNode,
				e = this._bone;
			t &&
				(t instanceof ccs.Armature && e.setChildArmature(null),
				t.removeFromParent(!0)),
				(this._displayRenderNode = i)
					? (i instanceof ccs.Armature
							? (this._bone.setChildArmature(i),
							  i.setParentBone(this._bone))
							: i instanceof cc.ParticleSystem &&
							  (i instanceof ccs.Armature
									? (e.setChildArmature(i),
									  i.setParentBone(e))
									: i instanceof cc.ParticleSystem &&
									  i.resetSystem()),
					  i.setColor(e.getDisplayedColor()),
					  i.setOpacity(e.getDisplayedOpacity()),
					  this._displayRenderNode.setVisible(this._visible),
					  (this._displayType =
							this._currentDecoDisplay.getDisplayData().displayType))
					: (this._displayType = ccs.DISPLAY_TYPE_MAX),
				(cc.renderer.childrenOrderDirty = !0);
		},
		getDisplayRenderNode: function () {
			return this._displayRenderNode;
		},
		getDisplayRenderNodeType: function () {
			return this._displayType;
		},
		getCurrentDisplayIndex: function () {
			return this._displayIndex;
		},
		getCurrentDecorativeDisplay: function () {
			return this._currentDecoDisplay;
		},
		getDecorativeDisplayByIndex: function (t) {
			return this._decoDisplayList[t];
		},
		initDisplayList: function (t) {
			if (((this._decoDisplayList.length = 0), t))
				for (
					var e = t.displayDataList,
						i = this._decoDisplayList,
						n = this._bone,
						r = 0;
					r < e.length;
					r++
				) {
					var o = e[r],
						s = new ccs.DecorativeDisplay();
					s.setDisplayData(o),
						ccs.displayFactory.createDisplay(n, s),
						i.push(s);
				}
		},
		containPoint: function (t, e) {
			if (!this._visible || this._displayIndex < 0) return !1;
			if (
				(void 0 !== e && (t = cc.p(t, e)),
				this._currentDecoDisplay.getDisplayData().displayType !==
					ccs.DISPLAY_TYPE_SPRITE)
			)
				return !1;
			e = (e = this._currentDecoDisplay.getDisplay()).getChildByTag(0);
			return ccs.SPRITE_CONTAIN_POINT_WITH_RETURN(e, t);
		},
		setVisible: function (t) {
			this._displayRenderNode &&
				((this._visible = t), this._displayRenderNode.setVisible(t));
		},
		isVisible: function () {
			return this._visible;
		},
		getContentSize: function () {
			return this._displayRenderNode
				? this._displayRenderNode.getContentSize()
				: cc.size(0, 0);
		},
		getBoundingBox: function () {
			return this._displayRenderNode
				? this._displayRenderNode.getBoundingBox()
				: cc.rect(0, 0, 0, 0);
		},
		getAnchorPoint: function () {
			return this._displayRenderNode
				? this._displayRenderNode.getAnchorPoint()
				: cc.p(0, 0);
		},
		getAnchorPointInPoints: function () {
			return this._displayRenderNode
				? this._displayRenderNode.getAnchorPointInPoints()
				: cc.p(0, 0);
		},
		getForceChangeDisplay: function () {
			return this._forceChangeDisplay;
		},
		release: function () {
			(this._decoDisplayList = null),
				this._displayRenderNode &&
					(this._displayRenderNode.removeFromParent(!0),
					(this._displayRenderNode = null));
		},
	})),
	(ccs.DisplayManager.create = function (t) {
		return new ccs.DisplayManager(t);
	}),
	(ccs.Skin = ccs.Sprite.extend({
		_skinData: null,
		bone: null,
		_skinTransform: null,
		_displayName: '',
		_armature: null,
		_className: 'Skin',
		ctor: function (t, e) {
			cc.Sprite.prototype.ctor.call(this),
				(this._skinData = null),
				(this.bone = null),
				(this._displayName = ''),
				(this._skinTransform = cc.affineTransformIdentity()),
				(this._armature = null) == t || '' === t
					? ccs.Skin.prototype.init.call(this)
					: '#' === t[0]
					? ccs.Skin.prototype.initWithSpriteFrameName.call(
							this,
							t.substr(1)
					  )
					: ccs.Skin.prototype.initWithFile.call(this, t, e);
		},
		initWithSpriteFrameName: function (t) {
			if ('' === t) return !1;
			var e = cc.spriteFrameCache.getSpriteFrame(t),
				i = !0;
			return (
				e
					? this.initWithSpriteFrame(e)
					: (cc.log(
							"Can't find CCSpriteFrame with %s. Please check your .plist file",
							t
					  ),
					  (i = !1)),
				(this._displayName = t),
				i
			);
		},
		initWithFile: function (t, e) {
			e = e
				? cc.Sprite.prototype.initWithFile.call(this, t, e)
				: cc.Sprite.prototype.initWithFile.call(this, t);
			return (this._displayName = t), e;
		},
		setSkinData: function (t) {
			(this._skinData = t),
				this.setScaleX(t.scaleX),
				this.setScaleY(t.scaleY),
				this.setRotationX(cc.radiansToDegrees(t.skewX)),
				this.setRotationY(cc.radiansToDegrees(-t.skewY)),
				this.setPosition(t.x, t.y),
				this._renderCmd.transform();
		},
		getSkinData: function () {
			return this._skinData;
		},
		updateArmatureTransform: function () {
			this._renderCmd.transform();
		},
		getNodeToWorldTransform: function () {
			return this._renderCmd.getNodeToWorldTransform();
		},
		getNodeToWorldTransformAR: function () {
			return this._renderCmd.getNodeToWorldTransformAR();
		},
		setBone: function (t) {
			this.bone = t;
			t = this.bone.getArmature();
			t && (this._armature = t);
		},
		getBone: function () {
			return this.bone;
		},
		getDisplayName: function () {
			return this._displayName;
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? ccs.Skin.CanvasRenderCmd
					: ccs.Skin.WebGLRenderCmd
			)(this);
		},
	}));
var _p = ccs.Skin.prototype;
_p.skinData,
	cc.defineGetterSetter(_p, 'skinData', _p.getSkinData, _p.setSkinData),
	_p.displayName,
	cc.defineGetterSetter(_p, 'displayName', _p.getDisplayName),
	(_p = null),
	(ccs.Skin.create = function (t, e) {
		return new ccs.Skin(t, e);
	}),
	(ccs.Skin.createWithSpriteFrameName = function (t) {
		return new ccs.Skin('#' + t);
	}),
	(function () {
		(ccs.Skin.RenderCmd = {
			_realWorldTM: null,
			transform: function (t, e) {
				var i,
					n,
					r = this._node,
					o = t ? t._worldTransform : null,
					s = this._transform,
					c = this._worldTransform;
				(this._dirtyFlag & cc.Node._dirtyFlags.transformDirty || o) &&
					(this.originTransform(),
					cc.affineTransformConcatIn(
						s,
						r.bone.getNodeToArmatureTransform()
					),
					(this._dirtyFlag =
						(this._dirtyFlag & cc.Node._dirtyFlags.transformDirty) ^
						this._dirtyFlag)),
					o
						? ((c.a = s.a * o.a + s.b * o.c),
						  (c.b = s.a * o.b + s.b * o.d),
						  (c.c = s.c * o.a + s.d * o.c),
						  (c.d = s.c * o.b + s.d * o.d),
						  (c.tx = s.tx * o.a + s.ty * o.c + o.tx),
						  (c.ty = s.tx * o.b + s.ty * o.d + o.ty),
						  (i = this._vertices) &&
								((t =
									(n = r._offsetPosition.x) + r._rect.width),
								(r =
									(o = r._offsetPosition.y) + r._rect.height),
								(i[0].x = n * c.a + r * c.c + c.tx),
								(i[0].y = n * c.b + r * c.d + c.ty),
								(i[1].x = n * c.a + o * c.c + c.tx),
								(i[1].y = n * c.b + o * c.d + c.ty),
								(i[2].x = t * c.a + r * c.c + c.tx),
								(i[2].y = t * c.b + r * c.d + c.ty),
								(i[3].x = t * c.a + o * c.c + c.tx),
								(i[3].y = t * c.b + o * c.d + c.ty)))
						: ((c.a = s.a),
						  (c.b = s.b),
						  (c.c = s.c),
						  (c.d = s.d),
						  (c.tx = s.tx),
						  (c.ty = s.ty));
				c = this._realWorldTM;
				c &&
					((c.a = s.a),
					(c.b = s.b),
					(c.c = s.c),
					(c.d = s.d),
					(c.tx = s.tx),
					(c.ty = s.ty),
					cc.affineTransformConcatIn(
						c,
						this._node.bone.getArmature()._renderCmd._worldTransform
					));
			},
			getNodeToWorldTransform: function () {
				return cc.affineTransformConcat(
					this._transform,
					this._node.bone.getArmature().getNodeToWorldTransform()
				);
			},
			getNodeToWorldTransformAR: function () {
				var t = this._transform,
					e = this._node;
				return (
					(this._anchorPointInPoints = cc.pointApplyAffineTransform(
						this._anchorPointInPoints,
						t
					)),
					(t.tx = this._anchorPointInPoints.x),
					(t.ty = this._anchorPointInPoints.y),
					cc.affineTransformConcat(
						t,
						e.bone.getArmature().getNodeToWorldTransform()
					)
				);
			},
		}),
			(ccs.Skin.CanvasRenderCmd = function (t) {
				cc.Sprite.CanvasRenderCmd.call(this, t),
					(this._realWorldTM = {
						a: 1,
						b: 0,
						c: 0,
						d: 1,
						tx: 0,
						ty: 0,
					});
			});
		var t = (ccs.Skin.CanvasRenderCmd.prototype = Object.create(
			cc.Sprite.CanvasRenderCmd.prototype
		));
		cc.inject(ccs.Skin.RenderCmd, t),
			(t.constructor = ccs.Skin.CanvasRenderCmd),
			(t._updateCurrentRegions = function () {
				var t = this._currentRegion;
				(this._currentRegion = this._oldRegion),
					(this._oldRegion = t),
					cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble !==
						this._regionFlag ||
						this._currentRegion.isEmpty() ||
						this._oldRegion.union(this._currentRegion),
					this._currentRegion.updateRegion(
						this.getLocalBB(),
						this._realWorldTM
					);
			}),
			(ccs.Skin.WebGLRenderCmd = function (t) {
				cc.Sprite.WebGLRenderCmd.call(this, t);
			}),
			(t = ccs.Skin.WebGLRenderCmd.prototype =
				Object.create(cc.Sprite.WebGLRenderCmd.prototype)),
			cc.inject(ccs.Skin.RenderCmd, t),
			(t.constructor = ccs.Skin.WebGLRenderCmd);
	})(),
	(ccs.ANIMATION_TYPE_SINGLE_FRAME = -4),
	(ccs.ANIMATION_TYPE_NO_LOOP = -3),
	(ccs.ANIMATION_TYPE_TO_LOOP_FRONT = -2),
	(ccs.ANIMATION_TYPE_TO_LOOP_BACK = -1),
	(ccs.ANIMATION_TYPE_LOOP_FRONT = 0),
	(ccs.ANIMATION_TYPE_LOOP_BACK = 1),
	(ccs.ANIMATION_TYPE_MAX = 2),
	(ccs.ProcessBase = ccs.Class.extend({
		_processScale: 1,
		_isComplete: !0,
		_isPause: !0,
		_isPlaying: !1,
		_currentPercent: 0,
		_rawDuration: 0,
		_loopType: 0,
		_tweenEasing: 0,
		animationInternal: null,
		_currentFrame: 0,
		_durationTween: 0,
		_nextFrameIndex: 0,
		_curFrameIndex: null,
		_isLoopBack: !1,
		ctor: function () {
			(this._processScale = 1),
				(this._isComplete = !0),
				(this._isPause = !0),
				(this._isPlaying = !1),
				(this._currentFrame = 0),
				(this._currentPercent = 0),
				(this._durationTween = 0),
				(this._rawDuration = 0),
				(this._loopType = ccs.ANIMATION_TYPE_LOOP_BACK),
				(this._tweenEasing = ccs.TweenType.LINEAR),
				(this.animationInternal = 1 / 60),
				(this._curFrameIndex = 0),
				(this._durationTween = 0),
				(this._isLoopBack = !1);
		},
		pause: function () {
			(this._isPause = !0), (this._isPlaying = !1);
		},
		resume: function () {
			(this._isPause = !1), (this._isPlaying = !0);
		},
		stop: function () {
			(this._isComplete = !0), (this._isPlaying = !1);
		},
		play: function (t, e, i, n) {
			(this._isComplete = !1),
				(this._isPause = !1),
				(this._isPlaying = !0),
				(this._currentFrame = 0),
				(this._nextFrameIndex = t),
				(this._tweenEasing = n);
		},
		update: function (t) {
			var e, i;
			this._isComplete ||
				this._isPause ||
				this._rawDuration <= 0 ||
				1 < t ||
				((e =
					void 0 === this._nextFrameIndex ? 0 : this._nextFrameIndex),
				(i = this._currentFrame),
				(i =
					e <= 0
						? ((this._currentPercent = 1), 0)
						: ((i +=
								this._processScale *
								(t / this.animationInternal)),
						  (this._currentPercent = i / e),
						  ccs.fmodf(i, e))),
				(this._currentFrame = i),
				this.updateHandler());
		},
		gotoFrame: function (t) {
			var e = this._loopType;
			e === ccs.ANIMATION_TYPE_NO_LOOP
				? (e = ccs.ANIMATION_TYPE_MAX)
				: e === ccs.ANIMATION_TYPE_TO_LOOP_FRONT &&
				  (e = ccs.ANIMATION_TYPE_LOOP_FRONT),
				(this._loopType = e),
				(this._curFrameIndex = t),
				(this._nextFrameIndex = this._durationTween);
		},
		getCurrentFrameIndex: function () {
			return (
				(this._curFrameIndex =
					(this._rawDuration - 1) * this._currentPercent),
				this._curFrameIndex
			);
		},
		updateHandler: function () {},
		isPause: function () {
			return this._isPause;
		},
		isComplete: function () {
			return this._isComplete;
		},
		getCurrentPercent: function () {
			return this._currentPercent;
		},
		getRawDuration: function () {
			return this._rawDuration;
		},
		getLoop: function () {
			return this._loopType;
		},
		getTweenEasing: function () {
			return this._tweenEasing;
		},
		getAnimationInternal: function () {
			return this.animationInternal;
		},
		setAnimationInternal: function (t) {
			this.animationInternal = t;
		},
		getProcessScale: function () {
			return this._processScale;
		},
		setProcessScale: function (t) {
			this._processScale = t;
		},
		isPlaying: function () {
			return this._isPlaying;
		},
	}));
var _p = ccs.ProcessBase.prototype;
_p.currentFrameIndex,
	cc.defineGetterSetter(_p, 'currentFrameIndex', _p.getCurrentFrameIndex),
	_p.paused,
	cc.defineGetterSetter(_p, 'paused', _p.isPause),
	_p.completed,
	cc.defineGetterSetter(_p, 'completed', _p.isComplete),
	_p.currentPercent,
	cc.defineGetterSetter(_p, 'currentPercent', _p.getCurrentPercent),
	_p.rawDuration,
	cc.defineGetterSetter(_p, 'rawDuration', _p.getRawDuration),
	_p.loop,
	cc.defineGetterSetter(_p, 'loop', _p.getLoop),
	_p.tweenEasing,
	cc.defineGetterSetter(_p, 'tweenEasing', _p.getTweenEasing),
	_p.playing,
	cc.defineGetterSetter(_p, 'playing', _p.isPlaying),
	(_p = null),
	(ccs.MovementEventType = { start: 0, complete: 1, loopComplete: 2 }),
	(ccs.AnimationEvent = ccs.Class.extend({
		_arguments: null,
		_callFunc: null,
		_selectorTarget: null,
		ctor: function (t, e, i) {
			(this._data = i), (this._callFunc = t), (this._selectorTarget = e);
		},
		call: function () {
			this._callFunc &&
				this._callFunc.apply(this._selectorTarget, this._arguments);
		},
		setArguments: function (t) {
			this._arguments = t;
		},
	})),
	(ccs.MovementEvent = function () {
		(this.armature = null),
			(this.movementType = ccs.MovementEventType.start),
			(this.movementID = '');
	}),
	(ccs.FrameEvent = function () {
		(this.bone = null),
			(this.frameEventName = ''),
			(this.originFrameIndex = 0),
			(this.currentFrameIndex = 0);
	}),
	(ccs.ArmatureAnimation = ccs.ProcessBase.extend({
		_animationData: null,
		_movementData: null,
		_armature: null,
		_movementID: '',
		_toIndex: 0,
		_tweenList: null,
		_speedScale: 1,
		_ignoreFrameEvent: !1,
		_frameEventQueue: null,
		_movementEventQueue: null,
		_movementList: null,
		_onMovementList: !1,
		_movementListLoop: !1,
		_movementIndex: 0,
		_movementListDurationTo: -1,
		_movementEventCallFunc: null,
		_frameEventCallFunc: null,
		_movementEventTarget: null,
		_frameEventTarget: null,
		_movementEventListener: null,
		_frameEventListener: null,
		ctor: function (t) {
			ccs.ProcessBase.prototype.ctor.call(this),
				(this._tweenList = []),
				(this._movementList = []),
				(this._frameEventQueue = []),
				(this._movementEventQueue = []),
				(this._armature = null),
				t && ccs.ArmatureAnimation.prototype.init.call(this, t);
		},
		init: function (t) {
			return (this._armature = t), !(this._tweenList.length = 0);
		},
		pause: function () {
			for (var t = this._tweenList, e = 0; e < t.length; e++)
				t[e].pause();
			ccs.ProcessBase.prototype.pause.call(this);
		},
		resume: function () {
			for (var t = this._tweenList, e = 0; e < t.length; e++)
				t[e].resume();
			ccs.ProcessBase.prototype.resume.call(this);
		},
		stop: function () {
			for (var t = this._tweenList, e = 0; e < t.length; e++) t[e].stop();
			(t.length = 0), ccs.ProcessBase.prototype.stop.call(this);
		},
		setAnimationScale: function (t) {
			this.setSpeedScale(t);
		},
		getAnimationScale: function () {
			return this.getSpeedScale();
		},
		setSpeedScale: function (t) {
			if (t !== this._speedScale) {
				(this._speedScale = t),
					(this._processScale = this._movementData
						? this._speedScale * this._movementData.scale
						: this._speedScale);
				var e,
					i = this._armature.getBoneDic();
				for (e in i) {
					var n = i[e];
					n.getTween().setProcessScale(this._processScale),
						n.getChildArmature() &&
							n
								.getChildArmature()
								.getAnimation()
								.setSpeedScale(this._processScale);
				}
			}
		},
		getSpeedScale: function () {
			return this._speedScale;
		},
		play: function (t, e, i) {
			cc.assert(
				this._animationData,
				'this.animationData can not be null'
			),
				(this._movementData = this._animationData.getMovement(t)),
				cc.assert(
					this._movementData,
					'this._movementData can not be null'
				),
				(e = void 0 === e ? -1 : e),
				(i = void 0 === i ? -1 : i),
				(this._rawDuration = this._movementData.duration),
				(this._movementID = t),
				(this._processScale =
					this._speedScale * this._movementData.scale),
				(e = -1 === e ? this._movementData.durationTo : e);
			var n =
					0 === this._movementData.durationTween
						? this._rawDuration
						: this._movementData.durationTween,
				r = this._movementData.tweenEasing;
			(i = i < 0 ? this._movementData.loop : i),
				(this._onMovementList = !1),
				ccs.ProcessBase.prototype.play.call(this, e, n, i, r),
				0 === this._rawDuration
					? (this._loopType = ccs.ANIMATION_TYPE_SINGLE_FRAME)
					: ((this._loopType = i
							? ccs.ANIMATION_TYPE_TO_LOOP_FRONT
							: ccs.ANIMATION_TYPE_NO_LOOP),
					  (this._durationTween = n)),
				(this._tweenList.length = 0);
			var o,
				s = this._armature.getBoneDic();
			for (o in s) {
				var c = s[o],
					a = this._movementData.movBoneDataDic[c.getName()],
					l = c.getTween();
				a && 0 < a.frameList.length
					? (this._tweenList.push(l),
					  (a.duration = this._movementData.duration),
					  l.play(a, e, n, i, r),
					  l.setProcessScale(this._processScale),
					  c.getChildArmature() &&
							(c
								.getChildArmature()
								.getAnimation()
								.setSpeedScale(this._processScale),
							c.getChildArmature().getAnimation().isPlaying() ||
								c
									.getChildArmature()
									.getAnimation()
									.playWithIndex(0)))
					: c.isIgnoreMovementBoneData() ||
					  (c.getDisplayManager().changeDisplayWithIndex(-1, !1),
					  l.stop());
			}
			this._armature.update(0);
		},
		playByIndex: function (t, e, i, n, r) {
			cc.log('playByIndex is deprecated. Use playWithIndex instead.'),
				this.playWithIndex(t, e, n);
		},
		playWithIndex: function (t, e, i) {
			var n = this._animationData.movementNames;
			cc.assert(-1 < t && t < n.length);
			t = n[t];
			this.play(t, e, i);
		},
		playWithNames: function (t, e, i) {
			(e = void 0 === e ? -1 : e),
				(i = void 0 === i || i),
				(this._movementListLoop = i),
				(this._movementListDurationTo = e),
				(this._onMovementList = !0),
				(this._movementIndex = 0),
				t instanceof Array
					? (this._movementList = t)
					: (this._movementList.length = 0),
				this.updateMovementList();
		},
		playWithIndexes: function (t, e, i) {
			(e = void 0 === e ? -1 : e),
				(i = void 0 === i || i),
				(this._movementList.length = 0),
				(this._movementListLoop = i),
				(this._movementListDurationTo = e),
				(this._onMovementList = !0),
				(this._movementIndex = 0);
			for (
				var n = this._animationData.movementNames, r = 0;
				r < t.length;
				r++
			) {
				var o = n[t[r]];
				this._movementList.push(o);
			}
			this.updateMovementList();
		},
		gotoAndPlay: function (t) {
			if (
				!this._movementData ||
				t < 0 ||
				t >= this._movementData.duration
			)
				cc.log(
					'Please ensure you have played a movement, and the frameIndex is in the range.'
				);
			else {
				var e = this._ignoreFrameEvent;
				(this._ignoreFrameEvent = !0),
					(this._isPlaying = !0),
					(this._isComplete = this._isPause = !1),
					ccs.ProcessBase.prototype.gotoFrame.call(this, t),
					(this._currentPercent =
						this._curFrameIndex /
						(this._movementData.duration - 1)),
					(this._currentFrame =
						this._nextFrameIndex * this._currentPercent);
				for (var i = this._tweenList, n = 0; n < i.length; n++)
					i[n].gotoAndPlay(t);
				this._armature.update(0), (this._ignoreFrameEvent = e);
			}
		},
		gotoAndPause: function (t) {
			this.gotoAndPlay(t), this.pause();
		},
		getMovementCount: function () {
			return this._animationData.getMovementCount();
		},
		update: function (t) {
			ccs.ProcessBase.prototype.update.call(this, t);
			for (var e = this._tweenList, i = 0; i < e.length; i++)
				e[i].update(t);
			for (var n, r = this._frameEventQueue; 0 < r.length; )
				(n = r.shift()),
					(this._ignoreFrameEvent = !0),
					this._frameEventCallFunc &&
						this._frameEventCallFunc.call(
							this._frameEventTarget,
							n.bone,
							n.frameEventName,
							n.originFrameIndex,
							n.currentFrameIndex
						),
					this._frameEventListener &&
						this._frameEventListener(
							n.bone,
							n.frameEventName,
							n.originFrameIndex,
							n.currentFrameIndex
						),
					(this._ignoreFrameEvent = !1);
			for (var o = this._movementEventQueue; 0 < o.length; )
				(n = o.shift()),
					this._movementEventCallFunc &&
						this._movementEventCallFunc.call(
							this._movementEventTarget,
							n.armature,
							n.movementType,
							n.movementID
						),
					this._movementEventListener &&
						this._movementEventListener(
							n.armature,
							n.movementType,
							n.movementID
						);
		},
		updateHandler: function () {
			var t = this._currentPercent;
			if (1 <= t) {
				switch (this._loopType) {
					case ccs.ANIMATION_TYPE_NO_LOOP:
						if (
							((this._loopType = ccs.ANIMATION_TYPE_MAX),
							(this._currentFrame =
								(t - 1) * this._nextFrameIndex),
							(t = this._currentFrame / this._durationTween) < 1)
						) {
							(this._nextFrameIndex = this._durationTween),
								this.movementEvent(
									this._armature,
									ccs.MovementEventType.start,
									this._movementID
								);
							break;
						}
						break;
					case ccs.ANIMATION_TYPE_MAX:
					case ccs.ANIMATION_TYPE_SINGLE_FRAME:
						(t = 1),
							(this._isComplete = !0),
							(this._isPlaying = !1),
							this.movementEvent(
								this._armature,
								ccs.MovementEventType.complete,
								this._movementID
							),
							this.updateMovementList();
						break;
					case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:
						(this._loopType = ccs.ANIMATION_TYPE_LOOP_FRONT),
							(t = ccs.fmodf(t, 1)),
							(this._currentFrame =
								0 === this._nextFrameIndex
									? 0
									: ccs.fmodf(
											this._currentFrame,
											this._nextFrameIndex
									  )),
							(this._nextFrameIndex =
								0 < this._durationTween
									? this._durationTween
									: 1),
							this.movementEvent(
								this,
								ccs.MovementEventType.start,
								this._movementID
							);
						break;
					default:
						(this._currentFrame = ccs.fmodf(
							this._currentFrame,
							this._nextFrameIndex
						)),
							(this._toIndex = 0),
							this.movementEvent(
								this._armature,
								ccs.MovementEventType.loopComplete,
								this._movementID
							);
				}
				this._currentPercent = t;
			}
		},
		getCurrentMovementID: function () {
			return this._isComplete ? '' : this._movementID;
		},
		setMovementEventCallFunc: function (t, e) {
			1 === arguments.length
				? (this._movementEventListener = t)
				: 2 === arguments.length &&
				  ((this._movementEventTarget = e),
				  (this._movementEventCallFunc = t));
		},
		setFrameEventCallFunc: function (t, e) {
			1 === arguments.length
				? (this._frameEventListener = t)
				: 2 === arguments.length &&
				  ((this._frameEventTarget = e),
				  (this._frameEventCallFunc = t));
		},
		setUserObject: function (t) {
			this._userObject = t;
		},
		frameEvent: function (t, e, i, n) {
			var r;
			((this._frameEventTarget && this._frameEventCallFunc) ||
				this._frameEventListener) &&
				(((r = new ccs.FrameEvent()).bone = t),
				(r.frameEventName = e),
				(r.originFrameIndex = i),
				(r.currentFrameIndex = n),
				this._frameEventQueue.push(r));
		},
		movementEvent: function (t, e, i) {
			var n;
			((this._movementEventTarget && this._movementEventCallFunc) ||
				this._movementEventListener) &&
				(((n = new ccs.MovementEvent()).armature = t),
				(n.movementType = e),
				(n.movementID = i),
				this._movementEventQueue.push(n));
		},
		updateMovementList: function () {
			var t, e;
			this._onMovementList &&
				((e = this._movementList),
				this._movementListLoop
					? ((t = e[this._movementIndex]),
					  this.play(t, t.durationTo, 0),
					  this._movementIndex++,
					  this._movementIndex >= e.length &&
							(this._movementIndex = 0))
					: this._movementIndex < e.length
					? ((t = e[this._movementIndex]),
					  this.play(t, t.durationTo, 0),
					  this._movementIndex++)
					: (this._onMovementList = !1),
				(this._onMovementList = !0));
		},
		setAnimationData: function (t) {
			this._animationData !== t && (this._animationData = t);
		},
		getAnimationData: function () {
			return this._animationData;
		},
		getUserObject: function () {
			return this._userObject;
		},
		isIgnoreFrameEvent: function () {
			return this._ignoreFrameEvent;
		},
	}));
var _p = ccs.ArmatureAnimation.prototype;
_p.speedScale,
	cc.defineGetterSetter(_p, 'speedScale', _p.getSpeedScale, _p.setSpeedScale),
	_p.animationScale,
	cc.defineGetterSetter(
		_p,
		'animationScale',
		_p.getAnimationScale,
		_p.setAnimationScale
	),
	(_p = null),
	(ccs.ArmatureAnimation.create = function (t) {
		return new ccs.ArmatureAnimation(t);
	}),
	(ccs.Tween = ccs.ProcessBase.extend({
		_tweenData: null,
		_to: null,
		_from: null,
		_between: null,
		_movementBoneData: null,
		_bone: null,
		_frameTweenEasing: 0,
		_betweenDuration: 0,
		_totalDuration: 0,
		_toIndex: 0,
		_fromIndex: 0,
		_animation: null,
		_passLastFrame: !1,
		ctor: function (t) {
			ccs.ProcessBase.prototype.ctor.call(this),
				(this._frameTweenEasing = ccs.TweenType.LINEAR),
				ccs.Tween.prototype.init.call(this, t);
		},
		init: function (t) {
			return (
				(this._from = new ccs.FrameData()),
				(this._between = new ccs.FrameData()),
				(this._bone = t),
				(this._tweenData = this._bone.getTweenData()),
				(this._tweenData.displayIndex = -1),
				(this._animation =
					null !== this._bone && null !== this._bone.getArmature()
						? this._bone.getArmature().getAnimation()
						: null),
				!0
			);
		},
		play: function (t, e, i, n, r) {
			ccs.ProcessBase.prototype.play.call(this, e, i, n, r),
				(this._loopType = n
					? ccs.ANIMATION_TYPE_TO_LOOP_FRONT
					: ccs.ANIMATION_TYPE_NO_LOOP),
				(this._totalDuration = 0),
				(this._betweenDuration = 0),
				(this._fromIndex = this._toIndex = 0);
			r = t !== this._movementBoneData;
			this.setMovementBoneData(t),
				(this._rawDuration = this._movementBoneData.duration);
			t = this._movementBoneData.getFrameData(0);
			(this._tweenData.displayIndex = t.displayIndex),
				this._bone.getArmature().getArmatureData().dataVersion >=
					ccs.CONST_VERSION_COMBINED &&
					(ccs.TransformHelp.nodeSub(
						this._tweenData,
						this._bone.getBoneData()
					),
					(this._tweenData.scaleX += 1),
					(this._tweenData.scaleY += 1)),
				0 === this._rawDuration
					? ((this._loopType = ccs.ANIMATION_TYPE_SINGLE_FRAME),
					  0 === e
							? this.setBetween(t, t)
							: this.setBetween(this._tweenData, t),
					  (this._frameTweenEasing = ccs.TweenType.LINEAR))
					: 1 < this._movementBoneData.frameList.length &&
					  ((this._durationTween = i * this._movementBoneData.scale),
					  n && 0 !== this._movementBoneData.delay
							? this.setBetween(
									this._tweenData,
									this.tweenNodeTo(
										this.updateFrameData(
											1 - this._movementBoneData.delay
										),
										this._between
									)
							  )
							: r && 0 !== e
							? this.setBetween(this._tweenData, t)
							: this.setBetween(t, t)),
				this.tweenNodeTo(0);
		},
		gotoAndPlay: function (t) {
			ccs.ProcessBase.prototype.gotoFrame.call(this, t),
				(this._totalDuration = 0),
				(this._betweenDuration = 0),
				(this._fromIndex = this._toIndex = 0),
				(this._isPlaying = !0),
				(this._isComplete = this._isPause = !1),
				(this._currentPercent =
					this._curFrameIndex / (this._rawDuration - 1)),
				(this._currentFrame =
					this._nextFrameIndex * this._currentPercent);
		},
		gotoAndPause: function (t) {
			this.gotoAndPlay(t), this.pause();
		},
		updateHandler: function () {
			var t = null == this._currentPercent ? 1 : this._currentPercent,
				e = this._loopType;
			if (1 <= t)
				switch (e) {
					case ccs.ANIMATION_TYPE_SINGLE_FRAME:
						(t = 1),
							(this._isComplete = !0),
							(this._isPlaying = !1);
						break;
					case ccs.ANIMATION_TYPE_NO_LOOP:
						if (
							((e = ccs.ANIMATION_TYPE_MAX),
							1 <=
								(t =
									this._durationTween <= 0
										? 1
										: ((t - 1) * this._nextFrameIndex) /
										  this._durationTween))
						) {
							(t = 1),
								(this._isComplete = !0),
								(this._isPlaying = !1);
							break;
						}
						(this._nextFrameIndex = this._durationTween),
							(this._currentFrame = t * this._nextFrameIndex),
							(this._totalDuration = 0),
							(this._betweenDuration = 0),
							(this._fromIndex = this._toIndex = 0);
						break;
					case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:
						(e = ccs.ANIMATION_TYPE_LOOP_FRONT),
							(this._nextFrameIndex =
								0 < this._durationTween
									? this._durationTween
									: 1),
							0 !== this._movementBoneData.delay
								? ((this._currentFrame =
										(1 - this._movementBoneData.delay) *
										this._nextFrameIndex),
								  (t =
										this._currentFrame /
										this._nextFrameIndex))
								: ((t = 0), (this._currentFrame = 0)),
							(this._totalDuration = 0),
							(this._betweenDuration = 0),
							(this._fromIndex = this._toIndex = 0);
						break;
					case ccs.ANIMATION_TYPE_MAX:
						(t = 1),
							(this._isComplete = !0),
							(this._isPlaying = !1);
						break;
					default:
						this._currentFrame = ccs.fmodf(
							this._currentFrame,
							this._nextFrameIndex
						);
				}
			t < 1 &&
				e < ccs.ANIMATION_TYPE_TO_LOOP_BACK &&
				(t = Math.sin((t * cc.PI) / 2)),
				(this._currentPercent = t),
				(this._loopType = e) > ccs.ANIMATION_TYPE_TO_LOOP_BACK &&
					(t = this.updateFrameData(t)),
				this._frameTweenEasing !== ccs.TweenType.TWEEN_EASING_MAX &&
					this.tweenNodeTo(t);
		},
		setBetween: function (t, e, i) {
			void 0 === i && (i = !0);
			do {
				if (t.displayIndex < 0 && 0 <= e.displayIndex) {
					this._from.copy(e), this._between.subtract(e, e, i);
					break;
				}
				if (e.displayIndex < 0 && 0 <= t.displayIndex) {
					this._from.copy(t), this._between.subtract(e, e, i);
					break;
				}
			} while ((this._from.copy(t), this._between.subtract(t, e, i), 0));
			t.isTween ||
				(this._tweenData.copy(t), (this._tweenData.isTween = !0)),
				this.arriveKeyFrame(t);
		},
		arriveKeyFrame: function (t) {
			var e, i, n;
			t &&
				((e = (n = this._bone).getDisplayManager()),
				(i = t.displayIndex),
				e.getForceChangeDisplay() || e.changeDisplayWithIndex(i, !1),
				(this._tweenData.zOrder = t.zOrder),
				n.updateZOrder(),
				this._bone.setBlendFunc(t.blendFunc),
				(n = n.getChildArmature()) &&
					'' !== t.movement &&
					n.getAnimation().play(t.movement));
		},
		tweenNodeTo: function (t, e) {
			e = e || this._tweenData;
			var i = this._from,
				n = this._between;
			return (
				i.isTween || (t = 0),
				(e.x = i.x + t * n.x),
				(e.y = i.y + t * n.y),
				(e.scaleX = i.scaleX + t * n.scaleX),
				(e.scaleY = i.scaleY + t * n.scaleY),
				(e.skewX = i.skewX + t * n.skewX),
				(e.skewY = i.skewY + t * n.skewY),
				this._bone.setTransformDirty(!0),
				e && n.isUseColorInfo && this.tweenColorTo(t, e),
				e
			);
		},
		tweenColorTo: function (t, e) {
			var i = this._from,
				n = this._between;
			(e.a = i.a + t * n.a),
				(e.r = i.r + t * n.r),
				(e.g = i.g + t * n.g),
				(e.b = i.b + t * n.b),
				this._bone.updateColor();
		},
		updateFrameData: function (t) {
			1 < t &&
				0 !== this._movementBoneData.delay &&
				(t = ccs.fmodf(t, 1));
			var e,
				i,
				n = (this._rawDuration - 1) * t,
				r = this._totalDuration,
				o = this._betweenDuration,
				s = this._toIndex;
			if (n < r || r + o <= n) {
				var c = this._movementBoneData.frameList,
					a = c.length;
				if (n < c[0].frameID)
					return (
						(e = i = c[0]),
						this.setBetween(e, i),
						this._currentPercent
					);
				if (n >= c[a - 1].frameID) {
					if (this._passLastFrame)
						return (
							(e = i = c[a - 1]),
							this.setBetween(e, i),
							this._currentPercent
						);
					this._passLastFrame = !0;
				} else this._passLastFrame = !1;
				do {
					if (
						((this._fromIndex = s),
						(r = (e = c[this._fromIndex]).frameID),
						a <= (s = this._fromIndex + 1) && (s = 0),
						(i = c[s]),
						e.strEvent &&
							!this._animation.isIgnoreFrameEvent() &&
							this._animation.frameEvent(
								this._bone,
								e.strEvent,
								e.frameID,
								n
							),
						n === e.frameID ||
							(this._passLastFrame && this._fromIndex === a - 1))
					)
						break;
				} while (n < e.frameID || n >= i.frameID);
				(o = i.frameID - e.frameID),
					(this._frameTweenEasing = e.tweenEasing),
					this.setBetween(e, i, !1),
					(this._totalDuration = r),
					(this._betweenDuration = o),
					(this._toIndex = s);
			}
			t = 0 === o ? 0 : (n - this._totalDuration) / this._betweenDuration;
			o =
				this._frameTweenEasing !== ccs.TweenType.LINEAR
					? this._frameTweenEasing
					: this._tweenEasing;
			return (
				o === ccs.TweenType.TWEEN_EASING_MAX ||
					o === ccs.TweenType.LINEAR ||
					this._passLastFrame ||
					(t = ccs.TweenFunction.tweenTo(
						t,
						o,
						this._from.easingParams
					)),
				t
			);
		},
		setAnimation: function (t) {
			this._animation = t;
		},
		getAnimation: function () {
			return this._animation;
		},
		setMovementBoneData: function (t) {
			this._movementBoneData = t;
		},
	}));
var _p = ccs.Tween.prototype;
_p.animation,
	cc.defineGetterSetter(_p, 'animation', _p.getAnimation, _p.setAnimation),
	(_p = null),
	(ccs.Tween.create = function (t) {
		return new ccs.Tween(t);
	}),
	(ccs.PT_RATIO = 32),
	(ccs.ColliderFilter = ccs.Class.extend({
		_collisionType: 0,
		_group: 0,
		_categoryBits: 0,
		_groupIndex: 0,
		_maskBits: 0,
		ctor: function (t, e) {
			(this._collisionType = t || 0), (this._group = e || 0);
		},
		updateShape: function (t) {
			var e;
			t instanceof cp.Shape
				? ((t.collision_type = this._collisionType),
				  (t.group = this._group))
				: t instanceof Box2D.b2FilterData &&
				  (((e = new Box2D.b2FilterData()).categoryBits =
						this._categoryBits),
				  (e.groupIndex = this._groupIndex),
				  (e.maskBits = this._maskBits),
				  t.SetFilterData(e));
		},
	})),
	(ccs.ColliderBody = ccs.Class.extend({
		shape: null,
		coutourData: null,
		colliderFilter: null,
		_calculatedVertexList: null,
		ctor: function (t) {
			(this.shape = null),
				(this.coutourData = t),
				(this.colliderFilter = new ccs.ColliderFilter()),
				ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX &&
					(this._calculatedVertexList = []);
		},
		getContourData: function () {
			return this.coutourData;
		},
		setColliderFilter: function (t) {
			this.colliderFilter = t;
		},
		getCalculatedVertexList: function () {
			return this._calculatedVertexList;
		},
		setB2Fixture: function (t) {
			this._fixture = t;
		},
		getB2Fixture: function () {
			return this._fixture;
		},
		setShape: function (t) {
			this.shape = t;
		},
		getShape: function () {
			return this.shape;
		},
		setContourData: function (t) {
			this.coutourData = t;
		},
		getColliderFilter: function () {
			return this.colliderFilter;
		},
	})),
	(ccs.ColliderDetector = ccs.Class.extend({
		_colliderBodyList: null,
		_bone: null,
		_body: null,
		_active: !1,
		_filter: null,
		helpPoint: cc.p(0, 0),
		ctor: function (t) {
			(this._colliderBodyList = []),
				(this._bone = null),
				(this._body = null),
				(this._active = !1),
				(this._filter = null),
				ccs.ColliderDetector.prototype.init.call(this, t);
		},
		init: function (t) {
			return (
				(this._colliderBodyList.length = 0),
				t && (this._bone = t),
				(this._filter = new ccs.ColliderFilter()),
				!0
			);
		},
		addContourData: function (t) {
			var e = new ccs.ColliderBody(t);
			if (
				(this._colliderBodyList.push(e),
				ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)
			)
				for (
					var i = e.getCalculatedVertexList(),
						n = t.vertexList,
						r = 0;
					r < n.length;
					r++
				) {
					var o = new ccs.ContourVertex2(0, 0);
					i.push(o);
				}
		},
		addContourDataList: function (t) {
			for (var e = 0; e < t.length; e++) this.addContourData(t[e]);
		},
		removeContourData: function (t) {
			for (
				var e = [], i = this._colliderBodyList, n = 0;
				n < i.length;
				n++
			) {
				var r = i[n];
				r && r.getContourData() === t && e.push(r);
			}
			for (n = 0; n < e.length; n++) cc.arrayRemoveObject(i, e[n]);
		},
		removeAll: function () {
			this._colliderBodyList.length = 0;
		},
		setActive: function (t) {
			if (this._active !== t) {
				this._active = t;
				var e,
					i = this._body;
				if (i)
					if (this._active)
						for (var n = 0; n < this._colliderBodyList.length; n++)
							(e = this._colliderBodyList[n].getShape()),
								i.space.addShape(e);
					else
						for (n = 0; n < this._colliderBodyList.length; n++)
							(e = this._colliderBodyList[n].getShape()),
								i.space.removeShape(e);
			}
		},
		getActive: function () {
			return this._active;
		},
		getColliderBodyList: function () {
			return this._colliderBodyList;
		},
		setColliderFilter: function (t) {
			this._filter = t;
			for (var e = this._colliderBodyList, i = 0; i < e.length; i++) {
				var n = e[i];
				n.setColliderFilter(t),
					n.getShape() &&
						n.getColliderFilter().updateShape(n.getShape());
			}
		},
		getColliderFilter: function () {
			return this._filter;
		},
		updateTransform: function (t) {
			if (this._active)
				for (
					var e = null, i = this._body, n = this.helpPoint, r = 0;
					r < this._colliderBodyList.length;
					r++
				) {
					var o = (e = this._colliderBodyList[r]).getContourData(),
						s = null;
					i && (s = e.getShape());
					for (
						var c,
							a = o.vertexList,
							l = e.getCalculatedVertexList(),
							h = 0;
						h < a.length;
						h++
					)
						(n.x = a[h].x),
							(n.y = a[h].y),
							(n = cc.pointApplyAffineTransform(n, t)),
							ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX &&
								(((c = cc.p(0, 0)).x = n.x),
								(c.y = n.y),
								(l[h] = c)),
							s &&
								((s.verts[2 * h] = n.x),
								(s.verts[2 * h + 1] = n.y));
					if (s)
						for (h = 0; h < a.length; h++) {
							var u = s.verts[(h + 1) % s.verts.length],
								u = cp.v.normalize(
									cp.v.perp(cp.v.sub(u, s.verts[h]))
								);
							s.planes &&
								((s.planes[h].n = u),
								(s.planes[h].d = cp.v.dot(u, s.verts[h])));
						}
				}
		},
		setBody: function (t) {
			this._body = t;
			for (var e, i = this._colliderBodyList, n = 0; n < i.length; n++) {
				for (
					var r = [],
						o = (e = i[n]).getContourData().vertexList,
						s = 0;
					s < o.length;
					s++
				) {
					var c = o[s];
					r.push(c.x), r.push(c.y);
				}
				var a = new cp.PolyShape(this._body, r, cp.vzero);
				(a.sensor = !0),
					(a.data = this._bone),
					this._active && this._body.space.addShape(a),
					e.setShape(a),
					e.getColliderFilter().updateShape(a);
			}
		},
		getBody: function () {
			return this._body;
		},
	}));
var _p = ccs.ColliderDetector.prototype;
_p.colliderFilter,
	cc.defineGetterSetter(
		_p,
		'colliderFilter',
		_p.getColliderFilter,
		_p.setColliderFilter
	),
	_p.active,
	cc.defineGetterSetter(_p, 'active', _p.getActive, _p.setActive),
	_p.body,
	cc.defineGetterSetter(_p, 'body', _p.getBody, _p.setBody),
	(_p = null),
	(ccs.ColliderDetector.create = function (t) {
		return new ccs.ColliderDetector(t);
	}),
	(ccs.Armature = ccs.Node.extend({
		animation: null,
		armatureData: null,
		batchNode: null,
		_textureAtlas: null,
		_parentBone: null,
		_boneDic: null,
		_topBoneList: null,
		_armatureIndexDic: null,
		_offsetPoint: null,
		version: 0,
		_armatureTransformDirty: !0,
		_body: null,
		_blendFunc: null,
		_className: 'Armature',
		ctor: function (t, e) {
			cc.Node.prototype.ctor.call(this),
				(this._name = ''),
				(this._topBoneList = []),
				(this._armatureIndexDic = {}),
				(this._offsetPoint = cc.p(0, 0)),
				(this._armatureTransformDirty = !0),
				(this._blendFunc = { src: cc.BLEND_SRC, dst: cc.BLEND_DST }),
				t && ccs.Armature.prototype.init.call(this, t, e);
		},
		init: function (t, e) {
			cc.Node.prototype.init.call(this),
				e && (this._parentBone = e),
				this.removeAllChildren(),
				(this.animation = new ccs.ArmatureAnimation()),
				this.animation.init(this),
				(this._boneDic = {}),
				(this._topBoneList.length = 0);
			var i,
				n = ccs.armatureDataManager;
			if ('' !== t) {
				(i = n.getAnimationData(t)),
					cc.assert(i, 'AnimationData not exist!'),
					this.animation.setAnimationData(i);
				var r,
					e = n.getArmatureData(t);
				for (r in (cc.assert(e, 'ArmatureData not exist!'),
				(this.armatureData = e).getBoneDataDic())) {
					var o = this.createBone(String(r));
					do {
						var s = i.getMovement(i.movementNames[0]);
						if (!s) break;
						s = s.getMovementBoneData(o.getName());
						if (!s || s.frameList.length <= 0) break;
						s = s.getFrameData(0);
					} while (
						s &&
						(o.getTweenData().copy(s),
						o.changeDisplayWithIndex(s.displayIndex, !1),
						0)
					);
				}
				this.update(0), this.updateOffsetPoint();
			} else
				(t = 'new_armature'),
					(this.armatureData = new ccs.ArmatureData()),
					(this.armatureData.name = t),
					((i = new ccs.AnimationData()).name = t),
					n.addArmatureData(t, this.armatureData),
					n.addAnimationData(t, i),
					this.animation.setAnimationData(i);
			return (
				this._renderCmd.initShaderCache(),
				this.setCascadeOpacityEnabled(!0),
				this.setCascadeColorEnabled(!0),
				!0
			);
		},
		addChild: function (t, e, i) {
			t instanceof ccui.Widget
				? cc.log(
						"Armature doesn't support to add Widget as its child, it will be fix soon."
				  )
				: cc.Node.prototype.addChild.call(this, t, e, i);
		},
		createBone: function (t) {
			var e = this.getBone(t);
			if (e) return e;
			var i = this.armatureData.getBoneData(t),
				n = i.parentName,
				e = null;
			return (
				n
					? (this.createBone(n),
					  (e = new ccs.Bone(t)),
					  this.addBone(e, n))
					: ((e = new ccs.Bone(t)), this.addBone(e, '')),
				e.setBoneData(i),
				e.getDisplayManager().changeDisplayWithIndex(-1, !1),
				e
			);
		},
		addBone: function (t, e) {
			cc.assert(t, 'Argument must be non-nil');
			var i,
				n = this._boneDic;
			t.getName() &&
				cc.assert(
					!n[t.getName()],
					"bone already added. It can't be added again"
				),
				e && (i = n[e]) ? i.addChildBone(t) : this._topBoneList.push(t),
				t.setArmature(this),
				(n[t.getName()] = t),
				this.addChild(t);
		},
		removeBone: function (t, e) {
			cc.assert(t, 'bone must be added to the bone dictionary!'),
				t.setArmature(null),
				t.removeFromParent(e),
				cc.arrayRemoveObject(this._topBoneList, t),
				delete this._boneDic[t.getName()],
				this.removeChild(t, !0);
		},
		getBone: function (t) {
			return this._boneDic[t];
		},
		changeBoneParent: function (t, e) {
			cc.assert(t, 'bone must be added to the bone dictionary!');
			var i = t.getParentBone();
			i &&
				(cc.arrayRemoveObject(i.getChildren(), t),
				t.setParentBone(null)),
				e &&
					((e = this._boneDic[e])
						? (e.addChildBone(t),
						  cc.arrayRemoveObject(this._topBoneList, t))
						: this._topBoneList.push(t));
		},
		getBoneDic: function () {
			return this._boneDic;
		},
		updateOffsetPoint: function () {
			var t = this.getBoundingBox();
			this.setContentSize(t);
			var e = this._offsetPoint;
			(e.x = -t.x),
				(e.y = -t.y),
				0 !== t.width &&
					0 !== t.height &&
					this.setAnchorPoint(e.x / t.width, e.y / t.height);
		},
		getOffsetPoints: function () {
			return { x: this._offsetPoint.x, y: this._offsetPoint.y };
		},
		setAnimation: function (t) {
			this.animation = t;
		},
		getAnimation: function () {
			return this.animation;
		},
		getArmatureTransformDirty: function () {
			return this._armatureTransformDirty;
		},
		update: function (t) {
			this.animation.update(t);
			for (var e = this._topBoneList, i = 0; i < e.length; i++)
				e[i].update(t);
			this._armatureTransformDirty = !1;
		},
		onEnter: function () {
			cc.Node.prototype.onEnter.call(this), this.scheduleUpdate();
		},
		onExit: function () {
			cc.Node.prototype.onExit.call(this), this.unscheduleUpdate();
		},
		getBoundingBox: function () {
			for (
				var t,
					e,
					i,
					n = 0,
					r = !0,
					o = cc.rect(0, 0, 0, 0),
					s = this._children,
					c = s.length,
					a = 0;
				a < c;
				a++
			) {
				var l = s[a];
				l &&
					((0 === (l = l.getDisplayManager().getBoundingBox()).x &&
						0 === l.y &&
						0 === l.width &&
						0 === l.height) ||
						(r
							? ((t = l.x),
							  (e = l.y),
							  (i = l.x + l.width),
							  (n = l.y + l.height),
							  (r = !1))
							: ((t = (l.x < o.x ? l : o).x),
							  (e = (l.y < o.y ? l : o).y),
							  (i =
									l.x + l.width > o.x + o.width
										? l.x + l.width
										: o.x + o.width),
							  (n =
									l.y + l.height > o.y + o.height
										? l.y + l.height
										: o.y + o.height)),
						(o.x = t),
						(o.y = e),
						(o.width = i - t),
						(o.height = n - e)));
			}
			return cc.rectApplyAffineTransform(
				o,
				this.getNodeToParentTransform()
			);
		},
		getBoneAtPoint: function (t, e) {
			for (var i = this._children, n = i.length - 1; 0 <= n; n--) {
				var r = i[n];
				if (
					r instanceof ccs.Bone &&
					r.getDisplayManager().containPoint(t, e)
				)
					return r;
			}
			return null;
		},
		setParentBone: function (t) {
			this._parentBone = t;
			var e,
				i = this._boneDic;
			for (e in i) i[e].setArmature(this);
		},
		getParentBone: function () {
			return this._parentBone;
		},
		drawContour: function () {
			cc._drawingUtil.setDrawColor(255, 255, 255, 255),
				cc._drawingUtil.setLineWidth(1);
			var t,
				e = this._boneDic;
			for (t in e) {
				var i = e[t].getColliderDetector();
				if (i)
					for (
						var n = i.getColliderBodyList(), r = 0;
						r < n.length;
						r++
					) {
						var o = n[r].getCalculatedVertexList();
						cc._drawingUtil.drawPoly(o, o.length, !0);
					}
			}
		},
		setBody: function (t) {
			if (this._body !== t) {
				this._body = t;
				for (
					var e, i = (this._body.data = this)._children, n = 0;
					n < i.length;
					n++
				)
					if ((e = i[n]) instanceof ccs.Bone)
						for (
							var r = e
									.getDisplayManager()
									.getDecorativeDisplayList(),
								o = 0;
							o < r.length;
							o++
						) {
							var s = r[o].getColliderDetector();
							s && s.setBody(this._body);
						}
			}
		},
		getShapeList: function () {
			return this._body ? this._body.shapeList : null;
		},
		getBody: function () {
			return this._body;
		},
		setBlendFunc: function (t, e) {
			void 0 === e
				? ((this._blendFunc.src = t.src), (this._blendFunc.dst = t.dst))
				: ((this._blendFunc.src = t), (this._blendFunc.dst = e));
		},
		getBlendFunc: function () {
			return new cc.BlendFunc(this._blendFunc.src, this._blendFunc.dst);
		},
		setColliderFilter: function (t) {
			var e,
				i = this._boneDic;
			for (e in i) i[e].setColliderFilter(t);
		},
		getArmatureData: function () {
			return this.armatureData;
		},
		setArmatureData: function (t) {
			this.armatureData = t;
		},
		getBatchNode: function () {
			return this.batchNode;
		},
		setBatchNode: function (t) {
			this.batchNode = t;
		},
		getVersion: function () {
			return this.version;
		},
		setVersion: function (t) {
			this.version = t;
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? ccs.Armature.CanvasRenderCmd
					: ccs.Armature.WebGLRenderCmd
			)(this);
		},
	}));
var _p = ccs.Armature.prototype;
_p.parentBone,
	cc.defineGetterSetter(_p, 'parentBone', _p.getParentBone, _p.setParentBone),
	_p.body,
	cc.defineGetterSetter(_p, 'body', _p.getBody, _p.setBody),
	_p.colliderFilter,
	cc.defineGetterSetter(_p, 'colliderFilter', null, _p.setColliderFilter),
	(_p = null),
	(ccs.Armature.create = function (t, e) {
		return new ccs.Armature(t, e);
	}),
	(ccs.Armature.RenderCmd = {
		_updateAnchorPointInPoint: function () {
			var t = this._node,
				e = t._contentSize,
				i = t._anchorPoint,
				t = t._offsetPoint;
			(this._anchorPointInPoints.x = e.width * i.x - t.x),
				(this._anchorPointInPoints.y = e.height * i.y - t.y),
				(this._realAnchorPointInPoints.x = e.width * i.x),
				(this._realAnchorPointInPoints.y = e.height * i.y),
				this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);
		},
		getAnchorPointInPoints: function () {
			return cc.p(this._realAnchorPointInPoints);
		},
	}),
	(function () {
		ccs.Armature.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._realAnchorPointInPoints = new cc.Point(0, 0)),
				(this._canUseDirtyRegion = !0),
				(this._startRenderCmd = new cc.CustomRenderCmd(
					this,
					this._startCmdCallback
				)),
				(this._RestoreRenderCmd = new cc.CustomRenderCmd(
					this,
					this._RestoreCmdCallback
				)),
				(this._startRenderCmd._canUseDirtyRegion = !0),
				(this._RestoreRenderCmd._canUseDirtyRegion = !0);
		};
		var t = (ccs.Armature.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		cc.inject(ccs.Armature.RenderCmd, t),
			(t.constructor = ccs.Armature.CanvasRenderCmd),
			(t._startCmdCallback = function (t, e, i) {
				var n = this._node._parent;
				this.transform(n ? n._renderCmd : null);
				t = t || cc._renderContext;
				t.save(),
					t._switchToArmatureMode(!0, this._worldTransform, e, i);
			}),
			(t.transform = function (t, e) {
				ccs.Node.CanvasRenderCmd.prototype.transform.call(this, t, e);
				for (
					var i = this._node._children, n = 0, r = i.length;
					n < r;
					n++
				) {
					var o,
						s,
						c,
						a,
						l,
						h = i[n],
						u = h._renderCmd;
					h &&
						h.getDisplayRenderNode &&
						((a = h.getDisplayRenderNodeType()),
						(l = h.getDisplayRenderNode()) &&
							l._renderCmd &&
							((o = l._renderCmd).transform(null),
							a !== ccs.DISPLAY_TYPE_ARMATURE &&
								a !== ccs.DISPLAY_TYPE_SPRITE &&
								cc.affineTransformConcatIn(
									o._worldTransform,
									h._worldTransform
								),
							(s = cc.Node._dirtyFlags),
							(c = o._dirtyFlag),
							(a = (l = u._dirtyFlag) & s.colorDirty),
							(l = l & s.opacityDirty),
							a && u._updateDisplayColor(),
							l && u._updateDisplayOpacity(),
							(a || l) && u._updateColor(),
							(u = h._renderCmd._displayedColor),
							(h = h._renderCmd._displayedOpacity),
							(a = c & s.colorDirty),
							(l = c & s.opacityDirty),
							a && o._updateDisplayColor(u),
							l && o._updateDisplayOpacity(h),
							(a || l) && o._updateColor()));
				}
			}),
			(t._RestoreCmdCallback = function (t) {
				(this._cacheDirty = !1),
					t._switchToArmatureMode(!1),
					t.restore();
			}),
			(t.initShaderCache = function () {}),
			(t.setShaderProgram = function () {}),
			(t.updateChildPosition = function (t, e) {
				t.visit();
			}),
			(t.rendering = function (t, e, i) {
				for (
					var n = this._node._children,
						r =
							(cc.BlendFunc.ALPHA_PREMULTIPLIED,
							cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,
							0),
						o = n.length;
					r < o;
					r++
				) {
					var s = n[r];
					if (s && s.getDisplayRenderNode) {
						var c = s.getDisplayRenderNode();
						if (null !== c) {
							var a = s._renderCmd;
							switch (
								(a._syncStatus(this),
								s.getDisplayRenderNodeType())
							) {
								case ccs.DISPLAY_TYPE_SPRITE:
									c._renderCmd.visit(a);
									break;
								case ccs.DISPLAY_TYPE_ARMATURE:
									c._renderCmd.rendering(t, e, i);
									break;
								default:
									c._renderCmd.visit(a);
							}
						}
					} else s instanceof cc.Node && this._visitNormalChild(s);
				}
			}),
			(t._visitNormalChild = function (t) {
				if (t) {
					var e = t._renderCmd;
					if (t._visible) {
						e._curLevel = this._curLevel + 1;
						var i,
							n,
							r = t._children;
						e._syncStatus(this), e.transform(null);
						var o = r.length;
						if (0 < o) {
							for (
								t.sortAllChildren(), i = 0;
								i < o && (n = r[i])._localZOrder < 0;
								i++
							)
								n._renderCmd.visit(e);
							for (cc.renderer.pushRenderCommand(e); i < o; i++)
								r[i]._renderCmd.visit(e);
						} else cc.renderer.pushRenderCommand(e);
						this._dirtyFlag = 0;
					}
				}
			}),
			(t.visit = function (t) {
				var e = this._node;
				e._visible &&
					(this._syncStatus(t),
					e.sortAllChildren(),
					cc.renderer.pushRenderCommand(this._startRenderCmd),
					this.rendering(),
					cc.renderer.pushRenderCommand(this._RestoreRenderCmd),
					(this._cacheDirty = !1));
			});
	})(),
	(ccs.Bone = ccs.Node.extend({
		_boneData: null,
		_armature: null,
		_childArmature: null,
		_displayManager: null,
		ignoreMovementBoneData: !1,
		_tween: null,
		_tweenData: null,
		_parentBone: null,
		_boneTransformDirty: !1,
		_worldTransform: null,
		_blendFunc: null,
		blendDirty: !1,
		_worldInfo: null,
		_armatureParentBone: null,
		_dataVersion: 0,
		_className: 'Bone',
		ctor: function (t) {
			cc.Node.prototype.ctor.call(this),
				(this._tweenData = null),
				(this._parentBone = null),
				(this._armature = null),
				(this._childArmature = null),
				(this._boneData = null),
				(this._tween = null),
				(this._displayManager = null),
				(this.ignoreMovementBoneData = !1),
				(this._worldTransform = cc.affineTransformMake(
					1,
					0,
					0,
					1,
					0,
					0
				)),
				(this._boneTransformDirty = !0),
				(this._blendFunc = new cc.BlendFunc(
					cc.BLEND_SRC,
					cc.BLEND_DST
				)),
				(this.blendDirty = !1),
				(this._worldInfo = null),
				(this._armatureParentBone = null),
				(this._dataVersion = 0),
				ccs.Bone.prototype.init.call(this, t);
		},
		init: function (t) {
			return (
				t && (this._name = t),
				(this._tweenData = new ccs.FrameData()),
				(this._tween = new ccs.Tween(this)),
				(this._displayManager = new ccs.DisplayManager(this)),
				(this._worldInfo = new ccs.BaseData()),
				(this._boneData = new ccs.BaseData()),
				!0
			);
		},
		setBoneData: function (t) {
			cc.assert(t, '_boneData must not be null'),
				this._boneData !== t && (this._boneData = t),
				this.setName(this._boneData.name),
				(this._localZOrder = this._boneData.zOrder),
				this._displayManager.initDisplayList(t);
		},
		getBoneData: function () {
			return this._boneData;
		},
		setArmature: function (t) {
			(this._armature = t)
				? (this._tween.setAnimation(this._armature.getAnimation()),
				  (this._dataVersion =
						this._armature.getArmatureData().dataVersion),
				  (this._armatureParentBone = this._armature.getParentBone()))
				: (this._armatureParentBone = null);
		},
		getArmature: function () {
			return this._armature;
		},
		update: function (t) {
			var e, i;
			this._parentBone &&
				(this._boneTransformDirty =
					this._boneTransformDirty ||
					this._parentBone.isTransformDirty()),
				this._armatureParentBone &&
					!this._boneTransformDirty &&
					(this._boneTransformDirty =
						this._armatureParentBone.isTransformDirty()),
				this._boneTransformDirty &&
					((e = this._tweenData),
					this._dataVersion >= ccs.CONST_VERSION_COMBINED &&
						(ccs.TransformHelp.nodeConcat(e, this._boneData),
						--e.scaleX,
						--e.scaleY),
					(i = this._worldInfo).copy(e),
					(i.x = e.x + this._position.x),
					(i.y = e.y + this._position.y),
					(i.scaleX = e.scaleX * this._scaleX),
					(i.scaleY = e.scaleY * this._scaleY),
					(i.skewX =
						e.skewX +
						this._skewX +
						cc.degreesToRadians(this._rotationX)),
					(i.skewY =
						e.skewY +
						this._skewY -
						cc.degreesToRadians(this._rotationY)),
					this._parentBone
						? this._applyParentTransform(this._parentBone)
						: this._armatureParentBone &&
						  this._applyParentTransform(this._armatureParentBone),
					ccs.TransformHelp.nodeToMatrix(i, this._worldTransform),
					this._armatureParentBone &&
						cc.affineTransformConcatIn(
							this._worldTransform,
							this._armature.getNodeToParentTransform()
						)),
				ccs.displayFactory.updateDisplay(
					this,
					t,
					this._boneTransformDirty ||
						this._armature.getArmatureTransformDirty()
				);
			for (var n = 0; n < this._children.length; n++)
				this._children[n].update(t);
			this._boneTransformDirty = !1;
		},
		_applyParentTransform: function (t) {
			var e = this._worldInfo,
				i = t._worldTransform,
				n = t._worldInfo,
				r = e.x,
				t = e.y;
			(e.x = r * i.a + t * i.c + n.x),
				(e.y = r * i.b + t * i.d + n.y),
				(e.scaleX = e.scaleX * n.scaleX),
				(e.scaleY = e.scaleY * n.scaleY),
				(e.skewX = e.skewX + n.skewX),
				(e.skewY = e.skewY + n.skewY);
		},
		setBlendFunc: function (t, e) {
			var i,
				n = this._blendFunc,
				e = void 0 === e ? ((i = t.src), t.dst) : ((i = t), e);
			(n.src === i && n.dst === e) ||
				((n.src = i), (n.dst = e), (this.blendDirty = !0));
		},
		updateColor: function () {
			var t,
				e = this._displayManager.getDisplayRenderNode();
			null !== e &&
				((t = this._renderCmd),
				e.setColor(
					cc.color(
						(t._displayedColor.r * this._tweenData.r) / 255,
						(t._displayedColor.g * this._tweenData.g) / 255,
						(t._displayedColor.b * this._tweenData.b) / 255
					)
				),
				e.setOpacity((t._displayedOpacity * this._tweenData.a) / 255));
		},
		updateZOrder: function () {
			this._armature.getArmatureData().dataVersion >=
			ccs.CONST_VERSION_COMBINED
				? this.setLocalZOrder(
						this._tweenData.zOrder + this._boneData.zOrder
				  )
				: this.setLocalZOrder(this._tweenData.zOrder);
		},
		addChildBone: function (t) {
			cc.assert(t, 'Argument must be non-nil'),
				cc.assert(
					!t.parentBone,
					"child already added. It can't be added again"
				),
				this._children.indexOf(t) < 0 &&
					(this._children.push(t), t.setParentBone(this));
		},
		removeChildBone: function (t, e) {
			if (
				0 < this._children.length &&
				-1 !== this._children.getIndex(t)
			) {
				if (e)
					for (var i = t._children, n = 0; n < i.length; n++) {
						var r = i[n];
						t.removeChildBone(r, e);
					}
				t.setParentBone(null),
					t.getDisplayManager().setCurrentDecorativeDisplay(null),
					cc.arrayRemoveObject(this._children, t);
			}
		},
		removeFromParent: function (t) {
			this._parentBone && this._parentBone.removeChildBone(this, t);
		},
		setParentBone: function (t) {
			this._parentBone = t;
		},
		getParentBone: function () {
			return this._parentBone;
		},
		setChildArmature: function (t) {
			this._childArmature !== t &&
				(null == t &&
					this._childArmature &&
					this._childArmature.setParentBone(null),
				(this._childArmature = t));
		},
		getChildArmature: function () {
			return this._childArmature;
		},
		getTween: function () {
			return this._tween;
		},
		setLocalZOrder: function (t) {
			this._localZOrder !== t &&
				cc.Node.prototype.setLocalZOrder.call(this, t);
		},
		getNodeToArmatureTransform: function () {
			return this._worldTransform;
		},
		getNodeToWorldTransform: function () {
			return cc.affineTransformConcat(
				this._worldTransform,
				this._armature.getNodeToWorldTransform()
			);
		},
		getDisplayRenderNode: function () {
			return this._displayManager.getDisplayRenderNode();
		},
		getDisplayRenderNodeType: function () {
			return this._displayManager.getDisplayRenderNodeType();
		},
		addDisplay: function (t, e) {
			return (e = e || 0), this._displayManager.addDisplay(t, e);
		},
		removeDisplay: function (t) {
			this._displayManager.removeDisplay(t);
		},
		changeDisplayByIndex: function (t, e) {
			cc.log(
				'changeDisplayByIndex is deprecated. Use changeDisplayWithIndex instead.'
			),
				this.changeDisplayWithIndex(t, e);
		},
		changeDisplayByName: function (t, e) {
			cc.log(
				'changeDisplayByName is deprecated. Use changeDisplayWithName instead.'
			),
				this.changeDisplayWithName(t, e);
		},
		changeDisplayWithIndex: function (t, e) {
			this._displayManager.changeDisplayWithIndex(t, e);
		},
		changeDisplayWithName: function (t, e) {
			this._displayManager.changeDisplayWithName(t, e);
		},
		getColliderDetector: function () {
			var t = this._displayManager.getCurrentDecorativeDisplay();
			if (t) {
				t = t.getColliderDetector();
				if (t) return t;
			}
			return null;
		},
		setColliderFilter: function (t) {
			for (
				var e = this._displayManager.getDecorativeDisplayList(), i = 0;
				i < e.length;
				i++
			) {
				var n = e[i].getColliderDetector();
				n && n.setColliderFilter(t);
			}
		},
		getColliderFilter: function () {
			var t = this.displayManager.getCurrentDecorativeDisplay();
			if (t) {
				t = t.getColliderDetector();
				if (t) return t.getColliderFilter();
			}
			return null;
		},
		setTransformDirty: function (t) {
			this._boneTransformDirty = t;
		},
		isTransformDirty: function () {
			return this._boneTransformDirty;
		},
		getDisplayManager: function () {
			return this._displayManager;
		},
		setIgnoreMovementBoneData: function (t) {
			this._ignoreMovementBoneData = t;
		},
		isIgnoreMovementBoneData: function () {
			return this._ignoreMovementBoneData;
		},
		getBlendFunc: function () {
			return new cc.BlendFunc(this._blendFunc.src, this._blendFunc.dst);
		},
		setBlendDirty: function (t) {
			this._blendDirty = t;
		},
		isBlendDirty: function () {
			return this._blendDirty;
		},
		getTweenData: function () {
			return this._tweenData;
		},
		getWorldInfo: function () {
			return this._worldInfo;
		},
		getChildrenBone: function () {
			return this._children;
		},
		nodeToArmatureTransform: function () {
			return this.getNodeToArmatureTransform();
		},
		nodeToWorldTransform: function () {
			return this.getNodeToWorldTransform();
		},
		getColliderBodyList: function () {
			var t = this.getColliderDetector();
			return t ? t.getColliderBodyList() : null;
		},
		getIgnoreMovementBoneData: function () {
			return this.isIgnoreMovementBoneData();
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? ccs.Bone.CanvasRenderCmd
					: ccs.Bone.WebGLRenderCmd
			)(this);
		},
	}));
var _p = ccs.Bone.prototype;
_p.boneData,
	cc.defineGetterSetter(_p, 'boneData', _p.getBoneData, _p.setBoneData),
	_p.armature,
	cc.defineGetterSetter(_p, 'armature', _p.getArmature, _p.setArmature),
	_p.childArmature,
	cc.defineGetterSetter(
		_p,
		'childArmature',
		_p.getChildArmature,
		_p.setChildArmature
	),
	_p.childrenBone,
	cc.defineGetterSetter(_p, 'childrenBone', _p.getChildrenBone),
	_p.tween,
	cc.defineGetterSetter(_p, 'tween', _p.getTween),
	_p.tweenData,
	cc.defineGetterSetter(_p, 'tweenData', _p.getTweenData),
	_p.colliderFilter,
	cc.defineGetterSetter(
		_p,
		'colliderFilter',
		_p.getColliderFilter,
		_p.setColliderFilter
	),
	(_p = null),
	(ccs.Bone.create = function (t) {
		return new ccs.Bone(t);
	}),
	(ccs.Bone.RenderCmd = {
		_updateColor: function () {
			var t,
				e = this._node,
				i = e._displayManager.getDisplayRenderNode();
			null !== i &&
				((t = i._renderCmd),
				i.setColor(this._displayedColor),
				i.setOpacity(this._displayedOpacity),
				t._syncDisplayColor(e._tweenData),
				t._syncDisplayOpacity(e._tweenData.a),
				t._updateColor());
		},
		transform: function (t, e) {
			var i = this._node,
				n = this._transform,
				r = this._worldTransform,
				t = t ? t._worldTransform : null;
			t &&
				(this.originTransform(),
				cc.affineTransformConcatIn(n, i._worldTransform)),
				t
					? ((r.a = n.a * t.a + n.b * t.c),
					  (r.b = n.a * t.b + n.b * t.d),
					  (r.c = n.c * t.a + n.d * t.c),
					  (r.d = n.c * t.b + n.d * t.d),
					  (r.tx = n.tx * t.a + n.ty * t.c + t.tx),
					  (r.ty = n.tx * t.b + n.ty * t.d + t.ty))
					: ((r.a = n.a),
					  (r.b = n.b),
					  (r.c = n.c),
					  (r.d = n.d),
					  (r.tx = n.tx),
					  (r.ty = n.ty));
		},
	}),
	(function () {
		ccs.Bone.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t), (this._needDraw = !1);
		};
		var t = (ccs.Bone.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		cc.inject(ccs.Bone.RenderCmd, t),
			(t.constructor = ccs.Bone.CanvasRenderCmd);
	})(),
	(function () {
		var t;
		cc.Node.WebGLRenderCmd &&
			((ccs.Bone.WebGLRenderCmd = function (t) {
				cc.Node.WebGLRenderCmd.call(this, t), (this._needDraw = !1);
			}),
			(t = ccs.Bone.WebGLRenderCmd.prototype =
				Object.create(cc.Node.WebGLRenderCmd.prototype)),
			cc.inject(ccs.Bone.RenderCmd, t),
			(t.constructor = ccs.Bone.WebGLRenderCmd));
	})(),
	(ccs.FRAME_TYPE_MOVE = 0),
	(ccs.FRAME_TYPE_SCALE = 1),
	(ccs.FRAME_TYPE_ROTATE = 2),
	(ccs.FRAME_TYPE_TINT = 3),
	(ccs.FRAME_TYPE_FADE = 4),
	(ccs.FRAME_TYPE_MAX = 5),
	(ccs.FrameEaseType = {
		CUSTOM: -1,
		LINEAR: 0,
		SINE_EASEIN: 1,
		SINE_EASEOUT: 2,
		SINE_EASEINOUT: 3,
		QUAD_EASEIN: 4,
		QUAD_EASEOUT: 5,
		QUAD_EASEINOUT: 6,
		CUBIC_EASEIN: 7,
		CUBIC_EASEOUT: 8,
		CUBIC_EASEINOUT: 9,
		QUART_EASEIN: 10,
		QUART_EASEOUT: 11,
		QUART_EASEINOUT: 12,
		QUINT_EASEIN: 13,
		QUINT_EASEOUT: 14,
		QUINT_EASEINOUT: 15,
		EXPO_EASEIN: 16,
		EXPO_EASEOUT: 17,
		EXPO_EASEINOUT: 18,
		CIRC_EASEIN: 19,
		CIRC_EASEOUT: 20,
		CIRC_EASEINOUT: 21,
		ELASTIC_EASEIN: 22,
		ELASTIC_EASEOUT: 23,
		ELASTIC_EASEINOUT: 24,
		BACK_EASEIN: 25,
		BACK_EASEOUT: 26,
		BACK_EASEINOUT: 27,
		BOUNCE_EASEIN: 28,
		BOUNCE_EASEOUT: 29,
		BOUNCE_EASEINOUT: 30,
		TWEEN_EASING_MAX: 1e3,
	}),
	(ccs.ActionFrame = ccs.Class.extend({
		frameType: 0,
		easingType: 0,
		frameIndex: 0,
		_Parameter: null,
		time: 0,
		ctor: function () {
			(this.frameType = 0),
				(this.easingType = ccs.FrameEaseType.LINEAR),
				(this.frameIndex = 0),
				(this.time = 0);
		},
		getAction: function (t, e) {
			return (
				cc.log('Need a definition of <getAction> for ActionFrame'), null
			);
		},
		_getEasingAction: function (t) {
			if (null === t)
				return console.error('Action cannot be null!'), null;
			var e;
			switch (this.easingType) {
				case ccs.FrameEaseType.CUSTOM:
					break;
				case ccs.FrameEaseType.LINEAR:
					e = t;
					break;
				case ccs.FrameEaseType.SINE_EASEIN:
					e = t.easing(cc.easeSineIn());
					break;
				case ccs.FrameEaseType.SINE_EASEOUT:
					e = t.easing(cc.easeSineOut());
					break;
				case ccs.FrameEaseType.SINE_EASEINOUT:
					e = t.easing(cc.easeSineInOut());
					break;
				case ccs.FrameEaseType.QUAD_EASEIN:
					e = t.easing(cc.easeQuadraticActionIn());
					break;
				case ccs.FrameEaseType.QUAD_EASEOUT:
					e = t.easing(cc.easeQuadraticActionOut());
					break;
				case ccs.FrameEaseType.QUAD_EASEINOUT:
					e = t.easing(cc.easeQuadraticActionInOut());
					break;
				case ccs.FrameEaseType.CUBIC_EASEIN:
					e = t.easing(cc.easeCubicActionIn());
					break;
				case ccs.FrameEaseType.CUBIC_EASEOUT:
					e = t.easing(cc.easeCubicActionOut());
					break;
				case ccs.FrameEaseType.CUBIC_EASEINOUT:
					e = t.easing(cc.easeCubicActionInOut());
					break;
				case ccs.FrameEaseType.QUART_EASEIN:
					e = t.easing(cc.easeQuarticActionIn());
					break;
				case ccs.FrameEaseType.QUART_EASEOUT:
					e = t.easing(cc.easeQuarticActionOut());
					break;
				case ccs.FrameEaseType.QUART_EASEINOUT:
					e = t.easing(cc.easeQuarticActionInOut());
					break;
				case ccs.FrameEaseType.QUINT_EASEIN:
					e = t.easing(cc.easeQuinticActionIn());
					break;
				case ccs.FrameEaseType.QUINT_EASEOUT:
					e = t.easing(cc.easeQuinticActionOut());
					break;
				case ccs.FrameEaseType.QUINT_EASEINOUT:
					e = t.easing(cc.easeQuinticActionInOut());
					break;
				case ccs.FrameEaseType.EXPO_EASEIN:
					e = t.easing(cc.easeExponentialIn());
					break;
				case ccs.FrameEaseType.EXPO_EASEOUT:
					e = t.easing(cc.easeExponentialOut());
					break;
				case ccs.FrameEaseType.EXPO_EASEINOUT:
					e = t.easing(cc.easeExponentialInOut());
					break;
				case ccs.FrameEaseType.CIRC_EASEIN:
					e = t.easing(cc.easeCircleActionIn());
					break;
				case ccs.FrameEaseType.CIRC_EASEOUT:
					e = t.easing(cc.easeCircleActionOut());
					break;
				case ccs.FrameEaseType.CIRC_EASEINOUT:
					e = t.easing(cc.easeCircleActionInOut());
					break;
				case ccs.FrameEaseType.ELASTIC_EASEIN:
					e = t.easing(cc.easeElasticIn());
					break;
				case ccs.FrameEaseType.ELASTIC_EASEOUT:
					e = t.easing(cc.easeElasticOut());
					break;
				case ccs.FrameEaseType.ELASTIC_EASEINOUT:
					e = t.easing(cc.easeElasticInOut());
					break;
				case ccs.FrameEaseType.BACK_EASEIN:
					e = t.easing(cc.easeBackIn());
					break;
				case ccs.FrameEaseType.BACK_EASEOUT:
					e = t.easing(cc.easeBackOut());
					break;
				case ccs.FrameEaseType.BACK_EASEINOUT:
					e = t.easing(cc.easeBackInOut());
					break;
				case ccs.FrameEaseType.BOUNCE_EASEIN:
					e = t.easing(cc.easeBounceIn());
					break;
				case ccs.FrameEaseType.BOUNCE_EASEOUT:
					e = t.easing(cc.easeBounceOut());
					break;
				case ccs.FrameEaseType.BOUNCE_EASEINOUT:
					e = t.easing(cc.easeBounceInOut());
			}
			return e;
		},
		setEasingParameter: function (t) {
			this._Parameter = [];
			for (var e = 0; e < t.length; e++) this._Parameter.push(t[e]);
		},
		setEasingType: function (t) {
			this.easingType = t;
		},
	})),
	(ccs.ActionMoveFrame = ccs.ActionFrame.extend({
		_position: null,
		ctor: function () {
			ccs.ActionFrame.prototype.ctor.call(this),
				(this._position = cc.p(0, 0)),
				(this.frameType = ccs.FRAME_TYPE_MOVE);
		},
		setPosition: function (t, e) {
			void 0 === e
				? ((this._position.x = t.x), (this._position.y = t.y))
				: ((this._position.x = t), (this._position.y = e));
		},
		getPosition: function () {
			return this._position;
		},
		getAction: function (t) {
			return this._getEasingAction(cc.moveTo(t, this._position));
		},
	})),
	(ccs.ActionScaleFrame = ccs.ActionFrame.extend({
		_scaleX: 1,
		_scaleY: 1,
		ctor: function () {
			ccs.ActionFrame.prototype.ctor.call(this),
				(this._scaleX = 1),
				(this._scaleY = 1),
				(this.frameType = ccs.FRAME_TYPE_SCALE);
		},
		setScaleX: function (t) {
			this._scaleX = t;
		},
		getScaleX: function () {
			return this._scaleX;
		},
		setScaleY: function (t) {
			this._scaleY = t;
		},
		getScaleY: function () {
			return this._scaleY;
		},
		getAction: function (t) {
			return this._getEasingAction(
				cc.scaleTo(t, this._scaleX, this._scaleY)
			);
		},
	})),
	(ccs.ActionRotationFrame = ccs.ActionFrame.extend({
		_rotation: 0,
		ctor: function () {
			ccs.ActionFrame.prototype.ctor.call(this),
				(this._rotation = 0),
				(this.frameType = ccs.FRAME_TYPE_ROTATE);
		},
		setRotation: function (t) {
			this._rotation = t;
		},
		getRotation: function () {
			return this._rotation;
		},
		getAction: function (t, e) {
			if (void 0 === e)
				return this._getEasingAction(cc.rotateTo(t, this._rotation));
			if (e instanceof cc.ActionRotationFrame) {
				e = this._rotation - e._rotation;
				return this._getEasingAction(cc.rotateBy(t, e));
			}
			return this.getAction(t);
		},
	})),
	(ccs.ActionFadeFrame = ccs.ActionFrame.extend({
		_opacity: 255,
		ctor: function () {
			ccs.ActionFrame.prototype.ctor.call(this),
				(this._opacity = 255),
				(this.frameType = ccs.FRAME_TYPE_FADE);
		},
		setOpacity: function (t) {
			this._opacity = t;
		},
		getOpacity: function () {
			return this._opacity;
		},
		getAction: function (t) {
			return this._getEasingAction(cc.fadeTo(t, this._opacity));
		},
	})),
	(ccs.ActionTintFrame = ccs.ActionFrame.extend({
		_color: null,
		ctor: function () {
			ccs.ActionFrame.prototype.ctor.call(this),
				(this._color = cc.color(255, 255, 255, 255)),
				(this.frameType = ccs.FRAME_TYPE_TINT);
		},
		setColor: function (t) {
			var e = this._color;
			(e.r = t.r), (e.g = t.g), (e.b = t.b);
		},
		getColor: function () {
			var t = this._color;
			return cc.color(t.r, t.g, t.b, t.a);
		},
		getAction: function (t) {
			return this._getEasingAction(
				cc.tintTo(t, this._color.r, this._color.g, this._color.b)
			);
		},
	})),
	(ccs.actionManager = {
		_actionDic: {},
		initWithDictionary: function (t, e, i) {
			for (
				var n = t,
					t = n.lastIndexOf('/'),
					n = n.substr(t + 1, n.length),
					r = e.actionlist,
					o = [],
					s = 0;
				s < r.length;
				s++
			) {
				var c = new ccs.ActionObject(),
					a = r[s];
				c.initWithDictionary(a, i), o.push(c);
			}
			this._actionDic[n] = o;
		},
		getActionByName: function (t, e) {
			var i = t,
				t = i.lastIndexOf('/'),
				i = i.substr(t + 1, i.length),
				n = this._actionDic[i];
			if (!n) return null;
			for (var r = 0; r < n.length; r++) {
				var o = n[r];
				if (e === o.getName()) return o;
			}
			return null;
		},
		playActionByName: function (t, e, i) {
			e = this.getActionByName(t, e);
			e && e.play(i);
		},
		stopActionByName: function (t, e) {
			e = this.getActionByName(t, e);
			e && e.stop();
		},
		releaseActions: function () {
			this._actionDic = {};
		},
		clear: function () {
			this._actionDic = {};
		},
	}),
	(ccs.ActionNode = ccs.Class.extend({
		_currentFrameIndex: 0,
		_destFrameIndex: 0,
		_unitTime: 0,
		_actionTag: 0,
		_object: null,
		_actionSpawn: null,
		_action: null,
		_frameArray: null,
		_frameArrayNum: 0,
		ctor: function () {
			(this._currentFrameIndex = 0),
				(this._destFrameIndex = 0),
				(this._unitTime = 0.1),
				(this._actionTag = 0),
				(this._object = null),
				(this._actionSpawn = null),
				(this._action = null),
				(this._frameArray = []),
				(this._frameArrayNum = ccs.FRAME_TYPE_MAX);
			for (var t = 0; t < this._frameArrayNum; t++)
				this._frameArray.push([]);
		},
		initWithDictionary: function (t, e) {
			this.setActionTag(t.ActionTag);
			for (
				var i = t.actionframelist,
					n = ccui.helper.seekActionWidgetByActionTag(e, t.ActionTag),
					r = n instanceof ccui.Widget && !(n instanceof ccui.Layout),
					o = 0;
				o < i.length;
				o++
			) {
				var s = i[o],
					c = s.frameid,
					a = s.tweenType;
				null == a && (a = 0);
				for (
					var l, h, u, _, d, p, f = s.tweenParameter, m = [], g = 0;
					g < f;
					g++
				) {
					var y = s.tweenParameter[g];
					m.push(y);
				}
				void 0 !== s.positionx &&
					((l = s.positionx),
					(h = s.positiony),
					r &&
						n.parent &&
						((l += (u = n.parent.getAnchorPointInPoints()).x),
						(h += u.y)),
					((u = new ccs.ActionMoveFrame()).frameIndex = c),
					u.setEasingType(a),
					u.setEasingParameter(m),
					u.setPosition(l, h),
					this._frameArray[ccs.FRAME_TYPE_MOVE].push(u)),
					void 0 !== s.scalex &&
						((h = s.scalex),
						(_ = s.scaley),
						((u = new ccs.ActionScaleFrame()).frameIndex = c),
						u.setEasingType(a),
						u.setEasingParameter(m),
						u.setScaleX(h),
						u.setScaleY(_),
						this._frameArray[ccs.FRAME_TYPE_SCALE].push(u)),
					void 0 !== s.rotation &&
						((d = s.rotation),
						((u = new ccs.ActionRotationFrame()).frameIndex = c),
						u.setEasingType(a),
						u.setEasingParameter(m),
						u.setRotation(d),
						this._frameArray[ccs.FRAME_TYPE_ROTATE].push(u)),
					void 0 !== s.opacity &&
						((p = s.opacity),
						((u = new ccs.ActionFadeFrame()).frameIndex = c),
						u.setEasingType(a),
						u.setEasingParameter(m),
						u.setOpacity(p),
						this._frameArray[ccs.FRAME_TYPE_FADE].push(u)),
					void 0 !== s.colorr &&
						((_ = s.colorr),
						(d = s.colorg),
						(p = s.colorb),
						((u = new ccs.ActionTintFrame()).frameIndex = c),
						u.setEasingType(a),
						u.setEasingParameter(m),
						u.setColor(cc.color(_, d, p)),
						this._frameArray[ccs.FRAME_TYPE_TINT].push(u)),
					(s = null);
			}
			this._initActionNodeFromRoot(e);
		},
		_initActionNodeFromRoot: function (t) {
			t instanceof ccui.Widget &&
				(t = ccui.helper.seekActionWidgetByActionTag(
					t,
					this.getActionTag()
				)) &&
				this.setObject(t);
		},
		setUnitTime: function (t) {
			(this._unitTime = t), this._refreshActionProperty();
		},
		getUnitTime: function () {
			return this._unitTime;
		},
		setActionTag: function (t) {
			this._actionTag = t;
		},
		getActionTag: function () {
			return this._actionTag;
		},
		setObject: function (t) {
			this._object = t;
		},
		getObject: function () {
			return this._object;
		},
		getActionNode: function () {
			return this._object instanceof cc.Node ? this._object : null;
		},
		insertFrame: function (t, e) {
			var i;
			null != e &&
				((i = e.frameType), this._frameArray[i].splice(t, 0, e));
		},
		addFrame: function (t) {
			var e;
			t && ((e = t.frameType), this._frameArray[e].push(t));
		},
		deleteFrame: function (t) {
			var e;
			null != t &&
				((e = t.frameType),
				(e = this._frameArray[e]),
				cc.arrayRemoveObject(e, t));
		},
		clearAllFrame: function () {
			for (var t = 0; t < this._frameArrayNum; t++)
				this._frameArray[t].length = 0;
		},
		_refreshActionProperty: function () {
			if (null === this._object) return null;
			for (var t = [], e = 0; e < this._frameArrayNum; e++) {
				var i = this._frameArray[e];
				if (!(i.length <= 0)) {
					for (var n, r = [], o = 0; o < i.length; o++) {
						var s,
							c = i[o],
							a = null;
						(a =
							0 !== o
								? ((s = i[o - 1]),
								  (s =
										(c.frameIndex - s.frameIndex) *
										this.getUnitTime()),
								  c.getAction(s))
								: c.getAction(0)) && r.push(a);
					}
					!r || (null !== (n = cc.sequence(r)) && t.push(n));
				}
			}
			return (
				(this._action = null),
				(this._actionSpawn = cc.spawn(t)),
				this._actionSpawn
			);
		},
		playAction: function (t) {
			null !== this._object &&
				null !== this._actionSpawn &&
				((this._action = t
					? cc.sequence(this._actionSpawn, t)
					: cc.sequence(this._actionSpawn)),
				this._runAction());
		},
		_runAction: function () {
			var t = this.getActionNode();
			null !== t && null !== this._action && t.runAction(this._action);
		},
		stopAction: function () {
			var t = this.getActionNode();
			null !== t &&
				null !== this._action &&
				(this._action.isDone() || t.stopAction(this._action));
		},
		getFirstFrameIndex: function () {
			for (
				var t = 99999,
					e = !1,
					i = this._frameArray,
					n = 0,
					r = this._frameArrayNum;
				n < r;
				n++
			) {
				var o = i[n];
				o.length <= 0 ||
					((e = !0), (t = (o = o[0].frameIndex) < t ? o : t));
			}
			return e || (t = 0), t;
		},
		getLastFrameIndex: function () {
			for (
				var t = -1,
					e = !1,
					i = this._frameArray,
					n = 0,
					r = this._frameArrayNum;
				n < r;
				n++
			) {
				var o = i[n];
				o.length <= 0 ||
					((e = !0),
					(t = t < (o = o[o.length - 1].frameIndex) ? o : t));
			}
			return e || (t = 0), t;
		},
		updateActionToTimeLine: function (t) {
			for (
				var e = !1, i = this.getUnitTime(), n = 0;
				n < this._frameArrayNum;
				n++
			) {
				var r = this._frameArray[n];
				if (null !== r)
					for (var o = 0; o < r.length; o++) {
						var s = r[o];
						if (s.frameIndex * i === t) {
							this._easingToFrame(1, 1, s), (e = !0);
							break;
						}
						if (s.frameIndex * i > t) {
							var c,
								a,
								l,
								e =
									0 === o
										? (this._easingToFrame(1, 1, s), !1)
										: ((c = r[o - 1]),
										  (a =
												(s.frameIndex - c.frameIndex) *
												i),
										  (l = t - c.frameIndex * i),
										  this._easingToFrame(a, 1, c),
										  this._easingToFrame(a, l / a, s),
										  !0);
							break;
						}
					}
			}
			return e;
		},
		_easingToFrame: function (t, e, i) {
			(i = i.getAction(t)), (t = this.getActionNode());
			null != i && null != t && (i.startWithTarget(t), i.update(e));
		},
		isActionDoneOnce: function () {
			return null === this._action || this._action.isDone();
		},
	})),
	(ccs.ActionObject = ccs.Class.extend({
		_actionNodeList: null,
		_name: '',
		_loop: !1,
		_pause: !1,
		_playing: !1,
		_unitTime: 0,
		_currentTime: 0,
		_scheduler: null,
		_callback: null,
		_fTotalTime: 0,
		ctor: function () {
			(this._actionNodeList = []),
				(this._name = ''),
				(this._loop = !1),
				(this._pause = !1),
				(this._playing = !1),
				(this._unitTime = 0.1),
				(this._currentTime = 0),
				(this._fTotalTime = 0),
				(this._scheduler = cc.director.getScheduler());
		},
		setName: function (t) {
			this._name = t;
		},
		getName: function () {
			return this._name;
		},
		setLoop: function (t) {
			this._loop = t;
		},
		getLoop: function () {
			return this._loop;
		},
		setUnitTime: function (t) {
			this._unitTime = t;
			for (var e = this._actionNodeList.length, i = 0; i < e; i++)
				this._actionNodeList[i].setUnitTime(this._unitTime);
		},
		getUnitTime: function () {
			return this._unitTime;
		},
		getCurrentTime: function () {
			return this._currentTime;
		},
		setCurrentTime: function (t) {
			this._currentTime = t;
		},
		getTotalTime: function () {
			return this._fTotalTime;
		},
		isPlaying: function () {
			return this._playing;
		},
		initWithDictionary: function (t, e) {
			this.setName(t.name),
				this.setLoop(t.loop),
				this.setUnitTime(t.unittime);
			for (var i = t.actionnodelist, n = 0, r = 0; r < i.length; r++) {
				var o = new ccs.ActionNode(),
					s = i[r];
				o.initWithDictionary(s, e),
					o.setUnitTime(this.getUnitTime()),
					this._actionNodeList.push(o);
				o = o.getLastFrameIndex() - o.getFirstFrameIndex();
				n < o && (n = o);
			}
			this._fTotalTime = n * this._unitTime;
		},
		addActionNode: function (t) {
			t && (this._actionNodeList.push(t), t.setUnitTime(this._unitTime));
		},
		removeActionNode: function (t) {
			null != t && cc.arrayRemoveObject(this._actionNodeList, t);
		},
		play: function (t) {
			this.stop(), this.updateToFrameByTime(0);
			for (var e = this._actionNodeList, i = e.length, n = 0; n < i; n++)
				e[n].playAction(t);
			this._loop &&
				this._scheduler.schedule(
					this.simulationActionUpdate,
					this,
					0,
					cc.REPEAT_FOREVER,
					0,
					!1,
					this.__instanceId + ''
				),
				void 0 !== t && (this._callback = t);
		},
		pause: function () {
			(this._pause = !0), (this._playing = !1);
		},
		stop: function () {
			for (var t = this._actionNodeList, e = 0; e < t.length; e++)
				t[e].stopAction();
			this._scheduler.unschedule(this.simulationActionUpdate, this),
				(this._pause = !1),
				(this._playing = !1);
		},
		updateToFrameByTime: function (t) {
			this._currentTime = t;
			for (var e = 0; e < this._actionNodeList.length; e++)
				this._actionNodeList[e].updateActionToTimeLine(t);
		},
		simulationActionUpdate: function (t) {
			for (
				var e = !0, i = this._actionNodeList, n = 0, r = i.length;
				n < r;
				n++
			)
				if (!i[n].isActionDoneOnce()) {
					e = !1;
					break;
				}
			e &&
				(null !== this._callback && this._callback.execute(),
				this._loop
					? this.play()
					: ((this._playing = !1),
					  this._scheduler.unschedule(
							this.simulationActionUpdate,
							this
					  )));
		},
	})),
	(ccs.ComAttribute = ccs.Component.extend({
		_jsonDict: null,
		_filePath: '',
		ctor: function () {
			cc.Component.prototype.ctor.call(this),
				(this._jsonDict = {}),
				(this._filePath = ''),
				(this._name = 'CCComAttribute'),
				ccs.ComAttribute.prototype.init.call(this);
		},
		init: function () {
			return (this._jsonDict = {}), !0;
		},
		setInt: function (t, e) {
			t ? (this._jsonDict[t] = e) : cc.log('Argument must be non-nil');
		},
		setDouble: function (t, e) {
			t ? (this._jsonDict[t] = e) : cc.log('Argument must be non-nil');
		},
		setFloat: function (t, e) {
			t ? (this._jsonDict[t] = e) : cc.log('Argument must be non-nil');
		},
		setBool: function (t, e) {
			t ? (this._jsonDict[t] = e) : cc.log('Argument must be non-nil');
		},
		setString: function (t, e) {
			t ? (this._jsonDict[t] = e) : cc.log('Argument must be non-nil');
		},
		setObject: function (t, e) {
			t ? (this._jsonDict[t] = e) : cc.log('Argument must be non-nil');
		},
		getInt: function (t) {
			t = this._jsonDict[t];
			return parseInt(t || 0);
		},
		getDouble: function (t) {
			t = this._jsonDict[t];
			return parseFloat(t || 0);
		},
		getFloat: function (t) {
			t = this._jsonDict[t];
			return parseFloat(t || 0);
		},
		getBool: function (t) {
			t = this._jsonDict[t];
			return Boolean(t || !1);
		},
		getString: function (t) {
			return this._jsonDict[t] || '';
		},
		getObject: function (t) {
			return this._jsonDict[t];
		},
		parse: function (t) {
			this._jsonDict = cc.loader.getRes(t);
		},
	})),
	(ccs.ComAttribute.create = function () {
		return new ccs.ComAttribute();
	}),
	(ccs.ComAudio = ccs.Component.extend({
		_filePath: '',
		_loop: !1,
		ctor: function () {
			cc.Component.prototype.ctor.call(this),
				(this._name = 'Audio'),
				ccs.ComAudio.prototype.init.call(this);
		},
		init: function () {
			return !0;
		},
		onExit: function () {
			this.stopBackgroundMusic(!0), this.stopAllEffects();
		},
		end: function () {
			cc.audioEngine.end();
		},
		preloadBackgroundMusic: function (t) {
			cc.loader.load(t);
		},
		playBackgroundMusic: function (t, e) {
			t
				? cc.audioEngine.playMusic(t, e)
				: cc.audioEngine.playMusic(this._filePath, this._loop);
		},
		stopBackgroundMusic: function (t) {
			cc.audioEngine.stopMusic(t);
		},
		pauseBackgroundMusic: function () {
			cc.audioEngine.pauseMusic();
		},
		resumeBackgroundMusic: function () {
			cc.audioEngine.resumeMusic();
		},
		rewindBackgroundMusic: function () {
			cc.audioEngine.rewindMusic();
		},
		willPlayBackgroundMusic: function () {
			return cc.audioEngine.willPlayMusic();
		},
		isBackgroundMusicPlaying: function () {
			return cc.audioEngine.isMusicPlaying();
		},
		getBackgroundMusicVolume: function () {
			return cc.audioEngine.getMusicVolume();
		},
		setBackgroundMusicVolume: function (t) {
			cc.audioEngine.setMusicVolume(t);
		},
		getEffectsVolume: function () {
			return cc.audioEngine.getEffectsVolume();
		},
		setEffectsVolume: function (t) {
			cc.audioEngine.setEffectsVolume(t);
		},
		playEffect: function (t, e) {
			return t
				? cc.audioEngine.playEffect(t, e)
				: cc.audioEngine.playEffect(this._filePath, this._loop);
		},
		pauseEffect: function (t) {
			cc.audioEngine.pauseEffect(t);
		},
		pauseAllEffects: function () {
			cc.audioEngine.pauseAllEffects();
		},
		resumeEffect: function (t) {
			cc.audioEngine.resumeEffect(t);
		},
		resumeAllEffects: function () {
			cc.audioEngine.resumeAllEffects();
		},
		stopEffect: function (t) {
			cc.audioEngine.stopEffect(t);
		},
		stopAllEffects: function () {
			cc.audioEngine.stopAllEffects();
		},
		preloadEffect: function (t) {
			cc.loader.getRes(t), this.setFile(t), this.setLoop(!1);
		},
		unloadEffect: function (t) {
			cc.audioEngine.unloadEffect(t);
		},
		setFile: function (t) {
			this._filePath = t;
		},
		setLoop: function (t) {
			this._loop = t;
		},
		getFile: function () {
			return this._filePath;
		},
		isLoop: function () {
			return this._loop;
		},
	})),
	(ccs.ComAudio.create = function () {
		return new ccs.ComAudio();
	}),
	(ccs.ComController = ccs.Component.extend({
		ctor: function () {
			cc.Component.prototype.ctor.call(this),
				(this._name = 'ComController'),
				ccs.ComController.prototype.init.call(this);
		},
		onEnter: function () {
			null !== this._owner && this._owner.scheduleUpdate();
		},
		isEnabled: function () {
			return this._enabled;
		},
		setEnabled: function (t) {
			this._enabled = t;
		},
	})),
	(ccs.ComController.create = function () {
		return new ccs.ComController();
	}),
	(ccs.ComRender = ccs.Component.extend({
		_render: null,
		ctor: function (t, e) {
			cc.Component.prototype.ctor.call(this),
				(this._render = t),
				(this._name = e),
				(this.isRenderer = !0),
				ccs.ComRender.prototype.init.call(this);
		},
		onEnter: function () {
			this._owner && this._owner.addChild(this._render);
		},
		onExit: function () {
			this._owner &&
				(this._owner.removeChild(this._render, !0),
				(this._render = null));
		},
		getNode: function () {
			return this._render;
		},
		setNode: function (t) {
			this._render = t;
		},
	})),
	(ccs.ComRender.create = function (t, e) {
		return new ccs.ComRender(t, e);
	}),
	(ccs.objectFactory = {
		_typeMap: {},
		createObject: function (t) {
			var e = null,
				t = this._typeMap[t];
			return t && (e = cc.isFunction(t._fun) ? new t._fun() : t._fun), e;
		},
		registerType: function (t) {
			this._typeMap[t._className] = t;
		},
		createGUI: function (t) {
			var e = null;
			'Panel' === t
				? (t = 'Layout')
				: 'TextArea' === t
				? (t = 'Label')
				: 'TextButton' === t && (t = 'Button');
			t = this._typeMap[t];
			return t && t._fun && (e = t._fun), e;
		},
		removeAll: function () {
			this._typeMap = {};
		},
	}),
	(ccs.TInfo = ccs.Class.extend({
		_className: '',
		_fun: null,
		ctor: function (t, e) {
			e
				? ((this._className = t), (this._fun = e))
				: ((this._className = t._className), (this._fun = t._fun)),
				ccs.objectFactory.registerType(this);
		},
	})),
	(ccs.sendEvent = function (t) {
		var e = ccs.triggerManager.get(t);
		if (null != e)
			for (var i = 0; i < e.length; i++) {
				var n = e[i];
				null != n && n.detect() && n.done();
			}
	}),
	(ccs.registerTriggerClass = function (t, e) {
		new ccs.TInfo(t, e);
	}),
	(ccs.triggerManager = {
		_eventTriggers: {},
		_triggerObjs: {},
		_movementDispatches: [],
		parse: function (t) {
			for (var e = 0; e < t.length; ++e) {
				var i = t[e],
					n = new ccs.TriggerObj();
				n.serialize(i);
				for (var r = n.getEvents(), o = 0; o < r.length; o++) {
					var s = r[o];
					this.add(s, n);
				}
				this._triggerObjs[n.getId()] = n;
			}
		},
		get: function (t) {
			return this._eventTriggers[t];
		},
		getTriggerObj: function (t) {
			return this._triggerObjs[t];
		},
		add: function (t, e) {
			var i = this._eventTriggers[t];
			-1 === (i = i || []).indexOf(e) &&
				(i.push(e), (this._eventTriggers[t] = i));
		},
		removeAll: function () {
			for (var t in this._eventTriggers)
				for (var e = this._eventTriggers[t], i = 0; i < e.length; i++)
					e[i].removeAll();
			this._eventTriggers = {};
		},
		remove: function (t, e) {
			if (e) return this._removeObj(t, e);
			var i = !1;
			do {
				var n = this._eventTriggers[t];
				if (!n) break;
				for (var r = 0; r < n.length; r++) {
					var o = n[r];
					o && o.removeAll();
				}
			} while ((delete this._eventTriggers[t], (i = !0), 0));
			return i;
		},
		_removeObj: function (t, e) {
			var i = !1;
			do {
				var n = this._eventTriggers[t];
				if (!n) break;
				for (var r = 0; r < n.length; r++) {
					var o = n[r];
					if (o && o == e) {
						o.removeAll(), n.splice(r, 1);
						break;
					}
				}
			} while (((i = !0), 0));
			return i;
		},
		removeTriggerObj: function (t) {
			var e = this.getTriggerObj(t);
			if (!e) return !1;
			for (var i = e.getEvents(), n = 0; n < i.length; n++) {
				var r = i[n];
				this.remove(r, e);
			}
			return !0;
		},
		isEmpty: function () {
			return !this._eventTriggers || this._eventTriggers.length <= 0;
		},
		addArmatureMovementCallBack: function (t, e, i) {
			if (null != t && null != i && null != e) {
				for (
					var n, r, o = !1, s = 0;
					s < this._movementDispatches.length;
					s++
				)
					(n = this._movementDispatches[s]) &&
						n[0] === t &&
						(n.addAnimationEventCallBack(e, i), (o = !0));
				o ||
					((r = new ccs.ArmatureMovementDispatcher()),
					t
						.getAnimation()
						.setMovementEventCallFunc(r.animationEvent, r),
					r.addAnimationEventCallBack(e, i),
					this._movementDispatches.push([t, r]));
			}
		},
		removeArmatureMovementCallBack: function (t, e, i) {
			if (null != t && null != e && null != i)
				for (var n, r = 0; r < this._movementDispatches.length; r++)
					(n = this._movementDispatches[r]) &&
						n[0] === t &&
						n.removeAnimationEventCallBack(i, e);
		},
		removeArmatureAllMovementCallBack: function (t) {
			if (null != t)
				for (var e, i = 0; i < this._movementDispatches.length; i++)
					if ((e = this._movementDispatches[i]) && e[0] === t) {
						this._movementDispatches.splice(i, 1);
						break;
					}
		},
		removeAllArmatureMovementCallBack: function () {
			this._movementDispatches.length = 0;
		},
		version: function () {
			return '1.2.0.0';
		},
	}),
	(ccs.ArmatureMovementDispatcher = ccs.Class.extend({
		_mapEventAnimation: null,
		ctor: function () {
			this._mapEventAnimation = [];
		},
		animationEvent: function (t, e, i) {
			for (var n, r, o = 0; o < this._mapEventAnimation.length; o++)
				(n = (r = this._mapEventAnimation[o])[0]),
					(r = r[1]) && r.call(n, t, e, i);
		},
		addAnimationEventCallBack: function (t, e) {
			this._mapEventAnimation.push([e, t]);
		},
		removeAnimationEventCallBack: function (t, e) {
			for (var i = 0; i < this._mapEventAnimation.length; i++)
				this._mapEventAnimation[i][0] === e &&
					this._mapEventAnimation.splice(i, 1);
		},
	})),
	(ccs.BaseTriggerCondition = ccs.Class.extend({
		ctor: function () {},
		init: function () {
			return !0;
		},
		detect: function () {
			return !0;
		},
		serialize: function (t) {},
		removeAll: function () {},
	})),
	(ccs.BaseTriggerAction = ccs.Class.extend({
		ctor: function () {},
		init: function () {
			return !0;
		},
		done: function () {},
		serialize: function (t) {},
		removeAll: function () {},
	})),
	(ccs.TriggerObj = ccs.Class.extend({
		_cons: null,
		_acts: null,
		_id: 0,
		_enable: !0,
		_vInt: null,
		ctor: function () {
			(this._id = 0),
				(this._enable = !0),
				ccs.TriggerObj.prototype.init.call(this);
		},
		init: function () {
			return (this._cons = []), (this._acts = []), (this._vInt = []), !0;
		},
		detect: function () {
			if (!this._enable || 0 === this._cons.length) return !0;
			for (var t = !0, e = null, i = 0; i < this._cons.length; i++)
				(e = this._cons[i]) && e.detect && (t = t && e.detect());
			return t;
		},
		done: function () {
			if (this._enable && 0 !== this._acts.length)
				for (var t, e = 0; e < this._acts.length; e++)
					(t = this._acts[e]) && t.done && t.done();
		},
		removeAll: function () {
			for (var t = null, e = 0; e < this._cons.length; e++)
				(t = this._cons[e]) && t.removeAll();
			this._cons = [];
			for (e = 0; e < this._acts.length; e++)
				(t = this._acts[e]) && t.removeAll();
			this._acts = [];
		},
		serialize: function (t) {
			this._id = t.id || 0;
			for (var e = t.conditions || [], i = 0; i < e.length; i++) {
				var n = (a = e[i]).classname,
					r = ccs.objectFactory.createObject(n);
				r
					? (r.serialize(a), r.init(), this._cons.push(r))
					: cc.log(
							'class named classname(' +
								n +
								') can not implement!'
					  );
			}
			for (var o = t.actions || [], i = 0; i < o.length; i++) {
				var n = (a = o[i]).classname,
					s = ccs.objectFactory.createObject(n);
				s
					? (s.serialize(a), s.init(), this._acts.push(s))
					: cc.log(
							'class named classname(' +
								n +
								') can not implement!'
					  );
			}
			for (var c = t.events || [], i = 0; i < c.length; i++) {
				var a,
					l = (a = c[i]).id;
				l < 0 || this._vInt.push(l);
			}
		},
		getId: function () {
			return this._id;
		},
		setEnable: function (t) {
			this._enable = t;
		},
		getEvents: function () {
			return this._vInt;
		},
	})),
	(ccs.TriggerObj.create = function () {
		return new ccs.TriggerObj();
	}),
	(ccs.ActionTimelineData = ccs.Class.extend({
		_actionTag: 0,
		ctor: function (t) {
			this._init(t);
		},
		_init: function (t) {
			return (this._actionTag = t), !0;
		},
		setActionTag: function (t) {
			this._actionTag = t;
		},
		getActionTag: function () {
			return this._actionTag;
		},
	})),
	(ccs.AnimationInfo = function (t, e, i) {
		(this.name = t), (this.startIndex = e), (this.endIndex = i);
	}),
	(ccs.ComExtensionData = ccs.Component.extend({
		_customProperty: null,
		_timelineData: null,
		_name: 'ComExtensionData',
		ctor: function () {
			return (
				(this._customProperty = ''),
				(this._timelineData = new ccs.ActionTimelineData(0)),
				!0
			);
		},
		setActionTag: function (t) {
			this._timelineData.setActionTag(t);
		},
		getActionTag: function () {
			return this._timelineData.getActionTag();
		},
		setCustomProperty: function (t) {
			this._customProperty = t;
		},
		getCustomProperty: function () {
			return this._customProperty;
		},
	})),
	(ccs.ComExtensionData.create = function () {
		return new ccs.ComExtensionData();
	}),
	(ccs.ActionTimelineData.create = function (t) {
		return new ccs.ActionTimelineData(t);
	}),
	(ccs.ActionTimeline = cc.Action.extend({
		_timelineMap: null,
		_timelineList: null,
		_duration: 0,
		_time: null,
		_timeSpeed: 1,
		_frameInternal: 1 / 60,
		_playing: !1,
		_currentFrame: 0,
		_startFrame: 0,
		_endFrame: 0,
		_loop: null,
		_frameEventListener: null,
		_animationInfos: null,
		_lastFrameListener: null,
		ctor: function () {
			cc.Action.prototype.ctor.call(this),
				(this._timelineMap = {}),
				(this._timelineList = []),
				(this._animationInfos = {}),
				this.init();
		},
		_gotoFrame: function (t) {
			for (var e = this._timelineList.length, i = 0; i < e; i++)
				this._timelineList[i]._gotoFrame(t);
		},
		_stepToFrame: function (t) {
			for (var e = this._timelineList.length, i = 0; i < e; i++)
				this._timelineList[i]._stepToFrame(t);
		},
		_emitFrameEvent: function (t) {
			this._frameEventListener && this._frameEventListener(t);
		},
		init: function () {
			return !0;
		},
		gotoFrameAndPlay: function (t, e, i, n) {
			for (var r, o = 0, s = arguments.length, c = []; o < s; o++)
				'boolean' == typeof arguments[o]
					? (r = arguments[o])
					: c.push(arguments[o]);
			(t = c[0]),
				(e = void 0 !== c[1] ? c[1] : this._duration),
				(i = c[2] || t),
				(n = null == r || r),
				(this._startFrame = t),
				(this._endFrame = e),
				(this._currentFrame = i),
				(this._loop = n),
				(this._time = this._currentFrame * this._frameInternal),
				this.resume(),
				this._gotoFrame(this._currentFrame);
		},
		gotoFrameAndPause: function (t) {
			(this._startFrame = this._currentFrame = t),
				(this._time = this._currentFrame * this._frameInternal),
				this.pause(),
				this._gotoFrame(this._currentFrame);
		},
		pause: function () {
			this._playing = !1;
		},
		resume: function () {
			this._playing = !0;
		},
		isPlaying: function () {
			return this._playing;
		},
		setTimeSpeed: function (t) {
			this._timeSpeed = t;
		},
		getTimeSpeed: function () {
			return this._timeSpeed;
		},
		setDuration: function (t) {
			this._duration = t;
		},
		getDuration: function () {
			return this._duration;
		},
		getStartFrame: function () {
			return this._startFrame;
		},
		getEndFrame: function () {
			return this._endFrame;
		},
		setCurrentFrame: function (t) {
			t >= this._startFrame && t <= this._endFrame
				? ((this._currentFrame = t),
				  (this._time = this._currentFrame * this._frameInternal))
				: cc.log(
						'frame index is not between start frame and end frame'
				  );
		},
		getCurrentFrame: function () {
			return this._currentFrame;
		},
		addTimeline: function (t) {
			var e = t.getActionTag();
			this._timelineMap[e] || (this._timelineMap[e] = []),
				-1 === this._timelineMap[e].indexOf(t) &&
					(this._timelineList.push(t),
					this._timelineMap[e].push(t),
					t.setActionTimeline(this));
		},
		removeTimeline: function (e) {
			var t = e.getActionTag();
			this._timelineMap[t] &&
				this._timelineMap[t].some(function (t) {
					if (t === e) return !0;
				}) &&
				(cc.arrayRemoveObject(this._timelineMap[t], e),
				cc.arrayRemoveObject(this._timelineList, e),
				e.setActionTimeline(null));
		},
		getTimelines: function () {
			return this._timelineList;
		},
		setFrameEventCallFunc: function (t) {
			this._frameEventListener = t;
		},
		clearFrameEventCallFunc: function () {
			this._frameEventListener = null;
		},
		clone: function () {
			var t,
				e = new ccs.ActionTimeline();
			for (t in (e.setDuration(this._duration),
			e.setTimeSpeed(this._timeSpeed),
			this._timelineMap)) {
				var i,
					n = this._timelineMap[t];
				for (i in n) {
					var r = n[i].clone();
					e.addTimeline(r);
				}
			}
			return e;
		},
		reverse: function () {
			return null;
		},
		step: function (t) {
			this._playing &&
				0 !== this._timelineMap.length &&
				0 !== this._duration &&
				((this._time += t * this._timeSpeed),
				(t = this._time - this._endFrame * this._frameInternal) <
				this._frameInternal
					? ((this._currentFrame = Math.floor(
							this._time / this._frameInternal
					  )),
					  this._stepToFrame(this._currentFrame),
					  0 <= t &&
							this._lastFrameListener &&
							this._lastFrameListener())
					: ((this._playing = this._loop),
					  this._playing
							? this.gotoFrameAndPlay(
									this._startFrame,
									this._endFrame,
									this._loop
							  )
							: ((this._time =
									this._endFrame * this._frameInternal),
							  this._currentFrame != this._endFrame &&
									((this._currentFrame = this._endFrame),
									this._stepToFrame(this._currentFrame),
									this._lastFrameListener &&
										this._lastFrameListener()))));
		},
		_foreachNodeDescendant: function (t, e) {
			e(t);
			for (var i = t.getChildren(), n = 0; n < i.length; n++) {
				var r = i[n];
				this._foreachNodeDescendant(r, e);
			}
		},
		startWithTarget: function (t) {
			cc.Action.prototype.startWithTarget.call(this, t);
			var r = this;
			this._foreachNodeDescendant(t, function (t) {
				var e = t.getComponent('ComExtensionData');
				if (e) {
					e = e.getActionTag();
					if (r._timelineMap[e])
						for (
							var i = r._timelineMap[e], n = 0;
							n < i.length;
							n++
						)
							i[n].setNode(t);
				}
			});
		},
		isDone: function () {
			return !1;
		},
		play: function (t, e) {
			var i = this._animationInfos[t];
			if (!i) return cc.log("Can't find animation info for %s", t);
			this.gotoFrameAndPlay(i.startIndex, i.endIndex, e);
		},
		addAnimationInfo: function (t) {
			this._animationInfos[t.name] = t;
		},
		removeAnimationInfo: function (t) {
			delete this._animationInfos[t];
		},
		isAnimationInfoExists: function (t) {
			return this._animationInfos[t];
		},
		getAnimationInfo: function (t) {
			return this._animationInfos[t];
		},
		setLastFrameCallFunc: function (t) {
			this._lastFrameListener = t;
		},
		clearLastFrameCallFunc: function () {
			this._lastFrameListener = null;
		},
	})),
	(ccs.ActionTimeline.create = function () {
		return new ccs.ActionTimeline();
	}),
	(ccs.Frame = ccs.Class.extend({
		_frameIndex: null,
		_tween: null,
		_timeline: null,
		_node: null,
		_tweenType: null,
		_easingParam: null,
		_enterWhenPassed: null,
		ctor: function () {
			(this._frameIndex = 0),
				(this._tween = !0),
				(this._timeline = null),
				(this._node = null),
				(this._enterWhenPassed = !1),
				(this._easingParam = []);
		},
		_emitEvent: function () {
			this._timeline &&
				this._timeline.getActionTimeline()._emitFrameEvent(this);
		},
		_cloneProperty: function (t) {
			(this._frameIndex = t.getFrameIndex()),
				(this._tween = t.isTween()),
				(this._tweenType = t.getTweenType()),
				this.setEasingParams(t.getEasingParams());
		},
		setFrameIndex: function (t) {
			this._frameIndex = t;
		},
		getFrameIndex: function () {
			return this._frameIndex;
		},
		setTimeline: function (t) {
			this._timeline = t;
		},
		getTimeline: function (t) {
			return this._timeline;
		},
		setNode: function (t) {
			this._node = t;
		},
		getNode: function () {
			return this._node;
		},
		setTween: function (t) {
			this._tween = t;
		},
		isTween: function () {
			return this._tween;
		},
		onEnter: function (t) {},
		apply: function (t) {
			this._tween &&
				(this._tweenType !== ccs.FrameEaseType.TWEEN_EASING_MAX &&
					this._tweenType !== ccs.FrameEaseType.LINEAR &&
					(t = this.tweenPercent(t)),
				this._onApply(t));
		},
		_onApply: function (t) {},
		clone: function () {},
		tweenPercent: function (t) {
			var e = ccs.Frame.tweenToMap[this._tweenType];
			return e ? e(t, this._easingParam) : t;
		},
		setEasingParams: function (t) {
			if (t)
				for (var e = (this._easingParam.length = 0); e < t.length; e++)
					this._easingParam[e] = t[e];
		},
		getEasingParams: function () {
			return this._easingParam;
		},
		setTweenType: function (t) {
			this._tweenType = t;
		},
		getTweenType: function () {
			return this._tweenType;
		},
		isEnterWhenPassed: function () {
			return this._enterWhenPassed;
		},
	})),
	(ccs.Frame.tweenToMap = {
		'-1': function (t, e) {
			if (e) {
				var i = 1 - t;
				return (
					e[1] * i * i * i +
					3 * e[3] * t * i * i +
					3 * e[5] * t * t * i +
					e[7] * t * t * t
				);
			}
			return t;
		},
		1: cc._easeSineInObj.easing,
		2: cc._easeSineOutObj.easing,
		3: cc._easeSineInOutObj.easing,
		4: cc._easeQuadraticActionIn.easing,
		5: cc._easeQuadraticActionOut.easing,
		6: cc._easeQuadraticActionInOut.easing,
		7: cc._easeCubicActionIn.easing,
		8: cc._easeCubicActionOut.easing,
		9: cc._easeCubicActionInOut.easing,
		10: cc._easeCubicActionIn.easing,
		11: cc._easeCubicActionOut.easing,
		12: cc._easeCubicActionInOut.easing,
		13: cc._easeQuinticActionIn.easing,
		14: cc._easeQuinticActionOut.easing,
		15: cc._easeQuinticActionInOut.easing,
		16: cc._easeExponentialInObj.easing,
		17: cc._easeExponentialOutObj.easing,
		18: cc._easeExponentialInOutObj.easing,
		19: cc._easeCircleActionIn.easing,
		20: cc._easeCircleActionOut.easing,
		21: cc._easeCircleActionInOut.easing,
		22: function (t, e) {
			var i = 0.3;
			return null != e && (i = e[0]), cc.easeElasticIn(i).easing(t);
		},
		23: function (t, e) {
			var i = 0.3;
			return null != e && (i = e[0]), cc.easeElasticOut(i).easing(t);
		},
		24: function (t, e) {
			var i = 0.3;
			return null != e && (i = e[0]), cc.easeElasticInOut(i).easing(t);
		},
		25: cc._easeBackInObj.easing,
		26: cc._easeBackOutObj.easing,
		27: cc._easeBackInOutObj.easing,
		28: cc._easeBounceInObj.easing,
		29: cc._easeBounceOutObj.easing,
		30: cc._easeBounceInOutObj.easing,
	}),
	(ccs.VisibleFrame = ccs.Frame.extend({
		_visible: !0,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this), (this._visible = !0);
		},
		onEnter: function (t) {
			this._node && this._node.setVisible(this._visible);
		},
		clone: function () {
			var t = new ccs.VisibleFrame();
			return t.setVisible(this._visible), t._cloneProperty(this), t;
		},
		setVisible: function (t) {
			this._visible = t;
		},
		isVisible: function () {
			return this._visible;
		},
	})),
	(ccs.VisibleFrame.create = function () {
		return new ccs.VisibleFrame();
	}),
	(ccs.TextureFrame = ccs.Frame.extend({
		_sprite: null,
		_textureName: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this), (this._textureName = '');
		},
		setNode: function (t) {
			ccs.Frame.prototype.setNode.call(this, t), (this._sprite = t);
		},
		onEnter: function (t) {
			var e, i;
			this._sprite &&
				((e = this._sprite.getBlendFunc()),
				null !=
				(i = cc.spriteFrameCache._spriteFrames[this._textureName])
					? this._sprite.setSpriteFrame(i)
					: this._sprite.setTexture(this._textureName),
				this._sprite.getBlendFunc() !== e &&
					this._sprite.setBlendFunc(e));
		},
		clone: function () {
			var t = new ccs.TextureFrame();
			return (
				t.setTextureName(this._textureName), t._cloneProperty(this), t
			);
		},
		setTextureName: function (t) {
			this._textureName = t;
		},
		getTextureName: function () {
			return this._textureName;
		},
	})),
	(ccs.TextureFrame.create = function () {
		return new ccs.TextureFrame();
	}),
	(ccs.RotationFrame = ccs.Frame.extend({
		_rotation: null,
		_betwennRotation: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this), (this._rotation = 0);
		},
		onEnter: function (t) {
			this._node &&
				(this._node.setRotation(this._rotation),
				this._tween &&
					(this._betwennRotation = t._rotation - this._rotation));
		},
		_onApply: function (t) {
			0 !== this._betwennRotation &&
				((t = this._rotation + t * this._betwennRotation),
				this._node.setRotation(t));
		},
		clone: function () {
			var t = new ccs.RotationFrame();
			return t.setRotation(this._rotation), t._cloneProperty(this), t;
		},
		setRotation: function (t) {
			this._rotation = t;
		},
		getRotation: function () {
			return this._rotation;
		},
	})),
	(ccs.RotationFrame.create = function () {
		return new ccs.RotationFrame();
	}),
	(ccs.SkewFrame = ccs.Frame.extend({
		_skewX: null,
		_skewY: null,
		_betweenSkewX: null,
		_betweenSkewY: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this),
				(this._skewX = 0),
				(this._skewY = 0);
		},
		onEnter: function (t) {
			this._node &&
				(this._node.setSkewX(this._skewX),
				this._node.setSkewY(this._skewY),
				this._tween &&
					((this._betweenSkewX = t._skewX - this._skewX),
					(this._betweenSkewY = t._skewY - this._skewY)));
		},
		_onApply: function (t) {
			var e;
			(0 === this._betweenSkewX && 0 === this._betweenSkewY) ||
				((e = this._skewX + t * this._betweenSkewX),
				(t = this._skewY + t * this._betweenSkewY),
				this._node.setSkewX(e),
				this._node.setSkewY(t));
		},
		clone: function () {
			var t = new ccs.SkewFrame();
			return (
				t.setSkewX(this._skewX),
				t.setSkewY(this._skewY),
				t._cloneProperty(this),
				t
			);
		},
		setSkewX: function (t) {
			this._skewX = t;
		},
		getSkewX: function () {
			return this._skewX;
		},
		setSkewY: function (t) {
			this._skewY = t;
		},
		getSkewY: function () {
			return this._skewY;
		},
	})),
	(ccs.SkewFrame.create = function () {
		return new ccs.SkewFrame();
	}),
	(ccs.RotationSkewFrame = ccs.SkewFrame.extend({
		onEnter: function (t) {
			this._node &&
				(this._node.setRotationX(this._skewX),
				this._node.setRotationY(this._skewY),
				this._tween &&
					((this._betweenSkewX = t._skewX - this._skewX),
					(this._betweenSkewY = t._skewY - this._skewY)));
		},
		_onApply: function (t) {
			var e;
			!this._node ||
				(0 === this._betweenSkewX && 0 === this._betweenSkewY) ||
				((e = this._skewX + t * this._betweenSkewX),
				(t = this._skewY + t * this._betweenSkewY),
				this._node.setRotationX(e),
				this._node.setRotationY(t));
		},
		clone: function () {
			var t = new ccs.RotationSkewFrame();
			return (
				t.setSkewX(this._skewX),
				t.setSkewY(this._skewY),
				t._cloneProperty(this),
				t
			);
		},
	})),
	(ccs.RotationSkewFrame.create = function () {
		return new ccs.RotationSkewFrame();
	}),
	(ccs.PositionFrame = ccs.Frame.extend({
		_position: null,
		_betweenX: null,
		_betweenY: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this), (this._position = cc.p(0, 0));
		},
		onEnter: function (t) {
			this._node &&
				(this._node.setPosition(this._position),
				this._tween &&
					((this._betweenX = t._position.x - this._position.x),
					(this._betweenY = t._position.y - this._position.y)));
		},
		_onApply: function (t) {
			var e;
			!this._node ||
				(0 === this._betweenX && 0 === this._betweenY) ||
				(((e = cc.p(0, 0)).x = this._position.x + this._betweenX * t),
				(e.y = this._position.y + this._betweenY * t),
				this._node.setPosition(e));
		},
		clone: function () {
			var t = new ccs.PositionFrame();
			return t.setPosition(this._position), t._cloneProperty(this), t;
		},
		setPosition: function (t) {
			this._position = t;
		},
		getPosition: function () {
			return this._position;
		},
		setX: function (t) {
			this._position.x = t;
		},
		getX: function () {
			return this._position.x;
		},
		setY: function (t) {
			this._position.y = t;
		},
		getY: function () {
			return this._position.y;
		},
	})),
	(ccs.PositionFrame.create = function () {
		return new ccs.PositionFrame();
	}),
	(ccs.ScaleFrame = ccs.Frame.extend({
		_scaleX: null,
		_scaleY: null,
		_betweenScaleX: null,
		_betweenScaleY: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this),
				(this._scaleX = 1),
				(this._scaleY = 1);
		},
		onEnter: function (t) {
			this._node &&
				(this._node.setScaleX(this._scaleX),
				this._node.setScaleY(this._scaleY),
				this._tween &&
					((this._betweenScaleX = t._scaleX - this._scaleX),
					(this._betweenScaleY = t._scaleY - this._scaleY)));
		},
		_onApply: function (t) {
			var e;
			!this._node ||
				(0 === this._betweenScaleX && 0 === this._betweenScaleY) ||
				((e = this._scaleX + this._betweenScaleX * t),
				(t = this._scaleY + this._betweenScaleY * t),
				this._node.setScaleX(e),
				this._node.setScaleY(t));
		},
		clone: function () {
			var t = new ccs.ScaleFrame();
			return (
				t.setScaleX(this._scaleX),
				t.setScaleY(this._scaleY),
				t._cloneProperty(this),
				t
			);
		},
		setScale: function (t) {
			(this._scaleX = t), (this._scaleY = t);
		},
		setScaleX: function (t) {
			this._scaleX = t;
		},
		getScaleX: function () {
			return this._scaleX;
		},
		setScaleY: function (t) {
			this._scaleY = t;
		},
		getScaleY: function () {
			return this._scaleY;
		},
	})),
	(ccs.ScaleFrame.create = function () {
		return new ccs.ScaleFrame();
	}),
	(ccs.AnchorPointFrame = ccs.Frame.extend({
		_anchorPoint: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this),
				(this._anchorPoint = cc.p(0, 0));
		},
		onEnter: function (t) {
			this._node && this._node.setAnchorPoint(this._anchorPoint);
		},
		clone: function () {
			var t = new ccs.AnchorPointFrame();
			return (
				t.setAnchorPoint(this._anchorPoint), t._cloneProperty(this), t
			);
		},
		setAnchorPoint: function (t) {
			this._anchorPoint = t;
		},
		getAnchorPoint: function () {
			return this._anchorPoint;
		},
	})),
	(ccs.AnchorPointFrame.create = function () {
		return new ccs.AnchorPointFrame();
	}),
	(ccs.InnerActionType = { LoopAction: 0, NoLoopAction: 1, SingleFrame: 2 }),
	(ccs.InnerActionFrame = ccs.Frame.extend({
		_innerActionType: null,
		_startFrameIndex: null,
		_endFrameIndex: 0,
		_singleFrameIndex: 0,
		_enterWithName: null,
		_animationName: '',
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this),
				(this._enterWithName = !1),
				(this._innerActionType = ccs.InnerActionType.LoopAction),
				(this._startFrameIndex = 0);
		},
		onEnter: function (t) {
			var e, i, n, r;
			!this._node ||
				((e = this._node.getActionByTag(this._node.getTag())) &&
					(ccs.InnerActionType.SingleFrame !== this._innerActionType
						? ((i = this._startFrameIndex),
						  (n = this._endFrameIndex),
						  this._enterWithName &&
								('-- ALL --' === this._animationName
									? ((i = 0), (n = e.getDuration()))
									: e.isAnimationInfoExists(
											this._animationName
									  )
									? ((i = (r = e.getAnimationInfo(
											this._animationName
									  )).startIndex),
									  (n = r.endIndex))
									: cc.log(
											'Animation %s not exists!',
											this._animationName
									  )),
						  (r =
								this._timeline
									.getActionTimeline()
									.getDuration() -
								this._frameIndex -
								n +
								i) < 0 && (n += r),
						  ccs.InnerActionType.NoLoopAction ===
						  this._innerActionType
								? e.gotoFrameAndPlay(i, n, !1)
								: ccs.InnerActionType.LoopAction ===
										this._innerActionType &&
								  e.gotoFrameAndPlay(i, n, !0))
						: e.gotoFrameAndPause(this._singleFrameIndex)));
		},
		setAnimationName: function (t) {
			this._animationName = t;
		},
		setSingleFrameIndex: function (t) {
			this._singleFrameIndex = t;
		},
		getSingleFrameIndex: function () {
			return this._startFrameIndex;
		},
		setEnterWithName: function (t) {
			this._enterWithName = t;
		},
		getEnterWithName: function () {
			return this._enterWithName;
		},
		clone: function () {
			var t = new ccs.InnerActionFrame();
			return (
				t.setInnerActionType(this._innerActionType),
				t.setStartFrameIndex(this._startFrameIndex),
				t.setEnterWithName(this._enterWithName),
				t.setAnimationName(this._animationName),
				t.setSingleFrameIndex(this._singleFrameIndex),
				t._cloneProperty(this),
				t
			);
		},
		setInnerActionType: function (t) {
			this._innerActionType = t;
		},
		getInnerActionType: function () {
			return this._innerActionType;
		},
		setStartFrameIndex: function (t) {
			this._startFrameIndex = t;
		},
		getStartFrameIndex: function () {
			return this._startFrameIndex;
		},
	})),
	(ccs.InnerActionFrame.create = function () {
		return new ccs.InnerActionFrame();
	}),
	(ccs.ColorFrame = ccs.Frame.extend({
		_alpha: null,
		_color: null,
		_betweenAlpha: null,
		_betweenRed: null,
		_betweenGreen: null,
		_betweenBlue: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this),
				(this._color = cc.color(255, 255, 255));
		},
		onEnter: function (t) {
			this._node &&
				(this._node.setColor(this._color),
				this._tween &&
					((t = t._color),
					(this._betweenRed = t.r - this._color.r),
					(this._betweenGreen = t.g - this._color.g),
					(this._betweenBlue = t.b - this._color.b)));
		},
		_onApply: function (t) {
			var e;
			this._node &&
				this._tween &&
				(0 !== this._betweenAlpha ||
					0 !== this._betweenRed ||
					0 !== this._betweenGreen ||
					0 !== this._betweenBlue) &&
				(((e = cc.color(255, 255, 255)).r =
					this._color.r + this._betweenRed * t),
				(e.g = this._color.g + this._betweenGreen * t),
				(e.b = this._color.b + this._betweenBlue * t),
				this._node.setColor(e),
				null !== this._alpha &&
					((t = this._alpha + this._betweenAlpha * t),
					this._node.setOpacity(t)));
		},
		clone: function () {
			var t = new ccs.ColorFrame();
			return t.setColor(this._color), t._cloneProperty(this), t;
		},
		setColor: function (t) {
			this._color = t;
		},
		getColor: function () {
			return this._color;
		},
	})),
	(ccs.ColorFrame.create = function () {
		return new ccs.ColorFrame();
	}),
	(ccs.AlphaFrame = ccs.Frame.extend({
		_alpha: null,
		_betweenAlpha: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this), (this._alpha = 255);
		},
		onEnter: function (t) {
			this._node &&
				(this._node.setOpacity(this._alpha),
				this._tween && (this._betweenAlpha = t._alpha - this._alpha));
		},
		_onApply: function (t) {
			this._node &&
				((t = this._alpha + this._betweenAlpha * t),
				this._node.setOpacity(t));
		},
		setAlpha: function (t) {
			this._alpha = t;
		},
		getAlpha: function () {
			return this._alpha;
		},
		clone: function () {
			var t = new ccs.AlphaFrame();
			return t.setAlpha(this._alpha), t._cloneProperty(this), t;
		},
	})),
	(ccs.EventFrame = ccs.Frame.extend({
		_event: null,
		ctor: function () {
			ccs.Frame.prototype.ctor.call(this),
				(this._event = ''),
				(this._enterWhenPassed = !0);
		},
		onEnter: function (t) {
			this._emitEvent();
		},
		clone: function () {
			var t = new ccs.EventFrame();
			return t.setEvent(this._event), t._cloneProperty(this), t;
		},
		setEvent: function (t) {
			this._event = t;
		},
		getEvent: function () {
			return this._event;
		},
	})),
	(ccs.EventFrame.create = function () {
		return new ccs.EventFrame();
	}),
	(ccs.ZOrderFrame = ccs.Frame.extend({
		_zorder: 0,
		onEnter: function (t) {
			this._node && this._node.setLocalZOrder(this._zorder);
		},
		clone: function () {
			var t = new ccs.ZOrderFrame();
			return t.setZOrder(this._zorder), t._cloneProperty(this), t;
		},
		setZOrder: function (t) {
			this._zorder = t;
		},
		getZOrder: function () {
			return this._zorder;
		},
	})),
	(ccs.ZOrderFrame.create = function () {
		return new ccs.ZOrderFrame();
	}),
	(ccs.BlendFuncFrame = ccs.Frame.extend({
		ctor: function () {
			this._super(), (this._blendFunc = null);
		},
		onEnter: function (t, e) {
			this._node &&
				this._blendFunc &&
				this._node.setBlendFunc(this._blendFunc);
		},
		clone: function () {
			var t = new ccs.BlendFuncFrame();
			return t.setBlendFunc(this._blendFunc), t._cloneProperty(this), t;
		},
		setBlendFunc: function (t) {
			t && t.src && t.dst && (this._blendFunc = t);
		},
		getBlendFunc: function () {
			return this._blendFunc;
		},
	})),
	(ccs.BlendFuncFrame.create = function () {
		return new ccs.BlendFuncFrame();
	}),
	(ccs.Timeline = ccs.Class.extend({
		_frames: null,
		_currentKeyFrame: null,
		_currentKeyFrameIndex: null,
		_fromIndex: null,
		_toIndex: null,
		_betweenDuration: null,
		_actionTag: null,
		_ActionTimeline: null,
		_node: null,
		ctor: function () {
			(this._frames = []),
				(this._currentKeyFrame = null),
				(this._currentKeyFrameIndex = 0),
				(this._fromIndex = 0),
				(this._toIndex = 0),
				(this._betweenDuration = 0),
				(this._actionTag = 0),
				(this._ActionTimeline = null),
				(this._node = null);
		},
		_gotoFrame: function (t) {
			0 !== this._frames.length &&
				(this._binarySearchKeyFrame(t), this._apply(t));
		},
		_stepToFrame: function (t) {
			0 !== this._frames.length &&
				(this._updateCurrentKeyFrame(t), this._apply(t));
		},
		getFrames: function () {
			return this._frames;
		},
		addFrame: function (t) {
			this._frames.push(t), t.setTimeline(this);
		},
		insertFrame: function (t, e) {
			this._frames.splice(e, 0, t), t.setTimeline(this);
		},
		removeFrame: function (t) {
			cc.arrayRemoveObject(this._frames, t), t.setTimeline(null);
		},
		setActionTag: function (t) {
			this._actionTag = t;
		},
		getActionTag: function () {
			return this._actionTag;
		},
		setNode: function (t) {
			for (var e = 0; e < this._frames.length; e++)
				this._frames[e].setNode(t);
		},
		getNode: function () {
			return this._node;
		},
		setActionTimeline: function (t) {
			this._ActionTimeline = t;
		},
		getActionTimeline: function () {
			return this._ActionTimeline;
		},
		clone: function () {
			var t = new ccs.Timeline();
			t._actionTag = this._actionTag;
			for (var e = 0; e < this._frames.length; e++) {
				var i = this._frames[e].clone();
				t.addFrame(i);
			}
			return t;
		},
		_apply: function (t) {
			this._currentKeyFrame &&
				((t =
					this._betweenDuration <= 0
						? 0
						: (t - this._currentKeyFrameIndex) /
						  this._betweenDuration),
				this._currentKeyFrame.apply(t));
		},
		_binarySearchKeyFrame: function (t) {
			var e = null,
				i = null,
				n = this._frames.length,
				r = !1;
			do {
				if (t < this._frames[0].getFrameIndex()) {
					this._currentKeyFrameIndex >=
						this._frames[0].getFrameIndex() && (r = !0),
						(this._fromIndex = 0),
						(this._toIndex = 0),
						(e = i = this._frames[0]),
						(this._currentKeyFrameIndex = 0),
						(this._betweenDuration =
							this._frames[0].getFrameIndex());
					break;
				}
				if (t >= this._frames[n - 1].getFrameIndex()) {
					(this._fromIndex = n - 1),
						(this._toIndex = 0),
						(e = i = this._frames[n - 1]),
						(this._currentKeyFrameIndex =
							this._frames[n - 1].getFrameIndex()),
						(this._betweenDuration = 0);
					break;
				}
				for (var o, s = -1, c = 0, a = n - 1; c <= a; ) {
					if (
						((o = Math.ceil((c + a) / 2)),
						t >= this._frames[o].getFrameIndex() &&
							t < this._frames[o + 1].getFrameIndex())
					) {
						s = o;
						break;
					}
					this._frames[o].getFrameIndex() > t
						? (a = o - 1)
						: (c = o + 1);
				}
			} while (
				((this._fromIndex = s),
				(this._toIndex = 1 < n ? (s + 1) | 0 : 0 | s),
				(e = this._frames[this._fromIndex]),
				(i = this._frames[this._toIndex]),
				(e = this._frames[s]),
				(i = this._frames[s + 1]),
				0 === s &&
					this._currentKeyFrameIndex < e.getFrameIndex() &&
					(r = !0),
				(this._currentKeyFrameIndex = e.getFrameIndex()),
				(this._betweenDuration = i.getFrameIndex() - e.getFrameIndex()),
				0)
			);
			(!r && this._currentKeyFrame == e) ||
				((this._currentKeyFrame = e), this._currentKeyFrame.onEnter(i));
		},
		_updateCurrentKeyFrame: function (t) {
			if (
				(60 < t && 0,
				t < this._currentKeyFrameIndex ||
					t >= this._currentKeyFrameIndex + this._betweenDuration)
			) {
				var e = null,
					i = null;
				do {
					var n = this._frames.length;
					if (t < this._frames[0].getFrameIndex()) {
						(e = i = this._frames[0]),
							(this._currentKeyFrameIndex = 0),
							(this._betweenDuration =
								this._frames[0].getFrameIndex());
						break;
					}
					if (t >= this._frames[n - 1].getFrameIndex()) {
						var r = this._frames[n - 1].getFrameIndex();
						if (this._currentKeyFrameIndex >= r) return;
						t = r;
					}
					for (;;) {
						if (
							((this._fromIndex = this._toIndex),
							(e = this._frames[this._fromIndex]),
							(this._currentKeyFrameIndex = e.getFrameIndex()),
							(this._toIndex = this._fromIndex + 1),
							this._toIndex >= n && (this._toIndex = 0),
							(i = this._frames[this._toIndex]),
							t === e.getFrameIndex())
						)
							break;
						if (t > e.getFrameIndex() && t < i.getFrameIndex())
							break;
						e.isEnterWhenPassed() && e.onEnter(i);
					}
				} while (
					((this._betweenDuration =
						i.getFrameIndex() - e.getFrameIndex()),
					0)
				);
				(this._currentKeyFrame = e), this._currentKeyFrame.onEnter(i);
			}
		},
	})),
	(ccs.Timeline.create = function () {
		return new ccs.Timeline();
	}),
	(ccs.SkinNode = (function () {
		var t = cc.Node.extend({});
		return (t.create = function () {}), t;
	})()),
	(ccs.BoneNode = (function () {
		var o = cc.Node,
			s = ccs.SkinNode,
			e = cc.BlendFunc,
			h = { p: cc.p, size: cc.size, rect: cc.rect },
			c = { log: cc.log, assert: cc.assert },
			i = o.extend({
				_customCommand: null,
				_blendFunc: null,
				_rackColor: null,
				_rackLength: null,
				_rackWidth: null,
				_childBones: null,
				_boneSkins: null,
				_rootSkeleton: null,
				_squareVertices: null,
				_squareColors: null,
				_noMVPVertices: null,
				ctor: function (t) {
					o.prototype.ctor.call(this),
						null === this._squareVertices &&
							(this._squareVertices = [
								{ x: 0, y: 0 },
								{ x: 0, y: 0 },
								{ x: 0, y: 0 },
								{ x: 0, y: 0 },
							]),
						(this._rackColor = cc.color.WHITE),
						(this._blendFunc = e.ALPHA_NON_PREMULTIPLIED),
						(this._childBones = []),
						(this._boneSkins = []),
						(this._rackLength = void 0 === t ? 50 : t),
						(this._rackWidth = 20),
						this._updateVertices();
				},
				addSkin: function (t, e, i) {
					var n = this._boneSkins;
					if ((c.assert(null != t, 'Argument must be non-nil'), i))
						for (var r = 0; r < n.length; r++) n[r].setVisible(!1);
					o.prototype.addChild.call(this, t),
						this._boneSkins.push(t),
						t.setVisible(e);
				},
				getChildBones: function () {
					return this._childBones;
				},
				getSkins: function () {
					return this._boneSkins;
				},
				displaySkin: function (t, e) {
					var i,
						n,
						r = this._boneSkins;
					if ('string' == typeof t)
						for (n = 0; n < r.length; n++)
							t == (i = r[n]).getName()
								? i.setVisible(!0)
								: e && i.setVisible(!1);
					else
						for (n = 0; n < r.length; n++)
							(i = r[n]) == t
								? i.setVisible(!0)
								: e && i.setVisible(!1);
				},
				getVisibleSkins: function () {
					for (
						var t, e = [], i = this._boneSkins, n = 0;
						n < i.length;
						n++
					)
						(t = i[n]).isVisible() && e.push(t);
					return e;
				},
				getRootSkeletonNode: function () {
					return this._rootSkeleton;
				},
				getAllSubBones: function () {
					for (
						var t = [], e = [], i = this._childBones, n = 0;
						n < i.length;
						n++
					)
						e.push(i[n]);
					for (; 0 < e.length; ) {
						var r = e.pop();
						t.push(r);
						for (var o = r.getChildBones(), s = 0; s < o; s++)
							e.push(o[s]);
					}
					return t;
				},
				getAllSubSkins: function () {
					for (
						var t = this.getAllSubBones(), e = [], i = 0;
						i < t.length;
						i++
					)
						for (var n = t[i].getSkins(), r = 0; r < n.length; r++)
							e.push(n[i]);
					return e;
				},
				addChild: function (t, e, i) {
					o.prototype.addChild.call(this, t, e, i),
						this._addToChildrenListHelper(t);
				},
				removeChild: function (t, e) {
					-1 !== this._children.indexOf(t) &&
						(o.prototype.removeChild.call(this, t, e),
						this._removeFromChildrenListHelper(t));
				},
				setBlendFunc: function (t) {
					var e = this._blendFunc;
					if (t && e.src !== t.src && e.dst !== t.dst) {
						this._blendFunc = t;
						for (var i = this._boneSkins, n = 0; n < i.length; n++)
							i[n].setBlendFunc(t);
					}
				},
				getBlendFunc: function () {
					return this._blendFunc;
				},
				setDebugDrawLength: function (t) {
					(this._rackLength = t), this._updateVertices();
				},
				getDebugDrawLength: function () {
					return this._rackLength;
				},
				setDebugDrawWidth: function (t) {
					(this._rackWidth = t), this._updateVertices();
				},
				getDebugDrawWidth: function () {
					return this._rackWidth;
				},
				setDebugDrawEnabled: function (t) {
					var e = this._renderCmd;
					e._debug !== t &&
						((e._debug = t),
						(cc.renderer.childrenOrderDirty = !0),
						this._visible &&
							null != this._rootSkeleton &&
							((this._rootSkeleton._subBonesDirty = !0),
							(this._rootSkeleton._subBonesOrderDirty = !0)));
				},
				isDebugDrawEnabled: function () {
					return this._renderCmd._debug;
				},
				setDebugDrawColor: function (t) {
					this._rackColor = t;
				},
				getDebugDrawColor: function () {
					return this._rackColor;
				},
				getVisibleSkinsRect: function () {
					var t,
						e,
						i = 0,
						n = (t = e = i),
						r = !0,
						o = h.rect(0, 0, 0, 0);
					this._renderCmd._debug &&
						null != this._rootSkeleton &&
						this._rootSkeleton._renderCmd._debug &&
						((e = this._rackWidth),
						(i = this._rackLength),
						(r = !1));
					for (var s, c = this._boneSkins, a = 0; a < c.length; a++) {
						var l = (s = c[a]).getBoundingBox();
						!s.isVisible() ||
							(0 === l.x &&
								0 === l.y &&
								0 === l.width &&
								0 === l.height) ||
							(r
								? ((n = cc.rectGetMinX(l)),
								  (t = cc.rectGetMinY(l)),
								  (e = cc.rectGetMaxX(l)),
								  (i = cc.rectGetMaxY(l)),
								  (r = !1))
								: ((n = Math.min(cc.rectGetMinX(l), n)),
								  (t = Math.min(cc.rectGetMinY(l), t)),
								  (e = Math.max(cc.rectGetMaxX(l), e)),
								  (i = Math.max(cc.rectGetMaxY(l), i))),
							o.setRect(n, t, e - n, i - t));
					}
					return o;
				},
				getBoundingBox: function () {
					var t = this.getVisibleSkinsRect();
					return cc.rectApplyAffineTransform(
						t,
						this.getNodeToParentAffineTransform()
					);
				},
				batchBoneDrawToSkeleton: function (t) {},
				setLocalZOrder: function (t) {
					o.prototype.setLocalZOrder.call(this, t),
						null != this._rootSkeleton &&
							(this._rootSkeleton._subBonesOrderDirty = !0);
				},
				setName: function (t) {
					var e,
						i = this._rootSkeleton,
						n = this.getName();
					o.prototype.setName.call(this, t),
						null != i &&
							((e = i._subBonesMap[n]),
							(n = i._subBonesMap[t]),
							e &&
								!n &&
								(delete i._subBonesMap[e],
								(i._subBonesMap[t] = e)));
				},
				setContentSize: function (t) {
					o.prototype.setContentSize.call(this, t),
						this._updateVertices();
				},
				setAnchorPoint: function (t) {
					o.prototype.setAnchorPoint.call(this, t),
						this._updateVertices();
				},
				setVisible: function (t) {
					this._visible != t &&
						(o.prototype.setVisible.call(this, t),
						null != this._rootSkeleton &&
							((this._rootSkeleton._subBonesDirty = !0),
							(this._rootSkeleton._subBonesOrderDirty = !0)));
				},
				_addToChildrenListHelper: function (t) {
					t instanceof i
						? this._addToBoneList(t)
						: this._addToSkinList(t);
				},
				_removeFromChildrenListHelper: function (t) {
					t instanceof i
						? this._removeFromBoneList(t)
						: t instanceof s && this._removeFromSkinList(skin);
				},
				_removeFromBoneList: function (t) {
					if (
						null != this._rootSkeleton &&
						t instanceof ccs.SkeletonNode &&
						t._rootSkeleton === this._rootSkeleton
					) {
						t._rootSkeleton = null;
						var e = t.getAllSubBones();
						e.push(t);
						for (var i, n = 0; n < e.length; n++)
							((i = e[n])._rootSkeleton = null),
								delete this._rootSkeleton._subBonesMap[
									i.getName()
								],
								(this._rootSkeleton._subBonesDirty = !0),
								(this._rootSkeleton._subBonesOrderDirty = !0);
					} else
						(this._rootSkeleton._subBonesDirty = !0),
							(this._rootSkeleton._subBonesOrderDirty = !0);
					cc.arrayRemoveObject(this._childBones, t);
				},
				_setRootSkeleton: function (t) {
					this._rootSkeleton = t;
					for (
						var e = this.getAllSubBones(), i = 0;
						i < e.length;
						i++
					)
						this._addToBoneList(e[i]);
				},
				_addToBoneList: function (t) {
					if (
						(-1 === this._childBones.indexOf(t) &&
							this._childBones.push(t),
						null != this._rootSkeleton) &&
						!(t instanceof s || t._rootSkeleton)
					) {
						var e = t.getAllSubBones();
						e.push(t);
						for (var i, n = 0; n < e.length; n++) {
							(i = e[n])._setRootSkeleton(this._rootSkeleton);
							var r = i.getName();
							this._rootSkeleton._subBonesMap[r]
								? cc.log(
										'already has a bone named %s in skeleton %s',
										r,
										this._rootSkeleton.getName()
								  )
								: (this._rootSkeleton._subBonesMap[
										i.getName()
								  ] = i),
								(this._rootSkeleton._subBonesDirty = !0),
								(this._rootSkeleton._subBonesOrderDirty = !0);
						}
					}
				},
				_visitSkins: function () {
					var t = this._renderCmd;
					if (this._visible) {
						var e = t.getParentRenderCmd();
						e && (t._curLevel = e._curLevel + 1);
						var i,
							n,
							r = this._boneSkins;
						t._syncStatus(e);
						var o = r.length;
						if (0 < o) {
							for (
								this.sortAllChildren(), i = 0;
								i < o && (n = r[i])._localZOrder < 0;
								i++
							)
								n._renderCmd.visit(t);
							for (; i < o; i++) r[i]._renderCmd.visit(t);
						}
						t._dirtyFlag = 0;
					}
				},
				_addToSkinList: function (t) {
					var e;
					this._boneSkins.push(t),
						t.getBlendFunc &&
							((e = t.getBlendFunc()),
							this._blendFunc.src !== e.src &&
								this._blendFunc.dst !== e.dst &&
								t.setBlendFunc(this._blendFunc));
				},
				_removeFromSkinList: function (t) {
					cc.arrayRemoveObject(this._boneSkins, t);
				},
				sortAllChildren: function () {
					this._sortArray(this._childBones),
						this._sortArray(this._boneSkins),
						o.prototype.sortAllChildren.call(this);
				},
				_sortArray: function (t) {
					if (t)
						for (var e, i, n = t.length, r = 1; r < n; r++) {
							for (i = t[r], e = r - 1; 0 <= e; ) {
								if (i._localZOrder < t[e]._localZOrder)
									t[e + 1] = t[e];
								else {
									if (
										!(
											i._localZOrder ===
												t[e]._localZOrder &&
											i.arrivalOrder < t[e].arrivalOrder
										)
									)
										break;
									t[e + 1] = t[e];
								}
								e--;
							}
							t[e + 1] = i;
						}
				},
				_updateVertices: function () {
					var t = this._squareVertices,
						e = this._renderCmd._anchorPointInPoints;
					if (
						this._rackLength != t[2].x - e.x ||
						t[3].y != this._rackWidth / 2 - e.y
					) {
						(t[1].x = t[1].y = t[3].y = 0),
							(t[0].x = t[2].x = 0.1 * this._rackLength),
							(t[2].y = 0.5 * this._rackWidth),
							(t[0].y = -t[2].y),
							(t[3].x = this._rackLength);
						for (var i = 0; i < t.length; i++)
							(t[i].x += e.x), (t[i].y += e.y);
						this._renderCmd.updateDebugPoint(t);
					}
				},
				_createRenderCmd: function () {
					return new (
						cc._renderType === cc.game.RENDER_TYPE_CANVAS ? t : a
					)(this);
				},
			});
		i.create = function (t, e) {
			return new ccui.BoneNode(t, e);
		};
		var t =
			(((r = n.prototype =
				Object.create(o.CanvasRenderCmd.prototype)).constructor = n),
			(r.visit = function (t) {
				var e = this._node;
				e._visit && e._visit(t);
			}),
			(r.updateDebugPoint = function (t) {
				this._drawNode.clear(),
					this._drawNode.drawPoly(t, this._color, 0, this._color);
			}),
			(r.transform = function (t, e) {
				var i = this._node._rootSkeleton;
				o.CanvasRenderCmd.prototype.transform.call(this, t, e),
					i &&
						i._renderCmd._debug &&
						this._drawNode._renderCmd.transform(this);
			}),
			n);
		function n(t) {
			o.CanvasRenderCmd.call(this, t),
				(this._debug = !1),
				(this._color = cc.color.WHITE),
				(this._drawNode = new cc.DrawNode());
		}
		var r,
			a =
				(((r = l.prototype =
					Object.create(o.WebGLRenderCmd.prototype)).constructor = l),
				(r.visit = function (t) {
					var e = this._node;
					e._visit && e._visit(t);
				}),
				(r.updateDebugPoint = function (t) {
					this._drawNode.clear(),
						this._drawNode.drawPoly(t, this._color, 0, this._color);
				}),
				(r.transform = function (t, e) {
					var i = this._node._rootSkeleton;
					o.WebGLRenderCmd.prototype.transform.call(this, t, e),
						i &&
							i._renderCmd._debug &&
							this._drawNode._renderCmd.transform(this);
				}),
				l);
		function l(t) {
			o.WebGLRenderCmd.call(this, t),
				(this._debug = !1),
				(this._color = cc.color.WHITE),
				(this._drawNode = new cc.DrawNode());
		}
		return i;
	})()),
	(ccs.SkeletonNode = (function () {
		var t = ccs.BoneNode,
			e =
				(cc.p,
				cc.size,
				cc.rect,
				t.extend({
					_subBonesMap: null,
					_squareVertices: null,
					_squareColors: null,
					_noMVPVertices: null,
					_skinGroupMap: null,
					_sortedAllBonesDirty: !1,
					_sortedAllBones: null,
					_batchedBoneVetices: null,
					_batchedBoneColors: null,
					_batchedVeticesCount: null,
					_batchBoneCommand: null,
					_subOrderedAllBones: null,
					ctor: function () {
						(this._squareVertices = [
							{ x: 0, y: 0 },
							{ x: 0, y: 0 },
							{ x: 0, y: 0 },
							{ x: 0, y: 0 },
							{ x: 0, y: 0 },
							{ x: 0, y: 0 },
							{ x: 0, y: 0 },
							{ x: 0, y: 0 },
						]),
							(this._rootSkeleton = this),
							t.prototype.ctor.call(this),
							(this._subBonesMap = {}),
							(this._subOrderedAllBones = []),
							(this._skinGroupMap = {}),
							(this._rackLength = this._rackWidth = 20),
							this._updateVertices();
					},
					getBoneNode: function (t) {
						t = this._subBonesMap[t];
						return t || null;
					},
					getAllSubBonesMap: function () {
						return this._subBonesMap;
					},
					changeSkins: function (t) {
						if ('object' == typeof t) {
							var e, i;
							for (i in t) {
								e = t[i];
								var n = this.getBoneNode(i);
								null !== n && n.displaySkin(e, !0);
							}
						} else {
							var r = this._suitMap[t];
							r && this.changeSkins(r, !0);
						}
					},
					addSkinGroup: function (t, e) {
						this._skinGroupMap[t] = e;
					},
					getBoundingBox: function () {
						var t,
							e,
							i = 0,
							n = (t = e = i),
							r = this.getVisibleSkinsRect(),
							o = !0;
						(0 === r.x &&
							0 === r.y &&
							0 === r.width &&
							0 === r.height) ||
							((n = cc.rectGetMinX(r)),
							(t = cc.rectGetMinY(r)),
							(e = cc.rectGetMaxX(r)),
							(i = cc.rectGetMaxY(r)),
							(o = !1));
						for (
							var s = this.getAllSubBones(), c = 0;
							c < s.length;
							c++
						) {
							a = s[c];
							var a = cc.rectApplyAffineTransform(
								a.getVisibleSkinsRect(),
								a.getNodeToParentTransform(
									a.getRootSkeletonNode()
								)
							);
							(0 === a.x &&
								0 === a.y &&
								0 === a.width &&
								0 === a.height) ||
								(o
									? ((n = cc.rectGetMinX(a)),
									  (t = cc.rectGetMinY(a)),
									  (e = cc.rectGetMaxX(a)),
									  (i = cc.rectGetMaxY(a)),
									  (o = !1))
									: ((n = Math.min(cc.rectGetMinX(a), n)),
									  (t = Math.min(cc.rectGetMinY(a), t)),
									  (e = Math.max(cc.rectGetMaxX(a), e)),
									  (i = Math.max(cc.rectGetMaxY(a), i))));
						}
						return (
							(r.x = n),
							(r.y = t),
							(r.width = e - n),
							(r.height = i - t),
							cc.rectApplyAffineTransform(
								r,
								this.getNodeToParentTransform()
							)
						);
					},
					_visit: function (t) {
						if (this._visible) {
							var e = this._renderCmd;
							if (
								((t = t || e.getParentRenderCmd()),
								e._syncStatus(t),
								0 !== this._children.length)
							)
								for (r = 0; r < this._children.length; r++)
									this._children[r]._renderCmd.visit(e);
							this._checkSubBonesDirty();
							for (
								var i, n = this._subOrderedAllBones, r = 0;
								r < n.length;
								r++
							)
								n[r]._visitSkins();
							if (e._debug)
								for (r = 0; r < n.length; r++)
									(i = n[r]._renderCmd),
										cc.renderer.pushRenderCommand(
											i._drawNode._renderCmd
										);
							this._dirtyFlag = 0;
						}
					},
					_checkSubBonesDirty: function () {
						this._subBonesDirty &&
							(this._updateOrderedAllbones(),
							(this._subBonesDirty = !1)),
							this._subBonesOrderDirty &&
								(this._sortOrderedAllBones(),
								(this._subBonesOrderDirty = !1));
					},
					_updateOrderedAllbones: function () {
						this._subOrderedAllBones.length = 0;
						for (
							var t, e = [], i = this._childBones, n = 0;
							n < i.length;
							n++
						)
							(t = i[n]).isVisible() && e.push(t);
						for (; 0 < e.length; ) {
							var r = e.pop(),
								o = r._renderCmd;
							o._syncStatus(o.getParentRenderCmd()),
								this._subOrderedAllBones.push(r);
							for (
								var s, c = r.getChildBones(), n = 0;
								n < c.length;
								n++
							)
								(s = c[n]).isVisible() && e.push(s);
						}
					},
					_sortOrderedAllBones: function () {
						this._sortArray(this._subOrderedAllBones);
					},
					_updateVertices: function () {
						var t = this._squareVertices,
							e = this._renderCmd._anchorPointInPoints;
						if (
							this._rackLength != t[6].x - e.x ||
							this._rackWidth != t[3].y - e.y
						) {
							var i = 0.5 * this._rackLength,
								n = 0.5 * this._rackWidth,
								r = 0.25 * i,
								o = 0.25 * n;
							(t[5].y =
								t[2].y =
								t[1].y =
								t[6].y =
								t[0].x =
								t[4].x =
								t[7].x =
								t[3].x =
									0),
								(t[5].x = -i),
								(t[0].y = -n),
								(t[6].x = i),
								(t[3].y = n),
								(t[1].x = r),
								(t[7].y = o),
								(t[2].x = -r),
								(t[4].y = -o);
							for (var s = 0; s < t.length; s++)
								(t[s].x += e.x), (t[s].y += e.y);
						}
					},
					_updateAllDrawBones: function () {
						for (var t in ((this._subDrawBones = {}),
						this._subBonesMap)) {
							var e = this._subBonesMap[t];
							e.isVisible() &&
								e.isDebugDrawEnabled() &&
								this._subDrawBones.push(e);
						}
						this._sortArray(this._sortedAllBones),
							(this._subDrawBones = !1);
					},
				}));
		return (
			(e.create = function () {
				return new e();
			}),
			e
		);
	})()),
	(ccs._load = (function () {
		function t(t, e, i) {
			var n = cc.loader.getRes(t);
			if (!n) return cc.log('%s does not exist', t);
			var r,
				o = c(t).toLocaleLowerCase();
			return 'json' !== o && 'exportjson' !== o
				? cc.log('%s load error, must be json file', t)
				: (e
						? (r = s[e])
						: n.widgetTree
						? (r = s.ccui)
						: n.nodeTree || (n.Content && n.Content.Content)
						? (r = s.timeline)
						: n.gameobjects && (r = s.scene),
				  r
						? !(e = n.version || n.Version) && n.armature_data
							? (cc.warn('%s is armature. please use:', t),
							  cc.warn(
									'    ccs.armatureDataManager.addArmatureFileInfoAsync(%s);',
									t
							  ),
							  cc.warn(
									"    var armature = new ccs.Armature('name');"
							  ),
							  new cc.Node())
							: (e = a(r, e))
							? e.parse(t, n, i) || null
							: (cc.log("Can't find the parser : %s", t),
							  new cc.Node())
						: (cc.log("Can't find the parser : %s", t),
						  new cc.Node()));
		}
		var s = { ccui: {}, timeline: {}, action: {}, scene: {} };
		(t.registerParser = function (t, e, i) {
			if (!t || !e || !i) return cc.log('register parser error');
			s[t] || (s[t] = {}), (s[t][e] = i);
		}),
			(t.getParser = function (t, e) {
				return t && e ? (s[t] ? s[t][e] : void 0) : t ? s[t] : s;
			});
		var c = function (t) {
				t = t.match(e);
				return t && t[1] ? t[1] : null;
			},
			e = /\.([^\.]+)$/,
			i = /([^\.](\.\*)?)*$/,
			a = function (t, e) {
				return t[e] || ('*' === e ? null : a(t, e.replace(i, '*')));
			};
		return t;
	})()),
	(ccs._parser = cc.Class.extend({
		ctor: function () {
			this.parsers = {};
		},
		_dirnameReg: /\S*\//,
		_dirname: function (t) {
			t = t.match(this._dirnameReg);
			return t && t[0] ? t[0] : '';
		},
		getClass: function (t) {
			return t.classname;
		},
		getNodeJson: function (t) {
			return t.widgetTree;
		},
		parse: function (t, e, i) {
			(i = i || this._dirname(t)), this.pretreatment(e, i);
			var n = this.parseNode(this.getNodeJson(e), i, t);
			return n && this.deferred(e, i, n, t), n;
		},
		pretreatment: function (t, e, i) {},
		deferred: function (t, e, i, n) {},
		parseNode: function (t, e) {
			var i = this.parsers[this.getClass(t)],
				n = null;
			return (
				i
					? (n = i.call(this, t, e))
					: cc.log("Can't find the parser : %s", this.getClass(t)),
				n
			);
		},
		registerParser: function (t, e) {
			this.parsers[t] = e;
		},
	})),
	(ccs.load = function (t, e) {
		var i = { node: null, action: null };
		return (
			(i.node = ccs._load(t, null, e)),
			(i.action = ccs._load(t, 'action', e)),
			i.action &&
				-1 === i.action.tag &&
				i.node &&
				(i.action.tag = i.node.tag),
			i
		);
	}),
	(ccs.load.validate = {}),
	(ccs.load.preload = !0),
	(ccs.loadWithVisibleSize = function (t, e) {
		(t = ccs.load(t, e)), (e = cc.director.getVisibleSize());
		return (
			t.node &&
				e &&
				(t.node.setContentSize(e.width, e.height),
				ccui.helper.doLayout(t.node)),
			t
		);
	}),
	(ccs.actionTimelineCache = {
		createAction: function (t) {
			return ccs._load(t, 'action');
		},
	}),
	(ccs.csLoader = {
		createNode: function (t) {
			return ccs._load(t);
		},
	}),
	cc.loader.register(['json'], {
		load: function (t, a, e, l) {
			cc.loader.loadJson(t, function (t, e) {
				var i = cc.path;
				if (e && e.Content && e.Content.Content.UsedResources) {
					for (
						var n,
							r = e.Content.Content.UsedResources,
							o = i.dirname(a),
							s = [],
							c = 0;
						c < r.length;
						c++
					)
						(!ccs.load.preload && /\.(png|jpg$)/.test(r[c])) ||
							((n = i.join(o, r[c])),
							(n = i._normalize(n)),
							ccs.load.validate[n] ||
								((ccs.load.validate[n] = !0), s.push(n)));
					cc.loader.load(s, function () {
						l(t, e);
					});
				} else l(t, e);
			});
		},
	}),
	(function (t) {
		var e = new (ccs._parser.extend({
			getNodeJson: function (t) {
				return t.action;
			},
			parseNode: function (t, n, e) {
				if (!t) return null;
				var r = this,
					o = new ccs.ActionTimeline();
				return (
					o.setDuration(t.duration),
					o.setTimeSpeed(t.speed || 1),
					t.timelines.forEach(function (t) {
						var e,
							i = r.parsers[t.frameType];
						i
							? (e = i.call(r, t, n))
							: cc.log('parser does not exist : %s', t.frameType),
							e && o.addTimeline(e),
							'ColorFrame' === t.frameType &&
								o.addTimeline(
									r.parsers.AlphaFrame.call(r, t, n)
								);
					}),
					o
				);
			},
		}))();
		[
			{
				name: 'PositionFrame',
				handle: function (t) {
					var e = new ccs.PositionFrame(),
						i = t.x,
						t = t.y;
					return e.setPosition(cc.p(i, t)), e;
				},
			},
			{
				name: 'VisibleFrame',
				handle: function (t) {
					var e = new ccs.VisibleFrame(),
						t = t.value;
					return e.setVisible(t), e;
				},
			},
			{
				name: 'ScaleFrame',
				handle: function (t) {
					var e = new ccs.ScaleFrame(),
						i = t.x,
						t = t.y;
					return e.setScaleX(i), e.setScaleY(t), e;
				},
			},
			{
				name: 'RotationFrame',
				handle: function (t) {
					var e = new ccs.RotationFrame(),
						t = t.rotation;
					return e.setRotation(t), e;
				},
			},
			{
				name: 'SkewFrame',
				handle: function (t) {
					var e = new ccs.SkewFrame(),
						i = t.x,
						t = t.y;
					return e.setSkewX(i), e.setSkewY(t), e;
				},
			},
			{
				name: 'RotationSkewFrame',
				handle: function (t) {
					var e = new ccs.RotationSkewFrame(),
						i = t.x,
						t = t.y;
					return e.setSkewX(i), e.setSkewY(t), e;
				},
			},
			{
				name: 'AnchorFrame',
				handle: function (t) {
					var e = new ccs.AnchorPointFrame(),
						i = t.x,
						t = t.y;
					return e.setAnchorPoint(cc.p(i, t)), e;
				},
			},
			{
				name: 'InnerActionFrame',
				handle: function (t) {
					var e = new ccs.InnerActionFrame(),
						i = t.innerActionType,
						t = t.startFrame;
					return e.setInnerActionType(i), e.setStartFrameIndex(t), e;
				},
			},
			{
				name: 'ColorFrame',
				handle: function (t) {
					var e = new ccs.ColorFrame(),
						i = t.red,
						n = t.green,
						r = t.blue;
					e.setColor(cc.color(i, n, r));
					(r = new ccs.AlphaFrame()), (t = t.alpha);
					return r.setAlpha(t), e;
				},
			},
			{
				name: 'AlphaFrame',
				handle: function (t) {
					var e = new ccs.AlphaFrame(),
						t = t.alpha;
					return e.setAlpha(t), e;
				},
			},
			{
				name: 'TextureFrame',
				handle: function (t) {
					var e = new ccs.TextureFrame(),
						i = t.value;
					return (
						null != i &&
							((t = i),
							null == cc.spriteFrameCache.getSpriteFrame(t) &&
								(t = ccs.csLoader.getJsonPath() + i),
							e.setTextureName(t)),
						e
					);
				},
			},
			{
				name: 'EventFrame',
				handle: function (t) {
					var e = new ccs.EventFrame(),
						t = t.value;
					return null != t && e.setEvent(t), e;
				},
			},
			{
				name: 'ZOrderFrame',
				handle: function (t) {
					var e = new ccs.ZOrderFrame(),
						t = t.value;
					return e.setZOrder(t), e;
				},
			},
		].forEach(function (n) {
			e.registerParser(n.name, function (t, e) {
				var i = new ccs.Timeline();
				i.setActionTag(t.actionTag);
				t = t.frames;
				return (
					t &&
						t.length &&
						t.forEach(function (t) {
							var e = n.handle(t);
							e.setFrameIndex(t.frameIndex),
								e.setTween(t.tween),
								i.addFrame(e);
						}),
					i
				);
			});
		}),
			t.registerParser('action', '0.*', e),
			t.registerParser('action', '1.*', e);
	})(ccs._load),
	(function (t) {
		var e = new (ccs._parser.extend({
			getNodeJson: function (t) {
				return t.Content.Content.Animation;
			},
			parseNode: function (t, n, e) {
				if (!t) return null;
				var r = this,
					o = new ccs.ActionTimeline();
				return (
					o.setDuration(t.Duration),
					o.setTimeSpeed(t.Speed || 1),
					t.Timelines.forEach(function (t) {
						var e,
							i = r.parsers[t.Property];
						i
							? (e = i.call(r, t, n))
							: cc.log('parser does not exist : %s', t.Property),
							e && o.addTimeline(e);
					}),
					o
				);
			},
			deferred: function (t, e, i, n) {
				for (
					var r = t.Content.Content.AnimationList,
						o = r ? r.length : 0,
						s = 0;
					s < o;
					s++
				) {
					var c = r[s],
						a = { name: null, startIndex: null, endIndex: null };
					(a.name = c.Name),
						(a.startIndex = c.StartIndex),
						(a.endIndex = c.EndIndex),
						i.addAnimationInfo(a);
				}
			},
		}))();
		[
			{
				name: 'Position',
				handle: function (t) {
					var e = new ccs.PositionFrame(),
						i = t.X,
						t = t.Y;
					return e.setPosition(cc.p(i, t)), e;
				},
			},
			{
				name: 'VisibleForFrame',
				handle: function (t) {
					var e = new ccs.VisibleFrame(),
						t = t.Value;
					return e.setVisible(t), e;
				},
			},
			{
				name: 'Scale',
				handle: function (t) {
					var e = new ccs.ScaleFrame(),
						i = t.X,
						t = t.Y;
					return e.setScaleX(i), e.setScaleY(t), e;
				},
			},
			{
				name: 'Rotation',
				handle: function (t) {
					var e = new ccs.RotationFrame(),
						t = t.Rotation || t.Value || 0;
					return e.setRotation(t), e;
				},
			},
			{
				name: 'Skew',
				handle: function (t) {
					var e = new ccs.SkewFrame(),
						i = t.X,
						t = t.Y;
					return e.setSkewX(i), e.setSkewY(t), e;
				},
			},
			{
				name: 'RotationSkew',
				handle: function (t) {
					var e = new ccs.RotationSkewFrame(),
						i = t.X,
						t = t.Y;
					return e.setSkewX(i), e.setSkewY(t), e;
				},
			},
			{
				name: 'Anchor',
				handle: function (t) {
					var e = new ccs.AnchorPointFrame(),
						i = t.X,
						t = t.Y;
					return e.setAnchorPoint(cc.p(i, t)), e;
				},
			},
			{
				name: 'AnchorPoint',
				handle: function (t) {
					var e = new ccs.AnchorPointFrame(),
						i = t.X,
						t = t.Y;
					return e.setAnchorPoint(cc.p(i, t)), e;
				},
			},
			{
				name: 'InnerAction',
				handle: function (t) {
					var e = new ccs.InnerActionFrame(),
						i = t.InnerActionType,
						t = t.StartFrame;
					return e.setInnerActionType(i), e.setStartFrameIndex(t), e;
				},
			},
			{
				name: 'CColor',
				handle: function (t) {
					var e = new ccs.ColorFrame(),
						t = t.Color;
					return (
						((t = t || {}).R = void 0 === t.R ? 255 : t.R),
						(t.G = void 0 === t.G ? 255 : t.G),
						(t.B = void 0 === t.B ? 255 : t.B),
						e.setColor(cc.color(t.R, t.G, t.B)),
						e
					);
				},
			},
			{
				name: 'Alpha',
				handle: function (t) {
					var e = new ccs.AlphaFrame(),
						t = t.Value;
					return e.setAlpha(t), e;
				},
			},
			{
				name: 'FileData',
				handle: function (t, e) {
					var i,
						n = new ccs.TextureFrame(),
						r = t.TextureFile;
					return (
						null != r &&
							((i = r.Plist),
							(t = r.Path),
							!(r = cc.spriteFrameCache.getSpriteFrame(t)) &&
								i &&
								(cc.loader.getRes(e + i)
									? (cc.spriteFrameCache.addSpriteFrames(
											e + i
									  ),
									  (r =
											cc.spriteFrameCache.getSpriteFrame(
												t
											)))
									: cc.log('%s need to be preloaded', e + i)),
							null == r && (t = e + t),
							n.setTextureName(t)),
						n
					);
				},
			},
			{
				name: 'FrameEvent',
				handle: function (t) {
					var e = new ccs.EventFrame(),
						t = t.Value;
					return null != t && e.setEvent(t), e;
				},
			},
			{
				name: 'ZOrder',
				handle: function (t) {
					var e = new ccs.ZOrderFrame(),
						t = t.Value;
					return e.setZOrder(t), e;
				},
			},
			{
				name: 'ActionValue',
				handle: function (t) {
					var e = new ccs.InnerActionFrame(),
						i = t.InnerActionType,
						n = t.CurrentAniamtionName,
						r = t.SingleFrameIndex,
						t = t.FrameIndex;
					return (
						void 0 !== t && e.setFrameIndex(t),
						e.setInnerActionType(ccs.InnerActionType[i]),
						e.setSingleFrameIndex(r),
						e.setEnterWithName(!0),
						n && e.setAnimationName(n),
						e
					);
				},
			},
			{
				name: 'BlendFunc',
				handle: function (t) {
					var e = new ccs.BlendFuncFrame(),
						t = t.BlendFunc;
					return (
						t &&
							void 0 !== t.Src &&
							void 0 !== t.Dst &&
							e.setBlendFunc(new cc.BlendFunc(t.Src, t.Dst)),
						e
					);
				},
			},
		].forEach(function (o) {
			e.registerParser(o.name, function (t, n) {
				var r = new ccs.Timeline();
				r.setActionTag(t.ActionTag);
				t = t.Frames;
				return (
					t &&
						t.length &&
						t.forEach(function (t) {
							var e = o.handle(t, n);
							e.setFrameIndex(t.FrameIndex);
							var i = null == t.Tween || t.Tween;
							e.setTween(i);
							t = t.EasingData;
							t &&
								(function (t, e) {
									var i = e.Type;
									t.setTweenType(i);
									var e = e.Points,
										n = [];
									e &&
										(e.forEach(function (t) {
											n.push(t.X), n.push(t.Y);
										}),
										t.setEasingParams(n));
								})(e, t),
								r.addFrame(e);
						}),
					r
				);
			});
		}),
			t.registerParser('action', '2.*', e),
			t.registerParser('action', '*', e);
	})(ccs._load),
	(function (t) {
		var e = new (ccs._parser.extend({
			getNodeJson: function (t) {
				return t;
			},
			parseNode: function (t, e) {
				var i = this.parsers[this.getClass(t)],
					n = null;
				return (
					i
						? (n = i.call(this, t, e))
						: cc.log(
								"Can't find the parser : %s",
								this.getClass(t)
						  ),
					n
				);
			},
			deferred: function (t, e, i, n) {
				ccs.triggerManager.parse(t.Triggers || []),
					ccs.sceneReader && (ccs.sceneReader._node = i);
			},
			setPropertyFromJsonDict: function (t, e) {
				var i = cc.isUndefined(e.x) ? 0 : e.x,
					n = cc.isUndefined(e.y) ? 0 : e.y;
				t.setPosition(i, n);
				i = Boolean(cc.isUndefined(e.visible) ? 1 : e.visible);
				t.setVisible(i);
				n = cc.isUndefined(e.objecttag) ? -1 : e.objecttag;
				t.setTag(n);
				i = cc.isUndefined(e.zorder) ? 0 : e.zorder;
				t.setLocalZOrder(i);
				(n = cc.isUndefined(e.scalex) ? 1 : e.scalex),
					(i = cc.isUndefined(e.scaley) ? 1 : e.scaley);
				t.setScaleX(n), t.setScaleY(i);
				i = cc.isUndefined(e.rotation) ? 0 : e.rotation;
				t.setRotation(i);
				e = e.name || '';
				t.setName(e);
			},
		}))();
		e.parseChild = function (t, e, i) {
			for (var n = 0; n < e.length; n++) {
				var r,
					o = e[n];
				o && (r = this.parseNode(o, i)), r && t.addChild(r);
			}
		};
		var o = {
				CCSprite: function (t, e, i) {
					var n = new cc.Sprite();
					c(e.fileData, i, function (t, e) {
						0 === e
							? n.setTexture(t)
							: 1 === e &&
							  ((t = cc.spriteFrameCache.getSpriteFrame(t)),
							  n.setSpriteFrame(t));
					});
					i = new ccs.ComRender(n, 'CCSprite');
					return t.addComponent(i), i;
				},
				CCTMXTiledMap: function (t, e, i) {
					var n = null;
					c(e.fileData, i, function (t, e) {
						0 === e && (n = new cc.TMXTiledMap(t));
					});
					i = new ccs.ComRender(n, 'CCTMXTiledMap');
					return t.addComponent(i), i;
				},
				CCParticleSystemQuad: function (t, e, i) {
					var n = null;
					c(e.fileData, i, function (t, e) {
						0 === e
							? (n = new cc.ParticleSystem(t))
							: cc.log(
									'unknown resourcetype on CCParticleSystemQuad!'
							  ),
							n.setPosition(0, 0);
					});
					i = new ccs.ComRender(n, 'CCParticleSystemQuad');
					return t.addComponent(i), i;
				},
				CCArmature: function (t, e, i) {
					var n = null;
					if (
						(c(e.fileData, i, function (t, e) {
							0 === e &&
								((e = cc.loader.getRes(t)) ||
									cc.log(
										'Please load the resource [%s] first!',
										t
									),
								(e = e.armature_data[0].name),
								ccs.armatureDataManager.addArmatureFileInfo(t),
								(n = new ccs.Armature(e)));
						}),
						n)
					) {
						i = new ccs.ComRender(n, 'CCArmature');
						t.addComponent(i);
						e = e.selectedactionname;
						return (
							e && n.getAnimation() && n.getAnimation().play(e), i
						);
					}
				},
				CCComAudio: function (i, n, t) {
					var r = null;
					c(n.fileData, t, function (t, e) {
						0 === e &&
							((r = new ccs.ComAudio()).preloadEffect(t),
							(t = n.name) && r.setName(t),
							i.addComponent(r));
					});
				},
				CCComAttribute: function (i, t, e) {
					var n = null;
					return (
						c(t.fileData, e, function (t, e) {
							0 === e
								? ((n = new ccs.ComAttribute()),
								  '' !== t && n.parse(t),
								  i.addComponent(n))
								: cc.log(
										'unknown resourcetype on CCComAttribute!'
								  );
						}),
						n
					);
				},
				CCBackgroundAudio: function (n, r, t) {
					var o = null;
					c(r.fileData, t, function (t, e) {
						var i;
						0 === e &&
							((o = new ccs.ComAudio()).preloadBackgroundMusic(t),
							o.setFile(t),
							(i = Boolean(r.loop || 0)),
							o.setLoop(i),
							(e = r.name) && o.setName(e),
							n.addComponent(o),
							o.playBackgroundMusic(t, i));
					});
				},
				GUIComponent: function (t, e, i) {
					var n = null;
					c(e.fileData, i, function (t, e) {
						n = ccs._load(t, 'ccui');
					});
					i = new ccs.ComRender(n, 'GUIComponent');
					return t.addComponent(i), i;
				},
				CCScene: function () {},
			},
			s = {},
			c = function (t, e, i) {
				var n, r;
				null != t &&
					((n = t.path),
					(r = t.resourceType),
					(t = t.plist),
					n &&
						(t &&
							(cc.loader.getRes(e + t)
								? ((s[e + t] = !0),
								  cc.spriteFrameCache.addSpriteFrames(e + t))
								: s[e + t] ||
								  cc.log('%s need to be preloaded', e + t)),
						i(0 !== r ? n : e + n, r)));
			};
		(e.parseComponents = function (n, t, r) {
			n &&
				t &&
				t.forEach(function (t) {
					var e = o[t.classname],
						i = null;
					e
						? (i = e(n, t, r))
						: cc.log(
								"Can't find the component parser : %s",
								t.classname
						  );
					t = t.name;
					i && t && i.setName(t);
				});
		}),
			e.registerParser('CCNode', function (t, e) {
				var i = new cc.Node();
				this.setPropertyFromJsonDict(i, t),
					this.parseChild.call(this, i, t.gameobjects, e),
					this.parseComponents(i, t.components, e);
				t = t.CanvasSize;
				return t && i.setContentSize(cc.size(t._width, t._height)), i;
			}),
			t.registerParser('scene', '*', e);
	})(ccs._load),
	(function (t, e) {
		var o = {},
			i = new (e.extend({
				getNodeJson: function (t) {
					return t.nodeTree;
				},
				addSpriteFrame: function (t, e, i) {
					if (t && e && t.length === e.length)
						for (var n = 0; n < t.length; n++) {
							var r = i + t[n];
							cc.loader.getRes(r) || o[r]
								? (o[r] = !0)
								: cc.log('%s need to be preloaded', r),
								cc.spriteFrameCache.addSpriteFrames(
									r,
									i + e[n]
								);
						}
				},
				pretreatment: function (t, e, i) {
					this.addSpriteFrame(t.textures, t.texturesPng, e);
				},
			}))();
		(i.generalAttributes = function (t, e) {
			var i = null != e.width ? e.width : 0,
				n = null != e.height ? e.height : 0,
				r = null != e.x ? e.x : 0,
				o = null != e.y ? e.y : 0,
				s = null != e.scaleX ? e.scaleX : 1,
				c = null != e.scaleY ? e.scaleY : 1,
				a = null != e.rotation ? e.rotation : 0,
				l = null != e.rotationSkewX ? e.rotationSkewX : 0,
				h = null != e.rotationSkewY ? e.rotationSkewY : 0,
				u = null != e.skewX ? e.skewX : 0,
				_ = null != e.skewY ? e.skewY : 0,
				d = null != e.anchorPointX ? e.anchorPointX : 0.5,
				p = null != e.anchorPointY ? e.anchorPointY : 0.5,
				f = null != e.opacity ? e.opacity : 255,
				m = null != e.colorR ? e.colorR : 255,
				g = null != e.colorG ? e.colorG : 255,
				y = null != e.colorB ? e.colorB : 255,
				T = null != e.colorR ? e.colorR : 0,
				S = null != e.tag ? e.tag : 0,
				C = null != e.actionTag ? e.actionTag : 0,
				e = null == e.visible || e.visible;
			(0 == r && 0 == o) || t.setPosition(cc.p(r, o)),
				1 != s && t.setScaleX(s),
				1 != c && t.setScaleY(c),
				0 != a && t.setRotation(a),
				0 != l && t.setRotationX(l),
				0 != h && t.setRotationY(h),
				0 != u && t.setSkewX(u),
				0 != _ && t.setSkewY(_),
				(0.5 == d && 0.5 == p) || t.setAnchorPoint(cc.p(d, p)),
				(0 == i && 0 == n) || t.setContentSize(cc.size(i, n)),
				0 != T && t.setLocalZOrder(T),
				1 != e && t.setVisible(e),
				255 != f && t.setOpacity(f),
				(255 == m && 255 == g && 255 == y) ||
					t.setColor(cc.color(m, g, y)),
				t.setTag(S),
				t.setUserObject(new ccs.ActionTimelineData(C));
		}),
			(i.parseComponent = function (t, e) {
				if (e)
					for (var i = 0; i < e.length; ++i) {
						var n = e[i],
							n = this.loadComponent(n);
						n && t.addComponent(n);
					}
			}),
			(i.parseChild = function (t, e, i, n) {
				for (var r = i.children, o = 0; o < r.length; o++) {
					var s,
						c,
						a = this.parseNode(r[o], n);
					a &&
						(e instanceof ccui.PageView
							? a instanceof ccui.Layout && e.addPage(a)
							: e instanceof ccui.ListView
							? a instanceof ccui.Widget &&
							  e.pushBackCustomItem(a)
							: (!(e instanceof ccui.Layout) &&
									a instanceof ccui.Widget &&
									(a.getPositionType() ===
										ccui.Widget.POSITION_PERCENT &&
										((s = a.getPositionPercent()),
										(c = e.getAnchorPoint()),
										a.setPositionPercent(
											cc.p(s.x + c.x, s.y + c.y)
										)),
									(c = e.getAnchorPointInPoints()),
									a.setPosition(
										cc.p(
											a.getPositionX() + c.x,
											a.getPositionY() + c.y
										)
									)),
							  e.addChild(a)));
				}
			}),
			(i.initNode = function (t) {
				var e = new cc.Node();
				return this.generalAttributes(e, t), e;
			}),
			(i.initSubGraph = function (t) {
				var e = t.fileName,
					e = e && '' !== e ? this.createNode(e) : new ccs.Node();
				return this.generalAttributes(e, t), e;
			}),
			(i.initSprite = function (t, e) {
				var i,
					n = t.fileName;
				null != n
					? (i = (i = cc.spriteFrameCache.getSpriteFrame(n))
							? ccs.Sprite.createWithSpriteFrame(i)
							: ((n = e + n), new ccs.Sprite(n))) ||
					  ((i = new cc.Sprite()),
					  cc.log(
							'filePath is empty. Create a sprite with no texture'
					  ))
					: (i = new ccs.Sprite()),
					this.generalAttributes(i, t);
				(n = t.flipX), (t = t.flipY);
				return (
					0 != n && i.setFlippedX(n), 0 != t && i.setFlippedY(t), i
				);
			}),
			(i.initParticle = function (t, e) {
				var i = t.plistFile,
					n = t.tmxFile,
					i = new cc.ParticleSystemQuad(i);
				return i.setTotalParticles(n), this.generalAttributes(i, t), i;
			}),
			(i.initTMXTiledMap = function (t, e) {
				var i = t.tmxFile,
					n = t.tmxString,
					r = t.resourcePath,
					t = null;
				return (
					i && '' !== i
						? (t = new cc.TMXTiledMap(i))
						: n &&
						  '' !== n &&
						  r &&
						  '' !== r &&
						  (t = new cc.TMXTiledMap(n, r)),
					t
				);
			});
		var s = t.getParser('ccui')['*'];
		(i.initWidget = function (t, e) {
			var i = t.classname,
				n = s.parsers[i];
			if (!n) return cc.log('%s parser is not found', i);
			var r,
				o = n.call(s, t, e);
			return (
				o &&
					((r = t.rotationSkewX),
					(i = t.rotationSkewY),
					(n = t.skewX),
					(e = t.skewY),
					0 != r && o.setRotationX(r),
					0 != i && o.setRotationY(i),
					0 != n && o.setSkewX(n),
					0 != e && o.setSkewY(e),
					(t = t.actionTag),
					o.setUserObject(new ccs.ActionTimelineData(t))),
				o
			);
		}),
			[
				{ name: 'Node', handle: i.initNode },
				{ name: 'SubGraph', handle: i.initSubGraph },
				{ name: 'Sprite', handle: i.initSprite },
				{ name: 'Particle', handle: i.initParticle },
				{ name: 'TMXTiledMap', handle: i.initTMXTiledMap },
				{ name: 'Widget', handle: i.initWidget },
				{ name: 'Panel', handle: i.initWidget },
				{ name: 'Button', handle: i.initWidget },
				{ name: 'CheckBox', handle: i.initWidget },
				{ name: 'ImageView', handle: i.initWidget },
				{ name: 'LabelAtlas', handle: i.initWidget },
				{ name: 'LabelBMFont', handle: i.initWidget },
				{ name: 'Label', handle: i.initWidget },
				{ name: 'ListView', handle: i.initWidget },
				{ name: 'LoadingBar', handle: i.initWidget },
				{ name: 'PageView', handle: i.initWidget },
				{ name: 'ScrollView', handle: i.initWidget },
				{ name: 'Slider', handle: i.initWidget },
				{ name: 'TextField', handle: i.initWidget },
			].forEach(function (r) {
				i.registerParser(r.name, function (t, e, i) {
					var n = r.handle.call(this, t.options);
					return (
						this.parseComponent(n, t.components),
						this.parseChild(e, n, t, i),
						n
					);
				});
			}),
			t.registerParser('timeline', '0.*', i),
			t.registerParser('timeline', '1.*', i);
	})(ccs._load, ccs._parser),
	(function (t) {
		function a(t, e) {
			return void 0 === t ? e : t;
		}
		var r = new (ccs._parser.extend({
			parse: function (t, e, i) {
				var n = void 0 !== i ? i : this._dirname(t);
				this.pretreatment(e, n, t);
				i = this.parseNode(this.getNodeJson(e), n);
				return this.deferred(e, n, i, t), i;
			},
			getNodeJson: function (t) {
				t = t.Content;
				return t.ObjectData || t.Content.ObjectData;
			},
			getClass: function (t) {
				return t.ctype;
			},
		}))();
		function c(t, e, i, n) {
			2 === t.getBackGroundColorType()
				? ((i = i || {}),
				  (n = n || {}),
				  t.setBackGroundColor(_(i), _(n)))
				: ((e = e || {}), t.setBackGroundColor(_(e)));
		}
		function l(t, e) {
			var i = e.ScaleX || 0,
				e = e.ScaleY || 0;
			t.setBackGroundColorVector(cc.p(i, e));
		}
		(r.generalAttributes = function (t, e) {
			null != e.Name && t.setName(e.Name);
			var i = e.Position;
			null == i ||
				(null == i.X && null == i.Y) ||
				t.setPosition(cc.p(i.X || 0, i.Y || 0));
			var n = e.Scale;
			null != n &&
				(null != n.ScaleX && t.setScaleX(n.ScaleX),
				null != n.ScaleY && t.setScaleY(n.ScaleY));
			var r = e.RotationSkewX;
			null != r && t.setRotationX(r);
			i = e.RotationSkewY;
			null != e.RotationSkewY && t.setRotationY(i);
			n = e.AnchorPoint;
			null != n &&
				(null == n.ScaleX && (n.ScaleX = 0),
				null == n.ScaleY && (n.ScaleY = 0),
				(0.5 == n.ScaleX && 0.5 == n.ScaleY) ||
					t.setAnchorPoint(cc.p(n.ScaleX, n.ScaleY))),
				null != e.ZOrder && t.setLocalZOrder(e.ZOrder);
			r = a(e.VisibleForFrame, !0);
			t.setVisible(r);
			i = e.Size;
			i && d(t, i),
				null != e.Alpha && t.setOpacity(e.Alpha),
				t.setTag(e.Tag || 0);
			(n = e.ActionTag || 0),
				(r = new ccs.ComExtensionData()),
				(i = e.UserData);
			void 0 !== i && r.setCustomProperty(i),
				r.setActionTag(n),
				t.getComponent('ComExtensionData') &&
					t.removeComponent('ComExtensionData'),
				t.addComponent(r),
				t.setCascadeColorEnabled(!0),
				t.setCascadeOpacityEnabled(!0),
				h(t, e);
		}),
			(r.parseChild = function (t, e, i) {
				if (t && e)
					for (var n = 0; n < e.length; n++) {
						var r,
							o,
							s = this.parseNode(e[n], i);
						s &&
							(t instanceof ccui.PageView
								? s instanceof ccui.Layout && t.addPage(s)
								: t instanceof ccui.ListView
								? s instanceof ccui.Widget &&
								  t.pushBackCustomItem(s)
								: (!(t instanceof ccui.Layout) &&
										s instanceof ccui.Widget &&
										s.getPositionType() ===
											ccui.Widget.POSITION_PERCENT &&
										((r = s.getPositionPercent()),
										(o = t.getAnchorPoint()),
										s.setPositionPercent(
											cc.p(r.x + o.x, r.y + o.y)
										)),
								  t.addChild(s)));
					}
			}),
			(r.initSingleNode = function (t) {
				var e = new cc.Node();
				this.generalAttributes(e, t);
				t = t.CColor;
				return null != t && e.setColor(_(t)), e;
			}),
			(r.initSprite = function (t, e) {
				var i = new cc.Sprite();
				u(t.FileData, e, function (t, e) {
					0 === e
						? i.setTexture(t)
						: 1 !== e ||
						  ((t = cc.spriteFrameCache.getSpriteFrame(t)) &&
								i.setSpriteFrame(t));
				});
				var n = t.BlendFunc;
				t.BlendFunc &&
					((e = cc.BlendFunc.ALPHA_PREMULTIPLIED),
					void 0 !== n.Src && (e.src = n.Src),
					void 0 !== n.Dst && (e.dst = n.Dst),
					i.setBlendFunc(e)),
					t.FlipX && i.setFlippedX(!0),
					t.FlipY && i.setFlippedY(!0),
					this.generalAttributes(i, t);
				t = t.CColor;
				return null != t && i.setColor(_(t)), i;
			}),
			(r.initParticle = function (n, t) {
				var r,
					o = this;
				return (
					u(n.FileData, t, function (t, e) {
						cc.loader.getRes(t) ||
							cc.log('%s need to be preloaded', t),
							(r = new cc.ParticleSystem(t)),
							o.generalAttributes(r, n),
							r.setPositionType(cc.ParticleSystem.TYPE_GROUPED),
							cc.sys.isNative ||
								r.setDrawMode(cc.ParticleSystem.TEXTURE_MODE);
						var i = n.BlendFunc;
						n.BlendFunc &&
							((t = cc.BlendFunc.ALPHA_PREMULTIPLIED),
							void 0 !== i.Src && (t.src = i.Src),
							void 0 !== i.Dst && (t.dst = i.Dst),
							r.setBlendFunc(t));
					}),
					r
				);
			}),
			(r.widgetAttributes = function (t, e, i) {
				t.setCascadeColorEnabled(!0),
					t.setCascadeOpacityEnabled(!0),
					t.setUnifySizeEnabled(!1),
					t.ignoreContentAdaptWithSize(!1),
					i || d(t, e.Size);
				var n = e.Name;
				n && t.setName(n);
				var r = e.ActionTag || 0;
				t.setActionTag(r);
				(i = new ccs.ComExtensionData()), (n = e.UserData);
				void 0 !== n && i.setCustomProperty(n),
					i.setActionTag(r),
					t.getComponent('ComExtensionData') &&
						t.removeComponent('ComExtensionData'),
					t.addComponent(i);
				r = e.RotationSkewX;
				r && t.setRotationX(r);
				i = e.RotationSkewY;
				i && t.setRotationY(i),
					e.FlipX && t.setFlippedX(!0),
					e.FlipY && t.setFlippedY(!0);
				r = e.zOrder;
				null != r && t.setLocalZOrder(r);
				i = a(e.VisibleForFrame, !0);
				t.setVisible(i);
				r = e.Alpha;
				null != r && t.setOpacity(r), t.setTag(e.Tag || 0);
				i = e.TouchEnable || !1;
				t.setTouchEnabled(i);
				r = e.CallBackType;
				null != r && t.setCallbackType(r);
				i = e.CallBackName;
				i && t.setCallbackName(i);
				r = e.Position;
				null != r && t.setPosition(r.X || 0, r.Y || 0);
				i = e.Scale;
				null != i &&
					((r = a(i.ScaleX, 1)),
					(o = a(i.ScaleY, 1)),
					t.setScaleX(r),
					t.setScaleY(o));
				var o = e.AnchorPoint;
				null != o && t.setAnchorPoint(o.ScaleX || 0, o.ScaleY || 0);
				o = e.CColor;
				null != o && t.setColor(_(o)), h(t, e), s(t, e);
			});
		var s = function (e, t) {
				var i = t.CallBackType,
					n = t.CallBackName,
					t = function (t) {
						'function' == typeof e[n] && e[n](t);
					};
				'Click' === i
					? e.addClickEventListener(t)
					: 'Touch' === i
					? e.addTouchEventListener(t)
					: 'Event' === i && e.addCCSEventListener(t);
			},
			h = function (t, e) {
				var i,
					n,
					r,
					o,
					s,
					c,
					a,
					l,
					h,
					u,
					_,
					d,
					p,
					f,
					m = ccui.LayoutComponent.bindLayoutComponent(t);
				m &&
					((i =
						e.PositionPercentXEnable ||
						e.PositionPercentXEnabled ||
						!1),
					(n =
						e.PositionPercentYEnable ||
						e.PositionPercentYEnabled ||
						!1),
					(o = r = 0),
					null != (d = e.PrePosition) &&
						((r = d.X || 0), (o = d.Y || 0)),
					(s = e.PercentWidthEnable || e.PercentWidthEnabled || !1),
					(c = e.PercentHeightEnable || e.PercentHeightEnabled || !1),
					(l = a = 0),
					(p = e.PreSize),
					null != d && ((a = p.X || 0), (l = p.Y || 0)),
					(h = e.StretchWidthEnable || !1),
					(f = e.StretchHeightEnable || !1),
					(u = e.HorizontalEdge),
					(_ = e.VerticalEdge),
					(t = e.LeftMargin || 0),
					(d = e.RightMargin || 0),
					(p = e.TopMargin || 0),
					(e = e.BottomMargin || 0),
					m.setPositionPercentXEnabled(i),
					m.setPositionPercentYEnabled(n),
					m.setPositionPercentX(r),
					m.setPositionPercentY(o),
					m.setPercentWidthEnabled(s),
					m.setPercentHeightEnabled(c),
					m.setPercentWidth(a),
					m.setPercentHeight(l),
					m.setPercentWidthEnabled(s || c),
					m.setStretchWidthEnabled(h),
					m.setStretchHeightEnabled(f),
					(f = ccui.LayoutComponent.horizontalEdge.NONE),
					'LeftEdge' === u
						? (f = ccui.LayoutComponent.horizontalEdge.LEFT)
						: 'RightEdge' === u
						? (f = ccui.LayoutComponent.horizontalEdge.RIGHT)
						: 'BothEdge' === u &&
						  (f = ccui.LayoutComponent.horizontalEdge.CENTER),
					m.setHorizontalEdge(f),
					(f = ccui.LayoutComponent.verticalEdge.NONE),
					'TopEdge' === _
						? (f = ccui.LayoutComponent.verticalEdge.TOP)
						: 'BottomEdge' === _
						? (f = ccui.LayoutComponent.verticalEdge.BOTTOM)
						: 'BothEdge' === _ &&
						  (f = ccui.LayoutComponent.verticalEdge.CENTER),
					m.setVerticalEdge(f),
					m.setTopMargin(p),
					m.setBottomMargin(e),
					m.setLeftMargin(t),
					m.setRightMargin(d),
					m.setVerticalEdge(f),
					m.setTopMargin(p),
					m.setBottomMargin(e),
					m.setLeftMargin(t),
					m.setRightMargin(d));
			};
		(r.initPanel = function (t, e) {
			var i = new ccui.Layout();
			this.widgetAttributes(i, t);
			var n = t.ClipAble || !1;
			null != n && i.setClippingEnabled(n);
			var r = a(t.ComboBoxIndex, 0);
			i.setBackGroundColorType(r);
			var o = a(t.BackColorAlpha, 255);
			null != o && i.setBackGroundColorOpacity(o);
			n = t.Scale9Enable;
			null != n && i.setBackGroundImageScale9Enabled(n);
			r = a(t.Alpha, 255);
			return (
				i.setOpacity(r),
				u(t.FileData, e, function (t, e) {
					i.setBackGroundImage(t, e);
				}),
				n
					? ((o = t.Scale9OriginX || 0),
					  (r = t.Scale9OriginY || 0),
					  (e = t.Scale9Width || 0),
					  (n = t.Scale9Height || 0),
					  i.setBackGroundImageCapInsets(cc.rect(o, r, e, n)),
					  d(i, t.Size))
					: i.isIgnoreContentAdaptWithSize() || d(i, t.Size),
				c(i, t.SingleColor, t.FirstColor, t.EndColor),
				l(i, t.ColorVector),
				i
			);
		}),
			(r.initText = function (t, e) {
				var i = new ccui.Text(),
					n = t.TouchScaleChangeAble;
				null != n && i.setTouchScaleChangeEnabled(n);
				var r = t.LabelText;
				null != r && i.setString(r);
				var o = t.FontSize;
				null != o && i.setFontSize(o);
				n = t.FontName;
				null != n && i.setFontName(n);
				(r = t.AreaWidth), (o = t.areaHeight);
				r && o && i.setTextAreaSize(cc.size(r, o));
				var s = t.HorizontalAlignmentType || 'HT_Left';
				switch (s) {
					case 'HT_Right':
						s = 2;
						break;
					case 'HT_Center':
						s = 1;
						break;
					case 'HT_Left':
					default:
						s = 0;
				}
				i.setTextHorizontalAlignment(s);
				var c = t.VerticalAlignmentType || 'VT_Top';
				switch (c) {
					case 'VT_Bottom':
						c = 2;
						break;
					case 'VT_Center':
						c = 1;
						break;
					case 'VT_Top':
					default:
						c = 0;
				}
				i.setTextVerticalAlignment(c);
				o = t.FontResource;
				null == o ||
					(null != (o = o.Path) &&
						((n = cc.sys.isNative
							? cc.path.join(cc.loader.resPath, e, o)
							: (n = o.match(/([^\/]+)\.(\S+)/))
							? n[1]
							: ''),
						i.setFontName(n))),
					t.OutlineEnabled &&
						t.OutlineColor &&
						i.enableOutline &&
						i.enableOutline(_(t.OutlineColor), a(t.OutlineSize, 1)),
					t.ShadowEnabled &&
						t.ShadowColor &&
						i.enableShadow &&
						i.enableShadow(
							_(t.ShadowColor),
							cc.size(
								a(t.ShadowOffsetX, 2),
								a(t.ShadowOffsetY, -2)
							),
							t.ShadowBlurRadius || 0
						);
				n = t.IsCustomSize;
				null != n && i.ignoreContentAdaptWithSize(!n),
					i.setUnifySizeEnabled(!1);
				n = t.CColor;
				return (
					(t.CColor = null),
					i.setTextColor(_(n)),
					this.widgetAttributes(
						i,
						t,
						i.isIgnoreContentAdaptWithSize()
					),
					(t.CColor = n),
					i
				);
			}),
			(r.initButton = function (t, e) {
				var i = new ccui.Button();
				u(t.NormalFileData, e, function (t, e) {
					i.loadTextureNormal(t, e);
				}),
					u(t.PressedFileData, e, function (t, e) {
						i.loadTexturePressed(t, e);
					}),
					u(t.DisabledFileData, e, function (t, e) {
						i.loadTextureDisabled(t, e);
					});
				var n = a(t.Scale9Enable, !1);
				n && i.setScale9Enabled(n);
				var r = t.ButtonText;
				null != r && i.setTitleText(r);
				var o = t.FontSize;
				null != o && i.setTitleFontSize(o);
				r = t.FontName;
				null != r && i.setTitleFontName(r);
				o = t.TextColor;
				null != o && i.setTitleColor(_(o));
				o = a(t.DisplayState, !0);
				i.setBright(o), i.setEnabled(o);
				o = t.FontResource;
				null == o ||
					(null != (o = o.Path) &&
						((r = cc.sys.isNative
							? cc.path.join(cc.loader.resPath, e, o)
							: (r = o.match(/([^\/]+)\.(\S+)/))
							? r[1]
							: ''),
						i.setTitleFontName(r)));
				r = i.getTitleRenderer();
				return (
					r &&
						t.ShadowEnabled &&
						t.ShadowColor &&
						r.enableShadow &&
						r.enableShadow(
							_(t.ShadowColor),
							cc.size(
								a(t.ShadowOffsetX, 2),
								a(t.ShadowOffsetY, -2)
							),
							t.ShadowBlurRadius || 0
						),
					r &&
						t.OutlineEnabled &&
						t.OutlineColor &&
						r.enableStroke &&
						r.enableStroke(_(t.OutlineColor), a(t.OutlineSize, 1)),
					this.widgetAttributes(i, t),
					n &&
						(i.setUnifySizeEnabled(!1),
						i.ignoreContentAdaptWithSize(!1),
						(n = cc.rect(
							t.Scale9OriginX || 0,
							t.Scale9OriginY || 0,
							t.Scale9Width || 0,
							t.Scale9Height || 0
						)),
						i.setCapInsets(n)),
					d(i, t.Size),
					i
				);
			}),
			(r.initCheckBox = function (t, e) {
				var n = new ccui.CheckBox();
				this.widgetAttributes(n, t),
					[
						{
							name: 'NormalBackFileData',
							handle: n.loadTextureBackGround,
						},
						{
							name: 'PressedBackFileData',
							handle: n.loadTextureBackGroundSelected,
						},
						{
							name: 'NodeNormalFileData',
							handle: n.loadTextureFrontCross,
						},
						{
							name: 'DisableBackFileData',
							handle: n.loadTextureBackGroundDisabled,
						},
						{
							name: 'NodeDisableFileData',
							handle: n.loadTextureFrontCrossDisabled,
						},
					].forEach(function (i) {
						u(t[i.name], e, function (t, e) {
							i.handle.call(n, t, e);
						});
					});
				var i = a(t.CheckedState, !1);
				n.setSelected(i);
				i = a(t.DisplayState, !0);
				return n.setBright(i), n.setEnabled(i), n;
			}),
			(r.initScrollView = function (t, e) {
				var i = new ccui.ScrollView();
				this.widgetAttributes(i, t),
					u(t.FileData, e, function (t, e) {
						i.setBackGroundImage(t, e);
					});
				var n = t.ClipAble || !1;
				i.setClippingEnabled(n);
				var r = a(t.ComboBoxIndex, 0);
				i.setBackGroundColorType(r);
				e = t.BackColorAlpha;
				null != e && i.setBackGroundColorOpacity(e),
					t.Scale9Enable
						? (i.setBackGroundImageScale9Enabled(!0),
						  (n = t.Scale9OriginX || 0),
						  (r = t.Scale9OriginY || 0),
						  (e = t.Scale9Width || 0),
						  (o = t.Scale9Height || 0),
						  i.setBackGroundImageCapInsets(cc.rect(n, r, e, o)),
						  d(i, t.Size))
						: i.isIgnoreContentAdaptWithSize() || d(i, t.Size),
					c(i, t.SingleColor, t.FirstColor, t.EndColor),
					l(i, t.ColorVector);
				var o = t.InnerNodeSize,
					o = cc.size(o.Width || 0, o.Height || 0);
				i.setInnerContainerSize(o);
				o = 0;
				'Vertical' === t.ScrollDirectionType && (o = 1),
					'Horizontal' === t.ScrollDirectionType && (o = 2),
					'Vertical_Horizontal' === t.ScrollDirectionType && (o = 3),
					i.setDirection(o);
				t = a(t.IsBounceEnabled, !1);
				return i.setBounceEnabled(t), i;
			}),
			(r.initImageView = function (t, e) {
				var i,
					n,
					r,
					o = new ccui.ImageView();
				return (
					u(t.FileData, e, function (t, e) {
						o.loadTexture(t, e);
					}),
					u(t.ImageFileData, e, function (t, e) {
						o.loadTexture(t, e);
					}),
					t.Scale9Enable
						? (o.setScale9Enabled(!0),
						  o.setUnifySizeEnabled(!1),
						  o.ignoreContentAdaptWithSize(!1),
						  (i = t.Scale9OriginX || 0),
						  (n = t.Scale9OriginY || 0),
						  (r = t.Scale9Width || 0),
						  (e = t.Scale9Height || 0),
						  o.setCapInsets(cc.rect(i, n, r, e)))
						: d(o, t.Size),
					this.widgetAttributes(o, t),
					o
				);
			}),
			(r.initLoadingBar = function (t, e) {
				var i = new ccui.LoadingBar();
				this.widgetAttributes(i, t),
					u(t.ImageFileData, e, function (t, e) {
						i.loadTexture(t, e);
					});
				e = 'Right_To_Left' === t.ProgressType ? 1 : 0;
				i.setDirection(e);
				t = a(t.ProgressInfo, 80);
				return null != t && i.setPercent(t), i;
			}),
			(r.initSlider = function (t, e) {
				var n = new ccui.Slider(),
					r = cc.loader;
				this.widgetAttributes(n, t),
					[
						{ name: 'BackGroundData', handle: n.loadBarTexture },
						{
							name: 'BallNormalData',
							handle: n.loadSlidBallTextureNormal,
						},
						{
							name: 'BallPressedData',
							handle: n.loadSlidBallTexturePressed,
						},
						{
							name: 'BallDisabledData',
							handle: n.loadSlidBallTextureDisabled,
						},
						{
							name: 'ProgressBarData',
							handle: n.loadProgressBarTexture,
						},
					].forEach(function (i) {
						u(t[i.name], e, function (t, e) {
							0 !== e ||
								r.getRes(t) ||
								cc.log('%s need to be preloaded', t),
								i.handle.call(n, t, e);
						});
					});
				var i = t.PercentInfo || 0;
				n.setPercent(i);
				i = a(t.DisplayState, !0);
				return n.setBright(i), n.setEnabled(i), n;
			}),
			(r.initPageView = function (t, e) {
				var i = new ccui.PageView();
				this.widgetAttributes(i, t),
					u(t.FileData, e, function (t, e) {
						i.setBackGroundImage(t, e);
					});
				var n,
					r = t.ClipAble || !1;
				i.setClippingEnabled(r),
					t.Scale9Enable &&
						(i.setBackGroundImageScale9Enabled(!0),
						(n = t.Scale9OriginX || 0),
						(e = t.Scale9OriginY || 0),
						(r = t.Scale9Width || 0),
						(o = t.Scale9Height || 0),
						i.setBackGroundImageCapInsets(cc.rect(n, e, r, o)));
				var o = a(t.ComboBoxIndex, 0);
				i.setBackGroundColorType(o),
					c(i, t.SingleColor, t.FirstColor, t.EndColor),
					l(i, t.ColorVector);
				o = t.BackColorAlpha;
				return (
					null != o && i.setBackGroundColorOpacity(o), d(i, t.Size), i
				);
			}),
			(r.initListView = function (t, e) {
				var i = new ccui.ListView();
				this.widgetAttributes(i, t),
					u(t.FileData, e, function (t, e) {
						i.setBackGroundImage(t, e);
					});
				var n = t.ClipAble || !1;
				i.setClippingEnabled(n);
				e = a(t.ComboBoxIndex, 0);
				i.setBackGroundColorType(e);
				n = a(t.BackColorAlpha, 255);
				t.Scale9Enable &&
					(i.setBackGroundImageScale9Enabled(!0),
					(e = t.Scale9OriginX || 0),
					(r = t.Scale9OriginY || 0),
					(o = t.Scale9Width || 0),
					(s = t.Scale9Height || 0),
					i.setBackGroundImageCapInsets(cc.rect(e, r, o, s)));
				var r = a(t.DirectionType, ccui.ListView.DIR_HORIZONTAL),
					o = a(t.VerticalType, 'Align_Left'),
					s = a(t.HorizontalType, 'Align_Top');
				r
					? 'Vertical' === r &&
					  (i.setDirection(ccui.ScrollView.DIR_VERTICAL),
					  '' === s
							? i.setGravity(ccui.ListView.GRAVITY_LEFT)
							: 'Align_Right' === s
							? i.setGravity(ccui.ListView.GRAVITY_RIGHT)
							: 'Align_HorizontalCenter' === s &&
							  i.setGravity(
									ccui.ListView.GRAVITY_CENTER_HORIZONTAL
							  ))
					: (i.setDirection(ccui.ScrollView.DIR_HORIZONTAL),
					  'Align_Bottom' === o
							? i.setGravity(ccui.ListView.GRAVITY_BOTTOM)
							: 'Align_VerticalCenter' === o
							? i.setGravity(
									ccui.ListView.GRAVITY_CENTER_VERTICAL
							  )
							: i.setGravity(ccui.ListView.GRAVITY_TOP));
				o = a(t.IsBounceEnabled, !1);
				i.setBounceEnabled(o);
				o = t.ItemMargin || 0;
				i.setItemsMargin(o);
				o = t.InnerNodeSize;
				return (
					null != o &&
						i.setInnerContainerSize(
							cc.size(o.Widget || 0, o.Height || 0)
						),
					c(i, t.SingleColor, t.FirstColor, t.EndColor),
					l(i, t.ColorVector),
					null != n && i.setBackGroundColorOpacity(n),
					d(i, t.Size),
					i
				);
			}),
			(r.initTextAtlas = function (t, e) {
				var i = new ccui.TextAtlas(),
					n = t.LabelText,
					r = t.CharWidth,
					o = t.CharHeight,
					s = t.StartChar;
				return (
					u(t.LabelAtlasFileImage_CNB, e, function (t, e) {
						cc.loader.getRes(t) ||
							cc.log('%s need to be preloaded', t),
							0 === e && i.setProperty(n, t, r, o, s);
					}),
					this.widgetAttributes(i, t),
					i.ignoreContentAdaptWithSize(!0),
					i
				);
			}),
			(r.initTextBMFont = function (t, e) {
				var i = new ccui.TextBMFont();
				this.widgetAttributes(i, t);
				var n = t.LabelText;
				return (
					i.setString(n),
					u(t.LabelBMFontFile_CNB, e, function (t, e) {
						cc.loader.getRes(t) ||
							cc.log('%s need to be pre loaded', t),
							i.setFntFile(t);
					}),
					i.ignoreContentAdaptWithSize(!0),
					i
				);
			}),
			(r.initTextField = function (t, e) {
				var i = new ccui.TextField();
				t.PasswordEnable &&
					(i.setPasswordEnabled(!0),
					(n = t.PasswordStyleText || '*'),
					i.setPasswordStyleText(n));
				var n = t.PlaceHolderText;
				null != n && i.setPlaceHolder(n);
				n = t.FontSize;
				null != n && i.setFontSize(n);
				n = t.FontName;
				null != n && i.setFontName(n),
					t.MaxLengthEnable &&
						(i.setMaxLengthEnabled(!0),
						(r = t.MaxLengthText || 0),
						i.setMaxLength(r)),
					this.widgetAttributes(i, t);
				var r = t.LabelText;
				null != r && i.setString(r);
				r = t.FontResource;
				null == r ||
					(null != (r = r.Path) &&
						((n = cc.sys.isNative
							? cc.path.join(cc.loader.resPath, e, r)
							: (n = r.match(/([^\/]+)\.(\S+)/))
							? n[1]
							: ''),
						i.setFontName(n))),
					i.setUnifySizeEnabled(!1),
					i.ignoreContentAdaptWithSize(!1);
				n = t.CColor;
				return (
					null != n && i.setTextColor(_(n)),
					i.isIgnoreContentAdaptWithSize() ||
						(d(i, t.Size),
						cc.sys.isNative &&
							i
								.getVirtualRenderer()
								.setLineBreakWithoutSpace(!0)),
					i
				);
			}),
			(r.initSimpleAudio = function (t, e) {
				var i = new ccs.ComAudio(),
					n = t.Loop || !1;
				i.setLoop(n),
					u(t.FileData, e, function (t, e) {
						i.setFile(t);
					});
			}),
			(r.initGameMap = function (i, t) {
				var n = null;
				return (
					u(i.FileData, t, function (t, e) {
						0 === e && (n = new cc.TMXTiledMap(t)),
							r.generalAttributes(n, i);
					}),
					n
				);
			}),
			(r.initProjectNode = function (t, e) {
				var i = t.FileData;
				if (null != i && i.Path) {
					i = e + i.Path;
					if (cc.loader.getRes(i)) {
						e = ccs.load(i, e);
						return (
							r.generalAttributes(e.node, t),
							e.action &&
								e.node &&
								((e.action.tag = e.node.tag),
								void 0 !== (t = t.InnerActionSpeed) &&
									e.action.setTimeSpeed(t),
								e.node.runAction(e.action),
								e.action.gotoFrameAndPause(0)),
							e.node
						);
					}
					cc.log('%s need to be preloaded', i);
				}
			}),
			(r.initArmature = function (t, e) {
				var o = new ccs.Armature(),
					s = t.IsLoop,
					c = t.IsAutoPlay,
					a = t.CurrentAnimationName;
				return (
					u(t.FileData, e, function (t, e) {
						var i,
							n,
							r = cc.loader.getRes(t);
						r
							? ((i = r.config_file_path),
							  (n = r.config_png_path),
							  i.forEach(function (t, e) {
									n[e] &&
										cc.spriteFrameCache.addSpriteFrames(
											t,
											n[e]
										);
							  }))
							: cc.log('%s need to be preloaded', t),
							ccs.armatureDataManager.addArmatureFileInfo(t),
							o.init(
								(function (t) {
									if (!t) return '';
									t = t.match(/([^\/]+)\.[^\/]+$/);
									return t && t[1] ? t[1] : '';
								})(t)
							),
							c
								? o.getAnimation().play(a, -1, s)
								: (o.getAnimation().play(a),
								  o.getAnimation().gotoAndPause(0));
					}),
					delete t.AnchorPoint,
					delete t.Size,
					r.generalAttributes(o, t),
					o.setColor(_(t.CColor)),
					o
				);
			}),
			(r.initBoneNode = function (t, e) {
				var i = new ccs.BoneNode(),
					n = t.Length;
				void 0 !== n && i.setDebugDrawLength(n);
				n = t.BlendFunc;
				n &&
					void 0 !== n.Src &&
					void 0 !== n.Dst &&
					i.setBlendFunc(new cc.BlendFunc(n.Src, n.Dst)),
					r.generalAttributes(i, t);
				t = t.CColor;
				return (
					!t ||
						(void 0 === t.R && void 0 === t.G && void 0 === t.B) ||
						i.setColor(_(t)),
					i
				);
			}),
			(r.initSkeletonNode = function (t) {
				var e = new ccs.SkeletonNode();
				r.generalAttributes(e, t);
				t = t.CColor;
				return (
					!t ||
						(void 0 === t.R && void 0 === t.G && void 0 === t.B) ||
						e.setColor(_(t)),
					e
				);
			});
		var o = {},
			u = function (t, e, i) {
				var n, r;
				null != t &&
					((n = t.Path),
					(r = 'Default' === t.Type || 'Normal' === t.Type ? 0 : 1),
					(t = t.Plist) &&
						(cc.loader.getRes(e + t)
							? ((o[e + t] = !0),
							  cc.spriteFrameCache.addSpriteFrames(e + t))
							: o[e + t] ||
							  cc.spriteFrameCache.getSpriteFrame(n) ||
							  cc.log('%s need to be preloaded', e + t)),
					0 !== r
						? cc.spriteFrameCache.getSpriteFrame(n)
							? i(n, r)
							: cc.log('failed to get spriteFrame: %s', n)
						: i(e + n, r));
			},
			_ = function (t) {
				if (t) {
					var e = null != t.R ? t.R : 255,
						i = null != t.G ? t.G : 255,
						n = null != t.B ? t.B : 255,
						t = null != t.A ? t.A : 255;
					return cc.color(e, i, n, t);
				}
			},
			d = function (t, e) {
				var i = e.X || 0,
					n = e.Y || 0;
				e && t.setContentSize(cc.size(i, n));
			};
		[
			{ name: 'SingleNodeObjectData', handle: r.initSingleNode },
			{ name: 'NodeObjectData', handle: r.initSingleNode },
			{ name: 'LayerObjectData', handle: r.initSingleNode },
			{ name: 'GameNodeObjectData', handle: r.initSingleNode },
			{ name: 'GameLayerObjectData', handle: r.initSingleNode },
			{ name: 'SpriteObjectData', handle: r.initSprite },
			{ name: 'ParticleObjectData', handle: r.initParticle },
			{ name: 'PanelObjectData', handle: r.initPanel },
			{ name: 'TextObjectData', handle: r.initText },
			{ name: 'ButtonObjectData', handle: r.initButton },
			{ name: 'CheckBoxObjectData', handle: r.initCheckBox },
			{ name: 'ScrollViewObjectData', handle: r.initScrollView },
			{ name: 'ImageViewObjectData', handle: r.initImageView },
			{ name: 'LoadingBarObjectData', handle: r.initLoadingBar },
			{ name: 'SliderObjectData', handle: r.initSlider },
			{ name: 'PageViewObjectData', handle: r.initPageView },
			{ name: 'ListViewObjectData', handle: r.initListView },
			{ name: 'TextAtlasObjectData', handle: r.initTextAtlas },
			{ name: 'TextBMFontObjectData', handle: r.initTextBMFont },
			{ name: 'TextFieldObjectData', handle: r.initTextField },
			{ name: 'SimpleAudioObjectData', handle: r.initSimpleAudio },
			{ name: 'GameMapObjectData', handle: r.initGameMap },
			{ name: 'ProjectNodeObjectData', handle: r.initProjectNode },
			{ name: 'ArmatureNodeObjectData', handle: r.initArmature },
			{ name: 'BoneNodeObjectData', handle: r.initBoneNode },
			{ name: 'SkeletonNodeObjectData', handle: r.initSkeletonNode },
		].forEach(function (n) {
			r.registerParser(n.name, function (t, e) {
				var i = n.handle.call(this, t, e);
				return this.parseChild(i, t.Children, e), i;
			});
		}),
			t.registerParser('timeline', '2.*', r),
			t.registerParser('timeline', '*', r);
	})(ccs._load),
	(function (t) {
		var o = new (ccs._parser.extend({
			addSpriteFrame: function (t, e) {
				if (t)
					for (var i = 0; i < t.length; i++)
						cc.spriteFrameCache.addSpriteFrames(e + t[i]);
			},
			pretreatment: function (t, e) {
				this.addSpriteFrame(t.textures, e);
			},
			deferred: function (t, e, i, n) {
				i &&
					(ccs.actionManager.initWithDictionary(n, t.animation, i),
					i.setContentSize(cc.size(t.designWidth, t.designHeight)));
			},
		}))();
		function f(t, e, i, n) {
			i && n(0 === e ? t + i : i, e);
		}
		(o.generalAttributes = function (t, e) {
			var i = e.ignoreSize;
			null != i && t.ignoreContentAdaptWithSize(i),
				e.sizeType && t.setSizeType(e.sizeType),
				e.positionType && t.setPositionType(e.positionType),
				t.setSizePercent(cc.p(e.sizePercentX, e.sizePercentY)),
				t.setPositionPercent(
					cc.p(e.positionPercentX, e.positionPercentY)
				);
			var n = 0,
				i = 0;
			(i = e.adaptScreen
				? ((n = (r = cc.director.getWinSize()).width), r.height)
				: ((n = e.width), e.height)),
				t.setContentSize(n, i),
				t.setTag(e.tag),
				t.setActionTag(e.actiontag),
				t.setTouchEnabled(e.touchAble);
			var r = e.name,
				n = r || 'default';
			t.setName(n);
			(i = e.x), (r = e.y);
			t.setPosition(i, r);
			n = null != e.scaleX ? e.scaleX : 1;
			t.setScaleX(n);
			i = null != e.scaleY ? e.scaleY : 1;
			t.setScaleY(i);
			r = e.rotation || 0;
			t.setRotation(r);
			n = e.visible || !1;
			if (
				(null != n && t.setVisible(n),
				t.setLocalZOrder(e.ZOrder),
				null != e.layoutParameter)
			) {
				var o = e.layoutParameter,
					s = null;
				switch (o.type) {
					case 0:
						break;
					case 1:
						s = new ccui.LinearLayoutParameter();
						var c = o.gravity;
						s.setGravity(c);
						break;
					case 2:
						var a = (s = new ccui.RelativeLayoutParameter()),
							c = o.relativeName;
						a.setRelativeName(c);
						c = o.relativeToName;
						a.setRelativeToWidgetName(c);
						c = o.align;
						a.setAlign(c);
				}
				null != s &&
					((i = o.marginLeft || 0),
					(r = o.marginTop || 0),
					(n = o.marginRight || 0),
					(e = o.marginDown || 0),
					s.setMargin(i, r, n, e),
					t.setLayoutParameter(s));
			}
		}),
			(o.colorAttributes = function (t, e) {
				var i = e.opacity;
				null != i && t.setOpacity(i);
				var n = e.colorR,
					r = e.colorG,
					i = e.colorB;
				t.setColor(
					cc.color(
						null == n ? 255 : n,
						null == r ? 255 : r,
						null == i ? 255 : i
					)
				),
					t.setFlippedX(e.flipX),
					t.setFlippedY(e.flipY);
			}),
			(o.anchorPointAttributes = function (t, e) {
				var i = e.anchorPointX,
					n = null != i ? e.anchorPointX : t.getAnchorPoint().x,
					r = e.anchorPointY,
					e = null != r ? e.anchorPointY : t.getAnchorPoint().y;
				(null == i && null == r) || t.setAnchorPoint(cc.p(n, e));
			}),
			(o.parseChild = function (t, e, i) {
				for (var n = e.children, r = 0; r < n.length; r++) {
					var o,
						s,
						c = this.parseNode(n[r], i);
					c &&
						(t instanceof ccui.PageView
							? t.addPage(c)
							: t instanceof ccui.ListView
							? t.pushBackCustomItem(c)
							: (t instanceof ccui.Layout ||
									(c.getPositionType() ===
										ccui.Widget.POSITION_PERCENT &&
										((o = c.getPositionPercent()),
										(s = t.getAnchorPoint()),
										c.setPositionPercent(
											cc.p(o.x + s.x, o.y + s.y)
										)),
									(s = t.getAnchorPointInPoints()),
									c.setPosition(
										cc.p(
											c.getPositionX() + s.x,
											c.getPositionY() + s.y
										)
									)),
							  t.addChild(c)));
				}
			}),
			(o.LayoutAttributes = function (i, t, e) {
				var n = 0,
					r = 0;
				(r = t.adaptScreen
					? ((n = (p = cc.director.getWinSize()).width), p.height)
					: ((n = t.width), t.height)),
					i.setSize(cc.size(n, r)),
					i.setClippingEnabled(t.clipAble);
				var o = t.backGroundScale9Enable;
				i.setBackGroundImageScale9Enabled(o);
				var s = t.bgColorR,
					c = t.bgColorG,
					a = t.bgColorB,
					l = t.bgStartColorR,
					h = t.bgStartColorG,
					u = t.bgStartColorB,
					_ = t.bgEndColorR,
					d = t.bgEndColorG,
					p = t.bgEndColorB,
					n = t.vectorX,
					r = t.vectorY;
				i.setBackGroundColorVector(cc.p(n, r));
				(n = t.bgColorOpacity), (r = t.colorType);
				i.setBackGroundColorType(r),
					i.setBackGroundColor(cc.color(l, h, u), cc.color(_, d, p)),
					i.setBackGroundColor(cc.color(s, c, a)),
					i.setBackGroundColorOpacity(n);
				a = t.backGroundImageData;
				a &&
					f(e, a.resourceType, a.path, function (t, e) {
						i.setBackGroundImage(t, e);
					}),
					o &&
						((n = t.capInsetsX),
						(e = t.capInsetsY),
						(a = t.capInsetsWidth),
						(o = t.capInsetsHeight),
						i.setBackGroundImageCapInsets(cc.rect(n, e, a, o))),
					t.layoutType && i.setLayoutType(t.layoutType);
			}),
			(o.ButtonAttributes = function (t, e, i) {
				var n = t,
					r = e.scale9Enable;
				n.setScale9Enabled(r);
				t = e.normalData;
				f(i, t.resourceType, t.path, function (t, e) {
					n.loadTextureNormal(t, e);
				});
				t = e.pressedData;
				f(i, t.resourceType, t.path, function (t, e) {
					n.loadTexturePressed(t, e);
				});
				t = e.disabledData;
				f(i, t.resourceType, t.path, function (t, e) {
					n.loadTextureDisabled(t, e);
				}),
					r &&
						((r = e.capInsetsX),
						(s = e.capInsetsY),
						(c = e.capInsetsWidth),
						(o = e.capInsetsHeight),
						n.setCapInsets(cc.rect(r, s, c, o)),
						(s = e.scale9Width),
						(c = e.scale9Height),
						null != s && null != c && n.setSize(cc.size(s, c)));
				var o = e.text;
				null != o && n.setTitleText(o);
				var s = e.textColorR,
					c = e.textColorG,
					o = e.textColorB,
					s = null !== s ? e.textColorR : 255,
					c = null !== c ? e.textColorG : 255,
					o = null !== o ? e.textColorB : 255;
				n.setTitleColor(cc.color(s, c, o)),
					null != e.fontSize && n.setTitleFontSize(e.fontSize),
					e.fontName && n.setTitleFontName(e.fontName);
			}),
			(o.CheckBoxAttributes = function (i, t, e) {
				var n = t.backGroundBoxData;
				f(e, n.resourceType, n.path, function (t, e) {
					i.loadTextureBackGround(t, e);
				});
				var r = t.backGroundBoxSelectedData;
				f(
					e,
					r.resourceType || n.resourceType,
					r.path || n.path,
					function (t, e) {
						i.loadTextureBackGroundSelected(t, e);
					}
				);
				r = t.frontCrossData;
				f(e, r.resourceType, r.path, function (t, e) {
					i.loadTextureFrontCross(t, e);
				});
				n = t.backGroundBoxDisabledData;
				f(
					e,
					n.resourceType || r.resourceType,
					n.path || r.path,
					function (t, e) {
						i.loadTextureBackGroundDisabled(t, e);
					}
				);
				r = t.frontCrossDisabledData;
				f(e, r.resourceType, r.path, function (t, e) {
					i.loadTextureFrontCrossDisabled(t, e);
				}),
					t.selectedState && i.setSelected(t.selectedState);
			}),
			(o.ImageViewAttributes = function (i, t, e) {
				var n = t.fileNameData;
				f(e, n.resourceType, n.path, function (t, e) {
					i.loadTexture(t, e);
				});
				var r,
					o,
					e = !1;
				t.scale9Enable && (e = t.scale9Enable),
					i.setScale9Enabled(e),
					e &&
						((n = t.scale9Width),
						(e = t.scale9Height),
						n &&
							e &&
							((r = t.scale9Width),
							(o = t.scale9Height),
							i.setSize(cc.size(r, o))),
						(e = t.capInsetsX),
						(r = t.capInsetsY),
						(o = t.capInsetsWidth),
						(t = t.capInsetsHeight),
						i.setCapInsets(cc.rect(e, r, o, t)));
			}),
			(o.TextAtlasAttributes = function (t, e, i) {
				var n = e.stringValue,
					r = e.charMapFileData,
					o = e.itemWidth,
					s = e.itemHeight,
					c = e.startCharMap;
				if (null != n && r && null != o && null != s && null != c) {
					var a = e.charMapFileData;
					switch (a.resourceType) {
						case 0:
							var l = i + a.path;
							t.setProperty(n, l, o, s, c);
							break;
						case 1:
							cc.log('Wrong res type of LabelAtlas!');
					}
				}
			}),
			(o.TextBMFontAttributes = function (t, e, i) {
				var n = e.fileNameData;
				switch (n.resourceType) {
					case 0:
						var r = i + n.path;
						t.setFntFile(r);
						break;
					case 1:
						cc.log('Wrong res type of LabelAtlas!');
				}
				e = e.text;
				t.setString(e);
			});
		var s = /\.ttf$/;
		(o.TextAttributes = function (t, e, i) {
			var n = e.touchScaleEnable;
			t.setTouchScaleChangeEnabled(n);
			n = e.text;
			t.setString(n), null != e.fontSize && t.setFontSize(e.fontSize);
			n = e.fontName;
			null != n &&
				(cc.sys.isNative
					? s.test(n)
						? t.setFontName(cc.path.join(cc.loader.resPath, i, n))
						: t.setFontName(n)
					: t.setFontName(n.replace(s, '')));
			(i = e.areaWidth), (n = e.areaHeight);
			null != i &&
				null != n &&
				((n = cc.size(e.areaWidth, e.areaHeight)),
				t.setTextAreaSize(n)),
				null != e.hAlignment &&
					t.setTextHorizontalAlignment(e.hAlignment),
				null != e.vAlignment &&
					t.setTextVerticalAlignment(e.vAlignment);
		}),
			(o.ListViewAttributes = function (t, e, i) {
				o.ScrollViewAttributes(t, e, i);
				i = e.direction;
				t.setDirection(i);
				i = e.gravity;
				t.setGravity(i);
				e = e.itemMargin;
				t.setItemsMargin(e);
			}),
			(o.LoadingBarAttributes = function (i, t, e) {
				var n = t.textureData;
				f(e, n.resourceType, n.path, function (t, e) {
					i.loadTexture(t, e);
				});
				var r,
					o = t.scale9Enable;
				i.setScale9Enabled(o),
					o &&
						((r = t.capInsetsX),
						(e = t.capInsetsY),
						(n = t.capInsetsWidth),
						(o = t.capInsetsHeight),
						i.setCapInsets(cc.rect(r, e, n, o)),
						(n = t.width),
						(o = t.height),
						i.setSize(cc.size(n, o))),
					i.setDirection(t.direction),
					i.setPercent(t.percent);
			}),
			(o.PageViewAttributes = o.LayoutAttributes),
			(o.ScrollViewAttributes = function (t, e, i) {
				o.LayoutAttributes(t, e, i);
				var n = null != e.innerWidth ? e.innerWidth : 200,
					i = null != e.innerHeight ? e.innerHeight : 200;
				t.setInnerContainerSize(cc.size(n, i));
				i = null != e.direction ? e.direction : 1;
				t.setDirection(i), t.setBounceEnabled(e.bounceEnable);
			}),
			(o.SliderAttributes = function (t, e, i) {
				var n = t,
					r = e.scale9Enable;
				n.setScale9Enabled(r);
				var o = e.barFileName,
					s = e.length,
					c = e.barFileNameData,
					t = c.resourceType,
					c = c.path;
				null != o
					? r &&
					  (f(i, t, c, function (t, e) {
							n.loadBarTexture(t, e);
					  }),
					  n.setSize(cc.size(s, n.getContentSize().height)))
					: f(i, t, c, function (t, e) {
							n.loadBarTexture(t, e);
					  });
				t = e.ballNormalData;
				f(i, t.resourceType, t.path, function (t, e) {
					n.loadSlidBallTextureNormal(t, e);
				});
				c = e.ballPressedData;
				f(
					i,
					c.resourceType || t.resourceType,
					c.path || t.path,
					function (t, e) {
						n.loadSlidBallTexturePressed(t, e);
					}
				);
				t = e.ballDisabledData;
				f(i, t.resourceType, t.path, function (t, e) {
					n.loadSlidBallTextureDisabled(t, e);
				});
				e = e.progressBarData;
				f(i, e.resourceType, e.path, function (t, e) {
					n.loadProgressBarTexture(t, e);
				});
			}),
			(o.TextFieldAttributes = function (t, e, i) {
				var n = e.placeHolder;
				n && t.setPlaceHolder(n), t.setString(e.text || '');
				n = e.fontSize;
				n && t.setFontSize(n);
				n = e.fontName;
				null != n &&
					(cc.sys.isNative
						? s.test(n)
							? t.setFontName(
									cc.path.join(cc.loader.resPath, i, n)
							  )
							: t.setFontName(n)
						: t.setFontName(n.replace(s, '')));
				(i = e.touchSizeWidth), (n = e.touchSizeHeight);
				null != i && null != n && t.setTouchSize(i, n);
				e.width, e.height;
				n = e.maxLengthEnable;
				t.setMaxLengthEnabled(n),
					n && ((r = e.maxLength), t.setMaxLength(r));
				n = e.passwordEnable;
				t.setPasswordEnabled(n),
					n && t.setPasswordStyleText(e.passwordStyleText);
				var r = e.areaWidth,
					n = e.areaHeight;
				r && n && ((o = cc.size(r, n)), t.setTextAreaSize(o));
				n = e.hAlignment;
				n && t.setTextHorizontalAlignment(n);
				var o = e.vAlignment;
				o && t.setTextVerticalAlignment(o);
				(n = e.colorR), (o = e.colorG), (e = e.colorB);
				void 0 !== n &&
					void 0 !== o &&
					void 0 !== e &&
					t.setTextColor(cc.color(n, o, e));
			}),
			[
				{
					name: 'Panel',
					object: ccui.Layout,
					handle: o.LayoutAttributes,
				},
				{
					name: 'Button',
					object: ccui.Button,
					handle: o.ButtonAttributes,
				},
				{
					name: 'CheckBox',
					object: ccui.CheckBox,
					handle: o.CheckBoxAttributes,
				},
				{
					name: 'ImageView',
					object: ccui.ImageView,
					handle: o.ImageViewAttributes,
				},
				{
					name: 'LabelAtlas',
					object: ccui.TextAtlas,
					handle: o.TextAtlasAttributes,
				},
				{
					name: 'LabelBMFont',
					object: ccui.TextBMFont,
					handle: o.TextBMFontAttributes,
				},
				{ name: 'Label', object: ccui.Text, handle: o.TextAttributes },
				{
					name: 'ListView',
					object: ccui.ListView,
					handle: o.ListViewAttributes,
				},
				{
					name: 'LoadingBar',
					object: ccui.LoadingBar,
					handle: o.LoadingBarAttributes,
				},
				{
					name: 'PageView',
					object: ccui.PageView,
					handle: o.PageViewAttributes,
				},
				{
					name: 'ScrollView',
					object: ccui.ScrollView,
					handle: o.ScrollViewAttributes,
				},
				{
					name: 'Slider',
					object: ccui.Slider,
					handle: o.SliderAttributes,
				},
				{
					name: 'TextField',
					object: ccui.TextField,
					handle: o.TextFieldAttributes,
				},
			].forEach(function (r) {
				o.registerParser(r.name, function (t, e) {
					var i = new r.object(),
						n = t.options;
					return (
						o.generalAttributes(i, n),
						r.handle(i, n, e),
						o.colorAttributes(i, n),
						o.anchorPointAttributes(i, n),
						o.parseChild.call(this, i, t, e),
						i
					);
				});
			}),
			t.registerParser('ccui', '*', o);
	})(ccs._load),
	(function () {
		ccs.uiReader = {
			_fileDesignSizes: {},
			widgetFromJsonFile: function (t) {
				var e = cc.loader.getRes(t);
				e &&
					(this._fileDesignSizes[t] = cc.size(
						e.designWidth || 0,
						e.designHeight || 0
					));
				var i = e.Version || e.version,
					e = ccs.uiReader.getVersionInteger(i);
				return !i || 1700 <= e
					? (cc.warn(
							'Not supported file types, Please try use the ccs.load'
					  ),
					  null)
					: ccs._load(t, 'ccui');
			},
			registerTypeAndCallBack: function (o, s, c, t) {
				var e = ccs._load.getParser('ccui')['*'],
					a = t.bind(c);
				e.registerParser(o, function (t, e) {
					var i = new s(),
						n = t.options;
					c.setPropsFromJsonDictionary &&
						c.setPropsFromJsonDictionary(i, n),
						this.generalAttributes(i, n);
					var r = (r = n.customProperty) ? JSON.parse(r) : {};
					return (
						a(o, i, r),
						this.colorAttributes(i, n),
						this.anchorPointAttributes(i, n),
						this.parseChild.call(this, i, t, e),
						i
					);
				});
			},
			getVersionInteger: function (t) {
				if (!t || 'string' != typeof t) return 0;
				t = t.split('.');
				if (4 !== t.length) return 0;
				var i = 0;
				return (
					t.forEach(function (t, e) {
						i += t * Math.pow(10, 3 - e);
					}),
					i
				);
			},
			storeFileDesignSize: function (t, e) {
				this._fileDesignSizes[t] = e;
			},
			getFileDesignSize: function (t) {
				return this._fileDesignSizes[t];
			},
			getFilePath: function () {
				return this._filePath;
			},
			setFilePath: function (t) {
				this._filePath = t;
			},
			getParseObjectMap: function () {
				return ccs._load.getParser('ccui')['*'].parsers;
			},
			getParseCallBackMap: function () {
				return ccs._load.getParser('ccui')['*'].parsers;
			},
			clear: function () {},
		};
		var t = ccs._load.getParser('ccui')['*'];
		(ccs.imageViewReader = {
			setPropsFromJsonDictionary: t.ImageViewAttributes,
		}),
			(ccs.buttonReader = {
				setPropsFromJsonDictionary: t.ButtonAttributes,
			}),
			(ccs.checkBoxReader = {
				setPropsFromJsonDictionary: t.CheckBoxAttributes,
			}),
			(ccs.labelAtlasReader = {
				setPropsFromJsonDictionary: t.TextAtlasAttributes,
			}),
			(ccs.labelBMFontReader = {
				setPropsFromJsonDictionary: t.TextBMFontAttributes,
			}),
			(ccs.labelReader = {
				setPropsFromJsonDictionary: t.TextAttributes,
			}),
			(ccs.layoutReader = {
				setPropsFromJsonDictionary: t.LayoutAttributes,
			}),
			(ccs.listViewReader = {
				setPropsFromJsonDictionary: t.ListViewAttributes,
			}),
			(ccs.loadingBarReader = {
				setPropsFromJsonDictionary: t.LoadingBarAttributes,
			}),
			(ccs.pageViewReader = {
				setPropsFromJsonDictionary: t.PageViewAttributes,
			}),
			(ccs.scrollViewReader = {
				setPropsFromJsonDictionary: t.ScrollViewAttributes,
			}),
			(ccs.sliderReader = {
				setPropsFromJsonDictionary: t.SliderAttributes,
			}),
			(ccs.textFieldReader = {
				setPropsFromJsonDictionary: t.TextFieldAttributes,
			});
	})(),
	(ccs.sceneReader = {
		_node: null,
		createNodeWithSceneFile: function (t) {
			t = ccs._load(t, 'scene');
			return (this._node = t);
		},
		getNodeByTag: function (t) {
			return null == this._node
				? null
				: this._node.getTag() === t
				? this._node
				: this._nodeByTag(this._node, t);
		},
		_nodeByTag: function (t, e) {
			if (null == t) return null;
			for (var i = null, n = t.getChildren(), r = 0; r < n.length; r++) {
				var o = n[r];
				if (o && o.getTag() === e) {
					i = o;
					break;
				}
				if ((i = this._nodeByTag(o, e))) break;
			}
			return i;
		},
		version: function () {
			return '*';
		},
		setTarget: function () {},
		clear: function () {
			ccs.triggerManager.removeAll(), cc.audioEngine.end();
		},
	}),
	(function () {
		ccs.Armature.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._parentCmd = null),
				(this._realAnchorPointInPoints = new cc.Point(0, 0));
		};
		var t = (ccs.Armature.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		cc.inject(ccs.Armature.RenderCmd, t),
			(t.constructor = ccs.Armature.WebGLRenderCmd),
			(t.uploadData = function (t, e, i) {
				for (
					var n,
						r = this._node,
						o = this._parentCmd || this,
						s = r._children,
						c = cc.BlendFunc.ALPHA_PREMULTIPLIED,
						a = cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,
						l = 0,
						h = s.length;
					l < h;
					l++
				) {
					var u = s[l],
						_ = u._renderCmd;
					if (u && u.getDisplayRenderNode) {
						var d,
							p = u.getDisplayRenderNode();
						if (null !== p)
							switch (
								((n = p._renderCmd),
								u.getDisplayRenderNodeType())
							) {
								case ccs.DISPLAY_TYPE_SPRITE:
									p instanceof ccs.Skin &&
										(p.setShaderProgram(
											this._shaderProgram
										),
										this._updateColorAndOpacity(n, u),
										n.transform(o),
										(d = u.getBlendFunc()).src !== c.src ||
										d.dst !== c.dst
											? p.setBlendFunc(u.getBlendFunc())
											: ((d = p.getTexture()),
											  r._blendFunc.src === c.src &&
											  r._blendFunc.dst === c.dst &&
											  d &&
											  !d.hasPremultipliedAlpha()
													? p.setBlendFunc(a)
													: p.setBlendFunc(
															r._blendFunc
													  )),
										cc.renderer._uploadBufferData(n));
									break;
								case ccs.DISPLAY_TYPE_ARMATURE:
									p.setShaderProgram(this._shaderProgram),
										(n._parentCmd = this);
								default:
									_._syncStatus(o),
										n._syncStatus(_),
										n.uploadData
											? cc.renderer._uploadBufferData(n)
											: n.rendering &&
											  (cc.renderer._batchRendering(),
											  n.rendering(cc._renderContext));
							}
					} else
						u instanceof cc.Node &&
							(u.setShaderProgram(this._shaderProgram),
							_._syncStatus(o),
							_.uploadData
								? cc.renderer._uploadBufferData(_)
								: _.rendering &&
								  (cc.renderer._batchRendering(),
								  _.rendering(cc._renderContext)));
				}
				return (this._parentCmd = null), 0;
			}),
			(t.initShaderCache = function () {
				this._shaderProgram = cc.shaderCache.programForKey(
					cc.SHADER_SPRITE_POSITION_TEXTURECOLOR
				);
			}),
			(t.setShaderProgram = function (t) {
				this._shaderProgram = t;
			}),
			(t._updateColorAndOpacity = function (t, e) {
				var i = e._renderCmd._displayedColor,
					n = e._renderCmd._displayedOpacity,
					r = cc.Node._dirtyFlags,
					o = t._dirtyFlag,
					e = o & r.colorDirty,
					r = o & r.opacityDirty;
				e && t._updateDisplayColor(i),
					r && t._updateDisplayOpacity(n),
					(e || r) && t._updateColor();
			}),
			(t.visit = function (t) {
				var e = this._node;
				if (e._visible) {
					(t = t || this.getParentRenderCmd()) &&
						(this._curLevel = t._curLevel + 1),
						this._syncStatus(t),
						e.sortAllChildren();
					var i,
						n,
						r = cc.renderer,
						o = e._children,
						s = o.length;
					for (
						isNaN(e._customZ) &&
							((e._vertexZ = r.assignedZ),
							(r.assignedZ += r.assignedZStep)),
							n = 0;
						n < s && (i = o[n])._localZOrder < 0;
						n++
					)
						isNaN(i._customZ) &&
							((i._vertexZ = r.assignedZ),
							(r.assignedZ += r.assignedZStep));
					for (r.pushRenderCommand(this); n < s; n++)
						(i = o[n]),
							isNaN(i._customZ) &&
								((i._vertexZ = r.assignedZ),
								(r.assignedZ += r.assignedZStep));
					this._dirtyFlag = 0;
				}
			});
	})(),
	(cc.pool = {
		_pool: {},
		_releaseCB: function () {
			this.release();
		},
		_autoRelease: function (t) {
			var e = void 0 !== t._running && !t._running;
			cc.director.getScheduler().schedule(this._releaseCB, t, 0, 0, 0, e);
		},
		putInPool: function (t) {
			var e,
				i = t.constructor.prototype.__pid;
			i ||
				(((e = {
					writable: !0,
					enumerable: !1,
					configurable: !0,
				}).value = ClassManager.getNewID()),
				Object.defineProperty(t.constructor.prototype, '__pid', e)),
				this._pool[i] || (this._pool[i] = []),
				t.retain && t.retain(),
				t.unuse && t.unuse(),
				this._pool[i].push(t);
		},
		hasObject: function (t) {
			(t = t.prototype.__pid), (t = this._pool[t]);
			return !(!t || 0 === t.length);
		},
		removeObject: function (t) {
			var e = t.constructor.prototype.__pid;
			if (e) {
				var i = this._pool[e];
				if (i)
					for (var n = 0; n < i.length; n++)
						t === i[n] &&
							(t.release && t.release(), i.splice(n, 1));
			}
		},
		getFromPool: function (t) {
			if (this.hasObject(t)) {
				var e = t.prototype.__pid,
					i = this._pool[e],
					e = Array.prototype.slice.call(arguments);
				e.shift();
				i = i.pop();
				return (
					i.reuse && i.reuse.apply(i, e),
					cc.sys.isNative && i.release && this._autoRelease(i),
					i
				);
			}
		},
		drainAllPools: function () {
			for (var t in this._pool)
				for (var e = 0; e < this._pool[t].length; e++) {
					var i = this._pool[t][e];
					i.release && i.release();
				}
			this._pool = {};
		},
	}),
	(function () {
		var PluginManager, PluginAssembly, Param, PluginList, Plugin;
		void 0 !== cc &&
			((PluginManager = function () {}),
			(PluginManager.prototype = {
				constructor: PluginManager,
				getInstance: function () {
					return this;
				},
				loadPlugin: function (t) {},
				unloadPlugin: function (t) {},
			}),
			(PluginAssembly = function () {}),
			(PluginAssembly.prototype = {
				constructor: PluginAssembly,
				setDebugMode: function (t) {},
				startSession: function (t) {},
				setCaptureUncaughtException: function (t) {},
				callFuncWithParam: function (t) {
					if ('function' == typeof this[t])
						return this[t].apply(
							this,
							Array.prototype.splice.call(arguments, 1)
						);
					cc.log('function is not define');
				},
				callStringFuncWithParam: function (t) {
					this.callFuncWithParam.apply(arguments);
				},
				getPluginName: function () {
					return this._name;
				},
				getPluginVersion: function () {
					return this._version;
				},
			}),
			(PluginAssembly.extend = function (name, porp) {
				var p,
					prototype = {};
				for (p in PluginAssembly.prototype)
					prototype[p] = PluginAssembly.prototype[p];
				for (p in porp) prototype[p] = porp[p];
				var tmp = eval('(function ' + name + 'Plugin(){})');
				return (
					(prototype.constructor = tmp),
					(tmp.prototype = prototype),
					tmp
				);
			}),
			(Param = function (t, e) {
				var i,
					n = plugin.PluginParam.ParamType;
				switch (t) {
					case n.TypeInt:
						i = parseInt(e);
						break;
					case n.TypeFloat:
						i = parseFloat(e);
						break;
					case n.TypeBool:
						i = Boolean(e);
						break;
					case n.TypeString:
						i = String(e);
						break;
					case n.TypeStringMap:
						i = e;
						break;
					default:
						i = e;
				}
				return i;
			}),
			(Param.ParamType = {
				TypeInt: 1,
				TypeFloat: 2,
				TypeBool: 3,
				TypeString: 4,
				TypeStringMap: 5,
			}),
			(Param.AdsResultCode = {
				AdsReceived: 0,
				FullScreenViewShown: 1,
				FullScreenViewDismissed: 2,
				PointsSpendSucceed: 3,
				PointsSpendFailed: 4,
				NetworkError: 5,
				UnknownError: 6,
			}),
			(Param.PayResultCode = {
				PaySuccess: 0,
				PayFail: 1,
				PayCancel: 2,
				PayTimeOut: 3,
			}),
			(Param.ShareResultCode = {
				ShareSuccess: 0,
				ShareFail: 1,
				ShareCancel: 2,
				ShareTimeOut: 3,
			}),
			(PluginList = {}),
			(Plugin = {
				extend: function (t, e) {
					var i = (cc.game.config && cc.game.config.plugin) || {};
					(PluginList[t] = new (PluginAssembly.extend(t, e))()),
						'function' == typeof PluginList[t].ctor &&
							PluginList[t].ctor(i[t]);
				},
				PluginList: PluginList,
				PluginParam: Param,
				PluginManager: new PluginManager(),
			}),
			(window.plugin = Plugin));
	})(),
	(function () {
		var t = {
			_ignoreBodyRotation: !1,
			_body: null,
			_rotation: 1,
			ctor: function (t, e) {
				var i;
				cc.Sprite.prototype.ctor.call(this),
					void 0 === t
						? cc.PhysicsSprite.prototype.init.call(this)
						: cc.isString(t)
						? '#' === t[0]
							? ((i = t.substr(1, t.length - 1)),
							  (i = cc.spriteFrameCache.getSpriteFrame(i)),
							  this.initWithSpriteFrame(i))
							: this.init(t, e)
						: cc.isObject(t) &&
						  (t instanceof cc.Texture2D
								? this.initWithTexture(t, e)
								: t instanceof cc.SpriteFrame &&
								  this.initWithSpriteFrame(t)),
					cc.renderer.pushRenderCommand(this._renderCmd);
			},
			visit: function () {
				cc.renderer.pushRenderCommand(this._renderCmd),
					cc.Sprite.prototype.visit.call(this);
			},
			setBody: function (t) {
				this._body = t;
			},
			getBody: function () {
				return this._body;
			},
			getPosition: function () {
				var t = this._body;
				return { x: t.p.x, y: t.p.y };
			},
			getPositionX: function () {
				return this._body.p.x;
			},
			getPositionY: function () {
				return this._body.p.y;
			},
			setPosition: function (t, e) {
				void 0 === e
					? ((this._body.p.x = t.x), (this._body.p.y = t.y))
					: ((this._body.p.x = t), (this._body.p.y = e));
			},
			setPositionX: function (t) {
				this._body.p.x = t;
			},
			setPositionY: function (t) {
				this._body.p.y = t;
			},
			_syncPosition: function () {
				var t = this._position,
					e = this._body;
				(t.x === e.p.x && t.y === e.p.y) ||
					cc.Sprite.prototype.setPosition.call(this, e.p.x, e.p.y);
			},
			getRotation: function () {
				return this._ignoreBodyRotation
					? this._rotationX
					: -cc.radiansToDegrees(this._body.a);
			},
			setRotation: function (t) {
				this._ignoreBodyRotation
					? cc.Sprite.prototype.setRotation.call(this, t)
					: (this._body.a = -cc.degreesToRadians(t));
			},
			_syncRotation: function () {
				var t = -cc.radiansToDegrees(this._body.a);
				this._rotationX !== t &&
					cc.Sprite.prototype.setRotation.call(this, t);
			},
			getNodeToParentTransform: function () {
				return this._renderCmd.getNodeToParentTransform();
			},
			isDirty: function () {
				return !this._body.isSleeping();
			},
			setDirty: function () {},
			setIgnoreBodyRotation: function (t) {
				this._ignoreBodyRotation = t;
			},
			_createRenderCmd: function () {
				return new (
					cc._renderType === cc.game.RENDER_TYPE_CANVAS
						? cc.PhysicsSprite.CanvasRenderCmd
						: cc.PhysicsSprite.WebGLRenderCmd
				)(this);
			},
		};
		(cc.PhysicsSprite = cc.Sprite.extend(t)),
			(cc.PhysicsSprite._className = 'PhysicsSprite'),
			(t = cc.PhysicsSprite.prototype).body,
			cc.defineGetterSetter(t, 'body', t.getBody, t.setBody),
			t.dirty,
			cc.defineGetterSetter(t, 'dirty', t.isDirty, t.setDirty),
			(cc.PhysicsSprite.create = function (t, e) {
				return new cc.PhysicsSprite(t, e);
			}),
			(cc.PhysicsSprite.createWithSpriteFrameName =
				cc.PhysicsSprite.create),
			(cc.PhysicsSprite.createWithSpriteFrame = cc.PhysicsSprite.create);
	})(),
	(function () {
		cc.PhysicsSprite.CanvasRenderCmd = function (t) {
			cc.Sprite.CanvasRenderCmd.call(this, t), (this._needDraw = !0);
		};
		var t = (cc.PhysicsSprite.CanvasRenderCmd.prototype = Object.create(
			cc.Sprite.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.PhysicsSprite.CanvasRenderCmd),
			(t.rendering = function (t, e, i) {
				var n = this._node;
				n._syncPosition(),
					n._ignoreBodyRotation || n._syncRotation(),
					this.transform(this.getParentRenderCmd()),
					cc.Sprite.CanvasRenderCmd.prototype.rendering.call(
						this,
						t,
						e,
						i
					);
			});
	})(),
	(cc.__convertVerts = function (t) {
		for (var e = [], i = 0; i < t.length / 2; i++)
			e[i] = { x: t[2 * i], y: t[2 * i + 1] };
		return e;
	}),
	(cc.ColorForBody = function (t) {
		return t.isRogue() || t.isSleeping()
			? cc.color(128, 128, 128, 128)
			: t.nodeIdleTime > t.space.sleepTimeThreshold
			? cc.color(84, 84, 84, 128)
			: cc.color(255, 0, 0, 128);
	}),
	(cc.DrawShape = function (t, e) {
		var i = t.body,
			n = cc.ColorForBody(i);
		switch (t.collisionCode) {
			case cp.CircleShape.prototype.collisionCode:
				this.drawDot(t.tc, Math.max(t.r, 1), n),
					this.drawSegment(
						t.tc,
						cp.v.add(t.tc, cp.v.mult(i.rot, t.r)),
						1,
						n
					);
				break;
			case cp.SegmentShape.prototype.collisionCode:
				this.drawSegment(t.ta, t.tb, Math.max(t.r, 2), n);
				break;
			case cp.PolyShape.prototype.collisionCode:
				var r = cc.color(n.r, n.g, n.b, cc.lerp(n.a, 255, 0.5));
				this.drawPoly(cc.__convertVerts(t.tVerts), n, 1, r);
				break;
			default:
				cc.log('cc.DrawShape(): Bad assertion in DrawShape()');
		}
	}),
	(cc.DrawConstraint = function (t, e) {
		var i,
			n,
			r = t.a,
			o = t.b;
		t instanceof cp.PinJoint || t instanceof cp.SlideJoint
			? ((i = r.local2World(t.anchr1)),
			  (n = o.local2World(t.anchr2)),
			  this.drawDot(i, 3, cc.CONSTRAINT_COLOR),
			  this.drawDot(n, 3, cc.CONSTRAINT_COLOR),
			  this.drawSegment(i, n, 1, cc.CONSTRAINT_COLOR))
			: t instanceof cp.PivotJoint
			? ((i = r.local2World(t.anchr1)),
			  (n = o.local2World(t.anchr2)),
			  this.drawDot(i, 3, cc.CONSTRAINT_COLOR),
			  this.drawDot(n, 3, cc.CONSTRAINT_COLOR))
			: t instanceof cp.GrooveJoint
			? ((i = r.local2World(t.grv_a)),
			  (n = r.local2World(t.grv_b)),
			  (t = o.local2World(t.anchr2)),
			  this.drawDot(t, 3, cc.CONSTRAINT_COLOR),
			  this.drawSegment(i, n, 1, cc.CONSTRAINT_COLOR))
			: cp.DampedSpring;
	}),
	(cc.CONSTRAINT_COLOR = cc.color(0, 255, 0, 128)),
	(cc.PhysicsDebugNode = cc.DrawNode.extend({
		_space: null,
		_className: 'PhysicsDebugNode',
		ctor: function (t) {
			cc.DrawNode.prototype.ctor.call(this), (this._space = t);
		},
		getSpace: function () {
			return this._space;
		},
		setSpace: function (t) {
			this._space = t;
		},
		draw: function (t) {
			this._space &&
				(this._space.eachShape(cc.DrawShape.bind(this)),
				this._space.eachConstraint(cc.DrawConstraint.bind(this)),
				cc.DrawNode.prototype.draw.call(this),
				this.clear());
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? cc.PhysicsDebugNode.CanvasRenderCmd
					: cc.PhysicsDebugNode.WebGLRenderCmd
			)(this);
		},
	})),
	(cc.PhysicsDebugNode.create = function (t) {
		return new cc.PhysicsDebugNode(t);
	}),
	(function () {
		cc.PhysicsDebugNode.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t),
				(this._buffer = t._buffer),
				(this._needDraw = !0);
		};
		var t = (cc.PhysicsDebugNode.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		(t.constructor = cc.PhysicsDebugNode.CanvasRenderCmd),
			(t.rendering = function (t, e, i) {
				var n = this._node;
				n._space &&
					(n._space.eachShape(cc.DrawShape.bind(n)),
					n._space.eachConstraint(cc.DrawConstraint.bind(n)),
					cc.DrawNode.CanvasRenderCmd.prototype.rendering.call(
						this,
						t,
						e,
						i
					),
					n.clear());
			}),
			(t._drawDot = cc.DrawNode.CanvasRenderCmd.prototype._drawDot),
			(t._drawSegment =
				cc.DrawNode.CanvasRenderCmd.prototype._drawSegment),
			(t._drawPoly = cc.DrawNode.CanvasRenderCmd.prototype._drawPoly);
	})(),
	(cc.PhysicsDebugNode.WebGLRenderCmd = function (t) {
		cc.Node.WebGLRenderCmd.call(this, t),
			(this._needDraw = !0),
			(this._matrix = new cc.math.Matrix4()),
			this._matrix.identity();
	}),
	(cc.PhysicsDebugNode.WebGLRenderCmd.prototype = Object.create(
		cc.Node.WebGLRenderCmd.prototype
	)),
	(cc.PhysicsDebugNode.WebGLRenderCmd.prototype.constructor =
		cc.PhysicsDebugNode.WebGLRenderCmd),
	(cc.PhysicsDebugNode.WebGLRenderCmd.prototype.rendering = function (t) {
		var e,
			i = this._node;
		i._space &&
			(i._space.eachShape(cc.DrawShape.bind(i)),
			i._space.eachConstraint(cc.DrawConstraint.bind(i)),
			(e = this._worldTransform),
			(this._matrix.mat[0] = e.a),
			(this._matrix.mat[4] = e.c),
			(this._matrix.mat[12] = e.tx),
			(this._matrix.mat[1] = e.b),
			(this._matrix.mat[5] = e.d),
			(this._matrix.mat[13] = e.ty),
			cc.glBlendFunc(i._blendFunc.src, i._blendFunc.dst),
			this._shaderProgram.use(),
			this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),
			i._render(),
			i.clear());
	}),
	(function () {
		cc.PhysicsSprite.WebGLRenderCmd = function (t) {
			cc.Sprite.WebGLRenderCmd.call(this, t), (this._needDraw = !0);
		};
		var t = (cc.PhysicsSprite.WebGLRenderCmd.prototype = Object.create(
			cc.Sprite.WebGLRenderCmd.prototype
		));
		(t.constructor = cc.PhysicsSprite.WebGLRenderCmd),
			(t.spUploadData = cc.Sprite.WebGLRenderCmd.prototype.uploadData),
			(t.uploadData = function (t, e, i) {
				var n = this._node;
				return (
					n._syncPosition(),
					n._ignoreBodyRotation || n._syncRotation(),
					this.transform(this.getParentRenderCmd(), !0),
					this.spUploadData(t, e, i)
				);
			});
	})(),
	(function (t) {
		var e;
		'object' == typeof exports && 'undefined' != typeof module
			? (module.exports = t())
			: 'function' == typeof define && define.amd
			? define([], t)
			: ('undefined' != typeof window
					? (e = window)
					: 'undefined' != typeof global
					? (e = global)
					: 'undefined' != typeof self && (e = self),
			  (e.io = t()));
	})(function () {
		return (function n(r, o, s) {
			function c(i, t) {
				if (!o[i]) {
					if (!r[i]) {
						var e = 'function' == typeof require && require;
						if (!t && e) return e(i, !0);
						if (a) return a(i, !0);
						throw new Error("Cannot find module '" + i + "'");
					}
					e = o[i] = { exports: {} };
					r[i][0].call(
						e.exports,
						function (t) {
							var e = r[i][1][t];
							return c(e || t);
						},
						e,
						e.exports,
						n,
						r,
						o,
						s
					);
				}
				return o[i].exports;
			}
			for (
				var a = 'function' == typeof require && require, t = 0;
				t < s.length;
				t++
			)
				c(s[t]);
			return c;
		})(
			{
				1: [
					function (t, e, i) {
						e.exports = t('./lib/');
					},
					{ './lib/': 2 },
				],
				2: [
					function (t, e, i) {
						var r = t('./url'),
							n = t('socket.io-parser'),
							o = t('./manager'),
							s = t('debug')('socket.io-client');
						e.exports = i = a;
						var c = (i.managers = {});
						function a(t, e) {
							'object' == typeof t && ((e = t), (t = void 0)),
								(e = e || {});
							var i = r(t),
								n = i.source,
								t = i.id,
								t =
									e.forceNew ||
									e['force new connection'] ||
									!1 === e.multiplex
										? (s('ignoring socket cache for %s', n),
										  o(n, e))
										: (c[t] ||
												(s('new io instance for %s', n),
												(c[t] = o(n, e))),
										  c[t]);
							return t.socket(i.path);
						}
						(i.protocol = n.protocol),
							(i.connect = a),
							(i.Manager = t('./manager')),
							(i.Socket = t('./socket'));
					},
					{
						'./manager': 3,
						'./socket': 5,
						'./url': 6,
						debug: 10,
						'socket.io-parser': 46,
					},
				],
				3: [
					function (t, e, i) {
						t('./url');
						var c = t('engine.io-client'),
							n = t('./socket'),
							r = t('component-emitter'),
							o = t('socket.io-parser'),
							a = t('./on'),
							s = t('component-bind'),
							l =
								(t('object-component'),
								t('debug')('socket.io-client:manager')),
							h = t('indexof'),
							u = t('backo2');
						function _(t, e) {
							if (!(this instanceof _)) return new _(t, e);
							t &&
								'object' == typeof t &&
								((e = t), (t = void 0)),
								((e = e || {}).path = e.path || '/socket.io'),
								(this.nsps = {}),
								(this.subs = []),
								(this.opts = e),
								this.reconnection(!1 !== e.reconnection),
								this.reconnectionAttempts(
									e.reconnectionAttempts || 1 / 0
								),
								this.reconnectionDelay(
									e.reconnectionDelay || 1e3
								),
								this.reconnectionDelayMax(
									e.reconnectionDelayMax || 5e3
								),
								this.randomizationFactor(
									e.randomizationFactor || 0.5
								),
								(this.backoff = new u({
									min: this.reconnectionDelay(),
									max: this.reconnectionDelayMax(),
									jitter: this.randomizationFactor(),
								})),
								this.timeout(
									null == e.timeout ? 2e4 : e.timeout
								),
								(this.readyState = 'closed'),
								(this.uri = t),
								(this.connected = []),
								(this.encoding = !1),
								(this.packetBuffer = []),
								(this.encoder = new o.Encoder()),
								(this.decoder = new o.Decoder()),
								(this.autoConnect = !1 !== e.autoConnect),
								this.autoConnect && this.open();
						}
						((e.exports = _).prototype.emitAll = function () {
							for (var t in (this.emit.apply(this, arguments),
							this.nsps))
								this.nsps[t].emit.apply(
									this.nsps[t],
									arguments
								);
						}),
							(_.prototype.updateSocketIds = function () {
								for (var t in this.nsps)
									this.nsps[t].id = this.engine.id;
							}),
							r(_.prototype),
							(_.prototype.reconnection = function (t) {
								return arguments.length
									? ((this._reconnection = !!t), this)
									: this._reconnection;
							}),
							(_.prototype.reconnectionAttempts = function (t) {
								return arguments.length
									? ((this._reconnectionAttempts = t), this)
									: this._reconnectionAttempts;
							}),
							(_.prototype.reconnectionDelay = function (t) {
								return arguments.length
									? ((this._reconnectionDelay = t),
									  this.backoff && this.backoff.setMin(t),
									  this)
									: this._reconnectionDelay;
							}),
							(_.prototype.randomizationFactor = function (t) {
								return arguments.length
									? ((this._randomizationFactor = t),
									  this.backoff && this.backoff.setJitter(t),
									  this)
									: this._randomizationFactor;
							}),
							(_.prototype.reconnectionDelayMax = function (t) {
								return arguments.length
									? ((this._reconnectionDelayMax = t),
									  this.backoff && this.backoff.setMax(t),
									  this)
									: this._reconnectionDelayMax;
							}),
							(_.prototype.timeout = function (t) {
								return arguments.length
									? ((this._timeout = t), this)
									: this._timeout;
							}),
							(_.prototype.maybeReconnectOnOpen = function () {
								!this.reconnecting &&
									this._reconnection &&
									0 === this.backoff.attempts &&
									this.reconnect();
							}),
							(_.prototype.open = _.prototype.connect =
								function (i) {
									if (
										(l('readyState %s', this.readyState),
										~this.readyState.indexOf('open'))
									)
										return this;
									l('opening %s', this.uri),
										(this.engine = c(this.uri, this.opts));
									var t = this.engine,
										n = this;
									(this.readyState = 'opening'),
										(this.skipReconnect = !1);
									var e,
										r,
										o = a(t, 'open', function () {
											n.onopen(), i && i();
										}),
										s = a(t, 'error', function (t) {
											var e;
											l('connect_error'),
												n.cleanup(),
												(n.readyState = 'closed'),
												n.emitAll('connect_error', t),
												i
													? (((e = new Error(
															'Connection error'
													  )).data = t),
													  i(e))
													: n.maybeReconnectOnOpen();
										});
									return (
										!1 !== this._timeout &&
											((e = this._timeout),
											l(
												'connect attempt will timeout after %d',
												e
											),
											(r = setTimeout(function () {
												l(
													'connect attempt timed out after %d',
													e
												),
													o.destroy(),
													t.close(),
													t.emit('error', 'timeout'),
													n.emitAll(
														'connect_timeout',
														e
													);
											}, e)),
											this.subs.push({
												destroy: function () {
													clearTimeout(r);
												},
											})),
										this.subs.push(o),
										this.subs.push(s),
										this
									);
								}),
							(_.prototype.onopen = function () {
								l('open'),
									this.cleanup(),
									(this.readyState = 'open'),
									this.emit('open');
								var t = this.engine;
								this.subs.push(a(t, 'data', s(this, 'ondata'))),
									this.subs.push(
										a(
											this.decoder,
											'decoded',
											s(this, 'ondecoded')
										)
									),
									this.subs.push(
										a(t, 'error', s(this, 'onerror'))
									),
									this.subs.push(
										a(t, 'close', s(this, 'onclose'))
									);
							}),
							(_.prototype.ondata = function (t) {
								this.decoder.add(t);
							}),
							(_.prototype.ondecoded = function (t) {
								this.emit('packet', t);
							}),
							(_.prototype.onerror = function (t) {
								l('error', t), this.emitAll('error', t);
							}),
							(_.prototype.socket = function (t) {
								var e,
									i = this.nsps[t];
								return (
									i ||
										((i = new n(this, t)),
										(this.nsps[t] = i),
										(e = this),
										i.on('connect', function () {
											(i.id = e.engine.id),
												~h(e.connected, i) ||
													e.connected.push(i);
										})),
									i
								);
							}),
							(_.prototype.destroy = function (t) {
								t = h(this.connected, t);
								~t && this.connected.splice(t, 1),
									this.connected.length || this.close();
							}),
							(_.prototype.packet = function (t) {
								l('writing packet %j', t);
								var i = this;
								i.encoding
									? i.packetBuffer.push(t)
									: ((i.encoding = !0),
									  this.encoder.encode(t, function (t) {
											for (var e = 0; e < t.length; e++)
												i.engine.write(t[e]);
											(i.encoding = !1),
												i.processPacketQueue();
									  }));
							}),
							(_.prototype.processPacketQueue = function () {
								var t;
								0 < this.packetBuffer.length &&
									!this.encoding &&
									((t = this.packetBuffer.shift()),
									this.packet(t));
							}),
							(_.prototype.cleanup = function () {
								for (var t; (t = this.subs.shift()); )
									t.destroy();
								(this.packetBuffer = []),
									(this.encoding = !1),
									this.decoder.destroy();
							}),
							(_.prototype.close = _.prototype.disconnect =
								function () {
									(this.skipReconnect = !0),
										this.backoff.reset(),
										(this.readyState = 'closed'),
										this.engine && this.engine.close();
								}),
							(_.prototype.onclose = function (t) {
								l('close'),
									this.cleanup(),
									this.backoff.reset(),
									(this.readyState = 'closed'),
									this.emit('close', t),
									this._reconnection &&
										!this.skipReconnect &&
										this.reconnect();
							}),
							(_.prototype.reconnect = function () {
								if (this.reconnecting || this.skipReconnect)
									return this;
								var t,
									e,
									i = this;
								this.backoff.attempts >=
								this._reconnectionAttempts
									? (l('reconnect failed'),
									  this.backoff.reset(),
									  this.emitAll('reconnect_failed'),
									  (this.reconnecting = !1))
									: ((t = this.backoff.duration()),
									  l(
											'will wait %dms before reconnect attempt',
											t
									  ),
									  (this.reconnecting = !0),
									  (e = setTimeout(function () {
											i.skipReconnect ||
												(l('attempting reconnect'),
												i.emitAll(
													'reconnect_attempt',
													i.backoff.attempts
												),
												i.emitAll(
													'reconnecting',
													i.backoff.attempts
												),
												i.skipReconnect ||
													i.open(function (t) {
														t
															? (l(
																	'reconnect attempt error'
															  ),
															  (i.reconnecting =
																	!1),
															  i.reconnect(),
															  i.emitAll(
																	'reconnect_error',
																	t.data
															  ))
															: (l(
																	'reconnect success'
															  ),
															  i.onreconnect());
													}));
									  }, t)),
									  this.subs.push({
											destroy: function () {
												clearTimeout(e);
											},
									  }));
							}),
							(_.prototype.onreconnect = function () {
								var t = this.backoff.attempts;
								(this.reconnecting = !1),
									this.backoff.reset(),
									this.updateSocketIds(),
									this.emitAll('reconnect', t);
							});
					},
					{
						'./on': 4,
						'./socket': 5,
						'./url': 6,
						backo2: 7,
						'component-bind': 8,
						'component-emitter': 9,
						debug: 10,
						'engine.io-client': 11,
						indexof: 42,
						'object-component': 43,
						'socket.io-parser': 46,
					},
				],
				4: [
					function (t, e, i) {
						e.exports = function (t, e, i) {
							return (
								t.on(e, i),
								{
									destroy: function () {
										t.removeListener(e, i);
									},
								}
							);
						};
					},
					{},
				],
				5: [
					function (t, e, i) {
						var o = t('socket.io-parser'),
							n = t('component-emitter'),
							s = t('to-array'),
							r = t('./on'),
							c = t('component-bind'),
							a = t('debug')('socket.io-client:socket'),
							l = t('has-binary');
						e.exports = _;
						var h = {
								connect: 1,
								connect_error: 1,
								connect_timeout: 1,
								disconnect: 1,
								error: 1,
								reconnect: 1,
								reconnect_attempt: 1,
								reconnect_failed: 1,
								reconnect_error: 1,
								reconnecting: 1,
							},
							u = n.prototype.emit;
						function _(t, e) {
							(this.io = t),
								(this.nsp = e),
								((this.json = this).ids = 0),
								(this.acks = {}),
								this.io.autoConnect && this.open(),
								(this.receiveBuffer = []),
								(this.sendBuffer = []),
								(this.connected = !1),
								(this.disconnected = !0);
						}
						n(_.prototype),
							(_.prototype.subEvents = function () {
								var t;
								this.subs ||
									((t = this.io),
									(this.subs = [
										r(t, 'open', c(this, 'onopen')),
										r(t, 'packet', c(this, 'onpacket')),
										r(t, 'close', c(this, 'onclose')),
									]));
							}),
							(_.prototype.open = _.prototype.connect =
								function () {
									return (
										this.connected ||
											(this.subEvents(),
											this.io.open(),
											'open' == this.io.readyState &&
												this.onopen()),
										this
									);
								}),
							(_.prototype.send = function () {
								var t = s(arguments);
								return (
									t.unshift('message'),
									this.emit.apply(this, t),
									this
								);
							}),
							(_.prototype.emit = function (t) {
								if (h.hasOwnProperty(t))
									return u.apply(this, arguments), this;
								var e = s(arguments),
									i = o.EVENT;
								l(e) && (i = o.BINARY_EVENT);
								i = { type: i, data: e };
								return (
									'function' == typeof e[e.length - 1] &&
										(a(
											'emitting packet with ack id %d',
											this.ids
										),
										(this.acks[this.ids] = e.pop()),
										(i.id = this.ids++)),
									this.connected
										? this.packet(i)
										: this.sendBuffer.push(i),
									this
								);
							}),
							(_.prototype.packet = function (t) {
								(t.nsp = this.nsp), this.io.packet(t);
							}),
							(_.prototype.onopen = function () {
								a('transport is open - connecting'),
									'/' != this.nsp &&
										this.packet({ type: o.CONNECT });
							}),
							(_.prototype.onclose = function (t) {
								a('close (%s)', t),
									(this.connected = !1),
									(this.disconnected = !0),
									delete this.id,
									this.emit('disconnect', t);
							}),
							(_.prototype.onpacket = function (t) {
								if (t.nsp == this.nsp)
									switch (t.type) {
										case o.CONNECT:
											this.onconnect();
											break;
										case o.EVENT:
										case o.BINARY_EVENT:
											this.onevent(t);
											break;
										case o.ACK:
										case o.BINARY_ACK:
											this.onack(t);
											break;
										case o.DISCONNECT:
											this.ondisconnect();
											break;
										case o.ERROR:
											this.emit('error', t.data);
									}
							}),
							(_.prototype.onevent = function (t) {
								var e = t.data || [];
								a('emitting event %j', e),
									null != t.id &&
										(a('attaching ack callback to event'),
										e.push(this.ack(t.id))),
									this.connected
										? u.apply(this, e)
										: this.receiveBuffer.push(e);
							}),
							(_.prototype.ack = function (i) {
								var n = this,
									r = !1;
								return function () {
									var t, e;
									r ||
										((r = !0),
										(t = s(arguments)),
										a('sending ack %j', t),
										(e = l(t) ? o.BINARY_ACK : o.ACK),
										n.packet({ type: e, id: i, data: t }));
								};
							}),
							(_.prototype.onack = function (t) {
								a('calling ack %s with %j', t.id, t.data),
									this.acks[t.id].apply(this, t.data),
									delete this.acks[t.id];
							}),
							(_.prototype.onconnect = function () {
								(this.connected = !0),
									(this.disconnected = !1),
									this.emit('connect'),
									this.emitBuffered();
							}),
							(_.prototype.emitBuffered = function () {
								for (
									var t = 0;
									t < this.receiveBuffer.length;
									t++
								)
									u.apply(this, this.receiveBuffer[t]);
								for (
									this.receiveBuffer = [], t = 0;
									t < this.sendBuffer.length;
									t++
								)
									this.packet(this.sendBuffer[t]);
								this.sendBuffer = [];
							}),
							(_.prototype.ondisconnect = function () {
								a('server disconnect (%s)', this.nsp),
									this.destroy(),
									this.onclose('io server disconnect');
							}),
							(_.prototype.destroy = function () {
								if (this.subs) {
									for (var t = 0; t < this.subs.length; t++)
										this.subs[t].destroy();
									this.subs = null;
								}
								this.io.destroy(this);
							}),
							(_.prototype.close = _.prototype.disconnect =
								function () {
									return (
										this.connected &&
											(a(
												'performing disconnect (%s)',
												this.nsp
											),
											this.packet({
												type: o.DISCONNECT,
											})),
										this.destroy(),
										this.connected &&
											this.onclose(
												'io client disconnect'
											),
										this
									);
								});
					},
					{
						'./on': 4,
						'component-bind': 8,
						'component-emitter': 9,
						debug: 10,
						'has-binary': 38,
						'socket.io-parser': 46,
						'to-array': 50,
					},
				],
				6: [
					function (t, e, i) {
						(function (n) {
							var r = t('parseuri'),
								o = t('debug')('socket.io-client:url');
							e.exports = function (t, e) {
								var i = t,
									e = e || n.location;
								null == t && (t = e.protocol + '//' + e.host);
								'string' == typeof t &&
									('/' == t.charAt(0) &&
										(t =
											'/' == t.charAt(1)
												? e.protocol + t
												: e.hostname + t),
									/^(https?|wss?):\/\//.test(t) ||
										(o('protocol-less url %s', t),
										(t =
											void 0 !== e
												? e.protocol + '//' + t
												: 'https://' + t)),
									o('parse %s', t),
									(i = r(t)));
								i.port ||
									(/^(http|ws)$/.test(i.protocol)
										? (i.port = '80')
										: /^(http|ws)s$/.test(i.protocol) &&
										  (i.port = '443'));
								return (
									(i.path = i.path || '/'),
									(i.id =
										i.protocol +
										'://' +
										i.host +
										':' +
										i.port),
									(i.href =
										i.protocol +
										'://' +
										i.host +
										(e && e.port == i.port
											? ''
											: ':' + i.port)),
									i
								);
							};
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{ debug: 10, parseuri: 44 },
				],
				7: [
					function (t, e, i) {
						function n(t) {
							(t = t || {}),
								(this.ms = t.min || 100),
								(this.max = t.max || 1e4),
								(this.factor = t.factor || 2),
								(this.jitter =
									0 < t.jitter && t.jitter <= 1
										? t.jitter
										: 0),
								(this.attempts = 0);
						}
						((e.exports = n).prototype.duration = function () {
							var t,
								e,
								i =
									this.ms *
									Math.pow(this.factor, this.attempts++);
							return (
								this.jitter &&
									((t = Math.random()),
									(e = Math.floor(t * this.jitter * i)),
									(i =
										0 == (1 & Math.floor(10 * t))
											? i - e
											: i + e)),
								0 | Math.min(i, this.max)
							);
						}),
							(n.prototype.reset = function () {
								this.attempts = 0;
							}),
							(n.prototype.setMin = function (t) {
								this.ms = t;
							}),
							(n.prototype.setMax = function (t) {
								this.max = t;
							}),
							(n.prototype.setJitter = function (t) {
								this.jitter = t;
							});
					},
					{},
				],
				8: [
					function (t, e, i) {
						var n = [].slice;
						e.exports = function (t, e) {
							if (
								('string' == typeof e && (e = t[e]),
								'function' != typeof e)
							)
								throw new Error('bind() requires a function');
							var i = n.call(arguments, 2);
							return function () {
								return e.apply(t, i.concat(n.call(arguments)));
							};
						};
					},
					{},
				],
				9: [
					function (t, e, i) {
						function n(t) {
							if (t)
								return (function (t) {
									for (var e in n.prototype)
										t[e] = n.prototype[e];
									return t;
								})(t);
						}
						((e.exports = n).prototype.on =
							n.prototype.addEventListener =
								function (t, e) {
									return (
										(this._callbacks =
											this._callbacks || {}),
										(this._callbacks[t] =
											this._callbacks[t] || []).push(e),
										this
									);
								}),
							(n.prototype.once = function (t, e) {
								var i = this;
								function n() {
									i.off(t, n), e.apply(this, arguments);
								}
								return (
									(this._callbacks = this._callbacks || {}),
									(n.fn = e),
									this.on(t, n),
									this
								);
							}),
							(n.prototype.off =
								n.prototype.removeListener =
								n.prototype.removeAllListeners =
								n.prototype.removeEventListener =
									function (t, e) {
										if (
											((this._callbacks =
												this._callbacks || {}),
											0 == arguments.length)
										)
											return (this._callbacks = {}), this;
										var i,
											n = this._callbacks[t];
										if (!n) return this;
										if (1 == arguments.length)
											return (
												delete this._callbacks[t], this
											);
										for (var r = 0; r < n.length; r++)
											if (
												(i = n[r]) === e ||
												i.fn === e
											) {
												n.splice(r, 1);
												break;
											}
										return this;
									}),
							(n.prototype.emit = function (t) {
								this._callbacks = this._callbacks || {};
								var e = [].slice.call(arguments, 1),
									i = this._callbacks[t];
								if (i)
									for (
										var n = 0, r = (i = i.slice(0)).length;
										n < r;
										++n
									)
										i[n].apply(this, e);
								return this;
							}),
							(n.prototype.listeners = function (t) {
								return (
									(this._callbacks = this._callbacks || {}),
									this._callbacks[t] || []
								);
							}),
							(n.prototype.hasListeners = function (t) {
								return !!this.listeners(t).length;
							});
					},
					{},
				],
				10: [
					function (t, e, i) {
						function r(n) {
							return r.enabled(n)
								? function (t) {
										t =
											(i = t) instanceof Error
												? i.stack || i.message
												: i;
										var e = new Date(),
											i = e - (r[n] || e);
										(r[n] = e),
											(t =
												n +
												' ' +
												t +
												' +' +
												r.humanize(i)),
											window.console &&
												console.log &&
												Function.prototype.apply.call(
													console.log,
													console,
													arguments
												);
								  }
								: function () {};
						}
						((e.exports = r).names = []),
							(r.skips = []),
							(r.enable = function (t) {
								try {
									localStorage.debug = t;
								} catch (t) {}
								for (
									var e = (t || '').split(/[\s,]+/),
										i = e.length,
										n = 0;
									n < i;
									n++
								)
									'-' === (t = e[n].replace('*', '.*?'))[0]
										? r.skips.push(
												new RegExp(
													'^' + t.substr(1) + '$'
												)
										  )
										: r.names.push(
												new RegExp('^' + t + '$')
										  );
							}),
							(r.disable = function () {
								r.enable('');
							}),
							(r.humanize = function (t) {
								return 36e5 <= t
									? (t / 36e5).toFixed(1) + 'h'
									: 6e4 <= t
									? (t / 6e4).toFixed(1) + 'm'
									: 1e3 <= t
									? ((t / 1e3) | 0) + 's'
									: t + 'ms';
							}),
							(r.enabled = function (t) {
								for (var e = 0, i = r.skips.length; e < i; e++)
									if (r.skips[e].test(t)) return !1;
								for (e = 0, i = r.names.length; e < i; e++)
									if (r.names[e].test(t)) return !0;
								return !1;
							});
						try {
							window.localStorage && r.enable(localStorage.debug);
						} catch (t) {}
					},
					{},
				],
				11: [
					function (t, e, i) {
						e.exports = t('./lib/');
					},
					{ './lib/': 12 },
				],
				12: [
					function (t, e, i) {
						(e.exports = t('./socket')),
							(e.exports.parser = t('engine.io-parser'));
					},
					{ './socket': 13, 'engine.io-parser': 25 },
				],
				13: [
					function (e, l, t) {
						(function (i) {
							var n = e('./transports'),
								t = e('component-emitter'),
								u = e('debug')('engine.io-client:socket'),
								r = e('indexof'),
								o = e('engine.io-parser'),
								s = e('parseuri'),
								c = e('parsejson'),
								a = e('parseqs');
							function _(t, e) {
								if (!(this instanceof _)) return new _(t, e);
								(e = e || {}),
									t &&
										'object' == typeof t &&
										((e = t), (t = null)),
									t &&
										((t = s(t)),
										(e.host = t.host),
										(e.secure =
											'https' == t.protocol ||
											'wss' == t.protocol),
										(e.port = t.port),
										t.query && (e.query = t.query)),
									(this.secure =
										null != e.secure
											? e.secure
											: i.location &&
											  'https:' == location.protocol),
									e.host &&
										((t = e.host.split(':')),
										(e.hostname = t.shift()),
										t.length
											? (e.port = t.pop())
											: e.port ||
											  (e.port = this.secure
													? '443'
													: '80')),
									(this.agent = e.agent || !1),
									(this.hostname =
										e.hostname ||
										(i.location
											? location.hostname
											: 'localhost')),
									(this.port =
										e.port ||
										(i.location && location.port
											? location.port
											: this.secure
											? 443
											: 80)),
									(this.query = e.query || {}),
									'string' == typeof this.query &&
										(this.query = a.decode(this.query)),
									(this.upgrade = !1 !== e.upgrade),
									(this.path =
										(e.path || '/engine.io').replace(
											/\/$/,
											''
										) + '/'),
									(this.forceJSONP = !!e.forceJSONP),
									(this.jsonp = !1 !== e.jsonp),
									(this.forceBase64 = !!e.forceBase64),
									(this.enablesXDR = !!e.enablesXDR),
									(this.timestampParam =
										e.timestampParam || 't'),
									(this.timestampRequests =
										e.timestampRequests),
									(this.transports = e.transports || [
										'polling',
										'websocket',
									]),
									(this.readyState = ''),
									(this.writeBuffer = []),
									(this.callbackBuffer = []),
									(this.policyPort = e.policyPort || 843),
									(this.rememberUpgrade =
										e.rememberUpgrade || !1),
									(this.binaryType = null),
									(this.onlyBinaryUpgrades =
										e.onlyBinaryUpgrades),
									(this.pfx = e.pfx || null),
									(this.key = e.key || null),
									(this.passphrase = e.passphrase || null),
									(this.cert = e.cert || null),
									(this.ca = e.ca || null),
									(this.ciphers = e.ciphers || null),
									(this.rejectUnauthorized =
										e.rejectUnauthorized || null),
									this.open();
							}
							((l.exports = _).priorWebsocketSuccess = !1),
								t(_.prototype),
								(_.protocol = o.protocol),
								((_.Socket = _).Transport = e('./transport')),
								(_.transports = e('./transports')),
								(_.parser = e('engine.io-parser')),
								(_.prototype.createTransport = function (t) {
									u('creating transport "%s"', t);
									var e = (function (t) {
										var e,
											i = {};
										for (e in t)
											t.hasOwnProperty(e) &&
												(i[e] = t[e]);
										return i;
									})(this.query);
									return (
										(e.EIO = o.protocol),
										(e.transport = t),
										this.id && (e.sid = this.id),
										new n[t]({
											agent: this.agent,
											hostname: this.hostname,
											port: this.port,
											secure: this.secure,
											path: this.path,
											query: e,
											forceJSONP: this.forceJSONP,
											jsonp: this.jsonp,
											forceBase64: this.forceBase64,
											enablesXDR: this.enablesXDR,
											timestampRequests:
												this.timestampRequests,
											timestampParam: this.timestampParam,
											policyPort: this.policyPort,
											socket: this,
											pfx: this.pfx,
											key: this.key,
											passphrase: this.passphrase,
											cert: this.cert,
											ca: this.ca,
											ciphers: this.ciphers,
											rejectUnauthorized:
												this.rejectUnauthorized,
										})
									);
								}),
								(_.prototype.open = function () {
									var t;
									if (
										this.rememberUpgrade &&
										_.priorWebsocketSuccess &&
										-1 !=
											this.transports.indexOf('websocket')
									)
										t = 'websocket';
									else {
										if (0 == this.transports.length) {
											var e = this;
											return void setTimeout(function () {
												e.emit(
													'error',
													'No transports available'
												);
											}, 0);
										}
										t = this.transports[0];
									}
									this.readyState = 'opening';
									try {
										t = this.createTransport(t);
									} catch (t) {
										return (
											this.transports.shift(),
											void this.open()
										);
									}
									t.open(), this.setTransport(t);
								}),
								(_.prototype.setTransport = function (t) {
									u('setting transport %s', t.name);
									var e = this;
									this.transport &&
										(u(
											'clearing existing transport %s',
											this.transport.name
										),
										this.transport.removeAllListeners()),
										(this.transport = t)
											.on('drain', function () {
												e.onDrain();
											})
											.on('packet', function (t) {
												e.onPacket(t);
											})
											.on('error', function (t) {
												e.onError(t);
											})
											.on('close', function () {
												e.onClose('transport close');
											});
								}),
								(_.prototype.probe = function (i) {
									u('probing transport "%s"', i);
									var n = this.createTransport(i, {
											probe: 1,
										}),
										e = !1,
										r = this;
									function t() {
										var t;
										r.onlyBinaryUpgrades &&
											((t =
												!this.supportsBinary &&
												r.transport.supportsBinary),
											(e = e || t)),
											e ||
												(u(
													'probe transport "%s" opened',
													i
												),
												n.send([
													{
														type: 'ping',
														data: 'probe',
													},
												]),
												n.once('packet', function (t) {
													e ||
														('pong' == t.type &&
														'probe' == t.data
															? (u(
																	'probe transport "%s" pong',
																	i
															  ),
															  (r.upgrading =
																	!0),
															  r.emit(
																	'upgrading',
																	n
															  ),
															  n &&
																	((_.priorWebsocketSuccess =
																		'websocket' ==
																		n.name),
																	u(
																		'pausing current transport "%s"',
																		r
																			.transport
																			.name
																	),
																	r.transport.pause(
																		function () {
																			e ||
																				('closed' !=
																					r.readyState &&
																					(u(
																						'changing transport and sending upgrade packet'
																					),
																					h(),
																					r.setTransport(
																						n
																					),
																					n.send(
																						[
																							{
																								type: 'upgrade',
																							},
																						]
																					),
																					r.emit(
																						'upgrade',
																						n
																					),
																					(n =
																						null),
																					(r.upgrading =
																						!1),
																					r.flush()));
																		}
																	)))
															: (u(
																	'probe transport "%s" failed',
																	i
															  ),
															  ((t = new Error(
																	'probe error'
															  )).transport =
																	n.name),
															  r.emit(
																	'upgradeError',
																	t
															  )));
												}));
									}
									function o() {
										e ||
											((e = !0),
											h(),
											n.close(),
											(n = null));
									}
									function s(t) {
										var e = new Error('probe error: ' + t);
										(e.transport = n.name),
											o(),
											u(
												'probe transport "%s" failed because of error: %s',
												i,
												t
											),
											r.emit('upgradeError', e);
									}
									function c() {
										s('transport closed');
									}
									function a() {
										s('socket closed');
									}
									function l(t) {
										n &&
											t.name != n.name &&
											(u(
												'"%s" works - aborting "%s"',
												t.name,
												n.name
											),
											o());
									}
									function h() {
										n.removeListener('open', t),
											n.removeListener('error', s),
											n.removeListener('close', c),
											r.removeListener('close', a),
											r.removeListener('upgrading', l);
									}
									(_.priorWebsocketSuccess = !1),
										n.once('open', t),
										n.once('error', s),
										n.once('close', c),
										this.once('close', a),
										this.once('upgrading', l),
										n.open();
								}),
								(_.prototype.onOpen = function () {
									if (
										(u('socket open'),
										(this.readyState = 'open'),
										(_.priorWebsocketSuccess =
											'websocket' == this.transport.name),
										this.emit('open'),
										this.flush(),
										'open' == this.readyState &&
											this.upgrade &&
											this.transport.pause)
									) {
										u('starting upgrade probes');
										for (
											var t = 0, e = this.upgrades.length;
											t < e;
											t++
										)
											this.probe(this.upgrades[t]);
									}
								}),
								(_.prototype.onPacket = function (t) {
									if (
										'opening' == this.readyState ||
										'open' == this.readyState
									)
										switch (
											(u(
												'socket receive: type "%s", data "%s"',
												t.type,
												t.data
											),
											this.emit('packet', t),
											this.emit('heartbeat'),
											t.type)
										) {
											case 'open':
												this.onHandshake(c(t.data));
												break;
											case 'pong':
												this.setPing();
												break;
											case 'error':
												var e = new Error(
													'server error'
												);
												(e.code = t.data),
													this.emit('error', e);
												break;
											case 'message':
												this.emit('data', t.data),
													this.emit(
														'message',
														t.data
													);
										}
									else
										u(
											'packet received with socket readyState "%s"',
											this.readyState
										);
								}),
								(_.prototype.onHandshake = function (t) {
									this.emit('handshake', t),
										(this.id = t.sid),
										(this.transport.query.sid = t.sid),
										(this.upgrades = this.filterUpgrades(
											t.upgrades
										)),
										(this.pingInterval = t.pingInterval),
										(this.pingTimeout = t.pingTimeout),
										this.onOpen(),
										'closed' != this.readyState &&
											(this.setPing(),
											this.removeListener(
												'heartbeat',
												this.onHeartbeat
											),
											this.on(
												'heartbeat',
												this.onHeartbeat
											));
								}),
								(_.prototype.onHeartbeat = function (t) {
									clearTimeout(this.pingTimeoutTimer);
									var e = this;
									e.pingTimeoutTimer = setTimeout(
										function () {
											'closed' != e.readyState &&
												e.onClose('ping timeout');
										},
										t || e.pingInterval + e.pingTimeout
									);
								}),
								(_.prototype.setPing = function () {
									var t = this;
									clearTimeout(t.pingIntervalTimer),
										(t.pingIntervalTimer = setTimeout(
											function () {
												u(
													'writing ping packet - expecting pong within %sms',
													t.pingTimeout
												),
													t.ping(),
													t.onHeartbeat(
														t.pingTimeout
													);
											},
											t.pingInterval
										));
								}),
								(_.prototype.ping = function () {
									this.sendPacket('ping');
								}),
								(_.prototype.onDrain = function () {
									for (var t = 0; t < this.prevBufferLen; t++)
										this.callbackBuffer[t] &&
											this.callbackBuffer[t]();
									this.writeBuffer.splice(
										0,
										this.prevBufferLen
									),
										this.callbackBuffer.splice(
											0,
											this.prevBufferLen
										),
										(this.prevBufferLen = 0) ==
										this.writeBuffer.length
											? this.emit('drain')
											: this.flush();
								}),
								(_.prototype.flush = function () {
									'closed' != this.readyState &&
										this.transport.writable &&
										!this.upgrading &&
										this.writeBuffer.length &&
										(u(
											'flushing %d packets in socket',
											this.writeBuffer.length
										),
										this.transport.send(this.writeBuffer),
										(this.prevBufferLen =
											this.writeBuffer.length),
										this.emit('flush'));
								}),
								(_.prototype.write = _.prototype.send =
									function (t, e) {
										return (
											this.sendPacket('message', t, e),
											this
										);
									}),
								(_.prototype.sendPacket = function (t, e, i) {
									'closing' != this.readyState &&
										'closed' != this.readyState &&
										((e = { type: t, data: e }),
										this.emit('packetCreate', e),
										this.writeBuffer.push(e),
										this.callbackBuffer.push(i),
										this.flush());
								}),
								(_.prototype.close = function () {
									function t() {
										n.onClose('forced close'),
											u(
												'socket closing - telling transport to close'
											),
											n.transport.close();
									}
									function e() {
										n.removeListener('upgrade', e),
											n.removeListener('upgradeError', e),
											t();
									}
									function i() {
										n.once('upgrade', e),
											n.once('upgradeError', e);
									}
									var n;
									return (
										('opening' != this.readyState &&
											'open' != this.readyState) ||
											((this.readyState = 'closing'),
											(n = this).writeBuffer.length
												? this.once(
														'drain',
														function () {
															(this.upgrading
																? i
																: t)();
														}
												  )
												: (this.upgrading ? i : t)()),
										this
									);
								}),
								(_.prototype.onError = function (t) {
									u('socket error %j', t),
										(_.priorWebsocketSuccess = !1),
										this.emit('error', t),
										this.onClose('transport error', t);
								}),
								(_.prototype.onClose = function (t, e) {
									var i;
									('opening' != this.readyState &&
										'open' != this.readyState &&
										'closing' != this.readyState) ||
										(u('socket close with reason: "%s"', t),
										(i = this),
										clearTimeout(this.pingIntervalTimer),
										clearTimeout(this.pingTimeoutTimer),
										setTimeout(function () {
											(i.writeBuffer = []),
												(i.callbackBuffer = []),
												(i.prevBufferLen = 0);
										}, 0),
										this.transport.removeAllListeners(
											'close'
										),
										this.transport.close(),
										this.transport.removeAllListeners(),
										(this.readyState = 'closed'),
										(this.id = null),
										this.emit('close', t, e));
								}),
								(_.prototype.filterUpgrades = function (t) {
									for (
										var e = [], i = 0, n = t.length;
										i < n;
										i++
									)
										~r(this.transports, t[i]) &&
											e.push(t[i]);
									return e;
								});
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{
						'./transport': 14,
						'./transports': 15,
						'component-emitter': 9,
						debug: 22,
						'engine.io-parser': 25,
						indexof: 42,
						parsejson: 34,
						parseqs: 35,
						parseuri: 36,
					},
				],
				14: [
					function (t, e, i) {
						var n = t('engine.io-parser');
						function r(t) {
							(this.path = t.path),
								(this.hostname = t.hostname),
								(this.port = t.port),
								(this.secure = t.secure),
								(this.query = t.query),
								(this.timestampParam = t.timestampParam),
								(this.timestampRequests = t.timestampRequests),
								(this.readyState = ''),
								(this.agent = t.agent || !1),
								(this.socket = t.socket),
								(this.enablesXDR = t.enablesXDR),
								(this.pfx = t.pfx),
								(this.key = t.key),
								(this.passphrase = t.passphrase),
								(this.cert = t.cert),
								(this.ca = t.ca),
								(this.ciphers = t.ciphers),
								(this.rejectUnauthorized =
									t.rejectUnauthorized);
						}
						t('component-emitter')((e.exports = r).prototype),
							(r.timestamps = 0),
							(r.prototype.onError = function (t, e) {
								t = new Error(t);
								return (
									(t.type = 'TransportError'),
									(t.description = e),
									this.emit('error', t),
									this
								);
							}),
							(r.prototype.open = function () {
								return (
									('closed' != this.readyState &&
										'' != this.readyState) ||
										((this.readyState = 'opening'),
										this.doOpen()),
									this
								);
							}),
							(r.prototype.close = function () {
								return (
									('opening' != this.readyState &&
										'open' != this.readyState) ||
										(this.doClose(), this.onClose()),
									this
								);
							}),
							(r.prototype.send = function (t) {
								if ('open' != this.readyState)
									throw new Error('Transport not open');
								this.write(t);
							}),
							(r.prototype.onOpen = function () {
								(this.readyState = 'open'),
									(this.writable = !0),
									this.emit('open');
							}),
							(r.prototype.onData = function (t) {
								t = n.decodePacket(t, this.socket.binaryType);
								this.onPacket(t);
							}),
							(r.prototype.onPacket = function (t) {
								this.emit('packet', t);
							}),
							(r.prototype.onClose = function () {
								(this.readyState = 'closed'),
									this.emit('close');
							});
					},
					{ 'component-emitter': 9, 'engine.io-parser': 25 },
				],
				15: [
					function (e, t, i) {
						(function (s) {
							var c = e('xmlhttprequest'),
								a = e('./polling-xhr'),
								l = e('./polling-jsonp'),
								t = e('./websocket');
							(i.polling = function (t) {
								var e = !1,
									i = !1,
									n = !1 !== t.jsonp;
								{
									var r, o;
									s.location &&
										((r = 'https:' == location.protocol),
										(o =
											(o = location.port) ||
											(r ? 443 : 80)),
										(e =
											t.hostname != location.hostname ||
											o != t.port),
										(i = t.secure != r));
								}
								{
									if (
										((t.xdomain = e),
										(t.xscheme = i),
										'open' in new c(t) && !t.forceJSONP)
									)
										return new a(t);
									if (!n) throw new Error('JSONP disabled');
									return new l(t);
								}
							}),
								(i.websocket = t);
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{
						'./polling-jsonp': 16,
						'./polling-xhr': 17,
						'./websocket': 19,
						xmlhttprequest: 20,
					},
				],
				16: [
					function (s, c, t) {
						(function (i) {
							var n = s('./polling'),
								t = s('component-inherit');
							c.exports = e;
							var r,
								l = /\n/g,
								h = /\\n/g;
							function o() {}
							function e(t) {
								n.call(this, t),
									(this.query = this.query || {}),
									r ||
										(i.___eio || (i.___eio = []),
										(r = i.___eio)),
									(this.index = r.length);
								var e = this;
								r.push(function (t) {
									e.onData(t);
								}),
									(this.query.j = this.index),
									i.document &&
										i.addEventListener &&
										i.addEventListener(
											'beforeunload',
											function () {
												e.script &&
													(e.script.onerror = o);
											},
											!1
										);
							}
							t(e, n),
								(e.prototype.supportsBinary = !1),
								(e.prototype.doClose = function () {
									this.script &&
										(this.script.parentNode.removeChild(
											this.script
										),
										(this.script = null)),
										this.form &&
											(this.form.parentNode.removeChild(
												this.form
											),
											(this.form = null),
											(this.iframe = null)),
										n.prototype.doClose.call(this);
								}),
								(e.prototype.doPoll = function () {
									var e = this,
										t = document.createElement('script');
									this.script &&
										(this.script.parentNode.removeChild(
											this.script
										),
										(this.script = null)),
										(t.async = !0),
										(t.src = this.uri()),
										(t.onerror = function (t) {
											e.onError('jsonp poll error', t);
										});
									var i =
										document.getElementsByTagName(
											'script'
										)[0];
									i.parentNode.insertBefore(t, i),
										(this.script = t),
										'undefined' != typeof navigator &&
											/gecko/i.test(
												navigator.userAgent
											) &&
											setTimeout(function () {
												var t =
													document.createElement(
														'iframe'
													);
												document.body.appendChild(t),
													document.body.removeChild(
														t
													);
											}, 100);
								}),
								(e.prototype.doWrite = function (t, e) {
									var i,
										n,
										r,
										o,
										s = this;
									function c() {
										a(), e();
									}
									function a() {
										if (s.iframe)
											try {
												s.form.removeChild(s.iframe);
											} catch (t) {
												s.onError(
													'jsonp polling iframe removal error',
													t
												);
											}
										try {
											var t =
												'<iframe src="javascript:0" name="' +
												s.iframeId +
												'">';
											o = document.createElement(t);
										} catch (t) {
											((o =
												document.createElement(
													'iframe'
												)).name = s.iframeId),
												(o.src = 'javascript:0');
										}
										(o.id = s.iframeId),
											s.form.appendChild(o),
											(s.iframe = o);
									}
									this.form ||
										((i = document.createElement('form')),
										(n =
											document.createElement('textarea')),
										(r = this.iframeId =
											'eio_iframe_' + this.index),
										(i.className = 'socketio'),
										(i.style.position = 'absolute'),
										(i.style.top = '-1000px'),
										(i.style.left = '-1000px'),
										(i.target = r),
										(i.method = 'POST'),
										i.setAttribute(
											'accept-charset',
											'utf-8'
										),
										(n.name = 'd'),
										i.appendChild(n),
										document.body.appendChild(i),
										(this.form = i),
										(this.area = n)),
										(this.form.action = this.uri()),
										a(),
										(t = t.replace(h, '\\\n')),
										(this.area.value = t.replace(l, '\\n'));
									try {
										this.form.submit();
									} catch (t) {}
									this.iframe.attachEvent
										? (this.iframe.onreadystatechange =
												function () {
													'complete' ==
														s.iframe.readyState &&
														c();
												})
										: (this.iframe.onload = c);
								});
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{ './polling': 18, 'component-inherit': 21 },
				],
				17: [
					function (h, u, t) {
						(function (n) {
							var r = h('xmlhttprequest'),
								o = h('./polling'),
								t = h('component-emitter'),
								e = h('component-inherit'),
								s = h('debug')('engine.io-client:polling-xhr');
							function i() {}
							function c(t) {
								var e, i;
								o.call(this, t),
									n.location &&
										((e = 'https:' == location.protocol),
										(i =
											(i = location.port) ||
											(e ? 443 : 80)),
										(this.xd =
											t.hostname != n.location.hostname ||
											i != t.port),
										(this.xs = t.secure != e));
							}
							function a(t) {
								(this.method = t.method || 'GET'),
									(this.uri = t.uri),
									(this.xd = !!t.xd),
									(this.xs = !!t.xs),
									(this.async = !1 !== t.async),
									(this.data =
										null != t.data ? t.data : null),
									(this.agent = t.agent),
									(this.isBinary = t.isBinary),
									(this.supportsBinary = t.supportsBinary),
									(this.enablesXDR = t.enablesXDR),
									(this.pfx = t.pfx),
									(this.key = t.key),
									(this.passphrase = t.passphrase),
									(this.cert = t.cert),
									(this.ca = t.ca),
									(this.ciphers = t.ciphers),
									(this.rejectUnauthorized =
										t.rejectUnauthorized),
									this.create();
							}
							function l() {
								for (var t in a.requests)
									a.requests.hasOwnProperty(t) &&
										a.requests[t].abort();
							}
							(u.exports = c),
								(u.exports.Request = a),
								e(c, o),
								(c.prototype.supportsBinary = !0),
								(c.prototype.request = function (t) {
									return (
										((t = t || {}).uri = this.uri()),
										(t.xd = this.xd),
										(t.xs = this.xs),
										(t.agent = this.agent || !1),
										(t.supportsBinary =
											this.supportsBinary),
										(t.enablesXDR = this.enablesXDR),
										(t.pfx = this.pfx),
										(t.key = this.key),
										(t.passphrase = this.passphrase),
										(t.cert = this.cert),
										(t.ca = this.ca),
										(t.ciphers = this.ciphers),
										(t.rejectUnauthorized =
											this.rejectUnauthorized),
										new a(t)
									);
								}),
								(c.prototype.doWrite = function (t, e) {
									var i =
											'string' != typeof t &&
											void 0 !== t,
										i = this.request({
											method: 'POST',
											data: t,
											isBinary: i,
										}),
										n = this;
									i.on('success', e),
										i.on('error', function (t) {
											n.onError('xhr post error', t);
										}),
										(this.sendXhr = i);
								}),
								(c.prototype.doPoll = function () {
									s('xhr poll');
									var t = this.request(),
										e = this;
									t.on('data', function (t) {
										e.onData(t);
									}),
										t.on('error', function (t) {
											e.onError('xhr poll error', t);
										}),
										(this.pollXhr = t);
								}),
								t(a.prototype),
								(a.prototype.create = function () {
									var t = {
										agent: this.agent,
										xdomain: this.xd,
										xscheme: this.xs,
										enablesXDR: this.enablesXDR,
									};
									(t.pfx = this.pfx),
										(t.key = this.key),
										(t.passphrase = this.passphrase),
										(t.cert = this.cert),
										(t.ca = this.ca),
										(t.ciphers = this.ciphers),
										(t.rejectUnauthorized =
											this.rejectUnauthorized);
									var e = (this.xhr = new r(t)),
										i = this;
									try {
										if (
											(s(
												'xhr open %s: %s',
												this.method,
												this.uri
											),
											e.open(
												this.method,
												this.uri,
												this.async
											),
											this.supportsBinary &&
												(e.responseType =
													'arraybuffer'),
											'POST' == this.method)
										)
											try {
												this.isBinary
													? e.setRequestHeader(
															'Content-type',
															'application/octet-stream'
													  )
													: e.setRequestHeader(
															'Content-type',
															'text/plain;charset=UTF-8'
													  );
											} catch (t) {}
										'withCredentials' in e &&
											(e.withCredentials = !0),
											this.hasXDR()
												? ((e.onload = function () {
														i.onLoad();
												  }),
												  (e.onerror = function () {
														i.onError(
															e.responseText
														);
												  }))
												: (e.onreadystatechange =
														function () {
															4 == e.readyState &&
																(200 ==
																	e.status ||
																1223 == e.status
																	? i.onLoad()
																	: setTimeout(
																			function () {
																				i.onError(
																					e.status
																				);
																			},
																			0
																	  ));
														}),
											s('xhr data %s', this.data),
											e.send(this.data);
									} catch (t) {
										return void setTimeout(function () {
											i.onError(t);
										}, 0);
									}
									n.document &&
										((this.index = a.requestsCount++),
										(a.requests[this.index] = this));
								}),
								(a.prototype.onSuccess = function () {
									this.emit('success'), this.cleanup();
								}),
								(a.prototype.onData = function (t) {
									this.emit('data', t), this.onSuccess();
								}),
								(a.prototype.onError = function (t) {
									this.emit('error', t), this.cleanup(!0);
								}),
								(a.prototype.cleanup = function (t) {
									if (
										void 0 !== this.xhr &&
										null !== this.xhr
									) {
										if (
											(this.hasXDR()
												? (this.xhr.onload =
														this.xhr.onerror =
															i)
												: (this.xhr.onreadystatechange =
														i),
											t)
										)
											try {
												this.xhr.abort();
											} catch (t) {}
										n.document &&
											delete a.requests[this.index],
											(this.xhr = null);
									}
								}),
								(a.prototype.onLoad = function () {
									var t, e;
									try {
										try {
											e = this.xhr
												.getResponseHeader(
													'Content-Type'
												)
												.split(';')[0];
										} catch (t) {}
										t =
											'application/octet-stream' === e
												? this.xhr.response
												: this.supportsBinary
												? 'ok'
												: this.xhr.responseText;
									} catch (t) {
										this.onError(t);
									}
									null != t && this.onData(t);
								}),
								(a.prototype.hasXDR = function () {
									return (
										void 0 !== n.XDomainRequest &&
										!this.xs &&
										this.enablesXDR
									);
								}),
								(a.prototype.abort = function () {
									this.cleanup();
								}),
								n.document &&
									((a.requestsCount = 0),
									(a.requests = {}),
									n.attachEvent
										? n.attachEvent('onunload', l)
										: n.addEventListener &&
										  n.addEventListener(
												'beforeunload',
												l,
												!1
										  ));
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{
						'./polling': 18,
						'component-emitter': 9,
						'component-inherit': 21,
						debug: 22,
						xmlhttprequest: 20,
					},
				],
				18: [
					function (t, e, i) {
						var n = t('../transport'),
							r = t('parseqs'),
							o = t('engine.io-parser'),
							s = t('component-inherit'),
							c = t('debug')('engine.io-client:polling');
						e.exports = l;
						var a =
							null !=
							new (t('xmlhttprequest'))({ xdomain: !1 })
								.responseType;
						function l(t) {
							var e = t && t.forceBase64;
							(a && !e) || (this.supportsBinary = !1),
								n.call(this, t);
						}
						s(l, n),
							(l.prototype.name = 'polling'),
							(l.prototype.doOpen = function () {
								this.poll();
							}),
							(l.prototype.pause = function (t) {
								var e,
									i = this;
								function n() {
									c('paused'), (i.readyState = 'paused'), t();
								}
								(this.readyState = 'pausing'),
									this.polling || !this.writable
										? ((e = 0),
										  this.polling &&
												(c(
													'we are currently polling - waiting to pause'
												),
												e++,
												this.once(
													'pollComplete',
													function () {
														c(
															'pre-pause polling complete'
														),
															--e || n();
													}
												)),
										  this.writable ||
												(c(
													'we are currently writing - waiting to pause'
												),
												e++,
												this.once('drain', function () {
													c(
														'pre-pause writing complete'
													),
														--e || n();
												})))
										: n();
							}),
							(l.prototype.poll = function () {
								c('polling'),
									(this.polling = !0),
									this.doPoll(),
									this.emit('poll');
							}),
							(l.prototype.onData = function (t) {
								var n = this;
								c('polling got data %s', t);
								o.decodePayload(
									t,
									this.socket.binaryType,
									function (t, e, i) {
										if (
											('opening' == n.readyState &&
												n.onOpen(),
											'close' == t.type)
										)
											return n.onClose(), !1;
										n.onPacket(t);
									}
								),
									'closed' != this.readyState &&
										((this.polling = !1),
										this.emit('pollComplete'),
										'open' == this.readyState
											? this.poll()
											: c(
													'ignoring poll - transport state "%s"',
													this.readyState
											  ));
							}),
							(l.prototype.doClose = function () {
								var t = this;
								function e() {
									c('writing close packet'),
										t.write([{ type: 'close' }]);
								}
								'open' == this.readyState
									? (c('transport open - closing'), e())
									: (c(
											'transport not open - deferring close'
									  ),
									  this.once('open', e));
							}),
							(l.prototype.write = function (t) {
								var e = this;
								this.writable = !1;
								function i() {
									(e.writable = !0), e.emit('drain');
								}
								e = this;
								o.encodePayload(
									t,
									this.supportsBinary,
									function (t) {
										e.doWrite(t, i);
									}
								);
							}),
							(l.prototype.uri = function () {
								var t = this.query || {},
									e = this.secure ? 'https' : 'http',
									i = '';
								return (
									!1 !== this.timestampRequests &&
										(t[this.timestampParam] =
											+new Date() + '-' + n.timestamps++),
									this.supportsBinary || t.sid || (t.b64 = 1),
									(t = r.encode(t)),
									this.port &&
										(('https' == e && 443 != this.port) ||
											('http' == e && 80 != this.port)) &&
										(i = ':' + this.port),
									t.length && (t = '?' + t),
									e +
										'://' +
										this.hostname +
										i +
										this.path +
										t
								);
							});
					},
					{
						'../transport': 14,
						'component-inherit': 21,
						debug: 22,
						'engine.io-parser': 25,
						parseqs: 35,
						xmlhttprequest: 20,
					},
				],
				19: [
					function (t, e, i) {
						var n = t('../transport'),
							r = t('engine.io-parser'),
							o = t('parseqs'),
							s = t('component-inherit'),
							c = t('debug')('engine.io-client:websocket'),
							a = t('ws');
						function l(t) {
							t && t.forceBase64 && (this.supportsBinary = !1),
								n.call(this, t);
						}
						s((e.exports = l), n),
							(l.prototype.name = 'websocket'),
							(l.prototype.supportsBinary = !0),
							(l.prototype.doOpen = function () {
								var t, e;
								this.check() &&
									((t = this.uri()),
									((e = { agent: this.agent }).pfx =
										this.pfx),
									(e.key = this.key),
									(e.passphrase = this.passphrase),
									(e.cert = this.cert),
									(e.ca = this.ca),
									(e.ciphers = this.ciphers),
									(e.rejectUnauthorized =
										this.rejectUnauthorized),
									(this.ws = new a(t, void 0, e)),
									void 0 === this.ws.binaryType &&
										(this.supportsBinary = !1),
									(this.ws.binaryType = 'arraybuffer'),
									this.addEventListeners());
							}),
							(l.prototype.addEventListeners = function () {
								var e = this;
								(this.ws.onopen = function () {
									e.onOpen();
								}),
									(this.ws.onclose = function () {
										e.onClose();
									}),
									(this.ws.onmessage = function (t) {
										e.onData(t.data);
									}),
									(this.ws.onerror = function (t) {
										e.onError('websocket error', t);
									});
							}),
							'undefined' != typeof navigator &&
								/iPad|iPhone|iPod/i.test(navigator.userAgent) &&
								(l.prototype.onData = function (t) {
									var e = this;
									setTimeout(function () {
										n.prototype.onData.call(e, t);
									}, 0);
								}),
							(l.prototype.write = function (t) {
								var e = this;
								this.writable = !1;
								for (var i = 0, n = t.length; i < n; i++)
									r.encodePacket(
										t[i],
										this.supportsBinary,
										function (t) {
											try {
												e.ws.send(t);
											} catch (t) {
												c(
													'websocket closed before onclose event'
												);
											}
										}
									);
								setTimeout(function () {
									(e.writable = !0), e.emit('drain');
								}, 0);
							}),
							(l.prototype.onClose = function () {
								n.prototype.onClose.call(this);
							}),
							(l.prototype.doClose = function () {
								void 0 !== this.ws && this.ws.close();
							}),
							(l.prototype.uri = function () {
								var t = this.query || {},
									e = this.secure ? 'wss' : 'ws',
									i = '';
								return (
									this.port &&
										(('wss' == e && 443 != this.port) ||
											('ws' == e && 80 != this.port)) &&
										(i = ':' + this.port),
									this.timestampRequests &&
										(t[this.timestampParam] = +new Date()),
									this.supportsBinary || (t.b64 = 1),
									(t = o.encode(t)).length && (t = '?' + t),
									e +
										'://' +
										this.hostname +
										i +
										this.path +
										t
								);
							}),
							(l.prototype.check = function () {
								return !(
									!a ||
									('__initialize' in a &&
										this.name === l.prototype.name)
								);
							});
					},
					{
						'../transport': 14,
						'component-inherit': 21,
						debug: 22,
						'engine.io-parser': 25,
						parseqs: 35,
						ws: 37,
					},
				],
				20: [
					function (t, e, i) {
						var r = t('has-cors');
						e.exports = function (t) {
							var e = t.xdomain,
								i = t.xscheme,
								n = t.enablesXDR;
							try {
								if (
									'undefined' != typeof XMLHttpRequest &&
									(!e || r)
								)
									return new XMLHttpRequest();
							} catch (t) {}
							try {
								if (
									'undefined' != typeof XDomainRequest &&
									!i &&
									n
								)
									return new XDomainRequest();
							} catch (t) {}
							if (!e)
								try {
									return new ActiveXObject(
										'Microsoft.XMLHTTP'
									);
								} catch (t) {}
						};
					},
					{ 'has-cors': 40 },
				],
				21: [
					function (t, e, i) {
						e.exports = function (t, e) {
							function i() {}
							(i.prototype = e.prototype),
								(t.prototype = new i()),
								(t.prototype.constructor = t);
						};
					},
					{},
				],
				22: [
					function (t, e, r) {
						function i() {
							var t;
							try {
								t = localStorage.debug;
							} catch (t) {}
							return t;
						}
						((r = e.exports = t('./debug')).log = function () {
							return (
								'object' == typeof console &&
								'function' == typeof console.log &&
								Function.prototype.apply.call(
									console.log,
									console,
									arguments
								)
							);
						}),
							(r.formatArgs = function () {
								var t = arguments,
									e = this.useColors;
								if (
									((t[0] =
										(e ? '%c' : '') +
										this.namespace +
										(e ? ' %c' : ' ') +
										t[0] +
										(e ? '%c ' : ' ') +
										'+' +
										r.humanize(this.diff)),
									!e)
								)
									return t;
								e = 'color: ' + this.color;
								t = [t[0], e, 'color: inherit'].concat(
									Array.prototype.slice.call(t, 1)
								);
								var i = 0,
									n = 0;
								return (
									t[0].replace(/%[a-z%]/g, function (t) {
										'%' !== t &&
											(i++, '%c' === t && (n = i));
									}),
									t.splice(n, 0, e),
									t
								);
							}),
							(r.save = function (t) {
								try {
									null == t
										? localStorage.removeItem('debug')
										: (localStorage.debug = t);
								} catch (t) {}
							}),
							(r.load = i),
							(r.useColors = function () {
								return (
									'WebkitAppearance' in
										document.documentElement.style ||
									(window.console &&
										(console.firebug ||
											(console.exception &&
												console.table))) ||
									(navigator.userAgent
										.toLowerCase()
										.match(/firefox\/(\d+)/) &&
										31 <= parseInt(RegExp.$1, 10))
								);
							}),
							(r.colors = [
								'lightseagreen',
								'forestgreen',
								'goldenrod',
								'dodgerblue',
								'darkorchid',
								'crimson',
							]),
							(r.formatters.j = function (t) {
								return JSON.stringify(t);
							}),
							r.enable(i());
					},
					{ './debug': 23 },
				],
				23: [
					function (t, e, s) {
						((s = e.exports =
							function (t) {
								function e() {}
								function i() {
									var n = i,
										t = +new Date(),
										e = t - (c || t);
									(n.diff = e),
										(n.prev = c),
										(n.curr = t),
										(c = t),
										null == n.useColors &&
											(n.useColors = s.useColors()),
										null == n.color &&
											n.useColors &&
											(n.color =
												s.colors[
													a++ % s.colors.length
												]);
									var r =
										Array.prototype.slice.call(arguments);
									(r[0] = s.coerce(r[0])),
										'string' != typeof r[0] &&
											(r = ['%o'].concat(r));
									var o = 0;
									(r[0] = r[0].replace(
										/%([a-z%])/g,
										function (t, e) {
											if ('%' === t) return t;
											o++;
											var i = s.formatters[e];
											return (
												'function' == typeof i &&
													((e = r[o]),
													(t = i.call(n, e)),
													r.splice(o, 1),
													o--),
												t
											);
										}
									)),
										'function' == typeof s.formatArgs &&
											(r = s.formatArgs.apply(n, r)),
										(
											i.log ||
											s.log ||
											console.log.bind(console)
										).apply(n, r);
								}
								(e.enabled = !1), (i.enabled = !0);
								var n = s.enabled(t) ? i : e;
								return (n.namespace = t), n;
							}).coerce = function (t) {
							return t instanceof Error
								? t.stack || t.message
								: t;
						}),
							(s.disable = function () {
								s.enable('');
							}),
							(s.enable = function (t) {
								s.save(t);
								for (
									var e = (t || '').split(/[\s,]+/),
										i = e.length,
										n = 0;
									n < i;
									n++
								)
									e[n] &&
										('-' ===
										(t = e[n].replace(/\*/g, '.*?'))[0]
											? s.skips.push(
													new RegExp(
														'^' + t.substr(1) + '$'
													)
											  )
											: s.names.push(
													new RegExp('^' + t + '$')
											  ));
							}),
							(s.enabled = function (t) {
								var e, i;
								for (e = 0, i = s.skips.length; e < i; e++)
									if (s.skips[e].test(t)) return !1;
								for (e = 0, i = s.names.length; e < i; e++)
									if (s.names[e].test(t)) return !0;
								return !1;
							}),
							(s.humanize = t('ms')),
							(s.names = []),
							(s.skips = []),
							(s.formatters = {});
						var c,
							a = 0;
					},
					{ ms: 24 },
				],
				24: [
					function (t, e, i) {
						function n(t, e, i) {
							if (!(t < e))
								return t < 1.5 * e
									? Math.floor(t / e) + ' ' + i
									: Math.ceil(t / e) + ' ' + i + 's';
						}
						e.exports = function (t, e) {
							return (
								(e = e || {}),
								'string' == typeof t
									? (function (t) {
											t =
												/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(
													t
												);
											if (!t) return;
											var e = parseFloat(t[1]);
											switch (
												(t[2] || 'ms').toLowerCase()
											) {
												case 'years':
												case 'year':
												case 'y':
													return 315576e5 * e;
												case 'days':
												case 'day':
												case 'd':
													return 864e5 * e;
												case 'hours':
												case 'hour':
												case 'h':
													return 36e5 * e;
												case 'minutes':
												case 'minute':
												case 'm':
													return 6e4 * e;
												case 'seconds':
												case 'second':
												case 's':
													return 1e3 * e;
												case 'ms':
													return e;
											}
									  })(t)
									: e.long
									? n((e = t), 864e5, 'day') ||
									  n(e, 36e5, 'hour') ||
									  n(e, 6e4, 'minute') ||
									  n(e, 1e3, 'second') ||
									  e + ' ms'
									: 864e5 <= (t = t)
									? Math.round(t / 864e5) + 'd'
									: 36e5 <= t
									? Math.round(t / 36e5) + 'h'
									: 6e4 <= t
									? Math.round(t / 6e4) + 'm'
									: 1e3 <= t
									? Math.round(t / 1e3) + 's'
									: t + 'ms'
							);
						};
					},
					{},
				],
				25: [
					function (f, t, m) {
						(function (l) {
							var t = f('./keys'),
								e = f('has-binary'),
								d = f('arraybuffer.slice'),
								n = f('base64-arraybuffer'),
								s = f('after'),
								o = f('utf8'),
								i = navigator.userAgent.match(/Android/i),
								r = /PhantomJS/i.test(navigator.userAgent),
								c = i || r;
							m.protocol = 3;
							var a = (m.packets = {
									open: 0,
									close: 1,
									ping: 2,
									pong: 3,
									message: 4,
									upgrade: 5,
									noop: 6,
								}),
								h = t(a),
								p = { type: 'error', data: 'parser error' },
								u = f('blob');
							function _(t, e, i) {
								for (
									var r = new Array(t.length),
										n = s(t.length, i),
										o = 0;
									o < t.length;
									o++
								)
									!(function (i, t, n) {
										e(t, function (t, e) {
											(r[i] = e), n(t, r);
										});
									})(o, t[o], n);
							}
							(m.encodePacket = function (t, e, i, n) {
								'function' == typeof e && ((n = e), (e = !1)),
									'function' == typeof i &&
										((n = i), (i = null));
								var r =
									void 0 === t.data
										? void 0
										: t.data.buffer || t.data;
								if (l.ArrayBuffer && r instanceof ArrayBuffer)
									return (function (t, e, i) {
										if (!e)
											return m.encodeBase64Packet(t, i);
										var e = t.data,
											n = new Uint8Array(e),
											r = new Uint8Array(
												1 + e.byteLength
											);
										r[0] = a[t.type];
										for (var o = 0; o < n.length; o++)
											r[o + 1] = n[o];
										return i(r.buffer);
									})(t, e, n);
								if (u && r instanceof l.Blob)
									return (function (t, e, i) {
										if (!e)
											return m.encodeBase64Packet(t, i);
										if (c)
											return (function (t, e, i) {
												if (!e)
													return m.encodeBase64Packet(
														t,
														i
													);
												var n = new FileReader();
												return (
													(n.onload = function () {
														(t.data = n.result),
															m.encodePacket(
																t,
																e,
																!0,
																i
															);
													}),
													n.readAsArrayBuffer(t.data)
												);
											})(t, e, i);
										e = new Uint8Array(1);
										e[0] = a[t.type];
										t = new u([e.buffer, t.data]);
										return i(t);
									})(t, e, n);
								if (r && r.base64)
									return (function (t, e) {
										t =
											'b' +
											m.packets[t.type] +
											t.data.data;
										return e(t);
									})(t, n);
								r = a[t.type];
								return (
									void 0 !== t.data &&
										(r += i
											? o.encode(String(t.data))
											: String(t.data)),
									n('' + r)
								);
							}),
								(m.encodeBase64Packet = function (e, i) {
									var n,
										r = 'b' + m.packets[e.type];
									if (u && e.data instanceof u) {
										var o = new FileReader();
										return (
											(o.onload = function () {
												var t = o.result.split(',')[1];
												i(r + t);
											}),
											o.readAsDataURL(e.data)
										);
									}
									try {
										n = String.fromCharCode.apply(
											null,
											new Uint8Array(e.data)
										);
									} catch (t) {
										for (
											var s = new Uint8Array(e.data),
												c = new Array(s.length),
												a = 0;
											a < s.length;
											a++
										)
											c[a] = s[a];
										n = String.fromCharCode.apply(null, c);
									}
									return (r += l.btoa(n)), i(r);
								}),
								(m.decodePacket = function (t, e, i) {
									if ('string' == typeof t || void 0 === t) {
										if ('b' == t.charAt(0))
											return m.decodeBase64Packet(
												t.substr(1),
												e
											);
										if (i)
											try {
												t = o.decode(t);
											} catch (t) {
												return p;
											}
										var n = t.charAt(0);
										return Number(n) == n && h[n]
											? 1 < t.length
												? {
														type: h[n],
														data: t.substring(1),
												  }
												: { type: h[n] }
											: p;
									}
									(n = new Uint8Array(t)[0]), (i = d(t, 1));
									return (
										u && 'blob' === e && (i = new u([i])),
										{ type: h[n], data: i }
									);
								}),
								(m.decodeBase64Packet = function (t, e) {
									var i = h[t.charAt(0)];
									if (!l.ArrayBuffer)
										return {
											type: i,
											data: {
												base64: !0,
												data: t.substr(1),
											},
										};
									t = n.decode(t.substr(1));
									return (
										'blob' === e && u && (t = new u([t])),
										{ type: i, data: t }
									);
								}),
								(m.encodePayload = function (t, i, n) {
									'function' == typeof i &&
										((n = i), (i = null));
									var r = e(t);
									return i && r
										? u && !c
											? m.encodePayloadAsBlob(t, n)
											: m.encodePayloadAsArrayBuffer(t, n)
										: t.length
										? void _(
												t,
												function (t, e) {
													m.encodePacket(
														t,
														!!r && i,
														!0,
														function (t) {
															e(
																null,
																(t = t).length +
																	':' +
																	t
															);
														}
													);
												},
												function (t, e) {
													return n(e.join(''));
												}
										  )
										: n('0:');
								}),
								(m.decodePayload = function (t, e, i) {
									if ('string' != typeof t)
										return m.decodePayloadAsBinary(t, e, i);
									if (
										('function' == typeof e &&
											((i = e), (e = null)),
										'' == t)
									)
										return i(p, 0, 1);
									for (
										var n, r = '', o = 0, s = t.length;
										o < s;
										o++
									) {
										var c = t.charAt(o);
										if (':' != c) r += c;
										else {
											if ('' == r || r != (n = Number(r)))
												return i(p, 0, 1);
											if (
												r !=
												(c = t.substr(o + 1, n)).length
											)
												return i(p, 0, 1);
											if (c.length) {
												if (
													((c = m.decodePacket(
														c,
														e,
														!0
													)),
													p.type == c.type &&
														p.data == c.data)
												)
													return i(p, 0, 1);
												if (!1 === i(c, o + n, s))
													return;
											}
											(o += n), (r = '');
										}
									}
									return '' != r ? i(p, 0, 1) : void 0;
								}),
								(m.encodePayloadAsArrayBuffer = function (
									t,
									n
								) {
									if (!t.length) return n(new ArrayBuffer(0));
									_(
										t,
										function (t, e) {
											m.encodePacket(
												t,
												!0,
												!0,
												function (t) {
													return e(null, t);
												}
											);
										},
										function (t, e) {
											var i = e.reduce(function (t, e) {
													e =
														'string' == typeof e
															? e.length
															: e.byteLength;
													return (
														t +
														e.toString().length +
														e +
														2
													);
												}, 0),
												s = new Uint8Array(i),
												c = 0;
											return (
												e.forEach(function (t) {
													var e =
															'string' ==
															typeof t,
														i = t;
													if (e) {
														for (
															var n =
																	new Uint8Array(
																		t.length
																	),
																r = 0;
															r < t.length;
															r++
														)
															n[r] =
																t.charCodeAt(r);
														i = n.buffer;
													}
													s[c++] = e ? 0 : 1;
													for (
														var o =
																i.byteLength.toString(),
															r = 0;
														r < o.length;
														r++
													)
														s[c++] = parseInt(o[r]);
													s[c++] = 255;
													for (
														n = new Uint8Array(i),
															r = 0;
														r < n.length;
														r++
													)
														s[c++] = n[r];
												}),
												n(s.buffer)
											);
										}
									);
								}),
								(m.encodePayloadAsBlob = function (t, i) {
									_(
										t,
										function (t, s) {
											m.encodePacket(
												t,
												!0,
												!0,
												function (t) {
													var e = new Uint8Array(1);
													if (
														((e[0] = 1),
														'string' == typeof t)
													) {
														for (
															var i =
																	new Uint8Array(
																		t.length
																	),
																n = 0;
															n < t.length;
															n++
														)
															i[n] =
																t.charCodeAt(n);
														(t = i.buffer),
															(e[0] = 0);
													}
													for (
														var r = (
																t instanceof
																ArrayBuffer
																	? t.byteLength
																	: t.size
															).toString(),
															o = new Uint8Array(
																r.length + 1
															),
															n = 0;
														n < r.length;
														n++
													)
														o[n] = parseInt(r[n]);
													(o[r.length] = 255),
														u &&
															((e = new u([
																e.buffer,
																o.buffer,
																t,
															])),
															s(null, e));
												}
											);
										},
										function (t, e) {
											return i(new u(e));
										}
									);
								}),
								(m.decodePayloadAsBinary = function (t, i, n) {
									'function' == typeof i &&
										((n = i), (i = null));
									for (
										var e = t, r = [], o = !1;
										0 < e.byteLength;

									) {
										for (
											var s = new Uint8Array(e),
												c = 0 === s[0],
												a = '',
												l = 1;
											255 != s[l];
											l++
										) {
											if (310 < a.length) {
												o = !0;
												break;
											}
											a += s[l];
										}
										if (o) return n(p, 0, 1);
										(e = d(e, 2 + a.length)),
											(a = parseInt(a));
										var h = d(e, 0, a);
										if (c)
											try {
												h = String.fromCharCode.apply(
													null,
													new Uint8Array(h)
												);
											} catch (t) {
												for (
													var u = new Uint8Array(h),
														h = '',
														l = 0;
													l < u.length;
													l++
												)
													h += String.fromCharCode(
														u[l]
													);
											}
										r.push(h), (e = d(e, a));
									}
									var _ = r.length;
									r.forEach(function (t, e) {
										n(m.decodePacket(t, i, !0), e, _);
									});
								});
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{
						'./keys': 26,
						after: 27,
						'arraybuffer.slice': 28,
						'base64-arraybuffer': 29,
						blob: 30,
						'has-binary': 31,
						utf8: 33,
					},
				],
				26: [
					function (t, e, i) {
						e.exports =
							Object.keys ||
							function (t) {
								var e,
									i = [],
									n = Object.prototype.hasOwnProperty;
								for (e in t) n.call(t, e) && i.push(e);
								return i;
							};
					},
					{},
				],
				27: [
					function (t, e, i) {
						function s() {}
						e.exports = function (t, i, n) {
							var r = !1;
							return (n = n || s), 0 === (o.count = t) ? i() : o;
							function o(t, e) {
								if (o.count <= 0)
									throw new Error(
										'after called too many times'
									);
								--o.count,
									t
										? ((r = !0), i(t), (i = n))
										: 0 !== o.count || r || i(null, e);
							}
						};
					},
					{},
				],
				28: [
					function (t, e, i) {
						e.exports = function (t, e, i) {
							var n = t.byteLength;
							if (((e = e || 0), (i = i || n), t.slice))
								return t.slice(e, i);
							if (
								(e < 0 && (e += n),
								i < 0 && (i += n),
								n < i && (i = n),
								n <= e || i <= e || 0 === n)
							)
								return new ArrayBuffer(0);
							for (
								var r = new Uint8Array(t),
									o = new Uint8Array(i - e),
									s = e,
									c = 0;
								s < i;
								s++, c++
							)
								o[c] = r[s];
							return o.buffer;
						};
					},
					{},
				],
				29: [
					function (t, e, i) {
						!(function (h) {
							'use strict';
							(i.encode = function (t) {
								for (
									var e = new Uint8Array(t),
										i = e.length,
										n = '',
										r = 0;
									r < i;
									r += 3
								)
									(n += h[e[r] >> 2]),
										(n +=
											h[
												((3 & e[r]) << 4) |
													(e[r + 1] >> 4)
											]),
										(n +=
											h[
												((15 & e[r + 1]) << 2) |
													(e[r + 2] >> 6)
											]),
										(n += h[63 & e[r + 2]]);
								return (
									i % 3 == 2
										? (n =
												n.substring(0, n.length - 1) +
												'=')
										: i % 3 == 1 &&
										  (n =
												n.substring(0, n.length - 2) +
												'=='),
									n
								);
							}),
								(i.decode = function (t) {
									var e,
										i,
										n,
										r,
										o = 0.75 * t.length,
										s = t.length,
										c = 0;
									'=' === t[t.length - 1] &&
										(o--, '=' === t[t.length - 2] && o--);
									for (
										var o = new ArrayBuffer(o),
											a = new Uint8Array(o),
											l = 0;
										l < s;
										l += 4
									)
										(e = h.indexOf(t[l])),
											(i = h.indexOf(t[l + 1])),
											(n = h.indexOf(t[l + 2])),
											(r = h.indexOf(t[l + 3])),
											(a[c++] = (e << 2) | (i >> 4)),
											(a[c++] =
												((15 & i) << 4) | (n >> 2)),
											(a[c++] =
												((3 & n) << 6) | (63 & r));
									return o;
								});
						})(
							'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
						);
					},
					{},
				],
				30: [
					function (t, o, e) {
						(function (t) {
							var r =
									t.BlobBuilder ||
									t.WebKitBlobBuilder ||
									t.MSBlobBuilder ||
									t.MozBlobBuilder,
								e = (function () {
									try {
										return 2 == new Blob(['hi']).size;
									} catch (t) {
										return !1;
									}
								})(),
								i =
									r &&
									r.prototype.append &&
									r.prototype.getBlob;
							function n(t, e) {
								e = e || {};
								for (var i = new r(), n = 0; n < t.length; n++)
									i.append(t[n]);
								return e.type ? i.getBlob(e.type) : i.getBlob();
							}
							o.exports = e ? t.Blob : i ? n : void 0;
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{},
				],
				31: [
					function (t, e, i) {
						(function (r) {
							var o = t('isarray');
							e.exports = function (t) {
								return (function t(e) {
									if (!e) return !1;
									if (
										(r.Buffer && r.Buffer.isBuffer(e)) ||
										(r.ArrayBuffer &&
											e instanceof ArrayBuffer) ||
										(r.Blob && e instanceof Blob) ||
										(r.File && e instanceof File)
									)
										return !0;
									if (o(e)) {
										for (var i = 0; i < e.length; i++)
											if (t(e[i])) return !0;
									} else if (e && 'object' == typeof e)
										for (var n in (e.toJSON &&
											(e = e.toJSON()),
										e))
											if (e.hasOwnProperty(n) && t(e[n]))
												return !0;
									return !1;
								})(t);
							};
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{ isarray: 32 },
				],
				32: [
					function (t, e, i) {
						e.exports =
							Array.isArray ||
							function (t) {
								return (
									'[object Array]' ==
									Object.prototype.toString.call(t)
								);
							};
					},
					{},
				],
				33: [
					function (t, f, m) {
						(function (p) {
							!(function (t) {
								var e = 'object' == typeof m && m,
									i =
										'object' == typeof f &&
										f &&
										f.exports == e &&
										f,
									n = 'object' == typeof p && p;
								(n.global !== n && n.window !== n) || (t = n);
								var r,
									o,
									s,
									c = String.fromCharCode;
								function a(t) {
									for (
										var e, i, n = [], r = 0, o = t.length;
										r < o;

									)
										55296 <= (e = t.charCodeAt(r++)) &&
										e <= 56319 &&
										r < o
											? 56320 ==
											  (64512 & (i = t.charCodeAt(r++)))
												? n.push(
														((1023 & e) << 10) +
															(1023 & i) +
															65536
												  )
												: (n.push(e), r--)
											: n.push(e);
									return n;
								}
								function l(t, e) {
									return c(((t >> e) & 63) | 128);
								}
								function h() {
									if (o <= s)
										throw Error('Invalid byte index');
									var t = 255 & r[s];
									if ((s++, 128 == (192 & t))) return 63 & t;
									throw Error('Invalid continuation byte');
								}
								var u = {
									version: '2.0.0',
									encode: function (t) {
										for (
											var e = a(t),
												i = e.length,
												n = -1,
												r = '';
											++n < i;

										)
											r += (function (t) {
												if (0 == (4294967168 & t))
													return c(t);
												var e = '';
												return (
													0 == (4294965248 & t)
														? (e = c(
																((t >> 6) &
																	31) |
																	192
														  ))
														: 0 == (4294901760 & t)
														? ((e = c(
																((t >> 12) &
																	15) |
																	224
														  )),
														  (e += l(t, 6)))
														: 0 ==
																(4292870144 &
																	t) &&
														  ((e = c(
																((t >> 18) &
																	7) |
																	240
														  )),
														  (e += l(t, 12)),
														  (e += l(t, 6))),
													(e += c((63 & t) | 128))
												);
											})(e[n]);
										return r;
									},
									decode: function (t) {
										(r = a(t)), (o = r.length), (s = 0);
										for (
											var e, i = [];
											!1 !==
											(e = (function () {
												var t, e;
												if (o < s)
													throw Error(
														'Invalid byte index'
													);
												if (s == o) return !1;
												if (
													((t = 255 & r[s]),
													s++,
													0 == (128 & t))
												)
													return t;
												if (192 == (224 & t)) {
													if (
														128 <=
														(e =
															((31 & t) << 6) |
															h())
													)
														return e;
													throw Error(
														'Invalid continuation byte'
													);
												}
												if (224 == (240 & t)) {
													if (
														2048 <=
														(e =
															((15 & t) << 12) |
															(h() << 6) |
															h())
													)
														return e;
													throw Error(
														'Invalid continuation byte'
													);
												}
												if (
													240 == (248 & t) &&
													65536 <=
														(e =
															((15 & t) << 18) |
															(h() << 12) |
															(h() << 6) |
															h()) &&
													e <= 1114111
												)
													return e;
												throw Error(
													'Invalid UTF-8 detected'
												);
											})());

										)
											i.push(e);
										return (function (t) {
											for (
												var e,
													i = t.length,
													n = -1,
													r = '';
												++n < i;

											)
												65535 < (e = t[n]) &&
													((r += c(
														(((e -= 65536) >>> 10) &
															1023) |
															55296
													)),
													(e = 56320 | (1023 & e))),
													(r += c(e));
											return r;
										})(i);
									},
								};
								if ((0, e && !e.nodeType))
									if (i) i.exports = u;
									else {
										var _,
											d = {}.hasOwnProperty;
										for (_ in u)
											d.call(u, _) && (e[_] = u[_]);
									}
								else t.utf8 = u;
							})(this);
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{},
				],
				34: [
					function (t, a, e) {
						(function (e) {
							var i = /^[\],:{}\s]*$/,
								n = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
								r =
									/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
								o = /(?:^|:|,)(?:\s*\[)+/g,
								s = /^\s+/,
								c = /\s+$/;
							a.exports = function (t) {
								return 'string' == typeof t && t
									? ((t = t.replace(s, '').replace(c, '')),
									  e.JSON && JSON.parse
											? JSON.parse(t)
											: i.test(
													t
														.replace(n, '@')
														.replace(r, ']')
														.replace(o, '')
											  )
											? new Function('return ' + t)()
											: void 0)
									: null;
							};
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{},
				],
				35: [
					function (t, e, i) {
						(i.encode = function (t) {
							var e,
								i = '';
							for (e in t)
								t.hasOwnProperty(e) &&
									(i.length && (i += '&'),
									(i +=
										encodeURIComponent(e) +
										'=' +
										encodeURIComponent(t[e])));
							return i;
						}),
							(i.decode = function (t) {
								for (
									var e = {},
										i = t.split('&'),
										n = 0,
										r = i.length;
									n < r;
									n++
								) {
									var o = i[n].split('=');
									e[decodeURIComponent(o[0])] =
										decodeURIComponent(o[1]);
								}
								return e;
							});
					},
					{},
				],
				36: [
					function (t, e, i) {
						var c =
								/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
							a = [
								'source',
								'protocol',
								'authority',
								'userInfo',
								'user',
								'password',
								'host',
								'port',
								'relative',
								'path',
								'directory',
								'file',
								'query',
								'anchor',
							];
						e.exports = function (t) {
							var e = t,
								i = t.indexOf('['),
								n = t.indexOf(']');
							-1 != i &&
								-1 != n &&
								(t =
									t.substring(0, i) +
									t.substring(i, n).replace(/:/g, ';') +
									t.substring(n, t.length));
							for (var r = c.exec(t || ''), o = {}, s = 14; s--; )
								o[a[s]] = r[s] || '';
							return (
								-1 != i &&
									-1 != n &&
									((o.source = e),
									(o.host = o.host
										.substring(1, o.host.length - 1)
										.replace(/;/g, ':')),
									(o.authority = o.authority
										.replace('[', '')
										.replace(']', '')
										.replace(/;/g, ':')),
									(o.ipv6uri = !0)),
								o
							);
						};
					},
					{},
				],
				37: [
					function (t, e, i) {
						var n = (function () {
								return this;
							})(),
							r = n.WebSocket || n.MozWebSocket;
						function o(t, e, i) {
							t = e ? new r(t, e) : new r(t);
							return t;
						}
						(e.exports = r ? o : null),
							r && (o.prototype = r.prototype);
					},
					{},
				],
				38: [
					function (t, e, i) {
						(function (r) {
							var o = t('isarray');
							e.exports = function (t) {
								return (function t(e) {
									if (!e) return !1;
									if (
										(r.Buffer && r.Buffer.isBuffer(e)) ||
										(r.ArrayBuffer &&
											e instanceof ArrayBuffer) ||
										(r.Blob && e instanceof Blob) ||
										(r.File && e instanceof File)
									)
										return !0;
									if (o(e)) {
										for (var i = 0; i < e.length; i++)
											if (t(e[i])) return !0;
									} else if (e && 'object' == typeof e)
										for (var n in (e.toJSON &&
											(e = e.toJSON()),
										e))
											if (
												Object.prototype.hasOwnProperty.call(
													e,
													n
												) &&
												t(e[n])
											)
												return !0;
									return !1;
								})(t);
							};
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{ isarray: 39 },
				],
				39: [
					function (t, e, i) {
						e.exports = t(32);
					},
					{},
				],
				40: [
					function (t, e, i) {
						var n = t('global');
						try {
							e.exports =
								'XMLHttpRequest' in n &&
								'withCredentials' in new n.XMLHttpRequest();
						} catch (t) {
							e.exports = !1;
						}
					},
					{ global: 41 },
				],
				41: [
					function (t, e, i) {
						e.exports = (function () {
							return this;
						})();
					},
					{},
				],
				42: [
					function (t, e, i) {
						var n = [].indexOf;
						e.exports = function (t, e) {
							if (n) return t.indexOf(e);
							for (var i = 0; i < t.length; ++i)
								if (t[i] === e) return i;
							return -1;
						};
					},
					{},
				],
				43: [
					function (t, e, i) {
						var n = Object.prototype.hasOwnProperty;
						(i.keys =
							Object.keys ||
							function (t) {
								var e,
									i = [];
								for (e in t) n.call(t, e) && i.push(e);
								return i;
							}),
							(i.values = function (t) {
								var e,
									i = [];
								for (e in t) n.call(t, e) && i.push(t[e]);
								return i;
							}),
							(i.merge = function (t, e) {
								for (var i in e) n.call(e, i) && (t[i] = e[i]);
								return t;
							}),
							(i.length = function (t) {
								return i.keys(t).length;
							}),
							(i.isEmpty = function (t) {
								return 0 == i.length(t);
							});
					},
					{},
				],
				44: [
					function (t, e, i) {
						var r =
								/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
							o = [
								'source',
								'protocol',
								'authority',
								'userInfo',
								'user',
								'password',
								'host',
								'port',
								'relative',
								'path',
								'directory',
								'file',
								'query',
								'anchor',
							];
						e.exports = function (t) {
							for (var e = r.exec(t || ''), i = {}, n = 14; n--; )
								i[o[n]] = e[n] || '';
							return i;
						};
					},
					{},
				],
				45: [
					function (t, e, i) {
						(function (h) {
							var u = t('isarray'),
								_ = t('./is-buffer');
							(i.deconstructPacket = function (t) {
								var s = [],
									e = t.data;
								return (
									(t.data = (function t(e) {
										if (!e) return e;
										if (_(e)) {
											var i = {
												_placeholder: !0,
												num: s.length,
											};
											return s.push(e), i;
										}
										if (u(e)) {
											for (
												var n = new Array(e.length),
													r = 0;
												r < e.length;
												r++
											)
												n[r] = t(e[r]);
											return n;
										}
										if (
											'object' != typeof e ||
											e instanceof Date
										)
											return e;
										var o,
											n = {};
										for (o in e) n[o] = t(e[o]);
										return n;
									})(e)),
									(t.attachments = s.length),
									{ packet: t, buffers: s }
								);
							}),
								(i.reconstructPacket = function (t, r) {
									return (
										(t.data = (function t(e) {
											if (e && e._placeholder)
												return r[e.num];
											if (u(e)) {
												for (
													var i = 0;
													i < e.length;
													i++
												)
													e[i] = t(e[i]);
												return e;
											}
											if (e && 'object' == typeof e) {
												for (var n in e) e[n] = t(e[n]);
												return e;
											}
											return e;
										})(t.data)),
										(t.attachments = void 0),
										t
									);
								}),
								(i.removeBlobs = function (t, c) {
									var a = 0,
										l = t;
									!(function t(e, i, n) {
										if (!e) return e;
										if (
											(h.Blob && e instanceof Blob) ||
											(h.File && e instanceof File)
										) {
											a++;
											var r = new FileReader();
											(r.onload = function () {
												n
													? (n[i] = this.result)
													: (l = this.result),
													--a || c(l);
											}),
												r.readAsArrayBuffer(e);
										} else if (u(e))
											for (var o = 0; o < e.length; o++)
												t(e[o], o, e);
										else if (
											e &&
											'object' == typeof e &&
											!_(e)
										)
											for (var s in e) t(e[s], s, e);
									})(l),
										a || c(l);
								});
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{ './is-buffer': 47, isarray: 48 },
				],
				46: [
					function (t, e, s) {
						var c = t('debug')('socket.io-parser'),
							a = t('json3'),
							i = (t('isarray'), t('component-emitter')),
							r = t('./binary'),
							n = t('./is-buffer');
						function o() {}
						function l(t) {
							var e = '',
								i = !1;
							return (
								(e += t.type),
								(s.BINARY_EVENT != t.type &&
									s.BINARY_ACK != t.type) ||
									((e += t.attachments), (e += '-')),
								t.nsp &&
									'/' != t.nsp &&
									((i = !0), (e += t.nsp)),
								null != t.id &&
									(i && ((e += ','), (i = !1)), (e += t.id)),
								null != t.data &&
									(i && (e += ','),
									(e += a.stringify(t.data))),
								c('encoded %j as %s', t, e),
								e
							);
						}
						function h() {
							this.reconstructor = null;
						}
						function u(t) {
							(this.reconPack = t), (this.buffers = []);
						}
						function _() {
							return { type: s.ERROR, data: 'parser error' };
						}
						(s.protocol = 4),
							(s.types = [
								'CONNECT',
								'DISCONNECT',
								'EVENT',
								'BINARY_EVENT',
								'ACK',
								'BINARY_ACK',
								'ERROR',
							]),
							(s.CONNECT = 0),
							(s.DISCONNECT = 1),
							(s.EVENT = 2),
							(s.ACK = 3),
							(s.ERROR = 4),
							(s.BINARY_EVENT = 5),
							(s.BINARY_ACK = 6),
							(s.Encoder = o),
							(s.Decoder = h),
							(o.prototype.encode = function (t, e) {
								var i, n;
								c('encoding packet %j', t),
									s.BINARY_EVENT == t.type ||
									s.BINARY_ACK == t.type
										? ((i = t),
										  (n = e),
										  r.removeBlobs(i, function (t) {
												var e = r.deconstructPacket(t),
													t = l(e.packet);
												(e = e.buffers).unshift(t),
													n(e);
										  }))
										: e([l(t)]);
							}),
							i(h.prototype),
							(h.prototype.add = function (t) {
								var e;
								if ('string' == typeof t)
									(e = (function (t) {
										var e = {},
											i = 0;
										if (
											((e.type = Number(t.charAt(0))),
											null == s.types[e.type])
										)
											return _();
										if (
											s.BINARY_EVENT == e.type ||
											s.BINARY_ACK == e.type
										) {
											for (
												var n = '';
												'-' != t.charAt(++i) &&
												((n += t.charAt(i)),
												i != t.length);

											);
											if (
												n != Number(n) ||
												'-' != t.charAt(i)
											)
												throw new Error(
													'Illegal attachments'
												);
											e.attachments = Number(n);
										}
										if ('/' == t.charAt(i + 1))
											for (e.nsp = ''; ++i; ) {
												if (',' == (o = t.charAt(i)))
													break;
												if (
													((e.nsp += o),
													i == t.length)
												)
													break;
											}
										else e.nsp = '/';
										var r = t.charAt(i + 1);
										if ('' !== r && Number(r) == r) {
											for (e.id = ''; ++i; ) {
												var o;
												if (
													null == (o = t.charAt(i)) ||
													Number(o) != o
												) {
													--i;
													break;
												}
												if (
													((e.id += t.charAt(i)),
													i == t.length)
												)
													break;
											}
											e.id = Number(e.id);
										}
										if (t.charAt(++i))
											try {
												e.data = a.parse(t.substr(i));
											} catch (t) {
												return _();
											}
										return c('decoded %s as %j', t, e), e;
									})(t)),
										s.BINARY_EVENT == e.type ||
										s.BINARY_ACK == e.type
											? ((this.reconstructor = new u(e)),
											  0 ===
													this.reconstructor.reconPack
														.attachments &&
													this.emit('decoded', e))
											: this.emit('decoded', e);
								else {
									if (!n(t) && !t.base64)
										throw new Error('Unknown type: ' + t);
									if (!this.reconstructor)
										throw new Error(
											'got binary data when not reconstructing a packet'
										);
									(e =
										this.reconstructor.takeBinaryData(t)) &&
										((this.reconstructor = null),
										this.emit('decoded', e));
								}
							}),
							(h.prototype.destroy = function () {
								this.reconstructor &&
									this.reconstructor.finishedReconstruction();
							}),
							(u.prototype.takeBinaryData = function (t) {
								if (
									(this.buffers.push(t),
									this.buffers.length !=
										this.reconPack.attachments)
								)
									return null;
								t = r.reconstructPacket(
									this.reconPack,
									this.buffers
								);
								return this.finishedReconstruction(), t;
							}),
							(u.prototype.finishedReconstruction = function () {
								(this.reconPack = null), (this.buffers = []);
							});
					},
					{
						'./binary': 45,
						'./is-buffer': 47,
						'component-emitter': 9,
						debug: 10,
						isarray: 48,
						json3: 49,
					},
				],
				47: [
					function (t, i, e) {
						(function (e) {
							i.exports = function (t) {
								return (
									(e.Buffer && e.Buffer.isBuffer(t)) ||
									(e.ArrayBuffer && t instanceof ArrayBuffer)
								);
							};
						}.call(
							this,
							'undefined' != typeof self
								? self
								: 'undefined' != typeof window
								? window
								: {}
						));
					},
					{},
				],
				48: [
					function (t, e, i) {
						e.exports = t(32);
					},
					{},
				],
				49: [
					function (t, e, T) {
						!(function (t) {
							var C,
								x,
								v = {}.toString,
								e = 'object' == typeof JSON && JSON,
								a =
									'object' == typeof T &&
									T &&
									!T.nodeType &&
									T;
							a && e
								? ((a.stringify = e.stringify),
								  (a.parse = e.parse))
								: (a = t.JSON = e || {});
							var h,
								E,
								A,
								b,
								c,
								R,
								i,
								P,
								u,
								l,
								I,
								w,
								D,
								_,
								d,
								p,
								f,
								m,
								n,
								r,
								o,
								s,
								L,
								g = new Date(-0xc782b5b800cec);
							try {
								g =
									-109252 == g.getUTCFullYear() &&
									0 === g.getUTCMonth() &&
									1 === g.getUTCDate() &&
									10 == g.getUTCHours() &&
									37 == g.getUTCMinutes() &&
									6 == g.getUTCSeconds() &&
									708 == g.getUTCMilliseconds();
							} catch (t) {}
							function y(t) {
								if (y[t] !== x) return y[t];
								var e;
								if ('bug-string-char-index' == t)
									e = 'a' != 'a'[0];
								else if ('json' == t)
									e = y('json-stringify') && y('json-parse');
								else {
									var i,
										n =
											'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';
									if ('json-stringify' == t) {
										var r = a.stringify,
											o = 'function' == typeof r && g;
										if (o) {
											(i = function () {
												return 1;
											}).toJSON = i;
											try {
												o =
													'0' === r(0) &&
													'0' === r(new Number()) &&
													'""' == r(new String()) &&
													r(v) === x &&
													r(x) === x &&
													r() === x &&
													'1' === r(i) &&
													'[1]' == r([i]) &&
													'[null]' == r([x]) &&
													'null' == r(null) &&
													'[null,null,null]' ==
														r([x, v, null]) &&
													r({
														a: [
															i,
															!0,
															!1,
															null,
															'\0\b\n\f\r   ',
														],
													}) == n &&
													'1' === r(null, i) &&
													'[\n 1,\n 2\n]' ==
														r([1, 2], null, 1) &&
													'"-271821-04-20T00:00:00.000Z"' ==
														r(new Date(-864e13)) &&
													'"+275760-09-13T00:00:00.000Z"' ==
														r(new Date(864e13)) &&
													'"-000001-01-01T00:00:00.000Z"' ==
														r(
															new Date(
																-621987552e5
															)
														) &&
													'"1969-12-31T23:59:59.999Z"' ==
														r(new Date(-1));
											} catch (t) {
												o = !1;
											}
										}
										e = o;
									}
									if ('json-parse' == t) {
										var s = a.parse;
										if ('function' == typeof s)
											try {
												if (0 === s('0') && !s(!1)) {
													var c =
														5 ==
															(i = s(n)).a
																.length &&
														1 === i.a[0];
													if (c) {
														try {
															c = !s('"    "');
														} catch (t) {}
														if (c)
															try {
																c =
																	1 !==
																	s('01');
															} catch (t) {}
														if (c)
															try {
																c =
																	1 !==
																	s('1.');
															} catch (t) {}
													}
												}
											} catch (t) {
												c = !1;
											}
										e = c;
									}
								}
								return (y[t] = !!e);
							}
							y('json') ||
								((h = '[object Function]'),
								(E = '[object Number]'),
								(A = '[object String]'),
								(b = '[object Array]'),
								(c = y('bug-string-char-index')),
								g ||
									((R = Math.floor),
									(i = [
										0, 31, 59, 90, 120, 151, 181, 212, 243,
										273, 304, 334,
									]),
									(P = function (t, e) {
										return (
											i[e] +
											365 * (t - 1970) +
											R((t - 1969 + (e = +(1 < e))) / 4) -
											R((t - 1901 + e) / 100) +
											R((t - 1601 + e) / 400)
										);
									})),
								(C = {}.hasOwnProperty) ||
									(C = function (t) {
										var i,
											e = { __proto__: null };
										return (
											(e.__proto__ = { toString: 1 }),
											(C =
												e.toString != v
													? function (t) {
															var e =
																	this
																		.__proto__,
																t =
																	t in
																	((this.__proto__ =
																		null),
																	this);
															return (
																(this.__proto__ =
																	e),
																t
															);
													  }
													: ((i = e.constructor),
													  function (t) {
															var e = (
																this
																	.constructor ||
																i
															).prototype;
															return (
																t in this &&
																!(
																	t in e &&
																	this[t] ===
																		e[t]
																)
															);
													  })),
											(e = null),
											C.call(this, t)
										);
									}),
								(u = {
									boolean: 1,
									number: 1,
									string: 1,
									undefined: 1,
								}),
								(L = function (t, e) {
									var i,
										l,
										n,
										r = 0;
									for (n in (((i = function () {
										this.valueOf = 0;
									}).prototype.valueOf = 0),
									(l = new i())))
										C.call(l, n) && r++;
									return (
										(i = l = null),
										(L = r
											? 2 == r
												? function (t, e) {
														var i,
															n = {},
															r = v.call(t) == h;
														for (i in t)
															(r &&
																'prototype' ==
																	i) ||
																C.call(n, i) ||
																!(n[i] = 1) ||
																!C.call(t, i) ||
																e(i);
												  }
												: function (t, e) {
														var i,
															n,
															r = v.call(t) == h;
														for (i in t)
															(r &&
																'prototype' ==
																	i) ||
																!C.call(t, i) ||
																(n =
																	'constructor' ===
																	i) ||
																e(i);
														(n ||
															C.call(
																t,
																(i =
																	'constructor')
															)) &&
															e(i);
												  }
											: ((l = [
													'valueOf',
													'toString',
													'toLocaleString',
													'propertyIsEnumerable',
													'isPrototypeOf',
													'hasOwnProperty',
													'constructor',
											  ]),
											  function (t, e) {
													var i,
														n,
														r,
														o,
														s,
														c = v.call(t) == h,
														a =
															c ||
															'function' ==
																typeof t.constructor ||
															('object' ==
															(s = typeof (r = t)[
																(o =
																	'hasOwnProperty')
															])
																? !r[o]
																: u[s])
																? C
																: t.hasOwnProperty;
													for (i in t)
														(c &&
															'prototype' == i) ||
															!a.call(t, i) ||
															e(i);
													for (
														n = l.length;
														(i = l[--n]);
														a.call(t, i) && e(i)
													);
											  }))(t, e)
									);
								}),
								y('json-stringify') ||
									((l = {
										92: '\\\\',
										34: '\\"',
										8: '\\b',
										12: '\\f',
										10: '\\n',
										13: '\\r',
										9: '\\t',
									}),
									(I = function (t, e) {
										return ('000000' + (e || 0)).slice(-t);
									}),
									(w = function (t) {
										var e,
											i = '"',
											n = 0,
											r = t.length,
											o = 10 < r && c;
										for (
											o && (e = t.split(''));
											n < r;
											n++
										) {
											var s = t.charCodeAt(n);
											switch (s) {
												case 8:
												case 9:
												case 10:
												case 12:
												case 13:
												case 34:
												case 92:
													i += l[s];
													break;
												default:
													if (s < 32) {
														i +=
															'\\u00' +
															I(
																2,
																s.toString(16)
															);
														break;
													}
													i += o
														? e[n]
														: c
														? t.charAt(n)
														: t[n];
											}
										}
										return i + '"';
									}),
									(D = function (t, e, i, n, r, o, s) {
										var c,
											a,
											l,
											h,
											u,
											_,
											d,
											p,
											f,
											m,
											g,
											y,
											T,
											S;
										try {
											c = e[t];
										} catch (t) {}
										if ('object' == typeof c && c)
											if (
												'[object Date]' !=
													(a = v.call(c)) ||
												C.call(c, 'toJSON')
											)
												'function' == typeof c.toJSON &&
													((a != E &&
														a != A &&
														a != b) ||
														C.call(c, 'toJSON')) &&
													(c = c.toJSON(t));
											else if (-1 / 0 < c && c < 1 / 0) {
												if (P) {
													for (
														u = R(c / 864e5),
															l =
																R(
																	u / 365.2425
																) +
																1970 -
																1;
														P(l + 1, 0) <= u;
														l++
													);
													for (
														h = R(
															(u - P(l, 0)) /
																30.42
														);
														P(l, h + 1) <= u;
														h++
													);
													(u = 1 + u - P(l, h)),
														(_ =
															R(
																(T =
																	((c %
																		864e5) +
																		864e5) %
																	864e5) /
																	36e5
															) % 24),
														(d = R(T / 6e4) % 60),
														(p = R(T / 1e3) % 60),
														(T = T % 1e3);
												} else
													(l = c.getUTCFullYear()),
														(h = c.getUTCMonth()),
														(u = c.getUTCDate()),
														(_ = c.getUTCHours()),
														(d = c.getUTCMinutes()),
														(p = c.getUTCSeconds()),
														(T =
															c.getUTCMilliseconds());
												c =
													(l <= 0 || 1e4 <= l
														? (l < 0 ? '-' : '+') +
														  I(6, l < 0 ? -l : l)
														: I(4, l)) +
													'-' +
													I(2, h + 1) +
													'-' +
													I(2, u) +
													'T' +
													I(2, _) +
													':' +
													I(2, d) +
													':' +
													I(2, p) +
													'.' +
													I(3, T) +
													'Z';
											} else c = null;
										if (
											(i && (c = i.call(e, t, c)),
											null === c)
										)
											return 'null';
										if (
											'[object Boolean]' ==
											(a = v.call(c))
										)
											return '' + c;
										if (a == E)
											return -1 / 0 < c && c < 1 / 0
												? '' + c
												: 'null';
										if (a == A) return w('' + c);
										if ('object' == typeof c) {
											for (y = s.length; y--; )
												if (s[y] === c)
													throw TypeError();
											if (
												(s.push(c),
												(f = []),
												(T = o),
												(o += r),
												a == b)
											) {
												for (
													g = 0, y = c.length;
													g < y;
													g++
												)
													(m = D(
														g,
														c,
														i,
														n,
														r,
														o,
														s
													)),
														f.push(
															m === x ? 'null' : m
														);
												S = f.length
													? r
														? '[\n' +
														  o +
														  f.join(',\n' + o) +
														  '\n' +
														  T +
														  ']'
														: '[' +
														  f.join(',') +
														  ']'
													: '[]';
											} else
												L(n || c, function (t) {
													var e = D(
														t,
														c,
														i,
														n,
														r,
														o,
														s
													);
													e !== x &&
														f.push(
															w(t) +
																':' +
																(r ? ' ' : '') +
																e
														);
												}),
													(S = f.length
														? r
															? '{\n' +
															  o +
															  f.join(
																	',\n' + o
															  ) +
															  '\n' +
															  T +
															  '}'
															: '{' +
															  f.join(',') +
															  '}'
														: '{}');
											return s.pop(), S;
										}
									}),
									(a.stringify = function (t, e, i) {
										var n, r, o, s;
										if (
											'function' == typeof e ||
											('object' == typeof e && e)
										)
											if ((s = v.call(e)) == h) r = e;
											else if (s == b) {
												o = {};
												for (
													var c, a = 0, l = e.length;
													a < l;
													c = e[a++],
														((s = v.call(c)) != A &&
															s != E) ||
															(o[c] = 1)
												);
											}
										if (i)
											if ((s = v.call(i)) == E) {
												if (0 < (i -= i % 1))
													for (
														n = '',
															10 < i && (i = 10);
														n.length < i;
														n += ' '
													);
											} else
												s == A &&
													(n =
														i.length <= 10
															? i
															: i.slice(0, 10));
										return D(
											'',
											(((c = {})[''] = t), c),
											r,
											o,
											n,
											'',
											[]
										);
									})),
								y('json-parse') ||
									((_ = String.fromCharCode),
									(d = {
										92: '\\',
										34: '"',
										47: '/',
										98: '\b',
										116: '  ',
										110: '\n',
										102: '\f',
										114: '\r',
									}),
									(m = function () {
										throw ((p = f = null), SyntaxError());
									}),
									(n = function () {
										for (
											var t,
												e,
												i,
												n,
												r,
												o = f,
												s = o.length;
											p < s;

										)
											switch ((r = o.charCodeAt(p))) {
												case 9:
												case 10:
												case 13:
												case 32:
													p++;
													break;
												case 123:
												case 125:
												case 91:
												case 93:
												case 58:
												case 44:
													return (
														(t = c
															? o.charAt(p)
															: o[p]),
														p++,
														t
													);
												case 34:
													for (t = '@', p++; p < s; )
														if (
															(r =
																o.charCodeAt(
																	p
																)) < 32
														)
															m();
														else if (92 == r)
															switch (
																(r =
																	o.charCodeAt(
																		++p
																	))
															) {
																case 92:
																case 34:
																case 47:
																case 98:
																case 116:
																case 110:
																case 102:
																case 114:
																	(t += d[r]),
																		p++;
																	break;
																case 117:
																	for (
																		e = ++p,
																			i =
																				p +
																				4;
																		p < i;
																		p++
																	)
																		(48 <=
																			(r =
																				o.charCodeAt(
																					p
																				)) &&
																			r <=
																				57) ||
																			(97 <=
																				r &&
																				r <=
																					102) ||
																			(65 <=
																				r &&
																				r <=
																					70) ||
																			m();
																	t += _(
																		'0x' +
																			o.slice(
																				e,
																				p
																			)
																	);
																	break;
																default:
																	m();
															}
														else {
															if (34 == r) break;
															for (
																r =
																	o.charCodeAt(
																		p
																	),
																	e = p;
																32 <= r &&
																92 != r &&
																34 != r;

															)
																r =
																	o.charCodeAt(
																		++p
																	);
															t += o.slice(e, p);
														}
													if (34 == o.charCodeAt(p))
														return p++, t;
													m();
												default:
													if (
														((e = p),
														45 == r &&
															((n = !0),
															(r = o.charCodeAt(
																++p
															))),
														48 <= r && r <= 57)
													) {
														for (
															48 == r &&
																48 <=
																	(r =
																		o.charCodeAt(
																			p +
																				1
																		)) &&
																r <= 57 &&
																m(),
																n = !1;
															p < s &&
															48 <=
																(r =
																	o.charCodeAt(
																		p
																	)) &&
															r <= 57;
															p++
														);
														if (
															46 ==
															o.charCodeAt(p)
														) {
															for (
																i = ++p;
																i < s &&
																48 <=
																	(r =
																		o.charCodeAt(
																			i
																		)) &&
																r <= 57;
																i++
															);
															i == p && m(),
																(p = i);
														}
														if (
															101 ==
																(r =
																	o.charCodeAt(
																		p
																	)) ||
															69 == r
														) {
															for (
																(43 !=
																	(r =
																		o.charCodeAt(
																			++p
																		)) &&
																	45 != r) ||
																	p++,
																	i = p;
																i < s &&
																48 <=
																	(r =
																		o.charCodeAt(
																			i
																		)) &&
																r <= 57;
																i++
															);
															i == p && m(),
																(p = i);
														}
														return +o.slice(e, p);
													}
													if (
														(n && m(),
														'true' ==
															o.slice(p, p + 4))
													)
														return (p += 4), !0;
													if (
														'false' ==
														o.slice(p, p + 5)
													)
														return (p += 5), !1;
													if (
														'null' ==
														o.slice(p, p + 4)
													)
														return (p += 4), null;
													m();
											}
										return '$';
									}),
									(r = function (t) {
										var e, i;
										if (
											('$' == t && m(),
											'string' == typeof t)
										) {
											if ('@' == (c ? t.charAt(0) : t[0]))
												return t.slice(1);
											if ('[' == t) {
												for (
													e = [];
													']' != (t = n());
													i = i || !0
												)
													!i ||
														(',' == t &&
															']' != (t = n())) ||
														m(),
														',' == t && m(),
														e.push(r(t));
												return e;
											}
											if ('{' == t) {
												for (
													e = {};
													'}' != (t = n());
													i = i || !0
												)
													!i ||
														(',' == t &&
															'}' != (t = n())) ||
														m(),
														(',' != t &&
															'string' ==
																typeof t &&
															'@' ==
																(c
																	? t.charAt(
																			0
																	  )
																	: t[0]) &&
															':' == n()) ||
															m(),
														(e[t.slice(1)] = r(
															n()
														));
												return e;
											}
											m();
										}
										return t;
									}),
									(o = function (t, e, i) {
										i = s(t, e, i);
										i === x ? delete t[e] : (t[e] = i);
									}),
									(s = function (t, e, i) {
										var n,
											r = t[e];
										if ('object' == typeof r && r)
											if (v.call(r) == b)
												for (n = r.length; n--; )
													o(r, n, i);
											else
												L(r, function (t) {
													o(r, t, i);
												});
										return i.call(t, e, r);
									}),
									(a.parse = function (t, e) {
										var i;
										return (
											(p = 0),
											(f = '' + t),
											(i = r(n())),
											'$' != n() && m(),
											(p = f = null),
											e && v.call(e) == h
												? s(
														(((t = {})[''] = i), t),
														'',
														e
												  )
												: i
										);
									})));
						})(this);
					},
					{},
				],
				50: [
					function (t, e, i) {
						e.exports = function (t, e) {
							for (
								var i = [], n = (e = e || 0) || 0;
								n < t.length;
								n++
							)
								i[n - e] = t[n];
							return i;
						};
					},
					{},
				],
			},
			{},
			[1]
		)(1);
	});
var gaf = gaf || {};
(gaf.COMPRESSION_NONE = 4669766),
	(gaf.COMPRESSION_ZIP = 4669763),
	(gaf.IDNONE = 4294967295),
	(gaf.FIRST_FRAME_INDEX = 0),
	(gaf.EFFECT_DROP_SHADOW = 0),
	(gaf.EFFECT_BLUR = 1),
	(gaf.EFFECT_GLOW = 2),
	(gaf.EFFECT_COLOR_MATRIX = 6),
	(gaf.ACTION_STOP = 0),
	(gaf.ACTION_PLAY = 1),
	(gaf.ACTION_GO_TO_AND_STOP = 2),
	(gaf.ACTION_GO_TO_AND_PLAY = 3),
	(gaf.ACTION_DISPATCH_EVENT = 4),
	(gaf.PI_FRAME = 0),
	(gaf.PI_EVENT_TYPE = 0),
	(gaf.TYPE_TEXTURE = 0),
	(gaf.TYPE_TEXT_FIELD = 1),
	(gaf.TYPE_TIME_LINE = 2),
	(gaf.UNIFORM_BLUR_TEXEL_OFFSET = 'u_step'),
	(gaf.UNIFORM_GLOW_TEXEL_OFFSET = 'u_step'),
	(gaf.UNIFORM_GLOW_COLOR = 'u_glowColor'),
	(gaf.UNIFORM_ALPHA_TINT_MULT = 'colorTransformMult'),
	(gaf.UNIFORM_ALPHA_TINT_OFFSET = 'colorTransformOffsets'),
	(gaf.UNIFORM_ALPHA_COLOR_MATRIX_BODY = 'colorMatrix'),
	(gaf.UNIFORM_ALPHA_COLOR_MATRIX_APPENDIX = 'colorMatrix2');
var gaf = gaf || {};
(gaf._tmp = gaf._tmp || {}),
	(gaf._initialized = !1),
	(gaf.CCGAFLoader = function () {
		this.load = function (t, e, i, n) {
			gaf._initialized || gaf._setup(),
				new gaf.Loader().LoadFile(t, function (t) {
					n(null, t);
				});
		};
	}),
	(gaf._setup = function () {
		gaf._setupShaders(), (gaf._initialized = !0);
	}),
	cc.loader.register('.gaf', new gaf.CCGAFLoader()),
	(gaf.CGAffineTransformCocosFormatFromFlashFormat = function (t) {
		var e = {};
		return (
			(e.a = t.a),
			(e.b = -t.b),
			(e.c = -t.c),
			(e.d = t.d),
			(e.tx = t.tx),
			(e.ty = -t.ty),
			e
		);
	}),
	(gaf._AssetPreload = function () {
		(this[0] = this.End),
			(this[1] = this.Atlases),
			(this[2] = this.AnimationMasks),
			(this[3] = this.AnimationObjects),
			(this[4] = this.AnimationFrames),
			(this[5] = this.NamedParts),
			(this[6] = this.Sequences),
			(this[7] = this.TextFields),
			(this[8] = this.Atlases),
			(this[9] = this.Stage),
			(this[10] = this.AnimationObjects),
			(this[11] = this.AnimationMasks),
			(this[12] = this.AnimationFrames),
			(this[13] = this.TimeLine);
	}),
	(gaf._AssetPreload.prototype.End = function (t, e, i) {
		i &&
			(i.getFps = function () {
				return t.getSceneFps();
			});
	}),
	(gaf._AssetPreload.prototype.Tag = function (t, e, i) {
		this[e.tagId].call(this, t, e.content, i);
	}),
	(gaf._AssetPreload.prototype.Tags = function (e, t, i) {
		var n = this;
		t.forEach(function (t) {
			n.Tag(e, t, i);
		});
	}),
	(gaf._AssetPreload.prototype.AtlasCreateFrames = function (t, n, r) {
		t.forEach(function (t) {
			var e = n._atlases[t.atlasId],
				i = cc.rect(t.origin.x, t.origin.y, t.size.x, t.size.y),
				i = new cc.SpriteFrame(e, i);
			(i._gafAnchor = {
				x: 0 - (0 - t.pivot.x / t.size.x),
				y: 1 - t.pivot.y / t.size.y,
			}),
				(r[t.elementAtlasId] = i);
		});
	}),
	(gaf._AssetPreload.prototype.Atlases = function (l, h, t) {
		var u = (l._atlasScales[h.scale] = l._atlasScales[h.scale] || []),
			_ = cc.Director._getInstance().getContentScaleFactor();
		h.atlases.forEach(function (t) {
			function e() {
				gaf._AssetPreload.AtlasCreateFrames(h.elements, l, u);
			}
			var i = t.id,
				n = '';
			t.sources.forEach(function (t) {
				t.csf === _ && (n = t.source);
			}),
				cc.assert(
					n,
					'GAF Error. Texture for current CSF not found. Reconvert animation with correct parameters.'
				),
				l._textureLoadDelegate && (n = l._textureLoadDelegate(n));
			for (
				var r = !1, o = l._getSearchPaths(n), s = 0, c = o.length;
				s < c;
				++s
			) {
				var a = o[s],
					a = cc.textureCache.getTextureForKey(a);
				if (a && a.isLoaded()) {
					a.handleLoadedTexture(!0),
						(r = !0),
						(l._atlases[i] = a),
						e();
					break;
				}
			}
			r ||
				(l._atlasesToLoad.hasOwnProperty(i) ||
					(gaf._AtlasLoader.loadArray(
						o,
						function (t) {
							t.handleLoadedTexture(!0), l._onAtlasLoaded(i, t);
						},
						function () {
							cc.log(
								"GAF Error. Couldn't find `" +
									n +
									'` required by `' +
									l.getGAFFileName() +
									'`'
							);
						}
					),
					(l._atlasesToLoad[i] = {})),
				l._onLoadTasks.push(e));
		});
	}),
	(gaf._AssetPreload.prototype.AnimationObjects = function (e, t, i) {
		t.forEach(function (t) {
			(t.type = void 0 === t.type ? gaf.TYPE_TEXTURE : t.type),
				i._objects.push(t.objectId),
				(e._objects[t.objectId] = t);
		});
	}),
	(gaf._AssetPreload.prototype.convertTint = function (t, e) {
		return t
			? {
					mult: {
						r: 255 * t.redMultiplier,
						g: 255 * t.greenMultiplier,
						b: 255 * t.blueMultiplier,
						a: 255 * e,
					},
					offset: {
						r: 255 * t.redOffset,
						g: 255 * t.greenOffset,
						b: 255 * t.blueOffset,
						a: 255 * t.alphaOffset,
					},
			  }
			: null;
	}),
	(gaf._AssetPreload.prototype.convertState = function (t) {
		return {
			hasColorTransform: t.hasColorTransform,
			hasMask: t.hasMask,
			hasEffect: t.hasEffect,
			objectIdRef: t.objectIdRef,
			depth: t.depth,
			alpha: 255 * t.alpha,
			matrix: gaf.CGAffineTransformCocosFormatFromFlashFormat(t.matrix),
			colorTransform: this.convertTint(t.colorTransform, t.alpha),
			effect: t.effect,
			maskObjectIdRef: t.maskObjectIdRef,
		};
	}),
	(gaf._AssetPreload.prototype.AnimationFrames = function (t, e, i) {
		var n = this;
		cc.assert(i, 'Error. Time Line should not be null.');
		for (var r = {}, o = [], s = 0, c = e.length; s < c; ++s) {
			var a = e[s];
			a.state &&
				a.state.forEach(function (t) {
					0 !== t.alpha
						? (r[t.objectIdRef] = n.convertState(t))
						: (r[t.objectIdRef] = null);
				});
			var l,
				h = [];
			for (l in r) r.hasOwnProperty(l) && r[l] && h.push(r[l]);
			o[a.frame - 1] = { states: h, actions: a.actions || null };
		}
		i.getFrames = function () {
			return o;
		};
	}),
	(gaf._AssetPreload.prototype.NamedParts = function (t, e, i) {
		var n = {};
		e.forEach(function (t) {
			n[t.name] = t.objectId;
		}),
			(i.getNamedParts = function () {
				return n;
			});
	}),
	(gaf._AssetPreload.prototype.Sequences = function (t, e, i) {
		var n = {};
		e.forEach(function (t) {
			n[t.id] = { start: t.start - 1, end: t.end };
		}),
			(i.getSequences = function () {
				return n;
			});
	}),
	(gaf._AssetPreload.prototype.TextFields = function (t, e, i) {}),
	(gaf._AssetPreload.prototype.Stage = function (t, e, i) {
		(t._sceneFps = e.fps),
			(t._sceneColor = e.color),
			(t._sceneWidth = e.width),
			(t._sceneHeight = e.height);
	}),
	(gaf._AssetPreload.prototype.AnimationMasks = function (e, t, i) {
		t.forEach(function (t) {
			(t.type = void 0 === t.type ? gaf.TYPE_TEXTURE : t.type),
				i._objects.push(t.objectId),
				(e._masks[t.objectId] = t);
		});
	}),
	(gaf._AssetPreload.prototype.TimeLine = function (t, e, i) {
		var n = new gaf._TimeLineProto(
			t,
			e.animationFrameCount,
			e.boundingBox,
			e.pivotPoint,
			e.id,
			e.linkageName
		);
		t._pushTimeLine(n), this.Tags(t, e.tags, n);
	}),
	(gaf._AssetPreload = new gaf._AssetPreload());
var gaf = gaf || {};
(gaf.Asset = cc.Class.extend({
	_className: 'GAFAsset',
	_header: null,
	_timeLines: null,
	_textFields: null,
	_protos: null,
	_objects: null,
	_masks: null,
	_rootTimeLine: null,
	_textureLoadDelegate: null,
	_sceneFps: 60,
	_sceneWidth: 0,
	_sceneHeight: 0,
	_sceneColor: 0,
	_gafData: null,
	_desiredAtlasScale: 1,
	_usedAtlasScale: 0,
	_atlases: null,
	_onLoadTasks: null,
	_atlasScales: null,
	_textureLoaded: !1,
	_atlasesToLoad: null,
	_gafName: null,
	initWithGAFFile: function (t, e) {
		var i = this;
		(this._textureLoadDelegate = e), (this._gafName = t);
		e = cc.loader.getRes(t);
		return e
			? this._init(e)
			: (cc.loader.load(t, function (t, e) {
					t || i._init(e[0]);
			  }),
			  !1);
	},
	initWithGAFBundle: function (t, e, i) {
		return cc.assert(!1, 'initWithGAFBundle is not yet implemented'), !1;
	},
	setRootTimelineWithName: function (t) {
		for (var e = 0, i = this._timeLines.length; e < i; ++e) {
			var n = this._timeLines[e];
			if (n && n.getLinkageName() === t)
				return void this._setRootTimeline(n);
		}
	},
	isAssetVersionPlayable: function () {
		return !0;
	},
	desiredAtlasScale: function () {
		return this._desiredAtlasScale;
	},
	setDesiredAtlasScale: function (t) {
		for (var e in ((this._desiredAtlasScale = t), this._atlasScales))
			this._atlasScales.hasOwnProperty(e) &&
				(0 === this._usedAtlasScale ||
					Math.abs(this._usedAtlasScale - t) > Math.abs(e - t)) &&
				(this._usedAtlasScale = e);
	},
	createObject: function () {
		return this._instantiateGaf(this._gafData);
	},
	createObjectAndRun: function (t) {
		cc.assert(
			1 === arguments.length,
			'GAFAsset::createObjectAndRun should have one param'
		);
		var e = this._instantiateGaf(this._gafData);
		return e.setLooped(t, !0), e.start(), e;
	},
	setTextureLoadDelegate: function (t) {},
	getSceneFps: function () {
		return this._sceneFps;
	},
	getSceneWidth: function () {},
	getSceneHeight: function () {},
	getSceneColor: function () {},
	setSceneFps: function (t) {
		this._sceneFps = t;
	},
	setSceneWidth: function (t) {},
	setSceneHeight: function (t) {},
	setSceneColor: function (t) {},
	getHeader: function () {
		return this._header;
	},
	getGAFFileName: function () {
		return this._gafName;
	},
	ctor: function () {
		(this._header = {}),
			(this._timeLines = []),
			(this._textFields = []),
			(this._objects = []),
			(this._masks = []),
			(this._protos = []),
			(this._atlases = {}),
			(this._onLoadTasks = []),
			(this._atlasScales = {}),
			(this._atlasesToLoad = {}),
			0 < arguments.length && this.initWithGAFFile.apply(this, arguments);
	},
	_getProtos: function () {
		return this._protos;
	},
	_setRootTimeline: function (t) {
		(this._rootTimeLine = t),
			(this._header.pivot = t.getPivot()),
			(this._header.frameSize = t.getRect());
	},
	_setHeader: function (t) {
		for (var e in t) t.hasOwnProperty(e) && (this._header[e] = t[e]);
	},
	_getMajorVerison: function () {
		return this._header.versionMajor;
	},
	_init: function (t) {
		var i = this;
		(this._gafData = t),
			this._setHeader(t.header),
			(this._timeLinesToLink = []),
			this._getMajorVerison() < 4 &&
				this._pushTimeLine(
					new gaf._TimeLineProto(
						this,
						this._header.framesCount,
						this._header.frameSize,
						this._header.pivot
					)
				),
			gaf._AssetPreload.Tags(this, t.tags, this._rootTimeLine),
			this._objects.forEach(function (t) {
				switch (t.type) {
					case gaf.TYPE_TEXTURE:
						i._protos[t.objectId] ||
							(i._protos[t.objectId] = new gaf._SpriteProto(
								i,
								i._atlasScales,
								t.elementAtlasIdRef
							));
						break;
					case gaf.TYPE_TIME_LINE:
						i._protos[t.objectId] =
							i._timeLines[t.elementAtlasIdRef];
						break;
					case gaf.TYPE_TEXT_FIELD:
						i._protos[t.objectId] =
							i._textFields[t.elementAtlasIdRef];
						break;
					default:
						cc.log('Unknown object type: ' + t.type);
				}
			}),
			this._masks.forEach(function (t) {
				if (!i._protos[t.objectId]) {
					var e = null;
					switch (t.type) {
						case gaf.TYPE_TEXTURE:
							e = new gaf._SpriteProto(
								i,
								i._atlasScales,
								t.elementAtlasIdRef
							);
							break;
						case gaf.TYPE_TIME_LINE:
							e = i._timeLines[t.elementAtlasIdRef];
							break;
						case gaf.TYPE_TEXT_FIELD:
							e = i._textFields[t.elementAtlasIdRef];
					}
					i._protos[t.objectId] = new gaf._MaskProto(
						i,
						e,
						t.elementAtlasIdRef
					);
				}
			}),
			this.setDesiredAtlasScale(this._desiredAtlasScale),
			0 === Object.keys(this._atlasesToLoad).length &&
				((this._textureLoaded = !0), this.dispatchEvent('load'));
	},
	_pushTimeLine: function (t) {
		0 === (this._timeLines[t.getId()] = t).getId() &&
			this._setRootTimeline(t);
	},
	_instantiateGaf: function () {
		return this._rootTimeLine._gafConstruct();
	},
	_onAtlasLoaded: function (t, e) {
		(this._atlases[t] = e),
			delete this._atlasesToLoad[t],
			0 === Object.keys(this._atlasesToLoad).length &&
				(this._onLoadTasks.forEach(function (t) {
					t();
				}),
				(this._onLoadTasks.length = 0),
				(this._textureLoaded = !0),
				this.dispatchEvent('load'));
	},
	isLoaded: function () {
		return this._textureLoaded;
	},
	_getSearchPaths: function (t) {
		var e = this.getGAFFileName().split('/');
		return [(e[e.length - 1] = t), e.join('/')];
	},
})),
	(gaf.Asset.create = function (t, e) {
		return new gaf.Asset(t, e);
	}),
	(gaf.Asset.createWithBundle = function (t, e, i) {
		var n = new gaf.Asset();
		return n.initWithGAFBundle(t, e, i), n;
	}),
	cc.EventHelper.prototype.apply(gaf.Asset.prototype);
var gaf = gaf || {};
(gaf._stateHasCtx = function (t) {
	if (
		t.hasColorTransform &&
		(0 < t.colorTransform.offset.r ||
			0 < t.colorTransform.offset.g ||
			0 < t.colorTransform.offset.b ||
			0 < t.colorTransform.offset.a)
	)
		return !0;
	if (t.hasEffect)
		for (var e = 0, i = t.effect.length; e < i; ++e)
			if (t.effect[e].type === gaf.EFFECT_COLOR_MATRIX) return !0;
	return !1;
}),
	(gaf.Object = cc.Node.extend({
		_asset: null,
		_className: 'GAFObject',
		_id: gaf.IDNONE,
		_gafproto: null,
		_parentTimeLine: null,
		_lastVisibleInFrame: 0,
		_filterStack: null,
		_cascadeColorMult: null,
		_cascadeColorOffset: null,
		_needsCtx: !1,
		_usedAtlasScale: 1,
		ctor: function (t) {
			1 == arguments.length && (this._usedAtlasScale = t),
				this._super(),
				(this._cascadeColorMult = cc.color(255, 255, 255, 255)),
				(this._cascadeColorOffset = cc.color(0, 0, 0, 0)),
				(this._filterStack = []);
		},
		setAnimationStartedNextLoopDelegate: function (t) {},
		setAnimationFinishedPlayDelegate: function (t) {},
		setLooped: function (t) {},
		getBoundingBoxForCurrentFrame: function () {
			return null;
		},
		setFps: function (t) {},
		getObjectByName: function (t) {
			return null;
		},
		clearSequence: function () {},
		getIsAnimationRunning: function () {
			return !1;
		},
		getSequences: function () {
			return [];
		},
		gotoAndStop: function (t) {},
		getStartFrame: function (t) {
			return gaf.IDNONE;
		},
		setFramePlayedDelegate: function (t) {},
		getCurrentFrameIndex: function () {
			return gaf.IDNONE;
		},
		getTotalFrameCount: function () {
			return 0;
		},
		start: function () {},
		stop: function () {},
		isVisibleInCurrentFrame: function () {
			return !(
				this._parentTimeLine &&
				this._parentTimeLine.getCurrentFrameIndex() + 1 !=
					this._lastVisibleInFrame
			);
		},
		isDone: function () {
			return !0;
		},
		playSequence: function (t, e, i) {
			return !1;
		},
		isReversed: function () {
			return !1;
		},
		setSequenceDelegate: function (t) {},
		setFrame: function (t) {
			return !1;
		},
		setControlDelegate: function (t) {},
		getEndFrame: function (t) {
			return gaf.IDNONE;
		},
		pauseAnimation: function () {},
		gotoAndPlay: function (t) {},
		isLooped: function () {
			return !1;
		},
		resumeAnimation: function () {},
		setReversed: function (t) {},
		hasSequences: function () {
			return !1;
		},
		getFps: function () {
			return 60;
		},
		setLocator: function (t) {},
		setExternalTransform: function (t) {
			cc.affineTransformEqualToTransform(this._additionalTransform, t) ||
				this.setAdditionalTransform(t);
		},
		getExternalTransform: function () {
			return this._additionalTransform;
		},
		setAnimationRunning: function () {},
		_enableTick: function (t) {},
		_resetState: function () {},
		_updateVisibility: function (t, e) {
			var i = t.hasColorTransform ? t.colorTransform.offset.a : 0;
			this.setOpacity(t.alpha + i);
		},
		isVisible: function () {
			return 0 < this.getOpacity();
		},
		visit: function (t) {
			this.isVisibleInCurrentFrame() && this._super(t);
		},
		_getFilters: function () {
			return null;
		},
		_processAnimation: function () {},
		_applyState: function (t, e) {
			this._applyStateSuper(t, e);
		},
		_applyStateSuper: function (t, e) {
			var i;
			(this._needsCtx = e._needsCtx),
				(this._filterStack.length = 0),
				(this._parentTimeLine = e),
				1 != this._usedAtlasScale
					? (((i = cc.clone(t.matrix)).tx *= this._usedAtlasScale),
					  (i.ty *= this._usedAtlasScale),
					  this.setExternalTransform(i))
					: this.setExternalTransform(t.matrix),
				t.hasEffect &&
					((this._filterStack = this._filterStack.concat(t.effect)),
					(this._needsCtx = !0)),
				e._filterStack &&
					0 < e._filterStack.length &&
					(this._filterStack = this._filterStack.concat(
						e._filterStack
					)),
				0 < this._filterStack.length &&
					this._filterStack[0].type === gaf.EFFECT_COLOR_MATRIX &&
					(this._needsCtx = !0),
				t.hasColorTransform
					? ((this._cascadeColorMult.r =
							(t.colorTransform.mult.r * e._cascadeColorMult.r) /
							255),
					  (this._cascadeColorMult.g =
							(t.colorTransform.mult.g * e._cascadeColorMult.g) /
							255),
					  (this._cascadeColorMult.b =
							(t.colorTransform.mult.b * e._cascadeColorMult.b) /
							255),
					  (this._cascadeColorMult.a =
							(t.colorTransform.mult.a * e._cascadeColorMult.a) /
							255),
					  (this._cascadeColorOffset.r =
							t.colorTransform.offset.r +
							e._cascadeColorOffset.r),
					  (this._cascadeColorOffset.g =
							t.colorTransform.offset.g +
							e._cascadeColorOffset.g),
					  (this._cascadeColorOffset.b =
							t.colorTransform.offset.b +
							e._cascadeColorOffset.b),
					  (this._cascadeColorOffset.a =
							t.colorTransform.offset.a +
							e._cascadeColorOffset.a))
					: ((this._cascadeColorMult.r = e._cascadeColorMult.r),
					  (this._cascadeColorMult.g = e._cascadeColorMult.g),
					  (this._cascadeColorMult.b = e._cascadeColorMult.b),
					  (this._cascadeColorMult.a =
							t.alpha * (e._cascadeColorMult.a / 255)),
					  (this._cascadeColorOffset.r = e._cascadeColorOffset.r),
					  (this._cascadeColorOffset.g = e._cascadeColorOffset.g),
					  (this._cascadeColorOffset.b = e._cascadeColorOffset.b),
					  (this._cascadeColorOffset.a = e._cascadeColorOffset.a)),
				(0 < this._cascadeColorOffset.r ||
					0 < this._cascadeColorOffset.g ||
					0 < this._cascadeColorOffset.b ||
					0 < this._cascadeColorOffset.a) &&
					(this._needsCtx = !0);
		},
		_initRendererCmd: function () {
			(this._renderCmd = cc.renderer.getRenderCmd(this)),
				(this._renderCmd._visit = this._renderCmd.visit);
			var e = this;
			this._renderCmd.visit = function (t) {
				e.isVisibleInCurrentFrame() && this._visit(t);
			};
		},
		_getNode: function () {
			return this;
		},
		setAnchorPoint: function (t, e) {
			void 0 === e ? this._super(t.x, t.y - 1) : this._super(t, e - 1);
		},
	})),
	(gaf.Object._createNullObject = function () {
		var t = new gaf.Object();
		return (
			(t.isVisible = function () {
				return !0;
			}),
			t
		);
	}),
	(gaf.TimeLine = gaf.Object.extend({
		_className: 'GAFTimeLine',
		_objects: null,
		_container: null,
		_animationStartedNextLoopDelegate: null,
		_animationFinishedPlayDelegate: null,
		_framePlayedDelegate: null,
		_sequenceDelegate: null,
		_fps: 60,
		_frameTime: 1 / 60,
		_currentSequenceStart: gaf.FIRST_FRAME_INDEX,
		_currentSequenceEnd: gaf.FIRST_FRAME_INDEX,
		_totalFrameCount: 0,
		_isRunning: !1,
		_isLooped: !1,
		_isReversed: !1,
		_timeDelta: 0,
		_animationsSelectorScheduled: !1,
		_currentFrame: gaf.FIRST_FRAME_INDEX,
		setAnimationStartedNextLoopDelegate: function (t) {
			this._animationStartedNextLoopDelegate = t;
		},
		setAnimationFinishedPlayDelegate: function (t) {
			this._animationFinishedPlayDelegate = t;
		},
		setLooped: function (e, i) {
			(this._isLooped = e),
				i &&
					this._objects.forEach(function (t) {
						t.setLooped(e, i);
					});
		},
		getBoundingBoxForCurrentFrame: function () {
			var i = null,
				n = !0;
			return (
				this._objects.forEach(function (t) {
					var e;
					t.isVisibleInCurrentFrame() &&
						t.isVisible() &&
						((e =
							(e = t.getBoundingBoxForCurrentFrame()) ||
							t.getBoundingBox()),
						(i = n ? ((n = !1), e) : cc.rectUnion(i, e)));
				}),
				cc._rectApplyAffineTransformIn(
					i,
					this._container.getNodeToParentTransform()
				)
			);
		},
		setFps: function (t) {
			cc.assert(0 !== t, 'Error! Fps is set to zero.'),
				(this._fps = t),
				(this._frameTime = 1 / t);
		},
		getObjectByName: function (e) {
			var t = e.split('.'),
				i = null,
				n = -1,
				r = this,
				o = {};
			try {
				t.forEach(function (t) {
					var e = r._gafproto.getNamedParts();
					if (!e.hasOwnProperty(t)) throw ((o.lastElement = t), o);
					(n = e[t]), (i = r._objects[n]), (r = i);
				});
			} catch (t) {
				if (t !== o) throw t;
				return (
					cc.log(
						'Sequence incorrect: `' +
							e +
							'` At: `' +
							o.lastElement +
							'`'
					),
					null
				);
			}
			return i;
		},
		clearSequence: function () {
			(this._currentSequenceStart = gaf.FIRST_FRAME_INDEX),
				(this._currentSequenceEnd = this._gafproto.getTotalFrames());
		},
		getIsAnimationRunning: function () {
			return this._isRunning;
		},
		gotoAndStop: function (t) {
			var e = 0,
				e = 'string' == typeof t ? this.getStartFrame(t) : t;
			return !!this.setFrame(e) && (this.setAnimationRunning(!1, !1), !0);
		},
		gotoAndPlay: function (t) {
			var e = 0,
				e = 'string' == typeof t ? this.getStartFrame(t) : t;
			return !!this.setFrame(e) && (this.setAnimationRunning(!0, !1), !0);
		},
		getStartFrame: function (t) {
			t = this._gafproto.getSequences()[t];
			return t ? t.start : gaf.IDNONE;
		},
		getEndFrame: function (t) {
			t = this._gafproto.getSequences()[t];
			return t ? t.end : gaf.IDNONE;
		},
		setFramePlayedDelegate: function (t) {
			this._framePlayedDelegate = t;
		},
		getCurrentFrameIndex: function () {
			return this._showingFrame;
		},
		getTotalFrameCount: function () {
			return this._gafproto.getTotalFrames();
		},
		start: function () {
			this._enableTick(!0),
				this._isRunning ||
					((this._currentFrame = gaf.FIRST_FRAME_INDEX),
					this.setAnimationRunning(!0, !0));
		},
		stop: function () {
			this._enableTick(!1),
				this._isRunning &&
					((this._currentFrame = gaf.FIRST_FRAME_INDEX),
					this.setAnimationRunning(!1, !0));
		},
		isDone: function () {
			return (
				!this._isLooped &&
				(this._isReversed
					? this._currentFrame < gaf.FIRST_FRAME_INDEX - 1
					: this._currentFrame > this._totalFrameCount)
			);
		},
		getSequences: function () {
			return this._gafproto.getSequences();
		},
		playSequence: function (t, e) {
			var i = this.getStartFrame(t),
				t = this.getEndFrame(t);
			return (
				gaf.IDNONE !== i &&
				gaf.IDNONE !== t &&
				((this._currentSequenceStart = i),
				(this._currentSequenceEnd = t),
				this._currentFrame < this._currentSequenceStart ||
					(this._currentFrame, this._currentSequenceEnd),
				(this._currentFrame = this._currentSequenceStart),
				this.setLooped(e, !1),
				this.resumeAnimation(),
				!0)
			);
		},
		isReversed: function () {
			return this._isReversed;
		},
		setSequenceDelegate: function (t) {
			this._sequenceDelegate = t;
		},
		setFrame: function (t) {
			return (
				t >= gaf.FIRST_FRAME_INDEX &&
				t < this._totalFrameCount &&
				((this._showingFrame = t),
				(this._currentFrame = t),
				this._processAnimation(),
				!0)
			);
		},
		pauseAnimation: function () {
			this._isRunning && this.setAnimationRunning(!1, !1);
		},
		isLooped: function () {
			return this._isLooped;
		},
		resumeAnimation: function () {
			this._isRunning || this.setAnimationRunning(!0, !1);
		},
		setReversed: function (t) {
			this._isReversed = t;
		},
		hasSequences: function () {
			return 0 < this._gafproto.getSequences().length;
		},
		getFps: function () {
			return this._fps;
		},
		ctor: function (t, e) {
			this._super(e),
				(this._objects = []),
				cc.assert(t, 'Error! Missing mandatory parameter.'),
				(this._gafproto = t);
		},
		setExternalTransform: function (t) {
			cc.affineTransformEqualToTransform(
				this._container._additionalTransform,
				t
			) || this._container.setAdditionalTransform(t);
		},
		_init: function () {
			this.setContentSize(this._gafproto.getBoundingBox()),
				(this._currentSequenceEnd = this._gafproto.getTotalFrames()),
				(this._totalFrameCount = this._currentSequenceEnd),
				this.setFps(this._gafproto.getFps()),
				(this._container = new cc.Node()),
				this.addChild(this._container);
			var i = this,
				n = this._gafproto.getAsset();
			this._gafproto.getObjects().forEach(function (t) {
				var e = n._getProtos()[t];
				cc.assert(
					e,
					'Error. GAF proto for type: ' +
						t.type +
						' and reference id: ' +
						t +
						' not found.'
				),
					(i._objects[t] = e._gafConstruct());
			});
		},
		_enableTick: function (t) {
			!this._animationsSelectorScheduled && t
				? (this.schedule(this._processAnimations),
				  (this._animationsSelectorScheduled = !0))
				: this._animationsSelectorScheduled &&
				  !t &&
				  (this.unschedule(this._processAnimations),
				  (this._animationsSelectorScheduled = !1));
		},
		_processAnimations: function (t) {
			for (this._timeDelta += t; this._timeDelta >= this._frameTime; )
				(this._timeDelta -= this._frameTime), this._step();
		},
		_step: function () {
			var t;
			(this._showingFrame = this._currentFrame),
				this.getIsAnimationRunning()
					? (!this._sequenceDelegate ||
							((t = this._isReversed
								? this._getSequenceByFirstFrame(
										this._currentFrame + 1
								  )
								: this._getSequenceByLastFrame(
										this._currentFrame
								  )) &&
								this._sequenceDelegate(this, t)),
					  this._isCurrentFrameLastInSequence() &&
							(this._isLooped
								? this._animationStartedNextLoopDelegate &&
								  this._animationStartedNextLoopDelegate(this)
								: (this.setAnimationRunning(!1, !1),
								  this._animationFinishedPlayDelegate &&
										this._animationFinishedPlayDelegate(
											this
										))),
					  this._processAnimation(),
					  (this._currentFrame = this._nextFrame()))
					: this._processAnimation();
		},
		_isCurrentFrameLastInSequence: function () {
			return this._isReversed
				? this._currentFrame == this._currentSequenceStart
				: this._currentFrame == this._currentSequenceEnd - 1;
		},
		_nextFrame: function () {
			return this._isCurrentFrameLastInSequence()
				? this._isLooped
					? this._isReversed
						? this._currentSequenceEnd - 1
						: this._currentSequenceStart
					: this._currentFrame
				: this._currentFrame + (this._isReversed ? -1 : 1);
		},
		_processAnimation: function () {
			this._realizeFrame(this._container, this._currentFrame),
				this._framePlayedDelegate &&
					this._framePlayedDelegate(this, this._currentFrame);
		},
		_realizeFrame: function (t, e) {
			var i = this._objects,
				n = this._gafproto.getFrames();
			if (!(e > n.length)) {
				n = n[e];
				if (n)
					for (var r = n.states, o = 0, s = r.length; o < s; ++o) {
						var c,
							a = r[o],
							l = i[a.objectIdRef];
						if (!l) return;
						a.alpha < 0 && l._resetState(),
							l._updateVisibility(a, this),
							l.isVisible() &&
								(l._applyState(a, this),
								(c = t),
								a.hasMask &&
									((c = i[a.maskObjectIdRef]._getNode()),
									cc.assert(c, 'Error! Mask not found.')),
								(l._lastVisibleInFrame = 1 + e),
								gaf.TimeLine.rearrangeSubobject(c, l, a.depth),
								l._step && l._step());
					}
			}
		},
		setAnimationRunning: function (e, i) {
			(this._isRunning = e),
				i &&
					this._objects.forEach(function (t) {
						t &&
							t.setAnimationRunning &&
							t.setAnimationRunning(e, i);
					});
		},
		_getSequenceByLastFrame: function () {
			var t,
				e = this._gafproto.getSequences();
			for (t in e)
				if (e.hasOwnProperty(t) && e[t].end === frame + 1) return t;
			return '';
		},
		_resetState: function () {
			this._super(), (this._currentFrame = this._currentSequenceStart);
		},
		_getSequenceByFirstFrame: function () {
			var t,
				e = this._gafproto.getSequences();
			for (t in e)
				if (e.hasOwnProperty(t) && e[t].start === frame) return t;
			return '';
		},
	})),
	(gaf.TimeLine.rearrangeSubobject = function (t, e, i) {
		e.getParent() !== t
			? (e.removeFromParent(!1), t.addChild(e, i))
			: e.setLocalZOrder(i);
	}),
	(gaf.TextField = gaf.Object.extend({ _className: 'GAFTextField' })),
	(gaf.Sprite = gaf.Object.extend({
		_className: 'GAFSprite',
		_hasCtx: !1,
		_hasFilter: !1,
		ctor: function (t, e) {
			this._super(e),
				cc.assert(t, 'Error! Missing mandatory parameter.'),
				(this._gafproto = t);
		},
		_init: function () {
			var t = this._gafproto.getFrame();
			cc.assert(t instanceof cc.SpriteFrame, 'Error. Wrong object type.'),
				(this._sprite = new cc.Sprite()),
				(this._sprite._renderCmd = this._gafCreateRenderCmd(
					this._sprite
				)),
				this._sprite.initWithSpriteFrame(t),
				this._sprite.setAnchorPoint(this._gafproto.getAnchor()),
				this.addChild(this._sprite),
				this._sprite.setOpacityModifyRGB(!0),
				cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					this._sprite.setBlendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
		},
		_applyState: function (t, e) {
			this._applyStateSuper(t, e),
				this._needsCtx
					? (this._hasCtx || (this._enableCtx(), (this._hasCtx = !0)),
					  this._applyCtxState(t))
					: (this._hasCtx &&
							(this._disableCtx(), (this._hasCtx = !1)),
					  cc.colorEqual(
							this._sprite._realColor,
							this._cascadeColorMult
					  ) || this._sprite.setColor(this._cascadeColorMult),
					  this._sprite.getOpacity() != this._cascadeColorMult.a &&
							this._sprite.setOpacity(this._cascadeColorMult.a));
		},
		_enableCtx: function () {
			this._sprite._renderCmd._enableCtx();
		},
		_disableCtx: function () {
			this._sprite._renderCmd._disableCtx();
		},
		_applyCtxState: function (t) {
			this._sprite._renderCmd._applyCtxState(this);
		},
		getBoundingBoxForCurrentFrame: function () {
			var t = this._sprite.getBoundingBox();
			return cc._rectApplyAffineTransformIn(
				t,
				this.getNodeToParentTransform()
			);
		},
		_gafCreateRenderCmd: function (t) {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? gaf.Sprite.CanvasRenderCmd
					: gaf.Sprite.WebGLRenderCmd
			)(t);
		},
	})),
	(gaf.Mask = gaf.Object.extend({
		_className: 'GAFMask',
		_clippingNode: null,
		ctor: function (t) {
			this._super(),
				cc.assert(t, 'Error! Missing mandatory parameter.'),
				(this._gafproto = t);
		},
		_init: function () {
			var t = this._gafproto.getMaskNodeProto();
			cc.assert(
				t,
				'Error. Mask node for id ref ' +
					this._gafproto.getIdRef() +
					' not found.'
			),
				(this._maskNode = t._gafConstruct()),
				(this._clippingNode = cc.ClippingNode.create(this._maskNode)),
				this._clippingNode.setAlphaThreshold(0.5),
				this.addChild(this._clippingNode);
		},
		setExternalTransform: function (t) {
			cc.affineTransformEqualToTransform(
				this._maskNode._additionalTransform,
				t
			) || this._maskNode.setAdditionalTransform(t);
		},
		_getNode: function () {
			return this._clippingNode;
		},
	})),
	(function () {
		gaf.Sprite.CanvasRenderCmd = function (t) {
			cc.Sprite.CanvasRenderCmd.call(this, t),
				(this._hasTintMult = !1),
				(this._hasTintOffset = !1),
				(this._hasCtx = !1),
				(this._tintMult = cc.color(255, 255, 255, 255)),
				(this._tintOffset = cc.color(0, 0, 0, 0)),
				(this._textureDirty = !1);
		};
		var t = (gaf.Sprite.CanvasRenderCmd.prototype = Object.create(
			cc.Sprite.CanvasRenderCmd.prototype
		));
		(t.constructor = gaf.Sprite.CanvasRenderCmd),
			(t._disableCtx = function () {
				(this._hasTintOffset = !1),
					(this._hasCtx = !1),
					(this._textureDirty = !0),
					this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),
					(this._tintMult = cc.color(255, 255, 255, 255)),
					(this._tintOffset = cc.color(0, 0, 0, 0));
			}),
			(t._enableCtx = function () {}),
			(t._applyCtxState = function (t) {
				var e = t._cascadeColorMult,
					i = t._cascadeColorOffset,
					n = e.a;
				this._node.getOpacity() != n && this._node.setOpacity(n);
				n = !cc.colorEqual(this._tintMult, e);
				n &&
					(this._node.setColor(e),
					(this._tintMult = e),
					(this._hasTintMult =
						255 !== e.r || 255 !== e.g || 255 !== e.b));
				e =
					this._tintOffset.r != i.r ||
					this._tintOffset.g != i.g ||
					this._tintOffset.b != i.b ||
					this._tintOffset.a != i.a;
				e &&
					((this._tintOffset = i),
					(this._hasTintOffset =
						0 !== i.r || 0 !== i.g || 0 !== i.b || 0 !== i.a)),
					(this._textureDirty = n || e),
					this._textureDirty &&
						this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),
					(this._hasCtx =
						0 < t._filterStack.length &&
						t._filterStack[0].type === gaf.EFFECT_COLOR_MATRIX);
			}),
			(t.rendering = function (t, e, i) {
				var n,
					r,
					o,
					s,
					c,
					a = this._node,
					l = this._textureCoord,
					h = this._displayedOpacity / 255;
				(!a._texture ||
					(0 !== l.width &&
						0 !== l.height &&
						a._texture._textureLoaded)) &&
					0 != h &&
					((r = (n = t || cc._renderContext).getContext()),
					(o = a._offsetPosition.x),
					(s = a._rect.height),
					(c = a._rect.width),
					(t = -a._offsetPosition.y - s),
					n.setTransform(this._worldTransform, e, i),
					n.setCompositeOperation(this._blendFuncStr),
					n.setGlobalAlpha(h),
					(a._flippedX || a._flippedY) && n.save(),
					a._flippedX && ((o = -o - c), r.scale(-1, 1)),
					a._flippedY && ((t = a._offsetPosition.y), r.scale(1, -1)),
					(h = a._texture._htmlElementObj),
					this._colorized
						? r.drawImage(
								h,
								0,
								0,
								l.width,
								l.height,
								o * e,
								t * i,
								c * e,
								s * i
						  )
						: r.drawImage(
								h,
								l.renderX,
								l.renderY,
								l.width,
								l.height,
								o * e,
								t * i,
								c * e,
								s * i
						  ),
					(a._flippedX || a._flippedY) && n.restore(),
					cc.g_NumberOfDraws++);
			}),
			cc.sys._supportCanvasNewBlendModes &&
				((t._updateColor = function () {
					var t = this._displayedColor,
						e = this._node;
					if (
						((this._hasTintMult |=
							255 !== t.r || 255 !== t.g || 255 !== t.b),
						this._textureDirty)
					) {
						(this._textureDirty = !1),
							this._colorized &&
								((this._colorized = !1),
								(e.texture = this._originalTexture));
						var i,
							n,
							r = e._texture,
							o = this._textureCoord;
						if (
							this._hasTintMult &&
							r &&
							o.validRect &&
							this._originalTexture
						) {
							if (!(n = r.getHtmlElementObj())) return;
							(this._colorized = !0),
								(this._hasTintOffset || this._hasCtx) &&
									(t = this._tintMult),
								(n =
									cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(
										this._originalTexture._htmlElementObj,
										t,
										o
									)),
								(r = new cc.Texture2D()).initWithElement(n),
								r.handleLoadedTexture(),
								(e.texture = r);
						}
						(r = e._texture),
							this._hasTintOffset &&
								((i = cc.textureCache.getTextureColors(
									this._originalTexture.getHtmlElementObj()
								)),
								r &&
									o.validRect &&
									this._originalTexture &&
									(n = r.getHtmlElementObj()) &&
									((t = this._colorized
										? cc.rect(0, 0, o.width, o.height)
										: o),
									(n = this._gafGenerateTintImage(
										e.texture._htmlElementObj,
										t,
										i,
										this._tintOffset,
										o
									)),
									(r = new cc.Texture2D()).initWithElement(n),
									r.handleLoadedTexture(),
									(e.texture = r),
									(this._colorized = !0)));
					}
				}),
				(t._gafGenerateTintImage = function (t, e, i, n, r, o) {
					r = r || cc.rect(0, 0, t.width, t.height);
					var s,
						c = Math.min(r.width, i[0].width),
						a = Math.min(r.height, i[0].height),
						o = o;
					return (
						o
							? (s = o.getContext('2d')).clearRect(0, 0, c, a)
							: (((o = document.createElement('canvas')).width =
									c),
							  (o.height = a),
							  (s = o.getContext('2d'))),
						s.save(),
						(s.globalCompositeOperation = 'source-over'),
						s.drawImage(i[2], r.x, r.y, c, a, 0, 0, c, a),
						(s.globalCompositeOperation = 'source-in'),
						(s.fillStyle =
							'rgba(' +
							Math.round(n.r) +
							',' +
							Math.round(n.g) +
							',' +
							Math.round(n.b) +
							',1)'),
						s.fillRect(0, 0, c, a),
						(s.globalCompositeOperation = 'lighter'),
						s.drawImage(t, e.x, e.y, c, a, 0, 0, c, a),
						s.restore(),
						o
					);
				}));
	})(),
	(gaf._TimeLineProto = function (t, e, i, n, r, o) {
		(r = void 0 !== r ? r : 0),
			(o = o || ''),
			(this._objects = []),
			(this.getTotalFrames = function () {
				return e;
			}),
			(this.getBoundingBox = function () {
				return i;
			}),
			(this.getId = function () {
				return r;
			}),
			(this.getLinkageName = function () {
				return o;
			}),
			(this.getPivot = function () {
				return n;
			}),
			(this.getRect = function () {
				return i;
			}),
			(this.getNamedParts = function () {
				return {};
			}),
			(this.getSequences = function () {
				return {};
			}),
			(this.getFrames = function () {
				return [];
			}),
			(this.getFps = function () {
				return 60;
			}),
			(this.getObjects = function () {
				return this._objects;
			}),
			(this.getAsset = function () {
				return t;
			}),
			(this._gafConstruct = function () {
				var t = this.getAsset()._usedAtlasScale,
					t = new gaf.TimeLine(this, t);
				return t._init(), t;
			});
	}),
	(gaf._SpriteProto = function (t, e, i) {
		(this.getFrames = function () {
			return e;
		}),
			(this.getIdRef = function () {
				return i;
			}),
			(this.getAsset = function () {
				return t;
			}),
			(this._gafConstruct = function () {
				var t = this.getAsset()._usedAtlasScale,
					t = new gaf.Sprite(this, t);
				return t._init(), t;
			});
	}),
	(gaf._SpriteProto.prototype.getFrame = function () {
		var t = this.getAsset()._usedAtlasScale;
		cc.assert(t, 'Error. Atlas scale zero.');
		var e = this.getFrames()[t];
		return (
			cc.assert(e, 'Error. No frames found for used scale `' + t + '`'),
			e[this.getIdRef()]
		);
	}),
	(gaf._SpriteProto.prototype.getAnchor = function () {
		return this.getFrame()._gafAnchor;
	}),
	(gaf._MaskProto = function (t, e, i) {
		(this.getIdRef = function () {
			return i;
		}),
			(this.getMaskNodeProto = function () {
				return e;
			}),
			(this._gafConstruct = function () {
				var t = new gaf.Mask(this);
				return t._init(), t;
			});
	}),
	(gaf.ReadSingleTag = function (t) {
		var e = t.Ushort(),
			i = gaf.Tags[e],
			n = {};
		return (
			void 0 === i
				? (console.log('GAF. Non implemented tag detected.'),
				  gaf.Tags.Default.parse(t, e))
				: (n = i.parse(t, e)),
			n
		);
	}),
	(gaf.ReadTags = function (t) {
		var e = [];
		try {
			do {
				var i = gaf.ReadSingleTag(t);
			} while ((e.push(i), 0 != i.tagId));
		} catch (t) {
			if (!(t instanceof Error && 'GAF format error' == t.message))
				throw (console.log(t.stack), t);
			console.log('GAF format error:\n' + t.stack);
		}
		return e;
	}),
	(gaf.Tag = function () {
		(this.Default = Object.create(gaf.Tag.base)),
			(this[0] = Object.create(gaf.Tag.End)),
			(this[1] = Object.create(gaf.Tag.DefineAtlas)),
			(this[2] = Object.create(gaf.Tag.DefineAnimationMasks)),
			(this[3] = Object.create(gaf.Tag.DefineAnimationObjects)),
			(this[4] = Object.create(gaf.Tag.DefineAnimationFrames)),
			(this[5] = Object.create(gaf.Tag.DefineNamedParts)),
			(this[6] = Object.create(gaf.Tag.DefineSequences)),
			(this[7] = Object.create(gaf.Tag.DefineTextFields)),
			(this[8] = Object.create(gaf.Tag.DefineAtlas2)),
			(this[9] = Object.create(gaf.Tag.DefineStage)),
			(this[10] = Object.create(gaf.Tag.DefineAnimationObjects2)),
			(this[11] = Object.create(gaf.Tag.DefineAnimationMasks2)),
			(this[12] = Object.create(gaf.Tag.DefineAnimationFrames2)),
			(this[13] = Object.create(gaf.Tag.DefineTimeline));
	}),
	(gaf.Tag.base = function () {}),
	(gaf.Tag.base.parse = function (t, e) {
		var i = t.Uint();
		t.startNestedBuffer(i);
		i = this.doParse(t);
		return (
			t.endNestedBuffer(), (i.tagName = this.tagName), (i.tagId = e), i
		);
	}),
	(gaf.Tag.base.doParse = function (t) {
		return {};
	}),
	(gaf.Tag.End = Object.create(gaf.Tag.base)),
	(gaf.Tag.End.tagName = 'TagEnd'),
	(gaf.Tag.DefineAtlas = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAtlas.tagName = 'TagDefineAtlas'),
	(gaf.Tag.DefineAtlas.doParse = function (t) {
		return {
			content: t.fields(
				'scale',
				'Float',
				'atlases',
				t.array(
					'Ubyte',
					t.fields(
						'id',
						'Uint',
						'sources',
						t.array(
							'Ubyte',
							t.fields('source', 'String', 'csf', 'Float')
						)
					)
				),
				'elements',
				t.array(
					'Uint',
					t.fields(
						'pivot',
						'Point',
						'origin',
						'Point',
						'scale',
						'Float',
						'size',
						'Point',
						'atlasId',
						'Uint',
						'elementAtlasId',
						'Uint'
					)
				)
			)(),
		};
	}),
	(gaf.Tag.DefineAnimationMasks = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAnimationMasks.tagName = 'TagDefineAnimationMasks'),
	(gaf.Tag.DefineAnimationMasks.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields('objectId', 'Uint', 'elementAtlasIdRef', 'Uint')
			)(),
		};
	}),
	(gaf.Tag.DefineAnimationObjects = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAnimationObjects.tagName = 'TagDefineAnimationObjects'),
	(gaf.Tag.DefineAnimationObjects.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields('objectId', 'Uint', 'elementAtlasIdRef', 'Uint')
			)(),
		};
	}),
	(gaf.Tag.DefineAnimationFrames = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAnimationFrames.tagName = 'TagDefineAnimationFrames'),
	(gaf.Tag.DefineAnimationFrames.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields(
					'frame',
					'Uint',
					'state',
					t.array(
						'Uint',
						t.fields(
							'hasColorTransform',
							'Ubyte',
							'hasMask',
							'Ubyte',
							'hasEffect',
							'Ubyte',
							'objectIdRef',
							'Uint',
							'depth',
							'Int',
							'alpha',
							'Float',
							'matrix',
							'Matrix',
							'colorTransform',
							t.condition(
								'hasColorTransform',
								1,
								t.fields(
									'alphaOffset',
									'Float',
									'redMultiplier',
									'Float',
									'redOffset',
									'Float',
									'greenMultiplier',
									'Float',
									'greenOffset',
									'Float',
									'blueMultiplier',
									'Float',
									'blueOffset',
									'Float'
								)
							),
							'effect',
							t.condition(
								'hasEffect',
								1,
								t.array('Ubyte', gaf.Tag._readFilter(t))
							),
							'maskObjectIdRef',
							t.condition(
								'hasMask',
								1,
								t.fields('maskObjectIdRef', 'Uint')
							)
						)
					)
				)
			)(),
		};
	}),
	(gaf.Tag.DefineNamedParts = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineNamedParts.tagName = 'TagDefineNamedParts'),
	(gaf.Tag.DefineNamedParts.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields('objectId', 'Uint', 'name', 'String')
			)(),
		};
	}),
	(gaf.Tag.DefineSequences = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineSequences.tagName = 'TagDefineSequences'),
	(gaf.Tag.DefineSequences.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields('id', 'String', 'start', 'Ushort', 'end', 'Ushort')
			)(),
		};
	}),
	(gaf.Tag.DefineTextFields = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineTextFields.tagName = 'TagDefineTextFields'),
	(gaf.Tag.DefineTextFields.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields(
					'id',
					'Uint',
					'pivot',
					'Point',
					'end',
					'Ushort',
					'width',
					'Float',
					'height',
					'Float',
					'text',
					'String',
					'embedFonts',
					'Boolean',
					'multiline',
					'Boolean',
					'wordWrap',
					'Boolean',
					'hasRestrict',
					'Boolean',
					'restrict',
					t.condition('hasRestrict', 1, function () {
						return t.String;
					}),
					'editable',
					'Boolean',
					'selectable',
					'Boolean',
					'displayAsPassword',
					'Boolean',
					'maxChars',
					'Uint',
					'align',
					'Uint',
					'blockIndent',
					'Uint',
					'bold',
					'Boolean',
					'bullet',
					'Boolean',
					'color',
					'color',
					'font',
					'String',
					'indent',
					'Uint',
					'italic',
					'Boolean',
					'kerning',
					'Boolean',
					'leading',
					'Uint',
					'leftMargin',
					'Uint',
					'letterSpacing',
					'Float',
					'rightMargin',
					'Uint',
					'size',
					'Uint',
					'tabStops',
					t.array('Uint', t.fields('value', 'Uint')),
					'target',
					'string',
					'underline',
					'Boolean',
					'url',
					'String'
				)
			)(),
		};
	}),
	(gaf.Tag.DefineAtlas2 = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAtlas2.tagName = 'TagDefineAtlas2'),
	(gaf.Tag.DefineAtlas2.doParse = function (t) {
		return {
			content: t.fields(
				'scale',
				'Float',
				'atlases',
				t.array(
					'Ubyte',
					t.fields(
						'id',
						'Uint',
						'sources',
						t.array(
							'Ubyte',
							t.fields('source', 'String', 'csf', 'Float')
						)
					)
				),
				'elements',
				t.array(
					'Uint',
					t.fields(
						'pivot',
						'Point',
						'origin',
						'Point',
						'scale',
						'Float',
						'size',
						'Point',
						'atlasId',
						'Uint',
						'elementAtlasId',
						'Uint',
						'hasScale9Grid',
						'Boolean',
						'scale9GridRect',
						t.condition('hasScale9Grid', 1, function () {
							return t.Rect();
						})
					)
				)
			)(),
		};
	}),
	(gaf.Tag.DefineStage = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineStage.tagName = 'TagDefineStage'),
	(gaf.Tag.DefineStage.doParse = function (t) {
		return {
			content: t.fields(
				'fps',
				'Ubyte',
				'color',
				'color',
				'width',
				'Ushort',
				'height',
				'Ushort'
			)(),
		};
	}),
	(gaf.Tag.DefineAnimationObjects2 = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAnimationObjects2.tagName = 'TagDefineAnimationObjects2'),
	(gaf.Tag.DefineAnimationObjects2.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields(
					'objectId',
					'Uint',
					'elementAtlasIdRef',
					'Uint',
					'type',
					'Ushort'
				)
			)(),
		};
	}),
	(gaf.Tag.DefineAnimationMasks2 = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAnimationMasks2.tagName = 'TagDefineAnimationMasks2'),
	(gaf.Tag.DefineAnimationMasks2.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields(
					'objectId',
					'Uint',
					'elementAtlasIdRef',
					'Uint',
					'type',
					'Ushort'
				)
			)(),
		};
	}),
	(gaf.Tag.DefineAnimationFrames2 = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineAnimationFrames2.tagName = 'TagDefineAnimationFrames2'),
	(gaf.Tag.DefineAnimationFrames2.doParse = function (t) {
		return {
			content: t.array(
				'Uint',
				t.fields(
					'frame',
					'Uint',
					'hasChangesInDisplayList',
					'Boolean',
					'hasActions',
					'Boolean',
					'state',
					t.condition(
						'hasChangesInDisplayList',
						1,
						t.array(
							'Uint',
							t.fields(
								'hasColorTransform',
								'Boolean',
								'hasMask',
								'Boolean',
								'hasEffect',
								'Boolean',
								'objectIdRef',
								'Uint',
								'depth',
								'Int',
								'alpha',
								'Float',
								'matrix',
								'Matrix',
								'colorTransform',
								t.condition(
									'hasColorTransform',
									1,
									t.fields(
										'alphaOffset',
										'Float',
										'redMultiplier',
										'Float',
										'redOffset',
										'Float',
										'greenMultiplier',
										'Float',
										'greenOffset',
										'Float',
										'blueMultiplier',
										'Float',
										'blueOffset',
										'Float'
									)
								),
								'effect',
								t.condition(
									'hasEffect',
									1,
									t.array('Ubyte', gaf.Tag._readFilter(t))
								),
								'maskObjectIdRef',
								t.condition('hasMask', 1, function () {
									return t.Uint();
								})
							)
						)
					),
					'actions',
					t.condition(
						'hasActions',
						1,
						t.array(
							'Uint',
							t.fields(
								'type',
								'Uint',
								'scope',
								'String',
								'params',
								gaf.Tag._readActionArguments(t)
							)
						)
					)
				)
			)(),
		};
	}),
	(gaf.Tag.DefineTimeline = Object.create(gaf.Tag.base)),
	(gaf.Tag.DefineTimeline.tagName = 'TagDefineTimeline'),
	(gaf.Tag.DefineTimeline.doParse = function (t) {
		var e = {
			content: t.fields(
				'id',
				'Uint',
				'animationFrameCount',
				'Uint',
				'boundingBox',
				'Rect',
				'pivotPoint',
				'Point',
				'hasLinkage',
				'Boolean',
				'linkageName',
				t.condition('hasLinkage', 1, function () {
					return t.String();
				})
			)(),
		};
		return (e.content.tags = gaf.ReadTags(t)), e;
	}),
	(gaf.Tag._readActionArguments = function (i) {
		return function () {
			var t = i.Uint(),
				e = [];
			for (i.startNestedBuffer(t); i.maxOffset() < i.tell(); )
				e.push(i.String());
			return i.endNestedBuffer(), e;
		};
	}),
	(gaf.Tag._readFilter = function (t) {
		return t.fields(
			'type',
			'Uint',
			'dropShadow',
			t.condition(
				'type',
				gaf.EFFECT_DROP_SHADOW,
				t.fields(
					'color',
					'color',
					'blurX',
					'Float',
					'blurY',
					'Float',
					'angle',
					'Float',
					'distance',
					'Float',
					'strength',
					'Float',
					'inner',
					'Boolean',
					'knockout',
					'Boolean'
				)
			),
			'blur',
			t.condition(
				'type',
				gaf.EFFECT_BLUR,
				t.fields('blurX', 'Float', 'blurY', 'Float')
			),
			'glow',
			t.condition(
				'type',
				gaf.EFFECT_GLOW,
				t.fields(
					'color',
					'color',
					'blurX',
					'Float',
					'blurY',
					'Float',
					'strength',
					'Float',
					'inner',
					'Boolean',
					'knockout',
					'Boolean'
				)
			),
			'colorMatrix',
			t.condition(
				'type',
				gaf.EFFECT_COLOR_MATRIX,
				t.fields(
					'rr',
					'Float',
					'gr',
					'Float',
					'br',
					'Float',
					'ar',
					'Float',
					'r',
					'Float',
					'rg',
					'Float',
					'gg',
					'Float',
					'bg',
					'Float',
					'ag',
					'Float',
					'g',
					'Float',
					'rb',
					'Float',
					'gb',
					'Float',
					'bb',
					'Float',
					'ab',
					'Float',
					'b',
					'Float',
					'ra',
					'Float',
					'ga',
					'Float',
					'ba',
					'Float',
					'aa',
					'Float',
					'a',
					'Float'
				)
			)
		);
	}),
	(gaf.Tags = new gaf.Tag());
var gaf = gaf || {};
(gaf.Loader = function () {
	(this.LoadFile = function (t, i) {
		var n = new XMLHttpRequest();
		n.open('GET', t, !0);
		var r = this;
		(n.responseType = 'arraybuffer'),
			(n.onload = function (t) {
				var e = new gaf.DataReader(n.response),
					e = r.LoadStream(e);
				i && i(e);
			}),
			n.send();
	}),
		(this.LoadStream = function (t) {
			var e,
				i,
				n = {};
			if (
				((e = t),
				(i = n),
				(i.compression = e.Uint()),
				(i.versionMajor = e.Ubyte()),
				(i.versionMinor = e.Ubyte()),
				(i.fileLength = e.Uint()),
				n.compression != gaf.COMPRESSION_NONE)
			) {
				if (n.compression != gaf.COMPRESSION_ZIP)
					throw new Error('GAF syntax error.');
				var r = t.dataRaw.slice(t.tell()),
					o = new window.Zlib.Inflate(new Uint8Array(r)).decompress();
				t = new gaf.DataReader(o.buffer);
			}
			return (
				n.versionMajor < 4
					? (((r = n).framesCount = (o = t).Ushort()),
					  (r.frameSize = o.Rect()),
					  (r.pivot = o.Point()))
					: (function (t, e) {
							var i = t.Uint();
							e.scaleValues = [];
							for (var n = 0; n < i; ++n)
								e.scaleValues.push(t.Float());
							var r = t.Uint();
							for (e.csfValues = [], n = 0; n < r; ++n)
								e.csfValues.push(t.Float());
					  })(t, n),
				{ header: n, tags: gaf.ReadTags(t) }
			);
		});
}),
	(gaf.DataReader = function (t) {
		(this.dataRaw = t), (this.buf = new DataView(t)), (this.offset = [0]);
	}),
	(gaf.DataReader.prototype.constructor = gaf.DataReader),
	(gaf.DataReader.prototype.newOffset = function (t) {
		if (
			((this.offset[this.offset.length - 1] += t),
			this.getOffset() > this.maxOffset())
		)
			throw new Error('GAF format error');
		return this.offset[this.offset.length - 1] - t;
	}),
	(gaf.DataReader.prototype.maxOffset = function () {
		return 1 == this.offset.length
			? this.buf.byteLength
			: this.offset[this.offset.length - 2];
	}),
	(gaf.DataReader.prototype.getOffset = function (t) {
		return this.offset[this.offset.length - 1];
	}),
	(gaf.DataReader.prototype.Ubyte = function () {
		return this.buf.getUint8(this.newOffset(1));
	}),
	(gaf.DataReader.prototype.Boolean = function () {
		var t = this.buf.getUint8(this.newOffset(1));
		if (1 < t) throw new Error('GAF format error');
		return t;
	}),
	(gaf.DataReader.prototype.Uint = function () {
		return this.buf.getUint32(this.newOffset(4), !0);
	}),
	(gaf.DataReader.prototype.Int = function () {
		return this.buf.getInt32(this.newOffset(4), !0);
	}),
	(gaf.DataReader.prototype.color = function () {
		return {
			b: this.Ubyte(),
			g: this.Ubyte(),
			r: this.Ubyte(),
			a: this.Ubyte(),
		};
	}),
	(gaf.DataReader.prototype.Ushort = function () {
		return this.buf.getUint16(this.newOffset(2), !0);
	}),
	(gaf.DataReader.prototype.Float = function () {
		return this.buf.getFloat32(this.newOffset(4), !0);
	}),
	(gaf.DataReader.prototype.String = function () {
		var t = this.Ushort(),
			e = this.newOffset(t),
			i = this.getOffset();
		try {
			var n = this.dataRaw.slice(e, i);
		} catch (t) {
			if (
				"Object doesn't support property or method 'slice'" != t.message
			)
				throw t;
			n = [];
			for (var r = e; r < i; ++r) n.push(this.buf.getUint8(r));
		}
		return decodeURIComponent(
			escape(String.fromCharCode.apply(null, new Uint8Array(n)))
		);
	}),
	(gaf.DataReader.prototype.startNestedBuffer = function (t) {
		this.offset.push(this.offset[this.offset.length - 1]),
			(this.offset[this.offset.length - 2] += t);
	}),
	(gaf.DataReader.prototype.endNestedBuffer = function () {
		if (1 == this.offset.length)
			throw new Error('No nested buffer available');
		this.offset.pop();
	}),
	(gaf.DataReader.prototype.Point = function () {
		return { x: this.Float(), y: this.Float() };
	}),
	(gaf.DataReader.prototype.Rect = function () {
		return {
			x: this.Float(),
			y: this.Float(),
			width: this.Float(),
			height: this.Float(),
		};
	}),
	(gaf.DataReader.prototype.Matrix = function () {
		return {
			a: this.Float(),
			b: this.Float(),
			c: this.Float(),
			d: this.Float(),
			tx: this.Float(),
			ty: this.Float(),
		};
	}),
	(gaf.DataReader.prototype.seek = function (t) {
		this.offset[this.offset.length - 1] = t;
	}),
	(gaf.DataReader.prototype.tell = function () {
		return this.offset[this.offset.length - 1];
	}),
	(gaf.DataReader.prototype.fields = function () {
		var n = this,
			r = arguments;
		return function () {
			arguments.callee.result = {};
			var t = 0;
			if (r.length % 2)
				throw new Error('Number of arguments is not even');
			for (; t < r.length; ) {
				var e = r[t++],
					i = r[t++];
				if ('function' == typeof i) arguments.callee.result[e] = i();
				else {
					if (!(i in n && 'function' == typeof n[i]))
						throw new Error(
							'Object DataReader has no function `' + i + '`'
						);
					arguments.callee.result[e] = n[i].call(n);
				}
			}
			return arguments.callee.result;
		};
	}),
	(gaf.DataReader.prototype.condition = function (t, e, i) {
		var r = arguments;
		return function () {
			if (3 != r.length) throw new Error('Condition function');
			var t = arguments.callee.caller;
			if (!('result' in t))
				throw new Error(
					'Condition function caller has no key `result`'
				);
			var e = t.result,
				i = r[0],
				n = r[1],
				t = r[2];
			return ('function' == typeof n
				? function () {
						return n(e[i]);
				  }
				: function () {
						return n == e[i];
				  })()
				? t()
				: null;
		};
	}),
	(gaf.DataReader.prototype.array = function () {
		var n = this,
			r = arguments;
		return function () {
			arguments.callee.result = [];
			for (var t = n[r[0]].call(n), e = 0; e < t; ++e) {
				var i = r[1].call();
				arguments.callee.result.push(i);
			}
			return arguments.callee.result;
		};
	}),
	(gaf.SHADER_GAUSSIAN_BLUR_FRAG =
		'varying mediump vec2 v_texCoord;\nuniform mediump vec2 u_step;\nvoid main()\n{ \n    mediump vec4 sum = vec4(0.0);                                      \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 4.0) * 0.05;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 0.0) * 0.18;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 4.0) * 0.05;   \n    gl_FragColor = sum;                                                \n} \n'),
	(gaf.SHADER_GLOW_FRAG =
		'varying mediump vec2 v_texCoord;\nuniform mediump vec2 u_step;\nuniform mediump vec4 u_glowColor;\nvoid main()\n{ \n    mediump vec4 sum = vec4(0.0);                                      \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 4.0) * 0.05;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 0.0) * 0.18;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 4.0) * 0.05;   \n    gl_FragColor = sum * u_glowColor;                                  \n} \n'),
	(gaf.SHADER_COLOR_MATRIX_FRAG =
		'varying mediump vec2 v_texCoord;\nvarying mediump vec4 v_fragmentColor;\nuniform mediump vec4 colorTransformMult;\nuniform mediump vec4 colorTransformOffsets;\nuniform mediump mat4 colorMatrix;\nuniform mediump vec4 colorMatrix2;\nvoid main()\n{ \n    vec4 texColor = texture2D(CC_Texture0, v_texCoord);                          \n    const float kMinimalAlphaAllowed = 1.0e-8;                                   \n    if (texColor.a > kMinimalAlphaAllowed)                                       \n    {                                                                            \n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);                  \n        vec4 ctxColor = texColor * colorTransformMult + colorTransformOffsets;   \n        vec4 adjustColor = colorMatrix * ctxColor + colorMatrix2;                \n        adjustColor *= v_fragmentColor;                                          \n        texColor = vec4(adjustColor.rgb * adjustColor.a, adjustColor.a);         \n    }                                                                            \n    gl_FragColor = texColor;                                                     \n}\n'),
	(gaf._glShaderInit = function () {
		(gaf._Uniforms = {
			ColorTransformMult: -1,
			ColorTransformOffset: -1,
			ColorMatrixBody: -1,
			ColorMatrixAppendix: -1,
			BlurTexelOffset: -1,
			GlowTexelOffset: -1,
			GlowColor: -1,
		}),
			(gaf._shaderCreate = function (t, e) {
				var i = new cc.GLProgram(),
					t = i.initWithVertexShaderByteArray(e, t);
				return (
					cc.assert(t, 'Shader init error'),
					i.addAttribute(
						cc.ATTRIBUTE_NAME_POSITION,
						cc.VERTEX_ATTRIB_POSITION
					),
					i.addAttribute(
						cc.ATTRIBUTE_NAME_COLOR,
						cc.VERTEX_ATTRIB_COLOR
					),
					i.addAttribute(
						cc.ATTRIBUTE_NAME_TEX_COORD,
						cc.VERTEX_ATTRIB_TEX_COORDS
					),
					(t = i.link()),
					cc.assert(t, 'Shader linking error'),
					i.updateUniforms(),
					i
				);
			}),
			(gaf._shaderCreateAlpha = function () {
				var t = gaf._shaderCreate(
					gaf.SHADER_COLOR_MATRIX_FRAG,
					cc.SHADER_POSITION_TEXTURE_COLOR_VERT
				);
				return (
					(gaf._Uniforms.ColorTransformMult =
						t.getUniformLocationForName(
							gaf.UNIFORM_ALPHA_TINT_MULT
						)),
					(gaf._Uniforms.ColorTransformOffset =
						t.getUniformLocationForName(
							gaf.UNIFORM_ALPHA_TINT_OFFSET
						)),
					(gaf._Uniforms.ColorMatrixBody =
						t.getUniformLocationForName(
							gaf.UNIFORM_ALPHA_COLOR_MATRIX_BODY
						)),
					(gaf._Uniforms.ColorMatrixAppendix =
						t.getUniformLocationForName(
							gaf.UNIFORM_ALPHA_COLOR_MATRIX_APPENDIX
						)),
					t
				);
			}),
			(gaf._shaderCreateBlur = function () {
				var t = gaf._shaderCreate(
					gaf.SHADER_GAUSSIAN_BLUR_FRAG,
					cc.SHADER_POSITION_TEXTURE_COLOR_VERT
				);
				return (
					(gaf._Uniforms.BlurTexelOffset =
						t._glContext.getUniformLocation(
							t._programObj,
							gaf.UNIFORM_BLUR_TEXEL_OFFSET
						)),
					t
				);
			}),
			(gaf._shaderCreateGlow = function () {
				var t = gaf._shaderCreate(
					gaf.SHADER_GLOW_FRAG,
					cc.SHADER_POSITION_TEXTURE_COLOR_VERT
				);
				return (
					(gaf._Uniforms.GlowTexelOffset =
						t._glContext.getUniformLocation(
							t._programObj,
							gaf.UNIFORM_GLOW_TEXEL_OFFSET
						)),
					(gaf._Uniforms.GlowColor = t._glContext.getUniformLocation(
						t._programObj,
						gaf.UNIFORM_GLOW_COLOR
					)),
					t
				);
			}),
			(gaf._Shaders = {
				Alpha: gaf._shaderCreateAlpha(),
				Blur: gaf._shaderCreateBlur(),
				Glow: gaf._shaderCreateGlow(),
			});
	}),
	(gaf._setupShaders = function () {
		cc._renderType === cc.game.RENDER_TYPE_WEBGL
			? gaf._glShaderInit()
			: delete gaf._glShaderInit;
	}),
	(gaf._AtlasLoader = {}),
	(gaf._AtlasLoader.execute = function (t, e, i) {
		(t() ? e : i)();
	}),
	(gaf._AtlasLoader.checkAtlas = function (t) {
		return function () {
			return t && 'string' != typeof t && t.isLoaded();
		};
	}),
	(gaf._AtlasLoader.load = function (t, e, i) {
		cc.textureCache.addImage(t, function (t) {
			gaf._AtlasLoader.execute(
				gaf._AtlasLoader.checkAtlas(t),
				function () {
					e(t);
				},
				i
			);
		});
	}),
	(gaf._AtlasLoader.loadFront = function (t, e, i) {
		return function () {
			0 < t.length
				? gaf._AtlasLoader.load(
						t[0],
						e,
						gaf._AtlasLoader.loadFront(t.slice(1), e, i)
				  )
				: i();
		};
	}),
	(gaf._AtlasLoader.loadArray = function (t, e, i) {
		gaf._AtlasLoader.loadFront(t, e, i)();
	});
var Box2D = {};
!(function (t) {
	function n() {}
	!(Object.defineProperty instanceof Function) &&
		Object.prototype.__defineGetter__ instanceof Function &&
		Object.prototype.__defineSetter__ instanceof Function &&
		(Object.defineProperty = function (t, e, i) {
			i.get instanceof Function && t.__defineGetter__(e, i.get),
				i.set instanceof Function && t.__defineSetter__(e, i.set);
		}),
		(t.inherit = function (t, e) {
			var i = t;
			(n.prototype = e.prototype),
				(t.prototype = new n()),
				(t.prototype.constructor = i);
		}),
		(t.generateCallback = function (t, e) {
			return function () {
				e.apply(t, arguments);
			};
		}),
		(t.NVector = function (t) {
			void 0 === t && (t = 0);
			for (var e = new Array(t || 0), i = 0; i < t; ++i) e[i] = 0;
			return e;
		}),
		(t.is = function (t, e) {
			return (
				null !== t &&
				((e instanceof Function && t instanceof e) ||
					!(
						null == t.constructor.__implements ||
						!t.constructor.__implements[e]
					))
			);
		}),
		(t.parseUInt = function (t) {
			return Math.abs(parseInt(t));
		});
})(Box2D);
var Vector = Array,
	Vector_a2j_Number = Box2D.NVector,
	i;
for (
	void 0 === Box2D && (Box2D = {}),
		void 0 === Box2D.Collision && (Box2D.Collision = {}),
		void 0 === Box2D.Collision.Shapes && (Box2D.Collision.Shapes = {}),
		void 0 === Box2D.Common && (Box2D.Common = {}),
		void 0 === Box2D.Common.Math && (Box2D.Common.Math = {}),
		void 0 === Box2D.Dynamics && (Box2D.Dynamics = {}),
		void 0 === Box2D.Dynamics.Contacts && (Box2D.Dynamics.Contacts = {}),
		void 0 === Box2D.Dynamics.Controllers &&
			(Box2D.Dynamics.Controllers = {}),
		void 0 === Box2D.Dynamics.Joints && (Box2D.Dynamics.Joints = {}),
		(function () {
			function t() {
				t.b2AABB.apply(this, arguments);
			}
			function e() {
				e.b2Bound.apply(this, arguments);
			}
			function i() {
				i.b2BoundValues.apply(this, arguments),
					this.constructor === i &&
						this.b2BoundValues.apply(this, arguments);
			}
			function n() {
				n.b2Collision.apply(this, arguments);
			}
			function r() {
				r.b2ContactID.apply(this, arguments),
					this.constructor === r &&
						this.b2ContactID.apply(this, arguments);
			}
			function o() {
				o.b2ContactPoint.apply(this, arguments);
			}
			function s() {
				s.b2Distance.apply(this, arguments);
			}
			function c() {
				c.b2DistanceInput.apply(this, arguments);
			}
			function a() {
				a.b2DistanceOutput.apply(this, arguments);
			}
			function l() {
				l.b2DistanceProxy.apply(this, arguments);
			}
			function h() {
				h.b2DynamicTree.apply(this, arguments),
					this.constructor === h &&
						this.b2DynamicTree.apply(this, arguments);
			}
			function u() {
				u.b2DynamicTreeBroadPhase.apply(this, arguments);
			}
			function _() {
				_.b2DynamicTreeNode.apply(this, arguments);
			}
			function d() {
				d.b2DynamicTreePair.apply(this, arguments);
			}
			function p() {
				p.b2Manifold.apply(this, arguments),
					this.constructor === p &&
						this.b2Manifold.apply(this, arguments);
			}
			function f() {
				f.b2ManifoldPoint.apply(this, arguments),
					this.constructor === f &&
						this.b2ManifoldPoint.apply(this, arguments);
			}
			function m() {
				m.b2Point.apply(this, arguments);
			}
			function g() {
				g.b2RayCastInput.apply(this, arguments),
					this.constructor === g &&
						this.b2RayCastInput.apply(this, arguments);
			}
			function y() {
				y.b2RayCastOutput.apply(this, arguments);
			}
			function T() {
				T.b2Segment.apply(this, arguments);
			}
			function S() {
				S.b2SeparationFunction.apply(this, arguments);
			}
			function C() {
				C.b2Simplex.apply(this, arguments),
					this.constructor === C &&
						this.b2Simplex.apply(this, arguments);
			}
			function x() {
				x.b2SimplexCache.apply(this, arguments);
			}
			function v() {
				v.b2SimplexVertex.apply(this, arguments);
			}
			function E() {
				E.b2TimeOfImpact.apply(this, arguments);
			}
			function A() {
				A.b2TOIInput.apply(this, arguments);
			}
			function b() {
				b.b2WorldManifold.apply(this, arguments),
					this.constructor === b &&
						this.b2WorldManifold.apply(this, arguments);
			}
			function R() {
				R.ClipVertex.apply(this, arguments);
			}
			function P() {
				P.Features.apply(this, arguments);
			}
			function I() {
				I.b2CircleShape.apply(this, arguments),
					this.constructor === I &&
						this.b2CircleShape.apply(this, arguments);
			}
			function w() {
				w.b2EdgeChainDef.apply(this, arguments),
					this.constructor === w &&
						this.b2EdgeChainDef.apply(this, arguments);
			}
			function D() {
				D.b2EdgeShape.apply(this, arguments),
					this.constructor === D &&
						this.b2EdgeShape.apply(this, arguments);
			}
			function L() {
				L.b2MassData.apply(this, arguments);
			}
			function O() {
				O.b2PolygonShape.apply(this, arguments),
					this.constructor === O &&
						this.b2PolygonShape.apply(this, arguments);
			}
			function B() {
				B.b2Shape.apply(this, arguments),
					this.constructor === B &&
						this.b2Shape.apply(this, arguments);
			}
			function N() {
				N.b2Color.apply(this, arguments),
					this.constructor === N &&
						this.b2Color.apply(this, arguments);
			}
			function F() {
				F.b2Settings.apply(this, arguments);
			}
			function M() {
				M.b2Mat22.apply(this, arguments),
					this.constructor === M &&
						this.b2Mat22.apply(this, arguments);
			}
			function V() {
				V.b2Mat33.apply(this, arguments),
					this.constructor === V &&
						this.b2Mat33.apply(this, arguments);
			}
			function k() {
				k.b2Math.apply(this, arguments);
			}
			function G() {
				G.b2Sweep.apply(this, arguments);
			}
			function W() {
				W.b2Transform.apply(this, arguments),
					this.constructor === W &&
						this.b2Transform.apply(this, arguments);
			}
			function z() {
				z.b2Vec2.apply(this, arguments),
					this.constructor === z &&
						this.b2Vec2.apply(this, arguments);
			}
			function U() {
				U.b2Vec3.apply(this, arguments),
					this.constructor === U &&
						this.b2Vec3.apply(this, arguments);
			}
			function Y() {
				Y.b2Body.apply(this, arguments),
					this.constructor === Y &&
						this.b2Body.apply(this, arguments);
			}
			function X() {
				X.b2BodyDef.apply(this, arguments),
					this.constructor === X &&
						this.b2BodyDef.apply(this, arguments);
			}
			function H() {
				H.b2ContactFilter.apply(this, arguments);
			}
			function j() {
				j.b2ContactImpulse.apply(this, arguments);
			}
			function q() {
				q.b2ContactListener.apply(this, arguments);
			}
			function J() {
				J.b2ContactManager.apply(this, arguments),
					this.constructor === J &&
						this.b2ContactManager.apply(this, arguments);
			}
			function Z() {
				Z.b2DebugDraw.apply(this, arguments),
					this.constructor === Z &&
						this.b2DebugDraw.apply(this, arguments);
			}
			function K() {
				K.b2DestructionListener.apply(this, arguments);
			}
			function Q() {
				Q.b2FilterData.apply(this, arguments);
			}
			function $() {
				$.b2Fixture.apply(this, arguments),
					this.constructor === $ &&
						this.b2Fixture.apply(this, arguments);
			}
			function tt() {
				tt.b2FixtureDef.apply(this, arguments),
					this.constructor === tt &&
						this.b2FixtureDef.apply(this, arguments);
			}
			function et() {
				et.b2Island.apply(this, arguments),
					this.constructor === et &&
						this.b2Island.apply(this, arguments);
			}
			function it() {
				it.b2TimeStep.apply(this, arguments);
			}
			function nt() {
				nt.b2World.apply(this, arguments),
					this.constructor === nt &&
						this.b2World.apply(this, arguments);
			}
			function rt() {
				rt.b2CircleContact.apply(this, arguments);
			}
			function ot() {
				ot.b2Contact.apply(this, arguments),
					this.constructor === ot &&
						this.b2Contact.apply(this, arguments);
			}
			function st() {
				st.b2ContactConstraint.apply(this, arguments),
					this.constructor === st &&
						this.b2ContactConstraint.apply(this, arguments);
			}
			function ct() {
				ct.b2ContactConstraintPoint.apply(this, arguments);
			}
			function at() {
				at.b2ContactEdge.apply(this, arguments);
			}
			function lt() {
				lt.b2ContactFactory.apply(this, arguments),
					this.constructor === lt &&
						this.b2ContactFactory.apply(this, arguments);
			}
			function ht() {
				ht.b2ContactRegister.apply(this, arguments);
			}
			function ut() {
				ut.b2ContactResult.apply(this, arguments);
			}
			function _t() {
				_t.b2ContactSolver.apply(this, arguments),
					this.constructor === _t &&
						this.b2ContactSolver.apply(this, arguments);
			}
			function dt() {
				dt.b2EdgeAndCircleContact.apply(this, arguments);
			}
			function pt() {
				pt.b2NullContact.apply(this, arguments),
					this.constructor === pt &&
						this.b2NullContact.apply(this, arguments);
			}
			function ft() {
				ft.b2PolyAndCircleContact.apply(this, arguments);
			}
			function mt() {
				mt.b2PolyAndEdgeContact.apply(this, arguments);
			}
			function gt() {
				gt.b2PolygonContact.apply(this, arguments);
			}
			function yt() {
				yt.b2PositionSolverManifold.apply(this, arguments),
					this.constructor === yt &&
						this.b2PositionSolverManifold.apply(this, arguments);
			}
			function Tt() {
				Tt.b2BuoyancyController.apply(this, arguments);
			}
			function St() {
				St.b2ConstantAccelController.apply(this, arguments);
			}
			function Ct() {
				Ct.b2ConstantForceController.apply(this, arguments);
			}
			function xt() {
				xt.b2Controller.apply(this, arguments);
			}
			function vt() {
				vt.b2ControllerEdge.apply(this, arguments);
			}
			function Et() {
				Et.b2GravityController.apply(this, arguments);
			}
			function At() {
				At.b2TensorDampingController.apply(this, arguments);
			}
			function bt() {
				bt.b2DistanceJoint.apply(this, arguments),
					this.constructor === bt &&
						this.b2DistanceJoint.apply(this, arguments);
			}
			function Rt() {
				Rt.b2DistanceJointDef.apply(this, arguments),
					this.constructor === Rt &&
						this.b2DistanceJointDef.apply(this, arguments);
			}
			function Pt() {
				Pt.b2FrictionJoint.apply(this, arguments),
					this.constructor === Pt &&
						this.b2FrictionJoint.apply(this, arguments);
			}
			function It() {
				It.b2FrictionJointDef.apply(this, arguments),
					this.constructor === It &&
						this.b2FrictionJointDef.apply(this, arguments);
			}
			function wt() {
				wt.b2GearJoint.apply(this, arguments),
					this.constructor === wt &&
						this.b2GearJoint.apply(this, arguments);
			}
			function Dt() {
				Dt.b2GearJointDef.apply(this, arguments),
					this.constructor === Dt &&
						this.b2GearJointDef.apply(this, arguments);
			}
			function Lt() {
				Lt.b2Jacobian.apply(this, arguments);
			}
			function Ot() {
				Ot.b2Joint.apply(this, arguments),
					this.constructor === Ot &&
						this.b2Joint.apply(this, arguments);
			}
			function Bt() {
				Bt.b2JointDef.apply(this, arguments),
					this.constructor === Bt &&
						this.b2JointDef.apply(this, arguments);
			}
			function Nt() {
				Nt.b2JointEdge.apply(this, arguments);
			}
			function Ft() {
				Ft.b2LineJoint.apply(this, arguments),
					this.constructor === Ft &&
						this.b2LineJoint.apply(this, arguments);
			}
			function Mt() {
				Mt.b2LineJointDef.apply(this, arguments),
					this.constructor === Mt &&
						this.b2LineJointDef.apply(this, arguments);
			}
			function Vt() {
				Vt.b2MouseJoint.apply(this, arguments),
					this.constructor === Vt &&
						this.b2MouseJoint.apply(this, arguments);
			}
			function kt() {
				kt.b2MouseJointDef.apply(this, arguments),
					this.constructor === kt &&
						this.b2MouseJointDef.apply(this, arguments);
			}
			function Gt() {
				Gt.b2PrismaticJoint.apply(this, arguments),
					this.constructor === Gt &&
						this.b2PrismaticJoint.apply(this, arguments);
			}
			function Wt() {
				Wt.b2PrismaticJointDef.apply(this, arguments),
					this.constructor === Wt &&
						this.b2PrismaticJointDef.apply(this, arguments);
			}
			function zt() {
				zt.b2PulleyJoint.apply(this, arguments),
					this.constructor === zt &&
						this.b2PulleyJoint.apply(this, arguments);
			}
			function Ut() {
				Ut.b2PulleyJointDef.apply(this, arguments),
					this.constructor === Ut &&
						this.b2PulleyJointDef.apply(this, arguments);
			}
			function Yt() {
				Yt.b2RevoluteJoint.apply(this, arguments),
					this.constructor === Yt &&
						this.b2RevoluteJoint.apply(this, arguments);
			}
			function Xt() {
				Xt.b2RevoluteJointDef.apply(this, arguments),
					this.constructor === Xt &&
						this.b2RevoluteJointDef.apply(this, arguments);
			}
			function Ht() {
				Ht.b2WeldJoint.apply(this, arguments),
					this.constructor === Ht &&
						this.b2WeldJoint.apply(this, arguments);
			}
			function jt() {
				jt.b2WeldJointDef.apply(this, arguments),
					this.constructor === jt &&
						this.b2WeldJointDef.apply(this, arguments);
			}
			(Box2D.Collision.IBroadPhase = 'Box2D.Collision.IBroadPhase'),
				(Box2D.Collision.b2AABB = t),
				(Box2D.Collision.b2Bound = e),
				(Box2D.Collision.b2BoundValues = i),
				(Box2D.Collision.b2Collision = n),
				(Box2D.Collision.b2ContactID = r),
				(Box2D.Collision.b2ContactPoint = o),
				(Box2D.Collision.b2Distance = s),
				(Box2D.Collision.b2DistanceInput = c),
				(Box2D.Collision.b2DistanceOutput = a),
				(Box2D.Collision.b2DistanceProxy = l),
				(Box2D.Collision.b2DynamicTree = h),
				(Box2D.Collision.b2DynamicTreeBroadPhase = u),
				(Box2D.Collision.b2DynamicTreeNode = _),
				(Box2D.Collision.b2DynamicTreePair = d),
				(Box2D.Collision.b2Manifold = p),
				(Box2D.Collision.b2ManifoldPoint = f),
				(Box2D.Collision.b2Point = m),
				(Box2D.Collision.b2RayCastInput = g),
				(Box2D.Collision.b2RayCastOutput = y),
				(Box2D.Collision.b2Segment = T),
				(Box2D.Collision.b2SeparationFunction = S),
				(Box2D.Collision.b2Simplex = C),
				(Box2D.Collision.b2SimplexCache = x),
				(Box2D.Collision.b2SimplexVertex = v),
				(Box2D.Collision.b2TimeOfImpact = E),
				(Box2D.Collision.b2TOIInput = A),
				(Box2D.Collision.b2WorldManifold = b),
				(Box2D.Collision.ClipVertex = R),
				(Box2D.Collision.Features = P),
				(Box2D.Collision.Shapes.b2CircleShape = I),
				(Box2D.Collision.Shapes.b2EdgeChainDef = w),
				(Box2D.Collision.Shapes.b2EdgeShape = D),
				(Box2D.Collision.Shapes.b2MassData = L),
				(Box2D.Collision.Shapes.b2PolygonShape = O),
				(Box2D.Collision.Shapes.b2Shape = B),
				(Box2D.Common.b2internal = 'Box2D.Common.b2internal'),
				(Box2D.Common.b2Color = N),
				(Box2D.Common.b2Settings = F),
				(Box2D.Common.Math.b2Mat22 = M),
				(Box2D.Common.Math.b2Mat33 = V),
				(Box2D.Common.Math.b2Math = k),
				(Box2D.Common.Math.b2Sweep = G),
				(Box2D.Common.Math.b2Transform = W),
				(Box2D.Common.Math.b2Vec2 = z),
				(Box2D.Common.Math.b2Vec3 = U),
				(Box2D.Dynamics.b2Body = Y),
				(Box2D.Dynamics.b2BodyDef = X),
				(Box2D.Dynamics.b2ContactFilter = H),
				(Box2D.Dynamics.b2ContactImpulse = j),
				(Box2D.Dynamics.b2ContactListener = q),
				(Box2D.Dynamics.b2ContactManager = J),
				(Box2D.Dynamics.b2DebugDraw = Z),
				(Box2D.Dynamics.b2DestructionListener = K),
				(Box2D.Dynamics.b2FilterData = Q),
				(Box2D.Dynamics.b2Fixture = $),
				(Box2D.Dynamics.b2FixtureDef = tt),
				(Box2D.Dynamics.b2Island = et),
				(Box2D.Dynamics.b2TimeStep = it),
				(Box2D.Dynamics.b2World = nt),
				(Box2D.Dynamics.Contacts.b2CircleContact = rt),
				(Box2D.Dynamics.Contacts.b2Contact = ot),
				(Box2D.Dynamics.Contacts.b2ContactConstraint = st),
				(Box2D.Dynamics.Contacts.b2ContactConstraintPoint = ct),
				(Box2D.Dynamics.Contacts.b2ContactEdge = at),
				(Box2D.Dynamics.Contacts.b2ContactFactory = lt),
				(Box2D.Dynamics.Contacts.b2ContactRegister = ht),
				(Box2D.Dynamics.Contacts.b2ContactResult = ut),
				(Box2D.Dynamics.Contacts.b2ContactSolver = _t),
				(Box2D.Dynamics.Contacts.b2EdgeAndCircleContact = dt),
				(Box2D.Dynamics.Contacts.b2NullContact = pt),
				(Box2D.Dynamics.Contacts.b2PolyAndCircleContact = ft),
				(Box2D.Dynamics.Contacts.b2PolyAndEdgeContact = mt),
				(Box2D.Dynamics.Contacts.b2PolygonContact = gt),
				(Box2D.Dynamics.Contacts.b2PositionSolverManifold = yt),
				(Box2D.Dynamics.Controllers.b2BuoyancyController = Tt),
				(Box2D.Dynamics.Controllers.b2ConstantAccelController = St),
				(Box2D.Dynamics.Controllers.b2ConstantForceController = Ct),
				(Box2D.Dynamics.Controllers.b2Controller = xt),
				(Box2D.Dynamics.Controllers.b2ControllerEdge = vt),
				(Box2D.Dynamics.Controllers.b2GravityController = Et),
				(Box2D.Dynamics.Controllers.b2TensorDampingController = At),
				(Box2D.Dynamics.Joints.b2DistanceJoint = bt),
				(Box2D.Dynamics.Joints.b2DistanceJointDef = Rt),
				(Box2D.Dynamics.Joints.b2FrictionJoint = Pt),
				(Box2D.Dynamics.Joints.b2FrictionJointDef = It),
				(Box2D.Dynamics.Joints.b2GearJoint = wt),
				(Box2D.Dynamics.Joints.b2GearJointDef = Dt),
				(Box2D.Dynamics.Joints.b2Jacobian = Lt),
				(Box2D.Dynamics.Joints.b2Joint = Ot),
				(Box2D.Dynamics.Joints.b2JointDef = Bt),
				(Box2D.Dynamics.Joints.b2JointEdge = Nt),
				(Box2D.Dynamics.Joints.b2LineJoint = Ft),
				(Box2D.Dynamics.Joints.b2LineJointDef = Mt),
				(Box2D.Dynamics.Joints.b2MouseJoint = Vt),
				(Box2D.Dynamics.Joints.b2MouseJointDef = kt),
				(Box2D.Dynamics.Joints.b2PrismaticJoint = Gt),
				(Box2D.Dynamics.Joints.b2PrismaticJointDef = Wt),
				(Box2D.Dynamics.Joints.b2PulleyJoint = zt),
				(Box2D.Dynamics.Joints.b2PulleyJointDef = Ut),
				(Box2D.Dynamics.Joints.b2RevoluteJoint = Yt),
				(Box2D.Dynamics.Joints.b2RevoluteJointDef = Xt),
				(Box2D.Dynamics.Joints.b2WeldJoint = Ht),
				(Box2D.Dynamics.Joints.b2WeldJointDef = jt);
		})(),
		Box2D.postDefs = [],
		(function () {
			var i = Box2D.Collision.Shapes.b2CircleShape,
				n =
					(Box2D.Collision.Shapes.b2EdgeChainDef,
					Box2D.Collision.Shapes.b2EdgeShape,
					Box2D.Collision.Shapes.b2MassData,
					Box2D.Collision.Shapes.b2PolygonShape),
				r = Box2D.Collision.Shapes.b2Shape,
				b =
					(Box2D.Common.b2Color,
					Box2D.Common.b2internal,
					Box2D.Common.b2Settings),
				v =
					(Box2D.Common.Math.b2Mat22,
					Box2D.Common.Math.b2Mat33,
					Box2D.Common.Math.b2Math),
				t = Box2D.Common.Math.b2Sweep,
				e = Box2D.Common.Math.b2Transform,
				E = Box2D.Common.Math.b2Vec2,
				m = (Box2D.Common.Math.b2Vec3, Box2D.Collision.b2AABB),
				o = Box2D.Collision.b2Bound,
				s = Box2D.Collision.b2BoundValues,
				R = Box2D.Collision.b2Collision,
				c = Box2D.Collision.b2ContactID,
				a = Box2D.Collision.b2ContactPoint,
				T = Box2D.Collision.b2Distance,
				l = Box2D.Collision.b2DistanceInput,
				h = Box2D.Collision.b2DistanceOutput,
				u = Box2D.Collision.b2DistanceProxy,
				_ = Box2D.Collision.b2DynamicTree,
				d = Box2D.Collision.b2DynamicTreeBroadPhase,
				p = Box2D.Collision.b2DynamicTreeNode,
				f = Box2D.Collision.b2DynamicTreePair,
				P = Box2D.Collision.b2Manifold,
				g = Box2D.Collision.b2ManifoldPoint,
				y = Box2D.Collision.b2Point,
				S = Box2D.Collision.b2RayCastInput,
				C = Box2D.Collision.b2RayCastOutput,
				x = Box2D.Collision.b2Segment,
				A = Box2D.Collision.b2SeparationFunction,
				I = Box2D.Collision.b2Simplex,
				w = Box2D.Collision.b2SimplexCache,
				D = Box2D.Collision.b2SimplexVertex,
				L = Box2D.Collision.b2TimeOfImpact,
				O = Box2D.Collision.b2TOIInput,
				B = Box2D.Collision.b2WorldManifold,
				N = Box2D.Collision.ClipVertex,
				F = Box2D.Collision.Features,
				M = Box2D.Collision.IBroadPhase;
			(m.b2AABB = function () {
				(this.lowerBound = new E()), (this.upperBound = new E());
			}),
				(m.prototype.IsValid = function () {
					var t = this.upperBound.x - this.lowerBound.x,
						e = this.upperBound.y - this.lowerBound.y;
					return (
						0 <= t &&
						0 <= e &&
						this.lowerBound.IsValid() &&
						this.upperBound.IsValid()
					);
				}),
				(m.prototype.GetCenter = function () {
					return new E(
						(this.lowerBound.x + this.upperBound.x) / 2,
						(this.lowerBound.y + this.upperBound.y) / 2
					);
				}),
				(m.prototype.GetExtents = function () {
					return new E(
						(this.upperBound.x - this.lowerBound.x) / 2,
						(this.upperBound.y - this.lowerBound.y) / 2
					);
				}),
				(m.prototype.Contains = function (t) {
					return (
						this.lowerBound.x <= t.lowerBound.x &&
						this.lowerBound.y <= t.lowerBound.y &&
						t.upperBound.x <= this.upperBound.x &&
						t.upperBound.y <= this.upperBound.y
					);
				}),
				(m.prototype.RayCast = function (t, e) {
					var i = -Number.MAX_VALUE,
						n = Number.MAX_VALUE,
						r = e.p1.x,
						o = e.p1.y,
						s = e.p2.x - e.p1.x,
						c = e.p2.y - e.p1.y,
						a = Math.abs(s),
						l = Math.abs(c),
						h = t.normal,
						u = 0,
						_ = 0,
						d = 0,
						p = 0,
						e = 0;
					if (a < Number.MIN_VALUE) {
						if (r < this.lowerBound.x || this.upperBound.x < r)
							return !1;
					} else if (
						((u = 1 / s),
						(_ = (this.lowerBound.x - r) * u),
						(e = -1),
						(d = (this.upperBound.x - r) * u) < _ &&
							((p = _), (_ = d), (d = p), (e = 1)),
						i < _ && ((h.x = e), (h.y = 0), (i = _)),
						(n = Math.min(n, d)) < i)
					)
						return !1;
					if (l < Number.MIN_VALUE) {
						if (o < this.lowerBound.y || this.upperBound.y < o)
							return !1;
					} else if (
						((u = 1 / c),
						(_ = (this.lowerBound.y - o) * u),
						(e = -1),
						(d = (this.upperBound.y - o) * u) < _ &&
							((p = _), (_ = d), (d = p), (e = 1)),
						i < _ && ((h.y = e), (h.x = 0), (i = _)),
						(n = Math.min(n, d)) < i)
					)
						return !1;
					return (t.fraction = i), !0;
				}),
				(m.prototype.TestOverlap = function (t) {
					var e = t.lowerBound.x - this.upperBound.x,
						i = t.lowerBound.y - this.upperBound.y,
						n = this.lowerBound.x - t.upperBound.x,
						t = this.lowerBound.y - t.upperBound.y;
					return !(0 < e || 0 < i) && !(0 < n || 0 < t);
				}),
				(m.Combine = function (t, e) {
					var i = new m();
					return i.Combine(t, e), i;
				}),
				(m.prototype.Combine = function (t, e) {
					(this.lowerBound.x = Math.min(
						t.lowerBound.x,
						e.lowerBound.x
					)),
						(this.lowerBound.y = Math.min(
							t.lowerBound.y,
							e.lowerBound.y
						)),
						(this.upperBound.x = Math.max(
							t.upperBound.x,
							e.upperBound.x
						)),
						(this.upperBound.y = Math.max(
							t.upperBound.y,
							e.upperBound.y
						));
				}),
				(o.b2Bound = function () {}),
				(o.prototype.IsLower = function () {
					return 0 == (1 & this.value);
				}),
				(o.prototype.IsUpper = function () {
					return 1 == (1 & this.value);
				}),
				(o.prototype.Swap = function (t) {
					var e = this.value,
						i = this.proxy,
						n = this.stabbingCount;
					(this.value = t.value),
						(this.proxy = t.proxy),
						(this.stabbingCount = t.stabbingCount),
						(t.value = e),
						(t.proxy = i),
						(t.stabbingCount = n);
				}),
				(s.b2BoundValues = function () {}),
				(s.prototype.b2BoundValues = function () {
					(this.lowerValues = new Vector_a2j_Number()),
						(this.lowerValues[0] = 0),
						(this.lowerValues[1] = 0),
						(this.upperValues = new Vector_a2j_Number()),
						(this.upperValues[0] = 0),
						(this.upperValues[1] = 0);
				}),
				(R.b2Collision = function () {}),
				(R.ClipSegmentToLine = function (t, e, i, n) {
					void 0 === n && (n = 0);
					var r,
						o = 0,
						s = (r = e[0]).v,
						c = (r = e[1]).v,
						a = i.x * s.x + i.y * s.y - n,
						i = i.x * c.x + i.y * c.y - n;
					return (
						a <= 0 && t[o++].Set(e[0]),
						i <= 0 && t[o++].Set(e[1]),
						a * i < 0 &&
							((n = a / (a - i)),
							((i = (r = t[o]).v).x = s.x + n * (c.x - s.x)),
							(i.y = s.y + n * (c.y - s.y)),
							(r = t[o]),
							(e = 0 < a ? e[0] : e[1]),
							(r.id = e.id),
							++o),
						o
					);
				}),
				(R.EdgeSeparation = function (t, e, i, n, r) {
					void 0 === i && (i = 0);
					parseInt(t.m_vertexCount);
					for (
						var o = t.m_vertices,
							s = t.m_normals,
							c = parseInt(n.m_vertexCount),
							a = n.m_vertices,
							t = e.R,
							l = s[i],
							n = t.col1.x * l.x + t.col2.x * l.y,
							s = t.col1.y * l.x + t.col2.y * l.y,
							h = (t = r.R).col1.x * n + t.col1.y * s,
							u = t.col2.x * n + t.col2.y * s,
							_ = 0,
							d = Number.MAX_VALUE,
							p = 0;
						p < c;
						++p
					) {
						var f = (l = a[p]).x * h + l.y * u;
						f < d && ((d = f), (_ = p));
					}
					(l = o[i]), (t = e.R);
					(o = e.position.x + (t.col1.x * l.x + t.col2.x * l.y)),
						(i = e.position.y + (t.col1.y * l.x + t.col2.y * l.y));
					(l = a[_]), (t = r.R);
					(e = r.position.x + (t.col1.x * l.x + t.col2.x * l.y)),
						(t = r.position.y + (t.col1.y * l.x + t.col2.y * l.y));
					return (e -= o) * n + (t -= i) * s;
				}),
				(R.FindMaxSeparation = function (t, e, i, n, r) {
					var o = parseInt(e.m_vertexCount),
						s = e.m_normals,
						c = r.R,
						a = n.m_centroid,
						l = r.position.x + (c.col1.x * a.x + c.col2.x * a.y),
						h = r.position.y + (c.col1.y * a.x + c.col2.y * a.y);
					(c = i.R),
						(a = e.m_centroid),
						(l -= i.position.x + (c.col1.x * a.x + c.col2.x * a.y)),
						(h -= i.position.y + (c.col1.y * a.x + c.col2.y * a.y));
					for (
						var u = l * i.R.col1.x + h * i.R.col1.y,
							_ = l * i.R.col2.x + h * i.R.col2.y,
							d = 0,
							p = -Number.MAX_VALUE,
							f = 0;
						f < o;
						++f
					) {
						var m = (a = s[f]).x * u + a.y * _;
						p < m && ((p = m), (d = f));
					}
					var g = R.EdgeSeparation(e, i, d, n, r),
						y = parseInt(0 <= d - 1 ? d - 1 : o - 1),
						c = R.EdgeSeparation(e, i, y, n, r),
						l = parseInt(d + 1 < o ? d + 1 : 0),
						h = R.EdgeSeparation(e, i, l, n, r),
						T = 0,
						S = 0,
						C = 0;
					if (g < c && h < c) (C = -1), (T = y), (S = c);
					else {
						if (!(g < h)) return (t[0] = d), g;
						(C = 1), (T = l), (S = h);
					}
					for (
						;
						(d =
							-1 == C
								? 0 <= T - 1
									? T - 1
									: o - 1
								: T + 1 < o
								? T + 1
								: 0),
							S < (g = R.EdgeSeparation(e, i, d, n, r));

					)
						(T = d), (S = g);
					return (t[0] = T), S;
				}),
				(R.FindIncidentEdge = function (t, e, i, n, r, o) {
					void 0 === n && (n = 0);
					parseInt(e.m_vertexCount);
					for (
						var s = e.m_normals,
							c = parseInt(r.m_vertexCount),
							a = r.m_vertices,
							l = r.m_normals,
							e = i.R,
							h = s[n],
							u = e.col1.x * h.x + e.col2.x * h.y,
							_ = e.col1.y * h.x + e.col2.y * h.y,
							r = (e = o.R).col1.x * u + e.col1.y * _,
							_ = e.col2.x * u + e.col2.y * _,
							u = r,
							d = 0,
							p = Number.MAX_VALUE,
							f = 0;
						f < c;
						++f
					) {
						var m = u * (h = l[f]).x + _ * h.y;
						m < p && ((p = m), (d = f));
					}
					(i = parseInt(d)),
						(s = parseInt(i + 1 < c ? i + 1 : 0)),
						(r = t[0]);
					(h = a[i]),
						(e = o.R),
						(r.v.x =
							o.position.x + (e.col1.x * h.x + e.col2.x * h.y)),
						(r.v.y =
							o.position.y + (e.col1.y * h.x + e.col2.y * h.y)),
						(r.id.features.referenceEdge = n),
						(r.id.features.incidentEdge = i),
						(r.id.features.incidentVertex = 0),
						(r = t[1]),
						(h = a[s]),
						(e = o.R),
						(r.v.x =
							o.position.x + (e.col1.x * h.x + e.col2.x * h.y)),
						(r.v.y =
							o.position.y + (e.col1.y * h.x + e.col2.y * h.y)),
						(r.id.features.referenceEdge = n),
						(r.id.features.incidentEdge = s),
						(r.id.features.incidentVertex = 1);
				}),
				(R.MakeClipPointVector = function () {
					var t = new Vector(2);
					return (t[0] = new N()), (t[1] = new N()), t;
				}),
				(R.CollidePolygons = function (t, e, i, n, r) {
					t.m_pointCount = 0;
					var o = e.m_radius + n.m_radius,
						s = 0;
					R.s_edgeAO[0] = 0;
					var c = R.FindMaxSeparation(R.s_edgeAO, e, i, n, r),
						s = R.s_edgeAO[0];
					if (!(o < c)) {
						R.s_edgeBO[0] = 0;
						var a = R.FindMaxSeparation(R.s_edgeBO, n, r, e, i),
							l = R.s_edgeBO[0];
						if (!(o < a)) {
							var h,
								u = 0,
								_ = 0,
								_ =
									0.98 * c + 0.001 < a
										? ((p = n),
										  (d = e),
										  (g = r),
										  (h = i),
										  (u = l),
										  (t.m_type = P.e_faceB),
										  1)
										: ((p = e),
										  (d = n),
										  (g = i),
										  (h = r),
										  (u = s),
										  (t.m_type = P.e_faceA),
										  0),
								l = R.s_incidentEdge;
							R.FindIncidentEdge(l, p, g, u, d, h);
							(e = parseInt(p.m_vertexCount)),
								(n = p.m_vertices),
								(i = n[u]),
								(r = u + 1 < e ? n[parseInt(u + 1)] : n[0]),
								(s = R.s_localTangent);
							s.Set(r.x - i.x, r.y - i.y), s.Normalize();
							var d = R.s_localNormal;
							(d.x = s.y), (d.y = -s.x);
							var p = R.s_planePoint;
							p.Set(0.5 * (i.x + r.x), 0.5 * (i.y + r.y));
							e = R.s_tangent;
							(x = g.R),
								(e.x = x.col1.x * s.x + x.col2.x * s.y),
								(e.y = x.col1.y * s.x + x.col2.y * s.y);
							u = R.s_tangent2;
							(u.x = -e.x), (u.y = -e.y);
							var f = R.s_normal;
							(f.x = e.y), (f.y = -e.x);
							(n = R.s_v11), (s = R.s_v12);
							(n.x =
								g.position.x +
								(x.col1.x * i.x + x.col2.x * i.y)),
								(n.y =
									g.position.y +
									(x.col1.y * i.x + x.col2.y * i.y)),
								(s.x =
									g.position.x +
									(x.col1.x * r.x + x.col2.x * r.y)),
								(s.y =
									g.position.y +
									(x.col1.y * r.x + x.col2.y * r.y));
							var m = f.x * n.x + f.y * n.y,
								g = -e.x * n.x - e.y * n.y + o,
								r = e.x * s.x + e.y * s.y + o,
								n = R.s_clipPoints1,
								y = R.s_clipPoints2,
								s = 0,
								s = R.ClipSegmentToLine(n, l, u, g);
							if (
								!(
									s < 2 ||
									(s = R.ClipSegmentToLine(y, n, e, r)) < 2
								)
							) {
								t.m_localPlaneNormal.SetV(d),
									t.m_localPoint.SetV(p);
								for (
									var T = 0, S = 0;
									S < b.b2_maxManifoldPoints;
									++S
								) {
									var C,
										x,
										v,
										E,
										A = y[S];
									f.x * A.v.x + f.y * A.v.y - m <= o &&
										((C = t.m_points[T]),
										(x = h.R),
										(v = A.v.x - h.position.x),
										(E = A.v.y - h.position.y),
										(C.m_localPoint.x =
											v * x.col1.x + E * x.col1.y),
										(C.m_localPoint.y =
											v * x.col2.x + E * x.col2.y),
										C.m_id.Set(A.id),
										(C.m_id.features.flip = _),
										++T);
								}
								t.m_pointCount = T;
							}
						}
					}
				}),
				(R.CollideCircles = function (t, e, i, n, r) {
					(t.m_pointCount = 0), (s = i.R), (c = e.m_p);
					var o = i.position.x + (s.col1.x * c.x + s.col2.x * c.y),
						i = i.position.y + (s.col1.y * c.x + s.col2.y * c.y),
						s = r.R,
						c = n.m_p,
						o =
							r.position.x +
							(s.col1.x * c.x + s.col2.x * c.y) -
							o,
						i =
							r.position.y +
							(s.col1.y * c.x + s.col2.y * c.y) -
							i,
						o = o * o + i * i,
						i = e.m_radius + n.m_radius;
					i * i < o ||
						((t.m_type = P.e_circles),
						t.m_localPoint.SetV(e.m_p),
						t.m_localPlaneNormal.SetZero(),
						(t.m_pointCount = 1),
						t.m_points[0].m_localPoint.SetV(n.m_p),
						(t.m_points[0].m_id.key = 0));
				}),
				(R.CollidePolygonAndCircle = function (t, e, i, n, r) {
					for (
						var o = (t.m_pointCount = 0),
							s = r.R,
							c = n.m_p,
							a =
								r.position.x +
								(s.col1.x * c.x + s.col2.x * c.y),
							r =
								r.position.y +
								(s.col1.y * c.x + s.col2.y * c.y),
							o = a - i.position.x,
							l = r - i.position.y,
							h = o * (s = i.R).col1.x + l * s.col1.y,
							u = o * s.col2.x + l * s.col2.y,
							_ = 0,
							d = -Number.MAX_VALUE,
							p = e.m_radius + n.m_radius,
							f = parseInt(e.m_vertexCount),
							m = e.m_vertices,
							g = e.m_normals,
							y = 0;
						y < f;
						++y
					) {
						(o = h - (c = m[y]).x), (l = u - c.y);
						var T = (c = g[y]).x * o + c.y * l;
						if (p < T) return;
						d < T && ((d = T), (_ = y));
					}
					(a = parseInt(_)),
						(r = parseInt(a + 1 < f ? a + 1 : 0)),
						(i = m[a]),
						(s = m[r]);
					if (d < Number.MIN_VALUE)
						return (
							(t.m_pointCount = 1),
							(t.m_type = P.e_faceA),
							t.m_localPlaneNormal.SetV(g[_]),
							(t.m_localPoint.x = 0.5 * (i.x + s.x)),
							(t.m_localPoint.y = 0.5 * (i.y + s.y)),
							t.m_points[0].m_localPoint.SetV(n.m_p),
							void (t.m_points[0].m_id.key = 0)
						);
					(e = (h - i.x) * (s.x - i.x) + (u - i.y) * (s.y - i.y)),
						(r = (h - s.x) * (i.x - s.x) + (u - s.y) * (i.y - s.y));
					e <= 0
						? (h - i.x) * (h - i.x) + (u - i.y) * (u - i.y) >
								p * p ||
						  ((t.m_pointCount = 1),
						  (t.m_type = P.e_faceA),
						  (t.m_localPlaneNormal.x = h - i.x),
						  (t.m_localPlaneNormal.y = u - i.y),
						  t.m_localPlaneNormal.Normalize(),
						  t.m_localPoint.SetV(i),
						  t.m_points[0].m_localPoint.SetV(n.m_p),
						  (t.m_points[0].m_id.key = 0))
						: r <= 0
						? (h - s.x) * (h - s.x) + (u - s.y) * (u - s.y) >
								p * p ||
						  ((t.m_pointCount = 1),
						  (t.m_type = P.e_faceA),
						  (t.m_localPlaneNormal.x = h - s.x),
						  (t.m_localPlaneNormal.y = u - s.y),
						  t.m_localPlaneNormal.Normalize(),
						  t.m_localPoint.SetV(s),
						  t.m_points[0].m_localPoint.SetV(n.m_p),
						  (t.m_points[0].m_id.key = 0))
						: ((r = 0.5 * (i.x + s.x)),
						  (s = 0.5 * (i.y + s.y)),
						  p < (d = (h - r) * g[a].x + (u - s) * g[a].y) ||
								((t.m_pointCount = 1),
								(t.m_type = P.e_faceA),
								(t.m_localPlaneNormal.x = g[a].x),
								(t.m_localPlaneNormal.y = g[a].y),
								t.m_localPlaneNormal.Normalize(),
								t.m_localPoint.Set(r, s),
								t.m_points[0].m_localPoint.SetV(n.m_p),
								(t.m_points[0].m_id.key = 0)));
				}),
				(R.TestOverlap = function (t, e) {
					var i = e.lowerBound,
						n = t.upperBound,
						r = i.x - n.x,
						o = i.y - n.y,
						i = t.lowerBound,
						n = e.upperBound,
						e = i.x - n.x,
						n = i.y - n.y;
					return !(0 < r || 0 < o) && !(0 < e || 0 < n);
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Collision.b2Collision.s_incidentEdge =
						R.MakeClipPointVector()),
						(Box2D.Collision.b2Collision.s_clipPoints1 =
							R.MakeClipPointVector()),
						(Box2D.Collision.b2Collision.s_clipPoints2 =
							R.MakeClipPointVector()),
						(Box2D.Collision.b2Collision.s_edgeAO =
							new Vector_a2j_Number(1)),
						(Box2D.Collision.b2Collision.s_edgeBO =
							new Vector_a2j_Number(1)),
						(Box2D.Collision.b2Collision.s_localTangent = new E()),
						(Box2D.Collision.b2Collision.s_localNormal = new E()),
						(Box2D.Collision.b2Collision.s_planePoint = new E()),
						(Box2D.Collision.b2Collision.s_normal = new E()),
						(Box2D.Collision.b2Collision.s_tangent = new E()),
						(Box2D.Collision.b2Collision.s_tangent2 = new E()),
						(Box2D.Collision.b2Collision.s_v11 = new E()),
						(Box2D.Collision.b2Collision.s_v12 = new E()),
						(Box2D.Collision.b2Collision.b2CollidePolyTempVec =
							new E()),
						(Box2D.Collision.b2Collision.b2_nullFeature = 255);
				}),
				(c.b2ContactID = function () {
					this.features = new F();
				}),
				(c.prototype.b2ContactID = function () {
					this.features._m_id = this;
				}),
				(c.prototype.Set = function (t) {
					this.key = t._key;
				}),
				(c.prototype.Copy = function () {
					var t = new c();
					return (t.key = this.key), t;
				}),
				Object.defineProperty(c.prototype, 'key', {
					enumerable: !1,
					configurable: !0,
					get: function () {
						return this._key;
					},
				}),
				Object.defineProperty(c.prototype, 'key', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._key = t),
							(this.features._referenceEdge = 255 & this._key),
							(this.features._incidentEdge =
								((65280 & this._key) >> 8) & 255),
							(this.features._incidentVertex =
								((16711680 & this._key) >> 16) & 255),
							(this.features._flip =
								((4278190080 & this._key) >> 24) & 255);
					},
				}),
				(a.b2ContactPoint = function () {
					(this.position = new E()),
						(this.velocity = new E()),
						(this.normal = new E()),
						(this.id = new c());
				}),
				(T.b2Distance = function () {}),
				(T.Distance = function (t, e, i) {
					++T.b2_gjkCalls;
					var n = i.proxyA,
						r = i.proxyB,
						o = i.transformA,
						s = i.transformB,
						c = T.s_simplex;
					c.ReadCache(e, n, o, r, s);
					for (
						var a,
							l,
							h,
							u = c.m_vertices,
							_ = T.s_saveA,
							d = T.s_saveB,
							p = (c.GetClosestPoint().LengthSquared(), 0),
							f = 0;
						f < 20;

					) {
						for (a = c.m_count, p = 0; p < a; p++)
							(_[p] = u[p].indexA), (d[p] = u[p].indexB);
						switch (c.m_count) {
							case 1:
								break;
							case 2:
								c.Solve2();
								break;
							case 3:
								c.Solve3();
								break;
							default:
								b.b2Assert(!1);
						}
						if (3 == c.m_count) break;
						(l = c.GetClosestPoint()).LengthSquared();
						var m = c.GetSearchDirection();
						if (
							m.LengthSquared() <
							Number.MIN_VALUE * Number.MIN_VALUE
						)
							break;
						var g = u[c.m_count];
						(g.indexA = n.GetSupport(
							v.MulTMV(o.R, m.GetNegative())
						)),
							(g.wA = v.MulX(o, n.GetVertex(g.indexA))),
							(g.indexB = r.GetSupport(v.MulTMV(s.R, m))),
							(g.wB = v.MulX(s, r.GetVertex(g.indexB))),
							(g.w = v.SubtractVV(g.wB, g.wA)),
							++f,
							++T.b2_gjkIters;
						for (var y = !1, p = 0; p < a; p++)
							if (g.indexA == _[p] && g.indexB == d[p]) {
								y = !0;
								break;
							}
						if (y) break;
						++c.m_count;
					}
					(T.b2_gjkMaxIters = v.Max(T.b2_gjkMaxIters, f)),
						c.GetWitnessPoints(t.pointA, t.pointB),
						(t.distance = v
							.SubtractVV(t.pointA, t.pointB)
							.Length()),
						(t.iterations = f),
						c.WriteCache(e),
						i.useRadii &&
							((h = n.m_radius),
							(e = r.m_radius),
							t.distance > h + e && t.distance > Number.MIN_VALUE
								? ((t.distance -= h + e),
								  (i = v.SubtractVV(
										t.pointB,
										t.pointA
								  )).Normalize(),
								  (t.pointA.x += h * i.x),
								  (t.pointA.y += h * i.y),
								  (t.pointB.x -= e * i.x),
								  (t.pointB.y -= e * i.y))
								: (((l = new E()).x =
										0.5 * (t.pointA.x + t.pointB.x)),
								  (l.y = 0.5 * (t.pointA.y + t.pointB.y)),
								  (t.pointA.x = t.pointB.x = l.x),
								  (t.pointA.y = t.pointB.y = l.y),
								  (t.distance = 0)));
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Collision.b2Distance.s_simplex = new I()),
						(Box2D.Collision.b2Distance.s_saveA =
							new Vector_a2j_Number(3)),
						(Box2D.Collision.b2Distance.s_saveB =
							new Vector_a2j_Number(3));
				}),
				(l.b2DistanceInput = function () {}),
				(h.b2DistanceOutput = function () {
					(this.pointA = new E()), (this.pointB = new E());
				}),
				(u.b2DistanceProxy = function () {}),
				(u.prototype.Set = function (t) {
					switch (t.GetType()) {
						case r.e_circleShape:
							var e = t instanceof i ? t : null;
							(this.m_vertices = new Vector(1, !0)),
								(this.m_vertices[0] = e.m_p),
								(this.m_count = 1),
								(this.m_radius = e.m_radius);
							break;
						case r.e_polygonShape:
							e = t instanceof n ? t : null;
							(this.m_vertices = e.m_vertices),
								(this.m_count = e.m_vertexCount),
								(this.m_radius = e.m_radius);
							break;
						default:
							b.b2Assert(!1);
					}
				}),
				(u.prototype.GetSupport = function (t) {
					for (
						var e = 0,
							i =
								this.m_vertices[0].x * t.x +
								this.m_vertices[0].y * t.y,
							n = 1;
						n < this.m_count;
						++n
					) {
						var r =
							this.m_vertices[n].x * t.x +
							this.m_vertices[n].y * t.y;
						i < r && ((e = n), (i = r));
					}
					return e;
				}),
				(u.prototype.GetSupportVertex = function (t) {
					for (
						var e = 0,
							i =
								this.m_vertices[0].x * t.x +
								this.m_vertices[0].y * t.y,
							n = 1;
						n < this.m_count;
						++n
					) {
						var r =
							this.m_vertices[n].x * t.x +
							this.m_vertices[n].y * t.y;
						i < r && ((e = n), (i = r));
					}
					return this.m_vertices[e];
				}),
				(u.prototype.GetVertexCount = function () {
					return this.m_count;
				}),
				(u.prototype.GetVertex = function (t) {
					return (
						void 0 === t && (t = 0),
						b.b2Assert(0 <= t && t < this.m_count),
						this.m_vertices[t]
					);
				}),
				(_.b2DynamicTree = function () {}),
				(_.prototype.b2DynamicTree = function () {
					(this.m_root = null),
						(this.m_freeList = null),
						(this.m_path = 0),
						(this.m_insertionCount = 0);
				}),
				(_.prototype.CreateProxy = function (t, e) {
					var i = this.AllocateNode(),
						n = b.b2_aabbExtension,
						r = b.b2_aabbExtension;
					return (
						(i.aabb.lowerBound.x = t.lowerBound.x - n),
						(i.aabb.lowerBound.y = t.lowerBound.y - r),
						(i.aabb.upperBound.x = t.upperBound.x + n),
						(i.aabb.upperBound.y = t.upperBound.y + r),
						(i.userData = e),
						this.InsertLeaf(i),
						i
					);
				}),
				(_.prototype.DestroyProxy = function (t) {
					this.RemoveLeaf(t), this.FreeNode(t);
				}),
				(_.prototype.MoveProxy = function (t, e, i) {
					if ((b.b2Assert(t.IsLeaf()), t.aabb.Contains(e))) return !1;
					this.RemoveLeaf(t);
					var n =
							b.b2_aabbExtension +
							b.b2_aabbMultiplier * (0 < i.x ? i.x : -i.x),
						i =
							b.b2_aabbExtension +
							b.b2_aabbMultiplier * (0 < i.y ? i.y : -i.y);
					return (
						(t.aabb.lowerBound.x = e.lowerBound.x - n),
						(t.aabb.lowerBound.y = e.lowerBound.y - i),
						(t.aabb.upperBound.x = e.upperBound.x + n),
						(t.aabb.upperBound.y = e.upperBound.y + i),
						this.InsertLeaf(t),
						!0
					);
				}),
				(_.prototype.Rebalance = function (t) {
					if ((void 0 === t && (t = 0), null != this.m_root))
						for (var e = 0; e < t; e++) {
							for (var i = this.m_root, n = 0; 0 == i.IsLeaf(); )
								(i =
									(this.m_path >> n) & 1
										? i.child2
										: i.child1),
									(n = (n + 1) & 31);
							++this.m_path,
								this.RemoveLeaf(i),
								this.InsertLeaf(i);
						}
				}),
				(_.prototype.GetFatAABB = function (t) {
					return t.aabb;
				}),
				(_.prototype.GetUserData = function (t) {
					return t.userData;
				}),
				(_.prototype.Query = function (t, e) {
					if (null != this.m_root) {
						var i = new Vector(),
							n = 0;
						for (i[n++] = this.m_root; 0 < n; ) {
							var r = i[--n];
							if (r.aabb.TestOverlap(e))
								if (r.IsLeaf()) {
									if (!t(r)) return;
								} else (i[n++] = r.child1), (i[n++] = r.child2);
						}
					}
				}),
				(_.prototype.RayCast = function (t, e) {
					if (null != this.m_root) {
						var i = e.p1,
							n = e.p2,
							r = v.SubtractVV(i, n);
						r.Normalize();
						var o = v.CrossFV(1, r),
							s = v.AbsV(o),
							c = e.maxFraction,
							a = new m(),
							l = i.x + c * (n.x - i.x),
							h = i.y + c * (n.y - i.y);
						(a.lowerBound.x = Math.min(i.x, l)),
							(a.lowerBound.y = Math.min(i.y, h)),
							(a.upperBound.x = Math.max(i.x, l)),
							(a.upperBound.y = Math.max(i.y, h));
						var u = new Vector(),
							_ = 0;
						for (u[_++] = this.m_root; 0 < _; ) {
							var d = u[--_];
							if (0 != d.aabb.TestOverlap(a)) {
								var p = d.aabb.GetCenter(),
									f = d.aabb.GetExtents();
								if (
									!(
										0 <
										Math.abs(
											o.x * (i.x - p.x) +
												o.y * (i.y - p.y)
										) -
											s.x * f.x -
											s.y * f.y
									)
								)
									if (d.IsLeaf()) {
										f = new S();
										if (
											((f.p1 = e.p1),
											(f.p2 = e.p2),
											(f.maxFraction = e.maxFraction),
											0 == (c = t(f, d)))
										)
											return;
										0 < c &&
											((l = i.x + c * (n.x - i.x)),
											(h = i.y + c * (n.y - i.y)),
											(a.lowerBound.x = Math.min(i.x, l)),
											(a.lowerBound.y = Math.min(i.y, h)),
											(a.upperBound.x = Math.max(i.x, l)),
											(a.upperBound.y = Math.max(
												i.y,
												h
											)));
									} else
										(u[_++] = d.child1),
											(u[_++] = d.child2);
							}
						}
					}
				}),
				(_.prototype.AllocateNode = function () {
					if (this.m_freeList) {
						var t = this.m_freeList;
						return (
							(this.m_freeList = t.parent),
							(t.parent = null),
							(t.child1 = null),
							(t.child2 = null),
							t
						);
					}
					return new p();
				}),
				(_.prototype.FreeNode = function (t) {
					(t.parent = this.m_freeList), (this.m_freeList = t);
				}),
				(_.prototype.InsertLeaf = function (t) {
					if ((++this.m_insertionCount, null == this.m_root))
						return (
							(this.m_root = t), void (this.m_root.parent = null)
						);
					var e = t.aabb.GetCenter();
					if (0 == (r = this.m_root).IsLeaf())
						do {
							var i = r.child1,
								n = r.child2,
								r =
									Math.abs(
										(i.aabb.lowerBound.x +
											i.aabb.upperBound.x) /
											2 -
											e.x
									) +
										Math.abs(
											(i.aabb.lowerBound.y +
												i.aabb.upperBound.y) /
												2 -
												e.y
										) <
									Math.abs(
										(n.aabb.lowerBound.x +
											n.aabb.upperBound.x) /
											2 -
											e.x
									) +
										Math.abs(
											(n.aabb.lowerBound.y +
												n.aabb.upperBound.y) /
												2 -
												e.y
										)
										? i
										: n;
						} while (0 == r.IsLeaf());
					var o = r.parent,
						s = this.AllocateNode();
					if (
						((s.parent = o),
						(s.userData = null),
						s.aabb.Combine(t.aabb, r.aabb),
						o)
					)
						for (
							r.parent.child1 == r
								? (o.child1 = s)
								: (o.child2 = s),
								s.child1 = r,
								s.child2 = t,
								r.parent = s,
								t.parent = s;
							!o.aabb.Contains(s.aabb) &&
							(o.aabb.Combine(o.child1.aabb, o.child2.aabb),
							(o = (s = o).parent));

						);
					else
						(s.child1 = r),
							(s.child2 = t),
							(r.parent = s),
							(t.parent = s),
							(this.m_root = s);
				}),
				(_.prototype.RemoveLeaf = function (t) {
					if (t != this.m_root) {
						var e = t.parent,
							i = e.parent,
							t = e.child1 == t ? e.child2 : e.child1;
						if (i)
							for (
								i.child1 == e ? (i.child1 = t) : (i.child2 = t),
									t.parent = i,
									this.FreeNode(e);
								i;

							) {
								var n = i.aabb;
								if (
									((i.aabb = m.Combine(
										i.child1.aabb,
										i.child2.aabb
									)),
									n.Contains(i.aabb))
								)
									break;
								i = i.parent;
							}
						else
							((this.m_root = t).parent = null), this.FreeNode(e);
					} else this.m_root = null;
				}),
				(d.b2DynamicTreeBroadPhase = function () {
					(this.m_tree = new _()),
						(this.m_moveBuffer = new Vector()),
						(this.m_pairBuffer = new Vector()),
						(this.m_pairCount = 0);
				}),
				(d.prototype.CreateProxy = function (t, e) {
					e = this.m_tree.CreateProxy(t, e);
					return ++this.m_proxyCount, this.BufferMove(e), e;
				}),
				(d.prototype.DestroyProxy = function (t) {
					this.UnBufferMove(t),
						--this.m_proxyCount,
						this.m_tree.DestroyProxy(t);
				}),
				(d.prototype.MoveProxy = function (t, e, i) {
					this.m_tree.MoveProxy(t, e, i) && this.BufferMove(t);
				}),
				(d.prototype.TestOverlap = function (t, e) {
					(t = this.m_tree.GetFatAABB(t)),
						(e = this.m_tree.GetFatAABB(e));
					return t.TestOverlap(e);
				}),
				(d.prototype.GetUserData = function (t) {
					return this.m_tree.GetUserData(t);
				}),
				(d.prototype.GetFatAABB = function (t) {
					return this.m_tree.GetFatAABB(t);
				}),
				(d.prototype.GetProxyCount = function () {
					return this.m_proxyCount;
				}),
				(d.prototype.UpdatePairs = function (t) {
					var i,
						n = this,
						e = (n.m_pairCount = 0);
					for (e = 0; e < n.m_moveBuffer.length; ++e) {
						function r(t) {
							if (t == i) return !0;
							n.m_pairCount == n.m_pairBuffer.length &&
								(n.m_pairBuffer[n.m_pairCount] = new f());
							var e = n.m_pairBuffer[n.m_pairCount];
							return (
								(e.proxyA = t < i ? t : i),
								(e.proxyB = i <= t ? t : i),
								++n.m_pairCount,
								!0
							);
						}
						i = n.m_moveBuffer[e];
						var o = n.m_tree.GetFatAABB(i);
						n.m_tree.Query(r, o);
					}
					for (e = n.m_moveBuffer.length = 0; e < n.m_pairCount; ) {
						var s = n.m_pairBuffer[e];
						for (
							t(
								n.m_tree.GetUserData(s.proxyA),
								n.m_tree.GetUserData(s.proxyB)
							),
								++e;
							e < n.m_pairCount;

						) {
							var c = n.m_pairBuffer[e];
							if (c.proxyA != s.proxyA || c.proxyB != s.proxyB)
								break;
							++e;
						}
					}
				}),
				(d.prototype.Query = function (t, e) {
					this.m_tree.Query(t, e);
				}),
				(d.prototype.RayCast = function (t, e) {
					this.m_tree.RayCast(t, e);
				}),
				(d.prototype.Validate = function () {}),
				(d.prototype.Rebalance = function (t) {
					void 0 === t && (t = 0), this.m_tree.Rebalance(t);
				}),
				(d.prototype.BufferMove = function (t) {
					this.m_moveBuffer[this.m_moveBuffer.length] = t;
				}),
				(d.prototype.UnBufferMove = function (t) {
					t = parseInt(this.m_moveBuffer.indexOf(t));
					this.m_moveBuffer.splice(t, 1);
				}),
				(d.prototype.ComparePairs = function (t, e) {
					return 0;
				}),
				(d.__implements = {}),
				(d.__implements[M] = !0),
				(p.b2DynamicTreeNode = function () {
					this.aabb = new m();
				}),
				(p.prototype.IsLeaf = function () {
					return null == this.child1;
				}),
				(f.b2DynamicTreePair = function () {}),
				(P.b2Manifold = function () {
					this.m_pointCount = 0;
				}),
				(P.prototype.b2Manifold = function () {
					this.m_points = new Vector(b.b2_maxManifoldPoints);
					for (var t = 0; t < b.b2_maxManifoldPoints; t++)
						this.m_points[t] = new g();
					(this.m_localPlaneNormal = new E()),
						(this.m_localPoint = new E());
				}),
				(P.prototype.Reset = function () {
					for (var t = 0; t < b.b2_maxManifoldPoints; t++)
						(this.m_points[t] instanceof g
							? this.m_points[t]
							: null
						).Reset();
					this.m_localPlaneNormal.SetZero(),
						this.m_localPoint.SetZero(),
						(this.m_type = 0),
						(this.m_pointCount = 0);
				}),
				(P.prototype.Set = function (t) {
					this.m_pointCount = t.m_pointCount;
					for (var e = 0; e < b.b2_maxManifoldPoints; e++)
						(this.m_points[e] instanceof g
							? this.m_points[e]
							: null
						).Set(t.m_points[e]);
					this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),
						this.m_localPoint.SetV(t.m_localPoint),
						(this.m_type = t.m_type);
				}),
				(P.prototype.Copy = function () {
					var t = new P();
					return t.Set(this), t;
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Collision.b2Manifold.e_circles = 1),
						(Box2D.Collision.b2Manifold.e_faceA = 2),
						(Box2D.Collision.b2Manifold.e_faceB = 4);
				}),
				(g.b2ManifoldPoint = function () {
					(this.m_localPoint = new E()), (this.m_id = new c());
				}),
				(g.prototype.b2ManifoldPoint = function () {
					this.Reset();
				}),
				(g.prototype.Reset = function () {
					this.m_localPoint.SetZero(),
						(this.m_normalImpulse = 0),
						(this.m_tangentImpulse = 0),
						(this.m_id.key = 0);
				}),
				(g.prototype.Set = function (t) {
					this.m_localPoint.SetV(t.m_localPoint),
						(this.m_normalImpulse = t.m_normalImpulse),
						(this.m_tangentImpulse = t.m_tangentImpulse),
						this.m_id.Set(t.m_id);
				}),
				(y.b2Point = function () {
					this.p = new E();
				}),
				(y.prototype.Support = function (t, e, i) {
					return (
						void 0 === e && (e = 0), void 0 === i && (i = 0), this.p
					);
				}),
				(y.prototype.GetFirstVertex = function (t) {
					return this.p;
				}),
				(S.b2RayCastInput = function () {
					(this.p1 = new E()), (this.p2 = new E());
				}),
				(S.prototype.b2RayCastInput = function (t, e, i) {
					void 0 === t && (t = null),
						void 0 === e && (e = null),
						void 0 === i && (i = 1),
						t && this.p1.SetV(t),
						e && this.p2.SetV(e),
						(this.maxFraction = i);
				}),
				(C.b2RayCastOutput = function () {
					this.normal = new E();
				}),
				(x.b2Segment = function () {
					(this.p1 = new E()), (this.p2 = new E());
				}),
				(x.prototype.TestSegment = function (t, e, i, n) {
					void 0 === n && (n = 0);
					var r = i.p1,
						o = i.p2.x - r.x,
						s = i.p2.y - r.y,
						c = this.p2.x - this.p1.x,
						a = this.p2.y - this.p1.y,
						l = -c,
						h = 100 * Number.MIN_VALUE,
						u = -(o * a + s * l);
					if (h < u) {
						(i = r.x - this.p1.x),
							(c = r.y - this.p1.y),
							(r = i * a + c * l);
						if (0 <= r && r <= n * u) {
							i = -o * c + s * i;
							if (-h * u <= i && i <= u * (1 + h)) {
								r /= u;
								u = Math.sqrt(a * a + l * l);
								return (
									(a /= u),
									(l /= u),
									(t[0] = r),
									e.Set(a, l),
									!0
								);
							}
						}
					}
					return !1;
				}),
				(x.prototype.Extend = function (t) {
					this.ExtendForward(t), this.ExtendBackward(t);
				}),
				(x.prototype.ExtendForward = function (t) {
					var e = this.p2.x - this.p1.x,
						i = this.p2.y - this.p1.y,
						t = Math.min(
							0 < e
								? (t.upperBound.x - this.p1.x) / e
								: e < 0
								? (t.lowerBound.x - this.p1.x) / e
								: Number.POSITIVE_INFINITY,
							0 < i
								? (t.upperBound.y - this.p1.y) / i
								: i < 0
								? (t.lowerBound.y - this.p1.y) / i
								: Number.POSITIVE_INFINITY
						);
					(this.p2.x = this.p1.x + e * t),
						(this.p2.y = this.p1.y + i * t);
				}),
				(x.prototype.ExtendBackward = function (t) {
					var e = -this.p2.x + this.p1.x,
						i = -this.p2.y + this.p1.y,
						t = Math.min(
							0 < e
								? (t.upperBound.x - this.p2.x) / e
								: e < 0
								? (t.lowerBound.x - this.p2.x) / e
								: Number.POSITIVE_INFINITY,
							0 < i
								? (t.upperBound.y - this.p2.y) / i
								: i < 0
								? (t.lowerBound.y - this.p2.y) / i
								: Number.POSITIVE_INFINITY
						);
					(this.p1.x = this.p2.x + e * t),
						(this.p1.y = this.p2.y + i * t);
				}),
				(A.b2SeparationFunction = function () {
					(this.m_localPoint = new E()), (this.m_axis = new E());
				}),
				(A.prototype.Initialize = function (t, e, i, n, r) {
					(this.m_proxyA = e), (this.m_proxyB = n);
					var o,
						s,
						c,
						a,
						l,
						h,
						u = parseInt(t.count);
					b.b2Assert(0 < u && u < 3);
					var _,
						d,
						p,
						f,
						m = 0,
						g = 0,
						y = 0,
						T = 0,
						S = 0,
						C = 0,
						x = 0;
					1 == u
						? ((this.m_type = A.e_points),
						  (o = this.m_proxyA.GetVertex(t.indexA[0])),
						  (a = this.m_proxyB.GetVertex(t.indexB[0])),
						  (d = o),
						  (_ = i.R),
						  (m =
								i.position.x +
								(_.col1.x * d.x + _.col2.x * d.y)),
						  (g =
								i.position.y +
								(_.col1.y * d.x + _.col2.y * d.y)),
						  (d = a),
						  (_ = r.R),
						  (y =
								r.position.x +
								(_.col1.x * d.x + _.col2.x * d.y)),
						  (T =
								r.position.y +
								(_.col1.y * d.x + _.col2.y * d.y)),
						  (this.m_axis.x = y - m),
						  (this.m_axis.y = T - g),
						  this.m_axis.Normalize())
						: t.indexB[0] == t.indexB[1]
						? ((this.m_type = A.e_faceA),
						  (s = this.m_proxyA.GetVertex(t.indexA[0])),
						  (c = this.m_proxyA.GetVertex(t.indexA[1])),
						  (a = this.m_proxyB.GetVertex(t.indexB[0])),
						  (this.m_localPoint.x = 0.5 * (s.x + c.x)),
						  (this.m_localPoint.y = 0.5 * (s.y + c.y)),
						  (this.m_axis = v.CrossVF(v.SubtractVV(c, s), 1)),
						  this.m_axis.Normalize(),
						  (d = this.m_axis),
						  (S = (_ = i.R).col1.x * d.x + _.col2.x * d.y),
						  (C = _.col1.y * d.x + _.col2.y * d.y),
						  (d = this.m_localPoint),
						  (_ = i.R),
						  (m =
								i.position.x +
								(_.col1.x * d.x + _.col2.x * d.y)),
						  (g =
								i.position.y +
								(_.col1.y * d.x + _.col2.y * d.y)),
						  (d = a),
						  (_ = r.R),
						  (x =
								((y =
									r.position.x +
									(_.col1.x * d.x + _.col2.x * d.y)) -
									m) *
									S +
								((T =
									r.position.y +
									(_.col1.y * d.x + _.col2.y * d.y)) -
									g) *
									C) < 0 && this.m_axis.NegativeSelf())
						: t.indexA[0] == t.indexA[0]
						? ((this.m_type = A.e_faceB),
						  (l = this.m_proxyB.GetVertex(t.indexB[0])),
						  (h = this.m_proxyB.GetVertex(t.indexB[1])),
						  (o = this.m_proxyA.GetVertex(t.indexA[0])),
						  (this.m_localPoint.x = 0.5 * (l.x + h.x)),
						  (this.m_localPoint.y = 0.5 * (l.y + h.y)),
						  (this.m_axis = v.CrossVF(v.SubtractVV(h, l), 1)),
						  this.m_axis.Normalize(),
						  (d = this.m_axis),
						  (S = (_ = r.R).col1.x * d.x + _.col2.x * d.y),
						  (C = _.col1.y * d.x + _.col2.y * d.y),
						  (d = this.m_localPoint),
						  (_ = r.R),
						  (y =
								r.position.x +
								(_.col1.x * d.x + _.col2.x * d.y)),
						  (T =
								r.position.y +
								(_.col1.y * d.x + _.col2.y * d.y)),
						  (d = o),
						  (_ = i.R),
						  (x =
								((m =
									i.position.x +
									(_.col1.x * d.x + _.col2.x * d.y)) -
									y) *
									S +
								((g =
									i.position.y +
									(_.col1.y * d.x + _.col2.y * d.y)) -
									T) *
									C) < 0 && this.m_axis.NegativeSelf())
						: ((s = this.m_proxyA.GetVertex(t.indexA[0])),
						  (c = this.m_proxyA.GetVertex(t.indexA[1])),
						  (l = this.m_proxyB.GetVertex(t.indexB[0])),
						  (h = this.m_proxyB.GetVertex(t.indexB[1])),
						  v.MulX(i, o),
						  (p = v.MulMV(i.R, v.SubtractVV(c, s))),
						  v.MulX(r, a),
						  (f = v.MulMV(r.R, v.SubtractVV(h, l))),
						  (e = p.x * p.x + p.y * p.y),
						  (n = f.x * f.x + f.y * f.y),
						  (u = v.SubtractVV(f, p)),
						  (t = p.x * u.x + p.y * u.y),
						  (u = f.x * u.x + f.y * u.y),
						  (x = 0) !=
								(f = e * n - (p = p.x * f.x + p.y * f.y) * p) &&
								(x = v.Clamp((p * u - t * n) / f, 0, 1)),
						  (p * x + u) / n < 0 &&
								(x = v.Clamp((p - t) / e, 0, 1)),
						  ((o = new E()).x = s.x + x * (c.x - s.x)),
						  (o.y = s.y + x * (c.y - s.y)),
						  ((a = new E()).x = l.x + x * (h.x - l.x)),
						  (a.y = l.y + x * (h.y - l.y)),
						  0 == x || 1 == x
								? ((this.m_type = A.e_faceB),
								  (this.m_axis = v.CrossVF(
										v.SubtractVV(h, l),
										1
								  )),
								  this.m_axis.Normalize(),
								  (this.m_localPoint = a),
								  (d = this.m_axis),
								  (S = (_ = r.R).col1.x * d.x + _.col2.x * d.y),
								  (C = _.col1.y * d.x + _.col2.y * d.y),
								  (d = this.m_localPoint),
								  (_ = r.R),
								  (y =
										r.position.x +
										(_.col1.x * d.x + _.col2.x * d.y)),
								  (T =
										r.position.y +
										(_.col1.y * d.x + _.col2.y * d.y)),
								  (d = o),
								  (_ = i.R),
								  (m =
										i.position.x +
										(_.col1.x * d.x + _.col2.x * d.y)),
								  (g =
										i.position.y +
										(_.col1.y * d.x + _.col2.y * d.y)))
								: ((this.m_type = A.e_faceA),
								  (this.m_axis = v.CrossVF(
										v.SubtractVV(c, s),
										1
								  )),
								  (this.m_localPoint = o),
								  (d = this.m_axis),
								  (S = (_ = i.R).col1.x * d.x + _.col2.x * d.y),
								  (C = _.col1.y * d.x + _.col2.y * d.y),
								  (d = this.m_localPoint),
								  (_ = i.R),
								  (m =
										i.position.x +
										(_.col1.x * d.x + _.col2.x * d.y)),
								  (g =
										i.position.y +
										(_.col1.y * d.x + _.col2.y * d.y)),
								  (d = a),
								  (_ = r.R),
								  (y =
										r.position.x +
										(_.col1.x * d.x + _.col2.x * d.y)),
								  (T =
										r.position.y +
										(_.col1.y * d.x + _.col2.y * d.y))),
						  x < 0 && this.m_axis.NegativeSelf());
				}),
				(A.prototype.Evaluate = function (t, e) {
					var i, n, r, o, s, c, a;
					switch (this.m_type) {
						case A.e_points:
							return (
								(i = v.MulTMV(t.R, this.m_axis)),
								(n = v.MulTMV(e.R, this.m_axis.GetNegative())),
								(r = this.m_proxyA.GetSupportVertex(i)),
								(o = this.m_proxyB.GetSupportVertex(n)),
								(s = v.MulX(t, r)),
								((c = v.MulX(e, o)).x - s.x) * this.m_axis.x +
									(c.y - s.y) * this.m_axis.y
							);
						case A.e_faceA:
							return (
								(a = v.MulMV(t.R, this.m_axis)),
								(s = v.MulX(t, this.m_localPoint)),
								(n = v.MulTMV(e.R, a.GetNegative())),
								(o = this.m_proxyB.GetSupportVertex(n)),
								((c = v.MulX(e, o)).x - s.x) * a.x +
									(c.y - s.y) * a.y
							);
						case A.e_faceB:
							return (
								(a = v.MulMV(e.R, this.m_axis)),
								(c = v.MulX(e, this.m_localPoint)),
								(i = v.MulTMV(t.R, a.GetNegative())),
								(r = this.m_proxyA.GetSupportVertex(i)),
								((s = v.MulX(t, r)).x - c.x) * a.x +
									(s.y - c.y) * a.y
							);
						default:
							return b.b2Assert(!1), 0;
					}
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Collision.b2SeparationFunction.e_points = 1),
						(Box2D.Collision.b2SeparationFunction.e_faceA = 2),
						(Box2D.Collision.b2SeparationFunction.e_faceB = 4);
				}),
				(I.b2Simplex = function () {
					(this.m_v1 = new D()),
						(this.m_v2 = new D()),
						(this.m_v3 = new D()),
						(this.m_vertices = new Vector(3));
				}),
				(I.prototype.b2Simplex = function () {
					(this.m_vertices[0] = this.m_v1),
						(this.m_vertices[1] = this.m_v2),
						(this.m_vertices[2] = this.m_v3);
				}),
				(I.prototype.ReadCache = function (t, e, i, n, r) {
					var o, s;
					b.b2Assert(0 <= t.count && t.count <= 3),
						(this.m_count = t.count);
					for (
						var c, a, l = this.m_vertices, h = 0;
						h < this.m_count;
						h++
					) {
						var u = l[h];
						(u.indexA = t.indexA[h]),
							(u.indexB = t.indexB[h]),
							(o = e.GetVertex(u.indexA)),
							(s = n.GetVertex(u.indexB)),
							(u.wA = v.MulX(i, o)),
							(u.wB = v.MulX(r, s)),
							(u.w = v.SubtractVV(u.wB, u.wA)),
							(u.a = 0);
					}
					1 < this.m_count &&
						((c = t.metric),
						((a = this.GetMetric()) < 0.5 * c ||
							2 * c < a ||
							a < Number.MIN_VALUE) &&
							(this.m_count = 0)),
						0 == this.m_count &&
							(((u = l[0]).indexA = 0),
							(u.indexB = 0),
							(o = e.GetVertex(0)),
							(s = n.GetVertex(0)),
							(u.wA = v.MulX(i, o)),
							(u.wB = v.MulX(r, s)),
							(u.w = v.SubtractVV(u.wB, u.wA)),
							(this.m_count = 1));
				}),
				(I.prototype.WriteCache = function (t) {
					(t.metric = this.GetMetric()),
						(t.count = Box2D.parseUInt(this.m_count));
					for (var e = this.m_vertices, i = 0; i < this.m_count; i++)
						(t.indexA[i] = Box2D.parseUInt(e[i].indexA)),
							(t.indexB[i] = Box2D.parseUInt(e[i].indexB));
				}),
				(I.prototype.GetSearchDirection = function () {
					switch (this.m_count) {
						case 1:
							return this.m_v1.w.GetNegative();
						case 2:
							var t = v.SubtractVV(this.m_v2.w, this.m_v1.w);
							return 0 < v.CrossVV(t, this.m_v1.w.GetNegative())
								? v.CrossFV(1, t)
								: v.CrossVF(t, 1);
						default:
							return b.b2Assert(!1), new E();
					}
				}),
				(I.prototype.GetClosestPoint = function () {
					switch (this.m_count) {
						case 0:
							return b.b2Assert(!1), new E();
						case 1:
							return this.m_v1.w;
						case 2:
							return new E(
								this.m_v1.a * this.m_v1.w.x +
									this.m_v2.a * this.m_v2.w.x,
								this.m_v1.a * this.m_v1.w.y +
									this.m_v2.a * this.m_v2.w.y
							);
						default:
							return b.b2Assert(!1), new E();
					}
				}),
				(I.prototype.GetWitnessPoints = function (t, e) {
					switch (this.m_count) {
						case 0:
							b.b2Assert(!1);
							break;
						case 1:
							t.SetV(this.m_v1.wA), e.SetV(this.m_v1.wB);
							break;
						case 2:
							(t.x =
								this.m_v1.a * this.m_v1.wA.x +
								this.m_v2.a * this.m_v2.wA.x),
								(t.y =
									this.m_v1.a * this.m_v1.wA.y +
									this.m_v2.a * this.m_v2.wA.y),
								(e.x =
									this.m_v1.a * this.m_v1.wB.x +
									this.m_v2.a * this.m_v2.wB.x),
								(e.y =
									this.m_v1.a * this.m_v1.wB.y +
									this.m_v2.a * this.m_v2.wB.y);
							break;
						case 3:
							(e.x = t.x =
								this.m_v1.a * this.m_v1.wA.x +
								this.m_v2.a * this.m_v2.wA.x +
								this.m_v3.a * this.m_v3.wA.x),
								(e.y = t.y =
									this.m_v1.a * this.m_v1.wA.y +
									this.m_v2.a * this.m_v2.wA.y +
									this.m_v3.a * this.m_v3.wA.y);
							break;
						default:
							b.b2Assert(!1);
					}
				}),
				(I.prototype.GetMetric = function () {
					switch (this.m_count) {
						case 0:
							return b.b2Assert(!1), 0;
						case 1:
							return 0;
						case 2:
							return v
								.SubtractVV(this.m_v1.w, this.m_v2.w)
								.Length();
						case 3:
							return v.CrossVV(
								v.SubtractVV(this.m_v2.w, this.m_v1.w),
								v.SubtractVV(this.m_v3.w, this.m_v1.w)
							);
						default:
							return b.b2Assert(!1), 0;
					}
				}),
				(I.prototype.Solve2 = function () {
					var t = this.m_v1.w,
						e = this.m_v2.w,
						i = v.SubtractVV(e, t),
						t = -(t.x * i.x + t.y * i.y);
					if (t <= 0)
						return (this.m_v1.a = 1), void (this.m_count = 1);
					e = e.x * i.x + e.y * i.y;
					if (e <= 0)
						return (
							(this.m_v2.a = 1),
							(this.m_count = 1),
							void this.m_v1.Set(this.m_v2)
						);
					i = 1 / (e + t);
					(this.m_v1.a = e * i),
						(this.m_v2.a = t * i),
						(this.m_count = 2);
				}),
				(I.prototype.Solve3 = function () {
					var t = this.m_v1.w,
						e = this.m_v2.w,
						i = this.m_v3.w,
						n = v.SubtractVV(e, t),
						r = v.Dot(t, n),
						o = v.Dot(e, n),
						s = -r,
						c = v.SubtractVV(i, t),
						a = v.Dot(t, c),
						l = v.Dot(i, c),
						h = -a,
						r = v.SubtractVV(i, e),
						a = v.Dot(e, r),
						r = v.Dot(i, r),
						a = -a,
						n = v.CrossVV(n, c),
						c = n * v.CrossVV(e, i),
						i = n * v.CrossVV(i, t),
						e = n * v.CrossVV(t, e);
					if (s <= 0 && h <= 0)
						return (this.m_v1.a = 1), void (this.m_count = 1);
					if (0 < o && 0 < s && e <= 0) {
						var u = 1 / (o + s);
						return (
							(this.m_v1.a = o * u),
							(this.m_v2.a = s * u),
							void (this.m_count = 2)
						);
					}
					if (0 < l && 0 < h && i <= 0) {
						u = 1 / (l + h);
						return (
							(this.m_v1.a = l * u),
							(this.m_v3.a = h * u),
							(this.m_count = 2),
							void this.m_v2.Set(this.m_v3)
						);
					}
					if (o <= 0 && a <= 0)
						return (
							(this.m_v2.a = 1),
							(this.m_count = 1),
							void this.m_v1.Set(this.m_v2)
						);
					if (l <= 0 && r <= 0)
						return (
							(this.m_v3.a = 1),
							(this.m_count = 1),
							void this.m_v1.Set(this.m_v3)
						);
					if (0 < r && 0 < a && c <= 0) {
						var _ = 1 / (r + a);
						return (
							(this.m_v2.a = r * _),
							(this.m_v3.a = a * _),
							(this.m_count = 2),
							void this.m_v1.Set(this.m_v3)
						);
					}
					_ = 1 / (c + i + e);
					(this.m_v1.a = c * _),
						(this.m_v2.a = i * _),
						(this.m_v3.a = e * _),
						(this.m_count = 3);
				}),
				(w.b2SimplexCache = function () {
					(this.indexA = new Vector_a2j_Number(3)),
						(this.indexB = new Vector_a2j_Number(3));
				}),
				(D.b2SimplexVertex = function () {}),
				(D.prototype.Set = function (t) {
					this.wA.SetV(t.wA),
						this.wB.SetV(t.wB),
						this.w.SetV(t.w),
						(this.a = t.a),
						(this.indexA = t.indexA),
						(this.indexB = t.indexB);
				}),
				(L.b2TimeOfImpact = function () {}),
				(L.TimeOfImpact = function (t) {
					++L.b2_toiCalls;
					var e = t.proxyA,
						i = t.proxyB,
						n = t.sweepA,
						r = t.sweepB;
					b.b2Assert(n.t0 == r.t0),
						b.b2Assert(1 - n.t0 > Number.MIN_VALUE);
					var o = e.m_radius + i.m_radius,
						s = t.tolerance,
						c = 0,
						a = 0,
						l = 0;
					for (
						L.s_cache.count = 0, L.s_distanceInput.useRadii = !1;
						;

					) {
						if (
							(n.GetTransform(L.s_xfA, c),
							r.GetTransform(L.s_xfB, c),
							(L.s_distanceInput.proxyA = e),
							(L.s_distanceInput.proxyB = i),
							(L.s_distanceInput.transformA = L.s_xfA),
							(L.s_distanceInput.transformB = L.s_xfB),
							T.Distance(
								L.s_distanceOutput,
								L.s_cache,
								L.s_distanceInput
							),
							L.s_distanceOutput.distance <= 0)
						) {
							c = 1;
							break;
						}
						L.s_fcn.Initialize(L.s_cache, e, L.s_xfA, i, L.s_xfB);
						var h = L.s_fcn.Evaluate(L.s_xfA, L.s_xfB);
						if (h <= 0) {
							c = 1;
							break;
						}
						if (
							(0 == a &&
								(l =
									o < h
										? v.Max(o - s, 0.75 * o)
										: v.Max(h - s, 0.02 * o)),
							h - l < 0.5 * s)
						) {
							if (0 != a) break;
							c = 1;
							break;
						}
						var u = c,
							_ = c,
							d = 1,
							p = h;
						n.GetTransform(L.s_xfA, d), r.GetTransform(L.s_xfB, d);
						var f = L.s_fcn.Evaluate(L.s_xfA, L.s_xfB);
						if (l <= f) {
							c = 1;
							break;
						}
						for (var m = 0; ; ) {
							var g = 0,
								g =
									1 & m
										? _ + ((l - p) * (d - _)) / (f - p)
										: 0.5 * (_ + d);
							n.GetTransform(L.s_xfA, g),
								r.GetTransform(L.s_xfB, g);
							var y = L.s_fcn.Evaluate(L.s_xfA, L.s_xfB);
							if (v.Abs(y - l) < 0.025 * s) {
								u = g;
								break;
							}
							if (
								(l < y
									? ((_ = g), (p = y))
									: ((d = g), (f = y)),
								++m,
								++L.b2_toiRootIters,
								50 == m)
							)
								break;
						}
						if (
							((L.b2_toiMaxRootIters = v.Max(
								L.b2_toiMaxRootIters,
								m
							)),
							u < (1 + 100 * Number.MIN_VALUE) * c)
						)
							break;
						if (((c = u), a++, ++L.b2_toiIters, 1e3 == a)) break;
					}
					return (L.b2_toiMaxIters = v.Max(L.b2_toiMaxIters, a)), c;
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Collision.b2TimeOfImpact.b2_toiCalls = 0),
						(Box2D.Collision.b2TimeOfImpact.b2_toiIters = 0),
						(Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters = 0),
						(Box2D.Collision.b2TimeOfImpact.b2_toiRootIters = 0),
						(Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters = 0),
						(Box2D.Collision.b2TimeOfImpact.s_cache = new w()),
						(Box2D.Collision.b2TimeOfImpact.s_distanceInput =
							new l()),
						(Box2D.Collision.b2TimeOfImpact.s_xfA = new e()),
						(Box2D.Collision.b2TimeOfImpact.s_xfB = new e()),
						(Box2D.Collision.b2TimeOfImpact.s_fcn = new A()),
						(Box2D.Collision.b2TimeOfImpact.s_distanceOutput =
							new h());
				}),
				(O.b2TOIInput = function () {
					(this.proxyA = new u()),
						(this.proxyB = new u()),
						(this.sweepA = new t()),
						(this.sweepB = new t());
				}),
				(B.b2WorldManifold = function () {
					this.m_normal = new E();
				}),
				(B.prototype.b2WorldManifold = function () {
					this.m_points = new Vector(b.b2_maxManifoldPoints);
					for (var t = 0; t < b.b2_maxManifoldPoints; t++)
						this.m_points[t] = new E();
				}),
				(B.prototype.Initialize = function (t, e, i, n, r) {
					if (
						(void 0 === i && (i = 0),
						void 0 === r && (r = 0),
						0 != t.m_pointCount)
					) {
						var o = 0,
							s = 0,
							c = 0,
							a = 0,
							l = 0,
							h = 0,
							u = 0;
						switch (t.m_type) {
							case P.e_circles:
								(p = e.R), (f = t.m_localPoint);
								var _ =
										e.position.x +
										p.col1.x * f.x +
										p.col2.x * f.y,
									d =
										e.position.y +
										p.col1.y * f.x +
										p.col2.y * f.y,
									p = n.R,
									f = t.m_points[0].m_localPoint,
									m =
										n.position.x +
										p.col1.x * f.x +
										p.col2.x * f.y,
									g =
										n.position.y +
										p.col1.y * f.x +
										p.col2.y * f.y,
									y = m - _,
									T = g - d,
									S = y * y + T * T;
								S > Number.MIN_VALUE * Number.MIN_VALUE
									? ((S = Math.sqrt(S)),
									  (this.m_normal.x = y / S),
									  (this.m_normal.y = T / S))
									: ((this.m_normal.x = 1),
									  (this.m_normal.y = 0));
								(_ = _ + i * this.m_normal.x),
									(d = d + i * this.m_normal.y),
									(m = m - r * this.m_normal.x),
									(g = g - r * this.m_normal.y);
								(this.m_points[0].x = 0.5 * (_ + m)),
									(this.m_points[0].y = 0.5 * (d + g));
								break;
							case P.e_faceA:
								for (
									p = e.R,
										f = t.m_localPlaneNormal,
										s = p.col1.x * f.x + p.col2.x * f.y,
										c = p.col1.y * f.x + p.col2.y * f.y,
										p = e.R,
										f = t.m_localPoint,
										a =
											e.position.x +
											p.col1.x * f.x +
											p.col2.x * f.y,
										l =
											e.position.y +
											p.col1.y * f.x +
											p.col2.y * f.y,
										this.m_normal.x = s,
										this.m_normal.y = c,
										o = 0;
									o < t.m_pointCount;
									o++
								)
									(p = n.R),
										(f = t.m_points[o].m_localPoint),
										(h =
											n.position.x +
											p.col1.x * f.x +
											p.col2.x * f.y),
										(u =
											n.position.y +
											p.col1.y * f.x +
											p.col2.y * f.y),
										(this.m_points[o].x =
											h +
											0.5 *
												(i -
													(h - a) * s -
													(u - l) * c -
													r) *
												s),
										(this.m_points[o].y =
											u +
											0.5 *
												(i -
													(h - a) * s -
													(u - l) * c -
													r) *
												c);
								break;
							case P.e_faceB:
								for (
									p = n.R,
										f = t.m_localPlaneNormal,
										s = p.col1.x * f.x + p.col2.x * f.y,
										c = p.col1.y * f.x + p.col2.y * f.y,
										p = n.R,
										f = t.m_localPoint,
										a =
											n.position.x +
											p.col1.x * f.x +
											p.col2.x * f.y,
										l =
											n.position.y +
											p.col1.y * f.x +
											p.col2.y * f.y,
										this.m_normal.x = -s,
										this.m_normal.y = -c,
										o = 0;
									o < t.m_pointCount;
									o++
								)
									(p = e.R),
										(f = t.m_points[o].m_localPoint),
										(h =
											e.position.x +
											p.col1.x * f.x +
											p.col2.x * f.y),
										(u =
											e.position.y +
											p.col1.y * f.x +
											p.col2.y * f.y),
										(this.m_points[o].x =
											h +
											0.5 *
												(r -
													(h - a) * s -
													(u - l) * c -
													i) *
												s),
										(this.m_points[o].y =
											u +
											0.5 *
												(r -
													(h - a) * s -
													(u - l) * c -
													i) *
												c);
						}
					}
				}),
				(N.ClipVertex = function () {
					(this.v = new E()), (this.id = new c());
				}),
				(N.prototype.Set = function (t) {
					this.v.SetV(t.v), this.id.Set(t.id);
				}),
				(F.Features = function () {}),
				Object.defineProperty(F.prototype, 'referenceEdge', {
					enumerable: !1,
					configurable: !0,
					get: function () {
						return this._referenceEdge;
					},
				}),
				Object.defineProperty(F.prototype, 'referenceEdge', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._referenceEdge = t),
							(this._m_id._key =
								(4294967040 & this._m_id._key) |
								(255 & this._referenceEdge));
					},
				}),
				Object.defineProperty(F.prototype, 'incidentEdge', {
					enumerable: !1,
					configurable: !0,
					get: function () {
						return this._incidentEdge;
					},
				}),
				Object.defineProperty(F.prototype, 'incidentEdge', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._incidentEdge = t),
							(this._m_id._key =
								(4294902015 & this._m_id._key) |
								((this._incidentEdge << 8) & 65280));
					},
				}),
				Object.defineProperty(F.prototype, 'incidentVertex', {
					enumerable: !1,
					configurable: !0,
					get: function () {
						return this._incidentVertex;
					},
				}),
				Object.defineProperty(F.prototype, 'incidentVertex', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._incidentVertex = t),
							(this._m_id._key =
								(4278255615 & this._m_id._key) |
								((this._incidentVertex << 16) & 16711680));
					},
				}),
				Object.defineProperty(F.prototype, 'flip', {
					enumerable: !1,
					configurable: !0,
					get: function () {
						return this._flip;
					},
				}),
				Object.defineProperty(F.prototype, 'flip', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._flip = t),
							(this._m_id._key =
								(16777215 & this._m_id._key) |
								((this._flip << 24) & 4278190080));
					},
				});
		})(),
		(function () {
			Box2D.Common.b2Color, Box2D.Common.b2internal;
			var o = Box2D.Common.b2Settings,
				e = Box2D.Collision.Shapes.b2CircleShape,
				t = Box2D.Collision.Shapes.b2EdgeChainDef,
				i = Box2D.Collision.Shapes.b2EdgeShape,
				v = Box2D.Collision.Shapes.b2MassData,
				s = Box2D.Collision.Shapes.b2PolygonShape,
				n = Box2D.Collision.Shapes.b2Shape,
				r = Box2D.Common.Math.b2Mat22,
				E = (Box2D.Common.Math.b2Mat33, Box2D.Common.Math.b2Math),
				c = (Box2D.Common.Math.b2Sweep, Box2D.Common.Math.b2Transform),
				A = Box2D.Common.Math.b2Vec2,
				a =
					(Box2D.Common.Math.b2Vec3,
					Box2D.Dynamics.b2Body,
					Box2D.Dynamics.b2BodyDef,
					Box2D.Dynamics.b2ContactFilter,
					Box2D.Dynamics.b2ContactImpulse,
					Box2D.Dynamics.b2ContactListener,
					Box2D.Dynamics.b2ContactManager,
					Box2D.Dynamics.b2DebugDraw,
					Box2D.Dynamics.b2DestructionListener,
					Box2D.Dynamics.b2FilterData,
					Box2D.Dynamics.b2Fixture,
					Box2D.Dynamics.b2FixtureDef,
					Box2D.Dynamics.b2Island,
					Box2D.Dynamics.b2TimeStep,
					Box2D.Dynamics.b2World,
					Box2D.Collision.b2AABB,
					Box2D.Collision.b2Bound,
					Box2D.Collision.b2BoundValues,
					Box2D.Collision.b2Collision,
					Box2D.Collision.b2ContactID,
					Box2D.Collision.b2ContactPoint,
					Box2D.Collision.b2Distance),
				l = Box2D.Collision.b2DistanceInput,
				h = Box2D.Collision.b2DistanceOutput,
				u = Box2D.Collision.b2DistanceProxy,
				_ =
					(Box2D.Collision.b2DynamicTree,
					Box2D.Collision.b2DynamicTreeBroadPhase,
					Box2D.Collision.b2DynamicTreeNode,
					Box2D.Collision.b2DynamicTreePair,
					Box2D.Collision.b2Manifold,
					Box2D.Collision.b2ManifoldPoint,
					Box2D.Collision.b2Point,
					Box2D.Collision.b2RayCastInput,
					Box2D.Collision.b2RayCastOutput,
					Box2D.Collision.b2Segment,
					Box2D.Collision.b2SeparationFunction,
					Box2D.Collision.b2Simplex,
					Box2D.Collision.b2SimplexCache);
			Box2D.Collision.b2SimplexVertex,
				Box2D.Collision.b2TimeOfImpact,
				Box2D.Collision.b2TOIInput,
				Box2D.Collision.b2WorldManifold,
				Box2D.Collision.ClipVertex,
				Box2D.Collision.Features,
				Box2D.Collision.IBroadPhase,
				Box2D.inherit(e, Box2D.Collision.Shapes.b2Shape),
				(e.prototype.__super =
					Box2D.Collision.Shapes.b2Shape.prototype),
				(e.b2CircleShape = function () {
					Box2D.Collision.Shapes.b2Shape.b2Shape.apply(
						this,
						arguments
					),
						(this.m_p = new A());
				}),
				(e.prototype.Copy = function () {
					var t = new e();
					return t.Set(this), t;
				}),
				(e.prototype.Set = function (t) {
					this.__super.Set.call(this, t),
						Box2D.is(t, e) &&
							((t = t instanceof e ? t : null),
							this.m_p.SetV(t.m_p));
				}),
				(e.prototype.TestPoint = function (t, e) {
					var i = t.R,
						n =
							t.position.x +
							(i.col1.x * this.m_p.x + i.col2.x * this.m_p.y),
						i =
							t.position.y +
							(i.col1.y * this.m_p.x + i.col2.y * this.m_p.y);
					return (
						(n = e.x - n) * n + (i = e.y - i) * i <=
						this.m_radius * this.m_radius
					);
				}),
				(e.prototype.RayCast = function (t, e, i) {
					var n = i.R,
						r =
							i.position.x +
							(n.col1.x * this.m_p.x + n.col2.x * this.m_p.y),
						o =
							i.position.y +
							(n.col1.y * this.m_p.x + n.col2.y * this.m_p.y),
						s = e.p1.x - r,
						c = e.p1.y - o,
						a = s * s + c * c - this.m_radius * this.m_radius,
						i = e.p2.x - e.p1.x,
						n = e.p2.y - e.p1.y,
						r = s * i + c * n,
						o = i * i + n * n,
						a = r * r - o * a;
					if (a < 0 || o < Number.MIN_VALUE) return !1;
					a = -(r + Math.sqrt(a));
					return (
						0 <= a &&
						a <= e.maxFraction * o &&
						((a /= o),
						(t.fraction = a),
						(t.normal.x = s + a * i),
						(t.normal.y = c + a * n),
						t.normal.Normalize(),
						!0)
					);
				}),
				(e.prototype.ComputeAABB = function (t, e) {
					var i = e.R,
						n =
							e.position.x +
							(i.col1.x * this.m_p.x + i.col2.x * this.m_p.y),
						i =
							e.position.y +
							(i.col1.y * this.m_p.x + i.col2.y * this.m_p.y);
					t.lowerBound.Set(n - this.m_radius, i - this.m_radius),
						t.upperBound.Set(n + this.m_radius, i + this.m_radius);
				}),
				(e.prototype.ComputeMass = function (t, e) {
					void 0 === e && (e = 0),
						(t.mass = e * o.b2_pi * this.m_radius * this.m_radius),
						t.center.SetV(this.m_p),
						(t.I =
							t.mass *
							(0.5 * this.m_radius * this.m_radius +
								(this.m_p.x * this.m_p.x +
									this.m_p.y * this.m_p.y)));
				}),
				(e.prototype.ComputeSubmergedArea = function (t, e, i, n) {
					void 0 === e && (e = 0);
					var r = E.MulX(i, this.m_p),
						o = -(E.Dot(t, r) - e);
					if (o < -this.m_radius + Number.MIN_VALUE) return 0;
					if (o > this.m_radius)
						return (
							n.SetV(r), Math.PI * this.m_radius * this.m_radius
						);
					(i = this.m_radius * this.m_radius),
						(e = o * o),
						(o =
							i * (Math.asin(o / this.m_radius) + Math.PI / 2) +
							o * Math.sqrt(i - e)),
						(e = ((-2 / 3) * Math.pow(i - e, 1.5)) / o);
					return (n.x = r.x + t.x * e), (n.y = r.y + t.y * e), o;
				}),
				(e.prototype.GetLocalPosition = function () {
					return this.m_p;
				}),
				(e.prototype.SetLocalPosition = function (t) {
					this.m_p.SetV(t);
				}),
				(e.prototype.GetRadius = function () {
					return this.m_radius;
				}),
				(e.prototype.SetRadius = function (t) {
					void 0 === t && (t = 0), (this.m_radius = t);
				}),
				(e.prototype.b2CircleShape = function (t) {
					void 0 === t && (t = 0),
						this.__super.b2Shape.call(this),
						(this.m_type = n.e_circleShape),
						(this.m_radius = t);
				}),
				(t.b2EdgeChainDef = function () {}),
				(t.prototype.b2EdgeChainDef = function () {
					(this.vertexCount = 0),
						(this.isALoop = !0),
						(this.vertices = []);
				}),
				Box2D.inherit(i, Box2D.Collision.Shapes.b2Shape),
				(i.prototype.__super =
					Box2D.Collision.Shapes.b2Shape.prototype),
				(i.b2EdgeShape = function () {
					Box2D.Collision.Shapes.b2Shape.b2Shape.apply(
						this,
						arguments
					),
						(this.s_supportVec = new A()),
						(this.m_v1 = new A()),
						(this.m_v2 = new A()),
						(this.m_coreV1 = new A()),
						(this.m_coreV2 = new A()),
						(this.m_normal = new A()),
						(this.m_direction = new A()),
						(this.m_cornerDir1 = new A()),
						(this.m_cornerDir2 = new A());
				}),
				(i.prototype.TestPoint = function (t, e) {
					return !1;
				}),
				(i.prototype.RayCast = function (t, e, i) {
					var n = e.p2.x - e.p1.x,
						r = e.p2.y - e.p1.y,
						o = i.R,
						s =
							i.position.x +
							(o.col1.x * this.m_v1.x + o.col2.x * this.m_v1.y),
						c =
							i.position.y +
							(o.col1.y * this.m_v1.x + o.col2.y * this.m_v1.y),
						a =
							i.position.y +
							(o.col1.y * this.m_v2.x + o.col2.y * this.m_v2.y) -
							c,
						l = -(
							i.position.x +
							(o.col1.x * this.m_v2.x + o.col2.x * this.m_v2.y) -
							s
						),
						h = 100 * Number.MIN_VALUE,
						i = -(n * a + r * l);
					if (h < i) {
						(o = e.p1.x - s), (s = e.p1.y - c), (c = o * a + s * l);
						if (0 <= c && c <= e.maxFraction * i) {
							o = -n * s + r * o;
							if (-h * i <= o && o <= i * (1 + h)) {
								(c /= i), (t.fraction = c);
								c = Math.sqrt(a * a + l * l);
								return (
									(t.normal.x = a / c),
									(t.normal.y = l / c),
									!0
								);
							}
						}
					}
					return !1;
				}),
				(i.prototype.ComputeAABB = function (t, e) {
					var i = e.R,
						n =
							e.position.x +
							(i.col1.x * this.m_v1.x + i.col2.x * this.m_v1.y),
						r =
							e.position.y +
							(i.col1.y * this.m_v1.x + i.col2.y * this.m_v1.y),
						o =
							e.position.x +
							(i.col1.x * this.m_v2.x + i.col2.x * this.m_v2.y),
						i =
							e.position.y +
							(i.col1.y * this.m_v2.x + i.col2.y * this.m_v2.y);
					n < o
						? ((t.lowerBound.x = n), (t.upperBound.x = o))
						: ((t.lowerBound.x = o), (t.upperBound.x = n)),
						r < i
							? ((t.lowerBound.y = r), (t.upperBound.y = i))
							: ((t.lowerBound.y = i), (t.upperBound.y = r));
				}),
				(i.prototype.ComputeMass = function (t, e) {
					void 0 === e && (e = 0),
						(t.mass = 0),
						t.center.SetV(this.m_v1),
						(t.I = 0);
				}),
				(i.prototype.ComputeSubmergedArea = function (t, e, i, n) {
					void 0 === e && (e = 0);
					var r = new A(t.x * e, t.y * e),
						o = E.MulX(i, this.m_v1),
						s = E.MulX(i, this.m_v2),
						i = E.Dot(t, o) - e,
						e = E.Dot(t, s) - e;
					if (0 < i) {
						if (0 < e) return 0;
						(o.x = (-e / (i - e)) * o.x + (i / (i - e)) * s.x),
							(o.y = (-e / (i - e)) * o.y + (i / (i - e)) * s.y);
					} else
						0 < e &&
							((s.x = (-e / (i - e)) * o.x + (i / (i - e)) * s.x),
							(s.y = (-e / (i - e)) * o.y + (i / (i - e)) * s.y));
					return (
						(n.x = (r.x + o.x + s.x) / 3),
						(n.y = (r.y + o.y + s.y) / 3),
						0.5 *
							((o.x - r.x) * (s.y - r.y) -
								(o.y - r.y) * (s.x - r.x))
					);
				}),
				(i.prototype.GetLength = function () {
					return this.m_length;
				}),
				(i.prototype.GetVertex1 = function () {
					return this.m_v1;
				}),
				(i.prototype.GetVertex2 = function () {
					return this.m_v2;
				}),
				(i.prototype.GetCoreVertex1 = function () {
					return this.m_coreV1;
				}),
				(i.prototype.GetCoreVertex2 = function () {
					return this.m_coreV2;
				}),
				(i.prototype.GetNormalVector = function () {
					return this.m_normal;
				}),
				(i.prototype.GetDirectionVector = function () {
					return this.m_direction;
				}),
				(i.prototype.GetCorner1Vector = function () {
					return this.m_cornerDir1;
				}),
				(i.prototype.GetCorner2Vector = function () {
					return this.m_cornerDir2;
				}),
				(i.prototype.Corner1IsConvex = function () {
					return this.m_cornerConvex1;
				}),
				(i.prototype.Corner2IsConvex = function () {
					return this.m_cornerConvex2;
				}),
				(i.prototype.GetFirstVertex = function (t) {
					var e = t.R;
					return new A(
						t.position.x +
							(e.col1.x * this.m_coreV1.x +
								e.col2.x * this.m_coreV1.y),
						t.position.y +
							(e.col1.y * this.m_coreV1.x +
								e.col2.y * this.m_coreV1.y)
					);
				}),
				(i.prototype.GetNextEdge = function () {
					return this.m_nextEdge;
				}),
				(i.prototype.GetPrevEdge = function () {
					return this.m_prevEdge;
				}),
				(i.prototype.Support = function (t, e, i) {
					void 0 === e && (e = 0), void 0 === i && (i = 0);
					var n = t.R,
						r =
							t.position.x +
							(n.col1.x * this.m_coreV1.x +
								n.col2.x * this.m_coreV1.y),
						o =
							t.position.y +
							(n.col1.y * this.m_coreV1.x +
								n.col2.y * this.m_coreV1.y),
						s =
							t.position.x +
							(n.col1.x * this.m_coreV2.x +
								n.col2.x * this.m_coreV2.y),
						n =
							t.position.y +
							(n.col1.y * this.m_coreV2.x +
								n.col2.y * this.m_coreV2.y);
					return (
						s * e + n * i < r * e + o * i
							? ((this.s_supportVec.x = r),
							  (this.s_supportVec.y = o))
							: ((this.s_supportVec.x = s),
							  (this.s_supportVec.y = n)),
						this.s_supportVec
					);
				}),
				(i.prototype.b2EdgeShape = function (t, e) {
					this.__super.b2Shape.call(this),
						(this.m_type = n.e_edgeShape),
						(this.m_prevEdge = null),
						(this.m_nextEdge = null),
						(this.m_v1 = t),
						(this.m_v2 = e),
						this.m_direction.Set(
							this.m_v2.x - this.m_v1.x,
							this.m_v2.y - this.m_v1.y
						),
						(this.m_length = this.m_direction.Normalize()),
						this.m_normal.Set(
							this.m_direction.y,
							-this.m_direction.x
						),
						this.m_coreV1.Set(
							-o.b2_toiSlop *
								(this.m_normal.x - this.m_direction.x) +
								this.m_v1.x,
							-o.b2_toiSlop *
								(this.m_normal.y - this.m_direction.y) +
								this.m_v1.y
						),
						this.m_coreV2.Set(
							-o.b2_toiSlop *
								(this.m_normal.x + this.m_direction.x) +
								this.m_v2.x,
							-o.b2_toiSlop *
								(this.m_normal.y + this.m_direction.y) +
								this.m_v2.y
						),
						(this.m_cornerDir1 = this.m_normal),
						this.m_cornerDir2.Set(
							-this.m_normal.x,
							-this.m_normal.y
						);
				}),
				(i.prototype.SetPrevEdge = function (t, e, i, n) {
					(this.m_prevEdge = t),
						(this.m_coreV1 = e),
						(this.m_cornerDir1 = i),
						(this.m_cornerConvex1 = n);
				}),
				(i.prototype.SetNextEdge = function (t, e, i, n) {
					(this.m_nextEdge = t),
						(this.m_coreV2 = e),
						(this.m_cornerDir2 = i),
						(this.m_cornerConvex2 = n);
				}),
				(v.b2MassData = function () {
					(this.mass = 0), (this.center = new A(0, 0)), (this.I = 0);
				}),
				Box2D.inherit(s, Box2D.Collision.Shapes.b2Shape),
				(s.prototype.__super =
					Box2D.Collision.Shapes.b2Shape.prototype),
				(s.b2PolygonShape = function () {
					Box2D.Collision.Shapes.b2Shape.b2Shape.apply(
						this,
						arguments
					);
				}),
				(s.prototype.Copy = function () {
					var t = new s();
					return t.Set(this), t;
				}),
				(s.prototype.Set = function (t) {
					if ((this.__super.Set.call(this, t), Box2D.is(t, s))) {
						var e = t instanceof s ? t : null;
						this.m_centroid.SetV(e.m_centroid),
							(this.m_vertexCount = e.m_vertexCount),
							this.Reserve(this.m_vertexCount);
						for (var i = 0; i < this.m_vertexCount; i++)
							this.m_vertices[i].SetV(e.m_vertices[i]),
								this.m_normals[i].SetV(e.m_normals[i]);
					}
				}),
				(s.prototype.SetAsArray = function (t, e) {
					void 0 === e && (e = 0);
					for (
						var i, n = new Vector(), r = 0, r = 0;
						r < t.length;
						++r
					)
						(i = t[r]), n.push(i);
					this.SetAsVector(n, e);
				}),
				(s.AsArray = function (t, e) {
					void 0 === e && (e = 0);
					var i = new s();
					return i.SetAsArray(t, e), i;
				}),
				(s.prototype.SetAsVector = function (t, e) {
					void 0 === e && (e = 0),
						0 == e && (e = t.length),
						o.b2Assert(2 <= e),
						(this.m_vertexCount = e),
						this.Reserve(e);
					for (var i = 0, i = 0; i < this.m_vertexCount; i++)
						this.m_vertices[i].SetV(t[i]);
					for (i = 0; i < this.m_vertexCount; ++i) {
						var n = parseInt(i),
							r = parseInt(
								i + 1 < this.m_vertexCount ? i + 1 : 0
							),
							n = E.SubtractVV(
								this.m_vertices[r],
								this.m_vertices[n]
							);
						o.b2Assert(n.LengthSquared() > Number.MIN_VALUE),
							this.m_normals[i].SetV(E.CrossVF(n, 1)),
							this.m_normals[i].Normalize();
					}
					this.m_centroid = s.ComputeCentroid(
						this.m_vertices,
						this.m_vertexCount
					);
				}),
				(s.AsVector = function (t, e) {
					void 0 === e && (e = 0);
					var i = new s();
					return i.SetAsVector(t, e), i;
				}),
				(s.prototype.SetAsBox = function (t, e) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						(this.m_vertexCount = 4),
						this.Reserve(4),
						this.m_vertices[0].Set(-t, -e),
						this.m_vertices[1].Set(t, -e),
						this.m_vertices[2].Set(t, e),
						this.m_vertices[3].Set(-t, e),
						this.m_normals[0].Set(0, -1),
						this.m_normals[1].Set(1, 0),
						this.m_normals[2].Set(0, 1),
						this.m_normals[3].Set(-1, 0),
						this.m_centroid.SetZero();
				}),
				(s.AsBox = function (t, e) {
					void 0 === t && (t = 0), void 0 === e && (e = 0);
					var i = new s();
					return i.SetAsBox(t, e), i;
				}),
				(s.prototype.SetAsOrientedBox = function (t, e, i, n) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = null),
						void 0 === n && (n = 0),
						(this.m_vertexCount = 4),
						this.Reserve(4),
						this.m_vertices[0].Set(-t, -e),
						this.m_vertices[1].Set(t, -e),
						this.m_vertices[2].Set(t, e),
						this.m_vertices[3].Set(-t, e),
						this.m_normals[0].Set(0, -1),
						this.m_normals[1].Set(1, 0),
						this.m_normals[2].Set(0, 1),
						this.m_normals[3].Set(-1, 0),
						(this.m_centroid = i);
					var r = new c();
					(r.position = i), r.R.Set(n);
					for (var o = 0; o < this.m_vertexCount; ++o)
						(this.m_vertices[o] = E.MulX(r, this.m_vertices[o])),
							(this.m_normals[o] = E.MulMV(
								r.R,
								this.m_normals[o]
							));
				}),
				(s.AsOrientedBox = function (t, e, i, n) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = null),
						void 0 === n && (n = 0);
					var r = new s();
					return r.SetAsOrientedBox(t, e, i, n), r;
				}),
				(s.prototype.SetAsEdge = function (t, e) {
					(this.m_vertexCount = 2),
						this.Reserve(2),
						this.m_vertices[0].SetV(t),
						this.m_vertices[1].SetV(e),
						(this.m_centroid.x = 0.5 * (t.x + e.x)),
						(this.m_centroid.y = 0.5 * (t.y + e.y)),
						(this.m_normals[0] = E.CrossVF(E.SubtractVV(e, t), 1)),
						this.m_normals[0].Normalize(),
						(this.m_normals[1].x = -this.m_normals[0].x),
						(this.m_normals[1].y = -this.m_normals[0].y);
				}),
				(s.AsEdge = function (t, e) {
					var i = new s();
					return i.SetAsEdge(t, e), i;
				}),
				(s.prototype.TestPoint = function (t, e) {
					for (
						var i,
							n = t.R,
							r = e.x - t.position.x,
							o = e.y - t.position.y,
							s = r * n.col1.x + o * n.col1.y,
							c = r * n.col2.x + o * n.col2.y,
							a = 0;
						a < this.m_vertexCount;
						++a
					) {
						(r = s - (i = this.m_vertices[a]).x), (o = c - i.y);
						if (0 < (i = this.m_normals[a]).x * r + i.y * o)
							return !1;
					}
					return !0;
				}),
				(s.prototype.RayCast = function (t, e, i) {
					var n,
						r = 0,
						o = e.maxFraction,
						s = e.p1.x - i.position.x,
						c = e.p1.y - i.position.y,
						a = i.R,
						l = s * a.col1.x + c * a.col1.y,
						h = s * a.col2.x + c * a.col2.y;
					(s = e.p2.x - i.position.x), (c = e.p2.y - i.position.y);
					for (
						var u = s * (a = i.R).col1.x + c * a.col1.y - l,
							_ = s * a.col2.x + c * a.col2.y - h,
							d = parseInt(-1),
							p = 0;
						p < this.m_vertexCount;
						++p
					) {
						(s = (n = this.m_vertices[p]).x - l), (c = n.y - h);
						var f = (n = this.m_normals[p]).x * s + n.y * c,
							m = n.x * u + n.y * _;
						if (0 == m) {
							if (f < 0) return !1;
						} else
							m < 0 && f < r * m
								? ((r = f / m), (d = p))
								: 0 < m && f < o * m && (o = f / m);
						if (o < r - Number.MIN_VALUE) return !1;
					}
					return (
						0 <= d &&
						((t.fraction = r),
						(a = i.R),
						(n = this.m_normals[d]),
						(t.normal.x = a.col1.x * n.x + a.col2.x * n.y),
						(t.normal.y = a.col1.y * n.x + a.col2.y * n.y),
						!0)
					);
				}),
				(s.prototype.ComputeAABB = function (t, e) {
					for (
						var i = e.R,
							n = this.m_vertices[0],
							r = (l =
								e.position.x +
								(i.col1.x * n.x + i.col2.x * n.y)),
							o = (h =
								e.position.y +
								(i.col1.y * n.x + i.col2.y * n.y)),
							s = 1;
						s < this.m_vertexCount;
						++s
					) {
						n = this.m_vertices[s];
						var c =
								e.position.x +
								(i.col1.x * n.x + i.col2.x * n.y),
							a =
								e.position.y +
								(i.col1.y * n.x + i.col2.y * n.y),
							l = l < c ? l : c,
							h = h < a ? h : a,
							r = c < r ? r : c,
							o = a < o ? o : a;
					}
					(t.lowerBound.x = l - this.m_radius),
						(t.lowerBound.y = h - this.m_radius),
						(t.upperBound.x = r + this.m_radius),
						(t.upperBound.y = o + this.m_radius);
				}),
				(s.prototype.ComputeMass = function (t, e) {
					if ((void 0 === e && (e = 0), 2 == this.m_vertexCount))
						return (
							(t.center.x =
								0.5 *
								(this.m_vertices[0].x + this.m_vertices[1].x)),
							(t.center.y =
								0.5 *
								(this.m_vertices[0].y + this.m_vertices[1].y)),
							(t.mass = 0),
							void (t.I = 0)
						);
					for (
						var i = 0, n = 0, r = 0, o = 0, s = 0;
						s < this.m_vertexCount;
						++s
					) {
						var c = this.m_vertices[s],
							a =
								s + 1 < this.m_vertexCount
									? this.m_vertices[parseInt(s + 1)]
									: this.m_vertices[0],
							l = +c.x,
							h = +c.y,
							u = +a.x,
							_ = +a.y,
							d = l * _ - h * u,
							p = 0.5 * d;
						(r += p),
							(i += (1 / 3) * p * (0 + c.x + a.x)),
							(n += (1 / 3) * p * (0 + c.y + a.y));
						o +=
							d *
							((1 / 3) *
								(0.25 * (l * l + u * l + u * u) +
									(0 * l + 0 * u)) +
								0 +
								((1 / 3) *
									(0.25 * (h * h + _ * h + _ * _) +
										(0 * h + 0 * _)) +
									0));
					}
					(t.mass = e * r),
						(i *= 1 / r),
						(n *= 1 / r),
						t.center.Set(i, n),
						(t.I = e * o);
				}),
				(s.prototype.ComputeSubmergedArea = function (t, e, i, n) {
					void 0 === e && (e = 0);
					for (
						var r = E.MulTMV(i.R, t),
							o = e - E.Dot(t, i.position),
							s = new Vector_a2j_Number(),
							c = 0,
							a = parseInt(-1),
							l = parseInt(-1),
							h = !1,
							u = 0,
							u = 0;
						u < this.m_vertexCount;
						++u
					) {
						s[u] = E.Dot(r, this.m_vertices[u]) - o;
						var _ = s[u] < -Number.MIN_VALUE;
						0 < u &&
							(_
								? h || ((a = u - 1), c++)
								: h && ((l = u - 1), c++)),
							(h = _);
					}
					switch (c) {
						case 0:
							if (h) {
								var d = new v();
								return (
									this.ComputeMass(d, 1),
									n.SetV(E.MulX(i, d.center)),
									d.mass
								);
							}
							return 0;
						case 1:
							-1 == a
								? (a = this.m_vertexCount - 1)
								: (l = this.m_vertexCount - 1);
					}
					var p,
						f = parseInt((a + 1) % this.m_vertexCount),
						m = parseInt((l + 1) % this.m_vertexCount),
						e = (0 - s[a]) / (s[f] - s[a]),
						t = (0 - s[l]) / (s[m] - s[l]),
						g = new A(
							this.m_vertices[a].x * (1 - e) +
								this.m_vertices[f].x * e,
							this.m_vertices[a].y * (1 - e) +
								this.m_vertices[f].y * e
						),
						y = new A(
							this.m_vertices[l].x * (1 - t) +
								this.m_vertices[m].x * t,
							this.m_vertices[l].y * (1 - t) +
								this.m_vertices[m].y * t
						),
						T = 0,
						S = new A(),
						C = this.m_vertices[f];
					for (u = f; u != m; ) {
						p =
							(u = (u + 1) % this.m_vertexCount) == m
								? y
								: this.m_vertices[u];
						var x =
							0.5 *
							((C.x - g.x) * (p.y - g.y) -
								(C.y - g.y) * (p.x - g.x));
						(T += x),
							(S.x += (x * (g.x + C.x + p.x)) / 3),
							(S.y += (x * (g.y + C.y + p.y)) / 3),
							(C = p);
					}
					return S.Multiply(1 / T), n.SetV(E.MulX(i, S)), T;
				}),
				(s.prototype.GetVertexCount = function () {
					return this.m_vertexCount;
				}),
				(s.prototype.GetVertices = function () {
					return this.m_vertices;
				}),
				(s.prototype.GetNormals = function () {
					return this.m_normals;
				}),
				(s.prototype.GetSupport = function (t) {
					for (
						var e = 0,
							i =
								this.m_vertices[0].x * t.x +
								this.m_vertices[0].y * t.y,
							n = 1;
						n < this.m_vertexCount;
						++n
					) {
						var r =
							this.m_vertices[n].x * t.x +
							this.m_vertices[n].y * t.y;
						i < r && ((e = n), (i = r));
					}
					return e;
				}),
				(s.prototype.GetSupportVertex = function (t) {
					for (
						var e = 0,
							i =
								this.m_vertices[0].x * t.x +
								this.m_vertices[0].y * t.y,
							n = 1;
						n < this.m_vertexCount;
						++n
					) {
						var r =
							this.m_vertices[n].x * t.x +
							this.m_vertices[n].y * t.y;
						i < r && ((e = n), (i = r));
					}
					return this.m_vertices[e];
				}),
				(s.prototype.Validate = function () {
					return !1;
				}),
				(s.prototype.b2PolygonShape = function () {
					this.__super.b2Shape.call(this),
						(this.m_type = n.e_polygonShape),
						(this.m_centroid = new A()),
						(this.m_vertices = new Vector()),
						(this.m_normals = new Vector());
				}),
				(s.prototype.Reserve = function (t) {
					void 0 === t && (t = 0);
					for (var e = parseInt(this.m_vertices.length); e < t; e++)
						(this.m_vertices[e] = new A()),
							(this.m_normals[e] = new A());
				}),
				(s.ComputeCentroid = function (t, e) {
					void 0 === e && (e = 0);
					for (var i = new A(), n = 0, r = 0; r < e; ++r) {
						var o = t[r],
							s = r + 1 < e ? t[parseInt(r + 1)] : t[0],
							c = +o.x,
							a = +o.y,
							l = +s.x,
							l = 0.5 * (c * +s.y - a * l);
						(n += l),
							(i.x += (1 / 3) * l * (0 + o.x + s.x)),
							(i.y += (1 / 3) * l * (0 + o.y + s.y));
					}
					return (i.x *= 1 / n), (i.y *= 1 / n), i;
				}),
				(s.ComputeOBB = function (t, e, i) {
					void 0 === i && (i = 0);
					for (var n = 0, r = new Vector(i + 1), n = 0; n < i; ++n)
						r[n] = e[n];
					r[i] = r[0];
					var o = Number.MAX_VALUE;
					for (n = 1; n <= i; ++n) {
						for (
							var s = r[parseInt(n - 1)],
								c = r[n].x - s.x,
								a = r[n].y - s.y,
								l = Math.sqrt(c * c + a * a),
								h = -(a /= l),
								u = (c /= l),
								_ = Number.MAX_VALUE,
								d = Number.MAX_VALUE,
								p = -Number.MAX_VALUE,
								f = -Number.MAX_VALUE,
								m = 0;
							m < i;
							++m
						) {
							var g = r[m].x - s.x,
								y = r[m].y - s.y,
								T = c * g + a * y,
								y = h * g + u * y;
							T < _ && (_ = T),
								y < d && (d = y),
								p < T && (p = T),
								f < y && (f = y);
						}
						var S,
							C = (p - _) * (f - d);
						C < 0.95 * o &&
							((o = C),
							(t.R.col1.x = c),
							(t.R.col1.y = a),
							(t.R.col2.x = h),
							(t.R.col2.y = u),
							(S = 0.5 * (_ + p)),
							(l = 0.5 * (d + f)),
							(C = t.R),
							(t.center.x = s.x + (C.col1.x * S + C.col2.x * l)),
							(t.center.y = s.y + (C.col1.y * S + C.col2.y * l)),
							(t.extents.x = 0.5 * (p - _)),
							(t.extents.y = 0.5 * (f - d)));
					}
				}),
				Box2D.postDefs.push(function () {
					Box2D.Collision.Shapes.b2PolygonShape.s_mat = new r();
				}),
				(n.b2Shape = function () {}),
				(n.prototype.Copy = function () {
					return null;
				}),
				(n.prototype.Set = function (t) {
					this.m_radius = t.m_radius;
				}),
				(n.prototype.GetType = function () {
					return this.m_type;
				}),
				(n.prototype.TestPoint = function (t, e) {
					return !1;
				}),
				(n.prototype.RayCast = function (t, e, i) {
					return !1;
				}),
				(n.prototype.ComputeAABB = function (t, e) {}),
				(n.prototype.ComputeMass = function (t, e) {
					void 0 === e && (e = 0);
				}),
				(n.prototype.ComputeSubmergedArea = function (t, e, i, n) {
					return void 0 === e && (e = 0), 0;
				}),
				(n.TestOverlap = function (t, e, i, n) {
					var r = new l();
					(r.proxyA = new u()),
						r.proxyA.Set(t),
						(r.proxyB = new u()),
						r.proxyB.Set(i),
						(r.transformA = e),
						(r.transformB = n),
						(r.useRadii = !0);
					e = new _();
					e.count = 0;
					n = new h();
					return (
						a.Distance(n, e, r), n.distance < 10 * Number.MIN_VALUE
					);
				}),
				(n.prototype.b2Shape = function () {
					(this.m_type = n.e_unknownShape),
						(this.m_radius = o.b2_linearSlop);
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Collision.Shapes.b2Shape.e_unknownShape =
						parseInt(-1)),
						(Box2D.Collision.Shapes.b2Shape.e_circleShape = 0),
						(Box2D.Collision.Shapes.b2Shape.e_polygonShape = 1),
						(Box2D.Collision.Shapes.b2Shape.e_edgeShape = 2),
						(Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount = 3),
						(Box2D.Collision.Shapes.b2Shape.e_hitCollide = 1),
						(Box2D.Collision.Shapes.b2Shape.e_missCollide = 0),
						(Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide =
							parseInt(-1));
				});
		})(),
		(function () {
			var t = Box2D.Common.b2Color,
				e = (Box2D.Common.b2internal, Box2D.Common.b2Settings),
				n =
					(Box2D.Common.Math.b2Mat22,
					Box2D.Common.Math.b2Mat33,
					Box2D.Common.Math.b2Math);
			Box2D.Common.Math.b2Sweep,
				Box2D.Common.Math.b2Transform,
				Box2D.Common.Math.b2Vec2,
				Box2D.Common.Math.b2Vec3,
				(t.b2Color = function () {
					(this._r = 0), (this._g = 0), (this._b = 0);
				}),
				(t.prototype.b2Color = function (t, e, i) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = 0),
						(this._r = Box2D.parseUInt(255 * n.Clamp(t, 0, 1))),
						(this._g = Box2D.parseUInt(255 * n.Clamp(e, 0, 1))),
						(this._b = Box2D.parseUInt(255 * n.Clamp(i, 0, 1)));
				}),
				(t.prototype.Set = function (t, e, i) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = 0),
						(this._r = Box2D.parseUInt(255 * n.Clamp(t, 0, 1))),
						(this._g = Box2D.parseUInt(255 * n.Clamp(e, 0, 1))),
						(this._b = Box2D.parseUInt(255 * n.Clamp(i, 0, 1)));
				}),
				Object.defineProperty(t.prototype, 'r', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._r = Box2D.parseUInt(255 * n.Clamp(t, 0, 1)));
					},
				}),
				Object.defineProperty(t.prototype, 'g', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._g = Box2D.parseUInt(255 * n.Clamp(t, 0, 1)));
					},
				}),
				Object.defineProperty(t.prototype, 'b', {
					enumerable: !1,
					configurable: !0,
					set: function (t) {
						void 0 === t && (t = 0),
							(this._b = Box2D.parseUInt(255 * n.Clamp(t, 0, 1)));
					},
				}),
				Object.defineProperty(t.prototype, 'color', {
					enumerable: !1,
					configurable: !0,
					get: function () {
						return (this._r << 16) | (this._g << 8) | this._b;
					},
				}),
				(e.b2Settings = function () {}),
				(e.b2MixFriction = function (t, e) {
					return (
						void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						Math.sqrt(t * e)
					);
				}),
				(e.b2MixRestitution = function (t, e) {
					return (
						void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						e < t ? t : e
					);
				}),
				(e.b2Assert = function (t) {
					if (!t) throw 'Assertion Failed';
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Common.b2Settings.VERSION = '2.1alpha'),
						(Box2D.Common.b2Settings.USHRT_MAX = 65535),
						(Box2D.Common.b2Settings.b2_pi = Math.PI),
						(Box2D.Common.b2Settings.b2_maxManifoldPoints = 2),
						(Box2D.Common.b2Settings.b2_aabbExtension = 0.1),
						(Box2D.Common.b2Settings.b2_aabbMultiplier = 2),
						(Box2D.Common.b2Settings.b2_polygonRadius =
							2 * e.b2_linearSlop),
						(Box2D.Common.b2Settings.b2_linearSlop = 0.005),
						(Box2D.Common.b2Settings.b2_angularSlop =
							(2 / 180) * e.b2_pi),
						(Box2D.Common.b2Settings.b2_toiSlop =
							8 * e.b2_linearSlop),
						(Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland = 32),
						(Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland = 32),
						(Box2D.Common.b2Settings.b2_velocityThreshold = 1),
						(Box2D.Common.b2Settings.b2_maxLinearCorrection = 0.2),
						(Box2D.Common.b2Settings.b2_maxAngularCorrection =
							(8 / 180) * e.b2_pi),
						(Box2D.Common.b2Settings.b2_maxTranslation = 2),
						(Box2D.Common.b2Settings.b2_maxTranslationSquared =
							e.b2_maxTranslation * e.b2_maxTranslation),
						(Box2D.Common.b2Settings.b2_maxRotation =
							0.5 * e.b2_pi),
						(Box2D.Common.b2Settings.b2_maxRotationSquared =
							e.b2_maxRotation * e.b2_maxRotation),
						(Box2D.Common.b2Settings.b2_contactBaumgarte = 0.2),
						(Box2D.Common.b2Settings.b2_timeToSleep = 0.5),
						(Box2D.Common.b2Settings.b2_linearSleepTolerance = 0.01),
						(Box2D.Common.b2Settings.b2_angularSleepTolerance =
							(2 / 180) * e.b2_pi);
				});
		})(),
		(function () {
			Box2D.Collision.b2AABB,
				Box2D.Common.b2Color,
				Box2D.Common.b2internal,
				Box2D.Common.b2Settings;
			var n = Box2D.Common.Math.b2Mat22,
				t = Box2D.Common.Math.b2Mat33,
				r = Box2D.Common.Math.b2Math,
				e = Box2D.Common.Math.b2Sweep,
				i = Box2D.Common.Math.b2Transform,
				o = Box2D.Common.Math.b2Vec2,
				s = Box2D.Common.Math.b2Vec3;
			(n.b2Mat22 = function () {
				(this.col1 = new o()), (this.col2 = new o());
			}),
				(n.prototype.b2Mat22 = function () {
					this.SetIdentity();
				}),
				(n.FromAngle = function (t) {
					void 0 === t && (t = 0);
					var e = new n();
					return e.Set(t), e;
				}),
				(n.FromVV = function (t, e) {
					var i = new n();
					return i.SetVV(t, e), i;
				}),
				(n.prototype.Set = function (t) {
					void 0 === t && (t = 0);
					var e = Math.cos(t),
						t = Math.sin(t);
					(this.col1.x = e),
						(this.col2.x = -t),
						(this.col1.y = t),
						(this.col2.y = e);
				}),
				(n.prototype.SetVV = function (t, e) {
					this.col1.SetV(t), this.col2.SetV(e);
				}),
				(n.prototype.Copy = function () {
					var t = new n();
					return t.SetM(this), t;
				}),
				(n.prototype.SetM = function (t) {
					this.col1.SetV(t.col1), this.col2.SetV(t.col2);
				}),
				(n.prototype.AddM = function (t) {
					(this.col1.x += t.col1.x),
						(this.col1.y += t.col1.y),
						(this.col2.x += t.col2.x),
						(this.col2.y += t.col2.y);
				}),
				(n.prototype.SetIdentity = function () {
					(this.col1.x = 1),
						(this.col2.x = 0),
						(this.col1.y = 0),
						(this.col2.y = 1);
				}),
				(n.prototype.SetZero = function () {
					(this.col1.x = 0),
						(this.col2.x = 0),
						(this.col1.y = 0),
						(this.col2.y = 0);
				}),
				(n.prototype.GetAngle = function () {
					return Math.atan2(this.col1.y, this.col1.x);
				}),
				(n.prototype.GetInverse = function (t) {
					var e = this.col1.x,
						i = this.col2.x,
						n = this.col1.y,
						r = this.col2.y,
						o = e * r - i * n;
					return (
						0 != o && (o = 1 / o),
						(t.col1.x = o * r),
						(t.col2.x = -o * i),
						(t.col1.y = -o * n),
						(t.col2.y = o * e),
						t
					);
				}),
				(n.prototype.Solve = function (t, e, i) {
					void 0 === e && (e = 0), void 0 === i && (i = 0);
					var n = this.col1.x,
						r = this.col2.x,
						o = this.col1.y,
						s = this.col2.y,
						c = n * s - r * o;
					return (
						0 != c && (c = 1 / c),
						(t.x = c * (s * e - r * i)),
						(t.y = c * (n * i - o * e)),
						t
					);
				}),
				(n.prototype.Abs = function () {
					this.col1.Abs(), this.col2.Abs();
				}),
				(t.b2Mat33 = function () {
					(this.col1 = new s()),
						(this.col2 = new s()),
						(this.col3 = new s());
				}),
				(t.prototype.b2Mat33 = function (t, e, i) {
					void 0 === t && (t = null),
						void 0 === e && (e = null),
						void 0 === i && (i = null),
						t || e || i
							? (this.col1.SetV(t),
							  this.col2.SetV(e),
							  this.col3.SetV(i))
							: (this.col1.SetZero(),
							  this.col2.SetZero(),
							  this.col3.SetZero());
				}),
				(t.prototype.SetVVV = function (t, e, i) {
					this.col1.SetV(t), this.col2.SetV(e), this.col3.SetV(i);
				}),
				(t.prototype.Copy = function () {
					return new t(this.col1, this.col2, this.col3);
				}),
				(t.prototype.SetM = function (t) {
					this.col1.SetV(t.col1),
						this.col2.SetV(t.col2),
						this.col3.SetV(t.col3);
				}),
				(t.prototype.AddM = function (t) {
					(this.col1.x += t.col1.x),
						(this.col1.y += t.col1.y),
						(this.col1.z += t.col1.z),
						(this.col2.x += t.col2.x),
						(this.col2.y += t.col2.y),
						(this.col2.z += t.col2.z),
						(this.col3.x += t.col3.x),
						(this.col3.y += t.col3.y),
						(this.col3.z += t.col3.z);
				}),
				(t.prototype.SetIdentity = function () {
					(this.col1.x = 1),
						(this.col2.x = 0),
						(this.col3.x = 0),
						(this.col1.y = 0),
						(this.col2.y = 1),
						(this.col3.y = 0),
						(this.col1.z = 0),
						(this.col2.z = 0),
						(this.col3.z = 1);
				}),
				(t.prototype.SetZero = function () {
					(this.col1.x = 0),
						(this.col2.x = 0),
						(this.col3.x = 0),
						(this.col1.y = 0),
						(this.col2.y = 0),
						(this.col3.y = 0),
						(this.col1.z = 0),
						(this.col2.z = 0),
						(this.col3.z = 0);
				}),
				(t.prototype.Solve22 = function (t, e, i) {
					void 0 === e && (e = 0), void 0 === i && (i = 0);
					var n = this.col1.x,
						r = this.col2.x,
						o = this.col1.y,
						s = this.col2.y,
						c = n * s - r * o;
					return (
						0 != c && (c = 1 / c),
						(t.x = c * (s * e - r * i)),
						(t.y = c * (n * i - o * e)),
						t
					);
				}),
				(t.prototype.Solve33 = function (t, e, i, n) {
					void 0 === e && (e = 0),
						void 0 === i && (i = 0),
						void 0 === n && (n = 0);
					var r = this.col1.x,
						o = this.col1.y,
						s = this.col1.z,
						c = this.col2.x,
						a = this.col2.y,
						l = this.col2.z,
						h = this.col3.x,
						u = this.col3.y,
						_ = this.col3.z,
						d =
							r * (a * _ - l * u) +
							o * (l * h - c * _) +
							s * (c * u - a * h);
					return (
						0 != d && (d = 1 / d),
						(t.x =
							d *
							(e * (a * _ - l * u) +
								i * (l * h - c * _) +
								n * (c * u - a * h))),
						(t.y =
							d *
							(r * (i * _ - n * u) +
								o * (n * h - e * _) +
								s * (e * u - i * h))),
						(t.z =
							d *
							(r * (a * n - l * i) +
								o * (l * e - c * n) +
								s * (c * i - a * e))),
						t
					);
				}),
				(r.b2Math = function () {}),
				(r.IsValid = function (t) {
					return void 0 === t && (t = 0), isFinite(t);
				}),
				(r.Dot = function (t, e) {
					return t.x * e.x + t.y * e.y;
				}),
				(r.CrossVV = function (t, e) {
					return t.x * e.y - t.y * e.x;
				}),
				(r.CrossVF = function (t, e) {
					return void 0 === e && (e = 0), new o(e * t.y, -e * t.x);
				}),
				(r.CrossFV = function (t, e) {
					return void 0 === t && (t = 0), new o(-t * e.y, t * e.x);
				}),
				(r.MulMV = function (t, e) {
					return new o(
						t.col1.x * e.x + t.col2.x * e.y,
						t.col1.y * e.x + t.col2.y * e.y
					);
				}),
				(r.MulTMV = function (t, e) {
					return new o(r.Dot(e, t.col1), r.Dot(e, t.col2));
				}),
				(r.MulX = function (t, e) {
					e = r.MulMV(t.R, e);
					return (e.x += t.position.x), (e.y += t.position.y), e;
				}),
				(r.MulXT = function (t, e) {
					var i = r.SubtractVV(e, t.position),
						e = i.x * t.R.col1.x + i.y * t.R.col1.y;
					return (
						(i.y = i.x * t.R.col2.x + i.y * t.R.col2.y),
						(i.x = e),
						i
					);
				}),
				(r.AddVV = function (t, e) {
					return new o(t.x + e.x, t.y + e.y);
				}),
				(r.SubtractVV = function (t, e) {
					return new o(t.x - e.x, t.y - e.y);
				}),
				(r.Distance = function (t, e) {
					var i = t.x - e.x,
						e = t.y - e.y;
					return Math.sqrt(i * i + e * e);
				}),
				(r.DistanceSquared = function (t, e) {
					var i = t.x - e.x,
						e = t.y - e.y;
					return i * i + e * e;
				}),
				(r.MulFV = function (t, e) {
					return void 0 === t && (t = 0), new o(t * e.x, t * e.y);
				}),
				(r.AddMM = function (t, e) {
					return n.FromVV(
						r.AddVV(t.col1, e.col1),
						r.AddVV(t.col2, e.col2)
					);
				}),
				(r.MulMM = function (t, e) {
					return n.FromVV(r.MulMV(t, e.col1), r.MulMV(t, e.col2));
				}),
				(r.MulTMM = function (t, e) {
					var i = new o(r.Dot(t.col1, e.col1), r.Dot(t.col2, e.col1)),
						e = new o(r.Dot(t.col1, e.col2), r.Dot(t.col2, e.col2));
					return n.FromVV(i, e);
				}),
				(r.Abs = function (t) {
					return void 0 === t && (t = 0), 0 < t ? t : -t;
				}),
				(r.AbsV = function (t) {
					return new o(r.Abs(t.x), r.Abs(t.y));
				}),
				(r.AbsM = function (t) {
					return n.FromVV(r.AbsV(t.col1), r.AbsV(t.col2));
				}),
				(r.Min = function (t, e) {
					return (
						void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						t < e ? t : e
					);
				}),
				(r.MinV = function (t, e) {
					return new o(r.Min(t.x, e.x), r.Min(t.y, e.y));
				}),
				(r.Max = function (t, e) {
					return (
						void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						e < t ? t : e
					);
				}),
				(r.MaxV = function (t, e) {
					return new o(r.Max(t.x, e.x), r.Max(t.y, e.y));
				}),
				(r.Clamp = function (t, e, i) {
					return (
						void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = 0),
						t < e ? e : i < t ? i : t
					);
				}),
				(r.ClampV = function (t, e, i) {
					return r.MaxV(e, r.MinV(t, i));
				}),
				(r.Swap = function (t, e) {
					var i = t[0];
					(t[0] = e[0]), (e[0] = i);
				}),
				(r.Random = function () {
					return 2 * Math.random() - 1;
				}),
				(r.RandomRange = function (t, e) {
					return (
						void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						(e - t) * Math.random() + t
					);
				}),
				(r.NextPowerOfTwo = function (t) {
					return (
						void 0 === t && (t = 0),
						(t |= (t >> 1) & 2147483647),
						(t |= (t >> 2) & 1073741823),
						(t |= (t >> 4) & 268435455),
						(t |= (t >> 8) & 16777215),
						(t |= (t >> 16) & 65535) + 1
					);
				}),
				(r.IsPowerOfTwo = function (t) {
					return void 0 === t && (t = 0), 0 < t && 0 == (t & (t - 1));
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Common.Math.b2Math.b2Vec2_zero = new o(0, 0)),
						(Box2D.Common.Math.b2Math.b2Mat22_identity = n.FromVV(
							new o(1, 0),
							new o(0, 1)
						)),
						(Box2D.Common.Math.b2Math.b2Transform_identity = new i(
							r.b2Vec2_zero,
							r.b2Mat22_identity
						));
				}),
				(e.b2Sweep = function () {
					(this.localCenter = new o()),
						(this.c0 = new o()),
						(this.c = new o());
				}),
				(e.prototype.Set = function (t) {
					this.localCenter.SetV(t.localCenter),
						this.c0.SetV(t.c0),
						this.c.SetV(t.c),
						(this.a0 = t.a0),
						(this.a = t.a),
						(this.t0 = t.t0);
				}),
				(e.prototype.Copy = function () {
					var t = new e();
					return (
						t.localCenter.SetV(this.localCenter),
						t.c0.SetV(this.c0),
						t.c.SetV(this.c),
						(t.a0 = this.a0),
						(t.a = this.a),
						(t.t0 = this.t0),
						t
					);
				}),
				(e.prototype.GetTransform = function (t, e) {
					void 0 === e && (e = 0),
						(t.position.x = (1 - e) * this.c0.x + e * this.c.x),
						(t.position.y = (1 - e) * this.c0.y + e * this.c.y);
					e = (1 - e) * this.a0 + e * this.a;
					t.R.Set(e);
					e = t.R;
					(t.position.x -=
						e.col1.x * this.localCenter.x +
						e.col2.x * this.localCenter.y),
						(t.position.y -=
							e.col1.y * this.localCenter.x +
							e.col2.y * this.localCenter.y);
				}),
				(e.prototype.Advance = function (t) {
					var e;
					void 0 === t && (t = 0),
						this.t0 < t &&
							1 - this.t0 > Number.MIN_VALUE &&
							((e = (t - this.t0) / (1 - this.t0)),
							(this.c0.x = (1 - e) * this.c0.x + e * this.c.x),
							(this.c0.y = (1 - e) * this.c0.y + e * this.c.y),
							(this.a0 = (1 - e) * this.a0 + e * this.a),
							(this.t0 = t));
				}),
				(i.b2Transform = function () {
					(this.position = new o()), (this.R = new n());
				}),
				(i.prototype.b2Transform = function (t, e) {
					void 0 === t && (t = null),
						void 0 === e && (e = null),
						t && (this.position.SetV(t), this.R.SetM(e));
				}),
				(i.prototype.Initialize = function (t, e) {
					this.position.SetV(t), this.R.SetM(e);
				}),
				(i.prototype.SetIdentity = function () {
					this.position.SetZero(), this.R.SetIdentity();
				}),
				(i.prototype.Set = function (t) {
					this.position.SetV(t.position), this.R.SetM(t.R);
				}),
				(i.prototype.GetAngle = function () {
					return Math.atan2(this.R.col1.y, this.R.col1.x);
				}),
				(o.b2Vec2 = function () {}),
				(o.prototype.b2Vec2 = function (t, e) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						(this.x = t),
						(this.y = e);
				}),
				(o.prototype.SetZero = function () {
					(this.x = 0), (this.y = 0);
				}),
				(o.prototype.Set = function (t, e) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						(this.x = t),
						(this.y = e);
				}),
				(o.prototype.SetV = function (t) {
					(this.x = t.x), (this.y = t.y);
				}),
				(o.prototype.GetNegative = function () {
					return new o(-this.x, -this.y);
				}),
				(o.prototype.NegativeSelf = function () {
					(this.x = -this.x), (this.y = -this.y);
				}),
				(o.Make = function (t, e) {
					return (
						void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						new o(t, e)
					);
				}),
				(o.prototype.Copy = function () {
					return new o(this.x, this.y);
				}),
				(o.prototype.Add = function (t) {
					(this.x += t.x), (this.y += t.y);
				}),
				(o.prototype.Subtract = function (t) {
					(this.x -= t.x), (this.y -= t.y);
				}),
				(o.prototype.Multiply = function (t) {
					void 0 === t && (t = 0), (this.x *= t), (this.y *= t);
				}),
				(o.prototype.MulM = function (t) {
					var e = this.x;
					(this.x = t.col1.x * e + t.col2.x * this.y),
						(this.y = t.col1.y * e + t.col2.y * this.y);
				}),
				(o.prototype.MulTM = function (t) {
					var e = r.Dot(this, t.col1);
					(this.y = r.Dot(this, t.col2)), (this.x = e);
				}),
				(o.prototype.CrossVF = function (t) {
					void 0 === t && (t = 0);
					var e = this.x;
					(this.x = t * this.y), (this.y = -t * e);
				}),
				(o.prototype.CrossFV = function (t) {
					void 0 === t && (t = 0);
					var e = this.x;
					(this.x = -t * this.y), (this.y = t * e);
				}),
				(o.prototype.MinV = function (t) {
					(this.x = (this.x < t.x ? this : t).x),
						(this.y = (this.y < t.y ? this : t).y);
				}),
				(o.prototype.MaxV = function (t) {
					(this.x = (this.x > t.x ? this : t).x),
						(this.y = (this.y > t.y ? this : t).y);
				}),
				(o.prototype.Abs = function () {
					this.x < 0 && (this.x = -this.x),
						this.y < 0 && (this.y = -this.y);
				}),
				(o.prototype.Length = function () {
					return Math.sqrt(this.x * this.x + this.y * this.y);
				}),
				(o.prototype.LengthSquared = function () {
					return this.x * this.x + this.y * this.y;
				}),
				(o.prototype.Normalize = function () {
					var t = Math.sqrt(this.x * this.x + this.y * this.y);
					if (t < Number.MIN_VALUE) return 0;
					var e = 1 / t;
					return (this.x *= e), (this.y *= e), t;
				}),
				(o.prototype.IsValid = function () {
					return r.IsValid(this.x) && r.IsValid(this.y);
				}),
				(s.b2Vec3 = function () {}),
				(s.prototype.b2Vec3 = function (t, e, i) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = 0),
						(this.x = t),
						(this.y = e),
						(this.z = i);
				}),
				(s.prototype.SetZero = function () {
					this.x = this.y = this.z = 0;
				}),
				(s.prototype.Set = function (t, e, i) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = 0),
						(this.x = t),
						(this.y = e),
						(this.z = i);
				}),
				(s.prototype.SetV = function (t) {
					(this.x = t.x), (this.y = t.y), (this.z = t.z);
				}),
				(s.prototype.GetNegative = function () {
					return new s(-this.x, -this.y, -this.z);
				}),
				(s.prototype.NegativeSelf = function () {
					(this.x = -this.x), (this.y = -this.y), (this.z = -this.z);
				}),
				(s.prototype.Copy = function () {
					return new s(this.x, this.y, this.z);
				}),
				(s.prototype.Add = function (t) {
					(this.x += t.x), (this.y += t.y), (this.z += t.z);
				}),
				(s.prototype.Subtract = function (t) {
					(this.x -= t.x), (this.y -= t.y), (this.z -= t.z);
				}),
				(s.prototype.Multiply = function (t) {
					void 0 === t && (t = 0),
						(this.x *= t),
						(this.y *= t),
						(this.z *= t);
				});
		})(),
		(function () {
			Box2D.Dynamics.Controllers.b2ControllerEdge,
				Box2D.Common.Math.b2Mat22,
				Box2D.Common.Math.b2Mat33;
			var p = Box2D.Common.Math.b2Math,
				t = Box2D.Common.Math.b2Sweep,
				o = Box2D.Common.Math.b2Transform,
				f = Box2D.Common.Math.b2Vec2,
				m = (Box2D.Common.Math.b2Vec3, Box2D.Common.b2Color),
				C = (Box2D.Common.b2internal, Box2D.Common.b2Settings),
				g = Box2D.Collision.b2AABB,
				e =
					(Box2D.Collision.b2Bound,
					Box2D.Collision.b2BoundValues,
					Box2D.Collision.b2Collision,
					Box2D.Collision.b2ContactID,
					Box2D.Collision.b2ContactPoint),
				i =
					(Box2D.Collision.b2Distance,
					Box2D.Collision.b2DistanceInput,
					Box2D.Collision.b2DistanceOutput,
					Box2D.Collision.b2DistanceProxy,
					Box2D.Collision.b2DynamicTree,
					Box2D.Collision.b2DynamicTreeBroadPhase),
				n =
					(Box2D.Collision.b2DynamicTreeNode,
					Box2D.Collision.b2DynamicTreePair,
					Box2D.Collision.b2Manifold,
					Box2D.Collision.b2ManifoldPoint,
					Box2D.Collision.b2Point,
					Box2D.Collision.b2RayCastInput),
				l = Box2D.Collision.b2RayCastOutput,
				u =
					(Box2D.Collision.b2Segment,
					Box2D.Collision.b2SeparationFunction,
					Box2D.Collision.b2Simplex,
					Box2D.Collision.b2SimplexCache,
					Box2D.Collision.b2SimplexVertex,
					Box2D.Collision.b2TimeOfImpact,
					Box2D.Collision.b2TOIInput,
					Box2D.Collision.b2WorldManifold,
					Box2D.Collision.ClipVertex,
					Box2D.Collision.Features,
					Box2D.Collision.IBroadPhase,
					Box2D.Collision.Shapes.b2CircleShape),
				_ =
					(Box2D.Collision.Shapes.b2EdgeChainDef,
					Box2D.Collision.Shapes.b2EdgeShape),
				r = Box2D.Collision.Shapes.b2MassData,
				d = Box2D.Collision.Shapes.b2PolygonShape,
				y = Box2D.Collision.Shapes.b2Shape,
				x = Box2D.Dynamics.b2Body,
				s = Box2D.Dynamics.b2BodyDef,
				c = Box2D.Dynamics.b2ContactFilter,
				a = Box2D.Dynamics.b2ContactImpulse,
				h = Box2D.Dynamics.b2ContactListener,
				T = Box2D.Dynamics.b2ContactManager,
				S = Box2D.Dynamics.b2DebugDraw,
				v = Box2D.Dynamics.b2DestructionListener,
				E = Box2D.Dynamics.b2FilterData,
				A = Box2D.Dynamics.b2Fixture,
				b = Box2D.Dynamics.b2FixtureDef,
				R = Box2D.Dynamics.b2Island,
				P = Box2D.Dynamics.b2TimeStep,
				I = Box2D.Dynamics.b2World,
				w =
					(Box2D.Dynamics.Contacts.b2CircleContact,
					Box2D.Dynamics.Contacts.b2Contact),
				D =
					(Box2D.Dynamics.Contacts.b2ContactConstraint,
					Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
					Box2D.Dynamics.Contacts.b2ContactEdge,
					Box2D.Dynamics.Contacts.b2ContactFactory),
				L =
					(Box2D.Dynamics.Contacts.b2ContactRegister,
					Box2D.Dynamics.Contacts.b2ContactResult,
					Box2D.Dynamics.Contacts.b2ContactSolver),
				O =
					(Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
					Box2D.Dynamics.Contacts.b2NullContact,
					Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
					Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
					Box2D.Dynamics.Contacts.b2PolygonContact,
					Box2D.Dynamics.Contacts.b2PositionSolverManifold,
					Box2D.Dynamics.Controllers.b2Controller,
					Box2D.Dynamics.Joints.b2DistanceJoint,
					Box2D.Dynamics.Joints.b2DistanceJointDef,
					Box2D.Dynamics.Joints.b2FrictionJoint,
					Box2D.Dynamics.Joints.b2FrictionJointDef,
					Box2D.Dynamics.Joints.b2GearJoint,
					Box2D.Dynamics.Joints.b2GearJointDef,
					Box2D.Dynamics.Joints.b2Jacobian,
					Box2D.Dynamics.Joints.b2Joint),
				B =
					(Box2D.Dynamics.Joints.b2JointDef,
					Box2D.Dynamics.Joints.b2JointEdge,
					Box2D.Dynamics.Joints.b2LineJoint,
					Box2D.Dynamics.Joints.b2LineJointDef,
					Box2D.Dynamics.Joints.b2MouseJoint,
					Box2D.Dynamics.Joints.b2MouseJointDef,
					Box2D.Dynamics.Joints.b2PrismaticJoint,
					Box2D.Dynamics.Joints.b2PrismaticJointDef,
					Box2D.Dynamics.Joints.b2PulleyJoint);
			Box2D.Dynamics.Joints.b2PulleyJointDef,
				Box2D.Dynamics.Joints.b2RevoluteJoint,
				Box2D.Dynamics.Joints.b2RevoluteJointDef,
				Box2D.Dynamics.Joints.b2WeldJoint,
				Box2D.Dynamics.Joints.b2WeldJointDef,
				(x.b2Body = function () {
					(this.m_xf = new o()),
						(this.m_sweep = new t()),
						(this.m_linearVelocity = new f()),
						(this.m_force = new f());
				}),
				(x.prototype.connectEdges = function (t, e, i) {
					void 0 === i && (i = 0);
					var n = Math.atan2(
							e.GetDirectionVector().y,
							e.GetDirectionVector().x
						),
						r = Math.tan(0.5 * (n - i)),
						o = p.MulFV(r, e.GetDirectionVector()),
						o = p.SubtractVV(o, e.GetNormalVector());
					(o = p.MulFV(C.b2_toiSlop, o)),
						(o = p.AddVV(o, e.GetVertex1()));
					i = p.AddVV(t.GetDirectionVector(), e.GetDirectionVector());
					i.Normalize();
					r = 0 < p.Dot(t.GetDirectionVector(), e.GetNormalVector());
					return (
						t.SetNextEdge(e, o, i, r), e.SetPrevEdge(t, o, i, r), n
					);
				}),
				(x.prototype.CreateFixture = function (t) {
					if (1 == this.m_world.IsLocked()) return null;
					var e = new A();
					return (
						e.Create(this, this.m_xf, t),
						this.m_flags & x.e_activeFlag &&
							((t = this.m_world.m_contactManager.m_broadPhase),
							e.CreateProxy(t, this.m_xf)),
						(e.m_next = this.m_fixtureList),
						(this.m_fixtureList = e),
						++this.m_fixtureCount,
						(e.m_body = this),
						0 < e.m_density && this.ResetMassData(),
						(this.m_world.m_flags |= I.e_newFixture),
						e
					);
				}),
				(x.prototype.CreateFixture2 = function (t, e) {
					void 0 === e && (e = 0);
					var i = new b();
					return (
						(i.shape = t), (i.density = e), this.CreateFixture(i)
					);
				}),
				(x.prototype.DestroyFixture = function (t) {
					if (1 != this.m_world.IsLocked()) {
						for (
							var e = this.m_fixtureList, i = null;
							null != e;

						) {
							if (e == t) {
								i
									? (i.m_next = t.m_next)
									: (this.m_fixtureList = t.m_next);
								break;
							}
							e = (i = e).m_next;
						}
						for (var n, r = this.m_contactList; r; ) {
							var o = r.contact,
								r = r.next,
								s = o.GetFixtureA(),
								c = o.GetFixtureB();
							(t != s && t != c) ||
								this.m_world.m_contactManager.Destroy(o);
						}
						this.m_flags & x.e_activeFlag &&
							((n = this.m_world.m_contactManager.m_broadPhase),
							t.DestroyProxy(n)),
							t.Destroy(),
							(t.m_body = null),
							(t.m_next = null),
							--this.m_fixtureCount,
							this.ResetMassData();
					}
				}),
				(x.prototype.SetPositionAndAngle = function (t, e) {
					if (
						(void 0 === e && (e = 0), 1 != this.m_world.IsLocked())
					) {
						this.m_xf.R.Set(e), this.m_xf.position.SetV(t);
						var i = this.m_xf.R,
							t = this.m_sweep.localCenter;
						(this.m_sweep.c.x = i.col1.x * t.x + i.col2.x * t.y),
							(this.m_sweep.c.y =
								i.col1.y * t.x + i.col2.y * t.y),
							(this.m_sweep.c.x += this.m_xf.position.x),
							(this.m_sweep.c.y += this.m_xf.position.y),
							this.m_sweep.c0.SetV(this.m_sweep.c),
							(this.m_sweep.a0 = this.m_sweep.a = e);
						for (
							var n = this.m_world.m_contactManager.m_broadPhase,
								r = this.m_fixtureList;
							r;
							r = r.m_next
						)
							r.Synchronize(n, this.m_xf, this.m_xf);
						this.m_world.m_contactManager.FindNewContacts();
					}
				}),
				(x.prototype.SetTransform = function (t) {
					this.SetPositionAndAngle(t.position, t.GetAngle());
				}),
				(x.prototype.GetTransform = function () {
					return this.m_xf;
				}),
				(x.prototype.GetPosition = function () {
					return this.m_xf.position;
				}),
				(x.prototype.SetPosition = function (t) {
					this.SetPositionAndAngle(t, this.GetAngle());
				}),
				(x.prototype.GetAngle = function () {
					return this.m_sweep.a;
				}),
				(x.prototype.SetAngle = function (t) {
					void 0 === t && (t = 0),
						this.SetPositionAndAngle(this.GetPosition(), t);
				}),
				(x.prototype.GetWorldCenter = function () {
					return this.m_sweep.c;
				}),
				(x.prototype.GetLocalCenter = function () {
					return this.m_sweep.localCenter;
				}),
				(x.prototype.SetLinearVelocity = function (t) {
					this.m_type != x.b2_staticBody &&
						this.m_linearVelocity.SetV(t);
				}),
				(x.prototype.GetLinearVelocity = function () {
					return this.m_linearVelocity;
				}),
				(x.prototype.SetAngularVelocity = function (t) {
					void 0 === t && (t = 0),
						this.m_type != x.b2_staticBody &&
							(this.m_angularVelocity = t);
				}),
				(x.prototype.GetAngularVelocity = function () {
					return this.m_angularVelocity;
				}),
				(x.prototype.GetDefinition = function () {
					var t = new s();
					return (
						(t.type = this.GetType()),
						(t.allowSleep =
							(this.m_flags & x.e_allowSleepFlag) ==
							x.e_allowSleepFlag),
						(t.angle = this.GetAngle()),
						(t.angularDamping = this.m_angularDamping),
						(t.angularVelocity = this.m_angularVelocity),
						(t.fixedRotation =
							(this.m_flags & x.e_fixedRotationFlag) ==
							x.e_fixedRotationFlag),
						(t.bullet =
							(this.m_flags & x.e_bulletFlag) == x.e_bulletFlag),
						(t.awake =
							(this.m_flags & x.e_awakeFlag) == x.e_awakeFlag),
						(t.linearDamping = this.m_linearDamping),
						t.linearVelocity.SetV(this.GetLinearVelocity()),
						(t.position = this.GetPosition()),
						(t.userData = this.GetUserData()),
						t
					);
				}),
				(x.prototype.ApplyForce = function (t, e) {
					this.m_type == x.b2_dynamicBody &&
						(0 == this.IsAwake() && this.SetAwake(!0),
						(this.m_force.x += t.x),
						(this.m_force.y += t.y),
						(this.m_torque +=
							(e.x - this.m_sweep.c.x) * t.y -
							(e.y - this.m_sweep.c.y) * t.x));
				}),
				(x.prototype.ApplyTorque = function (t) {
					void 0 === t && (t = 0),
						this.m_type == x.b2_dynamicBody &&
							(0 == this.IsAwake() && this.SetAwake(!0),
							(this.m_torque += t));
				}),
				(x.prototype.ApplyImpulse = function (t, e) {
					this.m_type == x.b2_dynamicBody &&
						(0 == this.IsAwake() && this.SetAwake(!0),
						(this.m_linearVelocity.x += this.m_invMass * t.x),
						(this.m_linearVelocity.y += this.m_invMass * t.y),
						(this.m_angularVelocity +=
							this.m_invI *
							((e.x - this.m_sweep.c.x) * t.y -
								(e.y - this.m_sweep.c.y) * t.x)));
				}),
				(x.prototype.Split = function (t) {
					for (
						var e,
							i = this.GetLinearVelocity().Copy(),
							n = this.GetAngularVelocity(),
							r = this.GetWorldCenter(),
							o = this.m_world.CreateBody(this.GetDefinition()),
							s = this.m_fixtureList;
						s;

					)
						var c,
							s = t(s)
								? ((c = s.m_next),
								  e ? (e.m_next = c) : (this.m_fixtureList = c),
								  this.m_fixtureCount--,
								  (s.m_next = o.m_fixtureList),
								  (o.m_fixtureList = s),
								  o.m_fixtureCount++,
								  (s.m_body = o),
								  c)
								: (e = s).m_next;
					this.ResetMassData(), o.ResetMassData();
					var a = this.GetWorldCenter(),
						l = o.GetWorldCenter(),
						a = p.AddVV(i, p.CrossFV(n, p.SubtractVV(a, r))),
						r = p.AddVV(i, p.CrossFV(n, p.SubtractVV(l, r)));
					return (
						this.SetLinearVelocity(a),
						o.SetLinearVelocity(r),
						this.SetAngularVelocity(n),
						o.SetAngularVelocity(n),
						this.SynchronizeFixtures(),
						o.SynchronizeFixtures(),
						o
					);
				}),
				(x.prototype.Merge = function (t) {
					for (var e = t.m_fixtureList; e; ) {
						var i = e.m_next;
						t.m_fixtureCount--,
							(e.m_next = this.m_fixtureList),
							(this.m_fixtureList = e),
							this.m_fixtureCount++,
							(e.m_body = n),
							(e = i);
					}
					(void 0).m_fixtureCount = 0;
					var n = t;
					this.GetWorldCenter(),
						n.GetWorldCenter(),
						this.GetLinearVelocity().Copy(),
						n.GetLinearVelocity().Copy(),
						this.GetAngularVelocity(),
						n.GetAngularVelocity();
					this.ResetMassData(), this.SynchronizeFixtures();
				}),
				(x.prototype.GetMass = function () {
					return this.m_mass;
				}),
				(x.prototype.GetInertia = function () {
					return this.m_I;
				}),
				(x.prototype.GetMassData = function (t) {
					(t.mass = this.m_mass),
						(t.I = this.m_I),
						t.center.SetV(this.m_sweep.localCenter);
				}),
				(x.prototype.SetMassData = function (t) {
					var e;
					C.b2Assert(0 == this.m_world.IsLocked()),
						1 != this.m_world.IsLocked() &&
							this.m_type == x.b2_dynamicBody &&
							((this.m_invMass = 0),
							(this.m_I = 0),
							(this.m_invI = 0),
							(this.m_mass = t.mass),
							this.m_mass <= 0 && (this.m_mass = 1),
							(this.m_invMass = 1 / this.m_mass),
							0 < t.I &&
								0 == (this.m_flags & x.e_fixedRotationFlag) &&
								((this.m_I =
									t.I -
									this.m_mass *
										(t.center.x * t.center.x +
											t.center.y * t.center.y)),
								(this.m_invI = 1 / this.m_I)),
							(e = this.m_sweep.c.Copy()),
							this.m_sweep.localCenter.SetV(t.center),
							this.m_sweep.c0.SetV(
								p.MulX(this.m_xf, this.m_sweep.localCenter)
							),
							this.m_sweep.c.SetV(this.m_sweep.c0),
							(this.m_linearVelocity.x +=
								this.m_angularVelocity *
								-(this.m_sweep.c.y - e.y)),
							(this.m_linearVelocity.y +=
								this.m_angularVelocity *
								(this.m_sweep.c.x - e.x)));
				}),
				(x.prototype.ResetMassData = function () {
					if (
						((this.m_mass = 0),
						(this.m_invMass = 0),
						(this.m_I = 0),
						(this.m_invI = 0),
						this.m_sweep.localCenter.SetZero(),
						this.m_type != x.b2_staticBody &&
							this.m_type != x.b2_kinematicBody)
					) {
						for (
							var t, e = f.Make(0, 0), i = this.m_fixtureList;
							i;
							i = i.m_next
						)
							0 != i.m_density &&
								((t = i.GetMassData()),
								(this.m_mass += t.mass),
								(e.x += t.center.x * t.mass),
								(e.y += t.center.y * t.mass),
								(this.m_I += t.I));
						0 < this.m_mass
							? ((this.m_invMass = 1 / this.m_mass),
							  (e.x *= this.m_invMass),
							  (e.y *= this.m_invMass))
							: ((this.m_mass = 1), (this.m_invMass = 1)),
							0 < this.m_I &&
							0 == (this.m_flags & x.e_fixedRotationFlag)
								? ((this.m_I -=
										this.m_mass * (e.x * e.x + e.y * e.y)),
								  (this.m_I *= this.m_inertiaScale),
								  C.b2Assert(0 < this.m_I),
								  (this.m_invI = 1 / this.m_I))
								: ((this.m_I = 0), (this.m_invI = 0));
						var n = this.m_sweep.c.Copy();
						this.m_sweep.localCenter.SetV(e),
							this.m_sweep.c0.SetV(
								p.MulX(this.m_xf, this.m_sweep.localCenter)
							),
							this.m_sweep.c.SetV(this.m_sweep.c0),
							(this.m_linearVelocity.x +=
								this.m_angularVelocity *
								-(this.m_sweep.c.y - n.y)),
							(this.m_linearVelocity.y +=
								this.m_angularVelocity *
								(this.m_sweep.c.x - n.x));
					}
				}),
				(x.prototype.GetWorldPoint = function (t) {
					var e = this.m_xf.R,
						t = new f(
							e.col1.x * t.x + e.col2.x * t.y,
							e.col1.y * t.x + e.col2.y * t.y
						);
					return (
						(t.x += this.m_xf.position.x),
						(t.y += this.m_xf.position.y),
						t
					);
				}),
				(x.prototype.GetWorldVector = function (t) {
					return p.MulMV(this.m_xf.R, t);
				}),
				(x.prototype.GetLocalPoint = function (t) {
					return p.MulXT(this.m_xf, t);
				}),
				(x.prototype.GetLocalVector = function (t) {
					return p.MulTMV(this.m_xf.R, t);
				}),
				(x.prototype.GetLinearVelocityFromWorldPoint = function (t) {
					return new f(
						this.m_linearVelocity.x -
							this.m_angularVelocity * (t.y - this.m_sweep.c.y),
						this.m_linearVelocity.y +
							this.m_angularVelocity * (t.x - this.m_sweep.c.x)
					);
				}),
				(x.prototype.GetLinearVelocityFromLocalPoint = function (t) {
					var e = this.m_xf.R,
						t = new f(
							e.col1.x * t.x + e.col2.x * t.y,
							e.col1.y * t.x + e.col2.y * t.y
						);
					return (
						(t.x += this.m_xf.position.x),
						(t.y += this.m_xf.position.y),
						new f(
							this.m_linearVelocity.x -
								this.m_angularVelocity *
									(t.y - this.m_sweep.c.y),
							this.m_linearVelocity.y +
								this.m_angularVelocity *
									(t.x - this.m_sweep.c.x)
						)
					);
				}),
				(x.prototype.GetLinearDamping = function () {
					return this.m_linearDamping;
				}),
				(x.prototype.SetLinearDamping = function (t) {
					void 0 === t && (t = 0), (this.m_linearDamping = t);
				}),
				(x.prototype.GetAngularDamping = function () {
					return this.m_angularDamping;
				}),
				(x.prototype.SetAngularDamping = function (t) {
					void 0 === t && (t = 0), (this.m_angularDamping = t);
				}),
				(x.prototype.SetType = function (t) {
					if ((void 0 === t && (t = 0), this.m_type != t)) {
						(this.m_type = t),
							this.ResetMassData(),
							this.m_type == x.b2_staticBody &&
								(this.m_linearVelocity.SetZero(),
								(this.m_angularVelocity = 0)),
							this.SetAwake(!0),
							this.m_force.SetZero(),
							(this.m_torque = 0);
						for (var e = this.m_contactList; e; e = e.next)
							e.contact.FlagForFiltering();
					}
				}),
				(x.prototype.GetType = function () {
					return this.m_type;
				}),
				(x.prototype.SetBullet = function (t) {
					t
						? (this.m_flags |= x.e_bulletFlag)
						: (this.m_flags &= ~x.e_bulletFlag);
				}),
				(x.prototype.IsBullet = function () {
					return (this.m_flags & x.e_bulletFlag) == x.e_bulletFlag;
				}),
				(x.prototype.SetSleepingAllowed = function (t) {
					t
						? (this.m_flags |= x.e_allowSleepFlag)
						: ((this.m_flags &= ~x.e_allowSleepFlag),
						  this.SetAwake(!0));
				}),
				(x.prototype.SetAwake = function (t) {
					t
						? ((this.m_flags |= x.e_awakeFlag),
						  (this.m_sleepTime = 0))
						: ((this.m_flags &= ~x.e_awakeFlag),
						  (this.m_sleepTime = 0),
						  this.m_linearVelocity.SetZero(),
						  (this.m_angularVelocity = 0),
						  this.m_force.SetZero(),
						  (this.m_torque = 0));
				}),
				(x.prototype.IsAwake = function () {
					return (this.m_flags & x.e_awakeFlag) == x.e_awakeFlag;
				}),
				(x.prototype.SetFixedRotation = function (t) {
					t
						? (this.m_flags |= x.e_fixedRotationFlag)
						: (this.m_flags &= ~x.e_fixedRotationFlag),
						this.ResetMassData();
				}),
				(x.prototype.IsFixedRotation = function () {
					return (
						(this.m_flags & x.e_fixedRotationFlag) ==
						x.e_fixedRotationFlag
					);
				}),
				(x.prototype.SetActive = function (t) {
					var e, i;
					if (t != this.IsActive())
						if (t)
							for (
								this.m_flags |= x.e_activeFlag,
									e =
										this.m_world.m_contactManager
											.m_broadPhase,
									i = this.m_fixtureList;
								i;
								i = i.m_next
							)
								i.CreateProxy(e, this.m_xf);
						else {
							for (
								this.m_flags &= ~x.e_activeFlag,
									e =
										this.m_world.m_contactManager
											.m_broadPhase,
									i = this.m_fixtureList;
								i;
								i = i.m_next
							)
								i.DestroyProxy(e);
							for (var n = this.m_contactList; n; ) {
								var r = n,
									n = n.next;
								this.m_world.m_contactManager.Destroy(
									r.contact
								);
							}
							this.m_contactList = null;
						}
				}),
				(x.prototype.IsActive = function () {
					return (this.m_flags & x.e_activeFlag) == x.e_activeFlag;
				}),
				(x.prototype.IsSleepingAllowed = function () {
					return (
						(this.m_flags & x.e_allowSleepFlag) ==
						x.e_allowSleepFlag
					);
				}),
				(x.prototype.GetFixtureList = function () {
					return this.m_fixtureList;
				}),
				(x.prototype.GetJointList = function () {
					return this.m_jointList;
				}),
				(x.prototype.GetControllerList = function () {
					return this.m_controllerList;
				}),
				(x.prototype.GetContactList = function () {
					return this.m_contactList;
				}),
				(x.prototype.GetNext = function () {
					return this.m_next;
				}),
				(x.prototype.GetUserData = function () {
					return this.m_userData;
				}),
				(x.prototype.SetUserData = function (t) {
					this.m_userData = t;
				}),
				(x.prototype.GetWorld = function () {
					return this.m_world;
				}),
				(x.prototype.b2Body = function (t, e) {
					(this.m_flags = 0),
						t.bullet && (this.m_flags |= x.e_bulletFlag),
						t.fixedRotation &&
							(this.m_flags |= x.e_fixedRotationFlag),
						t.allowSleep && (this.m_flags |= x.e_allowSleepFlag),
						t.awake && (this.m_flags |= x.e_awakeFlag),
						t.active && (this.m_flags |= x.e_activeFlag),
						(this.m_world = e),
						this.m_xf.position.SetV(t.position),
						this.m_xf.R.Set(t.angle),
						this.m_sweep.localCenter.SetZero(),
						(this.m_sweep.t0 = 1),
						(this.m_sweep.a0 = this.m_sweep.a = t.angle);
					var i = this.m_xf.R,
						e = this.m_sweep.localCenter;
					(this.m_sweep.c.x = i.col1.x * e.x + i.col2.x * e.y),
						(this.m_sweep.c.y = i.col1.y * e.x + i.col2.y * e.y),
						(this.m_sweep.c.x += this.m_xf.position.x),
						(this.m_sweep.c.y += this.m_xf.position.y),
						this.m_sweep.c0.SetV(this.m_sweep.c),
						(this.m_jointList = null),
						(this.m_controllerList = null),
						(this.m_contactList = null),
						(this.m_controllerCount = 0),
						(this.m_prev = null),
						(this.m_next = null),
						this.m_linearVelocity.SetV(t.linearVelocity),
						(this.m_angularVelocity = t.angularVelocity),
						(this.m_linearDamping = t.linearDamping),
						(this.m_angularDamping = t.angularDamping),
						this.m_force.Set(0, 0),
						(this.m_torque = 0),
						(this.m_sleepTime = 0),
						(this.m_type = t.type),
						this.m_type == x.b2_dynamicBody
							? ((this.m_mass = 1), (this.m_invMass = 1))
							: ((this.m_mass = 0), (this.m_invMass = 0)),
						(this.m_I = 0),
						(this.m_invI = 0),
						(this.m_inertiaScale = t.inertiaScale),
						(this.m_userData = t.userData),
						(this.m_fixtureList = null),
						(this.m_fixtureCount = 0);
				}),
				(x.prototype.SynchronizeFixtures = function () {
					var t = x.s_xf1;
					t.R.Set(this.m_sweep.a0);
					var e = t.R,
						i = this.m_sweep.localCenter;
					(t.position.x =
						this.m_sweep.c0.x - (e.col1.x * i.x + e.col2.x * i.y)),
						(t.position.y =
							this.m_sweep.c0.y -
							(e.col1.y * i.x + e.col2.y * i.y));
					for (
						var n = this.m_world.m_contactManager.m_broadPhase,
							r = this.m_fixtureList;
						r;
						r = r.m_next
					)
						r.Synchronize(n, t, this.m_xf);
				}),
				(x.prototype.SynchronizeTransform = function () {
					this.m_xf.R.Set(this.m_sweep.a);
					var t = this.m_xf.R,
						e = this.m_sweep.localCenter;
					(this.m_xf.position.x =
						this.m_sweep.c.x - (t.col1.x * e.x + t.col2.x * e.y)),
						(this.m_xf.position.y =
							this.m_sweep.c.y -
							(t.col1.y * e.x + t.col2.y * e.y));
				}),
				(x.prototype.ShouldCollide = function (t) {
					if (
						this.m_type != x.b2_dynamicBody &&
						t.m_type != x.b2_dynamicBody
					)
						return !1;
					for (var e = this.m_jointList; e; e = e.next)
						if (e.other == t && 0 == e.joint.m_collideConnected)
							return !1;
					return !0;
				}),
				(x.prototype.Advance = function (t) {
					void 0 === t && (t = 0),
						this.m_sweep.Advance(t),
						this.m_sweep.c.SetV(this.m_sweep.c0),
						(this.m_sweep.a = this.m_sweep.a0),
						this.SynchronizeTransform();
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Dynamics.b2Body.s_xf1 = new o()),
						(Box2D.Dynamics.b2Body.e_islandFlag = 1),
						(Box2D.Dynamics.b2Body.e_awakeFlag = 2),
						(Box2D.Dynamics.b2Body.e_allowSleepFlag = 4),
						(Box2D.Dynamics.b2Body.e_bulletFlag = 8),
						(Box2D.Dynamics.b2Body.e_fixedRotationFlag = 16),
						(Box2D.Dynamics.b2Body.e_activeFlag = 32),
						(Box2D.Dynamics.b2Body.b2_staticBody = 0),
						(Box2D.Dynamics.b2Body.b2_kinematicBody = 1),
						(Box2D.Dynamics.b2Body.b2_dynamicBody = 2);
				}),
				(s.b2BodyDef = function () {
					(this.position = new f()), (this.linearVelocity = new f());
				}),
				(s.prototype.b2BodyDef = function () {
					(this.userData = null),
						this.position.Set(0, 0),
						(this.angle = 0),
						this.linearVelocity.Set(0, 0),
						(this.angularVelocity = 0),
						(this.linearDamping = 0),
						(this.angularDamping = 0),
						(this.allowSleep = !0),
						(this.awake = !0),
						(this.fixedRotation = !1),
						(this.bullet = !1),
						(this.type = x.b2_staticBody),
						(this.active = !0),
						(this.inertiaScale = 1);
				}),
				(c.b2ContactFilter = function () {}),
				(c.prototype.ShouldCollide = function (t, e) {
					(t = t.GetFilterData()), (e = e.GetFilterData());
					return t.groupIndex == e.groupIndex && 0 != t.groupIndex
						? 0 < t.groupIndex
						: 0 != (t.maskBits & e.categoryBits) &&
								0 != (t.categoryBits & e.maskBits);
				}),
				(c.prototype.RayCollide = function (t, e) {
					return (
						!t || this.ShouldCollide(t instanceof A ? t : null, e)
					);
				}),
				Box2D.postDefs.push(function () {
					Box2D.Dynamics.b2ContactFilter.b2_defaultFilter = new c();
				}),
				(a.b2ContactImpulse = function () {
					(this.normalImpulses = new Vector_a2j_Number(
						C.b2_maxManifoldPoints
					)),
						(this.tangentImpulses = new Vector_a2j_Number(
							C.b2_maxManifoldPoints
						));
				}),
				(h.b2ContactListener = function () {}),
				(h.prototype.BeginContact = function (t) {}),
				(h.prototype.EndContact = function (t) {}),
				(h.prototype.PreSolve = function (t, e) {}),
				(h.prototype.PostSolve = function (t, e) {}),
				Box2D.postDefs.push(function () {
					Box2D.Dynamics.b2ContactListener.b2_defaultListener =
						new h();
				}),
				(T.b2ContactManager = function () {}),
				(T.prototype.b2ContactManager = function () {
					(this.m_world = null),
						(this.m_contactCount = 0),
						(this.m_contactFilter = c.b2_defaultFilter),
						(this.m_contactListener = h.b2_defaultListener),
						(this.m_contactFactory = new D(this.m_allocator)),
						(this.m_broadPhase = new i());
				}),
				(T.prototype.AddPair = function (t, e) {
					var i = e instanceof A ? e : null;
					if (
						(r = (n = t instanceof A ? t : null).GetBody()) !=
						(e = i.GetBody())
					) {
						for (var n, r, o = e.GetContactList(); o; ) {
							if (o.other == r) {
								var s = o.contact.GetFixtureA(),
									c = o.contact.GetFixtureB();
								if (s == n && c == i) return;
								if (s == i && c == n) return;
							}
							o = o.next;
						}
						0 != e.ShouldCollide(r) &&
							0 != this.m_contactFilter.ShouldCollide(n, i) &&
							((n = (t = this.m_contactFactory.Create(
								n,
								i
							)).GetFixtureA()),
							(i = t.GetFixtureB()),
							(r = n.m_body),
							(e = i.m_body),
							(t.m_prev = null),
							(t.m_next = this.m_world.m_contactList),
							null != this.m_world.m_contactList &&
								(this.m_world.m_contactList.m_prev = t),
							(((this.m_world.m_contactList = t).m_nodeA.contact =
								t).m_nodeA.other = e),
							(t.m_nodeA.prev = null),
							(t.m_nodeA.next = r.m_contactList),
							null != r.m_contactList &&
								(r.m_contactList.prev = t.m_nodeA),
							(r.m_contactList = t.m_nodeA),
							((t.m_nodeB.contact = t).m_nodeB.other = r),
							(t.m_nodeB.prev = null),
							(t.m_nodeB.next = e.m_contactList),
							null != e.m_contactList &&
								(e.m_contactList.prev = t.m_nodeB),
							(e.m_contactList = t.m_nodeB),
							++this.m_world.m_contactCount);
					}
				}),
				(T.prototype.FindNewContacts = function () {
					this.m_broadPhase.UpdatePairs(
						Box2D.generateCallback(this, this.AddPair)
					);
				}),
				(T.prototype.Destroy = function (t) {
					var e = t.GetFixtureA(),
						i = t.GetFixtureB(),
						e = e.GetBody(),
						i = i.GetBody();
					t.IsTouching() && this.m_contactListener.EndContact(t),
						t.m_prev && (t.m_prev.m_next = t.m_next),
						t.m_next && (t.m_next.m_prev = t.m_prev),
						t == this.m_world.m_contactList &&
							(this.m_world.m_contactList = t.m_next),
						t.m_nodeA.prev &&
							(t.m_nodeA.prev.next = t.m_nodeA.next),
						t.m_nodeA.next &&
							(t.m_nodeA.next.prev = t.m_nodeA.prev),
						t.m_nodeA == e.m_contactList &&
							(e.m_contactList = t.m_nodeA.next),
						t.m_nodeB.prev &&
							(t.m_nodeB.prev.next = t.m_nodeB.next),
						t.m_nodeB.next &&
							(t.m_nodeB.next.prev = t.m_nodeB.prev),
						t.m_nodeB == i.m_contactList &&
							(i.m_contactList = t.m_nodeB.next),
						this.m_contactFactory.Destroy(t),
						--this.m_contactCount;
				}),
				(T.prototype.Collide = function () {
					for (var t = this.m_world.m_contactList; t; ) {
						var e = t.GetFixtureA(),
							i = t.GetFixtureB(),
							n = e.GetBody(),
							r = i.GetBody();
						if (0 != n.IsAwake() || 0 != r.IsAwake()) {
							if (t.m_flags & w.e_filterFlag) {
								if (0 == r.ShouldCollide(n)) {
									var o = t,
										t = o.GetNext();
									this.Destroy(o);
									continue;
								}
								if (
									0 ==
									this.m_contactFilter.ShouldCollide(e, i)
								) {
									(t = (o = t).GetNext()), this.Destroy(o);
									continue;
								}
								t.m_flags &= ~w.e_filterFlag;
							}
							(e = e.m_proxy), (i = i.m_proxy);
							0 != this.m_broadPhase.TestOverlap(e, i)
								? (t.Update(this.m_contactListener),
								  (t = t.GetNext()))
								: ((t = (o = t).GetNext()), this.Destroy(o));
						} else t = t.GetNext();
					}
				}),
				Box2D.postDefs.push(function () {
					Box2D.Dynamics.b2ContactManager.s_evalCP = new e();
				}),
				(S.b2DebugDraw = function () {}),
				(S.prototype.b2DebugDraw = function () {}),
				(S.prototype.SetFlags = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.GetFlags = function () {}),
				(S.prototype.AppendFlags = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.ClearFlags = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.SetSprite = function (t) {}),
				(S.prototype.GetSprite = function () {}),
				(S.prototype.SetDrawScale = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.GetDrawScale = function () {}),
				(S.prototype.SetLineThickness = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.GetLineThickness = function () {}),
				(S.prototype.SetAlpha = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.GetAlpha = function () {}),
				(S.prototype.SetFillAlpha = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.GetFillAlpha = function () {}),
				(S.prototype.SetXFormScale = function (t) {
					void 0 === t && (t = 0);
				}),
				(S.prototype.GetXFormScale = function () {}),
				(S.prototype.DrawPolygon = function (t, e, i) {
					void 0 === e && (e = 0);
				}),
				(S.prototype.DrawSolidPolygon = function (t, e, i) {
					void 0 === e && (e = 0);
				}),
				(S.prototype.DrawCircle = function (t, e, i) {
					void 0 === e && (e = 0);
				}),
				(S.prototype.DrawSolidCircle = function (t, e, i, n) {
					void 0 === e && (e = 0);
				}),
				(S.prototype.DrawSegment = function (t, e, i) {}),
				(S.prototype.DrawTransform = function (t) {}),
				Box2D.postDefs.push(function () {
					(Box2D.Dynamics.b2DebugDraw.e_shapeBit = 1),
						(Box2D.Dynamics.b2DebugDraw.e_jointBit = 2),
						(Box2D.Dynamics.b2DebugDraw.e_aabbBit = 4),
						(Box2D.Dynamics.b2DebugDraw.e_pairBit = 8),
						(Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit = 16),
						(Box2D.Dynamics.b2DebugDraw.e_controllerBit = 32);
				}),
				(v.b2DestructionListener = function () {}),
				(v.prototype.SayGoodbyeJoint = function (t) {}),
				(v.prototype.SayGoodbyeFixture = function (t) {}),
				(E.b2FilterData = function () {
					(this.categoryBits = 1),
						(this.maskBits = 65535),
						(this.groupIndex = 0);
				}),
				(E.prototype.Copy = function () {
					var t = new E();
					return (
						(t.categoryBits = this.categoryBits),
						(t.maskBits = this.maskBits),
						(t.groupIndex = this.groupIndex),
						t
					);
				}),
				(A.b2Fixture = function () {
					this.m_filter = new E();
				}),
				(A.prototype.GetType = function () {
					return this.m_shape.GetType();
				}),
				(A.prototype.GetShape = function () {
					return this.m_shape;
				}),
				(A.prototype.SetSensor = function (t) {
					if (
						this.m_isSensor != t &&
						((this.m_isSensor = t), null != this.m_body)
					)
						for (var e = this.m_body.GetContactList(); e; ) {
							var i = e.contact,
								n = i.GetFixtureA(),
								r = i.GetFixtureB();
							(n != this && r != this) ||
								i.SetSensor(n.IsSensor() || r.IsSensor()),
								(e = e.next);
						}
				}),
				(A.prototype.IsSensor = function () {
					return this.m_isSensor;
				}),
				(A.prototype.SetFilterData = function (t) {
					if (((this.m_filter = t.Copy()), !this.m_body))
						for (var e = this.m_body.GetContactList(); e; ) {
							var i = e.contact,
								n = i.GetFixtureA(),
								r = i.GetFixtureB();
							(n != this && r != this) || i.FlagForFiltering(),
								(e = e.next);
						}
				}),
				(A.prototype.GetFilterData = function () {
					return this.m_filter.Copy();
				}),
				(A.prototype.GetBody = function () {
					return this.m_body;
				}),
				(A.prototype.GetNext = function () {
					return this.m_next;
				}),
				(A.prototype.GetUserData = function () {
					return this.m_userData;
				}),
				(A.prototype.SetUserData = function (t) {
					this.m_userData = t;
				}),
				(A.prototype.TestPoint = function (t) {
					return this.m_shape.TestPoint(
						this.m_body.GetTransform(),
						t
					);
				}),
				(A.prototype.RayCast = function (t, e) {
					return this.m_shape.RayCast(
						t,
						e,
						this.m_body.GetTransform()
					);
				}),
				(A.prototype.GetMassData = function (t) {
					return (
						void 0 === t && (t = null),
						null == t && (t = new r()),
						this.m_shape.ComputeMass(t, this.m_density),
						t
					);
				}),
				(A.prototype.SetDensity = function (t) {
					void 0 === t && (t = 0), (this.m_density = t);
				}),
				(A.prototype.GetDensity = function () {
					return this.m_density;
				}),
				(A.prototype.GetFriction = function () {
					return this.m_friction;
				}),
				(A.prototype.SetFriction = function (t) {
					void 0 === t && (t = 0), (this.m_friction = t);
				}),
				(A.prototype.GetRestitution = function () {
					return this.m_restitution;
				}),
				(A.prototype.SetRestitution = function (t) {
					void 0 === t && (t = 0), (this.m_restitution = t);
				}),
				(A.prototype.GetAABB = function () {
					return this.m_aabb;
				}),
				(A.prototype.b2Fixture = function () {
					(this.m_aabb = new g()),
						(this.m_userData = null),
						(this.m_body = null),
						(this.m_next = null),
						(this.m_shape = null),
						(this.m_density = 0),
						(this.m_friction = 0),
						(this.m_restitution = 0);
				}),
				(A.prototype.Create = function (t, e, i) {
					(this.m_userData = i.userData),
						(this.m_friction = i.friction),
						(this.m_restitution = i.restitution),
						(this.m_body = t),
						(this.m_next = null),
						(this.m_filter = i.filter.Copy()),
						(this.m_isSensor = i.isSensor),
						(this.m_shape = i.shape.Copy()),
						(this.m_density = i.density);
				}),
				(A.prototype.Destroy = function () {
					this.m_shape = null;
				}),
				(A.prototype.CreateProxy = function (t, e) {
					this.m_shape.ComputeAABB(this.m_aabb, e),
						(this.m_proxy = t.CreateProxy(this.m_aabb, this));
				}),
				(A.prototype.DestroyProxy = function (t) {
					null != this.m_proxy &&
						(t.DestroyProxy(this.m_proxy), (this.m_proxy = null));
				}),
				(A.prototype.Synchronize = function (t, e, i) {
					var n, r;
					this.m_proxy &&
						((n = new g()),
						(r = new g()),
						this.m_shape.ComputeAABB(n, e),
						this.m_shape.ComputeAABB(r, i),
						this.m_aabb.Combine(n, r),
						(e = p.SubtractVV(i.position, e.position)),
						t.MoveProxy(this.m_proxy, this.m_aabb, e));
				}),
				(b.b2FixtureDef = function () {
					this.filter = new E();
				}),
				(b.prototype.b2FixtureDef = function () {
					(this.shape = null),
						(this.userData = null),
						(this.friction = 0.2),
						(this.restitution = 0),
						(this.density = 0),
						(this.filter.categoryBits = 1),
						(this.filter.maskBits = 65535),
						(this.filter.groupIndex = 0),
						(this.isSensor = !1);
				}),
				(R.b2Island = function () {}),
				(R.prototype.b2Island = function () {
					(this.m_bodies = new Vector()),
						(this.m_contacts = new Vector()),
						(this.m_joints = new Vector());
				}),
				(R.prototype.Initialize = function (t, e, i, n, r, o) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = 0);
					var s = 0;
					for (
						this.m_bodyCapacity = t,
							this.m_contactCapacity = e,
							this.m_jointCapacity = i,
							this.m_bodyCount = 0,
							this.m_contactCount = 0,
							this.m_jointCount = 0,
							this.m_allocator = n,
							this.m_listener = r,
							this.m_contactSolver = o,
							s = this.m_bodies.length;
						s < t;
						s++
					)
						this.m_bodies[s] = null;
					for (s = this.m_contacts.length; s < e; s++)
						this.m_contacts[s] = null;
					for (s = this.m_joints.length; s < i; s++)
						this.m_joints[s] = null;
				}),
				(R.prototype.Clear = function () {
					(this.m_bodyCount = 0),
						(this.m_contactCount = 0),
						(this.m_jointCount = 0);
				}),
				(R.prototype.Solve = function (t, e, i) {
					var n = 0,
						r = 0;
					for (n = 0; n < this.m_bodyCount; ++n)
						(s = this.m_bodies[n]).GetType() == x.b2_dynamicBody &&
							((s.m_linearVelocity.x +=
								t.dt * (e.x + s.m_invMass * s.m_force.x)),
							(s.m_linearVelocity.y +=
								t.dt * (e.y + s.m_invMass * s.m_force.y)),
							(s.m_angularVelocity +=
								t.dt * s.m_invI * s.m_torque),
							s.m_linearVelocity.Multiply(
								p.Clamp(1 - t.dt * s.m_linearDamping, 0, 1)
							),
							(s.m_angularVelocity *= p.Clamp(
								1 - t.dt * s.m_angularDamping,
								0,
								1
							)));
					this.m_contactSolver.Initialize(
						t,
						this.m_contacts,
						this.m_contactCount,
						this.m_allocator
					);
					var o,
						s,
						c = this.m_contactSolver;
					for (
						c.InitVelocityConstraints(t), n = 0;
						n < this.m_jointCount;
						++n
					)
						this.m_joints[n].InitVelocityConstraints(t);
					for (n = 0; n < t.velocityIterations; ++n) {
						for (r = 0; r < this.m_jointCount; ++r)
							this.m_joints[r].SolveVelocityConstraints(t);
						c.SolveVelocityConstraints();
					}
					for (n = 0; n < this.m_jointCount; ++n)
						this.m_joints[n].FinalizeVelocityConstraints();
					for (
						c.FinalizeVelocityConstraints(), n = 0;
						n < this.m_bodyCount;
						++n
					)
						(s = this.m_bodies[n]).GetType() != x.b2_staticBody &&
							((o = t.dt * s.m_linearVelocity.x) * o +
								(o = t.dt * s.m_linearVelocity.y) * o >
								C.b2_maxTranslationSquared &&
								(s.m_linearVelocity.Normalize(),
								(s.m_linearVelocity.x *=
									C.b2_maxTranslation * t.inv_dt),
								(s.m_linearVelocity.y *=
									C.b2_maxTranslation * t.inv_dt)),
							(o = t.dt * s.m_angularVelocity) * o >
								C.b2_maxRotationSquared &&
								(s.m_angularVelocity < 0
									? (s.m_angularVelocity =
											-C.b2_maxRotation * t.inv_dt)
									: (s.m_angularVelocity =
											C.b2_maxRotation * t.inv_dt)),
							s.m_sweep.c0.SetV(s.m_sweep.c),
							(s.m_sweep.a0 = s.m_sweep.a),
							(s.m_sweep.c.x += t.dt * s.m_linearVelocity.x),
							(s.m_sweep.c.y += t.dt * s.m_linearVelocity.y),
							(s.m_sweep.a += t.dt * s.m_angularVelocity),
							s.SynchronizeTransform());
					for (n = 0; n < t.positionIterations; ++n) {
						for (
							var a = c.SolvePositionConstraints(
									C.b2_contactBaumgarte
								),
								l = !0,
								r = 0;
							r < this.m_jointCount;
							++r
						)
							var h = this.m_joints[r].SolvePositionConstraints(
									C.b2_contactBaumgarte
								),
								l = l && h;
						if (a && l) break;
					}
					if ((this.Report(c.m_constraints), i)) {
						for (
							var u = Number.MAX_VALUE,
								_ =
									C.b2_linearSleepTolerance *
									C.b2_linearSleepTolerance,
								d =
									C.b2_angularSleepTolerance *
									C.b2_angularSleepTolerance,
								n = 0;
							n < this.m_bodyCount;
							++n
						)
							(s = this.m_bodies[n]).GetType() !=
								x.b2_staticBody &&
								(0 == (s.m_flags & x.e_allowSleepFlag) &&
									(u = s.m_sleepTime = 0),
								(u =
									0 == (s.m_flags & x.e_allowSleepFlag) ||
									s.m_angularVelocity * s.m_angularVelocity >
										d ||
									p.Dot(
										s.m_linearVelocity,
										s.m_linearVelocity
									) > _
										? (s.m_sleepTime = 0)
										: ((s.m_sleepTime += t.dt),
										  p.Min(u, s.m_sleepTime))));
						if (u >= C.b2_timeToSleep)
							for (n = 0; n < this.m_bodyCount; ++n)
								(s = this.m_bodies[n]).SetAwake(!1);
					}
				}),
				(R.prototype.SolveTOI = function (t) {
					var e = 0,
						i = 0;
					this.m_contactSolver.Initialize(
						t,
						this.m_contacts,
						this.m_contactCount,
						this.m_allocator
					);
					for (
						var n = this.m_contactSolver, e = 0;
						e < this.m_jointCount;
						++e
					)
						this.m_joints[e].InitVelocityConstraints(t);
					for (e = 0; e < t.velocityIterations; ++e)
						for (
							n.SolveVelocityConstraints(), i = 0;
							i < this.m_jointCount;
							++i
						)
							this.m_joints[i].SolveVelocityConstraints(t);
					for (e = 0; e < this.m_bodyCount; ++e) {
						var r,
							o = this.m_bodies[e];
						o.GetType() != x.b2_staticBody &&
							((r = t.dt * o.m_linearVelocity.x) * r +
								(r = t.dt * o.m_linearVelocity.y) * r >
								C.b2_maxTranslationSquared &&
								(o.m_linearVelocity.Normalize(),
								(o.m_linearVelocity.x *=
									C.b2_maxTranslation * t.inv_dt),
								(o.m_linearVelocity.y *=
									C.b2_maxTranslation * t.inv_dt)),
							(r = t.dt * o.m_angularVelocity) * r >
								C.b2_maxRotationSquared &&
								(o.m_angularVelocity < 0
									? (o.m_angularVelocity =
											-C.b2_maxRotation * t.inv_dt)
									: (o.m_angularVelocity =
											C.b2_maxRotation * t.inv_dt)),
							o.m_sweep.c0.SetV(o.m_sweep.c),
							(o.m_sweep.a0 = o.m_sweep.a),
							(o.m_sweep.c.x += t.dt * o.m_linearVelocity.x),
							(o.m_sweep.c.y += t.dt * o.m_linearVelocity.y),
							(o.m_sweep.a += t.dt * o.m_angularVelocity),
							o.SynchronizeTransform());
					}
					for (e = 0; e < t.positionIterations; ++e) {
						for (
							var s = n.SolvePositionConstraints(0.75),
								c = !0,
								i = 0;
							i < this.m_jointCount;
							++i
						)
							var a = this.m_joints[i].SolvePositionConstraints(
									C.b2_contactBaumgarte
								),
								c = c && a;
						if (s && c) break;
					}
					this.Report(n.m_constraints);
				}),
				(R.prototype.Report = function (t) {
					if (null != this.m_listener)
						for (var e = 0; e < this.m_contactCount; ++e) {
							for (
								var i = this.m_contacts[e], n = t[e], r = 0;
								r < n.pointCount;
								++r
							)
								(R.s_impulse.normalImpulses[r] =
									n.points[r].normalImpulse),
									(R.s_impulse.tangentImpulses[r] =
										n.points[r].tangentImpulse);
							this.m_listener.PostSolve(i, R.s_impulse);
						}
				}),
				(R.prototype.AddBody = function (t) {
					(t.m_islandIndex = this.m_bodyCount),
						(this.m_bodies[this.m_bodyCount++] = t);
				}),
				(R.prototype.AddContact = function (t) {
					this.m_contacts[this.m_contactCount++] = t;
				}),
				(R.prototype.AddJoint = function (t) {
					this.m_joints[this.m_jointCount++] = t;
				}),
				Box2D.postDefs.push(function () {
					Box2D.Dynamics.b2Island.s_impulse = new a();
				}),
				(P.b2TimeStep = function () {}),
				(P.prototype.Set = function (t) {
					(this.dt = t.dt),
						(this.inv_dt = t.inv_dt),
						(this.positionIterations = t.positionIterations),
						(this.velocityIterations = t.velocityIterations),
						(this.warmStarting = t.warmStarting);
				}),
				(I.b2World = function () {
					(this.s_stack = new Vector()),
						(this.m_contactManager = new T()),
						(this.m_contactSolver = new L()),
						(this.m_island = new R());
				}),
				(I.prototype.b2World = function (t, e) {
					(this.m_destructionListener = null),
						(this.m_debugDraw = null),
						(this.m_bodyList = null),
						(this.m_contactList = null),
						(this.m_jointList = null),
						(this.m_controllerList = null),
						(this.m_bodyCount = 0),
						(this.m_contactCount = 0),
						(this.m_jointCount = 0),
						(this.m_controllerCount = 0),
						(I.m_warmStarting = !0),
						(I.m_continuousPhysics = !0),
						(this.m_allowSleep = e),
						(t.y = t.y),
						(this.m_gravity = t),
						(this.m_inv_dt0 = 0),
						(this.m_contactManager.m_world = this);
					t = new s();
					this.m_groundBody = this.CreateBody(t);
				}),
				(I.prototype.SetDestructionListener = function (t) {
					this.m_destructionListener = t;
				}),
				(I.prototype.SetContactFilter = function (t) {
					this.m_contactManager.m_contactFilter = t;
				}),
				(I.prototype.SetContactListener = function (t) {
					this.m_contactManager.m_contactListener = t;
				}),
				(I.prototype.SetDebugDraw = function (t) {
					this.m_debugDraw = t;
				}),
				(I.prototype.SetBroadPhase = function (t) {
					var e = this.m_contactManager.m_broadPhase;
					this.m_contactManager.m_broadPhase = t;
					for (var i = this.m_bodyList; i; i = i.m_next)
						for (var n = i.m_fixtureList; n; n = n.m_next)
							n.m_proxy = t.CreateProxy(
								e.GetFatAABB(n.m_proxy),
								n
							);
				}),
				(I.prototype.Validate = function () {
					this.m_contactManager.m_broadPhase.Validate();
				}),
				(I.prototype.GetProxyCount = function () {
					return this.m_contactManager.m_broadPhase.GetProxyCount();
				}),
				(I.prototype.CreateBody = function (t) {
					if (1 == this.IsLocked()) return null;
					t = new x(t, this);
					return (
						(t.m_prev = null),
						(t.m_next = this.m_bodyList),
						this.m_bodyList && (this.m_bodyList.m_prev = t),
						(this.m_bodyList = t),
						++this.m_bodyCount,
						t
					);
				}),
				(I.prototype.DestroyBody = function (t) {
					if (1 != this.IsLocked()) {
						for (var e = t.m_jointList; e; ) {
							var i = e,
								e = e.next;
							this.m_destructionListener &&
								this.m_destructionListener.SayGoodbyeJoint(
									i.joint
								),
								this.DestroyJoint(i.joint);
						}
						for (var n = t.m_controllerList; n; ) {
							var r = n,
								n = n.nextController;
							r.controller.RemoveBody(t);
						}
						for (var o = t.m_contactList; o; ) {
							var s = o,
								o = o.next;
							this.m_contactManager.Destroy(s.contact);
						}
						t.m_contactList = null;
						for (var c = t.m_fixtureList; c; ) {
							var a = c,
								c = c.m_next;
							this.m_destructionListener &&
								this.m_destructionListener.SayGoodbyeFixture(a),
								a.DestroyProxy(
									this.m_contactManager.m_broadPhase
								),
								a.Destroy();
						}
						(t.m_fixtureList = null),
							(t.m_fixtureCount = 0),
							t.m_prev && (t.m_prev.m_next = t.m_next),
							t.m_next && (t.m_next.m_prev = t.m_prev),
							t == this.m_bodyList &&
								(this.m_bodyList = t.m_next),
							--this.m_bodyCount;
					}
				}),
				(I.prototype.CreateJoint = function (t) {
					var e = O.Create(t, null);
					(e.m_prev = null),
						(e.m_next = this.m_jointList),
						this.m_jointList && (this.m_jointList.m_prev = e),
						(this.m_jointList = e),
						++this.m_jointCount,
						((e.m_edgeA.joint = e).m_edgeA.other = e.m_bodyB),
						(e.m_edgeA.prev = null),
						(e.m_edgeA.next = e.m_bodyA.m_jointList),
						e.m_bodyA.m_jointList &&
							(e.m_bodyA.m_jointList.prev = e.m_edgeA),
						(e.m_bodyA.m_jointList = e.m_edgeA),
						((e.m_edgeB.joint = e).m_edgeB.other = e.m_bodyA),
						(e.m_edgeB.prev = null),
						(e.m_edgeB.next = e.m_bodyB.m_jointList),
						e.m_bodyB.m_jointList &&
							(e.m_bodyB.m_jointList.prev = e.m_edgeB),
						(e.m_bodyB.m_jointList = e.m_edgeB);
					var i = t.bodyA,
						n = t.bodyB;
					if (0 == t.collideConnected)
						for (var r = n.GetContactList(); r; )
							r.other == i && r.contact.FlagForFiltering(),
								(r = r.next);
					return e;
				}),
				(I.prototype.DestroyJoint = function (t) {
					var e = t.m_collideConnected;
					t.m_prev && (t.m_prev.m_next = t.m_next),
						t.m_next && (t.m_next.m_prev = t.m_prev),
						t == this.m_jointList && (this.m_jointList = t.m_next);
					var i = t.m_bodyA,
						n = t.m_bodyB;
					if (
						(i.SetAwake(!0),
						n.SetAwake(!0),
						t.m_edgeA.prev &&
							(t.m_edgeA.prev.next = t.m_edgeA.next),
						t.m_edgeA.next &&
							(t.m_edgeA.next.prev = t.m_edgeA.prev),
						t.m_edgeA == i.m_jointList &&
							(i.m_jointList = t.m_edgeA.next),
						(t.m_edgeA.prev = null),
						(t.m_edgeA.next = null),
						t.m_edgeB.prev &&
							(t.m_edgeB.prev.next = t.m_edgeB.next),
						t.m_edgeB.next &&
							(t.m_edgeB.next.prev = t.m_edgeB.prev),
						t.m_edgeB == n.m_jointList &&
							(n.m_jointList = t.m_edgeB.next),
						(t.m_edgeB.prev = null),
						(t.m_edgeB.next = null),
						O.Destroy(t, null),
						--this.m_jointCount,
						0 == e)
					)
						for (var r = n.GetContactList(); r; )
							r.other == i && r.contact.FlagForFiltering(),
								(r = r.next);
				}),
				(I.prototype.AddController = function (t) {
					return (
						(t.m_next = this.m_controllerList),
						(t.m_prev = null),
						((this.m_controllerList = t).m_world = this)
							.m_controllerCount++,
						t
					);
				}),
				(I.prototype.RemoveController = function (t) {
					t.m_prev && (t.m_prev.m_next = t.m_next),
						t.m_next && (t.m_next.m_prev = t.m_prev),
						this.m_controllerList == t &&
							(this.m_controllerList = t.m_next),
						this.m_controllerCount--;
				}),
				(I.prototype.CreateController = function (t) {
					if (t.m_world != this)
						throw new Error(
							'Controller can only be a member of one world'
						);
					return (
						(t.m_next = this.m_controllerList),
						(t.m_prev = null),
						this.m_controllerList &&
							(this.m_controllerList.m_prev = t),
						(this.m_controllerList = t),
						++this.m_controllerCount,
						(t.m_world = this),
						t
					);
				}),
				(I.prototype.DestroyController = function (t) {
					t.Clear(),
						t.m_next && (t.m_next.m_prev = t.m_prev),
						t.m_prev && (t.m_prev.m_next = t.m_next),
						t == this.m_controllerList &&
							(this.m_controllerList = t.m_next),
						--this.m_controllerCount;
				}),
				(I.prototype.SetWarmStarting = function (t) {
					I.m_warmStarting = t;
				}),
				(I.prototype.SetContinuousPhysics = function (t) {
					I.m_continuousPhysics = t;
				}),
				(I.prototype.GetBodyCount = function () {
					return this.m_bodyCount;
				}),
				(I.prototype.GetJointCount = function () {
					return this.m_jointCount;
				}),
				(I.prototype.GetContactCount = function () {
					return this.m_contactCount;
				}),
				(I.prototype.SetGravity = function (t) {
					this.m_gravity = t;
				}),
				(I.prototype.GetGravity = function () {
					return this.m_gravity;
				}),
				(I.prototype.GetGroundBody = function () {
					return this.m_groundBody;
				}),
				(I.prototype.Step = function (t, e, i) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						void 0 === i && (i = 0),
						this.m_flags & I.e_newFixture &&
							(this.m_contactManager.FindNewContacts(),
							(this.m_flags &= ~I.e_newFixture)),
						(this.m_flags |= I.e_locked);
					var n = I.s_timestep2;
					(n.dt = t),
						(n.velocityIterations = e),
						(n.positionIterations = i),
						(n.inv_dt = 0 < t ? 1 / t : 0),
						(n.dtRatio = this.m_inv_dt0 * t),
						(n.warmStarting = I.m_warmStarting),
						this.m_contactManager.Collide(),
						0 < n.dt && this.Solve(n),
						I.m_continuousPhysics && 0 < n.dt && this.SolveTOI(n),
						0 < n.dt && (this.m_inv_dt0 = n.inv_dt),
						(this.m_flags &= ~I.e_locked);
				}),
				(I.prototype.ClearForces = function () {
					for (var t = this.m_bodyList; t; t = t.m_next)
						t.m_force.SetZero(), (t.m_torque = 0);
				}),
				(I.prototype.DrawDebugData = function () {
					if (null != this.m_debugDraw) {
						this.m_debugDraw.m_sprite.graphics.clear();
						var t,
							e,
							i,
							n,
							r,
							o,
							s = this.m_debugDraw.GetFlags(),
							c =
								(new f(),
								new f(),
								new f(),
								new g(),
								new g(),
								[new f(), new f(), new f(), new f()]),
							a = new m(0, 0, 0);
						if (s & S.e_shapeBit)
							for (t = this.m_bodyList; t; t = t.m_next)
								for (
									o = t.m_xf, e = t.GetFixtureList();
									e;
									e = e.m_next
								)
									(i = e.GetShape()),
										0 == t.IsActive()
											? a.Set(0.5, 0.5, 0.3)
											: t.GetType() == x.b2_staticBody
											? a.Set(0.5, 0.9, 0.5)
											: t.GetType() == x.b2_kinematicBody
											? a.Set(0.5, 0.5, 0.9)
											: 0 == t.IsAwake()
											? a.Set(0.6, 0.6, 0.6)
											: a.Set(0.9, 0.7, 0.7),
										this.DrawShape(i, o, a);
						if (s & S.e_jointBit)
							for (n = this.m_jointList; n; n = n.m_next)
								this.DrawJoint(n);
						if (s & S.e_controllerBit)
							for (var l = this.m_controllerList; l; l = l.m_next)
								l.Draw(this.m_debugDraw);
						if (s & S.e_pairBit) {
							a.Set(0.3, 0.9, 0.9);
							for (
								var h = this.m_contactManager.m_contactList;
								h;
								h = h.GetNext()
							) {
								var u = h.GetFixtureA(),
									_ = h.GetFixtureB(),
									u = u.GetAABB().GetCenter(),
									_ = _.GetAABB().GetCenter();
								this.m_debugDraw.DrawSegment(u, _, a);
							}
						}
						if (s & S.e_aabbBit)
							for (
								r = this.m_contactManager.m_broadPhase,
									c = [new f(), new f(), new f(), new f()],
									t = this.m_bodyList;
								t;
								t = t.GetNext()
							)
								if (0 != t.IsActive())
									for (
										e = t.GetFixtureList();
										e;
										e = e.GetNext()
									) {
										var d = r.GetFatAABB(e.m_proxy);
										c[0].Set(
											d.lowerBound.x,
											d.lowerBound.y
										),
											c[1].Set(
												d.upperBound.x,
												d.lowerBound.y
											),
											c[2].Set(
												d.upperBound.x,
												d.upperBound.y
											),
											c[3].Set(
												d.lowerBound.x,
												d.upperBound.y
											),
											this.m_debugDraw.DrawPolygon(
												c,
												4,
												a
											);
									}
						if (s & S.e_centerOfMassBit)
							for (t = this.m_bodyList; t; t = t.m_next)
								((o = I.s_xf).R = t.m_xf.R),
									(o.position = t.GetWorldCenter()),
									this.m_debugDraw.DrawTransform(o);
					}
				}),
				(I.prototype.QueryAABB = function (e, t) {
					var i = this.m_contactManager.m_broadPhase;
					i.Query(function (t) {
						return e(i.GetUserData(t));
					}, t);
				}),
				(I.prototype.QueryShape = function (e, i, n) {
					void 0 === n && (n = null),
						null == n && (n = new o()).SetIdentity();
					var r = this.m_contactManager.m_broadPhase;
					var t = new g();
					i.ComputeAABB(t, n),
						r.Query(function (t) {
							return (
								(t =
									r.GetUserData(t) instanceof A
										? r.GetUserData(t)
										: null),
								!y.TestOverlap(
									i,
									n,
									t.GetShape(),
									t.GetBody().GetTransform()
								) || e(t)
							);
						}, t);
				}),
				(I.prototype.QueryPoint = function (e, i) {
					var n = this.m_contactManager.m_broadPhase;
					var t = new g();
					t.lowerBound.Set(
						i.x - C.b2_linearSlop,
						i.y - C.b2_linearSlop
					),
						t.upperBound.Set(
							i.x + C.b2_linearSlop,
							i.y + C.b2_linearSlop
						),
						n.Query(function (t) {
							return (
								!(t =
									n.GetUserData(t) instanceof A
										? n.GetUserData(t)
										: null).TestPoint(i) || e(t)
							);
						}, t);
				}),
				(I.prototype.RayCast = function (r, o, s) {
					var c = this.m_contactManager.m_broadPhase,
						a = new l();
					var t = new n(o, s);
					c.RayCast(function (t, e) {
						var i = c.GetUserData(e),
							n = i instanceof A ? i : null;
						if (n.RayCast(a, t)) {
							(e = a.fraction),
								(i = new f(
									(1 - e) * o.x + e * s.x,
									(1 - e) * o.y + e * s.y
								));
							return r(n, i, a.normal, e);
						}
						return t.maxFraction;
					}, t);
				}),
				(I.prototype.RayCastOne = function (t, e) {
					var r;
					return (
						this.RayCast(
							function (t, e, i, n) {
								return void 0 === n && (n = 0), (r = t), n;
							},
							t,
							e
						),
						r
					);
				}),
				(I.prototype.RayCastAll = function (t, e) {
					var r = new Vector();
					return (
						this.RayCast(
							function (t, e, i, n) {
								return (
									void 0 === n && (n = 0),
									(r[r.length] = t),
									1
								);
							},
							t,
							e
						),
						r
					);
				}),
				(I.prototype.GetBodyList = function () {
					return this.m_bodyList;
				}),
				(I.prototype.GetJointList = function () {
					return this.m_jointList;
				}),
				(I.prototype.GetContactList = function () {
					return this.m_contactList;
				}),
				(I.prototype.IsLocked = function () {
					return 0 < (this.m_flags & I.e_locked);
				}),
				(I.prototype.Solve = function (t) {
					for (var e, i = this.m_controllerList; i; i = i.m_next)
						i.Step(t);
					var n = this.m_island;
					for (
						n.Initialize(
							this.m_bodyCount,
							this.m_contactCount,
							this.m_jointCount,
							null,
							this.m_contactManager.m_contactListener,
							this.m_contactSolver
						),
							e = this.m_bodyList;
						e;
						e = e.m_next
					)
						e.m_flags &= ~x.e_islandFlag;
					for (var r = this.m_contactList; r; r = r.m_next)
						r.m_flags &= ~w.e_islandFlag;
					for (var o = this.m_jointList; o; o = o.m_next)
						o.m_islandFlag = !1;
					parseInt(this.m_bodyCount);
					for (
						var s = this.s_stack, c = this.m_bodyList;
						c;
						c = c.m_next
					)
						if (
							!(c.m_flags & x.e_islandFlag) &&
							0 != c.IsAwake() &&
							0 != c.IsActive() &&
							c.GetType() != x.b2_staticBody
						) {
							n.Clear();
							var a = 0;
							for (
								(s[a++] = c).m_flags |= x.e_islandFlag;
								0 < a;

							)
								if (
									((e = s[--a]),
									n.AddBody(e),
									0 == e.IsAwake() && e.SetAwake(!0),
									e.GetType() != x.b2_staticBody)
								) {
									for (
										var l, h = e.m_contactList;
										h;
										h = h.next
									)
										h.contact.m_flags & w.e_islandFlag ||
											(1 != h.contact.IsSensor() &&
												0 != h.contact.IsEnabled() &&
												0 != h.contact.IsTouching() &&
												(n.AddContact(h.contact),
												(h.contact.m_flags |=
													w.e_islandFlag),
												(l = h.other).m_flags &
													x.e_islandFlag ||
													((s[a++] = l).m_flags |=
														x.e_islandFlag)));
									for (var u = e.m_jointList; u; u = u.next)
										1 != u.joint.m_islandFlag &&
											0 != (l = u.other).IsActive() &&
											(n.AddJoint(u.joint),
											(u.joint.m_islandFlag = !0),
											l.m_flags & x.e_islandFlag ||
												((s[a++] = l).m_flags |=
													x.e_islandFlag));
								}
							n.Solve(t, this.m_gravity, this.m_allowSleep);
							for (var _ = 0; _ < n.m_bodyCount; ++_)
								(e = n.m_bodies[_]).GetType() ==
									x.b2_staticBody &&
									(e.m_flags &= ~x.e_islandFlag);
						}
					for (_ = 0; _ < s.length && s[_]; ++_) s[_] = null;
					for (e = this.m_bodyList; e; e = e.m_next)
						0 != e.IsAwake() &&
							0 != e.IsActive() &&
							e.GetType() != x.b2_staticBody &&
							e.SynchronizeFixtures();
					this.m_contactManager.FindNewContacts();
				}),
				(I.prototype.SolveTOI = function (t) {
					var e,
						i,
						n,
						r,
						o,
						s,
						c = this.m_island;
					c.Initialize(
						this.m_bodyCount,
						C.b2_maxTOIContactsPerIsland,
						C.b2_maxTOIJointsPerIsland,
						null,
						this.m_contactManager.m_contactListener,
						this.m_contactSolver
					);
					for (
						var a = I.s_queue, l = this.m_bodyList;
						l;
						l = l.m_next
					)
						(l.m_flags &= ~x.e_islandFlag), (l.m_sweep.t0 = 0);
					for (_ = this.m_contactList; _; _ = _.m_next)
						_.m_flags &= ~(w.e_toiFlag | w.e_islandFlag);
					for (s = this.m_jointList; s; s = s.m_next)
						s.m_islandFlag = !1;
					for (;;) {
						for (
							var h = null, u = 1, _ = this.m_contactList;
							_;
							_ = _.m_next
						)
							if (
								1 != _.IsSensor() &&
								0 != _.IsEnabled() &&
								0 != _.IsContinuous()
							) {
								var d = 1;
								if (_.m_flags & w.e_toiFlag) d = _.m_toi;
								else {
									if (
										((e = _.m_fixtureA),
										(i = _.m_fixtureB),
										(n = e.m_body),
										(r = i.m_body),
										!(
											(n.GetType() == x.b2_dynamicBody &&
												0 != n.IsAwake()) ||
											(r.GetType() == x.b2_dynamicBody &&
												0 != r.IsAwake())
										))
									)
										continue;
									var p = n.m_sweep.t0;
									n.m_sweep.t0 < r.m_sweep.t0
										? ((p = r.m_sweep.t0),
										  n.m_sweep.Advance(p))
										: r.m_sweep.t0 < n.m_sweep.t0 &&
										  ((p = n.m_sweep.t0),
										  r.m_sweep.Advance(p)),
										(d = _.ComputeTOI(
											n.m_sweep,
											r.m_sweep
										)),
										C.b2Assert(0 <= d && d <= 1),
										0 < d &&
											d < 1 &&
											1 < (d = (1 - d) * p + d) &&
											(d = 1),
										(_.m_toi = d),
										(_.m_flags |= w.e_toiFlag);
								}
								Number.MIN_VALUE < d &&
									d < u &&
									((h = _), (u = d));
							}
						if (null == h || 1 - 100 * Number.MIN_VALUE < u) break;
						if (
							((e = h.m_fixtureA),
							(i = h.m_fixtureB),
							(n = e.m_body),
							(r = i.m_body),
							I.s_backupA.Set(n.m_sweep),
							I.s_backupB.Set(r.m_sweep),
							n.Advance(u),
							r.Advance(u),
							h.Update(this.m_contactManager.m_contactListener),
							(h.m_flags &= ~w.e_toiFlag),
							1 != h.IsSensor() && 0 != h.IsEnabled())
						) {
							if (0 != h.IsTouching()) {
								var f = n;
								f.GetType() != x.b2_dynamicBody && (f = r),
									c.Clear();
								var m,
									g = 0,
									y = 0;
								for (
									(a[g + y++] = f).m_flags |= x.e_islandFlag;
									0 < y;

								)
									if (
										((l = a[g++]),
										--y,
										c.AddBody(l),
										0 == l.IsAwake() && l.SetAwake(!0),
										l.GetType() == x.b2_dynamicBody)
									) {
										for (
											o = l.m_contactList;
											o &&
											c.m_contactCount !=
												c.m_contactCapacity;
											o = o.next
										)
											o.contact.m_flags &
												w.e_islandFlag ||
												(1 != o.contact.IsSensor() &&
													0 !=
														o.contact.IsEnabled() &&
													0 !=
														o.contact.IsTouching() &&
													(c.AddContact(o.contact),
													(o.contact.m_flags |=
														w.e_islandFlag),
													(m = o.other).m_flags &
														x.e_islandFlag ||
														(m.GetType() !=
															x.b2_staticBody &&
															(m.Advance(u),
															m.SetAwake(!0)),
														(a[g + y] = m),
														++y,
														(m.m_flags |=
															x.e_islandFlag))));
										for (
											var T = l.m_jointList;
											T;
											T = T.next
										)
											c.m_jointCount !=
												c.m_jointCapacity &&
												1 != T.joint.m_islandFlag &&
												0 != (m = T.other).IsActive() &&
												(c.AddJoint(T.joint),
												(T.joint.m_islandFlag = !0),
												m.m_flags & x.e_islandFlag ||
													(m.GetType() !=
														x.b2_staticBody &&
														(m.Advance(u),
														m.SetAwake(!0)),
													(a[g + y] = m),
													++y,
													(m.m_flags |=
														x.e_islandFlag)));
									}
								f = I.s_timestep;
								(f.warmStarting = !1),
									(f.dt = (1 - u) * t.dt),
									(f.inv_dt = 1 / f.dt),
									(f.dtRatio = 0),
									(f.velocityIterations =
										t.velocityIterations),
									(f.positionIterations =
										t.positionIterations),
									c.SolveTOI(f);
								for (var S = 0, S = 0; S < c.m_bodyCount; ++S)
									if (
										((l = c.m_bodies[S]),
										(l.m_flags &= ~x.e_islandFlag),
										0 != l.IsAwake() &&
											l.GetType() == x.b2_dynamicBody)
									)
										for (
											l.SynchronizeFixtures(),
												o = l.m_contactList;
											o;
											o = o.next
										)
											o.contact.m_flags &= ~w.e_toiFlag;
								for (S = 0; S < c.m_contactCount; ++S)
									(_ = c.m_contacts[S]).m_flags &= ~(
										w.e_toiFlag | w.e_islandFlag
									);
								for (S = 0; S < c.m_jointCount; ++S)
									(s = c.m_joints[S]).m_islandFlag = !1;
								this.m_contactManager.FindNewContacts();
							}
						} else
							n.m_sweep.Set(I.s_backupA),
								r.m_sweep.Set(I.s_backupB),
								n.SynchronizeTransform(),
								r.SynchronizeTransform();
					}
				}),
				(I.prototype.DrawJoint = function (t) {
					var e = t.GetBodyA(),
						i = t.GetBodyB(),
						n = e.m_xf,
						r = i.m_xf,
						o = n.position,
						s = r.position,
						c = t.GetAnchorA(),
						a = t.GetAnchorB(),
						l = I.s_jointColor;
					switch (t.m_type) {
						case O.e_distanceJoint:
							this.m_debugDraw.DrawSegment(c, a, l);
							break;
						case O.e_pulleyJoint:
							var h = t instanceof B ? t : null,
								u = h.GetGroundAnchorA(),
								h = h.GetGroundAnchorB();
							this.m_debugDraw.DrawSegment(u, c, l),
								this.m_debugDraw.DrawSegment(h, a, l),
								this.m_debugDraw.DrawSegment(u, h, l);
							break;
						case O.e_mouseJoint:
							this.m_debugDraw.DrawSegment(c, a, l);
							break;
						default:
							e != this.m_groundBody &&
								this.m_debugDraw.DrawSegment(o, c, l),
								this.m_debugDraw.DrawSegment(c, a, l),
								i != this.m_groundBody &&
									this.m_debugDraw.DrawSegment(s, a, l);
					}
				}),
				(I.prototype.DrawShape = function (t, e, i) {
					switch (t.m_type) {
						case y.e_circleShape:
							var n = t instanceof u ? t : null,
								r = p.MulX(e, n.m_p),
								o = n.m_radius,
								n = e.R.col1;
							this.m_debugDraw.DrawSolidCircle(r, o, n, i);
							break;
						case y.e_polygonShape:
							for (
								var s = 0,
									c = t instanceof d ? t : null,
									a = parseInt(c.GetVertexCount()),
									l = c.GetVertices(),
									h = new Vector(a),
									s = 0;
								s < a;
								++s
							)
								h[s] = p.MulX(e, l[s]);
							this.m_debugDraw.DrawSolidPolygon(h, a, i);
							break;
						case y.e_edgeShape:
							c = t instanceof _ ? t : null;
							this.m_debugDraw.DrawSegment(
								p.MulX(e, c.GetVertex1()),
								p.MulX(e, c.GetVertex2()),
								i
							);
					}
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Dynamics.b2World.s_timestep2 = new P()),
						(Box2D.Dynamics.b2World.s_xf = new o()),
						(Box2D.Dynamics.b2World.s_backupA = new t()),
						(Box2D.Dynamics.b2World.s_backupB = new t()),
						(Box2D.Dynamics.b2World.s_timestep = new P()),
						(Box2D.Dynamics.b2World.s_queue = new Vector()),
						(Box2D.Dynamics.b2World.s_jointColor = new m(
							0.5,
							0.8,
							0.8
						)),
						(Box2D.Dynamics.b2World.e_newFixture = 1),
						(Box2D.Dynamics.b2World.e_locked = 2);
				});
		})(),
		(function () {
			var i = Box2D.Collision.Shapes.b2CircleShape,
				n =
					(Box2D.Collision.Shapes.b2EdgeChainDef,
					Box2D.Collision.Shapes.b2EdgeShape),
				r =
					(Box2D.Collision.Shapes.b2MassData,
					Box2D.Collision.Shapes.b2PolygonShape),
				f = Box2D.Collision.Shapes.b2Shape,
				o = Box2D.Dynamics.Contacts.b2CircleContact,
				m = Box2D.Dynamics.Contacts.b2Contact,
				F = Box2D.Dynamics.Contacts.b2ContactConstraint,
				e = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
				t = Box2D.Dynamics.Contacts.b2ContactEdge,
				s = Box2D.Dynamics.Contacts.b2ContactFactory,
				c = Box2D.Dynamics.Contacts.b2ContactRegister,
				a = Box2D.Dynamics.Contacts.b2ContactResult,
				M = Box2D.Dynamics.Contacts.b2ContactSolver,
				l = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
				h = Box2D.Dynamics.Contacts.b2NullContact,
				u = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
				_ = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
				d = Box2D.Dynamics.Contacts.b2PolygonContact,
				p = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
				g = Box2D.Dynamics.b2Body,
				y =
					(Box2D.Dynamics.b2BodyDef,
					Box2D.Dynamics.b2ContactFilter,
					Box2D.Dynamics.b2ContactImpulse,
					Box2D.Dynamics.b2ContactListener,
					Box2D.Dynamics.b2ContactManager,
					Box2D.Dynamics.b2DebugDraw,
					Box2D.Dynamics.b2DestructionListener,
					Box2D.Dynamics.b2FilterData,
					Box2D.Dynamics.b2Fixture,
					Box2D.Dynamics.b2FixtureDef,
					Box2D.Dynamics.b2Island,
					Box2D.Dynamics.b2TimeStep),
				V =
					(Box2D.Dynamics.b2World,
					Box2D.Common.b2Color,
					Box2D.Common.b2internal,
					Box2D.Common.b2Settings),
				T = Box2D.Common.Math.b2Mat22,
				U = (Box2D.Common.Math.b2Mat33, Box2D.Common.Math.b2Math),
				S =
					(Box2D.Common.Math.b2Sweep,
					Box2D.Common.Math.b2Transform,
					Box2D.Common.Math.b2Vec2),
				C =
					(Box2D.Common.Math.b2Vec3,
					Box2D.Collision.b2AABB,
					Box2D.Collision.b2Bound,
					Box2D.Collision.b2BoundValues,
					Box2D.Collision.b2Collision),
				x = Box2D.Collision.b2ContactID,
				v =
					(Box2D.Collision.b2ContactPoint,
					Box2D.Collision.b2Distance,
					Box2D.Collision.b2DistanceInput,
					Box2D.Collision.b2DistanceOutput,
					Box2D.Collision.b2DistanceProxy,
					Box2D.Collision.b2DynamicTree,
					Box2D.Collision.b2DynamicTreeBroadPhase,
					Box2D.Collision.b2DynamicTreeNode,
					Box2D.Collision.b2DynamicTreePair,
					Box2D.Collision.b2Manifold),
				E =
					(Box2D.Collision.b2ManifoldPoint,
					Box2D.Collision.b2Point,
					Box2D.Collision.b2RayCastInput,
					Box2D.Collision.b2RayCastOutput,
					Box2D.Collision.b2Segment,
					Box2D.Collision.b2SeparationFunction,
					Box2D.Collision.b2Simplex,
					Box2D.Collision.b2SimplexCache,
					Box2D.Collision.b2SimplexVertex,
					Box2D.Collision.b2TimeOfImpact),
				A = Box2D.Collision.b2TOIInput,
				b = Box2D.Collision.b2WorldManifold;
			Box2D.Collision.ClipVertex,
				Box2D.Collision.Features,
				Box2D.Collision.IBroadPhase,
				Box2D.inherit(o, Box2D.Dynamics.Contacts.b2Contact),
				(o.prototype.__super =
					Box2D.Dynamics.Contacts.b2Contact.prototype),
				(o.b2CircleContact = function () {
					Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(
						this,
						arguments
					);
				}),
				(o.Create = function (t) {
					return new o();
				}),
				(o.Destroy = function (t, e) {}),
				(o.prototype.Reset = function (t, e) {
					this.__super.Reset.call(this, t, e);
				}),
				(o.prototype.Evaluate = function () {
					var t = this.m_fixtureA.GetBody(),
						e = this.m_fixtureB.GetBody();
					C.CollideCircles(
						this.m_manifold,
						this.m_fixtureA.GetShape() instanceof i
							? this.m_fixtureA.GetShape()
							: null,
						t.m_xf,
						this.m_fixtureB.GetShape() instanceof i
							? this.m_fixtureB.GetShape()
							: null,
						e.m_xf
					);
				}),
				(m.b2Contact = function () {
					(this.m_nodeA = new t()),
						(this.m_nodeB = new t()),
						(this.m_manifold = new v()),
						(this.m_oldManifold = new v());
				}),
				(m.prototype.GetManifold = function () {
					return this.m_manifold;
				}),
				(m.prototype.GetWorldManifold = function (t) {
					var e = this.m_fixtureA.GetBody(),
						i = this.m_fixtureB.GetBody(),
						n = this.m_fixtureA.GetShape(),
						r = this.m_fixtureB.GetShape();
					t.Initialize(
						this.m_manifold,
						e.GetTransform(),
						n.m_radius,
						i.GetTransform(),
						r.m_radius
					);
				}),
				(m.prototype.IsTouching = function () {
					return (
						(this.m_flags & m.e_touchingFlag) == m.e_touchingFlag
					);
				}),
				(m.prototype.IsContinuous = function () {
					return (
						(this.m_flags & m.e_continuousFlag) ==
						m.e_continuousFlag
					);
				}),
				(m.prototype.SetSensor = function (t) {
					t
						? (this.m_flags |= m.e_sensorFlag)
						: (this.m_flags &= ~m.e_sensorFlag);
				}),
				(m.prototype.IsSensor = function () {
					return (this.m_flags & m.e_sensorFlag) == m.e_sensorFlag;
				}),
				(m.prototype.SetEnabled = function (t) {
					t
						? (this.m_flags |= m.e_enabledFlag)
						: (this.m_flags &= ~m.e_enabledFlag);
				}),
				(m.prototype.IsEnabled = function () {
					return (this.m_flags & m.e_enabledFlag) == m.e_enabledFlag;
				}),
				(m.prototype.GetNext = function () {
					return this.m_next;
				}),
				(m.prototype.GetFixtureA = function () {
					return this.m_fixtureA;
				}),
				(m.prototype.GetFixtureB = function () {
					return this.m_fixtureB;
				}),
				(m.prototype.FlagForFiltering = function () {
					this.m_flags |= m.e_filterFlag;
				}),
				(m.prototype.b2Contact = function () {}),
				(m.prototype.Reset = function (t, e) {
					if (
						(void 0 === t && (t = null),
						void 0 === e && (e = null),
						(this.m_flags = m.e_enabledFlag),
						!t || !e)
					)
						return (
							(this.m_fixtureA = null),
							void (this.m_fixtureB = null)
						);
					(t.IsSensor() || e.IsSensor()) &&
						(this.m_flags |= m.e_sensorFlag);
					var i = t.GetBody(),
						n = e.GetBody();
					(i.GetType() != g.b2_dynamicBody ||
						i.IsBullet() ||
						n.GetType() != g.b2_dynamicBody ||
						n.IsBullet()) &&
						(this.m_flags |= m.e_continuousFlag),
						(this.m_fixtureA = t),
						(this.m_fixtureB = e),
						(this.m_manifold.m_pointCount = 0),
						(this.m_prev = null),
						(this.m_next = null),
						(this.m_nodeA.contact = null),
						(this.m_nodeA.prev = null),
						(this.m_nodeA.next = null),
						(this.m_nodeA.other = null),
						(this.m_nodeB.contact = null),
						(this.m_nodeB.prev = null),
						(this.m_nodeB.next = null),
						(this.m_nodeB.other = null);
				}),
				(m.prototype.Update = function (t) {
					var e = this.m_oldManifold;
					(this.m_oldManifold = this.m_manifold),
						(this.m_manifold = e),
						(this.m_flags |= m.e_enabledFlag);
					var i,
						n,
						r,
						o = !1,
						s =
							(this.m_flags & m.e_touchingFlag) ==
							m.e_touchingFlag,
						c = this.m_fixtureA.m_body,
						a = this.m_fixtureB.m_body,
						l = this.m_fixtureA.m_aabb.TestOverlap(
							this.m_fixtureB.m_aabb
						);
					if (this.m_flags & m.e_sensorFlag)
						l &&
							((i = this.m_fixtureA.GetShape()),
							(n = this.m_fixtureB.GetShape()),
							(r = c.GetTransform()),
							(e = a.GetTransform()),
							(o = f.TestOverlap(i, r, n, e))),
							(this.m_manifold.m_pointCount = 0);
					else {
						if (
							(c.GetType() != g.b2_dynamicBody ||
							c.IsBullet() ||
							a.GetType() != g.b2_dynamicBody ||
							a.IsBullet()
								? (this.m_flags |= m.e_continuousFlag)
								: (this.m_flags &= ~m.e_continuousFlag),
							l)
						) {
							this.Evaluate(),
								(o = 0 < this.m_manifold.m_pointCount);
							for (
								var h = 0;
								h < this.m_manifold.m_pointCount;
								++h
							) {
								var u = this.m_manifold.m_points[h];
								(u.m_normalImpulse = 0),
									(u.m_tangentImpulse = 0);
								for (
									var _ = u.m_id, d = 0;
									d < this.m_oldManifold.m_pointCount;
									++d
								) {
									var p = this.m_oldManifold.m_points[d];
									if (p.m_id.key == _.key) {
										(u.m_normalImpulse = p.m_normalImpulse),
											(u.m_tangentImpulse =
												p.m_tangentImpulse);
										break;
									}
								}
							}
						} else this.m_manifold.m_pointCount = 0;
						o != s && (c.SetAwake(!0), a.SetAwake(!0));
					}
					o
						? (this.m_flags |= m.e_touchingFlag)
						: (this.m_flags &= ~m.e_touchingFlag),
						0 == s && 1 == o && t.BeginContact(this),
						1 == s && 0 == o && t.EndContact(this),
						0 == (this.m_flags & m.e_sensorFlag) &&
							t.PreSolve(this, this.m_oldManifold);
				}),
				(m.prototype.Evaluate = function () {}),
				(m.prototype.ComputeTOI = function (t, e) {
					return (
						m.s_input.proxyA.Set(this.m_fixtureA.GetShape()),
						m.s_input.proxyB.Set(this.m_fixtureB.GetShape()),
						(m.s_input.sweepA = t),
						(m.s_input.sweepB = e),
						(m.s_input.tolerance = V.b2_linearSlop),
						E.TimeOfImpact(m.s_input)
					);
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag = 1),
						(Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag = 2),
						(Box2D.Dynamics.Contacts.b2Contact.e_islandFlag = 4),
						(Box2D.Dynamics.Contacts.b2Contact.e_toiFlag = 8),
						(Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag = 16),
						(Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag = 32),
						(Box2D.Dynamics.Contacts.b2Contact.e_filterFlag = 64),
						(Box2D.Dynamics.Contacts.b2Contact.s_input = new A());
				}),
				(F.b2ContactConstraint = function () {
					(this.localPlaneNormal = new S()),
						(this.localPoint = new S()),
						(this.normal = new S()),
						(this.normalMass = new T()),
						(this.K = new T());
				}),
				(F.prototype.b2ContactConstraint = function () {
					this.points = new Vector(V.b2_maxManifoldPoints);
					for (var t = 0; t < V.b2_maxManifoldPoints; t++)
						this.points[t] = new e();
				}),
				(e.b2ContactConstraintPoint = function () {
					(this.localPoint = new S()),
						(this.rA = new S()),
						(this.rB = new S());
				}),
				(t.b2ContactEdge = function () {}),
				(s.b2ContactFactory = function () {}),
				(s.prototype.b2ContactFactory = function (t) {
					(this.m_allocator = t), this.InitializeRegisters();
				}),
				(s.prototype.AddType = function (t, e, i, n) {
					void 0 === i && (i = 0),
						void 0 === n && (n = 0),
						(this.m_registers[i][n].createFcn = t),
						(this.m_registers[i][n].destroyFcn = e),
						(this.m_registers[i][n].primary = !0),
						i != n &&
							((this.m_registers[n][i].createFcn = t),
							(this.m_registers[n][i].destroyFcn = e),
							(this.m_registers[n][i].primary = !1));
				}),
				(s.prototype.InitializeRegisters = function () {
					this.m_registers = new Vector(f.e_shapeTypeCount);
					for (var t = 0; t < f.e_shapeTypeCount; t++) {
						this.m_registers[t] = new Vector(f.e_shapeTypeCount);
						for (var e = 0; e < f.e_shapeTypeCount; e++)
							this.m_registers[t][e] = new c();
					}
					this.AddType(
						o.Create,
						o.Destroy,
						f.e_circleShape,
						f.e_circleShape
					),
						this.AddType(
							u.Create,
							u.Destroy,
							f.e_polygonShape,
							f.e_circleShape
						),
						this.AddType(
							d.Create,
							d.Destroy,
							f.e_polygonShape,
							f.e_polygonShape
						),
						this.AddType(
							l.Create,
							l.Destroy,
							f.e_edgeShape,
							f.e_circleShape
						),
						this.AddType(
							_.Create,
							_.Destroy,
							f.e_polygonShape,
							f.e_edgeShape
						);
				}),
				(s.prototype.Create = function (t, e) {
					var i,
						n = parseInt(t.GetType()),
						r = parseInt(e.GetType()),
						n = this.m_registers[n][r];
					if (n.pool)
						return (
							(i = n.pool),
							(n.pool = i.m_next),
							n.poolCount--,
							i.Reset(t, e),
							i
						);
					r = n.createFcn;
					return null != r
						? (n.primary
								? (i = r(this.m_allocator)).Reset(t, e)
								: (i = r(this.m_allocator)).Reset(e, t),
						  i)
						: null;
				}),
				(s.prototype.Destroy = function (t) {
					0 < t.m_manifold.m_pointCount &&
						(t.m_fixtureA.m_body.SetAwake(!0),
						t.m_fixtureB.m_body.SetAwake(!0));
					var e = parseInt(t.m_fixtureA.GetType()),
						i = parseInt(t.m_fixtureB.GetType()),
						i = this.m_registers[e][i];
					i.poolCount++,
						(t.m_next = i.pool),
						(i.pool = t),
						(0, i.destroyFcn)(t, this.m_allocator);
				}),
				(c.b2ContactRegister = function () {}),
				(a.b2ContactResult = function () {
					(this.position = new S()),
						(this.normal = new S()),
						(this.id = new x());
				}),
				(M.b2ContactSolver = function () {
					(this.m_step = new y()),
						(this.m_constraints = new Vector());
				}),
				(M.prototype.b2ContactSolver = function () {}),
				(M.prototype.Initialize = function (t, e, i, n) {
					void 0 === i && (i = 0),
						this.m_step.Set(t),
						(this.m_allocator = n);
					var r = 0;
					for (
						this.m_constraintCount = i;
						this.m_constraints.length < this.m_constraintCount;

					)
						this.m_constraints[this.m_constraints.length] = new F();
					for (r = 0; r < i; ++r) {
						var o = (A = e[r]).m_fixtureA,
							s = A.m_fixtureB,
							c = o.m_shape,
							a = s.m_shape,
							l = c.m_radius,
							h = a.m_radius,
							u = o.m_body,
							_ = s.m_body,
							d = A.GetManifold(),
							p = V.b2MixFriction(
								o.GetFriction(),
								s.GetFriction()
							),
							f = V.b2MixRestitution(
								o.GetRestitution(),
								s.GetRestitution()
							),
							m = u.m_linearVelocity.x,
							g = u.m_linearVelocity.y,
							y = _.m_linearVelocity.x,
							T = _.m_linearVelocity.y,
							S = u.m_angularVelocity,
							C = _.m_angularVelocity;
						V.b2Assert(0 < d.m_pointCount),
							M.s_worldManifold.Initialize(
								d,
								u.m_xf,
								l,
								_.m_xf,
								h
							);
						var x = M.s_worldManifold.m_normal.x,
							v = M.s_worldManifold.m_normal.y,
							E = this.m_constraints[r];
						(E.bodyA = u),
							(E.bodyB = _),
							(E.manifold = d),
							(E.normal.x = x),
							(E.normal.y = v),
							(E.pointCount = d.m_pointCount),
							(E.friction = p),
							(E.restitution = f),
							(E.localPlaneNormal.x = d.m_localPlaneNormal.x),
							(E.localPlaneNormal.y = d.m_localPlaneNormal.y),
							(E.localPoint.x = d.m_localPoint.x),
							(E.localPoint.y = d.m_localPoint.y),
							(E.radius = l + h),
							(E.type = d.m_type);
						for (var A, b, R = 0; R < E.pointCount; ++R) {
							var P = d.m_points[R],
								I = E.points[R];
							(I.normalImpulse = P.m_normalImpulse),
								(I.tangentImpulse = P.m_tangentImpulse),
								I.localPoint.SetV(P.m_localPoint);
							var w = (I.rA.x =
									M.s_worldManifold.m_points[R].x -
									u.m_sweep.c.x),
								D = (I.rA.y =
									M.s_worldManifold.m_points[R].y -
									u.m_sweep.c.y),
								L = (I.rB.x =
									M.s_worldManifold.m_points[R].x -
									_.m_sweep.c.x),
								O = (I.rB.y =
									M.s_worldManifold.m_points[R].y -
									_.m_sweep.c.y),
								B = w * v - D * x,
								N = L * v - O * x;
							(B *= B), (N *= N);
							P =
								u.m_invMass +
								_.m_invMass +
								u.m_invI * B +
								_.m_invI * N;
							I.normalMass = 1 / P;
							P = u.m_mass * u.m_invMass + _.m_mass * _.m_invMass;
							(P +=
								u.m_mass * u.m_invI * B +
								_.m_mass * _.m_invI * N),
								(I.equalizedMass = 1 / P);
							(N = -x), (P = w * N - D * v), (N = L * N - O * v);
							(P *= P), (N *= N);
							N =
								u.m_invMass +
								_.m_invMass +
								u.m_invI * P +
								_.m_invI * N;
							(I.tangentMass = 1 / N), (I.velocityBias = 0);
							(D = y + -C * O - m - -S * D),
								(w = T + C * L - g - S * w),
								(w = E.normal.x * D + E.normal.y * w);
							w < -V.b2_velocityThreshold &&
								(I.velocityBias += -E.restitution * w);
						}
						2 == E.pointCount &&
							((b = E.points[0]),
							(c = E.points[1]),
							(a = u.m_invMass),
							(A = u.m_invI),
							(o = _.m_invMass),
							(s = _.m_invI),
							(l =
								a +
								o +
								A * (p = b.rA.x * v - b.rA.y * x) * p +
								s * (f = b.rB.x * v - b.rB.y * x) * f) *
								l <
							100 *
								(l *
									(c =
										a +
										o +
										A * (h = c.rA.x * v - c.rA.y * x) * h +
										s * (b = c.rB.x * v - c.rB.y * x) * b) -
									(b = a + o + A * p * h + s * f * b) * b)
								? (E.K.col1.Set(l, b),
								  E.K.col2.Set(b, c),
								  E.K.GetInverse(E.normalMass))
								: (E.pointCount = 1));
					}
				}),
				(M.prototype.InitVelocityConstraints = function (t) {
					for (var e = 0; e < this.m_constraintCount; ++e) {
						var i = this.m_constraints[e],
							n = i.bodyA,
							r = i.bodyB,
							o = n.m_invMass,
							s = n.m_invI,
							c = r.m_invMass,
							a = r.m_invI,
							l = i.normal.x,
							h = i.normal.y,
							u = h,
							_ = -l,
							d = 0,
							p = 0;
						if (t.warmStarting)
							for (p = i.pointCount, d = 0; d < p; ++d) {
								var f = i.points[d];
								(f.normalImpulse *= t.dtRatio),
									(f.tangentImpulse *= t.dtRatio);
								var m =
										f.normalImpulse * l +
										f.tangentImpulse * u,
									g =
										f.normalImpulse * h +
										f.tangentImpulse * _;
								(n.m_angularVelocity -=
									s * (f.rA.x * g - f.rA.y * m)),
									(n.m_linearVelocity.x -= o * m),
									(n.m_linearVelocity.y -= o * g),
									(r.m_angularVelocity +=
										a * (f.rB.x * g - f.rB.y * m)),
									(r.m_linearVelocity.x += c * m),
									(r.m_linearVelocity.y += c * g);
							}
						else
							for (p = i.pointCount, d = 0; d < p; ++d) {
								var y = i.points[d];
								(y.normalImpulse = 0), (y.tangentImpulse = 0);
							}
					}
				}),
				(M.prototype.SolveVelocityConstraints = function () {
					for (
						var t,
							e,
							i,
							n,
							r = 0,
							o = 0,
							s = 0,
							c = 0,
							a = 0,
							l = 0,
							h = 0,
							u = 0,
							_ = 0,
							d = 0,
							p = 0,
							f = 0;
						f < this.m_constraintCount;
						++f
					) {
						for (
							var m = this.m_constraints[f],
								g = m.bodyA,
								y = m.bodyB,
								T = g.m_angularVelocity,
								S = y.m_angularVelocity,
								C = g.m_linearVelocity,
								x = y.m_linearVelocity,
								v = g.m_invMass,
								E = g.m_invI,
								A = y.m_invMass,
								b = y.m_invI,
								R = m.normal.x,
								P = m.normal.y,
								I = P,
								w = -R,
								D = m.friction,
								r = 0;
							r < m.pointCount;
							r++
						)
							(t = m.points[r]),
								(i =
									(x.x - S * t.rB.y - C.x + T * t.rA.y) * I +
									(x.y + S * t.rB.x - C.y - T * t.rA.x) * w),
								(o = t.tangentMass * -i),
								(n = D * t.normalImpulse),
								(c =
									(o =
										(s = U.Clamp(
											t.tangentImpulse + o,
											-n,
											n
										)) - t.tangentImpulse) * I),
								(a = o * w),
								(C.x -= v * c),
								(C.y -= v * a),
								(T -= E * (t.rA.x * a - t.rA.y * c)),
								(x.x += A * c),
								(x.y += A * a),
								(S += b * (t.rB.x * a - t.rB.y * c)),
								(t.tangentImpulse = s);
						parseInt(m.pointCount);
						if (1 == m.pointCount)
							(t = m.points[0]),
								(e =
									(x.x + -S * t.rB.y - C.x - -T * t.rA.y) *
										R +
									(x.y + S * t.rB.x - C.y - T * t.rA.x) * P),
								(o = -t.normalMass * (e - t.velocityBias)),
								(c =
									(o =
										(s =
											0 < (s = t.normalImpulse + o)
												? s
												: 0) - t.normalImpulse) * R),
								(a = o * P),
								(C.x -= v * c),
								(C.y -= v * a),
								(T -= E * (t.rA.x * a - t.rA.y * c)),
								(x.x += A * c),
								(x.y += A * a),
								(S += b * (t.rB.x * a - t.rB.y * c)),
								(t.normalImpulse = s);
						else {
							var L,
								O = m.points[0],
								B = m.points[1],
								N = O.normalImpulse,
								F = B.normalImpulse,
								M =
									(x.x - S * O.rB.y - C.x + T * O.rA.y) * R +
									(x.y + S * O.rB.x - C.y - T * O.rA.x) * P,
								V =
									(x.x - S * B.rB.y - C.x + T * B.rA.y) * R +
									(x.y + S * B.rB.x - C.y - T * B.rA.x) * P,
								k = M - O.velocityBias,
								G = V - B.velocityBias;
							(k -= (L = m.K).col1.x * N + L.col2.x * F),
								(G -= L.col1.y * N + L.col2.y * F);
							for (;;) {
								var W = -(
										(L = m.normalMass).col1.x * k +
										L.col2.x * G
									),
									z = -(L.col1.y * k + L.col2.y * G);
								if (0 <= W && 0 <= z) {
									(u = (l = W - N) * R),
										(_ = l * P),
										(d = (h = z - F) * R),
										(p = h * P),
										(C.x -= v * (u + d)),
										(C.y -= v * (_ + p)),
										(T -=
											E *
											(O.rA.x * _ -
												O.rA.y * u +
												B.rA.x * p -
												B.rA.y * d)),
										(x.x += A * (u + d)),
										(x.y += A * (_ + p)),
										(S +=
											b *
											(O.rB.x * _ -
												O.rB.y * u +
												B.rB.x * p -
												B.rB.y * d)),
										(O.normalImpulse = W),
										(B.normalImpulse = z);
									break;
								}
								if (
									((W = -O.normalMass * k),
									(M = z = 0),
									(V = m.K.col1.y * W + G),
									0 <= W && 0 <= V)
								) {
									(u = (l = W - N) * R),
										(_ = l * P),
										(d = (h = z - F) * R),
										(p = h * P),
										(C.x -= v * (u + d)),
										(C.y -= v * (_ + p)),
										(T -=
											E *
											(O.rA.x * _ -
												O.rA.y * u +
												B.rA.x * p -
												B.rA.y * d)),
										(x.x += A * (u + d)),
										(x.y += A * (_ + p)),
										(S +=
											b *
											(O.rB.x * _ -
												O.rB.y * u +
												B.rB.x * p -
												B.rB.y * d)),
										(O.normalImpulse = W),
										(B.normalImpulse = z);
									break;
								}
								if (
									((W = 0),
									(z = -B.normalMass * G),
									(M = m.K.col2.x * z + k),
									(V = 0) <= z && 0 <= M)
								) {
									(u = (l = W - N) * R),
										(_ = l * P),
										(d = (h = z - F) * R),
										(p = h * P),
										(C.x -= v * (u + d)),
										(C.y -= v * (_ + p)),
										(T -=
											E *
											(O.rA.x * _ -
												O.rA.y * u +
												B.rA.x * p -
												B.rA.y * d)),
										(x.x += A * (u + d)),
										(x.y += A * (_ + p)),
										(S +=
											b *
											(O.rB.x * _ -
												O.rB.y * u +
												B.rB.x * p -
												B.rB.y * d)),
										(O.normalImpulse = W),
										(B.normalImpulse = z);
									break;
								}
								if (
									((V = G), (z = W = 0) <= (M = k) && 0 <= V)
								) {
									(u = (l = W - N) * R),
										(_ = l * P),
										(d = (h = z - F) * R),
										(p = h * P),
										(C.x -= v * (u + d)),
										(C.y -= v * (_ + p)),
										(T -=
											E *
											(O.rA.x * _ -
												O.rA.y * u +
												B.rA.x * p -
												B.rA.y * d)),
										(x.x += A * (u + d)),
										(x.y += A * (_ + p)),
										(S +=
											b *
											(O.rB.x * _ -
												O.rB.y * u +
												B.rB.x * p -
												B.rB.y * d)),
										(O.normalImpulse = W),
										(B.normalImpulse = z);
									break;
								}
								break;
							}
						}
						(g.m_angularVelocity = T), (y.m_angularVelocity = S);
					}
				}),
				(M.prototype.FinalizeVelocityConstraints = function () {
					for (var t = 0; t < this.m_constraintCount; ++t)
						for (
							var e = this.m_constraints[t],
								i = e.manifold,
								n = 0;
							n < e.pointCount;
							++n
						) {
							var r = i.m_points[n],
								o = e.points[n];
							(r.m_normalImpulse = o.normalImpulse),
								(r.m_tangentImpulse = o.tangentImpulse);
						}
				}),
				(M.prototype.SolvePositionConstraints = function (t) {
					void 0 === t && (t = 0);
					for (var e = 0, i = 0; i < this.m_constraintCount; i++) {
						var n = this.m_constraints[i],
							r = n.bodyA,
							o = n.bodyB,
							s = r.m_mass * r.m_invMass,
							c = r.m_mass * r.m_invI,
							a = o.m_mass * o.m_invMass,
							l = o.m_mass * o.m_invI;
						M.s_psm.Initialize(n);
						for (
							var h = M.s_psm.m_normal, u = 0;
							u < n.pointCount;
							u++
						) {
							var _ = n.points[u],
								d = M.s_psm.m_points[u],
								p = M.s_psm.m_separations[u],
								f = d.x - r.m_sweep.c.x,
								m = d.y - r.m_sweep.c.y,
								g = d.x - o.m_sweep.c.x,
								d = d.y - o.m_sweep.c.y,
								e = e < p ? e : p,
								p = U.Clamp(
									t * (p + V.b2_linearSlop),
									-V.b2_maxLinearCorrection,
									0
								),
								_ = -_.equalizedMass * p,
								p = _ * h.x,
								_ = _ * h.y;
							(r.m_sweep.c.x -= s * p),
								(r.m_sweep.c.y -= s * _),
								(r.m_sweep.a -= c * (f * _ - m * p)),
								r.SynchronizeTransform(),
								(o.m_sweep.c.x += a * p),
								(o.m_sweep.c.y += a * _),
								(o.m_sweep.a += l * (g * _ - d * p)),
								o.SynchronizeTransform();
						}
					}
					return e > -1.5 * V.b2_linearSlop;
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold =
						new b()),
						(Box2D.Dynamics.Contacts.b2ContactSolver.s_psm =
							new p());
				}),
				Box2D.inherit(l, Box2D.Dynamics.Contacts.b2Contact),
				(l.prototype.__super =
					Box2D.Dynamics.Contacts.b2Contact.prototype),
				(l.b2EdgeAndCircleContact = function () {
					Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(
						this,
						arguments
					);
				}),
				(l.Create = function (t) {
					return new l();
				}),
				(l.Destroy = function (t, e) {}),
				(l.prototype.Reset = function (t, e) {
					this.__super.Reset.call(this, t, e);
				}),
				(l.prototype.Evaluate = function () {
					var t = this.m_fixtureA.GetBody(),
						e = this.m_fixtureB.GetBody();
					this.b2CollideEdgeAndCircle(
						this.m_manifold,
						this.m_fixtureA.GetShape() instanceof n
							? this.m_fixtureA.GetShape()
							: null,
						t.m_xf,
						this.m_fixtureB.GetShape() instanceof i
							? this.m_fixtureB.GetShape()
							: null,
						e.m_xf
					);
				}),
				(l.prototype.b2CollideEdgeAndCircle = function (
					t,
					e,
					i,
					n,
					r
				) {}),
				Box2D.inherit(h, Box2D.Dynamics.Contacts.b2Contact),
				(h.prototype.__super =
					Box2D.Dynamics.Contacts.b2Contact.prototype),
				(h.b2NullContact = function () {
					Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(
						this,
						arguments
					);
				}),
				(h.prototype.b2NullContact = function () {
					this.__super.b2Contact.call(this);
				}),
				(h.prototype.Evaluate = function () {}),
				Box2D.inherit(u, Box2D.Dynamics.Contacts.b2Contact),
				(u.prototype.__super =
					Box2D.Dynamics.Contacts.b2Contact.prototype),
				(u.b2PolyAndCircleContact = function () {
					Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(
						this,
						arguments
					);
				}),
				(u.Create = function (t) {
					return new u();
				}),
				(u.Destroy = function (t, e) {}),
				(u.prototype.Reset = function (t, e) {
					this.__super.Reset.call(this, t, e),
						V.b2Assert(t.GetType() == f.e_polygonShape),
						V.b2Assert(e.GetType() == f.e_circleShape);
				}),
				(u.prototype.Evaluate = function () {
					var t = this.m_fixtureA.m_body,
						e = this.m_fixtureB.m_body;
					C.CollidePolygonAndCircle(
						this.m_manifold,
						this.m_fixtureA.GetShape() instanceof r
							? this.m_fixtureA.GetShape()
							: null,
						t.m_xf,
						this.m_fixtureB.GetShape() instanceof i
							? this.m_fixtureB.GetShape()
							: null,
						e.m_xf
					);
				}),
				Box2D.inherit(_, Box2D.Dynamics.Contacts.b2Contact),
				(_.prototype.__super =
					Box2D.Dynamics.Contacts.b2Contact.prototype),
				(_.b2PolyAndEdgeContact = function () {
					Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(
						this,
						arguments
					);
				}),
				(_.Create = function (t) {
					return new _();
				}),
				(_.Destroy = function (t, e) {}),
				(_.prototype.Reset = function (t, e) {
					this.__super.Reset.call(this, t, e),
						V.b2Assert(t.GetType() == f.e_polygonShape),
						V.b2Assert(e.GetType() == f.e_edgeShape);
				}),
				(_.prototype.Evaluate = function () {
					var t = this.m_fixtureA.GetBody(),
						e = this.m_fixtureB.GetBody();
					this.b2CollidePolyAndEdge(
						this.m_manifold,
						this.m_fixtureA.GetShape() instanceof r
							? this.m_fixtureA.GetShape()
							: null,
						t.m_xf,
						this.m_fixtureB.GetShape() instanceof n
							? this.m_fixtureB.GetShape()
							: null,
						e.m_xf
					);
				}),
				(_.prototype.b2CollidePolyAndEdge = function (
					t,
					e,
					i,
					n,
					r
				) {}),
				Box2D.inherit(d, Box2D.Dynamics.Contacts.b2Contact),
				(d.prototype.__super =
					Box2D.Dynamics.Contacts.b2Contact.prototype),
				(d.b2PolygonContact = function () {
					Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(
						this,
						arguments
					);
				}),
				(d.Create = function (t) {
					return new d();
				}),
				(d.Destroy = function (t, e) {}),
				(d.prototype.Reset = function (t, e) {
					this.__super.Reset.call(this, t, e);
				}),
				(d.prototype.Evaluate = function () {
					var t = this.m_fixtureA.GetBody(),
						e = this.m_fixtureB.GetBody();
					C.CollidePolygons(
						this.m_manifold,
						this.m_fixtureA.GetShape() instanceof r
							? this.m_fixtureA.GetShape()
							: null,
						t.m_xf,
						this.m_fixtureB.GetShape() instanceof r
							? this.m_fixtureB.GetShape()
							: null,
						e.m_xf
					);
				}),
				(p.b2PositionSolverManifold = function () {}),
				(p.prototype.b2PositionSolverManifold = function () {
					(this.m_normal = new S()),
						(this.m_separations = new Vector_a2j_Number(
							V.b2_maxManifoldPoints
						)),
						(this.m_points = new Vector(V.b2_maxManifoldPoints));
					for (var t = 0; t < V.b2_maxManifoldPoints; t++)
						this.m_points[t] = new S();
				}),
				(p.prototype.Initialize = function (t) {
					V.b2Assert(0 < t.pointCount);
					var e = 0,
						i = 0,
						n = 0,
						r = 0,
						o = 0;
					switch (t.type) {
						case v.e_circles:
							(a = t.bodyA.m_xf.R), (l = t.localPoint);
							var s =
									t.bodyA.m_xf.position.x +
									(a.col1.x * l.x + a.col2.x * l.y),
								c =
									t.bodyA.m_xf.position.y +
									(a.col1.y * l.x + a.col2.y * l.y),
								a = t.bodyB.m_xf.R,
								l = t.points[0].localPoint,
								h =
									t.bodyB.m_xf.position.x +
									(a.col1.x * l.x + a.col2.x * l.y),
								u =
									t.bodyB.m_xf.position.y +
									(a.col1.y * l.x + a.col2.y * l.y),
								_ = h - s,
								d = u - c,
								p = _ * _ + d * d;
							p > Number.MIN_VALUE * Number.MIN_VALUE
								? ((p = Math.sqrt(p)),
								  (this.m_normal.x = _ / p),
								  (this.m_normal.y = d / p))
								: ((this.m_normal.x = 1),
								  (this.m_normal.y = 0)),
								(this.m_points[0].x = 0.5 * (s + h)),
								(this.m_points[0].y = 0.5 * (c + u)),
								(this.m_separations[0] =
									_ * this.m_normal.x +
									d * this.m_normal.y -
									t.radius);
							break;
						case v.e_faceA:
							for (
								a = t.bodyA.m_xf.R,
									l = t.localPlaneNormal,
									this.m_normal.x =
										a.col1.x * l.x + a.col2.x * l.y,
									this.m_normal.y =
										a.col1.y * l.x + a.col2.y * l.y,
									a = t.bodyA.m_xf.R,
									l = t.localPoint,
									r =
										t.bodyA.m_xf.position.x +
										(a.col1.x * l.x + a.col2.x * l.y),
									o =
										t.bodyA.m_xf.position.y +
										(a.col1.y * l.x + a.col2.y * l.y),
									a = t.bodyB.m_xf.R,
									e = 0;
								e < t.pointCount;
								++e
							)
								(l = t.points[e].localPoint),
									(i =
										t.bodyB.m_xf.position.x +
										(a.col1.x * l.x + a.col2.x * l.y)),
									(n =
										t.bodyB.m_xf.position.y +
										(a.col1.y * l.x + a.col2.y * l.y)),
									(this.m_separations[e] =
										(i - r) * this.m_normal.x +
										(n - o) * this.m_normal.y -
										t.radius),
									(this.m_points[e].x = i),
									(this.m_points[e].y = n);
							break;
						case v.e_faceB:
							for (
								a = t.bodyB.m_xf.R,
									l = t.localPlaneNormal,
									this.m_normal.x =
										a.col1.x * l.x + a.col2.x * l.y,
									this.m_normal.y =
										a.col1.y * l.x + a.col2.y * l.y,
									a = t.bodyB.m_xf.R,
									l = t.localPoint,
									r =
										t.bodyB.m_xf.position.x +
										(a.col1.x * l.x + a.col2.x * l.y),
									o =
										t.bodyB.m_xf.position.y +
										(a.col1.y * l.x + a.col2.y * l.y),
									a = t.bodyA.m_xf.R,
									e = 0;
								e < t.pointCount;
								++e
							)
								(l = t.points[e].localPoint),
									(i =
										t.bodyA.m_xf.position.x +
										(a.col1.x * l.x + a.col2.x * l.y)),
									(n =
										t.bodyA.m_xf.position.y +
										(a.col1.y * l.x + a.col2.y * l.y)),
									(this.m_separations[e] =
										(i - r) * this.m_normal.x +
										(n - o) * this.m_normal.y -
										t.radius),
									this.m_points[e].Set(i, n);
							(this.m_normal.x *= -1), (this.m_normal.y *= -1);
					}
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA =
						new S()),
						(Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB =
							new S());
				});
		})(),
		(function () {
			Box2D.Dynamics.b2Body,
				Box2D.Dynamics.b2BodyDef,
				Box2D.Dynamics.b2ContactFilter,
				Box2D.Dynamics.b2ContactImpulse,
				Box2D.Dynamics.b2ContactListener,
				Box2D.Dynamics.b2ContactManager,
				Box2D.Dynamics.b2DebugDraw,
				Box2D.Dynamics.b2DestructionListener,
				Box2D.Dynamics.b2FilterData,
				Box2D.Dynamics.b2Fixture,
				Box2D.Dynamics.b2FixtureDef,
				Box2D.Dynamics.b2Island,
				Box2D.Dynamics.b2TimeStep,
				Box2D.Dynamics.b2World;
			var t = Box2D.Common.Math.b2Mat22,
				o = (Box2D.Common.Math.b2Mat33, Box2D.Common.Math.b2Math),
				_ =
					(Box2D.Common.Math.b2Sweep,
					Box2D.Common.Math.b2Transform,
					Box2D.Common.Math.b2Vec2),
				r = (Box2D.Common.Math.b2Vec3, Box2D.Common.b2Color),
				e =
					(Box2D.Common.b2internal,
					Box2D.Common.b2Settings,
					Box2D.Collision.Shapes.b2CircleShape,
					Box2D.Collision.Shapes.b2EdgeChainDef,
					Box2D.Collision.Shapes.b2EdgeShape,
					Box2D.Collision.Shapes.b2MassData,
					Box2D.Collision.Shapes.b2PolygonShape,
					Box2D.Collision.Shapes.b2Shape,
					Box2D.Dynamics.Controllers.b2BuoyancyController),
				i = Box2D.Dynamics.Controllers.b2ConstantAccelController,
				n = Box2D.Dynamics.Controllers.b2ConstantForceController,
				s = Box2D.Dynamics.Controllers.b2Controller,
				c = Box2D.Dynamics.Controllers.b2ControllerEdge,
				a = Box2D.Dynamics.Controllers.b2GravityController,
				l = Box2D.Dynamics.Controllers.b2TensorDampingController;
			Box2D.inherit(e, Box2D.Dynamics.Controllers.b2Controller),
				(e.prototype.__super =
					Box2D.Dynamics.Controllers.b2Controller.prototype),
				(e.b2BuoyancyController = function () {
					Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(
						this,
						arguments
					),
						(this.normal = new _(0, -1)),
						(this.offset = 0),
						(this.density = 0),
						(this.velocity = new _(0, 0)),
						(this.linearDrag = 2),
						(this.angularDrag = 1),
						(this.useDensity = !1),
						(this.useWorldGravity = !0),
						(this.gravity = null);
				}),
				(e.prototype.Step = function (t) {
					if (this.m_bodyList) {
						this.useWorldGravity &&
							(this.gravity = this.GetWorld()
								.GetGravity()
								.Copy());
						for (var e = this.m_bodyList; e; e = e.nextBody) {
							var i = e.body;
							if (0 != i.IsAwake()) {
								for (
									var n,
										r = new _(),
										o = new _(),
										s = 0,
										c = 0,
										a = i.GetFixtureList();
									a;
									a = a.GetNext()
								) {
									var l = new _(),
										h = a
											.GetShape()
											.ComputeSubmergedArea(
												this.normal,
												this.offset,
												i.GetTransform(),
												l
											);
									(s += h),
										(r.x += h * l.x),
										(r.y += h * l.y);
									var u = 0;
									(c += h * (u = (this.useDensity, 1))),
										(o.x += h * l.x * u),
										(o.y += h * l.y * u);
								}
								(r.x /= s),
									(r.y /= s),
									(o.x /= c),
									(o.y /= c),
									s < Number.MIN_VALUE ||
										((n =
											this.gravity.GetNegative()).Multiply(
											this.density * s
										),
										i.ApplyForce(n, o),
										(n =
											i.GetLinearVelocityFromWorldPoint(
												r
											)).Subtract(this.velocity),
										n.Multiply(-this.linearDrag * s),
										i.ApplyForce(n, r),
										i.ApplyTorque(
											(-i.GetInertia() / i.GetMass()) *
												s *
												i.GetAngularVelocity() *
												this.angularDrag
										));
							}
						}
					}
				}),
				(e.prototype.Draw = function (t) {
					var e = new _(),
						i = new _();
					(e.x = this.normal.x * this.offset + 1e3 * this.normal.y),
						(e.y =
							this.normal.y * this.offset - 1e3 * this.normal.x),
						(i.x =
							this.normal.x * this.offset - 1e3 * this.normal.y),
						(i.y =
							this.normal.y * this.offset + 1e3 * this.normal.x);
					var n = new r(0, 0, 1);
					t.DrawSegment(e, i, n);
				}),
				Box2D.inherit(i, Box2D.Dynamics.Controllers.b2Controller),
				(i.prototype.__super =
					Box2D.Dynamics.Controllers.b2Controller.prototype),
				(i.b2ConstantAccelController = function () {
					Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(
						this,
						arguments
					),
						(this.A = new _(0, 0));
				}),
				(i.prototype.Step = function (t) {
					for (
						var e = new _(this.A.x * t.dt, this.A.y * t.dt),
							i = this.m_bodyList;
						i;
						i = i.nextBody
					) {
						var n = i.body;
						n.IsAwake() &&
							n.SetLinearVelocity(
								new _(
									n.GetLinearVelocity().x + e.x,
									n.GetLinearVelocity().y + e.y
								)
							);
					}
				}),
				Box2D.inherit(n, Box2D.Dynamics.Controllers.b2Controller),
				(n.prototype.__super =
					Box2D.Dynamics.Controllers.b2Controller.prototype),
				(n.b2ConstantForceController = function () {
					Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(
						this,
						arguments
					),
						(this.F = new _(0, 0));
				}),
				(n.prototype.Step = function (t) {
					for (var e = this.m_bodyList; e; e = e.nextBody) {
						var i = e.body;
						i.IsAwake() && i.ApplyForce(this.F, i.GetWorldCenter());
					}
				}),
				(s.b2Controller = function () {}),
				(s.prototype.Step = function (t) {}),
				(s.prototype.Draw = function (t) {}),
				(s.prototype.AddBody = function (t) {
					var e = new c();
					(e.controller = this),
						(e.body = t),
						(e.nextBody = this.m_bodyList),
						(e.prevBody = null),
						(this.m_bodyList = e).nextBody &&
							(e.nextBody.prevBody = e),
						this.m_bodyCount++,
						(e.nextController = t.m_controllerList),
						(e.prevController = null),
						(t.m_controllerList = e).nextController &&
							(e.nextController.prevController = e),
						t.m_controllerCount++;
				}),
				(s.prototype.RemoveBody = function (t) {
					for (
						var e = t.m_controllerList;
						e && e.controller != this;

					)
						e = e.nextController;
					e.prevBody && (e.prevBody.nextBody = e.nextBody),
						e.nextBody && (e.nextBody.prevBody = e.prevBody),
						e.nextController &&
							(e.nextController.prevController =
								e.prevController),
						e.prevController &&
							(e.prevController.nextController =
								e.nextController),
						this.m_bodyList == e && (this.m_bodyList = e.nextBody),
						t.m_controllerList == e &&
							(t.m_controllerList = e.nextController),
						t.m_controllerCount--,
						this.m_bodyCount--;
				}),
				(s.prototype.Clear = function () {
					for (; this.m_bodyList; )
						this.RemoveBody(this.m_bodyList.body);
				}),
				(s.prototype.GetNext = function () {
					return this.m_next;
				}),
				(s.prototype.GetWorld = function () {
					return this.m_world;
				}),
				(s.prototype.GetBodyList = function () {
					return this.m_bodyList;
				}),
				(c.b2ControllerEdge = function () {}),
				Box2D.inherit(a, Box2D.Dynamics.Controllers.b2Controller),
				(a.prototype.__super =
					Box2D.Dynamics.Controllers.b2Controller.prototype),
				(a.b2GravityController = function () {
					Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(
						this,
						arguments
					),
						(this.G = 1),
						(this.invSqr = !0);
				}),
				(a.prototype.Step = function (t) {
					var e = null,
						i = null,
						n = null,
						r = 0,
						o = null,
						s = null,
						c = null,
						a = 0,
						l = 0,
						h = 0,
						u = null;
					if (this.invSqr)
						for (e = this.m_bodyList; e; e = e.nextBody)
							for (
								n = (i = e.body).GetWorldCenter(),
									r = i.GetMass(),
									o = this.m_bodyList;
								o != e;
								o = o.nextBody
							)
								(h =
									(a =
										(c = (s = o.body).GetWorldCenter()).x -
										n.x) *
										a +
									(l = c.y - n.y) * l) < Number.MIN_VALUE ||
									((u = new _(a, l)).Multiply(
										(this.G / h / Math.sqrt(h)) *
											r *
											s.GetMass()
									),
									i.IsAwake() && i.ApplyForce(u, n),
									u.Multiply(-1),
									s.IsAwake() && s.ApplyForce(u, c));
					else
						for (e = this.m_bodyList; e; e = e.nextBody)
							for (
								n = (i = e.body).GetWorldCenter(),
									r = i.GetMass(),
									o = this.m_bodyList;
								o != e;
								o = o.nextBody
							)
								(h =
									(a =
										(c = (s = o.body).GetWorldCenter()).x -
										n.x) *
										a +
									(l = c.y - n.y) * l) < Number.MIN_VALUE ||
									((u = new _(a, l)).Multiply(
										(this.G / h) * r * s.GetMass()
									),
									i.IsAwake() && i.ApplyForce(u, n),
									u.Multiply(-1),
									s.IsAwake() && s.ApplyForce(u, c));
				}),
				Box2D.inherit(l, Box2D.Dynamics.Controllers.b2Controller),
				(l.prototype.__super =
					Box2D.Dynamics.Controllers.b2Controller.prototype),
				(l.b2TensorDampingController = function () {
					Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(
						this,
						arguments
					),
						(this.T = new t()),
						(this.maxTimestep = 0);
				}),
				(l.prototype.SetAxisAligned = function (t, e) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						(this.T.col1.x = -t),
						(this.T.col1.y = 0),
						(this.T.col2.x = 0),
						(this.T.col2.y = -e),
						(this.maxTimestep =
							0 < t || 0 < e ? 1 / Math.max(t, e) : 0);
				}),
				(l.prototype.Step = function (t) {
					var e = t.dt;
					if (!(e <= Number.MIN_VALUE)) {
						e > this.maxTimestep &&
							0 < this.maxTimestep &&
							(e = this.maxTimestep);
						for (var i = this.m_bodyList; i; i = i.nextBody) {
							var n,
								r = i.body;
							r.IsAwake() &&
								((n = r.GetWorldVector(
									o.MulMV(
										this.T,
										r.GetLocalVector(r.GetLinearVelocity())
									)
								)),
								r.SetLinearVelocity(
									new _(
										r.GetLinearVelocity().x + n.x * e,
										r.GetLinearVelocity().y + n.y * e
									)
								));
						}
					}
				});
		})(),
		(function () {
			Box2D.Common.b2Color, Box2D.Common.b2internal;
			var v = Box2D.Common.b2Settings,
				E = Box2D.Common.Math.b2Mat22,
				e = Box2D.Common.Math.b2Mat33,
				A = Box2D.Common.Math.b2Math,
				b =
					(Box2D.Common.Math.b2Sweep,
					Box2D.Common.Math.b2Transform,
					Box2D.Common.Math.b2Vec2),
				R = Box2D.Common.Math.b2Vec3,
				n = Box2D.Dynamics.Joints.b2DistanceJoint,
				r = Box2D.Dynamics.Joints.b2DistanceJointDef,
				o = Box2D.Dynamics.Joints.b2FrictionJoint,
				s = Box2D.Dynamics.Joints.b2FrictionJointDef,
				c = Box2D.Dynamics.Joints.b2GearJoint,
				a = Box2D.Dynamics.Joints.b2GearJointDef,
				t = Box2D.Dynamics.Joints.b2Jacobian,
				C = Box2D.Dynamics.Joints.b2Joint,
				i = Box2D.Dynamics.Joints.b2JointDef,
				l = Box2D.Dynamics.Joints.b2JointEdge,
				h = Box2D.Dynamics.Joints.b2LineJoint,
				u = Box2D.Dynamics.Joints.b2LineJointDef,
				_ = Box2D.Dynamics.Joints.b2MouseJoint,
				d = Box2D.Dynamics.Joints.b2MouseJointDef,
				p = Box2D.Dynamics.Joints.b2PrismaticJoint,
				f = Box2D.Dynamics.Joints.b2PrismaticJointDef,
				m = Box2D.Dynamics.Joints.b2PulleyJoint,
				g = Box2D.Dynamics.Joints.b2PulleyJointDef,
				T = Box2D.Dynamics.Joints.b2RevoluteJoint,
				y = Box2D.Dynamics.Joints.b2RevoluteJointDef,
				S = Box2D.Dynamics.Joints.b2WeldJoint,
				x = Box2D.Dynamics.Joints.b2WeldJointDef;
			Box2D.Dynamics.b2Body,
				Box2D.Dynamics.b2BodyDef,
				Box2D.Dynamics.b2ContactFilter,
				Box2D.Dynamics.b2ContactImpulse,
				Box2D.Dynamics.b2ContactListener,
				Box2D.Dynamics.b2ContactManager,
				Box2D.Dynamics.b2DebugDraw,
				Box2D.Dynamics.b2DestructionListener,
				Box2D.Dynamics.b2FilterData,
				Box2D.Dynamics.b2Fixture,
				Box2D.Dynamics.b2FixtureDef,
				Box2D.Dynamics.b2Island,
				Box2D.Dynamics.b2TimeStep,
				Box2D.Dynamics.b2World,
				Box2D.inherit(n, Box2D.Dynamics.Joints.b2Joint),
				(n.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(n.b2DistanceJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.m_localAnchor1 = new b()),
						(this.m_localAnchor2 = new b()),
						(this.m_u = new b());
				}),
				(n.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
				}),
				(n.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
				}),
				(n.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(
							t * this.m_impulse * this.m_u.x,
							t * this.m_impulse * this.m_u.y
						)
					);
				}),
				(n.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), 0;
				}),
				(n.prototype.GetLength = function () {
					return this.m_length;
				}),
				(n.prototype.SetLength = function (t) {
					void 0 === t && (t = 0), (this.m_length = t);
				}),
				(n.prototype.GetFrequency = function () {
					return this.m_frequencyHz;
				}),
				(n.prototype.SetFrequency = function (t) {
					void 0 === t && (t = 0), (this.m_frequencyHz = t);
				}),
				(n.prototype.GetDampingRatio = function () {
					return this.m_dampingRatio;
				}),
				(n.prototype.SetDampingRatio = function (t) {
					void 0 === t && (t = 0), (this.m_dampingRatio = t);
				}),
				(n.prototype.b2DistanceJoint = function (t) {
					this.__super.b2Joint.call(this, t);
					this.m_localAnchor1.SetV(t.localAnchorA),
						this.m_localAnchor2.SetV(t.localAnchorB),
						(this.m_length = t.length),
						(this.m_frequencyHz = t.frequencyHz),
						(this.m_dampingRatio = t.dampingRatio),
						(this.m_impulse = 0),
						(this.m_gamma = 0),
						(this.m_bias = 0);
				}),
				(n.prototype.InitVelocityConstraints = function (t) {
					var e = 0,
						i = this.m_bodyA,
						n = this.m_bodyB,
						r = i.m_xf.R,
						o = this.m_localAnchor1.x - i.m_sweep.localCenter.x,
						s = this.m_localAnchor1.y - i.m_sweep.localCenter.y,
						e = r.col1.x * o + r.col2.x * s,
						s = r.col1.y * o + r.col2.y * s,
						o = e;
					r = n.m_xf.R;
					var c = this.m_localAnchor2.x - n.m_sweep.localCenter.x,
						a = this.m_localAnchor2.y - n.m_sweep.localCenter.y;
					(e = r.col1.x * c + r.col2.x * a),
						(a = r.col1.y * c + r.col2.y * a),
						(c = e),
						(this.m_u.x = n.m_sweep.c.x + c - i.m_sweep.c.x - o),
						(this.m_u.y = n.m_sweep.c.y + a - i.m_sweep.c.y - s);
					var l = Math.sqrt(
						this.m_u.x * this.m_u.x + this.m_u.y * this.m_u.y
					);
					l > v.b2_linearSlop
						? this.m_u.Multiply(1 / l)
						: this.m_u.SetZero();
					var h = o * this.m_u.y - s * this.m_u.x,
						r = c * this.m_u.y - a * this.m_u.x,
						e =
							i.m_invMass +
							i.m_invI * h * h +
							n.m_invMass +
							n.m_invI * r * r;
					(this.m_mass = 0 != e ? 1 / e : 0),
						0 < this.m_frequencyHz &&
							((h = l - this.m_length),
							(r = 2 * Math.PI * this.m_frequencyHz),
							(l = 2 * this.m_mass * this.m_dampingRatio * r),
							(r = this.m_mass * r * r),
							(this.m_gamma = t.dt * (l + t.dt * r)),
							(this.m_gamma =
								0 != this.m_gamma ? 1 / this.m_gamma : 0),
							(this.m_bias = h * t.dt * r * this.m_gamma),
							(this.m_mass = e + this.m_gamma),
							(this.m_mass =
								0 != this.m_mass ? 1 / this.m_mass : 0)),
						t.warmStarting
							? ((this.m_impulse *= t.dtRatio),
							  (e = this.m_impulse * this.m_u.x),
							  (t = this.m_impulse * this.m_u.y),
							  (i.m_linearVelocity.x -= i.m_invMass * e),
							  (i.m_linearVelocity.y -= i.m_invMass * t),
							  (i.m_angularVelocity -=
									i.m_invI * (o * t - s * e)),
							  (n.m_linearVelocity.x += n.m_invMass * e),
							  (n.m_linearVelocity.y += n.m_invMass * t),
							  (n.m_angularVelocity +=
									n.m_invI * (c * t - a * e)))
							: (this.m_impulse = 0);
				}),
				(n.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_xf.R,
						r = this.m_localAnchor1.x - e.m_sweep.localCenter.x,
						o = this.m_localAnchor1.y - e.m_sweep.localCenter.y,
						s = n.col1.x * r + n.col2.x * o,
						o = n.col1.y * r + n.col2.y * o,
						r = s;
					n = i.m_xf.R;
					var c = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchor2.y - i.m_sweep.localCenter.y,
						s = n.col1.x * c + n.col2.x * a,
						a = n.col1.y * c + n.col2.y * a,
						c = s,
						l = e.m_linearVelocity.x + -e.m_angularVelocity * o,
						h = e.m_linearVelocity.y + e.m_angularVelocity * r,
						n = i.m_linearVelocity.x + -i.m_angularVelocity * a,
						s = i.m_linearVelocity.y + i.m_angularVelocity * c,
						s = this.m_u.x * (n - l) + this.m_u.y * (s - h),
						h =
							-this.m_mass *
							(s + this.m_bias + this.m_gamma * this.m_impulse);
					this.m_impulse += h;
					(s = h * this.m_u.x), (h *= this.m_u.y);
					(e.m_linearVelocity.x -= e.m_invMass * s),
						(e.m_linearVelocity.y -= e.m_invMass * h),
						(e.m_angularVelocity -= e.m_invI * (r * h - o * s)),
						(i.m_linearVelocity.x += i.m_invMass * s),
						(i.m_linearVelocity.y += i.m_invMass * h),
						(i.m_angularVelocity += i.m_invI * (c * h - a * s));
				}),
				(n.prototype.SolvePositionConstraints = function (t) {
					if ((void 0 === t && (t = 0), 0 < this.m_frequencyHz))
						return !0;
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_xf.R,
						r = this.m_localAnchor1.x - e.m_sweep.localCenter.x,
						o = this.m_localAnchor1.y - e.m_sweep.localCenter.y,
						s = n.col1.x * r + n.col2.x * o,
						o = n.col1.y * r + n.col2.y * o,
						r = s;
					n = i.m_xf.R;
					var c = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchor2.y - i.m_sweep.localCenter.y,
						s = n.col1.x * c + n.col2.x * a,
						a = n.col1.y * c + n.col2.y * a,
						c = s,
						l = i.m_sweep.c.x + c - e.m_sweep.c.x - r,
						t = i.m_sweep.c.y + a - e.m_sweep.c.y - o,
						n = Math.sqrt(l * l + t * t);
					(l /= n), (t /= n);
					(s = n - this.m_length),
						(s = A.Clamp(
							s,
							-v.b2_maxLinearCorrection,
							v.b2_maxLinearCorrection
						)),
						(n = -this.m_mass * s);
					this.m_u.Set(l, t);
					(t = n * this.m_u.x), (n *= this.m_u.y);
					return (
						(e.m_sweep.c.x -= e.m_invMass * t),
						(e.m_sweep.c.y -= e.m_invMass * n),
						(e.m_sweep.a -= e.m_invI * (r * n - o * t)),
						(i.m_sweep.c.x += i.m_invMass * t),
						(i.m_sweep.c.y += i.m_invMass * n),
						(i.m_sweep.a += i.m_invI * (c * n - a * t)),
						e.SynchronizeTransform(),
						i.SynchronizeTransform(),
						A.Abs(s) < v.b2_linearSlop
					);
				}),
				Box2D.inherit(r, Box2D.Dynamics.Joints.b2JointDef),
				(r.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(r.b2DistanceJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.localAnchorA = new b()),
						(this.localAnchorB = new b());
				}),
				(r.prototype.b2DistanceJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_distanceJoint),
						(this.length = 1),
						(this.frequencyHz = 0),
						(this.dampingRatio = 0);
				}),
				(r.prototype.Initialize = function (t, e, i, n) {
					(this.bodyA = t),
						(this.bodyB = e),
						this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),
						this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));
					(e = n.x - i.x), (i = n.y - i.y);
					(this.length = Math.sqrt(e * e + i * i)),
						(this.frequencyHz = 0),
						(this.dampingRatio = 0);
				}),
				Box2D.inherit(o, Box2D.Dynamics.Joints.b2Joint),
				(o.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(o.b2FrictionJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.m_localAnchorA = new b()),
						(this.m_localAnchorB = new b()),
						(this.m_linearMass = new E()),
						(this.m_linearImpulse = new b());
				}),
				(o.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
				}),
				(o.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
				}),
				(o.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(
							t * this.m_linearImpulse.x,
							t * this.m_linearImpulse.y
						)
					);
				}),
				(o.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), t * this.m_angularImpulse;
				}),
				(o.prototype.SetMaxForce = function (t) {
					void 0 === t && (t = 0), (this.m_maxForce = t);
				}),
				(o.prototype.GetMaxForce = function () {
					return this.m_maxForce;
				}),
				(o.prototype.SetMaxTorque = function (t) {
					void 0 === t && (t = 0), (this.m_maxTorque = t);
				}),
				(o.prototype.GetMaxTorque = function () {
					return this.m_maxTorque;
				}),
				(o.prototype.b2FrictionJoint = function (t) {
					this.__super.b2Joint.call(this, t),
						this.m_localAnchorA.SetV(t.localAnchorA),
						this.m_localAnchorB.SetV(t.localAnchorB),
						this.m_linearMass.SetZero(),
						(this.m_angularMass = 0),
						this.m_linearImpulse.SetZero(),
						(this.m_angularImpulse = 0),
						(this.m_maxForce = t.maxForce),
						(this.m_maxTorque = t.maxTorque);
				}),
				(o.prototype.InitVelocityConstraints = function (t) {
					var e = 0,
						i = this.m_bodyA,
						n = this.m_bodyB,
						r = i.m_xf.R,
						o = this.m_localAnchorA.x - i.m_sweep.localCenter.x,
						s = this.m_localAnchorA.y - i.m_sweep.localCenter.y,
						e = r.col1.x * o + r.col2.x * s,
						s = r.col1.y * o + r.col2.y * s,
						o = e;
					r = n.m_xf.R;
					var c = this.m_localAnchorB.x - n.m_sweep.localCenter.x,
						a = this.m_localAnchorB.y - n.m_sweep.localCenter.y;
					(e = r.col1.x * c + r.col2.x * a),
						(a = r.col1.y * c + r.col2.y * a),
						(c = e);
					var l = i.m_invMass,
						h = n.m_invMass,
						u = i.m_invI,
						r = n.m_invI,
						e = new E();
					(e.col1.x = l + h),
						(e.col2.x = 0),
						(e.col1.y = 0),
						(e.col2.y = l + h),
						(e.col1.x += u * s * s),
						(e.col2.x += -u * o * s),
						(e.col1.y += -u * o * s),
						(e.col2.y += u * o * o),
						(e.col1.x += r * a * a),
						(e.col2.x += -r * c * a),
						(e.col1.y += -r * c * a),
						(e.col2.y += r * c * c),
						e.GetInverse(this.m_linearMass),
						(this.m_angularMass = u + r),
						0 < this.m_angularMass &&
							(this.m_angularMass = 1 / this.m_angularMass),
						t.warmStarting
							? ((this.m_linearImpulse.x *= t.dtRatio),
							  (this.m_linearImpulse.y *= t.dtRatio),
							  (this.m_angularImpulse *= t.dtRatio),
							  (t = this.m_linearImpulse),
							  (i.m_linearVelocity.x -= l * t.x),
							  (i.m_linearVelocity.y -= l * t.y),
							  (i.m_angularVelocity -=
									u *
									(o * t.y -
										s * t.x +
										this.m_angularImpulse)),
							  (n.m_linearVelocity.x += h * t.x),
							  (n.m_linearVelocity.y += h * t.y),
							  (n.m_angularVelocity +=
									r *
									(c * t.y -
										a * t.x +
										this.m_angularImpulse)))
							: (this.m_linearImpulse.SetZero(),
							  (this.m_angularImpulse = 0));
				}),
				(o.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_linearVelocity,
						r = e.m_angularVelocity,
						o = i.m_linearVelocity,
						s = i.m_angularVelocity,
						c = e.m_invMass,
						a = i.m_invMass,
						l = e.m_invI,
						h = i.m_invI,
						u = e.m_xf.R,
						_ = this.m_localAnchorA.x - e.m_sweep.localCenter.x,
						d = this.m_localAnchorA.y - e.m_sweep.localCenter.y,
						p = u.col1.x * _ + u.col2.x * d,
						d = u.col1.y * _ + u.col2.y * d,
						_ = p;
					u = i.m_xf.R;
					var f = this.m_localAnchorB.x - i.m_sweep.localCenter.x,
						m = this.m_localAnchorB.y - i.m_sweep.localCenter.y;
					(p = u.col1.x * f + u.col2.x * m),
						(m = u.col1.y * f + u.col2.y * m),
						(f = p);
					var u = s - r,
						p = -this.m_angularMass * u,
						u = this.m_angularImpulse,
						g = t.dt * this.m_maxTorque;
					(this.m_angularImpulse = A.Clamp(
						this.m_angularImpulse + p,
						-g,
						g
					)),
						(r -= l * (p = this.m_angularImpulse - u)),
						(s += h * p);
					(u = o.x - s * m - n.x + r * d),
						(p = o.y + s * f - n.y - r * _),
						(u = A.MulMV(this.m_linearMass, new b(-u, -p))),
						(p = this.m_linearImpulse.Copy());
					this.m_linearImpulse.Add(u),
						(g = t.dt * this.m_maxForce),
						this.m_linearImpulse.LengthSquared() > g * g &&
							(this.m_linearImpulse.Normalize(),
							this.m_linearImpulse.Multiply(g)),
						(u = A.SubtractVV(this.m_linearImpulse, p)),
						(n.x -= c * u.x),
						(n.y -= c * u.y),
						(r -= l * (_ * u.y - d * u.x)),
						(o.x += a * u.x),
						(o.y += a * u.y),
						(s += h * (f * u.y - m * u.x)),
						(e.m_angularVelocity = r),
						(i.m_angularVelocity = s);
				}),
				(o.prototype.SolvePositionConstraints = function (t) {
					return void 0 === t && (t = 0), !0;
				}),
				Box2D.inherit(s, Box2D.Dynamics.Joints.b2JointDef),
				(s.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(s.b2FrictionJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.localAnchorA = new b()),
						(this.localAnchorB = new b());
				}),
				(s.prototype.b2FrictionJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_frictionJoint),
						(this.maxForce = 0),
						(this.maxTorque = 0);
				}),
				(s.prototype.Initialize = function (t, e, i) {
					(this.bodyA = t),
						(this.bodyB = e),
						this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),
						this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i));
				}),
				Box2D.inherit(c, Box2D.Dynamics.Joints.b2Joint),
				(c.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(c.b2GearJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.m_groundAnchor1 = new b()),
						(this.m_groundAnchor2 = new b()),
						(this.m_localAnchor1 = new b()),
						(this.m_localAnchor2 = new b()),
						(this.m_J = new t());
				}),
				(c.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
				}),
				(c.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
				}),
				(c.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(
							t * this.m_impulse * this.m_J.linearB.x,
							t * this.m_impulse * this.m_J.linearB.y
						)
					);
				}),
				(c.prototype.GetReactionTorque = function (t) {
					void 0 === t && (t = 0);
					var e = this.m_bodyB.m_xf.R,
						i =
							this.m_localAnchor1.x -
							this.m_bodyB.m_sweep.localCenter.x,
						n =
							this.m_localAnchor1.y -
							this.m_bodyB.m_sweep.localCenter.y,
						r = e.col1.x * i + e.col2.x * n,
						n = e.col1.y * i + e.col2.y * n,
						i = r,
						e = this.m_impulse * this.m_J.linearB.x,
						r = this.m_impulse * this.m_J.linearB.y;
					return (
						t * (this.m_impulse * this.m_J.angularB - i * r + n * e)
					);
				}),
				(c.prototype.GetRatio = function () {
					return this.m_ratio;
				}),
				(c.prototype.SetRatio = function (t) {
					void 0 === t && (t = 0), (this.m_ratio = t);
				}),
				(c.prototype.b2GearJoint = function (t) {
					this.__super.b2Joint.call(this, t);
					var e = parseInt(t.joint1.m_type),
						i = parseInt(t.joint2.m_type);
					(this.m_revolute1 = null),
						(this.m_prismatic1 = null),
						(this.m_revolute2 = null),
						(this.m_prismatic2 = null);
					var n = 0,
						r = 0;
					(this.m_ground1 = t.joint1.GetBodyA()),
						(this.m_bodyA = t.joint1.GetBodyB()),
						(n =
							e == C.e_revoluteJoint
								? ((this.m_revolute1 =
										t.joint1 instanceof T
											? t.joint1
											: null),
								  this.m_groundAnchor1.SetV(
										this.m_revolute1.m_localAnchor1
								  ),
								  this.m_localAnchor1.SetV(
										this.m_revolute1.m_localAnchor2
								  ),
								  this.m_revolute1.GetJointAngle())
								: ((this.m_prismatic1 =
										t.joint1 instanceof p
											? t.joint1
											: null),
								  this.m_groundAnchor1.SetV(
										this.m_prismatic1.m_localAnchor1
								  ),
								  this.m_localAnchor1.SetV(
										this.m_prismatic1.m_localAnchor2
								  ),
								  this.m_prismatic1.GetJointTranslation())),
						(this.m_ground2 = t.joint2.GetBodyA()),
						(this.m_bodyB = t.joint2.GetBodyB()),
						(r =
							i == C.e_revoluteJoint
								? ((this.m_revolute2 =
										t.joint2 instanceof T
											? t.joint2
											: null),
								  this.m_groundAnchor2.SetV(
										this.m_revolute2.m_localAnchor1
								  ),
								  this.m_localAnchor2.SetV(
										this.m_revolute2.m_localAnchor2
								  ),
								  this.m_revolute2.GetJointAngle())
								: ((this.m_prismatic2 =
										t.joint2 instanceof p
											? t.joint2
											: null),
								  this.m_groundAnchor2.SetV(
										this.m_prismatic2.m_localAnchor1
								  ),
								  this.m_localAnchor2.SetV(
										this.m_prismatic2.m_localAnchor2
								  ),
								  this.m_prismatic2.GetJointTranslation())),
						(this.m_ratio = t.ratio),
						(this.m_constant = n + this.m_ratio * r),
						(this.m_impulse = 0);
				}),
				(c.prototype.InitVelocityConstraints = function (t) {
					var e,
						i,
						n = this.m_ground1,
						r = this.m_ground2,
						o = this.m_bodyA,
						s = this.m_bodyB,
						c = 0,
						a = 0,
						l = 0,
						h = 0,
						u = 0,
						_ = 0,
						d = 0;
					this.m_J.SetZero(),
						this.m_revolute1
							? ((this.m_J.angularA = -1), (d += o.m_invI))
							: ((e = n.m_xf.R),
							  (i = this.m_prismatic1.m_localXAxis1),
							  (c = e.col1.x * i.x + e.col2.x * i.y),
							  (a = e.col1.y * i.x + e.col2.y * i.y),
							  (e = o.m_xf.R),
							  (l =
									this.m_localAnchor1.x -
									o.m_sweep.localCenter.x),
							  (h =
									this.m_localAnchor1.y -
									o.m_sweep.localCenter.y),
							  (_ = e.col1.x * l + e.col2.x * h),
							  (h = e.col1.y * l + e.col2.y * h),
							  (u = (l = _) * a - h * c),
							  this.m_J.linearA.Set(-c, -a),
							  (this.m_J.angularA = -u),
							  (d += o.m_invMass + o.m_invI * u * u)),
						this.m_revolute2
							? ((this.m_J.angularB = -this.m_ratio),
							  (d += this.m_ratio * this.m_ratio * s.m_invI))
							: ((e = r.m_xf.R),
							  (i = this.m_prismatic2.m_localXAxis1),
							  (c = e.col1.x * i.x + e.col2.x * i.y),
							  (a = e.col1.y * i.x + e.col2.y * i.y),
							  (e = s.m_xf.R),
							  (l =
									this.m_localAnchor2.x -
									s.m_sweep.localCenter.x),
							  (h =
									this.m_localAnchor2.y -
									s.m_sweep.localCenter.y),
							  (_ = e.col1.x * l + e.col2.x * h),
							  (h = e.col1.y * l + e.col2.y * h),
							  (u = (l = _) * a - h * c),
							  this.m_J.linearB.Set(
									-this.m_ratio * c,
									-this.m_ratio * a
							  ),
							  (this.m_J.angularB = -this.m_ratio * u),
							  (d +=
									this.m_ratio *
									this.m_ratio *
									(s.m_invMass + s.m_invI * u * u))),
						(this.m_mass = 0 < d ? 1 / d : 0),
						t.warmStarting
							? ((o.m_linearVelocity.x +=
									o.m_invMass *
									this.m_impulse *
									this.m_J.linearA.x),
							  (o.m_linearVelocity.y +=
									o.m_invMass *
									this.m_impulse *
									this.m_J.linearA.y),
							  (o.m_angularVelocity +=
									o.m_invI *
									this.m_impulse *
									this.m_J.angularA),
							  (s.m_linearVelocity.x +=
									s.m_invMass *
									this.m_impulse *
									this.m_J.linearB.x),
							  (s.m_linearVelocity.y +=
									s.m_invMass *
									this.m_impulse *
									this.m_J.linearB.y),
							  (s.m_angularVelocity +=
									s.m_invI *
									this.m_impulse *
									this.m_J.angularB))
							: (this.m_impulse = 0);
				}),
				(c.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = this.m_J.Compute(
							e.m_linearVelocity,
							e.m_angularVelocity,
							i.m_linearVelocity,
							i.m_angularVelocity
						),
						n = -this.m_mass * n;
					(this.m_impulse += n),
						(e.m_linearVelocity.x +=
							e.m_invMass * n * this.m_J.linearA.x),
						(e.m_linearVelocity.y +=
							e.m_invMass * n * this.m_J.linearA.y),
						(e.m_angularVelocity +=
							e.m_invI * n * this.m_J.angularA),
						(i.m_linearVelocity.x +=
							i.m_invMass * n * this.m_J.linearB.x),
						(i.m_linearVelocity.y +=
							i.m_invMass * n * this.m_J.linearB.y),
						(i.m_angularVelocity +=
							i.m_invI * n * this.m_J.angularB);
				}),
				(c.prototype.SolvePositionConstraints = function (t) {
					void 0 === t && (t = 0);
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = 0,
						t = 0,
						n = this.m_revolute1
							? this.m_revolute1.GetJointAngle()
							: this.m_prismatic1.GetJointTranslation(),
						t = this.m_revolute2
							? this.m_revolute2.GetJointAngle()
							: this.m_prismatic2.GetJointTranslation(),
						t = this.m_constant - (n + this.m_ratio * t),
						t = -this.m_mass * t;
					return (
						(e.m_sweep.c.x += e.m_invMass * t * this.m_J.linearA.x),
						(e.m_sweep.c.y += e.m_invMass * t * this.m_J.linearA.y),
						(e.m_sweep.a += e.m_invI * t * this.m_J.angularA),
						(i.m_sweep.c.x += i.m_invMass * t * this.m_J.linearB.x),
						(i.m_sweep.c.y += i.m_invMass * t * this.m_J.linearB.y),
						(i.m_sweep.a += i.m_invI * t * this.m_J.angularB),
						e.SynchronizeTransform(),
						i.SynchronizeTransform(),
						0 < v.b2_linearSlop
					);
				}),
				Box2D.inherit(a, Box2D.Dynamics.Joints.b2JointDef),
				(a.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(a.b2GearJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					);
				}),
				(a.prototype.b2GearJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_gearJoint),
						(this.joint1 = null),
						(this.joint2 = null),
						(this.ratio = 1);
				}),
				(t.b2Jacobian = function () {
					(this.linearA = new b()), (this.linearB = new b());
				}),
				(t.prototype.SetZero = function () {
					this.linearA.SetZero(),
						(this.angularA = 0),
						this.linearB.SetZero(),
						(this.angularB = 0);
				}),
				(t.prototype.Set = function (t, e, i, n) {
					void 0 === e && (e = 0),
						void 0 === n && (n = 0),
						this.linearA.SetV(t),
						(this.angularA = e),
						this.linearB.SetV(i),
						(this.angularB = n);
				}),
				(t.prototype.Compute = function (t, e, i, n) {
					return (
						void 0 === e && (e = 0),
						void 0 === n && (n = 0),
						this.linearA.x * t.x +
							this.linearA.y * t.y +
							this.angularA * e +
							(this.linearB.x * i.x + this.linearB.y * i.y) +
							this.angularB * n
					);
				}),
				(C.b2Joint = function () {
					(this.m_edgeA = new l()),
						(this.m_edgeB = new l()),
						(this.m_localCenterA = new b()),
						(this.m_localCenterB = new b());
				}),
				(C.prototype.GetType = function () {
					return this.m_type;
				}),
				(C.prototype.GetAnchorA = function () {
					return null;
				}),
				(C.prototype.GetAnchorB = function () {
					return null;
				}),
				(C.prototype.GetReactionForce = function (t) {
					return void 0 === t && (t = 0), null;
				}),
				(C.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), 0;
				}),
				(C.prototype.GetBodyA = function () {
					return this.m_bodyA;
				}),
				(C.prototype.GetBodyB = function () {
					return this.m_bodyB;
				}),
				(C.prototype.GetNext = function () {
					return this.m_next;
				}),
				(C.prototype.GetUserData = function () {
					return this.m_userData;
				}),
				(C.prototype.SetUserData = function (t) {
					this.m_userData = t;
				}),
				(C.prototype.IsActive = function () {
					return this.m_bodyA.IsActive() && this.m_bodyB.IsActive();
				}),
				(C.Create = function (t, e) {
					var i = null;
					switch (t.type) {
						case C.e_distanceJoint:
							i = new n(t instanceof r ? t : null);
							break;
						case C.e_mouseJoint:
							i = new _(t instanceof d ? t : null);
							break;
						case C.e_prismaticJoint:
							i = new p(t instanceof f ? t : null);
							break;
						case C.e_revoluteJoint:
							i = new T(t instanceof y ? t : null);
							break;
						case C.e_pulleyJoint:
							i = new m(t instanceof g ? t : null);
							break;
						case C.e_gearJoint:
							i = new c(t instanceof a ? t : null);
							break;
						case C.e_lineJoint:
							i = new h(t instanceof u ? t : null);
							break;
						case C.e_weldJoint:
							i = new S(t instanceof x ? t : null);
							break;
						case C.e_frictionJoint:
							i = new o(t instanceof s ? t : null);
					}
					return i;
				}),
				(C.Destroy = function (t, e) {}),
				(C.prototype.b2Joint = function (t) {
					v.b2Assert(t.bodyA != t.bodyB),
						(this.m_type = t.type),
						(this.m_prev = null),
						(this.m_next = null),
						(this.m_bodyA = t.bodyA),
						(this.m_bodyB = t.bodyB),
						(this.m_collideConnected = t.collideConnected),
						(this.m_islandFlag = !1),
						(this.m_userData = t.userData);
				}),
				(C.prototype.InitVelocityConstraints = function (t) {}),
				(C.prototype.SolveVelocityConstraints = function (t) {}),
				(C.prototype.FinalizeVelocityConstraints = function () {}),
				(C.prototype.SolvePositionConstraints = function (t) {
					return void 0 === t && (t = 0), !1;
				}),
				Box2D.postDefs.push(function () {
					(Box2D.Dynamics.Joints.b2Joint.e_unknownJoint = 0),
						(Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint = 1),
						(Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint = 2),
						(Box2D.Dynamics.Joints.b2Joint.e_distanceJoint = 3),
						(Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint = 4),
						(Box2D.Dynamics.Joints.b2Joint.e_mouseJoint = 5),
						(Box2D.Dynamics.Joints.b2Joint.e_gearJoint = 6),
						(Box2D.Dynamics.Joints.b2Joint.e_lineJoint = 7),
						(Box2D.Dynamics.Joints.b2Joint.e_weldJoint = 8),
						(Box2D.Dynamics.Joints.b2Joint.e_frictionJoint = 9),
						(Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit = 0),
						(Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit = 1),
						(Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit = 2),
						(Box2D.Dynamics.Joints.b2Joint.e_equalLimits = 3);
				}),
				(i.b2JointDef = function () {}),
				(i.prototype.b2JointDef = function () {
					(this.type = C.e_unknownJoint),
						(this.userData = null),
						(this.bodyA = null),
						(this.bodyB = null),
						(this.collideConnected = !1);
				}),
				(l.b2JointEdge = function () {}),
				Box2D.inherit(h, Box2D.Dynamics.Joints.b2Joint),
				(h.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(h.b2LineJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.m_localAnchor1 = new b()),
						(this.m_localAnchor2 = new b()),
						(this.m_localXAxis1 = new b()),
						(this.m_localYAxis1 = new b()),
						(this.m_axis = new b()),
						(this.m_perp = new b()),
						(this.m_K = new E()),
						(this.m_impulse = new b());
				}),
				(h.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
				}),
				(h.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
				}),
				(h.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(
							t *
								(this.m_impulse.x * this.m_perp.x +
									(this.m_motorImpulse + this.m_impulse.y) *
										this.m_axis.x),
							t *
								(this.m_impulse.x * this.m_perp.y +
									(this.m_motorImpulse + this.m_impulse.y) *
										this.m_axis.y)
						)
					);
				}),
				(h.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), t * this.m_impulse.y;
				}),
				(h.prototype.GetJointTranslation = function () {
					var t = this.m_bodyA,
						e = this.m_bodyB,
						i = t.GetWorldPoint(this.m_localAnchor1),
						n = e.GetWorldPoint(this.m_localAnchor2),
						e = n.x - i.x,
						i = n.y - i.y,
						t = t.GetWorldVector(this.m_localXAxis1);
					return t.x * e + t.y * i;
				}),
				(h.prototype.GetJointSpeed = function () {
					var t = this.m_bodyA,
						e = this.m_bodyB,
						i = t.m_xf.R,
						n = this.m_localAnchor1.x - t.m_sweep.localCenter.x,
						r = this.m_localAnchor1.y - t.m_sweep.localCenter.y,
						o = i.col1.x * n + i.col2.x * r,
						r = i.col1.y * n + i.col2.y * r,
						n = o;
					i = e.m_xf.R;
					var s = this.m_localAnchor2.x - e.m_sweep.localCenter.x,
						c = this.m_localAnchor2.y - e.m_sweep.localCenter.y,
						o = i.col1.x * s + i.col2.x * c,
						c = i.col1.y * s + i.col2.y * c,
						s = o,
						a = t.m_sweep.c.x + n,
						l = t.m_sweep.c.y + r,
						h = e.m_sweep.c.x + s - a,
						i = e.m_sweep.c.y + c - l,
						o = t.GetWorldVector(this.m_localXAxis1),
						a = t.m_linearVelocity,
						l = e.m_linearVelocity,
						t = t.m_angularVelocity,
						e = e.m_angularVelocity;
					return (
						h * (-t * o.y) +
						i * (t * o.x) +
						(o.x * (l.x + -e * c - a.x - -t * r) +
							o.y * (l.y + e * s - a.y - t * n))
					);
				}),
				(h.prototype.IsLimitEnabled = function () {
					return this.m_enableLimit;
				}),
				(h.prototype.EnableLimit = function (t) {
					this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_enableLimit = t);
				}),
				(h.prototype.GetLowerLimit = function () {
					return this.m_lowerTranslation;
				}),
				(h.prototype.GetUpperLimit = function () {
					return this.m_upperTranslation;
				}),
				(h.prototype.SetLimits = function (t, e) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_lowerTranslation = t),
						(this.m_upperTranslation = e);
				}),
				(h.prototype.IsMotorEnabled = function () {
					return this.m_enableMotor;
				}),
				(h.prototype.EnableMotor = function (t) {
					this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_enableMotor = t);
				}),
				(h.prototype.SetMotorSpeed = function (t) {
					void 0 === t && (t = 0),
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_motorSpeed = t);
				}),
				(h.prototype.GetMotorSpeed = function () {
					return this.m_motorSpeed;
				}),
				(h.prototype.SetMaxMotorForce = function (t) {
					void 0 === t && (t = 0),
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_maxMotorForce = t);
				}),
				(h.prototype.GetMaxMotorForce = function () {
					return this.m_maxMotorForce;
				}),
				(h.prototype.GetMotorForce = function () {
					return this.m_motorImpulse;
				}),
				(h.prototype.b2LineJoint = function (t) {
					this.__super.b2Joint.call(this, t);
					this.m_localAnchor1.SetV(t.localAnchorA),
						this.m_localAnchor2.SetV(t.localAnchorB),
						this.m_localXAxis1.SetV(t.localAxisA),
						(this.m_localYAxis1.x = -this.m_localXAxis1.y),
						(this.m_localYAxis1.y = this.m_localXAxis1.x),
						this.m_impulse.SetZero(),
						(this.m_motorMass = 0),
						(this.m_motorImpulse = 0),
						(this.m_lowerTranslation = t.lowerTranslation),
						(this.m_upperTranslation = t.upperTranslation),
						(this.m_maxMotorForce = t.maxMotorForce),
						(this.m_motorSpeed = t.motorSpeed),
						(this.m_enableLimit = t.enableLimit),
						(this.m_enableMotor = t.enableMotor),
						(this.m_limitState = C.e_inactiveLimit),
						this.m_axis.SetZero(),
						this.m_perp.SetZero();
				}),
				(h.prototype.InitVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = 0;
					this.m_localCenterA.SetV(e.GetLocalCenter()),
						this.m_localCenterB.SetV(i.GetLocalCenter());
					var r = e.GetTransform(),
						o = (i.GetTransform(), e.m_xf.R),
						s = this.m_localAnchor1.x - this.m_localCenterA.x,
						c = this.m_localAnchor1.y - this.m_localCenterA.y,
						n = o.col1.x * s + o.col2.x * c,
						c = o.col1.y * s + o.col2.y * c,
						s = n;
					o = i.m_xf.R;
					var a = this.m_localAnchor2.x - this.m_localCenterB.x,
						l = this.m_localAnchor2.y - this.m_localCenterB.y;
					(n = o.col1.x * a + o.col2.x * l),
						(l = o.col1.y * a + o.col2.y * l),
						(a = n);
					(o = i.m_sweep.c.x + a - e.m_sweep.c.x - s),
						(n = i.m_sweep.c.y + l - e.m_sweep.c.y - c);
					(this.m_invMassA = e.m_invMass),
						(this.m_invMassB = i.m_invMass),
						(this.m_invIA = e.m_invI),
						(this.m_invIB = i.m_invI),
						this.m_axis.SetV(A.MulMV(r.R, this.m_localXAxis1)),
						(this.m_a1 =
							(o + s) * this.m_axis.y - (n + c) * this.m_axis.x),
						(this.m_a2 = a * this.m_axis.y - l * this.m_axis.x),
						(this.m_motorMass =
							this.m_invMassA +
							this.m_invMassB +
							this.m_invIA * this.m_a1 * this.m_a1 +
							this.m_invIB * this.m_a2 * this.m_a2),
						(this.m_motorMass =
							this.m_motorMass > Number.MIN_VALUE
								? 1 / this.m_motorMass
								: 0),
						this.m_perp.SetV(A.MulMV(r.R, this.m_localYAxis1)),
						(this.m_s1 =
							(o + s) * this.m_perp.y - (n + c) * this.m_perp.x),
						(this.m_s2 = a * this.m_perp.y - l * this.m_perp.x);
					var h,
						s = this.m_invMassA,
						c = this.m_invMassB,
						a = this.m_invIA,
						l = this.m_invIB;
					(this.m_K.col1.x =
						s +
						c +
						a * this.m_s1 * this.m_s1 +
						l * this.m_s2 * this.m_s2),
						(this.m_K.col1.y =
							a * this.m_s1 * this.m_a1 +
							l * this.m_s2 * this.m_a2),
						(this.m_K.col2.x = this.m_K.col1.y),
						(this.m_K.col2.y =
							s +
							c +
							a * this.m_a1 * this.m_a1 +
							l * this.m_a2 * this.m_a2),
						this.m_enableLimit
							? ((h = this.m_axis.x * o + this.m_axis.y * n),
							  A.Abs(
									this.m_upperTranslation -
										this.m_lowerTranslation
							  ) <
							  2 * v.b2_linearSlop
									? (this.m_limitState = C.e_equalLimits)
									: h <= this.m_lowerTranslation
									? this.m_limitState != C.e_atLowerLimit &&
									  ((this.m_limitState = C.e_atLowerLimit),
									  (this.m_impulse.y = 0))
									: h >= this.m_upperTranslation
									? this.m_limitState != C.e_atUpperLimit &&
									  ((this.m_limitState = C.e_atUpperLimit),
									  (this.m_impulse.y = 0))
									: ((this.m_limitState = C.e_inactiveLimit),
									  (this.m_impulse.y = 0)))
							: (this.m_limitState = C.e_inactiveLimit),
						0 == this.m_enableMotor && (this.m_motorImpulse = 0),
						t.warmStarting
							? ((this.m_impulse.x *= t.dtRatio),
							  (this.m_impulse.y *= t.dtRatio),
							  (this.m_motorImpulse *= t.dtRatio),
							  (o =
									this.m_impulse.x * this.m_perp.x +
									(this.m_motorImpulse + this.m_impulse.y) *
										this.m_axis.x),
							  (n =
									this.m_impulse.x * this.m_perp.y +
									(this.m_motorImpulse + this.m_impulse.y) *
										this.m_axis.y),
							  (h =
									this.m_impulse.x * this.m_s1 +
									(this.m_motorImpulse + this.m_impulse.y) *
										this.m_a1),
							  (t =
									this.m_impulse.x * this.m_s2 +
									(this.m_motorImpulse + this.m_impulse.y) *
										this.m_a2),
							  (e.m_linearVelocity.x -= this.m_invMassA * o),
							  (e.m_linearVelocity.y -= this.m_invMassA * n),
							  (e.m_angularVelocity -= this.m_invIA * h),
							  (i.m_linearVelocity.x += this.m_invMassB * o),
							  (i.m_linearVelocity.y += this.m_invMassB * n),
							  (i.m_angularVelocity += this.m_invIB * t))
							: (this.m_impulse.SetZero(),
							  (this.m_motorImpulse = 0));
				}),
				(h.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_linearVelocity,
						r = e.m_angularVelocity,
						o = i.m_linearVelocity,
						s = i.m_angularVelocity,
						c = 0,
						a = 0,
						l = 0,
						h = 0;
					this.m_enableMotor &&
						this.m_limitState != C.e_equalLimits &&
						((d =
							this.m_axis.x * (o.x - n.x) +
							this.m_axis.y * (o.y - n.y) +
							this.m_a2 * s -
							this.m_a1 * r),
						(_ = this.m_motorMass * (this.m_motorSpeed - d)),
						(u = this.m_motorImpulse),
						(d = t.dt * this.m_maxMotorForce),
						(this.m_motorImpulse = A.Clamp(
							this.m_motorImpulse + _,
							-d,
							d
						)),
						(c = (_ = this.m_motorImpulse - u) * this.m_axis.x),
						(a = _ * this.m_axis.y),
						(l = _ * this.m_a1),
						(h = _ * this.m_a2),
						(n.x -= this.m_invMassA * c),
						(n.y -= this.m_invMassA * a),
						(r -= this.m_invIA * l),
						(o.x += this.m_invMassB * c),
						(o.y += this.m_invMassB * a),
						(s += this.m_invIB * h));
					var u,
						_,
						d,
						p,
						t =
							this.m_perp.x * (o.x - n.x) +
							this.m_perp.y * (o.y - n.y) +
							this.m_s2 * s -
							this.m_s1 * r;
					(h =
						this.m_enableLimit &&
						this.m_limitState != C.e_inactiveLimit
							? ((d =
									this.m_axis.x * (o.x - n.x) +
									this.m_axis.y * (o.y - n.y) +
									this.m_a2 * s -
									this.m_a1 * r),
							  (u = this.m_impulse.Copy()),
							  (p = this.m_K.Solve(new b(), -t, -d)),
							  this.m_impulse.Add(p),
							  this.m_limitState == C.e_atLowerLimit
									? (this.m_impulse.y = A.Max(
											this.m_impulse.y,
											0
									  ))
									: this.m_limitState == C.e_atUpperLimit &&
									  (this.m_impulse.y = A.Min(
											this.m_impulse.y,
											0
									  )),
							  (_ =
									-t -
									(this.m_impulse.y - u.y) * this.m_K.col2.x),
							  (d =
									(d = 0) != this.m_K.col1.x
										? _ / this.m_K.col1.x + u.x
										: u.x),
							  (this.m_impulse.x = d),
							  (p.x = this.m_impulse.x - u.x),
							  (p.y = this.m_impulse.y - u.y),
							  (c = p.x * this.m_perp.x + p.y * this.m_axis.x),
							  (a = p.x * this.m_perp.y + p.y * this.m_axis.y),
							  (l = p.x * this.m_s1 + p.y * this.m_a1),
							  p.x * this.m_s2 + p.y * this.m_a2)
							: ((p =
									(p = 0) != this.m_K.col1.x
										? -t / this.m_K.col1.x
										: 0),
							  (this.m_impulse.x += p),
							  (c = p * this.m_perp.x),
							  (a = p * this.m_perp.y),
							  (l = p * this.m_s1),
							  p * this.m_s2)),
						(n.x -= this.m_invMassA * c),
						(n.y -= this.m_invMassA * a),
						(r -= this.m_invIA * l),
						(o.x += this.m_invMassB * c),
						(o.y += this.m_invMassB * a),
						(s += this.m_invIB * h),
						e.m_linearVelocity.SetV(n),
						(e.m_angularVelocity = r),
						i.m_linearVelocity.SetV(o),
						(i.m_angularVelocity = s);
				}),
				(h.prototype.SolvePositionConstraints = function (t) {
					void 0 === t && (t = 0);
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_sweep.c,
						r = e.m_sweep.a,
						o = i.m_sweep.c,
						s = i.m_sweep.a,
						c = 0,
						a = 0,
						l = 0,
						h = 0,
						u = 0,
						_ = 0,
						d = !1,
						p = 0,
						f = E.FromAngle(r),
						m = E.FromAngle(s),
						g = f,
						y = this.m_localAnchor1.x - this.m_localCenterA.x,
						T = this.m_localAnchor1.y - this.m_localCenterA.y,
						c = g.col1.x * y + g.col2.x * T,
						T = g.col1.y * y + g.col2.y * T,
						y = c;
					g = m;
					var S = this.m_localAnchor2.x - this.m_localCenterB.x,
						t = this.m_localAnchor2.y - this.m_localCenterB.y;
					(c = g.col1.x * S + g.col2.x * t),
						(t = g.col1.y * S + g.col2.y * t),
						(S = c);
					(m = o.x + S - n.x - y), (g = o.y + t - n.y - T);
					this.m_enableLimit &&
						((this.m_axis = A.MulMV(f, this.m_localXAxis1)),
						(this.m_a1 =
							(m + y) * this.m_axis.y - (g + T) * this.m_axis.x),
						(this.m_a2 = S * this.m_axis.y - t * this.m_axis.x),
						(c = this.m_axis.x * m + this.m_axis.y * g),
						A.Abs(
							this.m_upperTranslation - this.m_lowerTranslation
						) <
						2 * v.b2_linearSlop
							? ((p = A.Clamp(
									c,
									-v.b2_maxLinearCorrection,
									v.b2_maxLinearCorrection
							  )),
							  (_ = A.Abs(c)),
							  (d = !0))
							: c <= this.m_lowerTranslation
							? ((p = A.Clamp(
									c -
										this.m_lowerTranslation +
										v.b2_linearSlop,
									-v.b2_maxLinearCorrection,
									0
							  )),
							  (_ = this.m_lowerTranslation - c),
							  (d = !0))
							: c >= this.m_upperTranslation &&
							  ((p = A.Clamp(
									c -
										this.m_upperTranslation +
										v.b2_linearSlop,
									0,
									v.b2_maxLinearCorrection
							  )),
							  (_ = c - this.m_upperTranslation),
							  (d = !0))),
						(this.m_perp = A.MulMV(f, this.m_localYAxis1)),
						(this.m_s1 =
							(m + y) * this.m_perp.y - (g + T) * this.m_perp.x),
						(this.m_s2 = S * this.m_perp.y - t * this.m_perp.x);
					(t = new b()),
						(g = this.m_perp.x * m + this.m_perp.y * g),
						(_ = A.Max(_, A.Abs(g)));
					d
						? ((a = this.m_invMassA),
						  (l = this.m_invMassB),
						  (h = this.m_invIA),
						  (u = this.m_invIB),
						  (this.m_K.col1.x =
								a +
								l +
								h * this.m_s1 * this.m_s1 +
								u * this.m_s2 * this.m_s2),
						  (this.m_K.col1.y =
								h * this.m_s1 * this.m_a1 +
								u * this.m_s2 * this.m_a2),
						  (this.m_K.col2.x = this.m_K.col1.y),
						  (this.m_K.col2.y =
								a +
								l +
								h * this.m_a1 * this.m_a1 +
								u * this.m_a2 * this.m_a2),
						  this.m_K.Solve(t, -g, -p))
						: ((a = this.m_invMassA),
						  (l = this.m_invMassB),
						  (h = this.m_invIA),
						  (u = this.m_invIB),
						  (x =
								(x = 0) !=
								(C =
									a +
									l +
									h * this.m_s1 * this.m_s1 +
									u * this.m_s2 * this.m_s2)
									? -g / C
									: 0),
						  (t.x = x),
						  (t.y = 0));
					var g = t.x * this.m_perp.x + t.y * this.m_axis.x,
						C = t.x * this.m_perp.y + t.y * this.m_axis.y,
						x = t.x * this.m_s1 + t.y * this.m_a1,
						t = t.x * this.m_s2 + t.y * this.m_a2;
					return (
						(n.x -= this.m_invMassA * g),
						(n.y -= this.m_invMassA * C),
						(r -= this.m_invIA * x),
						(o.x += this.m_invMassB * g),
						(o.y += this.m_invMassB * C),
						(s += this.m_invIB * t),
						(e.m_sweep.a = r),
						(i.m_sweep.a = s),
						e.SynchronizeTransform(),
						i.SynchronizeTransform(),
						_ <= v.b2_linearSlop && 0 <= v.b2_angularSlop
					);
				}),
				Box2D.inherit(u, Box2D.Dynamics.Joints.b2JointDef),
				(u.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(u.b2LineJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.localAnchorA = new b()),
						(this.localAnchorB = new b()),
						(this.localAxisA = new b());
				}),
				(u.prototype.b2LineJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_lineJoint),
						this.localAxisA.Set(1, 0),
						(this.enableLimit = !1),
						(this.lowerTranslation = 0),
						(this.upperTranslation = 0),
						(this.enableMotor = !1),
						(this.maxMotorForce = 0),
						(this.motorSpeed = 0);
				}),
				(u.prototype.Initialize = function (t, e, i, n) {
					(this.bodyA = t),
						(this.bodyB = e),
						(this.localAnchorA = this.bodyA.GetLocalPoint(i)),
						(this.localAnchorB = this.bodyB.GetLocalPoint(i)),
						(this.localAxisA = this.bodyA.GetLocalVector(n));
				}),
				Box2D.inherit(_, Box2D.Dynamics.Joints.b2Joint),
				(_.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(_.b2MouseJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.K = new E()),
						(this.K1 = new E()),
						(this.K2 = new E()),
						(this.m_localAnchor = new b()),
						(this.m_target = new b()),
						(this.m_impulse = new b()),
						(this.m_mass = new E()),
						(this.m_C = new b());
				}),
				(_.prototype.GetAnchorA = function () {
					return this.m_target;
				}),
				(_.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchor);
				}),
				(_.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(t * this.m_impulse.x, t * this.m_impulse.y)
					);
				}),
				(_.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), 0;
				}),
				(_.prototype.GetTarget = function () {
					return this.m_target;
				}),
				(_.prototype.SetTarget = function (t) {
					0 == this.m_bodyB.IsAwake() && this.m_bodyB.SetAwake(!0),
						(this.m_target = t);
				}),
				(_.prototype.GetMaxForce = function () {
					return this.m_maxForce;
				}),
				(_.prototype.SetMaxForce = function (t) {
					void 0 === t && (t = 0), (this.m_maxForce = t);
				}),
				(_.prototype.GetFrequency = function () {
					return this.m_frequencyHz;
				}),
				(_.prototype.SetFrequency = function (t) {
					void 0 === t && (t = 0), (this.m_frequencyHz = t);
				}),
				(_.prototype.GetDampingRatio = function () {
					return this.m_dampingRatio;
				}),
				(_.prototype.SetDampingRatio = function (t) {
					void 0 === t && (t = 0), (this.m_dampingRatio = t);
				}),
				(_.prototype.b2MouseJoint = function (t) {
					this.__super.b2Joint.call(this, t),
						this.m_target.SetV(t.target);
					var e = this.m_target.x - this.m_bodyB.m_xf.position.x,
						i = this.m_target.y - this.m_bodyB.m_xf.position.y,
						n = this.m_bodyB.m_xf.R;
					(this.m_localAnchor.x = e * n.col1.x + i * n.col1.y),
						(this.m_localAnchor.y = e * n.col2.x + i * n.col2.y),
						(this.m_maxForce = t.maxForce),
						this.m_impulse.SetZero(),
						(this.m_frequencyHz = t.frequencyHz),
						(this.m_dampingRatio = t.dampingRatio),
						(this.m_beta = 0),
						(this.m_gamma = 0);
				}),
				(_.prototype.InitVelocityConstraints = function (t) {
					var e = this.m_bodyB,
						i = e.GetMass(),
						n = 2 * Math.PI * this.m_frequencyHz,
						r = 2 * i * this.m_dampingRatio * n,
						o = i * n * n;
					(this.m_gamma = t.dt * (r + t.dt * o)),
						(this.m_gamma =
							0 != this.m_gamma ? 1 / this.m_gamma : 0),
						(this.m_beta = t.dt * o * this.m_gamma),
						(i = e.m_xf.R);
					(n = this.m_localAnchor.x - e.m_sweep.localCenter.x),
						(r = this.m_localAnchor.y - e.m_sweep.localCenter.y),
						(o = i.col1.x * n + i.col2.x * r),
						(r = i.col1.y * n + i.col2.y * r),
						(n = o),
						(i = e.m_invMass),
						(o = e.m_invI);
					(this.K1.col1.x = i),
						(this.K1.col2.x = 0),
						(this.K1.col1.y = 0),
						(this.K1.col2.y = i),
						(this.K2.col1.x = o * r * r),
						(this.K2.col2.x = -o * n * r),
						(this.K2.col1.y = -o * n * r),
						(this.K2.col2.y = o * n * n),
						this.K.SetM(this.K1),
						this.K.AddM(this.K2),
						(this.K.col1.x += this.m_gamma),
						(this.K.col2.y += this.m_gamma),
						this.K.GetInverse(this.m_mass),
						(this.m_C.x = e.m_sweep.c.x + n - this.m_target.x),
						(this.m_C.y = e.m_sweep.c.y + r - this.m_target.y),
						(e.m_angularVelocity *= 0.98),
						(this.m_impulse.x *= t.dtRatio),
						(this.m_impulse.y *= t.dtRatio),
						(e.m_linearVelocity.x += i * this.m_impulse.x),
						(e.m_linearVelocity.y += i * this.m_impulse.y),
						(e.m_angularVelocity +=
							o * (n * this.m_impulse.y - r * this.m_impulse.x));
				}),
				(_.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyB,
						i = e.m_xf.R,
						n = this.m_localAnchor.x - e.m_sweep.localCenter.x,
						r = this.m_localAnchor.y - e.m_sweep.localCenter.y,
						o = i.col1.x * n + i.col2.x * r,
						r = i.col1.y * n + i.col2.y * r,
						n = o,
						s = e.m_linearVelocity.x + -e.m_angularVelocity * r,
						c = e.m_linearVelocity.y + e.m_angularVelocity * n;
					(i = this.m_mass),
						(o =
							s +
							this.m_beta * this.m_C.x +
							this.m_gamma * this.m_impulse.x),
						(a =
							c +
							this.m_beta * this.m_C.y +
							this.m_gamma * this.m_impulse.y);
					var c = -(i.col1.x * o + i.col2.x * a),
						o = -(i.col1.y * o + i.col2.y * a),
						i = this.m_impulse.x,
						a = this.m_impulse.y;
					(this.m_impulse.x += c), (this.m_impulse.y += o);
					t = t.dt * this.m_maxForce;
					this.m_impulse.LengthSquared() > t * t &&
						this.m_impulse.Multiply(t / this.m_impulse.Length()),
						(c = this.m_impulse.x - i),
						(o = this.m_impulse.y - a),
						(e.m_linearVelocity.x += e.m_invMass * c),
						(e.m_linearVelocity.y += e.m_invMass * o),
						(e.m_angularVelocity += e.m_invI * (n * o - r * c));
				}),
				(_.prototype.SolvePositionConstraints = function (t) {
					return void 0 === t && (t = 0), !0;
				}),
				Box2D.inherit(d, Box2D.Dynamics.Joints.b2JointDef),
				(d.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(d.b2MouseJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.target = new b());
				}),
				(d.prototype.b2MouseJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_mouseJoint),
						(this.maxForce = 0),
						(this.frequencyHz = 5),
						(this.dampingRatio = 0.7);
				}),
				Box2D.inherit(p, Box2D.Dynamics.Joints.b2Joint),
				(p.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(p.b2PrismaticJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.m_localAnchor1 = new b()),
						(this.m_localAnchor2 = new b()),
						(this.m_localXAxis1 = new b()),
						(this.m_localYAxis1 = new b()),
						(this.m_axis = new b()),
						(this.m_perp = new b()),
						(this.m_K = new e()),
						(this.m_impulse = new R());
				}),
				(p.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
				}),
				(p.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
				}),
				(p.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(
							t *
								(this.m_impulse.x * this.m_perp.x +
									(this.m_motorImpulse + this.m_impulse.z) *
										this.m_axis.x),
							t *
								(this.m_impulse.x * this.m_perp.y +
									(this.m_motorImpulse + this.m_impulse.z) *
										this.m_axis.y)
						)
					);
				}),
				(p.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), t * this.m_impulse.y;
				}),
				(p.prototype.GetJointTranslation = function () {
					var t = this.m_bodyA,
						e = this.m_bodyB,
						i = t.GetWorldPoint(this.m_localAnchor1),
						n = e.GetWorldPoint(this.m_localAnchor2),
						e = n.x - i.x,
						i = n.y - i.y,
						t = t.GetWorldVector(this.m_localXAxis1);
					return t.x * e + t.y * i;
				}),
				(p.prototype.GetJointSpeed = function () {
					var t = this.m_bodyA,
						e = this.m_bodyB,
						i = t.m_xf.R,
						n = this.m_localAnchor1.x - t.m_sweep.localCenter.x,
						r = this.m_localAnchor1.y - t.m_sweep.localCenter.y,
						o = i.col1.x * n + i.col2.x * r,
						r = i.col1.y * n + i.col2.y * r,
						n = o;
					i = e.m_xf.R;
					var s = this.m_localAnchor2.x - e.m_sweep.localCenter.x,
						c = this.m_localAnchor2.y - e.m_sweep.localCenter.y,
						o = i.col1.x * s + i.col2.x * c,
						c = i.col1.y * s + i.col2.y * c,
						s = o,
						a = t.m_sweep.c.x + n,
						l = t.m_sweep.c.y + r,
						h = e.m_sweep.c.x + s - a,
						i = e.m_sweep.c.y + c - l,
						o = t.GetWorldVector(this.m_localXAxis1),
						a = t.m_linearVelocity,
						l = e.m_linearVelocity,
						t = t.m_angularVelocity,
						e = e.m_angularVelocity;
					return (
						h * (-t * o.y) +
						i * (t * o.x) +
						(o.x * (l.x + -e * c - a.x - -t * r) +
							o.y * (l.y + e * s - a.y - t * n))
					);
				}),
				(p.prototype.IsLimitEnabled = function () {
					return this.m_enableLimit;
				}),
				(p.prototype.EnableLimit = function (t) {
					this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_enableLimit = t);
				}),
				(p.prototype.GetLowerLimit = function () {
					return this.m_lowerTranslation;
				}),
				(p.prototype.GetUpperLimit = function () {
					return this.m_upperTranslation;
				}),
				(p.prototype.SetLimits = function (t, e) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_lowerTranslation = t),
						(this.m_upperTranslation = e);
				}),
				(p.prototype.IsMotorEnabled = function () {
					return this.m_enableMotor;
				}),
				(p.prototype.EnableMotor = function (t) {
					this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_enableMotor = t);
				}),
				(p.prototype.SetMotorSpeed = function (t) {
					void 0 === t && (t = 0),
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_motorSpeed = t);
				}),
				(p.prototype.GetMotorSpeed = function () {
					return this.m_motorSpeed;
				}),
				(p.prototype.SetMaxMotorForce = function (t) {
					void 0 === t && (t = 0),
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_maxMotorForce = t);
				}),
				(p.prototype.GetMotorForce = function () {
					return this.m_motorImpulse;
				}),
				(p.prototype.b2PrismaticJoint = function (t) {
					this.__super.b2Joint.call(this, t);
					this.m_localAnchor1.SetV(t.localAnchorA),
						this.m_localAnchor2.SetV(t.localAnchorB),
						this.m_localXAxis1.SetV(t.localAxisA),
						(this.m_localYAxis1.x = -this.m_localXAxis1.y),
						(this.m_localYAxis1.y = this.m_localXAxis1.x),
						(this.m_refAngle = t.referenceAngle),
						this.m_impulse.SetZero(),
						(this.m_motorMass = 0),
						(this.m_motorImpulse = 0),
						(this.m_lowerTranslation = t.lowerTranslation),
						(this.m_upperTranslation = t.upperTranslation),
						(this.m_maxMotorForce = t.maxMotorForce),
						(this.m_motorSpeed = t.motorSpeed),
						(this.m_enableLimit = t.enableLimit),
						(this.m_enableMotor = t.enableMotor),
						(this.m_limitState = C.e_inactiveLimit),
						this.m_axis.SetZero(),
						this.m_perp.SetZero();
				}),
				(p.prototype.InitVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = 0;
					this.m_localCenterA.SetV(e.GetLocalCenter()),
						this.m_localCenterB.SetV(i.GetLocalCenter());
					var r = e.GetTransform(),
						o = (i.GetTransform(), e.m_xf.R),
						s = this.m_localAnchor1.x - this.m_localCenterA.x,
						c = this.m_localAnchor1.y - this.m_localCenterA.y,
						n = o.col1.x * s + o.col2.x * c,
						c = o.col1.y * s + o.col2.y * c,
						s = n;
					o = i.m_xf.R;
					var a = this.m_localAnchor2.x - this.m_localCenterB.x,
						l = this.m_localAnchor2.y - this.m_localCenterB.y;
					(n = o.col1.x * a + o.col2.x * l),
						(l = o.col1.y * a + o.col2.y * l),
						(a = n);
					(o = i.m_sweep.c.x + a - e.m_sweep.c.x - s),
						(n = i.m_sweep.c.y + l - e.m_sweep.c.y - c);
					(this.m_invMassA = e.m_invMass),
						(this.m_invMassB = i.m_invMass),
						(this.m_invIA = e.m_invI),
						(this.m_invIB = i.m_invI),
						this.m_axis.SetV(A.MulMV(r.R, this.m_localXAxis1)),
						(this.m_a1 =
							(o + s) * this.m_axis.y - (n + c) * this.m_axis.x),
						(this.m_a2 = a * this.m_axis.y - l * this.m_axis.x),
						(this.m_motorMass =
							this.m_invMassA +
							this.m_invMassB +
							this.m_invIA * this.m_a1 * this.m_a1 +
							this.m_invIB * this.m_a2 * this.m_a2),
						this.m_motorMass > Number.MIN_VALUE &&
							(this.m_motorMass = 1 / this.m_motorMass),
						this.m_perp.SetV(A.MulMV(r.R, this.m_localYAxis1)),
						(this.m_s1 =
							(o + s) * this.m_perp.y - (n + c) * this.m_perp.x),
						(this.m_s2 = a * this.m_perp.y - l * this.m_perp.x);
					var h,
						s = this.m_invMassA,
						c = this.m_invMassB,
						a = this.m_invIA,
						l = this.m_invIB;
					(this.m_K.col1.x =
						s +
						c +
						a * this.m_s1 * this.m_s1 +
						l * this.m_s2 * this.m_s2),
						(this.m_K.col1.y = a * this.m_s1 + l * this.m_s2),
						(this.m_K.col1.z =
							a * this.m_s1 * this.m_a1 +
							l * this.m_s2 * this.m_a2),
						(this.m_K.col2.x = this.m_K.col1.y),
						(this.m_K.col2.y = a + l),
						(this.m_K.col2.z = a * this.m_a1 + l * this.m_a2),
						(this.m_K.col3.x = this.m_K.col1.z),
						(this.m_K.col3.y = this.m_K.col2.z),
						(this.m_K.col3.z =
							s +
							c +
							a * this.m_a1 * this.m_a1 +
							l * this.m_a2 * this.m_a2),
						this.m_enableLimit
							? ((h = this.m_axis.x * o + this.m_axis.y * n),
							  A.Abs(
									this.m_upperTranslation -
										this.m_lowerTranslation
							  ) <
							  2 * v.b2_linearSlop
									? (this.m_limitState = C.e_equalLimits)
									: h <= this.m_lowerTranslation
									? this.m_limitState != C.e_atLowerLimit &&
									  ((this.m_limitState = C.e_atLowerLimit),
									  (this.m_impulse.z = 0))
									: h >= this.m_upperTranslation
									? this.m_limitState != C.e_atUpperLimit &&
									  ((this.m_limitState = C.e_atUpperLimit),
									  (this.m_impulse.z = 0))
									: ((this.m_limitState = C.e_inactiveLimit),
									  (this.m_impulse.z = 0)))
							: (this.m_limitState = C.e_inactiveLimit),
						0 == this.m_enableMotor && (this.m_motorImpulse = 0),
						t.warmStarting
							? ((this.m_impulse.x *= t.dtRatio),
							  (this.m_impulse.y *= t.dtRatio),
							  (this.m_motorImpulse *= t.dtRatio),
							  (o =
									this.m_impulse.x * this.m_perp.x +
									(this.m_motorImpulse + this.m_impulse.z) *
										this.m_axis.x),
							  (n =
									this.m_impulse.x * this.m_perp.y +
									(this.m_motorImpulse + this.m_impulse.z) *
										this.m_axis.y),
							  (h =
									this.m_impulse.x * this.m_s1 +
									this.m_impulse.y +
									(this.m_motorImpulse + this.m_impulse.z) *
										this.m_a1),
							  (t =
									this.m_impulse.x * this.m_s2 +
									this.m_impulse.y +
									(this.m_motorImpulse + this.m_impulse.z) *
										this.m_a2),
							  (e.m_linearVelocity.x -= this.m_invMassA * o),
							  (e.m_linearVelocity.y -= this.m_invMassA * n),
							  (e.m_angularVelocity -= this.m_invIA * h),
							  (i.m_linearVelocity.x += this.m_invMassB * o),
							  (i.m_linearVelocity.y += this.m_invMassB * n),
							  (i.m_angularVelocity += this.m_invIB * t))
							: (this.m_impulse.SetZero(),
							  (this.m_motorImpulse = 0));
				}),
				(p.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_linearVelocity,
						r = e.m_angularVelocity,
						o = i.m_linearVelocity,
						s = i.m_angularVelocity,
						c = 0,
						a = 0,
						l = 0,
						h = 0;
					this.m_enableMotor &&
						this.m_limitState != C.e_equalLimits &&
						((f =
							this.m_axis.x * (o.x - n.x) +
							this.m_axis.y * (o.y - n.y) +
							this.m_a2 * s -
							this.m_a1 * r),
						(d = this.m_motorMass * (this.m_motorSpeed - f)),
						(_ = this.m_motorImpulse),
						(u = t.dt * this.m_maxMotorForce),
						(this.m_motorImpulse = A.Clamp(
							this.m_motorImpulse + d,
							-u,
							u
						)),
						(c = (d = this.m_motorImpulse - _) * this.m_axis.x),
						(a = d * this.m_axis.y),
						(l = d * this.m_a1),
						(h = d * this.m_a2),
						(n.x -= this.m_invMassA * c),
						(n.y -= this.m_invMassA * a),
						(r -= this.m_invIA * l),
						(o.x += this.m_invMassB * c),
						(o.y += this.m_invMassB * a),
						(s += this.m_invIB * h));
					var u,
						_,
						d,
						p =
							this.m_perp.x * (o.x - n.x) +
							this.m_perp.y * (o.y - n.y) +
							this.m_s2 * s -
							this.m_s1 * r,
						f = s - r;
					(h =
						this.m_enableLimit &&
						this.m_limitState != C.e_inactiveLimit
							? ((t =
									this.m_axis.x * (o.x - n.x) +
									this.m_axis.y * (o.y - n.y) +
									this.m_a2 * s -
									this.m_a1 * r),
							  (u = this.m_impulse.Copy()),
							  (_ = this.m_K.Solve33(new R(), -p, -f, -t)),
							  this.m_impulse.Add(_),
							  this.m_limitState == C.e_atLowerLimit
									? (this.m_impulse.z = A.Max(
											this.m_impulse.z,
											0
									  ))
									: this.m_limitState == C.e_atUpperLimit &&
									  (this.m_impulse.z = A.Min(
											this.m_impulse.z,
											0
									  )),
							  (d =
									-p -
									(this.m_impulse.z - u.z) * this.m_K.col3.x),
							  (t =
									-f -
									(this.m_impulse.z - u.z) * this.m_K.col3.y),
							  ((t = this.m_K.Solve22(new b(), d, t)).x += u.x),
							  (t.y += u.y),
							  (this.m_impulse.x = t.x),
							  (this.m_impulse.y = t.y),
							  (_.x = this.m_impulse.x - u.x),
							  (_.y = this.m_impulse.y - u.y),
							  (_.z = this.m_impulse.z - u.z),
							  (c = _.x * this.m_perp.x + _.z * this.m_axis.x),
							  (a = _.x * this.m_perp.y + _.z * this.m_axis.y),
							  (l = _.x * this.m_s1 + _.y + _.z * this.m_a1),
							  _.x * this.m_s2 + _.y + _.z * this.m_a2)
							: ((f = this.m_K.Solve22(new b(), -p, -f)),
							  (this.m_impulse.x += f.x),
							  (this.m_impulse.y += f.y),
							  (c = f.x * this.m_perp.x),
							  (a = f.x * this.m_perp.y),
							  (l = f.x * this.m_s1 + f.y),
							  f.x * this.m_s2 + f.y)),
						(n.x -= this.m_invMassA * c),
						(n.y -= this.m_invMassA * a),
						(r -= this.m_invIA * l),
						(o.x += this.m_invMassB * c),
						(o.y += this.m_invMassB * a),
						(s += this.m_invIB * h),
						e.m_linearVelocity.SetV(n),
						(e.m_angularVelocity = r),
						i.m_linearVelocity.SetV(o),
						(i.m_angularVelocity = s);
				}),
				(p.prototype.SolvePositionConstraints = function (t) {
					void 0 === t && (t = 0);
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_sweep.c,
						r = e.m_sweep.a,
						o = i.m_sweep.c,
						s = i.m_sweep.a,
						c = 0,
						a = 0,
						l = 0,
						h = 0,
						u = 0,
						_ = 0,
						d = !1,
						p = 0,
						f = E.FromAngle(r),
						m = E.FromAngle(s),
						g = f,
						y = this.m_localAnchor1.x - this.m_localCenterA.x,
						T = this.m_localAnchor1.y - this.m_localCenterA.y,
						c = g.col1.x * y + g.col2.x * T,
						T = g.col1.y * y + g.col2.y * T,
						y = c;
					g = m;
					var S = this.m_localAnchor2.x - this.m_localCenterB.x,
						t = this.m_localAnchor2.y - this.m_localCenterB.y;
					(c = g.col1.x * S + g.col2.x * t),
						(t = g.col1.y * S + g.col2.y * t),
						(S = c);
					(m = o.x + S - n.x - y), (g = o.y + t - n.y - T);
					this.m_enableLimit &&
						((this.m_axis = A.MulMV(f, this.m_localXAxis1)),
						(this.m_a1 =
							(m + y) * this.m_axis.y - (g + T) * this.m_axis.x),
						(this.m_a2 = S * this.m_axis.y - t * this.m_axis.x),
						(c = this.m_axis.x * m + this.m_axis.y * g),
						A.Abs(
							this.m_upperTranslation - this.m_lowerTranslation
						) <
						2 * v.b2_linearSlop
							? ((p = A.Clamp(
									c,
									-v.b2_maxLinearCorrection,
									v.b2_maxLinearCorrection
							  )),
							  (_ = A.Abs(c)),
							  (d = !0))
							: c <= this.m_lowerTranslation
							? ((p = A.Clamp(
									c -
										this.m_lowerTranslation +
										v.b2_linearSlop,
									-v.b2_maxLinearCorrection,
									0
							  )),
							  (_ = this.m_lowerTranslation - c),
							  (d = !0))
							: c >= this.m_upperTranslation &&
							  ((p = A.Clamp(
									c -
										this.m_upperTranslation +
										v.b2_linearSlop,
									0,
									v.b2_maxLinearCorrection
							  )),
							  (_ = c - this.m_upperTranslation),
							  (d = !0))),
						(this.m_perp = A.MulMV(f, this.m_localYAxis1)),
						(this.m_s1 =
							(m + y) * this.m_perp.y - (g + T) * this.m_perp.x),
						(this.m_s2 = S * this.m_perp.y - t * this.m_perp.x);
					var t = new R(),
						m = this.m_perp.x * m + this.m_perp.y * g,
						g = s - r - this.m_refAngle,
						_ = A.Max(_, A.Abs(m)),
						C = A.Abs(g);
					d
						? ((a = this.m_invMassA),
						  (l = this.m_invMassB),
						  (h = this.m_invIA),
						  (u = this.m_invIB),
						  (this.m_K.col1.x =
								a +
								l +
								h * this.m_s1 * this.m_s1 +
								u * this.m_s2 * this.m_s2),
						  (this.m_K.col1.y = h * this.m_s1 + u * this.m_s2),
						  (this.m_K.col1.z =
								h * this.m_s1 * this.m_a1 +
								u * this.m_s2 * this.m_a2),
						  (this.m_K.col2.x = this.m_K.col1.y),
						  (this.m_K.col2.y = h + u),
						  (this.m_K.col2.z = h * this.m_a1 + u * this.m_a2),
						  (this.m_K.col3.x = this.m_K.col1.z),
						  (this.m_K.col3.y = this.m_K.col2.z),
						  (this.m_K.col3.z =
								a +
								l +
								h * this.m_a1 * this.m_a1 +
								u * this.m_a2 * this.m_a2),
						  this.m_K.Solve33(t, -m, -g, -p))
						: ((a = this.m_invMassA),
						  (l = this.m_invMassB),
						  (h = this.m_invIA),
						  (u = this.m_invIB),
						  (a =
								a +
								l +
								h * this.m_s1 * this.m_s1 +
								u * this.m_s2 * this.m_s2),
						  (l = h * this.m_s1 + u * this.m_s2),
						  (x = h + u),
						  this.m_K.col1.Set(a, l, 0),
						  this.m_K.col2.Set(l, x, 0),
						  (x = this.m_K.Solve22(new b(), -m, -g)),
						  (t.x = x.x),
						  (t.y = x.y),
						  (t.z = 0));
					var m = t.x * this.m_perp.x + t.z * this.m_axis.x,
						g = t.x * this.m_perp.y + t.z * this.m_axis.y,
						x = t.x * this.m_s1 + t.y + t.z * this.m_a1,
						t = t.x * this.m_s2 + t.y + t.z * this.m_a2;
					return (
						(n.x -= this.m_invMassA * m),
						(n.y -= this.m_invMassA * g),
						(r -= this.m_invIA * x),
						(o.x += this.m_invMassB * m),
						(o.y += this.m_invMassB * g),
						(s += this.m_invIB * t),
						(e.m_sweep.a = r),
						(i.m_sweep.a = s),
						e.SynchronizeTransform(),
						i.SynchronizeTransform(),
						_ <= v.b2_linearSlop && C <= v.b2_angularSlop
					);
				}),
				Box2D.inherit(f, Box2D.Dynamics.Joints.b2JointDef),
				(f.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(f.b2PrismaticJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.localAnchorA = new b()),
						(this.localAnchorB = new b()),
						(this.localAxisA = new b());
				}),
				(f.prototype.b2PrismaticJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_prismaticJoint),
						this.localAxisA.Set(1, 0),
						(this.referenceAngle = 0),
						(this.enableLimit = !1),
						(this.lowerTranslation = 0),
						(this.upperTranslation = 0),
						(this.enableMotor = !1),
						(this.maxMotorForce = 0),
						(this.motorSpeed = 0);
				}),
				(f.prototype.Initialize = function (t, e, i, n) {
					(this.bodyA = t),
						(this.bodyB = e),
						(this.localAnchorA = this.bodyA.GetLocalPoint(i)),
						(this.localAnchorB = this.bodyB.GetLocalPoint(i)),
						(this.localAxisA = this.bodyA.GetLocalVector(n)),
						(this.referenceAngle =
							this.bodyB.GetAngle() - this.bodyA.GetAngle());
				}),
				Box2D.inherit(m, Box2D.Dynamics.Joints.b2Joint),
				(m.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(m.b2PulleyJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.m_groundAnchor1 = new b()),
						(this.m_groundAnchor2 = new b()),
						(this.m_localAnchor1 = new b()),
						(this.m_localAnchor2 = new b()),
						(this.m_u1 = new b()),
						(this.m_u2 = new b());
				}),
				(m.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
				}),
				(m.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
				}),
				(m.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(
							t * this.m_impulse * this.m_u2.x,
							t * this.m_impulse * this.m_u2.y
						)
					);
				}),
				(m.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), 0;
				}),
				(m.prototype.GetGroundAnchorA = function () {
					var t = this.m_ground.m_xf.position.Copy();
					return t.Add(this.m_groundAnchor1), t;
				}),
				(m.prototype.GetGroundAnchorB = function () {
					var t = this.m_ground.m_xf.position.Copy();
					return t.Add(this.m_groundAnchor2), t;
				}),
				(m.prototype.GetLength1 = function () {
					var t = this.m_bodyA.GetWorldPoint(this.m_localAnchor1),
						e =
							this.m_ground.m_xf.position.x +
							this.m_groundAnchor1.x,
						i =
							this.m_ground.m_xf.position.y +
							this.m_groundAnchor1.y,
						e = t.x - e,
						i = t.y - i;
					return Math.sqrt(e * e + i * i);
				}),
				(m.prototype.GetLength2 = function () {
					var t = this.m_bodyB.GetWorldPoint(this.m_localAnchor2),
						e =
							this.m_ground.m_xf.position.x +
							this.m_groundAnchor2.x,
						i =
							this.m_ground.m_xf.position.y +
							this.m_groundAnchor2.y,
						e = t.x - e,
						i = t.y - i;
					return Math.sqrt(e * e + i * i);
				}),
				(m.prototype.GetRatio = function () {
					return this.m_ratio;
				}),
				(m.prototype.b2PulleyJoint = function (t) {
					this.__super.b2Joint.call(this, t);
					(this.m_ground = this.m_bodyA.m_world.m_groundBody),
						(this.m_groundAnchor1.x =
							t.groundAnchorA.x - this.m_ground.m_xf.position.x),
						(this.m_groundAnchor1.y =
							t.groundAnchorA.y - this.m_ground.m_xf.position.y),
						(this.m_groundAnchor2.x =
							t.groundAnchorB.x - this.m_ground.m_xf.position.x),
						(this.m_groundAnchor2.y =
							t.groundAnchorB.y - this.m_ground.m_xf.position.y),
						this.m_localAnchor1.SetV(t.localAnchorA),
						this.m_localAnchor2.SetV(t.localAnchorB),
						(this.m_ratio = t.ratio),
						(this.m_constant =
							t.lengthA + this.m_ratio * t.lengthB),
						(this.m_maxLength1 = A.Min(
							t.maxLengthA,
							this.m_constant -
								this.m_ratio * m.b2_minPulleyLength
						)),
						(this.m_maxLength2 = A.Min(
							t.maxLengthB,
							(this.m_constant - m.b2_minPulleyLength) /
								this.m_ratio
						)),
						(this.m_impulse = 0),
						(this.m_limitImpulse1 = 0),
						(this.m_limitImpulse2 = 0);
				}),
				(m.prototype.InitVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_xf.R,
						r = this.m_localAnchor1.x - e.m_sweep.localCenter.x,
						o = this.m_localAnchor1.y - e.m_sweep.localCenter.y,
						s = n.col1.x * r + n.col2.x * o,
						o = n.col1.y * r + n.col2.y * o,
						r = s;
					n = i.m_xf.R;
					var c = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchor2.y - i.m_sweep.localCenter.y,
						s = n.col1.x * c + n.col2.x * a,
						a = n.col1.y * c + n.col2.y * a,
						c = s,
						l = e.m_sweep.c.x + r,
						h = e.m_sweep.c.y + o,
						u = i.m_sweep.c.x + c,
						_ = i.m_sweep.c.y + a,
						d =
							this.m_ground.m_xf.position.x +
							this.m_groundAnchor1.x,
						p =
							this.m_ground.m_xf.position.y +
							this.m_groundAnchor1.y,
						n =
							this.m_ground.m_xf.position.x +
							this.m_groundAnchor2.x,
						s =
							this.m_ground.m_xf.position.y +
							this.m_groundAnchor2.y;
					this.m_u1.Set(l - d, h - p), this.m_u2.Set(u - n, _ - s);
					(n = this.m_u1.Length()), (_ = this.m_u2.Length());
					n > v.b2_linearSlop
						? this.m_u1.Multiply(1 / n)
						: this.m_u1.SetZero(),
						_ > v.b2_linearSlop
							? this.m_u2.Multiply(1 / _)
							: this.m_u2.SetZero(),
						0 < this.m_constant - n - this.m_ratio * _
							? ((this.m_state = C.e_inactiveLimit),
							  (this.m_impulse = 0))
							: (this.m_state = C.e_atUpperLimit),
						n < this.m_maxLength1
							? ((this.m_limitState1 = C.e_inactiveLimit),
							  (this.m_limitImpulse1 = 0))
							: (this.m_limitState1 = C.e_atUpperLimit),
						_ < this.m_maxLength2
							? ((this.m_limitState2 = C.e_inactiveLimit),
							  (this.m_limitImpulse2 = 0))
							: (this.m_limitState2 = C.e_atUpperLimit);
					(s = r * this.m_u1.y - o * this.m_u1.x),
						(n = c * this.m_u2.y - a * this.m_u2.x);
					(this.m_limitMass1 = e.m_invMass + e.m_invI * s * s),
						(this.m_limitMass2 = i.m_invMass + i.m_invI * n * n),
						(this.m_pulleyMass =
							this.m_limitMass1 +
							this.m_ratio * this.m_ratio * this.m_limitMass2),
						(this.m_limitMass1 = 1 / this.m_limitMass1),
						(this.m_limitMass2 = 1 / this.m_limitMass2),
						(this.m_pulleyMass = 1 / this.m_pulleyMass),
						t.warmStarting
							? ((this.m_impulse *= t.dtRatio),
							  (this.m_limitImpulse1 *= t.dtRatio),
							  (this.m_limitImpulse2 *= t.dtRatio),
							  (_ =
									(-this.m_impulse - this.m_limitImpulse1) *
									this.m_u1.x),
							  (s =
									(-this.m_impulse - this.m_limitImpulse1) *
									this.m_u1.y),
							  (n =
									(-this.m_ratio * this.m_impulse -
										this.m_limitImpulse2) *
									this.m_u2.x),
							  (t =
									(-this.m_ratio * this.m_impulse -
										this.m_limitImpulse2) *
									this.m_u2.y),
							  (e.m_linearVelocity.x += e.m_invMass * _),
							  (e.m_linearVelocity.y += e.m_invMass * s),
							  (e.m_angularVelocity +=
									e.m_invI * (r * s - o * _)),
							  (i.m_linearVelocity.x += i.m_invMass * n),
							  (i.m_linearVelocity.y += i.m_invMass * t),
							  (i.m_angularVelocity +=
									i.m_invI * (c * t - a * n)))
							: ((this.m_impulse = 0),
							  (this.m_limitImpulse1 = 0),
							  (this.m_limitImpulse2 = 0));
				}),
				(m.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_xf.R,
						r = this.m_localAnchor1.x - e.m_sweep.localCenter.x,
						o = this.m_localAnchor1.y - e.m_sweep.localCenter.y,
						s = n.col1.x * r + n.col2.x * o,
						o = n.col1.y * r + n.col2.y * o,
						r = s;
					n = i.m_xf.R;
					var c = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchor2.y - i.m_sweep.localCenter.y,
						s = n.col1.x * c + n.col2.x * a,
						a = n.col1.y * c + n.col2.y * a,
						c = s,
						l = 0,
						h = 0,
						u = 0,
						_ = 0,
						d = 0,
						p = 0,
						f = 0,
						m = 0,
						g = 0,
						n = 0,
						s = 0;
					this.m_state == C.e_atUpperLimit &&
						((l = e.m_linearVelocity.x + -e.m_angularVelocity * o),
						(h = e.m_linearVelocity.y + e.m_angularVelocity * r),
						(u = i.m_linearVelocity.x + -i.m_angularVelocity * a),
						(_ = i.m_linearVelocity.y + i.m_angularVelocity * c),
						(g =
							-(this.m_u1.x * l + this.m_u1.y * h) -
							this.m_ratio * (this.m_u2.x * u + this.m_u2.y * _)),
						(n = this.m_pulleyMass * -g),
						(s = this.m_impulse),
						(this.m_impulse = A.Max(0, this.m_impulse + n)),
						(d = -(n = this.m_impulse - s) * this.m_u1.x),
						(p = -n * this.m_u1.y),
						(f = -this.m_ratio * n * this.m_u2.x),
						(m = -this.m_ratio * n * this.m_u2.y),
						(e.m_linearVelocity.x += e.m_invMass * d),
						(e.m_linearVelocity.y += e.m_invMass * p),
						(e.m_angularVelocity += e.m_invI * (r * p - o * d)),
						(i.m_linearVelocity.x += i.m_invMass * f),
						(i.m_linearVelocity.y += i.m_invMass * m),
						(i.m_angularVelocity += i.m_invI * (c * m - a * f))),
						this.m_limitState1 == C.e_atUpperLimit &&
							((l =
								e.m_linearVelocity.x +
								-e.m_angularVelocity * o),
							(h =
								e.m_linearVelocity.y + e.m_angularVelocity * r),
							(g = -(this.m_u1.x * l + this.m_u1.y * h)),
							(n = -this.m_limitMass1 * g),
							(s = this.m_limitImpulse1),
							(this.m_limitImpulse1 = A.Max(
								0,
								this.m_limitImpulse1 + n
							)),
							(d = -(n = this.m_limitImpulse1 - s) * this.m_u1.x),
							(p = -n * this.m_u1.y),
							(e.m_linearVelocity.x += e.m_invMass * d),
							(e.m_linearVelocity.y += e.m_invMass * p),
							(e.m_angularVelocity +=
								e.m_invI * (r * p - o * d))),
						this.m_limitState2 == C.e_atUpperLimit &&
							((u =
								i.m_linearVelocity.x +
								-i.m_angularVelocity * a),
							(_ =
								i.m_linearVelocity.y + i.m_angularVelocity * c),
							(g = -(this.m_u2.x * u + this.m_u2.y * _)),
							(n = -this.m_limitMass2 * g),
							(s = this.m_limitImpulse2),
							(this.m_limitImpulse2 = A.Max(
								0,
								this.m_limitImpulse2 + n
							)),
							(f = -(n = this.m_limitImpulse2 - s) * this.m_u2.x),
							(m = -n * this.m_u2.y),
							(i.m_linearVelocity.x += i.m_invMass * f),
							(i.m_linearVelocity.y += i.m_invMass * m),
							(i.m_angularVelocity +=
								i.m_invI * (c * m - a * f)));
				}),
				(m.prototype.SolvePositionConstraints = function (t) {
					void 0 === t && (t = 0);
					var e,
						i = this.m_bodyA,
						n = this.m_bodyB,
						r =
							this.m_ground.m_xf.position.x +
							this.m_groundAnchor1.x,
						o =
							this.m_ground.m_xf.position.y +
							this.m_groundAnchor1.y,
						s =
							this.m_ground.m_xf.position.x +
							this.m_groundAnchor2.x,
						c =
							this.m_ground.m_xf.position.y +
							this.m_groundAnchor2.y,
						a = 0,
						l = 0,
						h = 0,
						u = 0,
						_ = 0,
						d = 0,
						p = 0,
						f = 0,
						m = 0,
						g = 0,
						y = 0,
						T = 0,
						S = 0,
						t = 0;
					return (
						this.m_state == C.e_atUpperLimit &&
							((e = i.m_xf.R),
							(a =
								this.m_localAnchor1.x -
								i.m_sweep.localCenter.x),
							(l =
								this.m_localAnchor1.y -
								i.m_sweep.localCenter.y),
							(S = e.col1.x * a + e.col2.x * l),
							(l = e.col1.y * a + e.col2.y * l),
							(a = S),
							(e = n.m_xf.R),
							(h =
								this.m_localAnchor2.x -
								n.m_sweep.localCenter.x),
							(u =
								this.m_localAnchor2.y -
								n.m_sweep.localCenter.y),
							(S = e.col1.x * h + e.col2.x * u),
							(u = e.col1.y * h + e.col2.y * u),
							(h = S),
							(_ = i.m_sweep.c.x + a),
							(d = i.m_sweep.c.y + l),
							(p = n.m_sweep.c.x + h),
							(f = n.m_sweep.c.y + u),
							this.m_u1.Set(_ - r, d - o),
							this.m_u2.Set(p - s, f - c),
							(m = this.m_u1.Length()),
							(g = this.m_u2.Length()),
							m > v.b2_linearSlop
								? this.m_u1.Multiply(1 / m)
								: this.m_u1.SetZero(),
							g > v.b2_linearSlop
								? this.m_u2.Multiply(1 / g)
								: this.m_u2.SetZero(),
							(y = this.m_constant - m - this.m_ratio * g),
							(t = A.Max(t, -y)),
							(y = A.Clamp(
								y + v.b2_linearSlop,
								-v.b2_maxLinearCorrection,
								0
							)),
							(_ = -(T = -this.m_pulleyMass * y) * this.m_u1.x),
							(d = -T * this.m_u1.y),
							(p = -this.m_ratio * T * this.m_u2.x),
							(f = -this.m_ratio * T * this.m_u2.y),
							(i.m_sweep.c.x += i.m_invMass * _),
							(i.m_sweep.c.y += i.m_invMass * d),
							(i.m_sweep.a += i.m_invI * (a * d - l * _)),
							(n.m_sweep.c.x += n.m_invMass * p),
							(n.m_sweep.c.y += n.m_invMass * f),
							(n.m_sweep.a += n.m_invI * (h * f - u * p)),
							i.SynchronizeTransform(),
							n.SynchronizeTransform()),
						this.m_limitState1 == C.e_atUpperLimit &&
							((e = i.m_xf.R),
							(a =
								this.m_localAnchor1.x -
								i.m_sweep.localCenter.x),
							(l =
								this.m_localAnchor1.y -
								i.m_sweep.localCenter.y),
							(S = e.col1.x * a + e.col2.x * l),
							(l = e.col1.y * a + e.col2.y * l),
							(a = S),
							(_ = i.m_sweep.c.x + a),
							(d = i.m_sweep.c.y + l),
							this.m_u1.Set(_ - r, d - o),
							(m = this.m_u1.Length()) > v.b2_linearSlop
								? ((this.m_u1.x *= 1 / m),
								  (this.m_u1.y *= 1 / m))
								: this.m_u1.SetZero(),
							(y = this.m_maxLength1 - m),
							(t = A.Max(t, -y)),
							(y = A.Clamp(
								y + v.b2_linearSlop,
								-v.b2_maxLinearCorrection,
								0
							)),
							(_ = -(T = -this.m_limitMass1 * y) * this.m_u1.x),
							(d = -T * this.m_u1.y),
							(i.m_sweep.c.x += i.m_invMass * _),
							(i.m_sweep.c.y += i.m_invMass * d),
							(i.m_sweep.a += i.m_invI * (a * d - l * _)),
							i.SynchronizeTransform()),
						this.m_limitState2 == C.e_atUpperLimit &&
							((e = n.m_xf.R),
							(h =
								this.m_localAnchor2.x -
								n.m_sweep.localCenter.x),
							(u =
								this.m_localAnchor2.y -
								n.m_sweep.localCenter.y),
							(S = e.col1.x * h + e.col2.x * u),
							(u = e.col1.y * h + e.col2.y * u),
							(h = S),
							(p = n.m_sweep.c.x + h),
							(f = n.m_sweep.c.y + u),
							this.m_u2.Set(p - s, f - c),
							(g = this.m_u2.Length()) > v.b2_linearSlop
								? ((this.m_u2.x *= 1 / g),
								  (this.m_u2.y *= 1 / g))
								: this.m_u2.SetZero(),
							(y = this.m_maxLength2 - g),
							(t = A.Max(t, -y)),
							(y = A.Clamp(
								y + v.b2_linearSlop,
								-v.b2_maxLinearCorrection,
								0
							)),
							(p = -(T = -this.m_limitMass2 * y) * this.m_u2.x),
							(f = -T * this.m_u2.y),
							(n.m_sweep.c.x += n.m_invMass * p),
							(n.m_sweep.c.y += n.m_invMass * f),
							(n.m_sweep.a += n.m_invI * (h * f - u * p)),
							n.SynchronizeTransform()),
						t < v.b2_linearSlop
					);
				}),
				Box2D.postDefs.push(function () {
					Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength = 2;
				}),
				Box2D.inherit(g, Box2D.Dynamics.Joints.b2JointDef),
				(g.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(g.b2PulleyJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.groundAnchorA = new b()),
						(this.groundAnchorB = new b()),
						(this.localAnchorA = new b()),
						(this.localAnchorB = new b());
				}),
				(g.prototype.b2PulleyJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_pulleyJoint),
						this.groundAnchorA.Set(-1, 1),
						this.groundAnchorB.Set(1, 1),
						this.localAnchorA.Set(-1, 0),
						this.localAnchorB.Set(1, 0),
						(this.lengthA = 0),
						(this.maxLengthA = 0),
						(this.lengthB = 0),
						(this.maxLengthB = 0),
						(this.ratio = 1),
						(this.collideConnected = !0);
				}),
				(g.prototype.Initialize = function (t, e, i, n, r, o, s) {
					void 0 === s && (s = 0),
						(this.bodyA = t),
						(this.bodyB = e),
						this.groundAnchorA.SetV(i),
						this.groundAnchorB.SetV(n),
						(this.localAnchorA = this.bodyA.GetLocalPoint(r)),
						(this.localAnchorB = this.bodyB.GetLocalPoint(o));
					(e = r.x - i.x), (i = r.y - i.y);
					this.lengthA = Math.sqrt(e * e + i * i);
					(i = o.x - n.x), (n = o.y - n.y);
					(this.lengthB = Math.sqrt(i * i + n * n)), (this.ratio = s);
					s = this.lengthA + this.ratio * this.lengthB;
					(this.maxLengthA = s - this.ratio * m.b2_minPulleyLength),
						(this.maxLengthB =
							(s - m.b2_minPulleyLength) / this.ratio);
				}),
				Box2D.inherit(T, Box2D.Dynamics.Joints.b2Joint),
				(T.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(T.b2RevoluteJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.K = new E()),
						(this.K1 = new E()),
						(this.K2 = new E()),
						(this.K3 = new E()),
						(this.impulse3 = new R()),
						(this.impulse2 = new b()),
						(this.reduced = new b()),
						(this.m_localAnchor1 = new b()),
						(this.m_localAnchor2 = new b()),
						(this.m_impulse = new R()),
						(this.m_mass = new e());
				}),
				(T.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
				}),
				(T.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
				}),
				(T.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(t * this.m_impulse.x, t * this.m_impulse.y)
					);
				}),
				(T.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), t * this.m_impulse.z;
				}),
				(T.prototype.GetJointAngle = function () {
					return (
						this.m_bodyB.m_sweep.a -
						this.m_bodyA.m_sweep.a -
						this.m_referenceAngle
					);
				}),
				(T.prototype.GetJointSpeed = function () {
					return (
						this.m_bodyB.m_angularVelocity -
						this.m_bodyA.m_angularVelocity
					);
				}),
				(T.prototype.IsLimitEnabled = function () {
					return this.m_enableLimit;
				}),
				(T.prototype.EnableLimit = function (t) {
					this.m_enableLimit = t;
				}),
				(T.prototype.GetLowerLimit = function () {
					return this.m_lowerAngle;
				}),
				(T.prototype.GetUpperLimit = function () {
					return this.m_upperAngle;
				}),
				(T.prototype.SetLimits = function (t, e) {
					void 0 === t && (t = 0),
						void 0 === e && (e = 0),
						(this.m_lowerAngle = t),
						(this.m_upperAngle = e);
				}),
				(T.prototype.IsMotorEnabled = function () {
					return (
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						this.m_enableMotor
					);
				}),
				(T.prototype.EnableMotor = function (t) {
					this.m_enableMotor = t;
				}),
				(T.prototype.SetMotorSpeed = function (t) {
					void 0 === t && (t = 0),
						this.m_bodyA.SetAwake(!0),
						this.m_bodyB.SetAwake(!0),
						(this.m_motorSpeed = t);
				}),
				(T.prototype.GetMotorSpeed = function () {
					return this.m_motorSpeed;
				}),
				(T.prototype.SetMaxMotorTorque = function (t) {
					void 0 === t && (t = 0), (this.m_maxMotorTorque = t);
				}),
				(T.prototype.GetMotorTorque = function () {
					return this.m_maxMotorTorque;
				}),
				(T.prototype.b2RevoluteJoint = function (t) {
					this.__super.b2Joint.call(this, t),
						this.m_localAnchor1.SetV(t.localAnchorA),
						this.m_localAnchor2.SetV(t.localAnchorB),
						(this.m_referenceAngle = t.referenceAngle),
						this.m_impulse.SetZero(),
						(this.m_motorImpulse = 0),
						(this.m_lowerAngle = t.lowerAngle),
						(this.m_upperAngle = t.upperAngle),
						(this.m_maxMotorTorque = t.maxMotorTorque),
						(this.m_motorSpeed = t.motorSpeed),
						(this.m_enableLimit = t.enableLimit),
						(this.m_enableMotor = t.enableMotor),
						(this.m_limitState = C.e_inactiveLimit);
				}),
				(T.prototype.InitVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB;
					this.m_enableMotor || this.m_enableLimit, (s = e.m_xf.R);
					var n = this.m_localAnchor1.x - e.m_sweep.localCenter.x,
						r = this.m_localAnchor1.y - e.m_sweep.localCenter.y,
						o = s.col1.x * n + s.col2.x * r,
						r = s.col1.y * n + s.col2.y * r,
						n = o,
						s = i.m_xf.R,
						c = this.m_localAnchor2.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchor2.y - i.m_sweep.localCenter.y;
					(o = s.col1.x * c + s.col2.x * a),
						(a = s.col1.y * c + s.col2.y * a),
						(c = o);
					var l,
						h = e.m_invMass,
						u = i.m_invMass,
						s = e.m_invI,
						o = i.m_invI;
					(this.m_mass.col1.x = h + u + r * r * s + a * a * o),
						(this.m_mass.col2.x = -r * n * s - a * c * o),
						(this.m_mass.col3.x = -r * s - a * o),
						(this.m_mass.col1.y = this.m_mass.col2.x),
						(this.m_mass.col2.y = h + u + n * n * s + c * c * o),
						(this.m_mass.col3.y = n * s + c * o),
						(this.m_mass.col1.z = this.m_mass.col3.x),
						(this.m_mass.col2.z = this.m_mass.col3.y),
						(this.m_mass.col3.z = s + o),
						(this.m_motorMass = 1 / (s + o)),
						0 == this.m_enableMotor && (this.m_motorImpulse = 0),
						this.m_enableLimit
							? ((l =
									i.m_sweep.a -
									e.m_sweep.a -
									this.m_referenceAngle),
							  A.Abs(this.m_upperAngle - this.m_lowerAngle) <
							  2 * v.b2_angularSlop
									? (this.m_limitState = C.e_equalLimits)
									: l <= this.m_lowerAngle
									? (this.m_limitState != C.e_atLowerLimit &&
											(this.m_impulse.z = 0),
									  (this.m_limitState = C.e_atLowerLimit))
									: l >= this.m_upperAngle
									? (this.m_limitState != C.e_atUpperLimit &&
											(this.m_impulse.z = 0),
									  (this.m_limitState = C.e_atUpperLimit))
									: ((this.m_limitState = C.e_inactiveLimit),
									  (this.m_impulse.z = 0)))
							: (this.m_limitState = C.e_inactiveLimit),
						t.warmStarting
							? ((this.m_impulse.x *= t.dtRatio),
							  (this.m_impulse.y *= t.dtRatio),
							  (this.m_motorImpulse *= t.dtRatio),
							  (l = this.m_impulse.x),
							  (t = this.m_impulse.y),
							  (e.m_linearVelocity.x -= h * l),
							  (e.m_linearVelocity.y -= h * t),
							  (e.m_angularVelocity -=
									s *
									(n * t -
										r * l +
										this.m_motorImpulse +
										this.m_impulse.z)),
							  (i.m_linearVelocity.x += u * l),
							  (i.m_linearVelocity.y += u * t),
							  (i.m_angularVelocity +=
									o *
									(c * t -
										a * l +
										this.m_motorImpulse +
										this.m_impulse.z)))
							: (this.m_impulse.SetZero(),
							  (this.m_motorImpulse = 0));
				}),
				(T.prototype.SolveVelocityConstraints = function (t) {
					var e,
						i,
						n,
						r,
						o = this.m_bodyA,
						s = this.m_bodyB,
						c = 0,
						a = 0,
						l = 0,
						h = 0,
						u = 0,
						_ = o.m_linearVelocity,
						d = o.m_angularVelocity,
						p = s.m_linearVelocity,
						f = s.m_angularVelocity,
						m = o.m_invMass,
						g = s.m_invMass,
						y = o.m_invI,
						T = s.m_invI;
					this.m_enableMotor &&
						this.m_limitState != C.e_equalLimits &&
						((e = f - d - this.m_motorSpeed),
						(n = this.m_motorMass * -e),
						(i = this.m_motorImpulse),
						(e = t.dt * this.m_maxMotorTorque),
						(this.m_motorImpulse = A.Clamp(
							this.m_motorImpulse + n,
							-e,
							e
						)),
						(d -= y * (n = this.m_motorImpulse - i)),
						(f += T * n)),
						this.m_enableLimit &&
						this.m_limitState != C.e_inactiveLimit
							? ((r = o.m_xf.R),
							  (a =
									this.m_localAnchor1.x -
									o.m_sweep.localCenter.x),
							  (l =
									this.m_localAnchor1.y -
									o.m_sweep.localCenter.y),
							  (c = r.col1.x * a + r.col2.x * l),
							  (l = r.col1.y * a + r.col2.y * l),
							  (a = c),
							  (r = s.m_xf.R),
							  (h =
									this.m_localAnchor2.x -
									s.m_sweep.localCenter.x),
							  (u =
									this.m_localAnchor2.y -
									s.m_sweep.localCenter.y),
							  (c = r.col1.x * h + r.col2.x * u),
							  (u = r.col1.y * h + r.col2.y * u),
							  (h = c),
							  (e = p.x + -f * u - _.x - -d * l),
							  (i = p.y + f * h - _.y - d * a),
							  (n = f - d),
							  this.m_mass.Solve33(this.impulse3, -e, -i, -n),
							  this.m_limitState == C.e_equalLimits
									? this.m_impulse.Add(this.impulse3)
									: this.m_limitState == C.e_atLowerLimit
									? this.m_impulse.z + this.impulse3.z < 0 &&
									  (this.m_mass.Solve22(
											this.reduced,
											-e,
											-i
									  ),
									  (this.impulse3.x = this.reduced.x),
									  (this.impulse3.y = this.reduced.y),
									  (this.impulse3.z = -this.m_impulse.z),
									  (this.m_impulse.x += this.reduced.x),
									  (this.m_impulse.y += this.reduced.y),
									  (this.m_impulse.z = 0))
									: this.m_limitState == C.e_atUpperLimit &&
									  0 < this.m_impulse.z + this.impulse3.z &&
									  (this.m_mass.Solve22(
											this.reduced,
											-e,
											-i
									  ),
									  (this.impulse3.x = this.reduced.x),
									  (this.impulse3.y = this.reduced.y),
									  (this.impulse3.z = -this.m_impulse.z),
									  (this.m_impulse.x += this.reduced.x),
									  (this.m_impulse.y += this.reduced.y),
									  (this.m_impulse.z = 0)),
							  (_.x -= m * this.impulse3.x),
							  (_.y -= m * this.impulse3.y),
							  (d -=
									y *
									(a * this.impulse3.y -
										l * this.impulse3.x +
										this.impulse3.z)),
							  (p.x += g * this.impulse3.x),
							  (p.y += g * this.impulse3.y),
							  (f +=
									T *
									(h * this.impulse3.y -
										u * this.impulse3.x +
										this.impulse3.z)))
							: ((r = o.m_xf.R),
							  (a =
									this.m_localAnchor1.x -
									o.m_sweep.localCenter.x),
							  (l =
									this.m_localAnchor1.y -
									o.m_sweep.localCenter.y),
							  (c = r.col1.x * a + r.col2.x * l),
							  (l = r.col1.y * a + r.col2.y * l),
							  (a = c),
							  (r = s.m_xf.R),
							  (h =
									this.m_localAnchor2.x -
									s.m_sweep.localCenter.x),
							  (u =
									this.m_localAnchor2.y -
									s.m_sweep.localCenter.y),
							  (c = r.col1.x * h + r.col2.x * u),
							  (u = r.col1.y * h + r.col2.y * u),
							  (h = c),
							  (r = p.x + -f * u - _.x - -d * l),
							  (c = p.y + f * h - _.y - d * a),
							  this.m_mass.Solve22(this.impulse2, -r, -c),
							  (this.m_impulse.x += this.impulse2.x),
							  (this.m_impulse.y += this.impulse2.y),
							  (_.x -= m * this.impulse2.x),
							  (_.y -= m * this.impulse2.y),
							  (d -=
									y *
									(a * this.impulse2.y -
										l * this.impulse2.x)),
							  (p.x += g * this.impulse2.x),
							  (p.y += g * this.impulse2.y),
							  (f +=
									T *
									(h * this.impulse2.y -
										u * this.impulse2.x))),
						o.m_linearVelocity.SetV(_),
						(o.m_angularVelocity = d),
						s.m_linearVelocity.SetV(p),
						(s.m_angularVelocity = f);
				}),
				(T.prototype.SolvePositionConstraints = function (t) {
					void 0 === t && (t = 0);
					var e = 0,
						i = this.m_bodyA,
						n = this.m_bodyB,
						r = 0,
						o = 0,
						s = 0;
					this.m_enableLimit &&
						this.m_limitState != C.e_inactiveLimit &&
						((g =
							n.m_sweep.a - i.m_sweep.a - this.m_referenceAngle),
						(y = 0),
						this.m_limitState == C.e_equalLimits
							? ((e = A.Clamp(
									g - this.m_lowerAngle,
									-v.b2_maxAngularCorrection,
									v.b2_maxAngularCorrection
							  )),
							  (y = -this.m_motorMass * e),
							  (r = A.Abs(e)))
							: this.m_limitState == C.e_atLowerLimit
							? ((r = -(e = g - this.m_lowerAngle)),
							  (e = A.Clamp(
									e + v.b2_angularSlop,
									-v.b2_maxAngularCorrection,
									0
							  )),
							  (y = -this.m_motorMass * e))
							: this.m_limitState == C.e_atUpperLimit &&
							  ((r = e = g - this.m_upperAngle),
							  (e = A.Clamp(
									e - v.b2_angularSlop,
									0,
									v.b2_maxAngularCorrection
							  )),
							  (y = -this.m_motorMass * e)),
						(i.m_sweep.a -= i.m_invI * y),
						(n.m_sweep.a += n.m_invI * y),
						i.SynchronizeTransform(),
						n.SynchronizeTransform()),
						(h = i.m_xf.R);
					var c = this.m_localAnchor1.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchor1.y - i.m_sweep.localCenter.y,
						l = h.col1.x * c + h.col2.x * a,
						a = h.col1.y * c + h.col2.y * a,
						c = l,
						h = n.m_xf.R,
						u = this.m_localAnchor2.x - n.m_sweep.localCenter.x,
						_ = this.m_localAnchor2.y - n.m_sweep.localCenter.y;
					(l = h.col1.x * u + h.col2.x * _),
						(_ = h.col1.y * u + h.col2.y * _),
						(u = l);
					var d = n.m_sweep.c.x + u - i.m_sweep.c.x - c,
						p = n.m_sweep.c.y + _ - i.m_sweep.c.y - a,
						f = d * d + p * p,
						t = Math.sqrt(f),
						m = t,
						g = i.m_invMass,
						e = n.m_invMass,
						y = i.m_invI,
						h = n.m_invI,
						l = 10 * v.b2_linearSlop;
					return (
						l * l < f &&
							((o = (t = 1 / (g + e)) * -d),
							(s = t * -p),
							(i.m_sweep.c.x -= 0.5 * g * o),
							(i.m_sweep.c.y -= 0.5 * g * s),
							(n.m_sweep.c.x += 0.5 * e * o),
							(n.m_sweep.c.y += 0.5 * e * s),
							(d = n.m_sweep.c.x + u - i.m_sweep.c.x - c),
							(p = n.m_sweep.c.y + _ - i.m_sweep.c.y - a)),
						(this.K1.col1.x = g + e),
						(this.K1.col2.x = 0),
						(this.K1.col1.y = 0),
						(this.K1.col2.y = g + e),
						(this.K2.col1.x = y * a * a),
						(this.K2.col2.x = -y * c * a),
						(this.K2.col1.y = -y * c * a),
						(this.K2.col2.y = y * c * c),
						(this.K3.col1.x = h * _ * _),
						(this.K3.col2.x = -h * u * _),
						(this.K3.col1.y = -h * u * _),
						(this.K3.col2.y = h * u * u),
						this.K.SetM(this.K1),
						this.K.AddM(this.K2),
						this.K.AddM(this.K3),
						this.K.Solve(T.tImpulse, -d, -p),
						(o = T.tImpulse.x),
						(s = T.tImpulse.y),
						(i.m_sweep.c.x -= i.m_invMass * o),
						(i.m_sweep.c.y -= i.m_invMass * s),
						(i.m_sweep.a -= i.m_invI * (c * s - a * o)),
						(n.m_sweep.c.x += n.m_invMass * o),
						(n.m_sweep.c.y += n.m_invMass * s),
						(n.m_sweep.a += n.m_invI * (u * s - _ * o)),
						i.SynchronizeTransform(),
						n.SynchronizeTransform(),
						m <= v.b2_linearSlop && r <= v.b2_angularSlop
					);
				}),
				Box2D.postDefs.push(function () {
					Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse = new b();
				}),
				Box2D.inherit(y, Box2D.Dynamics.Joints.b2JointDef),
				(y.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(y.b2RevoluteJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.localAnchorA = new b()),
						(this.localAnchorB = new b());
				}),
				(y.prototype.b2RevoluteJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_revoluteJoint),
						this.localAnchorA.Set(0, 0),
						this.localAnchorB.Set(0, 0),
						(this.referenceAngle = 0),
						(this.lowerAngle = 0),
						(this.upperAngle = 0),
						(this.maxMotorTorque = 0),
						(this.motorSpeed = 0),
						(this.enableLimit = !1),
						(this.enableMotor = !1);
				}),
				(y.prototype.Initialize = function (t, e, i) {
					(this.bodyA = t),
						(this.bodyB = e),
						(this.localAnchorA = this.bodyA.GetLocalPoint(i)),
						(this.localAnchorB = this.bodyB.GetLocalPoint(i)),
						(this.referenceAngle =
							this.bodyB.GetAngle() - this.bodyA.GetAngle());
				}),
				Box2D.inherit(S, Box2D.Dynamics.Joints.b2Joint),
				(S.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype),
				(S.b2WeldJoint = function () {
					Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(
						this,
						arguments
					),
						(this.m_localAnchorA = new b()),
						(this.m_localAnchorB = new b()),
						(this.m_impulse = new R()),
						(this.m_mass = new e());
				}),
				(S.prototype.GetAnchorA = function () {
					return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
				}),
				(S.prototype.GetAnchorB = function () {
					return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
				}),
				(S.prototype.GetReactionForce = function (t) {
					return (
						void 0 === t && (t = 0),
						new b(t * this.m_impulse.x, t * this.m_impulse.y)
					);
				}),
				(S.prototype.GetReactionTorque = function (t) {
					return void 0 === t && (t = 0), t * this.m_impulse.z;
				}),
				(S.prototype.b2WeldJoint = function (t) {
					this.__super.b2Joint.call(this, t),
						this.m_localAnchorA.SetV(t.localAnchorA),
						this.m_localAnchorB.SetV(t.localAnchorB),
						(this.m_referenceAngle = t.referenceAngle),
						this.m_impulse.SetZero(),
						(this.m_mass = new e());
				}),
				(S.prototype.InitVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_xf.R,
						r = this.m_localAnchorA.x - e.m_sweep.localCenter.x,
						o = this.m_localAnchorA.y - e.m_sweep.localCenter.y,
						s = n.col1.x * r + n.col2.x * o,
						o = n.col1.y * r + n.col2.y * o,
						r = s;
					n = i.m_xf.R;
					var c = this.m_localAnchorB.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchorB.y - i.m_sweep.localCenter.y;
					(s = n.col1.x * c + n.col2.x * a),
						(a = n.col1.y * c + n.col2.y * a),
						(c = s);
					var l = e.m_invMass,
						h = i.m_invMass,
						n = e.m_invI,
						s = i.m_invI;
					(this.m_mass.col1.x = l + h + o * o * n + a * a * s),
						(this.m_mass.col2.x = -o * r * n - a * c * s),
						(this.m_mass.col3.x = -o * n - a * s),
						(this.m_mass.col1.y = this.m_mass.col2.x),
						(this.m_mass.col2.y = l + h + r * r * n + c * c * s),
						(this.m_mass.col3.y = r * n + c * s),
						(this.m_mass.col1.z = this.m_mass.col3.x),
						(this.m_mass.col2.z = this.m_mass.col3.y),
						(this.m_mass.col3.z = n + s),
						t.warmStarting
							? ((this.m_impulse.x *= t.dtRatio),
							  (this.m_impulse.y *= t.dtRatio),
							  (this.m_impulse.z *= t.dtRatio),
							  (e.m_linearVelocity.x -= l * this.m_impulse.x),
							  (e.m_linearVelocity.y -= l * this.m_impulse.y),
							  (e.m_angularVelocity -=
									n *
									(r * this.m_impulse.y -
										o * this.m_impulse.x +
										this.m_impulse.z)),
							  (i.m_linearVelocity.x += h * this.m_impulse.x),
							  (i.m_linearVelocity.y += h * this.m_impulse.y),
							  (i.m_angularVelocity +=
									s *
									(c * this.m_impulse.y -
										a * this.m_impulse.x +
										this.m_impulse.z)))
							: this.m_impulse.SetZero();
				}),
				(S.prototype.SolveVelocityConstraints = function (t) {
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_linearVelocity,
						r = e.m_angularVelocity,
						o = i.m_linearVelocity,
						s = i.m_angularVelocity,
						c = e.m_invMass,
						a = i.m_invMass,
						l = e.m_invI,
						h = i.m_invI,
						u = e.m_xf.R,
						_ = this.m_localAnchorA.x - e.m_sweep.localCenter.x,
						d = this.m_localAnchorA.y - e.m_sweep.localCenter.y,
						p = u.col1.x * _ + u.col2.x * d,
						d = u.col1.y * _ + u.col2.y * d,
						_ = p;
					u = i.m_xf.R;
					var f = this.m_localAnchorB.x - i.m_sweep.localCenter.x,
						m = this.m_localAnchorB.y - i.m_sweep.localCenter.y;
					(p = u.col1.x * f + u.col2.x * m),
						(m = u.col1.y * f + u.col2.y * m),
						(f = p);
					var g = o.x - s * m - n.x + r * d,
						y = o.y + s * f - n.y - r * _,
						u = s - r,
						p = new R();
					this.m_mass.Solve33(p, -g, -y, -u),
						this.m_impulse.Add(p),
						(n.x -= c * p.x),
						(n.y -= c * p.y),
						(r -= l * (_ * p.y - d * p.x + p.z)),
						(o.x += a * p.x),
						(o.y += a * p.y),
						(s += h * (f * p.y - m * p.x + p.z)),
						(e.m_angularVelocity = r),
						(i.m_angularVelocity = s);
				}),
				(S.prototype.SolvePositionConstraints = function (t) {
					void 0 === t && (t = 0);
					var e = this.m_bodyA,
						i = this.m_bodyB,
						n = e.m_xf.R,
						r = this.m_localAnchorA.x - e.m_sweep.localCenter.x,
						o = this.m_localAnchorA.y - e.m_sweep.localCenter.y,
						s = n.col1.x * r + n.col2.x * o,
						o = n.col1.y * r + n.col2.y * o,
						r = s;
					n = i.m_xf.R;
					var c = this.m_localAnchorB.x - i.m_sweep.localCenter.x,
						a = this.m_localAnchorB.y - i.m_sweep.localCenter.y;
					(s = n.col1.x * c + n.col2.x * a),
						(a = n.col1.y * c + n.col2.y * a),
						(c = s);
					var l = e.m_invMass,
						h = i.m_invMass,
						u = e.m_invI,
						_ = i.m_invI,
						d = i.m_sweep.c.x + c - e.m_sweep.c.x - r,
						p = i.m_sweep.c.y + a - e.m_sweep.c.y - o,
						f = i.m_sweep.a - e.m_sweep.a - this.m_referenceAngle,
						t = 10 * v.b2_linearSlop,
						n = Math.sqrt(d * d + p * p),
						s = A.Abs(f);
					t < n && ((u *= 1), (_ *= 1)),
						(this.m_mass.col1.x = l + h + o * o * u + a * a * _),
						(this.m_mass.col2.x = -o * r * u - a * c * _),
						(this.m_mass.col3.x = -o * u - a * _),
						(this.m_mass.col1.y = this.m_mass.col2.x),
						(this.m_mass.col2.y = l + h + r * r * u + c * c * _),
						(this.m_mass.col3.y = r * u + c * _),
						(this.m_mass.col1.z = this.m_mass.col3.x),
						(this.m_mass.col2.z = this.m_mass.col3.y),
						(this.m_mass.col3.z = u + _);
					t = new R();
					return (
						this.m_mass.Solve33(t, -d, -p, -f),
						(e.m_sweep.c.x -= l * t.x),
						(e.m_sweep.c.y -= l * t.y),
						(e.m_sweep.a -= u * (r * t.y - o * t.x + t.z)),
						(i.m_sweep.c.x += h * t.x),
						(i.m_sweep.c.y += h * t.y),
						(i.m_sweep.a += _ * (c * t.y - a * t.x + t.z)),
						e.SynchronizeTransform(),
						i.SynchronizeTransform(),
						n <= v.b2_linearSlop && s <= v.b2_angularSlop
					);
				}),
				Box2D.inherit(x, Box2D.Dynamics.Joints.b2JointDef),
				(x.prototype.__super =
					Box2D.Dynamics.Joints.b2JointDef.prototype),
				(x.b2WeldJointDef = function () {
					Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(
						this,
						arguments
					),
						(this.localAnchorA = new b()),
						(this.localAnchorB = new b());
				}),
				(x.prototype.b2WeldJointDef = function () {
					this.__super.b2JointDef.call(this),
						(this.type = C.e_weldJoint),
						(this.referenceAngle = 0);
				}),
				(x.prototype.Initialize = function (t, e, i) {
					(this.bodyA = t),
						(this.bodyB = e),
						this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),
						this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),
						(this.referenceAngle =
							this.bodyB.GetAngle() - this.bodyA.GetAngle());
				});
		})(),
		(function () {
			var t = Box2D.Dynamics.b2DebugDraw;
			(t.b2DebugDraw = function () {
				(this.m_drawScale = 1),
					(this.m_lineThickness = 1),
					(this.m_alpha = 1),
					(this.m_fillAlpha = 1),
					(this.m_xformScale = 1);
				var t = this;
				this.m_sprite = {
					graphics: {
						clear: function () {
							t.m_ctx.clearRect(
								0,
								0,
								t.m_ctx.canvas.width,
								t.m_ctx.canvas.height
							);
						},
					},
				};
			}),
				(t.prototype._color = function (t, e) {
					return (
						'rgba(' +
						((16711680 & t) >> 16) +
						',' +
						((65280 & t) >> 8) +
						',' +
						(255 & t) +
						',' +
						e +
						')'
					);
				}),
				(t.prototype.b2DebugDraw = function () {
					this.m_drawFlags = 0;
				}),
				(t.prototype.SetFlags = function (t) {
					void 0 === t && (t = 0), (this.m_drawFlags = t);
				}),
				(t.prototype.GetFlags = function () {
					return this.m_drawFlags;
				}),
				(t.prototype.AppendFlags = function (t) {
					void 0 === t && (t = 0), (this.m_drawFlags |= t);
				}),
				(t.prototype.ClearFlags = function (t) {
					void 0 === t && (t = 0), (this.m_drawFlags &= ~t);
				}),
				(t.prototype.SetSprite = function (t) {
					this.m_ctx = t;
				}),
				(t.prototype.GetSprite = function () {
					return this.m_ctx;
				}),
				(t.prototype.SetDrawScale = function (t) {
					void 0 === t && (t = 0), (this.m_drawScale = t);
				}),
				(t.prototype.GetDrawScale = function () {
					return this.m_drawScale;
				}),
				(t.prototype.SetLineThickness = function (t) {
					void 0 === t && (t = 0),
						(this.m_lineThickness = t),
						(this.m_ctx.strokeWidth = t);
				}),
				(t.prototype.GetLineThickness = function () {
					return this.m_lineThickness;
				}),
				(t.prototype.SetAlpha = function (t) {
					void 0 === t && (t = 0), (this.m_alpha = t);
				}),
				(t.prototype.GetAlpha = function () {
					return this.m_alpha;
				}),
				(t.prototype.SetFillAlpha = function (t) {
					void 0 === t && (t = 0), (this.m_fillAlpha = t);
				}),
				(t.prototype.GetFillAlpha = function () {
					return this.m_fillAlpha;
				}),
				(t.prototype.SetXFormScale = function (t) {
					void 0 === t && (t = 0), (this.m_xformScale = t);
				}),
				(t.prototype.GetXFormScale = function () {
					return this.m_xformScale;
				}),
				(t.prototype.DrawPolygon = function (t, e, i) {
					if (e) {
						var n = this.m_ctx,
							r = this.m_drawScale;
						n.beginPath(),
							(n.strokeStyle = this._color(
								i.color,
								this.m_alpha
							)),
							n.moveTo(t[0].x * r, t[0].y * r);
						for (var o = 1; o < e; o++)
							n.lineTo(t[o].x * r, t[o].y * r);
						n.lineTo(t[0].x * r, t[0].y * r),
							n.closePath(),
							n.stroke();
					}
				}),
				(t.prototype.DrawSolidPolygon = function (t, e, i) {
					if (e) {
						var n = this.m_ctx,
							r = this.m_drawScale;
						n.beginPath(),
							(n.strokeStyle = this._color(
								i.color,
								this.m_alpha
							)),
							(n.fillStyle = this._color(
								i.color,
								this.m_fillAlpha
							)),
							n.moveTo(t[0].x * r, t[0].y * r);
						for (var o = 1; o < e; o++)
							n.lineTo(t[o].x * r, t[o].y * r);
						n.lineTo(t[0].x * r, t[0].y * r),
							n.closePath(),
							n.fill(),
							n.stroke();
					}
				}),
				(t.prototype.DrawCircle = function (t, e, i) {
					var n, r;
					e &&
						((n = this.m_ctx),
						(r = this.m_drawScale),
						n.beginPath(),
						(n.strokeStyle = this._color(i.color, this.m_alpha)),
						n.arc(t.x * r, t.y * r, e * r, 0, 2 * Math.PI, !0),
						n.closePath(),
						n.stroke());
				}),
				(t.prototype.DrawSolidCircle = function (t, e, i, n) {
					var r, o, s, c;
					e &&
						((r = this.m_ctx),
						(o = this.m_drawScale),
						(s = t.x * o),
						(c = t.y * o),
						r.moveTo(0, 0),
						r.beginPath(),
						(r.strokeStyle = this._color(n.color, this.m_alpha)),
						(r.fillStyle = this._color(n.color, this.m_fillAlpha)),
						r.arc(s, c, e * o, 0, 2 * Math.PI, !0),
						r.moveTo(s, c),
						r.lineTo((t.x + i.x * e) * o, (t.y + i.y * e) * o),
						r.closePath(),
						r.fill(),
						r.stroke());
				}),
				(t.prototype.DrawSegment = function (t, e, i) {
					var n = this.m_ctx,
						r = this.m_drawScale;
					(n.strokeStyle = this._color(i.color, this.m_alpha)),
						n.beginPath(),
						n.moveTo(t.x * r, t.y * r),
						n.lineTo(e.x * r, e.y * r),
						n.closePath(),
						n.stroke();
				}),
				(t.prototype.DrawTransform = function (t) {
					var e = this.m_ctx,
						i = this.m_drawScale;
					e.beginPath(),
						(e.strokeStyle = this._color(16711680, this.m_alpha)),
						e.moveTo(t.position.x * i, t.position.y * i),
						e.lineTo(
							(t.position.x + this.m_xformScale * t.R.col1.x) * i,
							(t.position.y + this.m_xformScale * t.R.col1.y) * i
						),
						(e.strokeStyle = this._color(65280, this.m_alpha)),
						e.moveTo(t.position.x * i, t.position.y * i),
						e.lineTo(
							(t.position.x + this.m_xformScale * t.R.col2.x) * i,
							(t.position.y + this.m_xformScale * t.R.col2.y) * i
						),
						e.closePath(),
						e.stroke();
				});
		})(),
		i = 0;
	i < Box2D.postDefs.length;
	++i
)
	Box2D.postDefs[i]();
delete Box2D.postDefs,
	'undefined' != typeof require &&
		'undefined' != typeof module &&
		(module.exports = Box2D),
	(function () {
		var c;
		function f(t, e) {
			if (!t) throw new Error('Assertion failed: ' + e);
		}
		function m(t, e) {
			!t &&
				console &&
				console.warn &&
				(console.warn('ASSERTION FAILED: ' + e),
				console.trace && console.trace());
		}
		function p(t, e) {
			return t < e ? t + ' ' + e : e + ' ' + t;
		}
		function s(t, e) {
			for (var i = 0; i < t.length; i++)
				if (t[i] === e) return (t[i] = t[t.length - 1]), t.length--, 0;
		}
		(Object.create =
			Object.create ||
			function (t) {
				function e() {}
				return (e.prototype = t), new e();
			}),
			'undefined' == typeof exports
				? ((c = {}), 'object' == typeof window && (window.cp = c))
				: (c = exports);
		var E,
			A =
				'object' == typeof window &&
				-1 < window.navigator.userAgent.indexOf('Firefox')
					? ((E = Math.min), Math.max)
					: ((E = function (t, e) {
							return t < e ? t : e;
					  }),
					  function (t, e) {
							return e < t ? t : e;
					  });
		function d(t, e, i) {
			var n = t[2 * e];
			(t[2 * e] = t[2 * i]),
				(t[2 * i] = n),
				(n = t[2 * e + 1]),
				(t[2 * e + 1] = t[2 * i + 1]),
				(t[2 * i + 1] = n);
		}
		function h(t, e, i, n, r, o) {
			if (0 === i) return 0;
			for (
				var s = 0,
					c = e,
					a = R(r, n),
					l = o * v(a),
					h = e,
					u = e + i - 1;
				h <= u;

			) {
				var _ = new T(t[2 * h], t[2 * h + 1]),
					_ = w(a, R(_, n));
				l < _ ? (s < _ && ((s = _), (c = h)), h++) : (d(t, h, u), u--);
			}
			return c != e && d(t, e, c), h - e;
		}
		(c.momentForCircle = function (t, e, i, n) {
			return t * (0.5 * (e * e + i * i) + L(n));
		}),
			(c.areaForCircle = function (t, e) {
				return Math.PI * Math.abs(t * t - e * e);
			}),
			(c.momentForSegment = function (t, e, i) {
				var n = I(b(e, i), 0.5);
				return t * (r(i, e) / 12 + L(n));
			}),
			(c.areaForSegment = function (t, e, i) {
				return i * (Math.PI * i + 2 * V(t, e));
			}),
			(c.momentForPoly = function (t, e, i) {
				for (var n = 0, r = 0, o = e.length, s = 0; s < o; s += 2) {
					var c = e[s] + i.x,
						a = e[s + 1] + i.y,
						l = e[(s + 2) % o] + i.x,
						h = e[(s + 3) % o] + i.y,
						u = D(l, h, c, a);
					(n += u * (x(c, a, c, a) + x(c, a, l, h) + x(l, h, l, h))),
						(r += u);
				}
				return (t * n) / (6 * r);
			}),
			(c.areaForPoly = function (t) {
				for (var e = 0, i = 0, n = t.length; i < n; i += 2)
					e += w(
						new T(t[i], t[i + 1]),
						new T(t[(i + 2) % n], t[(i + 3) % n])
					);
				return -e / 2;
			}),
			(c.centroidForPoly = function (t) {
				for (
					var e = 0, i = new T(0, 0), n = 0, r = t.length;
					n < r;
					n += 2
				) {
					var o = new T(t[n], t[n + 1]),
						s = new T(t[(n + 2) % r], t[(n + 3) % r]),
						c = w(o, s);
					(e += c), (i = b(i, I(b(o, s), c)));
				}
				return I(i, 1 / (3 * e));
			}),
			(c.recenterPoly = function (t) {
				for (var e = c.centroidForPoly(t), i = 0; i < t.length; i += 2)
					(t[i] -= e.x), (t[i + 1] -= e.y);
			}),
			(c.momentForBox = function (t, e, i) {
				return (t * (e * e + i * i)) / 12;
			}),
			(c.momentForBox2 = function (t, e) {
				var i = e.r - e.l,
					n = e.t - e.b,
					e = I([e.l + e.r, e.b + e.t], 0.5);
				return c.momentForBox(t, i, n) + t * L(e);
			});
		var a = (c.loopIndexes = function (t) {
				for (
					var e,
						i,
						n = 0,
						r = 0,
						o = (e = t[0]),
						s = (i = t[1]),
						c = t.length >> 1,
						a = 1;
					a < c;
					a++
				) {
					var l = t[2 * a],
						h = t[2 * a + 1];
					l < o || (l == o && h < s)
						? ((o = l), (s = h), (n = a))
						: (e < l || (l == e && i < h)) &&
						  ((e = l), (i = h), (r = a));
				}
				return [n, r];
			}),
			u = function (t, e, i, n, r, o, s, c) {
				if (n < 0) return 0;
				if (0 == n) return (e[2 * c] = o.x), (e[2 * c + 1] = o.y), 1;
				var a = h(e, i, n, r, o, t),
					l = new T(e[2 * i], e[2 * i + 1]),
					r = u(t, e, i + 1, a - 1, r, l, o, c),
					l = c + r++;
				(e[2 * l] = o.x), (e[2 * l + 1] = o.y);
				(l = h(e, i + a, n - a, o, s, t)),
					(n = new T(e[2 * (i + a)], e[2 * (i + a) + 1]));
				return r + u(t, e, i + a + 1, l - 1, o, n, s, c + r);
			};
		function g(t, e, i) {
			return E(A(t, e), i);
		}
		c.convexHull = function (t, e, i) {
			if (e) for (var n = 0; n < t.length; n++) e[n] = t[n];
			else e = t;
			var r = a(t),
				o = r[0],
				s = r[1];
			if (o == s) return (e.length = 2), e;
			d(e, 0, o), d(e, 1, 0 == s ? o : s);
			(r = new T(e[0], e[1])),
				(o = new T(e[2], e[3])),
				(s = t.length >> 1),
				(r = u(i, e, 2, s - 2, r, o, r, 1) + 1);
			return (
				(e.length = 2 * r),
				m(
					j(e),
					'Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can.'
				),
				e
			);
		};
		var y = function (t) {
				return A(0, E(t, 1));
			},
			T = (c.Vect = function (t, e) {
				(this.x = t), (this.y = e);
			});
		c.v = function (t, e) {
			return new T(t, e);
		};
		var S = (c.vzero = new T(0, 0)),
			C = (c.v.dot = function (t, e) {
				return t.x * e.x + t.y * e.y;
			}),
			x = function (t, e, i, n) {
				return t * i + e * n;
			},
			v = (c.v.len = function (t) {
				return Math.sqrt(C(t, t));
			}),
			o = (c.v.len2 = function (t, e) {
				return Math.sqrt(t * t + e * e);
			}),
			b =
				((c.v.eql = function (t, e) {
					return t.x === e.x && t.y === e.y;
				}),
				(c.v.add = function (t, e) {
					return new T(t.x + e.x, t.y + e.y);
				}));
		T.prototype.add = function (t) {
			return (this.x += t.x), (this.y += t.y), this;
		};
		var R = (c.v.sub = function (t, e) {
			return new T(t.x - e.x, t.y - e.y);
		});
		T.prototype.sub = function (t) {
			return (this.x -= t.x), (this.y -= t.y), this;
		};
		var P = (c.v.neg = function (t) {
			return new T(-t.x, -t.y);
		});
		T.prototype.neg = function () {
			return (this.x = -this.x), (this.y = -this.y), this;
		};
		var I = (c.v.mult = function (t, e) {
			return new T(t.x * e, t.y * e);
		});
		T.prototype.mult = function (t) {
			return (this.x *= t), (this.y *= t), this;
		};
		var w = (c.v.cross = function (t, e) {
				return t.x * e.y - t.y * e.x;
			}),
			D = function (t, e, i, n) {
				return t * n - e * i;
			},
			l = (c.v.perp = function (t) {
				return new T(-t.y, t.x);
			}),
			i =
				((c.v.pvrperp = function (t) {
					return new T(t.y, -t.x);
				}),
				(c.v.project = function (t, e) {
					return I(e, C(t, e) / L(e));
				}));
		T.prototype.project = function (t) {
			return this.mult(C(this, t) / L(t)), this;
		};
		var _ = (c.v.rotate = function (t, e) {
			return new T(t.x * e.x - t.y * e.y, t.x * e.y + t.y * e.x);
		});
		T.prototype.rotate = function (t) {
			return (
				(this.x = this.x * t.x - this.y * t.y),
				(this.y = this.x * t.y + this.y * t.x),
				this
			);
		};
		var e = (c.v.unrotate = function (t, e) {
				return new T(t.x * e.x + t.y * e.y, t.y * e.x - t.x * e.y);
			}),
			L = (c.v.lengthsq = function (t) {
				return C(t, t);
			}),
			O = (c.v.lengthsq2 = function (t, e) {
				return t * t + e * e;
			}),
			B = (c.v.lerp = function (t, e, i) {
				return b(I(t, 1 - i), I(e, i));
			}),
			N = (c.v.normalize = function (t) {
				return I(t, 1 / v(t));
			}),
			F = (c.v.normalize_safe = function (t) {
				return 0 === t.x && 0 === t.y ? S : N(t);
			}),
			M = (c.v.clamp = function (t, e) {
				return C(t, t) > e * e ? I(N(t), e) : t;
			}),
			V =
				((c.v.lerpconst = function (t, e, i) {
					return b(t, M(R(e, t), i));
				}),
				(c.v.dist = function (t, e) {
					return v(R(t, e));
				})),
			r = (c.v.distsq = function (t, e) {
				return L(R(t, e));
			}),
			k =
				((c.v.near = function (t, e, i) {
					return r(t, e) < i * i;
				}),
				(c.v.slerp = function (t, e, i) {
					var n = Math.acos(C(t, e));
					if (n) {
						var r = 1 / Math.sin(n);
						return b(
							I(t, Math.sin((1 - i) * n) * r),
							I(e, Math.sin(i * n) * r)
						);
					}
					return t;
				})),
			G =
				((c.v.slerpconst = function (t, e, i) {
					var n = Math.acos(C(t, e));
					return k(t, e, E(i, n) / n);
				}),
				(c.v.forangle = function (t) {
					return new T(Math.cos(t), Math.sin(t));
				}),
				(c.v.toangle = function (t) {
					return Math.atan2(t.y, t.x);
				}),
				(c.v.str = function (t) {
					return '(' + t.x.toFixed(3) + ', ' + t.y.toFixed(3) + ')';
				}),
				(c.BB = function (t, e, i, n) {
					(this.l = t), (this.b = e), (this.r = i), (this.t = n), 0;
				}));
		function W(t, e) {
			return new G(t.x - e, t.y - e, t.x + e, t.y + e);
		}
		c.bb = function (t, e, i, n) {
			return new G(t, e, i, n);
		};
		var n = 0;
		(c.NO_GROUP = 0),
			(c.ALL_LAYERS = -1),
			(c.ALL_CATEGORIES = -1),
			(c.resetShapeIdCounter = function () {
				n = 0;
			});
		var z = (c.Shape = function (t) {
			(this.body = t),
				(this.bb_l = this.bb_b = this.bb_r = this.bb_t = 0),
				(this.hashid = n++),
				(this.sensor = !1),
				(this.e = 0),
				(this.u = 0),
				(this.surface_v = S),
				(this.collision_type = 0),
				(this.group = 0),
				(this.layers = -1),
				(this.space = null),
				(this.collisionCode = this.collisionCode);
		});
		function U(t, e, i) {
			(this.shape = t), (this.p = e), (this.d = i);
		}
		function Y(t, e, i) {
			(this.shape = t), (this.t = e), (this.n = i);
		}
		(z.prototype.setElasticity = function (t) {
			this.e = t;
		}),
			(z.prototype.setFriction = function (t) {
				this.body.activate(), (this.u = t);
			}),
			(z.prototype.setLayers = function (t) {
				this.body.activate(), (this.layers = t);
			}),
			(z.prototype.setSensor = function (t) {
				this.body.activate(), (this.sensor = t);
			}),
			(z.prototype.setCollisionType = function (t) {
				this.body.activate(), (this.collision_type = t);
			}),
			(z.prototype.getBody = function () {
				return this.body;
			}),
			(z.prototype.active = function () {
				return this.body && -1 !== this.body.shapeList.indexOf(this);
			}),
			(z.prototype.setBody = function (t) {
				f(
					!this.active(),
					'You cannot change the body on an active shape. You must remove the shape from the space before changing the body.'
				),
					(this.body = t);
			}),
			(z.prototype.cacheBB = function () {
				return this.update(this.body.p, this.body.rot);
			}),
			(z.prototype.update = function (t, e) {
				f(!isNaN(e.x), 'Rotation is NaN'),
					f(!isNaN(t.x), 'Position is NaN'),
					this.cacheData(t, e);
			}),
			(z.prototype.pointQuery = function (t) {
				t = this.nearestPointQuery(t);
				if (t.d < 0) return t;
			}),
			(z.prototype.getBB = function () {
				return new G(this.bb_l, this.bb_b, this.bb_r, this.bb_t);
			}),
			(Y.prototype.hitPoint = function (t, e) {
				return B(t, e, this.t);
			}),
			(Y.prototype.hitDist = function (t, e) {
				return V(t, e) * this.t;
			});
		var t = (c.CircleShape = function (t, e, i) {
			(this.c = this.tc = i),
				(this.r = e),
				(this.type = 'circle'),
				z.call(this, t);
		});
		function X(t, e, i, n, r, o) {
			(n = R(n, e)), (r = R(r, e));
			var s = C(n, n) - 2 * C(n, r) + C(r, r),
				e = -2 * C(n, n) + 2 * C(n, r);
			if (0 <= (i = e * e - 4 * s * (C(n, n) - i * i))) {
				s = (-e - Math.sqrt(i)) / (2 * s);
				if (0 <= s && s <= 1) return new Y(t, s, N(B(n, r, s)));
			}
		}
		(t.prototype = Object.create(z.prototype)),
			(t.prototype.cacheData = function (t, e) {
				(e = this.tc = _(this.c, e).add(t)), (t = this.r);
				(this.bb_l = e.x - t),
					(this.bb_b = e.y - t),
					(this.bb_r = e.x + t),
					(this.bb_t = e.y + t);
			}),
			(t.prototype.nearestPointQuery = function (t) {
				var e = t.x - this.tc.x,
					i = t.y - this.tc.y,
					n = o(e, i),
					t = this.r,
					i = new T(this.tc.x + (e * t) / n, this.tc.y + (i * t) / n);
				return new U(this, i, n - t);
			}),
			(t.prototype.segmentQuery = function (t, e) {
				return X(this, this.tc, this.r, t, e);
			});
		var H = (c.SegmentShape = function (t, e, i, n) {
			(this.a = e),
				(this.b = i),
				(this.n = l(N(R(i, e)))),
				(this.ta = this.tb = this.tn = null),
				(this.r = n),
				(this.a_tangent = S),
				(this.b_tangent = S),
				(this.type = 'segment'),
				z.call(this, t);
		});
		(H.prototype = Object.create(z.prototype)),
			(H.prototype.cacheData = function (t, e) {
				var i, n, r;
				(this.ta = b(t, _(this.a, e))),
					(this.tb = b(t, _(this.b, e))),
					(this.tn = _(this.n, e)),
					(n =
						this.ta.x < this.tb.x
							? ((i = this.ta.x), this.tb.x)
							: ((i = this.tb.x), this.ta.x)),
					(t =
						this.ta.y < this.tb.y
							? ((r = this.ta.y), this.tb.y)
							: ((r = this.tb.y), this.ta.y));
				e = this.r;
				(this.bb_l = i - e),
					(this.bb_b = r - e),
					(this.bb_r = n + e),
					(this.bb_t = t + e);
			}),
			(H.prototype.nearestPointQuery = function (t) {
				var e = (function (t, e, i) {
						(e = R(e, i)), (t = y(C(e, R(t, i)) / L(e)));
						return b(i, I(e, t));
					})(t, this.ta, this.tb),
					i = t.x - e.x,
					n = t.y - e.y,
					r = o(i, n),
					t = this.r,
					e = r ? b(e, I(new T(i, n), t / r)) : e;
				return new U(this, e, r - t);
			}),
			(H.prototype.segmentQuery = function (t, e) {
				var i = this.tn,
					n = C(R(this.ta, t), i),
					r = this.r,
					o = 0 < n ? P(i) : i,
					s = R(I(o, r), t),
					c = b(this.ta, s),
					a = b(this.tb, s),
					s = R(e, t);
				if (w(s, c) * w(s, a) <= 0) {
					(a = n + (0 < n ? -r : r)), (n = -a), (a = C(s, i) - a);
					if (n * a < 0) return new Y(this, n / (n - a), o);
				} else if (0 !== r) {
					(r = X(this, this.ta, this.r, t, e)),
						(e = X(this, this.tb, this.r, t, e));
					return !r || (e && e.t < r.t) ? e : r;
				}
			}),
			(H.prototype.setNeighbors = function (t, e) {
				(this.a_tangent = R(t, this.a)),
					(this.b_tangent = R(e, this.b));
			}),
			(H.prototype.setEndpoints = function (t, e) {
				(this.a = t), (this.b = e), (this.n = l(N(R(e, t))));
			});
		var j = function (t) {
				for (var e = t.length, i = 0; i < e; i += 2) {
					var n = t[i],
						r = t[i + 1],
						o = t[(i + 2) % e],
						s = t[(i + 3) % e],
						c = t[(i + 4) % e],
						a = t[(i + 5) % e];
					if (0 < D(o - n, s - r, c - o, a - s)) return !1;
				}
				return !0;
			},
			q = (c.PolyShape = function (t, e, i) {
				this.setVerts(e, i), (this.type = 'poly'), z.call(this, t);
			});
		function J(t, e) {
			(this.n = t), (this.d = e);
		}
		(q.prototype = Object.create(z.prototype)),
			(J.prototype.compare = function (t) {
				return C(this.n, t) - this.d;
			}),
			(q.prototype.setVerts = function (t, e) {
				f(4 <= t.length, 'Polygons require some verts'),
					f(
						'number' == typeof t[0],
						'Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])'
					),
					f(
						j(t),
						'Polygon is concave or has a reversed winding. Consider using cpConvexHull()'
					);
				var i = t.length,
					n = i >> 1;
				(this.verts = new Array(i)),
					(this.tVerts = new Array(i)),
					(this.planes = new Array(n)),
					(this.tPlanes = new Array(n));
				for (var r = 0; r < i; r += 2) {
					var o = t[r] + e.x,
						s = t[r + 1] + e.y,
						c = t[(r + 2) % i] + e.x,
						a = t[(r + 3) % i] + e.y,
						a = N(l(new T(c - o, a - s)));
					(this.verts[r] = o),
						(this.verts[r + 1] = s),
						(this.planes[r >> 1] = new J(a, x(a.x, a.y, o, s))),
						(this.tPlanes[r >> 1] = new J(new T(0, 0), 0));
				}
			}),
			(c.BoxShape = function (t, e, i) {
				(e /= 2), (i /= 2);
				return Z(t, new G(-e, -i, e, i));
			});
		var Z = (c.BoxShape2 = function (t, e) {
			e = [e.l, e.b, e.l, e.t, e.r, e.t, e.r, e.b];
			return new q(t, e, S);
		});
		(q.prototype.transformVerts = function (t, e) {
			for (
				var i = this.verts,
					n = this.tVerts,
					r = 1 / 0,
					o = -1 / 0,
					s = 1 / 0,
					c = -1 / 0,
					a = 0;
				a < i.length;
				a += 2
			) {
				var l = i[a],
					h = i[a + 1],
					u = t.x + l * e.x - h * e.y,
					h = t.y + l * e.y + h * e.x;
				(n[a] = u),
					(n[a + 1] = h),
					(r = E(r, u)),
					(o = A(o, u)),
					(s = E(s, h)),
					(c = A(c, h));
			}
			(this.bb_l = r), (this.bb_b = s), (this.bb_r = o), (this.bb_t = c);
		}),
			(q.prototype.transformAxes = function (t, e) {
				for (
					var i = this.planes, n = this.tPlanes, r = 0;
					r < i.length;
					r++
				) {
					var o = _(i[r].n, e);
					(n[r].n = o), (n[r].d = C(t, o) + i[r].d);
				}
			}),
			(q.prototype.cacheData = function (t, e) {
				this.transformAxes(t, e), this.transformVerts(t, e);
			}),
			(q.prototype.nearestPointQuery = function (t) {
				for (
					var e = this.tPlanes,
						i = this.tVerts,
						n = i[i.length - 2],
						r = i[i.length - 1],
						o = 1 / 0,
						s = S,
						c = !1,
						a = 0;
					a < e.length;
					a++
				) {
					0 < e[a].compare(t) && (c = !0);
					var l = i[2 * a],
						h = i[2 * a + 1],
						u = (function (t, e, i, n, r, o) {
							(i -= r),
								(n -= o),
								(e = y(x(i, n, t - r, e - o) / O(i, n)));
							return new T(r + i * e, o + n * e);
						})(t.x, t.y, n, r, l, h),
						_ = V(t, u);
					_ < o && ((o = _), (s = u)), (n = l), (r = h);
				}
				return new U(this, s, c ? o : -o);
			}),
			(q.prototype.segmentQuery = function (t, e) {
				for (
					var i = this.tPlanes,
						n = this.tVerts,
						r = i.length,
						o = 2 * r,
						s = 0;
					s < r;
					s++
				) {
					var c = i[s].n,
						a = C(t, c);
					if (!(i[s].d > a)) {
						var l = C(e, c),
							h = (i[s].d - a) / (l - a);
						if (!(h < 0 || 1 < h)) {
							var u = B(t, e, h),
								l = -w(c, u),
								a = -D(c.x, c.y, n[2 * s], n[2 * s + 1]),
								u = -D(
									c.x,
									c.y,
									n[(2 * s + 2) % o],
									n[(2 * s + 3) % o]
								);
							if (a <= l && l <= u) return new Y(this, h, c);
						}
					}
				}
			}),
			(q.prototype.valueOnAxis = function (t, e) {
				for (
					var i = this.tVerts, n = x(t.x, t.y, i[0], i[1]), r = 2;
					r < i.length;
					r += 2
				)
					n = E(n, x(t.x, t.y, i[r], i[r + 1]));
				return n - e;
			}),
			(q.prototype.containsVert = function (t, e) {
				for (var i = this.tPlanes, n = 0; n < i.length; n++) {
					var r = i[n].n;
					if (0 < x(r.x, r.y, t, e) - i[n].d) return !1;
				}
				return !0;
			}),
			(q.prototype.containsVertPartial = function (t, e, i) {
				for (var n = this.tPlanes, r = 0; r < n.length; r++) {
					var o = n[r].n;
					if (!(C(o, i) < 0))
						if (0 < x(o.x, o.y, t, e) - n[r].d) return !1;
				}
				return !0;
			}),
			(q.prototype.getNumVerts = function () {
				return this.verts.length / 2;
			}),
			(q.prototype.getCount = q.prototype.getNumVerts),
			(q.prototype.getVert = function (t) {
				return new T(this.verts[2 * t], this.verts[2 * t + 1]);
			});
		var K,
			Q = (c.Body = function (t, e) {
				(this.p = new T(0, 0)),
					(this.vx = this.vy = 0),
					(this.f = new T(0, 0)),
					(this.w = 0),
					(this.t = 0),
					(this.v_limit = 1 / 0),
					(this.w_limit = 1 / 0),
					(this.v_biasx = this.v_biasy = 0),
					(this.w_bias = 0),
					(this.space = null),
					(this.shapeList = []),
					(this.arbiterList = null),
					(this.constraintList = null),
					(this.nodeRoot = null),
					(this.nodeNext = null),
					(this.nodeIdleTime = 0),
					this.setMass(t),
					this.setMoment(e),
					(this.rot = new T(0, 0)),
					this.setAngle(0);
			});
		(c.StaticBody = function () {
			var t = new Q(1 / 0, 1 / 0);
			return (t.nodeIdleTime = 1 / 0), t;
		}),
			'undefined' != typeof DEBUG && DEBUG
				? ((K = function (t, e) {
						var i, n;
						(n = e),
							f((i = t).x == i.x && i.y == i.y, n),
							(t = t),
							(e = e),
							f(
								Math.abs(t.x) !== 1 / 0 &&
									Math.abs(t.y) !== 1 / 0,
								e
							);
				  }),
				  (Q.prototype.sanityCheck = function () {
						f(
							this.m == this.m && this.m_inv == this.m_inv,
							"Body's mass is invalid."
						),
							f(
								this.i == this.i && this.i_inv == this.i_inv,
								"Body's moment is invalid."
							),
							K(this.p, "Body's position is invalid."),
							K(this.f, "Body's force is invalid."),
							f(
								this.vx == this.vx &&
									Math.abs(this.vx) !== 1 / 0,
								"Body's velocity is invalid."
							),
							f(
								this.vy == this.vy &&
									Math.abs(this.vy) !== 1 / 0,
								"Body's velocity is invalid."
							),
							f(
								this.a == this.a && Math.abs(this.a) !== 1 / 0,
								"Body's angle is invalid."
							),
							f(
								this.w == this.w && Math.abs(this.w) !== 1 / 0,
								"Body's angular velocity is invalid."
							),
							f(
								this.t == this.t && Math.abs(this.t) !== 1 / 0,
								"Body's torque is invalid."
							),
							K(this.rot, "Body's rotation vector is invalid."),
							f(
								this.v_limit == this.v_limit,
								"Body's velocity limit is invalid."
							),
							f(
								this.w_limit == this.w_limit,
								"Body's angular velocity limit is invalid."
							);
				  }))
				: (Q.prototype.sanityCheck = function () {}),
			(Q.prototype.getPos = function () {
				return this.p;
			}),
			(Q.prototype.getVel = function () {
				return new T(this.vx, this.vy);
			}),
			(Q.prototype.getAngVel = function () {
				return this.w;
			}),
			(Q.prototype.getPosition = Q.prototype.getPos),
			(Q.prototype.getVelocity = Q.prototype.getVel),
			(Q.prototype.getAngularVelocity = Q.prototype.getAngVel),
			(Q.prototype.getCenterOfGravity = function () {
				return this.p;
			}),
			(Q.prototype.isSleeping = function () {
				return null !== this.nodeRoot;
			}),
			(Q.prototype.isStatic = function () {
				return this.nodeIdleTime === 1 / 0;
			}),
			(Q.prototype.isRogue = function () {
				return null === this.space;
			}),
			(Q.prototype.setMass = function (t) {
				f(0 < t, 'Mass must be positive and non-zero.'),
					this.activate(),
					(this.m = t),
					(this.m_inv = 1 / t);
			}),
			(Q.prototype.setMoment = function (t) {
				f(0 < t, 'Moment of Inertia must be positive and non-zero.'),
					this.activate(),
					(this.i = t),
					(this.i_inv = 1 / t);
			}),
			(Q.prototype.addShape = function (t) {
				this.shapeList.push(t);
			}),
			(Q.prototype.removeShape = function (t) {
				s(this.shapeList, t);
			});
		var $ = function (t, e, i) {
			return t === i
				? t.next(e)
				: (t.a === e
						? (t.next_a = $(t.next_a, e, i))
						: (t.next_b = $(t.next_b, e, i)),
				  t);
		};
		(Q.prototype.removeConstraint = function (t) {
			this.constraintList = $(this.constraintList, this, t);
		}),
			(Q.prototype.setPos = function (t) {
				this.activate(),
					this.sanityCheck(),
					t === S && (t = c.v(0, 0)),
					(this.p = t);
			}),
			(Q.prototype.setVel = function (t) {
				this.activate(), (this.vx = t.x), (this.vy = t.y);
			}),
			(Q.prototype.setAngVel = function (t) {
				this.activate(), (this.w = t);
			}),
			(Q.prototype.setAngleInternal = function (t) {
				f(
					!isNaN(t),
					"Internal Error: Attempting to set body's angle to NaN"
				),
					(this.a = t),
					(this.rot.x = Math.cos(t)),
					(this.rot.y = Math.sin(t));
			}),
			(Q.prototype.setAngle = function (t) {
				this.activate(), this.sanityCheck(), this.setAngleInternal(t);
			}),
			(Q.prototype.velocity_func = function (t, e, i) {
				var n = this.vx * e + (t.x + this.f.x * this.m_inv) * i,
					r = this.vy * e + (t.y + this.f.y * this.m_inv) * i,
					o = this.v_limit,
					t = n * n + r * r,
					t = o * o < t ? o / Math.sqrt(t) : 1;
				(this.vx = n * t), (this.vy = r * t);
				t = this.w_limit;
				(this.w = g(this.w * e + this.t * this.i_inv * i, -t, t)),
					this.sanityCheck();
			}),
			(Q.prototype.position_func = function (t) {
				(this.p.x += (this.vx + this.v_biasx) * t),
					(this.p.y += (this.vy + this.v_biasy) * t),
					this.setAngleInternal(this.a + (this.w + this.w_bias) * t),
					(this.v_biasx = this.v_biasy = 0),
					(this.w_bias = 0),
					this.sanityCheck();
			}),
			(Q.prototype.resetForces = function () {
				this.activate(), (this.f = new T(0, 0)), (this.t = 0);
			}),
			(Q.prototype.applyForce = function (t, e) {
				this.activate(), (this.f = b(this.f, t)), (this.t += w(e, t));
			}),
			(Q.prototype.applyImpulse = function (t, e) {
				this.activate(), Ut(this, t.x, t.y, e);
			}),
			(Q.prototype.getVelAtPoint = function (t) {
				return b(new T(this.vx, this.vy), I(l(t), this.w));
			}),
			(Q.prototype.getVelAtWorldPoint = function (t) {
				return this.getVelAtPoint(R(t, this.p));
			}),
			(Q.prototype.getVelAtLocalPoint = function (t) {
				return this.getVelAtPoint(_(t, this.rot));
			}),
			(Q.prototype.eachShape = function (t) {
				for (var e = 0, i = this.shapeList.length; e < i; e++)
					t(this.shapeList[e]);
			}),
			(Q.prototype.eachConstraint = function (t) {
				for (var e = this.constraintList; e; ) {
					var i = e.next(this);
					t(e), (e = i);
				}
			}),
			(Q.prototype.eachArbiter = function (t) {
				for (var e = this.arbiterList; e; ) {
					var i = e.next(this);
					(e.swappedColl = this === e.body_b), t(e), (e = i);
				}
			}),
			(Q.prototype.local2World = function (t) {
				return b(this.p, _(t, this.rot));
			}),
			(Q.prototype.world2Local = function (t) {
				return e(R(t, this.p), this.rot);
			}),
			(Q.prototype.localToWorld = Q.prototype.local2World),
			(Q.prototype.worldToLocal = Q.prototype.world2Local),
			(Q.prototype.kineticEnergy = function () {
				var t = this.vx * this.vx + this.vy * this.vy,
					e = this.w * this.w;
				return (t ? t * this.m : 0) + (e ? e * this.i : 0);
			});
		var tt = (c.SpatialIndex = function (t) {
			if ((this.staticIndex = t)) {
				if (t.dynamicIndex)
					throw new Error(
						'This static index is already associated with a dynamic index.'
					);
				t.dynamicIndex = this;
			}
		});
		tt.prototype.collideStatic = function (t, e) {
			var i;
			0 < t.count &&
				((i = t.query),
				this.each(function (t) {
					i(t, new G(t.bb_l, t.bb_b, t.bb_r, t.bb_t), e);
				}));
		};
		var et = (c.BBTree = function (t) {
			tt.call(this, t),
				(this.velocityFunc = null),
				(this.leaves = {}),
				(this.count = 0),
				(this.root = null),
				(this.pooledNodes = null),
				(this.pooledPairs = null),
				(this.stamp = 0);
		});
		function it(t, e, i) {
			(this.obj = null),
				(this.bb_l = E(e.bb_l, i.bb_l)),
				(this.bb_b = E(e.bb_b, i.bb_b)),
				(this.bb_r = A(e.bb_r, i.bb_r)),
				(this.bb_t = A(e.bb_t, i.bb_t)),
				(this.parent = null),
				this.setA(e),
				this.setB(i);
		}
		function nt(t, e) {
			(this.obj = e),
				t.getBB(e, this),
				(this.parent = null),
				(this.stamp = 1),
				(this.pairs = null);
		}
		function rt(t, e, i, n) {
			(this.prevA = null),
				(this.leafA = t),
				(this.nextA = e),
				(this.prevB = null),
				(this.leafB = i),
				(this.nextB = n);
		}
		function ot(t, e, i) {
			i && (i.leafA === e ? (i.prevA = t) : (i.prevB = t)),
				t
					? t.leafA === e
						? (t.nextA = i)
						: (t.nextB = i)
					: (e.pairs = i);
		}
		function st(t, e, i) {
			var n = t.pairs,
				r = e.pairs,
				i = i.makePair(t, n, e, r);
			(t.pairs = e.pairs = i),
				n && (n.leafA === t ? (n.prevA = i) : (n.prevB = i)),
				r && (r.leafA === e ? (r.prevA = i) : (r.prevB = i));
		}
		function ct(t, e) {
			return (
				(A(t.bb_r, e.bb_r) - E(t.bb_l, e.bb_l)) *
				(A(t.bb_t, e.bb_t) - E(t.bb_b, e.bb_b))
			);
		}
		function at(t, e) {
			return (
				Math.abs(t.bb_l + t.bb_r - e.bb_l - e.bb_r) +
				Math.abs(t.bb_b + t.bb_t - e.bb_b - e.bb_t)
			);
		}
		(et.prototype = Object.create(tt.prototype)),
			(et.prototype.makeNode = function (t, e) {
				var i = this.pooledNodes;
				return i
					? ((this.pooledNodes = i.parent),
					  i.constructor(this, t, e),
					  i)
					: new it(0, t, e);
			}),
			(et.prototype.getBB = function (t, e) {
				var i,
					n,
					r = this.velocityFunc;
				r
					? ((i = 0.1 * (t.bb_r - t.bb_l)),
					  (n = 0.1 * (t.bb_t - t.bb_b)),
					  (r = I(r(t), 0.1)),
					  (e.bb_l = t.bb_l + E(-i, r.x)),
					  (e.bb_b = t.bb_b + E(-n, r.y)),
					  (e.bb_r = t.bb_r + A(i, r.x)),
					  (e.bb_t = t.bb_t + A(n, r.y)))
					: ((e.bb_l = t.bb_l),
					  (e.bb_b = t.bb_b),
					  (e.bb_r = t.bb_r),
					  (e.bb_t = t.bb_t));
			}),
			(et.prototype.getStamp = function () {
				var t = this.dynamicIndex;
				return (t && t.stamp ? t : this).stamp;
			}),
			(et.prototype.incrementStamp = function () {
				this.dynamicIndex && this.dynamicIndex.stamp
					? this.dynamicIndex.stamp++
					: this.stamp++;
			}),
			(et.prototype.makePair = function (t, e, i, n) {
				var r = this.pooledPairs;
				return r
					? ((this.pooledPairs = r.prevA),
					  (r.prevA = null),
					  (r.leafA = t),
					  (r.nextA = e),
					  (r.prevB = null),
					  (r.leafB = i),
					  (r.nextB = n),
					  r)
					: new rt(t, e, i, n);
			}),
			(rt.prototype.recycle = function (t) {
				(this.prevA = t.pooledPairs), (t.pooledPairs = this);
			}),
			(nt.prototype.clearPairs = function (t) {
				var e,
					i = this.pairs;
				for (this.pairs = null; i; )
					i.leafA === this
						? ((e = i.nextA), ot(i.prevB, i.leafB, i.nextB))
						: ((e = i.nextB), ot(i.prevA, i.leafA, i.nextA)),
						i.recycle(t),
						(i = e);
			}),
			(it.prototype.recycle = function (t) {
				(this.parent = t.pooledNodes), (t.pooledNodes = this);
			}),
			(nt.prototype.recycle = function (t) {}),
			(it.prototype.setA = function (t) {
				(this.A = t).parent = this;
			}),
			(it.prototype.setB = function (t) {
				(this.B = t).parent = this;
			}),
			(it.prototype.isLeaf = !(nt.prototype.isLeaf = !0)),
			(it.prototype.otherChild = function (t) {
				return this.A == t ? this.B : this.A;
			}),
			(it.prototype.replaceChild = function (t, e, i) {
				m(t == this.A || t == this.B, 'Node is not a child of parent.'),
					this.A == t
						? (this.A.recycle(i), this.setA(e))
						: (this.B.recycle(i), this.setB(e));
				for (var n = this; n; n = n.parent) {
					var r = n.A,
						o = n.B;
					(n.bb_l = E(r.bb_l, o.bb_l)),
						(n.bb_b = E(r.bb_b, o.bb_b)),
						(n.bb_r = A(r.bb_r, o.bb_r)),
						(n.bb_t = A(r.bb_t, o.bb_t));
				}
			}),
			(it.prototype.bbArea = nt.prototype.bbArea =
				function () {
					return (this.bb_r - this.bb_l) * (this.bb_t - this.bb_b);
				});
		var lt = function (t, e, i) {
			if (null == t) return e;
			if (t.isLeaf) return i.makeNode(e, t);
			var n = t.B.bbArea() + ct(t.A, e),
				r = t.A.bbArea() + ct(t.B, e);
			return (
				n === r && ((n = at(t.A, e)), (r = at(t.B, e))),
				r < n ? t.setB(lt(t.B, e, i)) : t.setA(lt(t.A, e, i)),
				(t.bb_l = E(t.bb_l, e.bb_l)),
				(t.bb_b = E(t.bb_b, e.bb_b)),
				(t.bb_r = A(t.bb_r, e.bb_r)),
				(t.bb_t = A(t.bb_t, e.bb_t)),
				t
			);
		};
		function ht(t, e, i) {
			var n = 1 / (i.x - e.x),
				r = t.bb_l == e.x ? -1 / 0 : (t.bb_l - e.x) * n,
				o = t.bb_r == e.x ? 1 / 0 : (t.bb_r - e.x) * n,
				n = E(r, o),
				r = A(r, o),
				o = 1 / (i.y - e.y),
				i = t.bb_b == e.y ? -1 / 0 : (t.bb_b - e.y) * o,
				e = t.bb_t == e.y ? 1 / 0 : (t.bb_t - e.y) * o,
				o = E(i, e),
				e = A(i, e);
			if (o <= r && n <= e) {
				o = A(n, o);
				if (0 <= E(r, e) && o <= 1) return A(o, 0);
			}
			return 1 / 0;
		}
		it.prototype.intersectsBB = nt.prototype.intersectsBB = function (t) {
			return (
				this.bb_l <= t.r &&
				t.l <= this.bb_r &&
				this.bb_b <= t.t &&
				t.b <= this.bb_t
			);
		};
		var ut = function (t, e, i) {
				t.intersectsBB(e) &&
					(t.isLeaf ? i(t.obj) : (ut(t.A, e, i), ut(t.B, e, i)));
			},
			_t = function (t, e, i, n, r) {
				if (t.isLeaf) return r(t.obj);
				var o = ht(t.A, e, i),
					s = ht(t.B, e, i);
				return (
					o < s
						? (o < n && (n = E(n, _t(t.A, e, i, n, r))),
						  s < n && (n = E(n, _t(t.B, e, i, n, r))))
						: (s < n && (n = E(n, _t(t.B, e, i, n, r))),
						  o < n && (n = E(n, _t(t.A, e, i, n, r)))),
					n
				);
			};
		function dt(t, e, i) {
			if (e == t) return null;
			var n = e.parent;
			return n != t
				? (n.parent.replaceChild(n, n.otherChild(e), i), t)
				: (((e = t.otherChild(e)).parent = t.parent), t.recycle(i), e);
		}
		function pt(t, e) {
			return (
				t.bb_l <= e.bb_r &&
				e.bb_l <= t.bb_r &&
				t.bb_b <= e.bb_t &&
				e.bb_b <= t.bb_t
			);
		}
		function ft(t, e) {}
		function mt(t, e, i, n, r) {
			return (
				(A(t.bb_r, n) - E(t.bb_l, e)) * (A(t.bb_t, r) - E(t.bb_b, i))
			);
		}
		(et.prototype.subtreeRecycle = function (t) {
			t.isLeaf &&
				(this.subtreeRecycle(t.A),
				this.subtreeRecycle(t.B),
				t.recycle(this));
		}),
			(nt.prototype.markLeafQuery = function (t, e, i, n) {
				pt(t, this) &&
					(e
						? st(t, this, i)
						: (this.stamp < t.stamp && st(this, t, i),
						  n && n(t.obj, this.obj)));
			}),
			(it.prototype.markLeafQuery = function (t, e, i, n) {
				pt(t, this) &&
					(this.A.markLeafQuery(t, e, i, n),
					this.B.markLeafQuery(t, e, i, n));
			}),
			(nt.prototype.markSubtree = function (t, e, i) {
				if (this.stamp == t.getStamp()) {
					e && e.markLeafQuery(this, !1, t, i);
					for (var n = this; n.parent; n = n.parent)
						n == n.parent.A
							? n.parent.B.markLeafQuery(this, !0, t, i)
							: n.parent.A.markLeafQuery(this, !1, t, i);
				} else
					for (var r = this.pairs; r; )
						r =
							this === r.leafB
								? (i && i(r.leafA.obj, this.obj), r.nextB)
								: r.nextA;
			}),
			(it.prototype.markSubtree = function (t, e, i) {
				this.A.markSubtree(t, e, i), this.B.markSubtree(t, e, i);
			}),
			(nt.prototype.containsObj = function (t) {
				return (
					this.bb_l <= t.bb_l &&
					this.bb_r >= t.bb_r &&
					this.bb_b <= t.bb_b &&
					this.bb_t >= t.bb_t
				);
			}),
			(nt.prototype.update = function (t) {
				var e = t.root,
					i = this.obj;
				return (
					!this.containsObj(i) &&
					(t.getBB(this.obj, this),
					(e = dt(e, this, t)),
					(t.root = lt(e, this, t)),
					this.clearPairs(t),
					(this.stamp = t.getStamp()),
					!0)
				);
			}),
			(nt.prototype.addPairs = function (t) {
				var e,
					i = t.dynamicIndex;
				i
					? (e = i.root) && e.markLeafQuery(this, !0, i, null)
					: ((i = t.staticIndex.root), this.markSubtree(t, i, null));
			}),
			(et.prototype.insert = function (t, e) {
				t = new nt(this, t);
				(this.leaves[e] = t),
					(this.root = lt(this.root, t, this)),
					this.count++,
					(t.stamp = this.getStamp()),
					t.addPairs(this),
					this.incrementStamp();
			}),
			(et.prototype.remove = function (t, e) {
				var i = this.leaves[e];
				delete this.leaves[e],
					(this.root = dt(this.root, i, this)),
					this.count--,
					i.clearPairs(this),
					i.recycle(this);
			}),
			(et.prototype.contains = function (t, e) {
				return null != this.leaves[e];
			}),
			(et.prototype.reindexQuery = function (t) {
				if (this.root) {
					var e,
						i = this.leaves;
					for (e in i) i[e].update(this);
					var n = this.staticIndex,
						r = n && n.root;
					this.root.markSubtree(this, r, t),
						n && !r && this.collideStatic(this, n, t),
						this.incrementStamp();
				}
			}),
			(et.prototype.reindex = function () {
				this.reindexQuery(ft);
			}),
			(et.prototype.reindexObject = function (t, e) {
				e = this.leaves[e];
				e &&
					(e.update(this) && e.addPairs(this), this.incrementStamp());
			}),
			(et.prototype.pointQuery = function (t, e) {
				this.query(new G(t.x, t.y, t.x, t.y), e);
			}),
			(et.prototype.segmentQuery = function (t, e, i, n) {
				this.root && _t(this.root, t, e, i, n);
			}),
			(et.prototype.query = function (t, e) {
				this.root && ut(this.root, t, e);
			}),
			(et.prototype.count = function () {
				return this.count;
			}),
			(et.prototype.each = function (t) {
				for (var e in this.leaves) t(this.leaves[e].obj);
			});
		var gt = function (t, e, i, n) {
			if (1 == n) return e[i];
			if (2 == n) return t.makeNode(e[i], e[i + 1]);
			for (
				var r = (v = e[i]).bb_l,
					o = v.bb_b,
					s = v.bb_r,
					c = v.bb_t,
					a = i + n,
					l = i + 1;
				l < a;
				l++
			)
				(v = e[l]),
					(r = E(r, v.bb_l)),
					(o = E(o, v.bb_b)),
					(s = A(s, v.bb_r)),
					(c = A(c, v.bb_t));
			var h = c - o < s - r,
				u = new Array(2 * n);
			if (h)
				for (l = i; l < a; l++)
					(u[2 * l + 0] = e[l].bb_l), (u[2 * l + 1] = e[l].bb_r);
			else
				for (l = i; l < a; l++)
					(u[2 * l + 0] = e[l].bb_b), (u[2 * l + 1] = e[l].bb_t);
			u.sort(function (t, e) {
				return t - e;
			});
			var _ = 0.5 * (u[n - 1] + u[n]),
				d = r,
				p = o,
				f = s,
				m = c,
				g = r,
				y = o,
				T = s,
				S = c;
			h ? (f = g = _) : (m = y = _);
			for (var C = a, x = i; x < C; ) {
				var v = e[x];
				mt(v, g, y, T, S) < mt(v, d, p, f, m)
					? (C--, (e[x] = e[C]), (e[C] = v))
					: x++;
			}
			if (C != n)
				return NodeNew(t, gt(t, e, i, C - i), gt(t, e, C, a - C));
			for (v = null, l = i; l < a; l++) v = lt(v, e[l], t);
			return v;
		};
		et.prototype.optimize = function () {
			var t,
				e = new Array(this.count),
				i = 0;
			for (t in this.leaves) e[i++] = this.nodes[t];
			tree.subtreeRecycle(root), (this.root = gt(tree, e, e.length));
		};
		var yt = function (t, e) {
			!t.isLeaf && e <= 10 && (yt(t.A, e + 1), yt(t.B, e + 1));
			for (var i = '', n = 0; n < e; n++) i += ' ';
			console.log(i + t.bb_b + ' ' + t.bb_t);
		};
		et.prototype.log = function () {
			this.root && yt(this.root, 0);
		};
		var Tt = (c.CollisionHandler = function () {
			this.a = this.b = 0;
		});
		function St(t, e) {
			(this.e = 0),
				(this.u = 0),
				(this.surface_vr = S),
				(this.a = t),
				(this.body_a = t.body),
				(this.b = e),
				(this.body_b = e.body),
				(this.thread_a_next = this.thread_a_prev = null),
				(this.thread_b_next = this.thread_b_prev = null),
				(this.contacts = null),
				(this.stamp = 0),
				(this.handler = null),
				(this.swappedColl = !1),
				(this.state = 'first coll');
		}
		function Ct(t, e, i) {
			(this.point = t), (this.normal = e), (this.dist = i);
		}
		function xt(t, e, i, n) {
			i
				? i.body_a === e
					? (i.thread_a_next = n)
					: (i.thread_b_next = n)
				: (e.arbiterList = n),
				n &&
					(n.body_a === e
						? (n.thread_a_prev = i)
						: (n.thread_b_prev = i));
		}
		function vt(t, e, i, n) {
			(this.p = t),
				(this.n = e),
				(this.dist = i),
				(this.r1 = this.r2 = S),
				(this.nMass = this.tMass = this.bounce = this.bias = 0),
				(this.jnAcc = this.jtAcc = this.jBias = 0),
				(this.hash = n),
				0;
		}
		function Et(t, e, i, n) {
			var r = i + n,
				n = R(e, t),
				e = L(n);
			if (!(r * r <= e)) {
				e = Math.sqrt(e);
				return new vt(
					b(t, I(n, 0.5 + (i - 0.5 * r) / (e || 1 / 0))),
					e ? I(n, 1 / e) : new T(1, 0),
					e - r,
					0
				);
			}
		}
		function At(t, e) {
			var i = 0,
				n = t.valueOnAxis(e[0].n, e[0].d);
			if (0 < n) return -1;
			for (var r = 1; r < e.length; r++) {
				var o = t.valueOnAxis(e[r].n, e[r].d);
				if (0 < o) return -1;
				n < o && ((n = o), (i = r));
			}
			return (wt = n), i;
		}
		function bt(t, e, i, n) {
			for (var r = [], o = t.tVerts, s = 0; s < o.length; s += 2) {
				var c = o[s],
					a = o[s + 1];
				e.containsVert(c, a) &&
					r.push(new vt(new T(c, a), i, n, p(t.hashid, s >> 1)));
			}
			for (var l = e.tVerts, s = 0; s < l.length; s += 2) {
				(c = l[s]), (a = l[s + 1]);
				t.containsVert(c, a) &&
					r.push(new vt(new T(c, a), i, n, p(e.hashid, s >> 1)));
			}
			return r.length
				? r
				: (function (t, e, i, n) {
						for (
							var r = [], o = t.tVerts, s = 0;
							s < o.length;
							s += 2
						) {
							var c = o[s],
								a = o[s + 1];
							e.containsVertPartial(c, a, P(i)) &&
								r.push(
									new vt(new T(c, a), i, n, p(t.hashid, s))
								);
						}
						for (var l = e.tVerts, s = 0; s < l.length; s += 2) {
							(c = l[s]), (a = l[s + 1]);
							t.containsVertPartial(c, a, i) &&
								r.push(
									new vt(new T(c, a), i, n, p(e.hashid, s))
								);
						}
						return r;
				  })(t, e, i, n);
		}
		function Rt(t, e, i) {
			var n = C(e, t.ta) - t.r,
				t = C(e, t.tb) - t.r;
			return E(n, t) - i;
		}
		function Pt(t, e, i, n, r) {
			for (
				var o = w(e.tn, e.ta),
					s = w(e.tn, e.tb),
					c = I(e.tn, r),
					a = i.tVerts,
					l = 0;
				l < a.length;
				l += 2
			) {
				var h,
					u = a[l],
					_ = a[l + 1];
				x(u, _, c.x, c.y) < C(e.tn, e.ta) * r + e.r &&
					(h = D(e.tn.x, e.tn.y, u, _)) <= o &&
					s <= h &&
					t.push(new vt(new T(u, _), c, n, p(i.hashid, l)));
			}
		}
		(Tt.prototype.begin = function (t, e) {
			return !0;
		}),
			(Tt.prototype.preSolve = function (t, e) {
				return !0;
			}),
			(Tt.prototype.postSolve = function (t, e) {}),
			(Tt.prototype.separate = function (t, e) {}),
			(St.prototype.getShapes = function () {
				return this.swappedColl ? [this.b, this.a] : [this.a, this.b];
			}),
			(St.prototype.totalImpulse = function () {
				for (
					var t = this.contacts, e = new T(0, 0), i = 0, n = t.length;
					i < n;
					i++
				) {
					var r = t[i];
					e.add(I(r.n, r.jnAcc));
				}
				return this.swappedColl ? e : e.neg();
			}),
			(St.prototype.totalImpulseWithFriction = function () {
				for (
					var t = this.contacts, e = new T(0, 0), i = 0, n = t.length;
					i < n;
					i++
				) {
					var r = t[i];
					e.add(new T(r.jnAcc, r.jtAcc).rotate(r.n));
				}
				return this.swappedColl ? e : e.neg();
			}),
			(St.prototype.totalKE = function () {
				for (
					var t = (1 - this.e) / (1 + this.e),
						e = 0,
						i = this.contacts,
						n = 0,
						r = i.length;
					n < r;
					n++
				) {
					var o = i[n],
						s = o.jnAcc,
						c = o.jtAcc;
					e += (t * s * s) / o.nMass + (c * c) / o.tMass;
				}
				return e;
			}),
			(St.prototype.ignore = function () {
				this.state = 'ignore';
			}),
			(St.prototype.getA = function () {
				return this.swappedColl ? this.b : this.a;
			}),
			(St.prototype.getB = function () {
				return this.swappedColl ? this.a : this.b;
			}),
			(St.prototype.isFirstContact = function () {
				return 'first coll' === this.state;
			}),
			(St.prototype.getContactPointSet = function () {
				for (
					var t = new Array(this.contacts.length), e = 0;
					e < t.length;
					e++
				)
					t[e] = new Ct(
						this.contacts[e].p,
						this.contacts[e].n,
						this.contacts[e].dist
					);
				return t;
			}),
			(St.prototype.getNormal = function (t) {
				t = this.contacts[t].n;
				return this.swappedColl ? P(t) : t;
			}),
			(St.prototype.getPoint = function (t) {
				return this.contacts[t].p;
			}),
			(St.prototype.getDepth = function (t) {
				return this.contacts[t].dist;
			}),
			(St.prototype.unthread = function () {
				xt(0, this.body_a, this.thread_a_prev, this.thread_a_next),
					xt(0, this.body_b, this.thread_b_prev, this.thread_b_next),
					(this.thread_a_prev = this.thread_a_next = null),
					(this.thread_b_prev = this.thread_b_next = null);
			}),
			(St.prototype.update = function (t, e, i, n) {
				if (this.contacts)
					for (var r = 0; r < this.contacts.length; r++)
						for (
							var o = this.contacts[r], s = 0;
							s < t.length;
							s++
						) {
							var c = t[s];
							c.hash === o.hash &&
								((c.jnAcc = o.jnAcc), (c.jtAcc = o.jtAcc));
						}
				(this.contacts = t),
					(this.handler = e),
					(this.swappedColl = i.collision_type !== e.a),
					(this.e = i.e * n.e),
					(this.u = i.u * n.u),
					(this.surface_vr = R(i.surface_v, n.surface_v)),
					(this.a = i),
					(this.body_a = i.body),
					(this.b = n),
					(this.body_b = n.body),
					'cached' == this.state && (this.state = 'first coll');
			}),
			(St.prototype.preStep = function (t, e, i) {
				for (
					var n = this.body_a, r = this.body_b, o = 0;
					o < this.contacts.length;
					o++
				) {
					var s = this.contacts[o];
					(s.r1 = R(s.p, n.p)),
						(s.r2 = R(s.p, r.p)),
						(s.nMass = 1 / Ht(n, r, s.r1, s.r2, s.n)),
						(s.tMass = 1 / Ht(n, r, s.r1, s.r2, l(s.n))),
						(s.bias = (-i * E(0, s.dist + e)) / t),
						(s.jBias = 0),
						(s.bounce = zt(n, r, s.r1, s.r2, s.n) * this.e);
				}
			}),
			(St.prototype.applyCachedImpulse = function (t) {
				if (!this.isFirstContact())
					for (
						var e = this.body_a, i = this.body_b, n = 0;
						n < this.contacts.length;
						n++
					) {
						var r = this.contacts[n],
							o = r.n.x,
							s = r.n.y,
							c = o * r.jnAcc - s * r.jtAcc,
							s = o * r.jtAcc + s * r.jnAcc;
						Yt(e, i, r.r1, r.r2, c * t, s * t);
					}
			}),
			(St.prototype.applyImpulse = function () {
				0;
				for (
					var t = this.body_a,
						e = this.body_b,
						i = this.surface_vr,
						n = this.u,
						r = 0;
					r < this.contacts.length;
					r++
				) {
					0;
					var o = this.contacts[r],
						s = o.nMass,
						c = o.n,
						a = o.r1,
						l = o.r2,
						h = e.vx - l.y * e.w - (t.vx - a.y * t.w),
						u = e.vy + l.x * e.w - (t.vy + a.x * t.w),
						_ =
							c.x *
								(e.v_biasx -
									l.y * e.w_bias -
									t.v_biasx +
									a.y * t.w_bias) +
							c.y *
								(l.x * e.w_bias +
									e.v_biasy -
									a.x * t.w_bias -
									t.v_biasy),
						d = x(h, u, c.x, c.y),
						h = x(h + i.x, u + i.y, -c.y, c.x),
						u = (o.bias - _) * s,
						_ = o.jBias;
					o.jBias = A(_ + u, 0);
					(u = -(o.bounce + d) * s), (d = o.jnAcc);
					o.jnAcc = A(d + u, 0);
					(s = n * o.jnAcc), (u = -h * o.tMass), (h = o.jtAcc);
					o.jtAcc = g(h + u, -s, s);
					(s = c.x * (o.jBias - _)), (_ = c.y * (o.jBias - _));
					Xt(t, -s, -_, a), Xt(e, s, _, l);
					(d = o.jnAcc - d), (h = o.jtAcc - h);
					Yt(t, e, a, l, c.x * d - c.y * h, c.x * h + c.y * d);
				}
			}),
			(St.prototype.callSeparate = function (t) {
				t.lookupHandler(
					this.a.collision_type,
					this.b.collision_type
				).separate(this, t);
			}),
			(St.prototype.next = function (t) {
				return this.body_a == t
					? this.thread_a_next
					: this.thread_b_next;
			});
		var It = [],
			wt = 0;
		(t.prototype.collisionCode = 0),
			(H.prototype.collisionCode = 1),
			(q.prototype.collisionCode = 2),
			(t.prototype.collisionTable = [
				function (t, e) {
					e = Et(t.tc, e.tc, t.r, e.r);
					return e ? [e] : It;
				},
				function (t, e) {
					var i = e.ta,
						n = e.tb,
						r = t.tc,
						o = R(n, i),
						n = y(C(o, R(r, i)) / L(o)),
						o = b(i, I(o, n)),
						o = Et(r, o, t.r, e.r);
					if (o) {
						t = o.n;
						return (0 === n && C(t, e.a_tangent) < 0) ||
							(1 === n && C(t, e.b_tangent) < 0)
							? It
							: [o];
					}
					return It;
				},
				function (t, e) {
					for (
						var i = e.tPlanes,
							n = 0,
							r = C(i[0].n, t.tc) - i[0].d - t.r,
							o = 0;
						o < i.length;
						o++
					) {
						var s = C(i[o].n, t.tc) - i[o].d - t.r;
						if (0 < s) return It;
						r < s && ((r = s), (n = o));
					}
					var c,
						a = i[n].n,
						l = e.tVerts,
						h = l.length,
						u = n << 1,
						_ = l[u],
						d = l[1 + u],
						p = l[(2 + u) % h],
						e = l[(3 + u) % h],
						l = D(a.x, a.y, _, d),
						u = D(a.x, a.y, p, e),
						h = w(a, t.tc);
					return h < u
						? (c = Et(t.tc, new T(p, e), t.r, 0))
							? [c]
							: It
						: h < l
						? [new vt(R(t.tc, I(a, t.r + r / 2)), P(a), r, 0)]
						: (c = Et(t.tc, new T(_, d), t.r, 0))
						? [c]
						: It;
				},
			]),
			(H.prototype.collisionTable = [
				null,
				function (t, e) {
					return It;
				},
				function (t, e) {
					var i = [],
						n = e.tPlanes,
						r = n.length,
						o = C(t.tn, t.ta),
						s = e.valueOnAxis(t.tn, o) - t.r,
						c = e.valueOnAxis(P(t.tn), -o) - t.r;
					if (0 < c || 0 < s) return It;
					var a = 0,
						l = Rt(t, n[0].n, n[0].d);
					if (0 < l) return It;
					for (var h = 0; h < r; h++) {
						var u = Rt(t, n[h].n, n[h].d);
						if (0 < u) return It;
						l < u && ((l = u), (a = h));
					}
					var _ = P(n[a].n),
						d = b(t.ta, I(_, t.r)),
						o = b(t.tb, I(_, t.r));
					if (
						(e.containsVert(d.x, d.y) &&
							i.push(new vt(d, _, l, p(t.hashid, 0))),
						e.containsVert(o.x, o.y) &&
							i.push(new vt(o, _, l, p(t.hashid, 1))),
						(l <= s || l <= c) &&
							(c < s ? Pt(i, t, e, s, 1) : Pt(i, t, e, c, -1)),
						0 === i.length)
					) {
						(_ = 2 * a),
							(s = e.tVerts),
							(c = new T(s[_], s[1 + _]));
						if ((e = Et(t.ta, c, t.r, 0))) return [e];
						if ((e = Et(t.tb, c, t.r, 0))) return [e];
						(c = 2 * r),
							(c = new T(s[(2 + _) % c], s[(3 + _) % c]));
						if ((e = Et(t.ta, c, t.r, 0))) return [e];
						if ((e = Et(t.tb, c, t.r, 0))) return [e];
					}
					return i;
				},
			]),
			(q.prototype.collisionTable = [
				null,
				null,
				function (t, e) {
					var i = At(e, t.tPlanes);
					if (-1 == i) return It;
					var n = wt,
						r = At(t, e.tPlanes);
					if (-1 == r) return It;
					var o = wt;
					return o < n
						? bt(t, e, t.tPlanes[i].n, n)
						: bt(t, e, P(e.tPlanes[r].n), o);
				},
			]);
		var Dt = (c.collideShapes = function (t, e) {
				return (
					f(
						t.collisionCode <= e.collisionCode,
						'Collided shapes must be sorted by type'
					),
					t.collisionTable[e.collisionCode](t, e)
				);
			}),
			Lt = new Tt();
		function Ot(t) {
			f(
				!t.locked,
				'This addition/removal cannot be done safely during a call to cpSpaceStep()  or during a query. Put these calls into a post-step callback.'
			);
		}
		function Bt(t) {
			return t ? t.nodeRoot : null;
		}
		((H = c.Space =
			function () {
				(this.stamp = 0),
					(this.curr_dt = 0),
					(this.bodies = []),
					(this.rousedBodies = []),
					(this.sleepingComponents = []),
					(this.staticShapes = new et(null)),
					(this.activeShapes = new et(this.staticShapes)),
					(this.arbiters = []),
					(this.contactBuffersHead = null),
					(this.cachedArbiters = {}),
					(this.constraints = []),
					(this.locked = 0),
					(this.collisionHandlers = {}),
					(this.defaultHandler = Lt),
					(this.postStepCallbacks = []),
					(this.iterations = 10),
					(this.gravity = S),
					(this.damping = 1),
					(this.idleSpeedThreshold = 0),
					(this.sleepTimeThreshold = 1 / 0),
					(this.collisionSlop = 0.1),
					(this.collisionBias = Math.pow(0.9, 60)),
					(this.collisionPersistence = 3),
					(this.enableContactGraph = !1),
					(this.staticBody = new Q(1 / 0, 1 / 0)),
					(this.staticBody.nodeIdleTime = 1 / 0),
					(this.collideShapes = this.makeCollideShapes());
			}).prototype.getCurrentTimeStep = function () {
			return this.curr_dt;
		}),
			(H.prototype.setIterations = function (t) {
				this.iterations = t;
			}),
			(H.prototype.isLocked = function () {
				return this.locked;
			}),
			(H.prototype.addCollisionHandler = function (t, e, i, n, r, o) {
				Ot(this), this.removeCollisionHandler(t, e);
				var s = new Tt();
				(s.a = t),
					(s.b = e),
					i && (s.begin = i),
					n && (s.preSolve = n),
					r && (s.postSolve = r),
					o && (s.separate = o),
					(this.collisionHandlers[p(t, e)] = s);
			}),
			(H.prototype.removeCollisionHandler = function (t, e) {
				Ot(this), delete this.collisionHandlers[p(t, e)];
			}),
			(H.prototype.setDefaultCollisionHandler = function (t, e, i, n) {
				Ot(this);
				var r = new Tt();
				t && (r.begin = t),
					e && (r.preSolve = e),
					i && (r.postSolve = i),
					n && (r.separate = n),
					(this.defaultHandler = r);
			}),
			(H.prototype.lookupHandler = function (t, e) {
				return this.collisionHandlers[p(t, e)] || this.defaultHandler;
			}),
			(H.prototype.addShape = function (t) {
				var e = t.body;
				return e.isStatic()
					? this.addStaticShape(t)
					: (f(
							!t.space,
							'This shape is already added to a space and cannot be added to another.'
					  ),
					  Ot(this),
					  e.activate(),
					  e.addShape(t),
					  t.update(e.p, e.rot),
					  this.activeShapes.insert(t, t.hashid),
					  (t.space = this),
					  t);
			}),
			(H.prototype.addStaticShape = function (t) {
				f(
					!t.space,
					'This shape is already added to a space and cannot be added to another.'
				),
					Ot(this);
				var e = t.body;
				return (
					e.addShape(t),
					t.update(e.p, e.rot),
					this.staticShapes.insert(t, t.hashid),
					(t.space = this),
					t
				);
			}),
			(H.prototype.addBody = function (t) {
				return (
					f(
						!t.isStatic(),
						'Static bodies cannot be added to a space as they are not meant to be simulated.'
					),
					f(
						!t.space,
						'This body is already added to a space and cannot be added to another.'
					),
					Ot(this),
					this.bodies.push(t),
					(t.space = this),
					t
				);
			}),
			(H.prototype.addConstraint = function (t) {
				f(
					!t.space,
					'This shape is already added to a space and cannot be added to another.'
				),
					Ot(this);
				var e = t.a,
					i = t.b;
				return (
					e.activate(),
					i.activate(),
					this.constraints.push(t),
					(t.next_a = e.constraintList),
					((e.constraintList = t).next_b = i.constraintList),
					((i.constraintList = t).space = this),
					t
				);
			}),
			(H.prototype.filterArbiters = function (t, e) {
				for (var i in this.cachedArbiters) {
					var n = this.cachedArbiters[i];
					((t !== n.body_a || (e !== n.a && null !== e)) &&
						(t !== n.body_b || (e !== n.b && null !== e))) ||
						(e && 'cached' !== n.state && n.callSeparate(this),
						n.unthread(),
						s(this.arbiters, n),
						delete this.cachedArbiters[i]);
				}
			}),
			(H.prototype.removeShape = function (t) {
				var e = t.body;
				e.isStatic()
					? this.removeStaticShape(t)
					: (f(
							this.containsShape(t),
							'Cannot remove a shape that was not added to the space. (Removed twice maybe?)'
					  ),
					  Ot(this),
					  e.activate(),
					  e.removeShape(t),
					  this.filterArbiters(e, t),
					  this.activeShapes.remove(t, t.hashid),
					  (t.space = null));
			}),
			(H.prototype.removeStaticShape = function (t) {
				f(
					this.containsShape(t),
					'Cannot remove a static or sleeping shape that was not added to the space. (Removed twice maybe?)'
				),
					Ot(this);
				var e = t.body;
				e.isStatic() && e.activateStatic(t),
					e.removeShape(t),
					this.filterArbiters(e, t),
					this.staticShapes.remove(t, t.hashid),
					(t.space = null);
			}),
			(H.prototype.removeBody = function (t) {
				f(
					this.containsBody(t),
					'Cannot remove a body that was not added to the space. (Removed twice maybe?)'
				),
					Ot(this),
					t.activate(),
					s(this.bodies, t),
					(t.space = null);
			}),
			(H.prototype.removeConstraint = function (t) {
				f(
					this.containsConstraint(t),
					'Cannot remove a constraint that was not added to the space. (Removed twice maybe?)'
				),
					Ot(this),
					t.a.activate(),
					t.b.activate(),
					s(this.constraints, t),
					t.a.removeConstraint(t),
					t.b.removeConstraint(t),
					(t.space = null);
			}),
			(H.prototype.containsShape = function (t) {
				return t.space === this;
			}),
			(H.prototype.containsBody = function (t) {
				return t.space == this;
			}),
			(H.prototype.containsConstraint = function (t) {
				return t.space == this;
			}),
			(H.prototype.uncacheArbiter = function (t) {
				delete this.cachedArbiters[p(t.a.hashid, t.b.hashid)],
					s(this.arbiters, t);
			}),
			(H.prototype.eachBody = function (t) {
				this.lock();
				for (var e = this.bodies, i = 0; i < e.length; i++) t(e[i]);
				for (var n = this.sleepingComponents, i = 0; i < n.length; i++)
					for (var r = n[i]; r; ) {
						var o = r.nodeNext;
						t(r), (r = o);
					}
				this.unlock(!0);
			}),
			(H.prototype.eachShape = function (t) {
				this.lock(),
					this.activeShapes.each(t),
					this.staticShapes.each(t),
					this.unlock(!0);
			}),
			(H.prototype.eachConstraint = function (t) {
				this.lock();
				for (var e = this.constraints, i = 0; i < e.length; i++)
					t(e[i]);
				this.unlock(!0);
			}),
			(H.prototype.reindexStatic = function () {
				f(
					!this.locked,
					'You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.'
				),
					this.staticShapes.each(function (t) {
						var e = t.body;
						t.update(e.p, e.rot);
					}),
					this.staticShapes.reindex();
			}),
			(H.prototype.reindexShape = function (t) {
				f(
					!this.locked,
					'You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.'
				);
				var e = t.body;
				t.update(e.p, e.rot),
					this.activeShapes.reindexObject(t, t.hashid),
					this.staticShapes.reindexObject(t, t.hashid);
			}),
			(H.prototype.reindexShapesForBody = function (t) {
				for (var e = t.shapeList; e; e = e.next) this.reindexShape(e);
			}),
			(H.prototype.useSpatialHash = function (t, e) {
				throw new Error('Spatial Hash not implemented.');
			}),
			(H.prototype.activateBody = function (t) {
				if (
					(f(
						!t.isRogue(),
						'Internal error: Attempting to activate a rogue body.'
					),
					this.locked)
				)
					-1 === this.rousedBodies.indexOf(t) &&
						this.rousedBodies.push(t);
				else {
					this.bodies.push(t);
					for (var e = 0; e < t.shapeList.length; e++) {
						var i = t.shapeList[e];
						this.staticShapes.remove(i, i.hashid),
							this.activeShapes.insert(i, i.hashid);
					}
					for (var n, r, o = t.arbiterList; o; o = o.next(t))
						(t !== (s = o.body_a) && !s.isStatic()) ||
							((n = o.a),
							(r = o.b),
							((this.cachedArbiters[p(n.hashid, r.hashid)] =
								o).stamp = this.stamp),
							(o.handler = this.lookupHandler(
								n.collision_type,
								r.collision_type
							)),
							this.arbiters.push(o));
					for (var s, c = t.constraintList; c; c = c.nodeNext)
						(t !== (s = c.a) && !s.isStatic()) ||
							this.constraints.push(c);
				}
			}),
			(H.prototype.deactivateBody = function (t) {
				f(
					!t.isRogue(),
					'Internal error: Attempting to deactivate a rogue body.'
				),
					s(this.bodies, t);
				for (var e = 0; e < t.shapeList.length; e++) {
					var i = t.shapeList[e];
					this.activeShapes.remove(i, i.hashid),
						this.staticShapes.insert(i, i.hashid);
				}
				for (var n = t.arbiterList; n; n = n.next(t))
					(t !== (r = n.body_a) && !r.isStatic()) ||
						this.uncacheArbiter(n);
				for (var r, o = t.constraintList; o; o = o.nodeNext)
					(t !== (r = o.a) && !r.isStatic()) ||
						s(this.constraints, o);
			}),
			(Q.prototype.activate = function () {
				this.isRogue() ||
					((this.nodeIdleTime = 0),
					(function (t) {
						if (t && t.isSleeping(t)) {
							f(
								!t.isRogue(),
								'Internal Error: componentActivate() called on a rogue body.'
							);
							for (var e = t.space, i = t; i; ) {
								var n = i.nodeNext;
								(i.nodeIdleTime = 0),
									(i.nodeRoot = null),
									(i.nodeNext = null),
									e.activateBody(i),
									(i = n);
							}
							s(e.sleepingComponents, t);
						}
					})(Bt(this)));
			}),
			(Q.prototype.activateStatic = function (t) {
				f(
					this.isStatic(),
					'Body.activateStatic() called on a non-static body.'
				);
				for (var e = this.arbiterList; e; e = e.next(this))
					(t && t != e.a && t != e.b) ||
						(e.body_a == this ? e.body_b : e.body_a).activate();
			}),
			(Q.prototype.pushArbiter = function (t) {
				m(
					null ===
						(t.body_a === this ? t.thread_a_next : t.thread_b_next),
					'Internal Error: Dangling contact graph pointers detected. (A)'
				),
					m(
						null ===
							(t.body_a === this
								? t.thread_a_prev
								: t.thread_b_prev),
						'Internal Error: Dangling contact graph pointers detected. (B)'
					);
				var e = this.arbiterList;
				m(
					null === e ||
						null ===
							(e.body_a === this
								? e.thread_a_prev
								: e.thread_b_prev),
					'Internal Error: Dangling contact graph pointers detected. (C)'
				),
					t.body_a === this
						? (t.thread_a_next = e)
						: (t.thread_b_next = e),
					e &&
						(e.body_a === this
							? (e.thread_a_prev = t)
							: (e.thread_b_prev = t)),
					(this.arbiterList = t);
			});
		var Nt = function (t, e) {
			if (!e.isRogue()) {
				var i = Bt(e);
				if (null == i) {
					(o = t),
						((s = e).nodeRoot = o),
						s !== o &&
							((s.nodeNext = o.nodeNext), (o.nodeNext = s));
					for (var n = e.arbiterList; n; n = n.next(e))
						Nt(t, e == n.body_a ? n.body_b : n.body_a);
					for (var r = e.constraintList; r; r = r.next(e))
						Nt(t, e == r.a ? r.b : r.a);
				} else
					m(
						i === t,
						'Internal Error: Inconsistency detected in the contact graph.'
					);
			}
			var o, s;
		};
		function Ft(t) {
			var e = t.body;
			t.update(e.p, e.rot);
		}
		function Mt(t, e, i, n) {
			var r = t.vx + -i.y * t.w,
				i = t.vy + i.x * t.w,
				t = e.vx + -n.y * e.w,
				e = e.vy + n.x * e.w;
			return new T(t - r, e - i);
		}
		function Vt(t, e, i) {
			return (i = w(e, i)), t.m_inv + t.i_inv * i * i;
		}
		function kt(t, e, i, n, r, o) {
			var s = (u = t.m_inv + e.m_inv),
				c = 0,
				a = 0,
				l = u,
				h = t.i_inv,
				u = i.x * i.x * h,
				t = i.y * i.y * h,
				h = -i.x * i.y * h;
			(s += t),
				(c += h),
				(a += h),
				(l += u),
				(h = e.i_inv),
				(u = n.x * n.x * h),
				(e = n.y * n.y * h),
				(h = -n.x * n.y * h),
				(h = (s += e) * (l += u) - (c += h) * (a += h)),
				m(0 != h, 'Unsolvable constraint.'),
				(h = 1 / h),
				(r.x = l * h),
				(r.y = -c * h),
				(o.x = -a * h),
				(o.y = s * h);
		}
		function Gt(t, e, i) {
			return new T(C(t, e), C(t, i));
		}
		function Wt(t, e) {
			return 1 - Math.pow(t, e);
		}
		(H.prototype.processComponents = function (t) {
			for (
				var e = this.sleepTimeThreshold !== 1 / 0,
					i = this.bodies,
					n = 0;
				n < i.length;
				n++
			) {
				var r = i[n];
				m(
					null === r.nodeNext,
					'Internal Error: Dangling next pointer detected in contact graph.'
				),
					m(
						null === r.nodeRoot,
						'Internal Error: Dangling root pointer detected in contact graph.'
					);
			}
			if (e)
				for (
					var o = this.idleSpeedThreshold,
						s = o ? o * o : L(this.gravity) * t * t,
						n = 0;
					n < i.length;
					n++
				) {
					var r = i[n],
						c = s ? r.m * s : 0;
					r.nodeIdleTime =
						r.kineticEnergy() > c ? 0 : r.nodeIdleTime + t;
				}
			for (var a = this.arbiters, n = 0, l = a.length; n < l; n++) {
				var h = a[n],
					u = h.body_a,
					_ = h.body_b;
				e &&
					(((_.isRogue() && !_.isStatic()) || u.isSleeping()) &&
						u.activate(),
					((u.isRogue() && !u.isStatic()) || _.isSleeping()) &&
						_.activate()),
					u.pushArbiter(h),
					_.pushArbiter(h);
			}
			if (e) {
				for (var d = this.constraints, n = 0; n < d.length; n++) {
					var p = d[n],
						u = p.a;
					(_ = p.b).isRogue() && !_.isStatic() && u.activate(),
						u.isRogue() && !u.isStatic() && _.activate();
				}
				for (n = 0; n < i.length; ) {
					r = i[n];
					if (
						null !== Bt(r) ||
						(Nt(r, r),
						(function (t, e) {
							for (var i = t; i; i = i.nodeNext)
								if (i.nodeIdleTime < e) return !0;
							return !1;
						})(r, this.sleepTimeThreshold))
					)
						n++, (r.nodeRoot = null), (r.nodeNext = null);
					else {
						this.sleepingComponents.push(r);
						for (var f = r; f; f = f.nodeNext)
							this.deactivateBody(f);
					}
				}
			}
		}),
			(Q.prototype.sleep = function () {
				this.sleepWithGroup(null);
			}),
			(Q.prototype.sleepWithGroup = function (t) {
				f(
					!this.isStatic() && !this.isRogue(),
					'Rogue and static bodies cannot be put to sleep.'
				);
				var e = this.space;
				if (
					(f(e, 'Cannot put a rogue body to sleep.'),
					f(
						!e.locked,
						'Bodies cannot be put to sleep during a query or a call to cpSpaceStep(). Put these calls into a post-step callback.'
					),
					f(
						null === t || t.isSleeping(),
						'Cannot use a non-sleeping body as a group identifier.'
					),
					this.isSleeping())
				)
					f(
						Bt(this) === Bt(t),
						"The body is already sleeping and it's group cannot be reassigned."
					);
				else {
					for (var i = 0; i < this.shapeList.length; i++)
						this.shapeList[i].update(this.p, this.rot);
					e.deactivateBody(this),
						t
							? ((t = Bt(t)),
							  (this.nodeRoot = t),
							  (this.nodeNext = t.nodeNext),
							  (this.nodeIdleTime = 0),
							  (t.nodeNext = this))
							: (((this.nodeRoot = this).nodeNext = null),
							  (this.nodeIdleTime = 0),
							  e.sleepingComponents.push(this)),
						s(e.bodies, this);
				}
			}),
			(H.prototype.activateShapesTouchingShape = function (t) {
				this.sleepTimeThreshold !== 1 / 0 &&
					this.shapeQuery(t, function (t, e) {
						t.body.activate();
					});
			}),
			(H.prototype.pointQuery = function (e, i, n, r) {
				function t(t) {
					(!t.group || n !== t.group) &&
						i & t.layers &&
						t.pointQuery(e) &&
						r(t);
				}
				var o = new G(e.x, e.y, e.x, e.y);
				this.lock(),
					this.activeShapes.query(o, t),
					this.staticShapes.query(o, t),
					this.unlock(!0);
			}),
			(H.prototype.pointQueryFirst = function (t, e, i) {
				var n = null;
				return (
					this.pointQuery(t, e, i, function (t) {
						t.sensor || (n = t);
					}),
					n
				);
			}),
			(H.prototype.nearestPointQuery = function (i, n, r, o, s) {
				function t(t) {
					var e;
					(t.group && o === t.group) ||
						!(r & t.layers) ||
						((e = t.nearestPointQuery(i)).d < n && s(t, e.d, e.p));
				}
				var e = W(i, n);
				this.lock(),
					this.activeShapes.query(e, t),
					this.staticShapes.query(e, t),
					this.unlock(!0);
			}),
			(H.prototype.nearestPointQueryNearest = function (e, i, n, r) {
				function t(t) {
					(t.group && r === t.group) ||
						!(n & t.layers) ||
						t.sensor ||
						((t = t.nearestPointQuery(e)).d < i &&
							(!o || t.d < o.d) &&
							(o = t));
				}
				var o,
					s = W(e, i);
				return (
					this.activeShapes.query(s, t),
					this.staticShapes.query(s, t),
					o
				);
			}),
			(c.SHAPE_FILTER_ALL = {
				group: c.NO_GROUP,
				categories: c.ALL_CATEGORIES,
				mask: c.ALL_CATEGORIES,
			}),
			(H.prototype.pointQueryNearest = function (t, e, i) {
				i = this.nearestPointQueryNearest(t, e, i.mask, i.group);
				return void 0 !== i && ((i.distance = i.d), (i.point = i.p)), i;
			}),
			(H.prototype.segmentQuery = function (i, n, r, o, s) {
				function t(t) {
					var e;
					return (
						(!t.group || o !== t.group) &&
							r & t.layers &&
							(e = t.segmentQuery(i, n)) &&
							s(t, e.t, e.n),
						1
					);
				}
				this.lock(),
					this.staticShapes.segmentQuery(i, n, 1, t),
					this.activeShapes.segmentQuery(i, n, 1, t),
					this.unlock(!0);
			}),
			(H.prototype.segmentQueryFirst = function (i, n, r, o) {
				function t(t) {
					var e;
					return (
						(!t.group || o !== t.group) &&
							r & t.layers &&
							!t.sensor &&
							(e = t.segmentQuery(i, n)) &&
							(null === s || e.t < s.t) &&
							(s = e),
						s ? s.t : 1
					);
				}
				var s = null;
				return (
					this.staticShapes.segmentQuery(i, n, 1, t),
					this.activeShapes.segmentQuery(i, n, s ? s.t : 1, t),
					s &&
						'null' !== s &&
						'undefined' !== s &&
						((s.normal = s.n),
						(s.alpha = s.t),
						(s.p = s.point = c.v.lerp(i, n, s.t))),
					s
				);
			}),
			(H.prototype.bbQuery = function (s, c, a, l) {
				function t(t) {
					var e, i, n, r, o;
					(!t.group || a !== t.group) &&
						c & t.layers &&
						((e = s),
						(i = t.bb_l),
						(n = t.bb_b),
						(r = t.bb_r),
						(o = t.bb_t),
						e.l <= r && i <= e.r && e.b <= o && n <= e.t) &&
						l(t);
				}
				this.lock(),
					this.activeShapes.query(s, t),
					this.staticShapes.query(s, t),
					this.unlock(!0);
			}),
			(H.prototype.shapeQuery = function (o, s) {
				var t = o.body;
				t && o.update(t.p, t.rot);
				var e = new G(o.bb_l, o.bb_b, o.bb_r, o.bb_t),
					c = !1,
					t = function (t) {
						var e,
							i = o;
						if (
							(!i.group || i.group !== t.group) &&
							i.layers & t.layers &&
							i !== t
						) {
							if (i.collisionCode <= t.collisionCode)
								e = Dt(i, t);
							else {
								e = Dt(t, i);
								for (var n = 0; n < e.length; n++)
									e[n].n = P(e[n].n);
							}
							if (
								e.length &&
								((c = !(i.sensor || t.sensor)), s)
							) {
								for (
									var r = new Array(e.length), n = 0;
									n < e.length;
									n++
								)
									r[n] = new Ct(e[n].p, e[n].n, e[n].dist);
								s(t, r);
							}
						}
					};
				return (
					this.lock(),
					this.activeShapes.query(e, t),
					this.staticShapes.query(e, t),
					this.unlock(!0),
					c
				);
			}),
			(H.prototype.addPostStepCallback = function (t) {
				m(
					this.locked,
					'Adding a post-step callback when the space is not locked is unnecessary. Post-step callbacks will not called until the end of the next call to cpSpaceStep() or the next query.'
				),
					this.postStepCallbacks.push(t);
			}),
			(H.prototype.runPostStepCallbacks = function () {
				for (var t = 0; t < this.postStepCallbacks.length; t++)
					this.postStepCallbacks[t]();
				this.postStepCallbacks = [];
			}),
			(H.prototype.lock = function () {
				this.locked++;
			}),
			(H.prototype.unlock = function (t) {
				if (
					(this.locked--,
					f(
						0 <= this.locked,
						'Internal Error: Space lock underflow.'
					),
					0 === this.locked && t)
				) {
					for (var e = this.rousedBodies, i = 0; i < e.length; i++)
						this.activateBody(e[i]);
					(e.length = 0), this.runPostStepCallbacks();
				}
			}),
			(H.prototype.makeCollideShapes = function () {
				var a = this;
				return function (t, e) {
					var i,
						n,
						r,
						o,
						s,
						c = a;
					t.bb_l <= e.bb_r &&
						e.bb_l <= t.bb_r &&
						t.bb_b <= e.bb_t &&
						e.bb_b <= t.bb_t &&
						t.body !== e.body &&
						(!t.group || t.group !== e.group) &&
						t.layers & e.layers &&
						((i = c.lookupHandler(
							t.collision_type,
							e.collision_type
						)),
						((n = t.sensor || e.sensor) && i === Lt) ||
							(t.collisionCode > e.collisionCode &&
								((s = t), (t = e), (e = s)),
							0 !== (r = Dt(t, e)).length &&
								((o = p(t.hashid, e.hashid)),
								(s =
									(s = c.cachedArbiters[o]) ||
									(c.cachedArbiters[o] = new St(
										t,
										e
									))).update(r, i, t, e),
								'first coll' != s.state ||
									i.begin(s, c) ||
									s.ignore(),
								'ignore' !== s.state && i.preSolve(s, c) && !n
									? c.arbiters.push(s)
									: ((s.contacts = null),
									  'ignore' !== s.state &&
											(s.state = 'normal')),
								(s.stamp = c.stamp))));
				};
			}),
			(H.prototype.arbiterSetFilter = function (t) {
				var e = this.stamp - t.stamp,
					i = t.body_a,
					n = t.body_b;
				return (
					!(
						(!i.isStatic() && !i.isSleeping()) ||
						(!n.isStatic() && !n.isSleeping())
					) ||
					(1 <= e &&
						'cached' != t.state &&
						(t.callSeparate(this), (t.state = 'cached')),
					!(e >= this.collisionPersistence) ||
						((t.contacts = null), !1))
				);
			}),
			(H.prototype.step = function (t) {
				if (0 !== t) {
					f(0 === S.x && 0 === S.y, 'vzero is invalid'), this.stamp++;
					var e,
						i,
						n = this.curr_dt;
					this.curr_dt = t;
					var r = this.bodies,
						o = this.constraints,
						s = this.arbiters;
					for (h = 0; h < s.length; h++) {
						var c = s[h];
						(c.state = 'normal'),
							c.body_a.isSleeping() ||
								c.body_b.isSleeping() ||
								c.unthread();
					}
					for (s.length = 0, this.lock(), h = 0; h < r.length; h++)
						r[h].position_func(t);
					for (i in (this.activeShapes.each(Ft),
					this.activeShapes.reindexQuery(this.collideShapes),
					this.unlock(!1),
					this.processComponents(t),
					this.lock(),
					this.cachedArbiters))
						this.arbiterSetFilter(this.cachedArbiters[i]) ||
							delete this.cachedArbiters[i];
					for (
						var a = this.collisionSlop,
							l = 1 - Math.pow(this.collisionBias, t),
							h = 0;
						h < s.length;
						h++
					)
						s[h].preStep(t, a, l);
					for (h = 0; h < o.length; h++) {
						var u = o[h];
						u.preSolve(this), u.preStep(t);
					}
					var _ = Math.pow(this.damping, t),
						d = this.gravity;
					for (h = 0; h < r.length; h++) r[h].velocity_func(d, _, t);
					var p = 0 === n ? 0 : t / n;
					for (h = 0; h < s.length; h++) s[h].applyCachedImpulse(p);
					for (h = 0; h < o.length; h++) o[h].applyCachedImpulse(p);
					for (h = 0; h < this.iterations; h++) {
						for (e = 0; e < s.length; e++) s[e].applyImpulse();
						for (e = 0; e < o.length; e++) o[e].applyImpulse();
					}
					for (h = 0; h < o.length; h++) o[h].postSolve(this);
					for (h = 0; h < s.length; h++)
						s[h].handler.postSolve(s[h], this);
					this.unlock(!0);
				}
			});
		var zt = function (t, e, i, n, r) {
				var o = t.vx + -i.y * t.w,
					i = t.vy + i.x * t.w,
					t = e.vx + -n.y * e.w,
					e = e.vy + n.x * e.w;
				return x(t - o, e - i, r.x, r.y);
			},
			Ut = function (t, e, i, n) {
				(t.vx += e * t.m_inv),
					(t.vy += i * t.m_inv),
					(t.w += t.i_inv * (n.x * i - n.y * e));
			},
			Yt = function (t, e, i, n, r, o) {
				Ut(t, -r, -o, i), Ut(e, r, o, n);
			},
			Xt = function (t, e, i, n) {
				(t.v_biasx += e * t.m_inv),
					(t.v_biasy += i * t.m_inv),
					(t.w_bias += t.i_inv * D(n.x, n.y, e, i));
			},
			Ht = function (t, e, i, n, r) {
				r = Vt(t, i, r) + Vt(e, n, r);
				return m(0 !== r, 'Unsolvable collision or constraint.'), r;
			},
			jt = (c.Constraint = function (t, e) {
				(this.a = t),
					(this.b = e),
					(this.space = null),
					(this.next_a = null),
					(this.next_b = null),
					(this.maxForce = 1 / 0),
					(this.errorBias = Math.pow(0.9, 60)),
					(this.maxBias = 1 / 0);
			});
		function qt(t, e) {
			return (t.restLength - e) * t.stiffness;
		}
		function Jt(t, e) {
			return (e - t.restAngle) * t.stiffness;
		}
		(jt.prototype.activateBodies = function () {
			this.a && this.a.activate(), this.b && this.b.activate();
		}),
			(jt.prototype.preStep = function (t) {}),
			(jt.prototype.applyCachedImpulse = function (t) {}),
			(jt.prototype.applyImpulse = function () {}),
			(jt.prototype.getImpulse = function () {
				return 0;
			}),
			(jt.prototype.preSolve = function (t) {}),
			(jt.prototype.postSolve = function (t) {}),
			(jt.prototype.next = function (t) {
				return this.a === t ? this.next_a : this.next_b;
			}),
			((H = c.PinJoint =
				function (t, e, i, n) {
					jt.call(this, t, e), (this.anchr1 = i), (this.anchr2 = n);
					(i = t ? b(t.p, _(i, t.rot)) : i),
						(n = e ? b(e.p, _(n, e.rot)) : n);
					(this.dist = v(R(n, i))),
						m(
							0 < this.dist,
							'You created a 0 length pin joint. A pivot joint will be much more stable.'
						),
						(this.r1 = this.r2 = null),
						(this.n = null),
						(this.nMass = 0),
						(this.jnAcc = this.jnMax = 0),
						(this.bias = 0);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b;
				(this.r1 = _(this.anchr1, e.rot)),
					(this.r2 = _(this.anchr2, i.rot));
				var n = R(b(i.p, this.r2), b(e.p, this.r1)),
					r = v(n);
				(this.n = I(n, 1 / (r || 1 / 0))),
					(this.nMass = 1 / Ht(e, i, this.r1, this.r2, this.n));
				i = this.maxBias;
				(this.bias = g(
					(-Wt(this.errorBias, t) * (r - this.dist)) / t,
					-i,
					i
				)),
					(this.jnMax = this.maxForce * t);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				t = I(this.n, this.jnAcc * t);
				Yt(this.a, this.b, this.r1, this.r2, t.x, t.y);
			}),
			(H.prototype.applyImpulse = function () {
				var t = this.a,
					e = this.b,
					i = this.n,
					n = zt(t, e, this.r1, this.r2, i),
					r = (this.bias - n) * this.nMass,
					n = this.jnAcc;
				(this.jnAcc = g(n + r, -this.jnMax, this.jnMax)),
					(r = this.jnAcc - n),
					Yt(t, e, this.r1, this.r2, i.x * r, i.y * r);
			}),
			(H.prototype.getImpulse = function () {
				return Math.abs(this.jnAcc);
			}),
			((H = c.SlideJoint =
				function (t, e, i, n, r, o) {
					jt.call(this, t, e),
						(this.anchr1 = i),
						(this.anchr2 = n),
						(this.min = r),
						(this.max = o),
						(this.r1 = this.r2 = this.n = null),
						(this.nMass = 0),
						(this.jnAcc = this.jnMax = 0),
						(this.bias = 0);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b;
				(this.r1 = _(this.anchr1, e.rot)),
					(this.r2 = _(this.anchr2, i.rot));
				var n = R(b(i.p, this.r2), b(e.p, this.r1)),
					r = v(n),
					o = 0;
				r > this.max
					? ((o = r - this.max), (this.n = F(n)))
					: r < this.min
					? ((o = this.min - r), (this.n = P(F(n))))
					: ((this.n = S), (this.jnAcc = 0)),
					(this.nMass = 1 / Ht(e, i, this.r1, this.r2, this.n));
				i = this.maxBias;
				(this.bias = g((-Wt(this.errorBias, t) * o) / t, -i, i)),
					(this.jnMax = this.maxForce * t);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				t = this.jnAcc * t;
				Yt(
					this.a,
					this.b,
					this.r1,
					this.r2,
					this.n.x * t,
					this.n.y * t
				);
			}),
			(H.prototype.applyImpulse = function () {
				var t, e, i, n, r;
				(0 === this.n.x && 0 === this.n.y) ||
					((t = this.a),
					(e = this.b),
					(i = this.n),
					(n = this.r1),
					(r = this.r2),
					(n = Mt(t, e, n, r)),
					(r = C(n, i)),
					(n = (this.bias - r) * this.nMass),
					(r = this.jnAcc),
					(this.jnAcc = g(r + n, -this.jnMax, 0)),
					(n = this.jnAcc - r),
					Yt(t, e, this.r1, this.r2, i.x * n, i.y * n));
			}),
			(H.prototype.getImpulse = function () {
				return Math.abs(this.jnAcc);
			}),
			((H = c.PivotJoint =
				function (t, e, i, n) {
					var r;
					jt.call(this, t, e),
						void 0 === n &&
							((r = i),
							(i = t ? t.world2Local(r) : r),
							(n = e ? e.world2Local(r) : r)),
						(this.anchr1 = i),
						(this.anchr2 = n),
						(this.r1 = this.r2 = S),
						(this.k1 = new T(0, 0)),
						(this.k2 = new T(0, 0)),
						(this.jAcc = S),
						(this.jMaxLen = 0),
						(this.bias = S);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b;
				(this.r1 = _(this.anchr1, e.rot)),
					(this.r2 = _(this.anchr2, i.rot)),
					kt(e, i, this.r1, this.r2, this.k1, this.k2),
					(this.jMaxLen = this.maxForce * t);
				e = R(b(i.p, this.r2), b(e.p, this.r1));
				this.bias = M(I(e, -Wt(this.errorBias, t) / t), this.maxBias);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				Yt(
					this.a,
					this.b,
					this.r1,
					this.r2,
					this.jAcc.x * t,
					this.jAcc.y * t
				);
			}),
			(H.prototype.applyImpulse = function () {
				var t = this.a,
					e = this.b,
					i = this.r1,
					n = this.r2,
					i = Mt(t, e, i, n),
					n = Gt(R(this.bias, i), this.k1, this.k2),
					i = this.jAcc;
				(this.jAcc = M(b(this.jAcc, n), this.jMaxLen)),
					Yt(
						t,
						e,
						this.r1,
						this.r2,
						this.jAcc.x - i.x,
						this.jAcc.y - i.y
					);
			}),
			(H.prototype.getImpulse = function () {
				return v(this.jAcc);
			}),
			((H = c.GrooveJoint =
				function (t, e, i, n, r) {
					jt.call(this, t, e),
						(this.grv_a = i),
						(this.grv_b = n),
						(this.grv_n = l(N(R(n, i)))),
						(this.anchr2 = r),
						(this.grv_tn = null),
						(this.clamp = 0),
						(this.r1 = this.r2 = null),
						(this.k1 = new T(0, 0)),
						(this.k2 = new T(0, 0)),
						(this.jAcc = S),
						(this.jMaxLen = 0),
						(this.bias = null);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b,
					n = e.local2World(this.grv_a),
					r = e.local2World(this.grv_b),
					o = _(this.grv_n, e.rot),
					s = C(n, o);
				(this.grv_tn = o), (this.r2 = _(this.anchr2, i.rot));
				var c = w(b(i.p, this.r2), o);
				c <= w(n, o)
					? ((this.clamp = 1), (this.r1 = R(n, e.p)))
					: c >= w(r, o)
					? ((this.clamp = -1), (this.r1 = R(r, e.p)))
					: ((this.clamp = 0),
					  (this.r1 = R(b(I(l(o), -c), I(o, s)), e.p))),
					kt(e, i, this.r1, this.r2, this.k1, this.k2),
					(this.jMaxLen = this.maxForce * t);
				e = R(b(i.p, this.r2), b(e.p, this.r1));
				this.bias = M(I(e, -Wt(this.errorBias, t) / t), this.maxBias);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				Yt(
					this.a,
					this.b,
					this.r1,
					this.r2,
					this.jAcc.x * t,
					this.jAcc.y * t
				);
			}),
			(H.prototype.grooveConstrain = function (t) {
				var e = this.grv_tn,
					e = 0 < this.clamp * w(t, e) ? t : i(t, e);
				return M(e, this.jMaxLen);
			}),
			(H.prototype.applyImpulse = function () {
				var t = this.a,
					e = this.b,
					i = this.r1,
					n = this.r2,
					i = Mt(t, e, i, n),
					n = Gt(R(this.bias, i), this.k1, this.k2),
					i = this.jAcc;
				(this.jAcc = this.grooveConstrain(b(i, n))),
					Yt(
						t,
						e,
						this.r1,
						this.r2,
						this.jAcc.x - i.x,
						this.jAcc.y - i.y
					);
			}),
			(H.prototype.getImpulse = function () {
				return v(this.jAcc);
			}),
			(H.prototype.setGrooveA = function (t) {
				(this.grv_a = t),
					(this.grv_n = l(N(R(this.grv_b, t)))),
					this.activateBodies();
			}),
			(H.prototype.setGrooveB = function (t) {
				(this.grv_b = t),
					(this.grv_n = l(N(R(t, this.grv_a)))),
					this.activateBodies();
			}),
			((H = c.DampedSpring =
				function (t, e, i, n, r, o, s) {
					jt.call(this, t, e),
						(this.anchr1 = i),
						(this.anchr2 = n),
						(this.restLength = r),
						(this.stiffness = o),
						(this.damping = s),
						(this.springForceFunc = qt),
						(this.target_vrn = this.v_coef = 0),
						(this.r1 = this.r2 = null),
						(this.nMass = 0),
						(this.n = null);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b;
				(this.r1 = _(this.anchr1, e.rot)),
					(this.r2 = _(this.anchr2, i.rot));
				var n = R(b(i.p, this.r2), b(e.p, this.r1)),
					r = v(n);
				this.n = I(n, 1 / (r || 1 / 0));
				n = Ht(e, i, this.r1, this.r2, this.n);
				m(0 !== n, 'Unsolvable this.'),
					(this.nMass = 1 / n),
					(this.target_vrn = 0),
					(this.v_coef = 1 - Math.exp(-this.damping * t * n));
				r = this.springForceFunc(this, r);
				Yt(e, i, this.r1, this.r2, this.n.x * r * t, this.n.y * r * t);
			}),
			(H.prototype.applyCachedImpulse = function (t) {}),
			(H.prototype.applyImpulse = function () {
				var t = this.a,
					e = this.b,
					i = this.n,
					n = this.r1,
					r = this.r2,
					r = zt(t, e, n, r, i),
					i = (this.target_vrn - r) * this.v_coef;
				(this.target_vrn = r + i),
					(i *= this.nMass),
					Yt(t, e, this.r1, this.r2, this.n.x * i, this.n.y * i);
			}),
			(H.prototype.getImpulse = function () {
				return 0;
			}),
			((H = c.DampedRotarySpring =
				function (t, e, i, n, r) {
					jt.call(this, t, e),
						(this.restAngle = i),
						(this.stiffness = n),
						(this.damping = r),
						(this.springTorqueFunc = Jt),
						(this.target_wrn = 0),
						(this.w_coef = 0),
						(this.iSum = 0);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b,
					n = e.i_inv + i.i_inv;
				m(0 !== n, 'Unsolvable spring.'),
					(this.iSum = 1 / n),
					(this.w_coef = 1 - Math.exp(-this.damping * t * n)),
					(this.target_wrn = 0);
				t = this.springTorqueFunc(this, e.a - i.a) * t;
				(e.w -= t * e.i_inv), (i.w += t * i.i_inv);
			}),
			(H.prototype.applyImpulse = function () {
				var t = this.a,
					e = this.b,
					i = t.w - e.w,
					n = (this.target_wrn - i) * this.w_coef;
				this.target_wrn = i + n;
				n *= this.iSum;
				(t.w += n * t.i_inv), (e.w -= n * e.i_inv);
			}),
			((H = c.RotaryLimitJoint =
				function (t, e, i, n) {
					jt.call(this, t, e),
						(this.min = i),
						(this.max = n),
						(this.jAcc = 0),
						(this.iSum = this.bias = this.jMax = 0);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b,
					n = i.a - e.a,
					r = 0;
				n > this.max
					? (r = this.max - n)
					: n < this.min && (r = this.min - n),
					(this.iSum = 1 / (1 / e.i + 1 / i.i));
				i = this.maxBias;
				(this.bias = g((-Wt(this.errorBias, t) * r) / t, -i, i)),
					(this.jMax = this.maxForce * t),
					this.bias || (this.jAcc = 0);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				var e = this.a,
					i = this.b,
					t = this.jAcc * t;
				(e.w -= t * e.i_inv), (i.w += t * i.i_inv);
			}),
			(H.prototype.applyImpulse = function () {
				var t, e, i, n;
				this.bias &&
					((t = this.a),
					(n = (e = this.b).w - t.w),
					(i = -(this.bias + n) * this.iSum),
					(n = this.jAcc),
					this.bias < 0
						? (this.jAcc = g(n + i, 0, this.jMax))
						: (this.jAcc = g(n + i, -this.jMax, 0)),
					(i = this.jAcc - n),
					(t.w -= i * t.i_inv),
					(e.w += i * e.i_inv));
			}),
			(H.prototype.getImpulse = function () {
				return Math.abs(joint.jAcc);
			}),
			((H = c.RatchetJoint =
				function (t, e, i, n) {
					jt.call(this, t, e),
						(this.angle = 0),
						(this.phase = i),
						(this.ratchet = n),
						(this.angle = (e ? e.a : 0) - (t ? t.a : 0)),
						(this.iSum = this.bias = this.jAcc = this.jMax = 0);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b,
					n = this.angle,
					r = this.phase,
					o = this.ratchet,
					s = i.a - e.a,
					c = n - s,
					n = 0;
				0 < c * o
					? (n = c)
					: (this.angle = Math.floor((s - r) / o) * o + r),
					(this.iSum = 1 / (e.i_inv + i.i_inv));
				i = this.maxBias;
				(this.bias = g((-Wt(this.errorBias, t) * n) / t, -i, i)),
					(this.jMax = this.maxForce * t),
					this.bias || (this.jAcc = 0);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				var e = this.a,
					i = this.b,
					t = this.jAcc * t;
				(e.w -= t * e.i_inv), (i.w += t * i.i_inv);
			}),
			(H.prototype.applyImpulse = function () {
				var t, e, i, n, r;
				this.bias &&
					((t = this.a),
					(r = (e = this.b).w - t.w),
					(i = this.ratchet),
					(n = -(this.bias + r) * this.iSum),
					(r = this.jAcc),
					(this.jAcc =
						g((r + n) * i, 0, this.jMax * Math.abs(i)) / i),
					(n = this.jAcc - r),
					(t.w -= n * t.i_inv),
					(e.w += n * e.i_inv));
			}),
			(H.prototype.getImpulse = function (t) {
				return Math.abs(t.jAcc);
			}),
			((H = c.GearJoint =
				function (t, e, i, n) {
					jt.call(this, t, e),
						(this.phase = i),
						(this.ratio = n),
						(this.ratio_inv = 1 / n),
						(this.jAcc = 0),
						(this.iSum = this.bias = this.jMax = 0);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				var e = this.a,
					i = this.b;
				this.iSum =
					1 / (e.i_inv * this.ratio_inv + this.ratio * i.i_inv);
				var n = this.maxBias;
				(this.bias = g(
					(-Wt(this.errorBias, t) *
						(i.a * this.ratio - e.a - this.phase)) /
						t,
					-n,
					n
				)),
					(this.jMax = this.maxForce * t);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				var e = this.a,
					i = this.b,
					t = this.jAcc * t;
				(e.w -= t * e.i_inv * this.ratio_inv), (i.w += t * i.i_inv);
			}),
			(H.prototype.applyImpulse = function () {
				var t = this.a,
					e = this.b,
					i = e.w * this.ratio - t.w,
					n = (this.bias - i) * this.iSum,
					i = this.jAcc;
				(this.jAcc = g(i + n, -this.jMax, this.jMax)),
					(n = this.jAcc - i),
					(t.w -= n * t.i_inv * this.ratio_inv),
					(e.w += n * e.i_inv);
			}),
			(H.prototype.getImpulse = function () {
				return Math.abs(this.jAcc);
			}),
			(H.prototype.setRatio = function (t) {
				(this.ratio = t),
					(this.ratio_inv = 1 / t),
					this.activateBodies();
			}),
			((H = c.SimpleMotor =
				function (t, e, i) {
					jt.call(this, t, e),
						(this.rate = i),
						(this.jAcc = 0),
						(this.iSum = this.jMax = 0);
				}).prototype = Object.create(jt.prototype)),
			(H.prototype.preStep = function (t) {
				(this.iSum = 1 / (this.a.i_inv + this.b.i_inv)),
					(this.jMax = this.maxForce * t);
			}),
			(H.prototype.applyCachedImpulse = function (t) {
				var e = this.a,
					i = this.b,
					t = this.jAcc * t;
				(e.w -= t * e.i_inv), (i.w += t * i.i_inv);
			}),
			(H.prototype.applyImpulse = function () {
				var t = this.a,
					e = this.b,
					i = -(e.w - t.w + this.rate) * this.iSum,
					n = this.jAcc;
				(this.jAcc = g(n + i, -this.jMax, this.jMax)),
					(i = this.jAcc - n),
					(t.w -= i * t.i_inv),
					(e.w += i * e.i_inv);
			}),
			(H.prototype.getImpulse = function () {
				return Math.abs(this.jAcc);
			});
	})();
var sp = sp || {};
(sp.VERTEX_INDEX = { X1: 0, Y1: 1, X2: 2, Y2: 3, X3: 4, Y3: 5, X4: 6, Y4: 7 }),
	(sp.ATTACHMENT_TYPE = {
		REGION: 0,
		BOUNDING_BOX: 1,
		MESH: 2,
		SKINNED_MESH: 3,
	}),
	(sp.Skeleton = cc.Node.extend({
		_skeleton: null,
		_rootBone: null,
		_timeScale: 1,
		_debugSlots: !1,
		_debugBones: !1,
		_premultipliedAlpha: !1,
		_ownsSkeletonData: null,
		_atlas: null,
		_blendFunc: null,
		ctor: function (t, e, i) {
			cc.Node.prototype.ctor.call(this),
				0 === arguments.length
					? this.init()
					: this.initWithArgs(t, e, i);
		},
		_createRenderCmd: function () {
			return new (
				cc._renderType === cc.game.RENDER_TYPE_CANVAS
					? sp.Skeleton.CanvasRenderCmd
					: sp.Skeleton.WebGLRenderCmd
			)(this);
		},
		init: function () {
			cc.Node.prototype.init.call(this),
				(this._premultipliedAlpha =
					cc._renderType === cc.game.RENDER_TYPE_WEBGL &&
					cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA),
				(this._blendFunc = { src: cc.BLEND_SRC, dst: cc.BLEND_DST }),
				this.scheduleUpdate();
		},
		setDebugSolots: function (t) {
			this._debugSlots = t;
		},
		setDebugBones: function (t) {
			this._debugBones = t;
		},
		setDebugSlotsEnabled: function (t) {
			this._debugSlots = t;
		},
		getDebugSlotsEnabled: function () {
			return this._debugSlots;
		},
		setDebugBonesEnabled: function (t) {
			this._debugBones = t;
		},
		getDebugBonesEnabled: function () {
			return this._debugBones;
		},
		setTimeScale: function (t) {
			this._timeScale = t;
		},
		getTimeScale: function () {
			return this._timeScale;
		},
		initWithArgs: function (t, e, i) {
			var n,
				r,
				o = t,
				s = e,
				e = cc.isString(o)
					? ((s = cc.isString(s)
							? ((n = cc.loader.getRes(s)),
							  sp._atlasLoader.setAtlasFile(s),
							  new spine.Atlas(n, sp._atlasLoader))
							: e),
					  (i = i || 1 / cc.director.getContentScaleFactor()),
					  (r = new spine.AtlasAttachmentLoader(s)),
					  ((n = new spine.SkeletonJson(r)).scale = i),
					  (r = cc.loader.getRes(o)),
					  (r = n.readSkeletonData(r)),
					  s.dispose(n),
					  !0)
					: ((r = t), e);
			this.setSkeletonData(r, e), this.init();
		},
		getBoundingBox: function () {
			for (
				var t = cc.FLT_MAX,
					e = cc.FLT_MAX,
					i = cc.FLT_MIN,
					n = cc.FLT_MIN,
					r = this.getScaleX(),
					o = this.getScaleY(),
					s = [],
					c = this._skeleton.slots,
					a = sp.VERTEX_INDEX,
					l = 0,
					h = c.length;
				l < h;
				++l
			) {
				var u,
					_ = c[l];
				_.attachment &&
					_.attachment.type == sp.ATTACHMENT_TYPE.REGION &&
					((u = _.attachment),
					this._computeRegionAttachmentWorldVertices(
						u,
						_.bone.skeleton.x,
						_.bone.skeleton.y,
						_.bone,
						s
					),
					(t = Math.min(
						t,
						s[a.X1] * r,
						s[a.X4] * r,
						s[a.X2] * r,
						s[a.X3] * r
					)),
					(e = Math.min(
						e,
						s[a.Y1] * o,
						s[a.Y4] * o,
						s[a.Y2] * o,
						s[a.Y3] * o
					)),
					(i = Math.max(
						i,
						s[a.X1] * r,
						s[a.X4] * r,
						s[a.X2] * r,
						s[a.X3] * r
					)),
					(n = Math.max(
						n,
						s[a.Y1] * o,
						s[a.Y4] * o,
						s[a.Y2] * o,
						s[a.Y3] * o
					)));
			}
			var d = this.getPosition();
			return cc.rect(d.x + t, d.y + e, i - t, n - e);
		},
		_computeRegionAttachmentWorldVertices: function (t, e, i, n, r) {
			var o = t.offset,
				t = sp.VERTEX_INDEX;
			(e += n.worldX),
				(i += n.worldY),
				(r[t.X1] = o[t.X1] * n.m00 + o[t.Y1] * n.m01 + e),
				(r[t.Y1] = o[t.X1] * n.m10 + o[t.Y1] * n.m11 + i),
				(r[t.X2] = o[t.X2] * n.m00 + o[t.Y2] * n.m01 + e),
				(r[t.Y2] = o[t.X2] * n.m10 + o[t.Y2] * n.m11 + i),
				(r[t.X3] = o[t.X3] * n.m00 + o[t.Y3] * n.m01 + e),
				(r[t.Y3] = o[t.X3] * n.m10 + o[t.Y3] * n.m11 + i),
				(r[t.X4] = o[t.X4] * n.m00 + o[t.Y4] * n.m01 + e),
				(r[t.Y4] = o[t.X4] * n.m10 + o[t.Y4] * n.m11 + i);
		},
		updateWorldTransform: function () {
			this._skeleton.updateWorldTransform();
		},
		setToSetupPose: function () {
			this._skeleton.setToSetupPose();
		},
		setBonesToSetupPose: function () {
			this._skeleton.setBonesToSetupPose();
		},
		setSlotsToSetupPose: function () {
			this._skeleton.setSlotsToSetupPose();
		},
		findBone: function (t) {
			return this._skeleton.findBone(t);
		},
		findSlot: function (t) {
			return this._skeleton.findSlot(t);
		},
		setSkin: function (t) {
			return this._skeleton.setSkinByName(t);
		},
		getAttachment: function (t, e) {
			return this._skeleton.getAttachmentBySlotName(t, e);
		},
		setAttachment: function (t, e) {
			this._skeleton.setAttachment(t, e);
		},
		setPremultipliedAlpha: function (t) {
			this._premultipliedAlpha = t;
		},
		isPremultipliedAlpha: function () {
			return this._premultipliedAlpha;
		},
		setSkeletonData: function (t, e) {
			null != t.width &&
				null != t.height &&
				this.setContentSize(
					t.width / cc.director.getContentScaleFactor(),
					t.height / cc.director.getContentScaleFactor()
				),
				(this._skeleton = new spine.Skeleton(t)),
				this._skeleton.updateWorldTransform(),
				(this._rootBone = this._skeleton.getRootBone()),
				(this._ownsSkeletonData = e),
				this._renderCmd._createChildFormSkeletonData();
		},
		getTextureAtlas: function (t) {
			return t.rendererObject.page.rendererObject;
		},
		getBlendFunc: function () {
			return this._blendFunc;
		},
		setBlendFunc: function (t, e) {
			var i = this._blendFunc;
			void 0 === e
				? ((i.src = t.src), (i.dst = t.dst))
				: ((i.src = t), (i.dst = e));
		},
		update: function (t) {
			this._skeleton.update(t);
		},
	})),
	(sp.Skeleton.create = function (t, e, i) {
		return new sp.Skeleton(t, e, i);
	});
var spine = {
	radDeg: 180 / Math.PI,
	degRad: Math.PI / 180,
	temp: [],
	Float32Array: 'undefined' == typeof Float32Array ? Array : Float32Array,
	Uint16Array: 'undefined' == typeof Uint16Array ? Array : Uint16Array,
	BoneData: function (t, e) {
		(this.length = this.x = this.y = this.rotation = 0),
			(this.scaleX = this.scaleY = 1),
			(this.name = t),
			(this.parent = e);
	},
};
(spine.BoneData.prototype = {
	length: 0,
	x: 0,
	y: 0,
	rotation: 0,
	scaleX: 1,
	scaleY: 1,
	inheritScale: !0,
	inheritRotation: !0,
	flipX: !1,
	flipY: !1,
}),
	(spine.BlendMode = { normal: 0, additive: 1, multiply: 2, screen: 3 }),
	(spine.SlotData = function (t, e) {
		(this.r = this.g = this.b = this.a = 1),
			(this.blendMode = spine.BlendMode.normal),
			(this.name = t),
			(this.boneData = e);
	}),
	(spine.SlotData.prototype = {
		r: 1,
		g: 1,
		b: 1,
		a: 1,
		attachmentName: null,
		blendMode: spine.BlendMode.normal,
	}),
	(spine.IkConstraintData = function (t) {
		(this.bendDirection = this.mix = 1), (this.name = t), (this.bones = []);
	}),
	(spine.IkConstraintData.prototype = {
		target: null,
		bendDirection: 1,
		mix: 1,
	}),
	(spine.Bone = function (t, e, i) {
		(this.x = this.y = this.rotation = this.rotationIK = 0),
			(this.scaleX = this.scaleY = 1),
			(this.flipX = this.flipY = !1),
			(this.m00 = this.m01 = this.worldX = 0),
			(this.m10 = this.m11 = this.worldY = 0),
			(this.worldRotation = 0),
			(this.worldScaleX = this.worldScaleY = 1),
			(this.worldFlipX = this.worldFlipY = !1),
			(this.data = t),
			(this.skeleton = e),
			(this.parent = i),
			this.setToSetupPose();
	}),
	(spine.Bone.yDown = !1),
	(spine.Bone.prototype = {
		x: 0,
		y: 0,
		rotation: 0,
		rotationIK: 0,
		scaleX: 1,
		scaleY: 1,
		flipX: !1,
		flipY: !1,
		m00: 0,
		m01: 0,
		worldX: 0,
		m10: 0,
		m11: 0,
		worldY: 0,
		worldRotation: 0,
		worldScaleX: 1,
		worldScaleY: 1,
		worldFlipX: !1,
		worldFlipY: !1,
		updateWorldTransform: function () {
			var t = this.parent;
			t
				? ((this.worldX = this.x * t.m00 + this.y * t.m01 + t.worldX),
				  (this.worldY = this.x * t.m10 + this.y * t.m11 + t.worldY),
				  this.data.inheritScale
						? ((this.worldScaleX = t.worldScaleX * this.scaleX),
						  (this.worldScaleY = t.worldScaleY * this.scaleY))
						: ((this.worldScaleX = this.scaleX),
						  (this.worldScaleY = this.scaleY)),
				  (this.worldRotation = this.data.inheritRotation
						? t.worldRotation + this.rotationIK
						: this.rotationIK),
				  (this.worldFlipX = t.worldFlipX != this.flipX),
				  (this.worldFlipY = t.worldFlipY != this.flipY))
				: ((e = this.skeleton.flipX),
				  (i = this.skeleton.flipY),
				  (this.worldX = e ? -this.x : this.x),
				  (this.worldY = i != spine.Bone.yDown ? -this.y : this.y),
				  (this.worldScaleX = this.scaleX),
				  (this.worldScaleY = this.scaleY),
				  (this.worldRotation = this.rotationIK),
				  (this.worldFlipX = e != this.flipX),
				  (this.worldFlipY = i != this.flipY));
			var e = this.worldRotation * spine.degRad,
				i = Math.cos(e),
				e = Math.sin(e);
			this.worldFlipX
				? ((this.m00 = -i * this.worldScaleX),
				  (this.m01 = e * this.worldScaleY))
				: ((this.m00 = i * this.worldScaleX),
				  (this.m01 = -e * this.worldScaleY)),
				this.worldFlipY != spine.Bone.yDown
					? ((this.m10 = -e * this.worldScaleX),
					  (this.m11 = -i * this.worldScaleY))
					: ((this.m10 = e * this.worldScaleX),
					  (this.m11 = i * this.worldScaleY));
		},
		setToSetupPose: function () {
			var t = this.data;
			(this.x = t.x),
				(this.y = t.y),
				(this.rotation = t.rotation),
				(this.rotationIK = this.rotation),
				(this.scaleX = t.scaleX),
				(this.scaleY = t.scaleY),
				(this.flipX = t.flipX),
				(this.flipY = t.flipY);
		},
		worldToLocal: function (t) {
			var e = t[0] - this.worldX,
				i = t[1] - this.worldY,
				n = this.m00,
				r = this.m10,
				o = this.m01,
				s = this.m11;
			this.worldFlipX != (this.worldFlipY != spine.Bone.yDown) &&
				((n = -n), (s = -s));
			var c = 1 / (n * s - o * r);
			(t[0] = e * n * c - i * o * c), (t[1] = i * s * c - e * r * c);
		},
		localToWorld: function (t) {
			var e = t[0],
				i = t[1];
			(t[0] = e * this.m00 + i * this.m01 + this.worldX),
				(t[1] = e * this.m10 + i * this.m11 + this.worldY);
		},
	}),
	(spine.Slot = function (t, e) {
		(this.r = this.g = this.b = this.a = 1),
			(this._attachmentTime = 0),
			(this.data = t),
			(this.bone = e),
			this.setToSetupPose();
	}),
	(spine.Slot.prototype = {
		r: 1,
		g: 1,
		b: 1,
		a: 1,
		_attachmentTime: 0,
		attachment: null,
		attachmentVertices: [],
		setAttachment: function (t) {
			(this.attachment = t),
				(this._attachmentTime = this.bone.skeleton.time),
				(this.attachmentVertices.length = 0);
		},
		setAttachmentTime: function (t) {
			this._attachmentTime = this.bone.skeleton.time - t;
		},
		getAttachmentTime: function () {
			return this.bone.skeleton.time - this._attachmentTime;
		},
		setToSetupPose: function () {
			var t = this.data;
			(this.r = t.r), (this.g = t.g), (this.b = t.b), (this.a = t.a);
			for (
				var e = this.bone.skeleton.data.slots, i = 0, n = e.length;
				i < n;
				i++
			)
				if (e[i] == t) {
					this.setAttachment(
						t.attachmentName
							? this.bone.skeleton.getAttachmentBySlotIndex(
									i,
									t.attachmentName
							  )
							: null
					);
					break;
				}
		},
	}),
	(spine.IkConstraint = function (t, e) {
		(this.data = t),
			(this.mix = t.mix),
			(this.bendDirection = t.bendDirection),
			(this.bones = []);
		for (var i = 0, n = t.bones.length; i < n; i++)
			this.bones.push(e.findBone(t.bones[i].name));
		this.target = e.findBone(t.target.name);
	}),
	(spine.IkConstraint.prototype = {
		apply: function () {
			var t = this.target,
				e = this.bones;
			switch (e.length) {
				case 1:
					spine.IkConstraint.apply1(
						e[0],
						t.worldX,
						t.worldY,
						this.mix
					);
					break;
				case 2:
					spine.IkConstraint.apply2(
						e[0],
						e[1],
						t.worldX,
						t.worldY,
						this.bendDirection,
						this.mix
					);
			}
		},
	}),
	(spine.IkConstraint.apply1 = function (t, e, i, n) {
		var r = t.data.inheritRotation && t.parent ? t.parent.worldRotation : 0,
			o = t.rotation,
			e = Math.atan2(i - t.worldY, e - t.worldX) * spine.radDeg;
		t.worldFlipX != (t.worldFlipY != spine.Bone.yDown) && (e = -e),
			(e -= r),
			(t.rotationIK = o + (e - o) * n);
	}),
	(spine.IkConstraint.apply2 = function (t, e, i, n, r, o) {
		var s = e.rotation,
			c = t.rotation;
		if (!o) return (e.rotationIK = s), void (t.rotationIK = c);
		var a = spine.temp,
			l = t.parent;
		l
			? ((a[0] = i),
			  (a[1] = n),
			  l.worldToLocal(a),
			  (i = (a[0] - t.x) * l.worldScaleX),
			  (n = (a[1] - t.y) * l.worldScaleY))
			: ((i -= t.x), (n -= t.y)),
			(u =
				e.parent == t
					? ((h = e.x), e.y)
					: ((a[0] = e.x),
					  (a[1] = e.y),
					  e.parent.localToWorld(a),
					  t.worldToLocal(a),
					  (h = a[0]),
					  a[1]));
		var l = h * t.worldScaleX,
			a = u * t.worldScaleY,
			h = Math.atan2(a, l),
			u = Math.sqrt(l * l + a * a),
			l = e.data.length * e.worldScaleX,
			a = 2 * u * l;
		a < 1e-4
			? (e.rotationIK = s + (Math.atan2(n, i) * spine.radDeg - c - s) * o)
			: ((a = (i * i + n * n - u * u - l * l) / a) < -1
					? (a = -1)
					: 1 < a && (a = 1),
			  (r = Math.acos(a) * r),
			  (a = u + l * a),
			  (l *= Math.sin(r)),
			  180 <
			  (l =
					(Math.atan2(n * a - i * l, i * a + n * l) - h) *
						spine.radDeg -
					c)
					? (l -= 360)
					: l < -180 && (l += 360),
			  (t.rotationIK = c + l * o),
			  180 < (l = (r + h) * spine.radDeg - s)
					? (l -= 360)
					: l < -180 && (l += 360),
			  (e.rotationIK =
					s + (l + t.worldRotation - e.parent.worldRotation) * o));
	}),
	(spine.Skin = function (t) {
		(this.name = t), (this.attachments = {});
	}),
	(spine.Skin.prototype = {
		addAttachment: function (t, e, i) {
			this.attachments[t + ':' + e] = i;
		},
		getAttachment: function (t, e) {
			return this.attachments[t + ':' + e];
		},
		_attachAll: function (t, e) {
			for (var i in e.attachments) {
				var n = i.indexOf(':'),
					r = parseInt(i.substring(0, n)),
					o = i.substring(n + 1),
					n = t.slots[r];
				!n.attachment ||
					n.attachment.name != o ||
					((o = this.getAttachment(r, o)) && n.setAttachment(o));
			}
		},
	}),
	(spine.Animation = function (t, e, i) {
		(this.name = t), (this.timelines = e), (this.duration = i);
	}),
	(spine.Animation.prototype = {
		apply: function (t, e, i, n, r) {
			n &&
				0 != this.duration &&
				((i %= this.duration), (e %= this.duration));
			for (var o = this.timelines, s = 0, c = o.length; s < c; s++)
				o[s].apply(t, e, i, r, 1);
		},
		mix: function (t, e, i, n, r, o) {
			n &&
				0 != this.duration &&
				((i %= this.duration), (e %= this.duration));
			for (var s = this.timelines, c = 0, a = s.length; c < a; c++)
				s[c].apply(t, e, i, r, o);
		},
	}),
	(spine.Animation.binarySearch = function (t, e, i) {
		var n = 0,
			r = Math.floor(t.length / i) - 2;
		if (!r) return i;
		for (var o = r >>> 1; ; ) {
			if ((t[(o + 1) * i] <= e ? (n = o + 1) : (r = o), n == r))
				return (n + 1) * i;
			o = (n + r) >>> 1;
		}
	}),
	(spine.Animation.binarySearch1 = function (t, e) {
		var i = 0,
			n = t.length - 2;
		if (!n) return 1;
		for (var r = n >>> 1; ; ) {
			if ((t[r + 1] <= e ? (i = r + 1) : (n = r), i == n)) return i + 1;
			r = (i + n) >>> 1;
		}
	}),
	(spine.Animation.linearSearch = function (t, e, i) {
		for (var n = 0, r = t.length - i; n <= r; n += i)
			if (t[n] > e) return n;
		return -1;
	}),
	(spine.Curves = function (t) {
		this.curves = [];
	}),
	(spine.Curves.prototype = {
		setLinear: function (t) {
			this.curves[19 * t] = 0;
		},
		setStepped: function (t) {
			this.curves[19 * t] = 1;
		},
		setCurve: function (t, e, i, n, r) {
			var o = 0.1 * 0.1 * 0.1,
				s = 6 * o,
				c = 2 * -e + n,
				a = 2 * -i + r,
				n = 3 * (e - n) + 1,
				r = 3 * (i - r) + 1,
				l = e * (3 * 0.1) + c * (0.1 * 0.1 * 3) + n * o,
				h = i * (3 * 0.1) + a * (0.1 * 0.1 * 3) + r * o,
				u = c * (0.1 * 0.1 * 6) + n * s,
				_ = a * (0.1 * 0.1 * 6) + r * s,
				d = n * s,
				p = r * s,
				f = 19 * t,
				m = this.curves;
			m[f++] = 2;
			for (var g = l, y = h, T = f + 19 - 1; f < T; f += 2)
				(m[f] = g),
					(m[f + 1] = y),
					(l += u),
					(h += _),
					(u += d),
					(_ += p),
					(g += l),
					(y += h);
		},
		getCurvePercent: function (t, e) {
			e = e < 0 ? 0 : 1 < e ? 1 : e;
			var i = this.curves,
				n = 19 * t,
				t = i[n];
			if (0 === t) return e;
			if (1 == t) return 0;
			for (var r = 0, o = ++n, s = n + 19 - 1; n < s; n += 2)
				if (e <= (r = i[n])) {
					var c,
						a = n == o ? (c = 0) : ((c = i[n - 2]), i[n - 1]);
					return a + ((i[n + 1] - a) * (e - c)) / (r - c);
				}
			t = i[n - 1];
			return t + ((1 - t) * (e - r)) / (1 - r);
		},
	}),
	(spine.RotateTimeline = function (t) {
		(this.boneIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = 2 * t);
	}),
	(spine.RotateTimeline.prototype = {
		boneIndex: 0,
		getFrameCount: function () {
			return this.frames.length / 2;
		},
		setFrame: function (t, e, i) {
			(t *= 2), (this.frames[t] = e), (this.frames[t + 1] = i);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			if (!(i < o[0])) {
				var s = t.bones[this.boneIndex];
				if (i >= o[o.length - 2]) {
					for (
						var c = s.data.rotation + o[o.length - 1] - s.rotation;
						180 < c;

					)
						c -= 360;
					for (; c < -180; ) c += 360;
					s.rotation += c * r;
				} else {
					for (
						var a = spine.Animation.binarySearch(o, i, 2),
							l = o[a - 1],
							t = o[a],
							t = 1 - (i - t) / (o[a - 2] - t),
							t = this.curves.getCurvePercent(a / 2 - 1, t),
							c = o[a + 1] - l;
						180 < c;

					)
						c -= 360;
					for (; c < -180; ) c += 360;
					for (
						c = s.data.rotation + (l + c * t) - s.rotation;
						180 < c;

					)
						c -= 360;
					for (; c < -180; ) c += 360;
					s.rotation += c * r;
				}
			}
		},
	}),
	(spine.TranslateTimeline = function (t) {
		(this.boneIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = 3 * t);
	}),
	(spine.TranslateTimeline.prototype = {
		boneIndex: 0,
		getFrameCount: function () {
			return this.frames.length / 3;
		},
		setFrame: function (t, e, i, n) {
			(t *= 3),
				(this.frames[t] = e),
				(this.frames[t + 1] = i),
				(this.frames[t + 2] = n);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			if (!(i < o[0])) {
				var s = t.bones[this.boneIndex];
				if (i >= o[o.length - 3])
					return (
						(s.x += (s.data.x + o[o.length - 2] - s.x) * r),
						void (s.y += (s.data.y + o[o.length - 1] - s.y) * r)
					);
				var c = spine.Animation.binarySearch(o, i, 3),
					a = o[c - 2],
					l = o[c - 1],
					t = o[c],
					t = 1 - (i - t) / (o[c + -3] - t),
					t = this.curves.getCurvePercent(c / 3 - 1, t);
				(s.x += (s.data.x + a + (o[c + 1] - a) * t - s.x) * r),
					(s.y += (s.data.y + l + (o[c + 2] - l) * t - s.y) * r);
			}
		},
	}),
	(spine.ScaleTimeline = function (t) {
		(this.boneIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = 3 * t);
	}),
	(spine.ScaleTimeline.prototype = {
		boneIndex: 0,
		getFrameCount: function () {
			return this.frames.length / 3;
		},
		setFrame: function (t, e, i, n) {
			(t *= 3),
				(this.frames[t] = e),
				(this.frames[t + 1] = i),
				(this.frames[t + 2] = n);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			if (!(i < o[0])) {
				var s = t.bones[this.boneIndex];
				if (i >= o[o.length - 3])
					return (
						(s.scaleX +=
							(s.data.scaleX * o[o.length - 2] - s.scaleX) * r),
						void (s.scaleY +=
							(s.data.scaleY * o[o.length - 1] - s.scaleY) * r)
					);
				var c = spine.Animation.binarySearch(o, i, 3),
					a = o[c - 2],
					l = o[c - 1],
					t = o[c],
					t = 1 - (i - t) / (o[c + -3] - t),
					t = this.curves.getCurvePercent(c / 3 - 1, t);
				(s.scaleX +=
					(s.data.scaleX * (a + (o[c + 1] - a) * t) - s.scaleX) * r),
					(s.scaleY +=
						(s.data.scaleY * (l + (o[c + 2] - l) * t) - s.scaleY) *
						r);
			}
		},
	}),
	(spine.ColorTimeline = function (t) {
		(this.boneIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = 5 * t);
	}),
	(spine.ColorTimeline.prototype = {
		slotIndex: 0,
		getFrameCount: function () {
			return this.frames.length / 5;
		},
		setFrame: function (t, e, i, n, r, o) {
			(t *= 5),
				(this.frames[t] = e),
				(this.frames[t + 1] = i),
				(this.frames[t + 2] = n),
				(this.frames[t + 3] = r),
				(this.frames[t + 4] = o);
		},
		apply: function (t, e, i, n, r) {
			var o,
				s,
				c,
				a,
				l,
				h,
				u,
				_,
				d,
				p = this.frames;
			i < p[0] ||
				((d =
					i >= p[p.length - 5]
						? ((o = p[(_ = p.length - 1) - 3]),
						  (s = p[_ - 2]),
						  (c = p[_ - 1]),
						  p[_])
						: ((l =
								p[
									(a = spine.Animation.binarySearch(
										p,
										i,
										5
									)) - 4
								]),
						  (h = p[a - 3]),
						  (u = p[a - 2]),
						  (_ = p[a - 1]),
						  (d = 1 - (i - (d = p[a])) / (p[a - 5] - d)),
						  (d = this.curves.getCurvePercent(a / 5 - 1, d)),
						  (o = l + (p[a + 1] - l) * d),
						  (s = h + (p[a + 2] - h) * d),
						  (c = u + (p[a + 3] - u) * d),
						  _ + (p[a + 4] - _) * d)),
				(t = t.slots[this.slotIndex]),
				r < 1
					? ((t.r += (o - t.r) * r),
					  (t.g += (s - t.g) * r),
					  (t.b += (c - t.b) * r),
					  (t.a += (d - t.a) * r))
					: ((t.r = o), (t.g = s), (t.b = c), (t.a = d)));
		},
	}),
	(spine.AttachmentTimeline = function (t) {
		(this.slotIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = t),
			(this.attachmentNames = []),
			(this.attachmentNames.length = t);
	}),
	(spine.AttachmentTimeline.prototype = {
		slotIndex: 0,
		getFrameCount: function () {
			return this.frames.length;
		},
		setFrame: function (t, e, i) {
			(this.frames[t] = e), (this.attachmentNames[t] = i);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			i < o[0]
				? i < e && this.apply(t, e, Number.MAX_VALUE, null, 0)
				: (i < e && (e = -1),
				  o[
						(i =
							i >= o[o.length - 1]
								? o.length - 1
								: spine.Animation.binarySearch1(o, i) - 1)
				  ] < e ||
						((i = this.attachmentNames[i]),
						t.slots[this.slotIndex].setAttachment(
							i
								? t.getAttachmentBySlotIndex(this.slotIndex, i)
								: null
						)));
		},
	}),
	(spine.EventTimeline = function (t) {
		(this.frames = []),
			(this.frames.length = t),
			(this.events = []),
			(this.events.length = t);
	}),
	(spine.EventTimeline.prototype = {
		getFrameCount: function () {
			return this.frames.length;
		},
		setFrame: function (t, e, i) {
			(this.frames[t] = e), (this.events[t] = i);
		},
		apply: function (t, e, i, n, r) {
			if (n) {
				var o,
					s = this.frames,
					c = s.length;
				if (i < e) this.apply(t, e, Number.MAX_VALUE, n, r), (e = -1);
				else if (e >= s[c - 1]) return;
				if (!(i < s[0])) {
					if (e < s[0]) o = 0;
					else
						for (
							var a =
								s[(o = spine.Animation.binarySearch1(s, e))];
							0 < o && s[o - 1] == a;

						)
							o--;
					for (var l = this.events; o < c && i >= s[o]; o++)
						n.push(l[o]);
				}
			}
		},
	}),
	(spine.DrawOrderTimeline = function (t) {
		(this.frames = []),
			(this.frames.length = t),
			(this.drawOrders = []),
			(this.drawOrders.length = t);
	}),
	(spine.DrawOrderTimeline.prototype = {
		getFrameCount: function () {
			return this.frames.length;
		},
		setFrame: function (t, e, i) {
			(this.frames[t] = e), (this.drawOrders[t] = i);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			if (!(i < o[0])) {
				var i =
						i >= o[o.length - 1]
							? o.length - 1
							: spine.Animation.binarySearch1(o, i) - 1,
					s = t.drawOrder,
					c = t.slots,
					a = this.drawOrders[i];
				if (a)
					for (l = 0, h = a.length; l < h; l++) s[l] = t.slots[a[l]];
				else for (var l = 0, h = c.length; l < h; l++) s[l] = c[l];
			}
		},
	}),
	(spine.FfdTimeline = function (t) {
		(this.slotIndex = this.attachment = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = t),
			(this.frameVertices = []),
			(this.frameVertices.length = t);
	}),
	(spine.FfdTimeline.prototype = {
		slotIndex: 0,
		attachment: 0,
		getFrameCount: function () {
			return this.frames.length;
		},
		setFrame: function (t, e, i) {
			(this.frames[t] = e), (this.frameVertices[t] = i);
		},
		apply: function (t, e, i, n, r) {
			var o = t.slots[this.slotIndex];
			if (o.attachment == this.attachment) {
				var s = this.frames;
				if (!(i < s[0])) {
					var c = this.frameVertices,
						a = c[0].length,
						l = o.attachmentVertices;
					if (
						(l.length != a && (r = 1),
						(l.length = a),
						i >= s[s.length - 1])
					) {
						var h = c[s.length - 1];
						if (r < 1)
							for (var u = 0; u < a; u++)
								l[u] += (h[u] - l[u]) * r;
						else for (u = 0; u < a; u++) l[u] = h[u];
					} else {
						var t = spine.Animation.binarySearch1(s, i),
							o = s[t],
							_ = 1 - (i - o) / (s[t - 1] - o),
							_ = this.curves.getCurvePercent(
								t - 1,
								_ < 0 ? 0 : 1 < _ ? 1 : _
							),
							d = c[t - 1],
							p = c[t];
						if (r < 1)
							for (u = 0; u < a; u++) {
								var f = d[u];
								l[u] += (f + (p[u] - f) * _ - l[u]) * r;
							}
						else
							for (u = 0; u < a; u++) {
								f = d[u];
								l[u] = f + (p[u] - f) * _;
							}
					}
				}
			}
		},
	}),
	(spine.IkConstraintTimeline = function (t) {
		(this.ikConstraintIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = 3 * t);
	}),
	(spine.IkConstraintTimeline.prototype = {
		ikConstraintIndex: 0,
		getFrameCount: function () {
			return this.frames.length / 3;
		},
		setFrame: function (t, e, i, n) {
			(t *= 3),
				(this.frames[t] = e),
				(this.frames[t + 1] = i),
				(this.frames[t + 2] = n);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			if (!(i < o[0])) {
				var s = t.ikConstraints[this.ikConstraintIndex];
				if (i >= o[o.length - 3])
					return (
						(s.mix += (o[o.length - 2] - s.mix) * r),
						void (s.bendDirection = o[o.length - 1])
					);
				var c = spine.Animation.binarySearch(o, i, 3),
					a = o[c + -2],
					t = o[c],
					t = 1 - (i - t) / (o[c + -3] - t),
					t = this.curves.getCurvePercent(c / 3 - 1, t),
					t = a + (o[c + 1] - a) * t;
				(s.mix += (t - s.mix) * r), (s.bendDirection = o[c + -1]);
			}
		},
	}),
	(spine.FlipXTimeline = function (t) {
		(this.boneIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = 2 * t);
	}),
	(spine.FlipXTimeline.prototype = {
		boneIndex: 0,
		getFrameCount: function () {
			return this.frames.length / 2;
		},
		setFrame: function (t, e, i) {
			(t *= 2), (this.frames[t] = e), (this.frames[t + 1] = i ? 1 : 0);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			i < o[0]
				? i < e && this.apply(t, e, Number.MAX_VALUE, null, 0)
				: (i < e && (e = -1),
				  o[
						(i =
							(i >= o[o.length - 2]
								? o.length
								: spine.Animation.binarySearch(o, i, 2)) - 2)
				  ] < e || (t.bones[this.boneIndex].flipX = 0 != o[1 + i]));
		},
	}),
	(spine.FlipYTimeline = function (t) {
		(this.boneIndex = 0),
			(this.curves = new spine.Curves(t)),
			(this.frames = []),
			(this.frames.length = 2 * t);
	}),
	(spine.FlipYTimeline.prototype = {
		boneIndex: 0,
		getFrameCount: function () {
			return this.frames.length / 2;
		},
		setFrame: function (t, e, i) {
			(t *= 2), (this.frames[t] = e), (this.frames[t + 1] = i ? 1 : 0);
		},
		apply: function (t, e, i, n, r) {
			var o = this.frames;
			i < o[0]
				? i < e && this.apply(t, e, Number.MAX_VALUE, null, 0)
				: (i < e && (e = -1),
				  o[
						(i =
							(i >= o[o.length - 2]
								? o.length
								: spine.Animation.binarySearch(o, i, 2)) - 2)
				  ] < e || (t.bones[this.boneIndex].flipY = 0 != o[1 + i]));
		},
	}),
	(spine.SkeletonData = function () {
		(this.width = this.height = 0),
			(this.bones = []),
			(this.slots = []),
			(this.skins = []),
			(this.events = []),
			(this.animations = []),
			(this.ikConstraints = []);
	}),
	(spine.SkeletonData.prototype = {
		name: null,
		defaultSkin: null,
		width: 0,
		height: 0,
		version: null,
		hash: null,
		findBone: function (t) {
			for (var e = this.bones, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return e[i];
			return null;
		},
		findBoneIndex: function (t) {
			for (var e = this.bones, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return i;
			return -1;
		},
		findSlot: function (t) {
			for (var e = this.slots, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return slot[i];
			return null;
		},
		findSlotIndex: function (t) {
			for (var e = this.slots, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return i;
			return -1;
		},
		findSkin: function (t) {
			for (var e = this.skins, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return e[i];
			return null;
		},
		findEvent: function (t) {
			for (var e = this.events, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return e[i];
			return null;
		},
		findAnimation: function (t) {
			for (var e = this.animations, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return e[i];
			return null;
		},
		findIkConstraint: function (t) {
			for (var e = this.ikConstraints, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return e[i];
			return null;
		},
	}),
	(spine.Skeleton = function (t) {
		(this.x = this.y = 0),
			(this.r = this.g = this.b = this.a = 1),
			(this.time = 0),
			(this.flipX = this.flipY = !1),
			(this.data = t),
			(this.bones = []);
		for (var e = 0, i = t.bones.length; e < i; e++) {
			var n = t.bones[e],
				r = n.parent ? this.bones[t.bones.indexOf(n.parent)] : null;
			this.bones.push(new spine.Bone(n, this, r));
		}
		(this.slots = []), (this.drawOrder = []);
		for (e = 0, i = t.slots.length; e < i; e++) {
			var o = t.slots[e],
				s = this.bones[t.bones.indexOf(o.boneData)],
				s = new spine.Slot(o, s);
			this.slots.push(s), this.drawOrder.push(s);
		}
		this.ikConstraints = [];
		for (e = 0, i = t.ikConstraints.length; e < i; e++)
			this.ikConstraints.push(
				new spine.IkConstraint(t.ikConstraints[e], this)
			);
		(this.boneCache = []), this.updateCache();
	}),
	(spine.Skeleton.prototype = {
		x: 0,
		y: 0,
		skin: null,
		r: 1,
		g: 1,
		b: 1,
		a: 1,
		time: 0,
		flipX: !1,
		flipY: !1,
		updateCache: function () {
			var t = this.ikConstraints,
				e = t.length,
				i = e + 1,
				n = this.boneCache;
			n.length > i && (n.length = i);
			for (var r = 0, o = n.length; r < o; r++) n[r].length = 0;
			for (; n.length < i; ) n[n.length] = [];
			var s = n[0],
				c = this.bones;
			t: for (r = 0, o = c.length; r < o; r++) {
				var a = c[r],
					l = a;
				do {
					for (var h = 0; h < e; h++)
						for (
							var u = t[h],
								_ = u.bones[0],
								d = u.bones[u.bones.length - 1];
							;

						) {
							if (l == d) {
								n[h].push(a), n[h + 1].push(a);
								continue t;
							}
							if (d == _) break;
							d = d.parent;
						}
				} while ((l = l.parent));
				s[s.length] = a;
			}
		},
		updateWorldTransform: function () {
			for (var t = this.bones, e = 0, i = t.length; e < i; e++) {
				var n = t[e];
				n.rotationIK = n.rotation;
			}
			for (var e = 0, r = this.boneCache.length - 1; ; ) {
				for (var o = this.boneCache[e], s = 0, c = o.length; s < c; s++)
					o[s].updateWorldTransform();
				if (e == r) break;
				this.ikConstraints[e].apply(), e++;
			}
		},
		setToSetupPose: function () {
			this.setBonesToSetupPose(), this.setSlotsToSetupPose();
		},
		setBonesToSetupPose: function () {
			for (var t = this.bones, e = 0, i = t.length; e < i; e++)
				t[e].setToSetupPose();
			for (var n = this.ikConstraints, e = 0, i = n.length; e < i; e++) {
				var r = n[e];
				(r.bendDirection = r.data.bendDirection), (r.mix = r.data.mix);
			}
		},
		setSlotsToSetupPose: function () {
			for (
				var t = this.slots, e = this.drawOrder, i = 0, n = t.length;
				i < n;
				i++
			)
				(e[i] = t[i]), t[i].setToSetupPose(i);
		},
		getRootBone: function () {
			return this.bones.length ? this.bones[0] : null;
		},
		findBone: function (t) {
			for (var e = this.bones, i = 0, n = e.length; i < n; i++)
				if (e[i].data.name == t) return e[i];
			return null;
		},
		findBoneIndex: function (t) {
			for (var e = this.bones, i = 0, n = e.length; i < n; i++)
				if (e[i].data.name == t) return i;
			return -1;
		},
		findSlot: function (t) {
			for (var e = this.slots, i = 0, n = e.length; i < n; i++)
				if (e[i].data.name == t) return e[i];
			return null;
		},
		findSlotIndex: function (t) {
			for (var e = this.slots, i = 0, n = e.length; i < n; i++)
				if (e[i].data.name == t) return i;
			return -1;
		},
		setSkinByName: function (t) {
			var e = this.data.findSkin(t);
			if (!e) throw new Error('Skin not found: ' + t);
			this.setSkin(e);
		},
		setSkin: function (t) {
			if (t)
				if (this.skin) t._attachAll(this, this.skin);
				else
					for (var e = this.slots, i = 0, n = e.length; i < n; i++) {
						var r = e[i],
							o = r.data.attachmentName;
						!o ||
							((o = t.getAttachment(i, o)) && r.setAttachment(o));
					}
			this.skin = t;
		},
		getAttachmentBySlotName: function (t, e) {
			return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t), e);
		},
		getAttachmentBySlotIndex: function (t, e) {
			if (this.skin) {
				var i = this.skin.getAttachment(t, e);
				if (i) return i;
			}
			return this.data.defaultSkin
				? this.data.defaultSkin.getAttachment(t, e)
				: null;
		},
		setAttachment: function (t, e) {
			for (var i = this.slots, n = 0, r = i.length; n < r; n++) {
				var o = i[n];
				if (o.data.name == t) {
					var s = null;
					if (e && !(s = this.getAttachmentBySlotIndex(n, e)))
						throw new Error(
							'Attachment not found: ' + e + ', for slot: ' + t
						);
					return void o.setAttachment(s);
				}
			}
			throw new Error('Slot not found: ' + t);
		},
		findIkConstraint: function (t) {
			for (var e = this.ikConstraints, i = 0, n = e.length; i < n; i++)
				if (e[i].data.name == t) return e[i];
			return null;
		},
		update: function (t) {
			this.time += t;
		},
	}),
	(spine.EventData = function (t) {
		(this.intValue = this.floatValue = 0), (this.name = t);
	}),
	(spine.EventData.prototype = {
		intValue: 0,
		floatValue: 0,
		stringValue: null,
	}),
	(spine.Event = function (t) {
		(this.intValue = this.floatValue = 0), (this.data = t);
	}),
	(spine.Event.prototype = { intValue: 0, floatValue: 0, stringValue: null }),
	(spine.AttachmentType = {
		region: 0,
		boundingbox: 1,
		mesh: 2,
		skinnedmesh: 3,
	}),
	(spine.RegionAttachment = function (t) {
		(this.type = spine.AttachmentType.region),
			(this.x = this.y = this.rotation = 0),
			(this.scaleX = this.scaleY = 1),
			(this.width = this.height = 0),
			(this.r = this.g = this.b = this.a = 1),
			(this.regionOffsetX =
				this.regionOffsetY =
				this.regionWidth =
				this.regionHeight =
				this.regionOriginalWidth =
				this.regionOriginalHeight =
					0),
			(this.name = t),
			(this.offset = []),
			(this.offset.length = 8),
			(this.uvs = []),
			(this.uvs.length = 8);
	}),
	(spine.RegionAttachment.prototype = {
		x: 0,
		y: 0,
		rotation: 0,
		scaleX: 1,
		scaleY: 1,
		width: 0,
		height: 0,
		r: 1,
		g: 1,
		b: 1,
		a: 1,
		path: null,
		rendererObject: null,
		regionOffsetX: 0,
		regionOffsetY: 0,
		regionWidth: 0,
		regionHeight: 0,
		regionOriginalWidth: 0,
		regionOriginalHeight: 0,
		setUVs: function (t, e, i, n, r) {
			var o = this.uvs;
			r
				? ((o[2] = t),
				  (o[3] = n),
				  (o[4] = t),
				  (o[5] = e),
				  (o[6] = i),
				  (o[7] = e),
				  (o[0] = i),
				  (o[1] = n))
				: ((o[0] = t),
				  (o[1] = n),
				  (o[2] = t),
				  (o[3] = e),
				  (o[4] = i),
				  (o[5] = e),
				  (o[6] = i),
				  (o[7] = n));
		},
		updateOffset: function () {
			var t = (this.width / this.regionOriginalWidth) * this.scaleX,
				e = (this.height / this.regionOriginalHeight) * this.scaleY,
				i = (-this.width / 2) * this.scaleX + this.regionOffsetX * t,
				n = (-this.height / 2) * this.scaleY + this.regionOffsetY * e,
				r = i + this.regionWidth * t,
				o = n + this.regionHeight * e,
				s = this.rotation * spine.degRad,
				c = Math.cos(s),
				a = Math.sin(s),
				t = i * c + this.x,
				e = i * a,
				s = n * c + this.y,
				i = n * a,
				n = r * c + this.x,
				r = r * a,
				c = o * c + this.y,
				o = o * a,
				a = this.offset;
			(a[0] = t - i),
				(a[1] = s + e),
				(a[2] = t - o),
				(a[3] = c + e),
				(a[4] = n - o),
				(a[5] = c + r),
				(a[6] = n - i),
				(a[7] = s + r);
		},
		computeVertices: function (t, e, i, n) {
			(t += i.worldX), (e += i.worldY);
			var r = i.m00,
				o = i.m01,
				s = i.m10,
				c = i.m11,
				i = this.offset;
			(n[0] = i[0] * r + i[1] * o + t),
				(n[1] = i[0] * s + i[1] * c + e),
				(n[2] = i[2] * r + i[3] * o + t),
				(n[3] = i[2] * s + i[3] * c + e),
				(n[4] = i[4] * r + i[5] * o + t),
				(n[5] = i[4] * s + i[5] * c + e),
				(n[6] = i[6] * r + i[7] * o + t),
				(n[7] = i[6] * s + i[7] * c + e);
		},
	}),
	(spine.MeshAttachment = function (t) {
		(this.type = spine.AttachmentType.mesh),
			(this.hullLength = 0),
			(this.r = this.g = this.b = this.a = 1),
			(this.regionU = this.regionV = this.regionV2 = 0),
			(this.regionRotate = !1),
			(this.regionOffsetX =
				this.regionOffsetY =
				this.regionWidth =
				this.regionHeight =
				this.regionOriginalWidth =
				this.regionOriginalHeight =
					0),
			(this.width = this.height = 0),
			(this.name = t);
	}),
	(spine.MeshAttachment.prototype = {
		vertices: null,
		uvs: null,
		regionUVs: null,
		triangles: null,
		hullLength: 0,
		r: 1,
		g: 1,
		b: 1,
		a: 1,
		path: null,
		rendererObject: null,
		regionU: 0,
		regionV: 0,
		regionU2: 0,
		regionV2: 0,
		regionRotate: !1,
		regionOffsetX: 0,
		regionOffsetY: 0,
		regionWidth: 0,
		regionHeight: 0,
		regionOriginalWidth: 0,
		regionOriginalHeight: 0,
		edges: null,
		width: 0,
		height: 0,
		updateUVs: function () {
			var t = this.regionU2 - this.regionU,
				e = this.regionV2 - this.regionV,
				i = this.regionUVs.length;
			if (
				((this.uvs && this.uvs.length == i) ||
					(this.uvs = new spine.Float32Array(i)),
				this.regionRotate)
			)
				for (var n = 0; n < i; n += 2)
					(this.uvs[n] = this.regionU + this.regionUVs[n + 1] * t),
						(this.uvs[n + 1] =
							this.regionV + e - this.regionUVs[n] * e);
			else
				for (n = 0; n < i; n += 2)
					(this.uvs[n] = this.regionU + this.regionUVs[n] * t),
						(this.uvs[n + 1] =
							this.regionV + this.regionUVs[n + 1] * e);
		},
		computeWorldVertices: function (t, e, i, n) {
			var r = i.bone;
			(t += r.worldX), (e += r.worldY);
			var o = r.m00,
				s = r.m01,
				c = r.m10,
				a = r.m11,
				l = this.vertices,
				h = l.length;
			i.attachmentVertices.length == h && (l = i.attachmentVertices);
			for (var u = 0; u < h; u += 2) {
				var _ = l[u],
					d = l[u + 1];
				(n[u] = _ * o + d * s + t), (n[u + 1] = _ * c + d * a + e);
			}
		},
	}),
	(spine.SkinnedMeshAttachment = function (t) {
		(this.type = spine.AttachmentType.skinnedmesh),
			(this.hullLength = 0),
			(this.r = this.g = this.b = this.a = 1),
			(this.regionU = this.regionV = this.regionU2 = this.regionV2 = 0),
			(this.regionRotate = !1),
			(this.regionOffsetX =
				this.regionOffsetY =
				this.regionWidth =
				this.regionHeight =
				this.regionOriginalWidth =
				this.regionOriginalHeight =
					0),
			(this.width = this.height = 0),
			(this.name = t);
	}),
	(spine.SkinnedMeshAttachment.prototype = {
		bones: null,
		weights: null,
		uvs: null,
		regionUVs: null,
		triangles: null,
		hullLength: 0,
		r: 1,
		g: 1,
		b: 1,
		a: 1,
		path: null,
		rendererObject: null,
		regionU: 0,
		regionV: 0,
		regionU2: 0,
		regionV2: 0,
		regionRotate: !1,
		regionOffsetX: 0,
		regionOffsetY: 0,
		regionWidth: 0,
		regionHeight: 0,
		regionOriginalWidth: 0,
		regionOriginalHeight: 0,
		edges: null,
		width: 0,
		height: 0,
		updateUVs: function (t, e, i, n, r) {
			var o = this.regionU2 - this.regionU,
				s = this.regionV2 - this.regionV,
				c = this.regionUVs.length;
			if (
				((this.uvs && this.uvs.length == c) ||
					(this.uvs = new spine.Float32Array(c)),
				this.regionRotate)
			)
				for (var a = 0; a < c; a += 2)
					(this.uvs[a] = this.regionU + this.regionUVs[a + 1] * o),
						(this.uvs[a + 1] =
							this.regionV + s - this.regionUVs[a] * s);
			else
				for (a = 0; a < c; a += 2)
					(this.uvs[a] = this.regionU + this.regionUVs[a] * o),
						(this.uvs[a + 1] =
							this.regionV + this.regionUVs[a + 1] * s);
		},
		computeWorldVertices: function (t, e, i, n) {
			var r,
				o,
				s,
				c,
				a,
				l,
				h,
				u = i.bone.skeleton.bones,
				_ = this.weights,
				d = this.bones,
				p = 0,
				f = 0,
				m = 0,
				g = 0,
				y = d.length;
			if (i.attachmentVertices.length)
				for (var T = i.attachmentVertices; f < y; p += 2) {
					for (s = o = 0, r = d[f++] + f; f < r; f++, m += 3, g += 2)
						(c = u[d[f]]),
							(a = _[m] + T[g]),
							(l = _[m + 1] + T[g + 1]),
							(h = _[m + 2]),
							(o += (a * c.m00 + l * c.m01 + c.worldX) * h),
							(s += (a * c.m10 + l * c.m11 + c.worldY) * h);
					(n[p] = o + t), (n[p + 1] = s + e);
				}
			else
				for (; f < y; p += 2) {
					for (s = o = 0, r = d[f++] + f; f < r; f++, m += 3)
						(c = u[d[f]]),
							(a = _[m]),
							(l = _[m + 1]),
							(h = _[m + 2]),
							(o += (a * c.m00 + l * c.m01 + c.worldX) * h),
							(s += (a * c.m10 + l * c.m11 + c.worldY) * h);
					(n[p] = o + t), (n[p + 1] = s + e);
				}
		},
	}),
	(spine.BoundingBoxAttachment = function (t) {
		(this.type = spine.AttachmentType.boundingbox),
			(this.name = t),
			(this.vertices = []);
	}),
	(spine.BoundingBoxAttachment.prototype = {
		computeWorldVertices: function (t, e, i, n) {
			(t += i.worldX), (e += i.worldY);
			for (
				var r = i.m00,
					o = i.m01,
					s = i.m10,
					c = i.m11,
					a = this.vertices,
					l = 0,
					h = a.length;
				l < h;
				l += 2
			) {
				var u = a[l],
					_ = a[l + 1];
				(n[l] = u * r + _ * o + t), (n[l + 1] = u * s + _ * c + e);
			}
		},
	}),
	(spine.AnimationStateData = function (t) {
		(this.skeletonData = t),
			(this.animationToMixTime = {}),
			(this.defaultMix = 0);
	}),
	(spine.AnimationStateData.prototype = {
		defaultMix: 0,
		setMixByName: function (t, e, i) {
			var n = this.skeletonData.findAnimation(t);
			if (!n) throw new Error('Animation not found: ' + t);
			t = this.skeletonData.findAnimation(e);
			if (!t) throw new Error('Animation not found: ' + e);
			this.setMix(n, t, i);
		},
		setMix: function (t, e, i) {
			this.animationToMixTime[t.name + ':' + e.name] = i;
		},
		getMix: function (t, e) {
			e = t.name + ':' + e.name;
			return this.animationToMixTime.hasOwnProperty(e)
				? this.animationToMixTime[e]
				: this.defaultMix;
		},
	}),
	(spine.TrackEntry = function () {
		(this.delay = this.time = this.endTime = 0),
			(this.lastTime = -1),
			(this.timeScale = 1),
			(this.mixTime = this.mixDuration = 1),
			(this.mix = 1);
	}),
	(spine.TrackEntry.prototype = {
		next: null,
		previous: null,
		animation: null,
		loop: !1,
		delay: 0,
		time: 0,
		lastTime: -1,
		endTime: 0,
		timeScale: 1,
		mixTime: 0,
		mixDuration: 0,
		mix: 1,
		onStart: null,
		onEnd: null,
		onComplete: null,
		onEvent: null,
	}),
	(spine.AnimationState = function (t) {
		(this.timeScale = 1),
			(this.data = t),
			(this.tracks = []),
			(this.events = []);
	}),
	(spine.AnimationState.prototype = {
		onStart: null,
		onEnd: null,
		onComplete: null,
		onEvent: null,
		timeScale: 1,
		update: function (t) {
			t *= this.timeScale;
			for (var e = 0; e < this.tracks.length; e++) {
				var i,
					n = this.tracks[e];
				n &&
					((n.time += t * n.timeScale),
					n.previous &&
						((i = t * n.previous.timeScale),
						(n.previous.time += i),
						(n.mixTime += i)),
					(i = n.next)
						? ((i.time = n.lastTime - i.delay),
						  0 <= i.time && this.setCurrent(e, i))
						: !n.loop &&
						  n.lastTime >= n.endTime &&
						  this.clearTrack(e));
			}
		},
		apply: function (t) {
			for (var e = 0; e < this.tracks.length; e++) {
				var i = this.tracks[e];
				if (i) {
					this.events.length = 0;
					var n = i.time,
						r = i.lastTime,
						o = i.endTime,
						s = i.loop;
					!s && o < n && (n = o);
					var c,
						a = i.previous;
					a
						? ((c = a.time),
						  !a.loop && c > a.endTime && (c = a.endTime),
						  a.animation.apply(t, c, c, a.loop, null),
						  1 <= (a = (i.mixTime / i.mixDuration) * i.mix) &&
								((a = 1), (i.previous = null)),
						  i.animation.mix(t, i.lastTime, n, s, this.events, a))
						: 1 == i.mix
						? i.animation.apply(t, i.lastTime, n, s, this.events)
						: i.animation.mix(
								t,
								i.lastTime,
								n,
								s,
								this.events,
								i.mix
						  );
					for (var l = 0, h = this.events.length; l < h; l++) {
						var u = this.events[l];
						i.onEvent && i.onEvent(e, u),
							this.onEvent && this.onEvent(e, u);
					}
					(s ? n % o < r % o : r < o && o <= n) &&
						((o = Math.floor(n / o)),
						i.onComplete && i.onComplete(e, o),
						this.onComplete && this.onComplete(e, o)),
						(i.lastTime = i.time);
				}
			}
		},
		clearTracks: function () {
			for (var t = 0, e = this.tracks.length; t < e; t++)
				this.clearTrack(t);
			this.tracks.length = 0;
		},
		clearTrack: function (t) {
			var e;
			t >= this.tracks.length ||
				((e = this.tracks[t]) &&
					(e.onEnd && e.onEnd(t),
					this.onEnd && this.onEnd(t),
					(this.tracks[t] = null)));
		},
		_expandToIndex: function (t) {
			if (t < this.tracks.length) return this.tracks[t];
			for (; t >= this.tracks.length; ) this.tracks.push(null);
			return null;
		},
		setCurrent: function (t, e) {
			var i,
				n = this._expandToIndex(t);
			n &&
				((i = n.previous),
				(n.previous = null),
				n.onEnd && n.onEnd(t),
				this.onEnd && this.onEnd(t),
				(e.mixDuration = this.data.getMix(n.animation, e.animation)),
				0 < e.mixDuration &&
					((e.mixTime = 0),
					i && n.mixTime / n.mixDuration < 0.5
						? (e.previous = i)
						: (e.previous = n))),
				(this.tracks[t] = e).onStart && e.onStart(t),
				this.onStart && this.onStart(t);
		},
		setAnimationByName: function (t, e, i) {
			var n = this.data.skeletonData.findAnimation(e);
			if (!n) throw new Error('Animation not found: ' + e);
			return this.setAnimation(t, n, i);
		},
		setAnimation: function (t, e, i) {
			var n = new spine.TrackEntry();
			return (
				(n.animation = e),
				(n.loop = i),
				(n.endTime = e.duration),
				this.setCurrent(t, n),
				n
			);
		},
		addAnimationByName: function (t, e, i, n) {
			var r = this.data.skeletonData.findAnimation(e);
			if (!r) throw new Error('Animation not found: ' + e);
			return this.addAnimation(t, r, i, n);
		},
		addAnimation: function (t, e, i, n) {
			var r = new spine.TrackEntry();
			(r.animation = e), (r.loop = i), (r.endTime = e.duration);
			var o = this._expandToIndex(t);
			if (o) {
				for (; o.next; ) o = o.next;
				o.next = r;
			} else this.tracks[t] = r;
			return (
				n <= 0 &&
					(o
						? (n += o.endTime - this.data.getMix(o.animation, e))
						: (n = 0)),
				(r.delay = n),
				r
			);
		},
		getCurrent: function (t) {
			return t >= this.tracks.length ? null : this.tracks[t];
		},
	}),
	(spine.SkeletonJson = function (t) {
		(this.scale = 1), (this.attachmentLoader = t);
	}),
	(spine.SkeletonJson.prototype = {
		scale: 1,
		readSkeletonData: function (t, e) {
			var i = new spine.SkeletonData();
			i.name = e;
			e = t.skeleton;
			e &&
				((i.hash = e.hash),
				(i.version = e.spine),
				(i.width = e.width || 0),
				(i.height = e.height || 0));
			for (var n = 0, r = (a = t.bones).length; n < r; n++) {
				var o = a[n],
					s = null;
				if (o.parent && !(s = i.findBone(o.parent)))
					throw new Error('Parent bone not found: ' + o.parent);
				((f = new spine.BoneData(o.name, s)).length =
					(o.length || 0) * this.scale),
					(f.x = (o.x || 0) * this.scale),
					(f.y = (o.y || 0) * this.scale),
					(f.rotation = o.rotation || 0),
					(f.scaleX = o.hasOwnProperty('scaleX') ? o.scaleX : 1),
					(f.scaleY = o.hasOwnProperty('scaleY') ? o.scaleY : 1),
					(f.inheritScale =
						!o.hasOwnProperty('inheritScale') || o.inheritScale),
					(f.inheritRotation =
						!o.hasOwnProperty('inheritRotation') ||
						o.inheritRotation),
					i.bones.push(f);
			}
			var c = t.ik;
			if (c)
				for (n = 0, r = c.length; n < r; n++) {
					for (
						var a,
							l = c[n],
							h = new spine.IkConstraintData(l.name),
							u = 0,
							_ = (a = l.bones).length;
						u < _;
						u++
					) {
						var d = i.findBone(a[u]);
						if (!d) throw new Error('IK bone not found: ' + a[u]);
						h.bones.push(d);
					}
					if (((h.target = i.findBone(l.target)), !h.target))
						throw new Error('Target bone not found: ' + l.target);
					(h.bendDirection =
						!l.hasOwnProperty('bendPositive') || l.bendPositive
							? 1
							: -1),
						(h.mix = l.hasOwnProperty('mix') ? l.mix : 1),
						i.ikConstraints.push(h);
				}
			for (var p = t.slots, n = 0, r = p.length; n < r; n++) {
				var f,
					m = p[n];
				if (!(f = i.findBone(m.bone)))
					throw new Error('Slot bone not found: ' + m.bone);
				var g = new spine.SlotData(m.name, f),
					y = m.color;
				y &&
					((g.r = this.toColor(y, 0)),
					(g.g = this.toColor(y, 1)),
					(g.b = this.toColor(y, 2)),
					(g.a = this.toColor(y, 3))),
					(g.attachmentName = m.attachment),
					(g.blendMode = spine.AttachmentType[m.blend || 'normal']),
					i.slots.push(g);
			}
			var T,
				S = t.skins;
			for (T in S)
				if (S.hasOwnProperty(T)) {
					var C,
						x = S[T],
						v = new spine.Skin(T);
					for (C in x)
						if (x.hasOwnProperty(C)) {
							var E,
								A,
								b = i.findSlotIndex(C),
								R = x[C];
							for (E in R)
								R.hasOwnProperty(E) &&
									(A = this.readAttachment(v, E, R[E])) &&
									v.addAttachment(b, E, A);
						}
					i.skins.push(v), 'default' == v.name && (i.defaultSkin = v);
				}
			var P,
				I,
				w,
				D = t.events;
			for (P in D)
				D.hasOwnProperty(P) &&
					((I = D[P]),
					((w = new spine.EventData(P)).intValue = I.int || 0),
					(w.floatValue = I.float || 0),
					(w.stringValue = I.string || null),
					i.events.push(w));
			var L,
				O = t.animations;
			for (L in O) O.hasOwnProperty(L) && this.readAnimation(L, O[L], i);
			return i;
		},
		readAttachment: function (t, e, i) {
			e = i.name || e;
			var n,
				r = spine.AttachmentType[i.type || 'region'],
				o = i.path || e,
				s = this.scale;
			if (r == spine.AttachmentType.region) {
				var c = this.attachmentLoader.newRegionAttachment(t, e, o);
				if (!c) return null;
				(c.path = o),
					(c.x = (i.x || 0) * s),
					(c.y = (i.y || 0) * s),
					(c.scaleX = i.hasOwnProperty('scaleX') ? i.scaleX : 1),
					(c.scaleY = i.hasOwnProperty('scaleY') ? i.scaleY : 1),
					(c.rotation = i.rotation || 0),
					(c.width = (i.width || 0) * s),
					(c.height = (i.height || 0) * s);
				var a = i.color;
				return (
					a &&
						((c.r = this.toColor(a, 0)),
						(c.g = this.toColor(a, 1)),
						(c.b = this.toColor(a, 2)),
						(c.a = this.toColor(a, 3))),
					c.updateOffset(),
					c
				);
			}
			if (r == spine.AttachmentType.mesh)
				return (n = this.attachmentLoader.newMeshAttachment(t, e, o))
					? ((n.path = o),
					  (n.vertices = this.getFloatArray(i, 'vertices', s)),
					  (n.triangles = this.getIntArray(i, 'triangles')),
					  (n.regionUVs = this.getFloatArray(i, 'uvs', 1)),
					  n.updateUVs(),
					  (a = i.color) &&
							((n.r = this.toColor(a, 0)),
							(n.g = this.toColor(a, 1)),
							(n.b = this.toColor(a, 2)),
							(n.a = this.toColor(a, 3))),
					  (n.hullLength = 2 * (i.hull || 0)),
					  i.edges && (n.edges = this.getIntArray(i, 'edges')),
					  (n.width = (i.width || 0) * s),
					  (n.height = (i.height || 0) * s),
					  n)
					: null;
			if (r == spine.AttachmentType.skinnedmesh) {
				if (
					!(n = this.attachmentLoader.newSkinnedMeshAttachment(
						t,
						e,
						o
					))
				)
					return null;
				n.path = o;
				for (
					var o = this.getFloatArray(i, 'uvs', 1),
						l = [],
						h = [],
						u = 0,
						_ = (f = this.getFloatArray(i, 'vertices', 1)).length;
					u < _;

				)
					for (
						var d = 0 | f[u++], p = u + 4 * (h[h.length] = d);
						u < p;

					)
						(h[h.length] = f[u]),
							(l[l.length] = f[u + 1] * s),
							(l[l.length] = f[u + 2] * s),
							(l[l.length] = f[u + 3]),
							(u += 4);
				return (
					(n.bones = h),
					(n.weights = l),
					(n.triangles = this.getIntArray(i, 'triangles')),
					(n.regionUVs = o),
					n.updateUVs(),
					(a = i.color) &&
						((n.r = this.toColor(a, 0)),
						(n.g = this.toColor(a, 1)),
						(n.b = this.toColor(a, 2)),
						(n.a = this.toColor(a, 3))),
					(n.hullLength = 2 * (i.hull || 0)),
					i.edges && (n.edges = this.getIntArray(i, 'edges')),
					(n.width = (i.width || 0) * s),
					(n.height = (i.height || 0) * s),
					n
				);
			}
			if (r != spine.AttachmentType.boundingbox)
				throw new Error('Unknown attachment type: ' + r);
			for (
				var f,
					m = this.attachmentLoader.newBoundingBoxAttachment(t, e),
					u = 0,
					_ = (f = i.vertices).length;
				u < _;
				u++
			)
				m.vertices.push(f[u] * s);
			return m;
		},
		readAnimation: function (t, e, i) {
			var n,
				r = [],
				o = 0,
				s = e.slots;
			for (n in s)
				if (s.hasOwnProperty(n)) {
					var c = s[n],
						a = i.findSlotIndex(n);
					for (C in c)
						if (c.hasOwnProperty(C)) {
							var l = c[C];
							if ('color' == C) {
								(M = new spine.ColorTimeline(
									l.length
								)).slotIndex = a;
								for (
									var h = 0, u = 0, _ = l.length;
									u < _;
									u++
								) {
									var d = (g = l[u]).color,
										p = this.toColor(d, 0),
										f = this.toColor(d, 1),
										m = this.toColor(d, 2),
										d = this.toColor(d, 3);
									M.setFrame(h, g.time, p, f, m, d),
										this.readCurve(M, h, g),
										h++;
								}
								r.push(M),
									(o = Math.max(
										o,
										M.frames[5 * M.getFrameCount() - 5]
									));
							} else {
								if ('attachment' != C)
									throw new Error(
										'Invalid timeline type for a slot: ' +
											C +
											' (' +
											n +
											')'
									);
								(M = new spine.AttachmentTimeline(
									l.length
								)).slotIndex = a;
								for (h = 0, u = 0, _ = l.length; u < _; u++) {
									var g = l[u];
									M.setFrame(h++, g.time, g.name);
								}
								r.push(M),
									(o = Math.max(
										o,
										M.frames[M.getFrameCount() - 1]
									));
							}
						}
				}
			var y,
				T = e.bones;
			for (y in T)
				if (T.hasOwnProperty(y)) {
					var S = i.findBoneIndex(y);
					if (-1 == S) throw new Error('Bone not found: ' + y);
					var C,
						x = T[y];
					for (C in x)
						if (x.hasOwnProperty(C)) {
							l = x[C];
							if ('rotate' == C) {
								(M = new spine.RotateTimeline(
									l.length
								)).boneIndex = S;
								for (h = 0, u = 0, _ = l.length; u < _; u++) {
									g = l[u];
									M.setFrame(h, g.time, g.angle),
										this.readCurve(M, h, g),
										h++;
								}
								r.push(M),
									(o = Math.max(
										o,
										M.frames[2 * M.getFrameCount() - 2]
									));
							} else if ('translate' == C || 'scale' == C) {
								var v = 1;
								'scale' == C
									? (M = new spine.ScaleTimeline(l.length))
									: ((M = new spine.TranslateTimeline(
											l.length
									  )),
									  (v = this.scale)),
									(M.boneIndex = S);
								for (h = 0, u = 0, _ = l.length; u < _; u++) {
									var E = ((g = l[u]).x || 0) * v,
										A = (g.y || 0) * v;
									M.setFrame(h, g.time, E, A),
										this.readCurve(M, h, g),
										h++;
								}
								r.push(M),
									(o = Math.max(
										o,
										M.frames[3 * M.getFrameCount() - 3]
									));
							} else {
								if ('flipX' != C && 'flipY' != C)
									throw new Error(
										'Invalid timeline type for a bone: ' +
											C +
											' (' +
											y +
											')'
									);
								(M = new (
									(E = 'flipX' == C)
										? spine.FlipXTimeline
										: spine.FlipYTimeline
								)(l.length)).boneIndex = S;
								for (
									var b = E ? 'x' : 'y',
										h = 0,
										u = 0,
										_ = l.length;
									u < _;
									u++
								) {
									g = l[u];
									M.setFrame(h, g.time, g[b] || !1), h++;
								}
								r.push(M),
									(o = Math.max(
										o,
										M.frames[2 * M.getFrameCount() - 2]
									));
							}
						}
				}
			var R,
				P = e.ik;
			for (R in P)
				if (P.hasOwnProperty(R)) {
					var I = i.findIkConstraint(R),
						l = P[R];
					(M = new spine.IkConstraintTimeline(
						l.length
					)).ikConstraintIndex = i.ikConstraints.indexOf(I);
					for (h = 0, u = 0, _ = l.length; u < _; u++) {
						var w = (g = l[u]).hasOwnProperty('mix') ? g.mix : 1,
							D =
								!g.hasOwnProperty('bendPositive') ||
								g.bendPositive
									? 1
									: -1;
						M.setFrame(h, g.time, w, D),
							this.readCurve(M, h, g),
							h++;
					}
					r.push(M),
						(o = Math.max(o, M.frames[3 * M.frameCount - 3]));
				}
			var L,
				O = e.ffd;
			for (L in O) {
				var B = i.findSkin(L);
				for (n in (c = O[L])) {
					var N,
						a = i.findSlotIndex(n),
						F = c[n];
					for (N in F) {
						var l = F[N],
							M = new spine.FfdTimeline(l.length),
							V = B.getAttachment(a, N);
						if (!V)
							throw new Error('FFD attachment not found: ' + N);
						M.slotIndex = a;
						for (
							var k =
									(M.attachment = V).type ==
									spine.AttachmentType.mesh,
								G = k
									? V.vertices.length
									: (V.weights.length / 3) * 2,
								h = 0,
								u = 0,
								_ = l.length;
							u < _;
							u++
						) {
							if ((g = l[u]).vertices) {
								var W,
									z = g.vertices;
								(W = []).length = G;
								var U = g.offset || 0,
									Y = z.length;
								if (1 == this.scale)
									for (var X = 0; X < Y; X++) W[X + U] = z[X];
								else
									for (X = 0; X < Y; X++)
										W[X + U] = z[X] * this.scale;
								if (k)
									for (
										var H = V.vertices, X = 0, Y = W.length;
										X < Y;
										X++
									)
										W[X] += H[X];
							} else k ? (W = V.vertices) : ((W = []).length = G);
							M.setFrame(h, g.time, W),
								this.readCurve(M, h, g),
								h++;
						}
						(r[r.length] = M),
							(o = Math.max(o, M.frames[M.frameCount - 1]));
					}
				}
			}
			var j = e.drawOrder;
			if ((j = j || e.draworder)) {
				for (
					var M = new spine.DrawOrderTimeline(j.length),
						q = i.slots.length,
						h = 0,
						u = 0,
						_ = j.length;
					u < _;
					u++
				) {
					var J = j[u],
						Z = null;
					if (J.offsets) {
						for (X = ((Z = []).length = q) - 1; 0 <= X; X--)
							Z[X] = -1;
						var K = J.offsets,
							Q = [];
						Q.length = q - K.length;
						for (
							var $ = 0, tt = 0, X = 0, Y = K.length;
							X < Y;
							X++
						) {
							var et = K[X];
							if (-1 == (a = i.findSlotIndex(et.slot)))
								throw new Error('Slot not found: ' + et.slot);
							for (; $ != a; ) Q[tt++] = $++;
							Z[$ + et.offset] = $++;
						}
						for (; $ < q; ) Q[tt++] = $++;
						for (X = q - 1; 0 <= X; X--)
							-1 == Z[X] && (Z[X] = Q[--tt]);
					}
					M.setFrame(h++, J.time, Z);
				}
				r.push(M), (o = Math.max(o, M.frames[M.getFrameCount() - 1]));
			}
			var it = e.events;
			if (it) {
				for (
					M = new spine.EventTimeline(it.length),
						h = 0,
						u = 0,
						_ = it.length;
					u < _;
					u++
				) {
					var nt = it[u],
						rt = i.findEvent(nt.name);
					if (!rt) throw new Error('Event not found: ' + nt.name);
					var ot = new spine.Event(rt);
					(ot.intValue = nt.hasOwnProperty('int')
						? nt.int
						: rt.intValue),
						(ot.floatValue = nt.hasOwnProperty('float')
							? nt.float
							: rt.floatValue),
						(ot.stringValue = nt.hasOwnProperty('string')
							? nt.string
							: rt.stringValue),
						M.setFrame(h++, nt.time, ot);
				}
				r.push(M), (o = Math.max(o, M.frames[M.getFrameCount() - 1]));
			}
			i.animations.push(new spine.Animation(t, r, o));
		},
		readCurve: function (t, e, i) {
			i = i.curve;
			i
				? 'stepped' == i
					? t.curves.setStepped(e)
					: i instanceof Array &&
					  t.curves.setCurve(e, i[0], i[1], i[2], i[3])
				: t.curves.setLinear(e);
		},
		toColor: function (t, e) {
			if (8 != t.length)
				throw new Error(
					'Color hexadecimal length must be 8, received: ' + t
				);
			return parseInt(t.substring(2 * e, 2 * e + 2), 16) / 255;
		},
		getFloatArray: function (t, e, i) {
			var n = t[e],
				r = new spine.Float32Array(n.length),
				o = 0,
				s = n.length;
			if (1 == i) for (; o < s; o++) r[o] = n[o];
			else for (; o < s; o++) r[o] = n[o] * i;
			return r;
		},
		getIntArray: function (t, e) {
			for (
				var i = t[e],
					n = new spine.Uint16Array(i.length),
					r = 0,
					o = i.length;
				r < o;
				r++
			)
				n[r] = 0 | i[r];
			return n;
		},
	}),
	(spine.Atlas = function (t, e) {
		(this.textureLoader = e), (this.pages = []), (this.regions = []);
		var i = new spine.AtlasReader(t),
			n = [];
		n.length = 4;
		for (var r = null; ; ) {
			var o,
				s,
				c,
				a,
				l,
				h = i.readLine();
			if (null === h) break;
			(h = i.trim(h)).length
				? r
					? (((l = new spine.AtlasRegion()).name = h),
					  (l.page = r),
					  (l.rotate = 'true' == i.readValue()),
					  i.readTuple(n),
					  (o = parseInt(n[0])),
					  (s = parseInt(n[1])),
					  i.readTuple(n),
					  (c = parseInt(n[0])),
					  (a = parseInt(n[1])),
					  (l.u = o / r.width),
					  (l.v = s / r.height),
					  l.rotate
							? ((l.u2 = (o + a) / r.width),
							  (l.v2 = (s + c) / r.height))
							: ((l.u2 = (o + c) / r.width),
							  (l.v2 = (s + a) / r.height)),
					  (l.x = o),
					  (l.y = s),
					  (l.width = Math.abs(c)),
					  (l.height = Math.abs(a)),
					  4 == i.readTuple(n) &&
							((l.splits = [
								parseInt(n[0]),
								parseInt(n[1]),
								parseInt(n[2]),
								parseInt(n[3]),
							]),
							4 == i.readTuple(n) &&
								((l.pads = [
									parseInt(n[0]),
									parseInt(n[1]),
									parseInt(n[2]),
									parseInt(n[3]),
								]),
								i.readTuple(n))),
					  (l.originalWidth = parseInt(n[0])),
					  (l.originalHeight = parseInt(n[1])),
					  i.readTuple(n),
					  (l.offsetX = parseInt(n[0])),
					  (l.offsetY = parseInt(n[1])),
					  (l.index = parseInt(i.readValue())),
					  this.regions.push(l))
					: (((r = new spine.AtlasPage()).name = h),
					  2 == i.readTuple(n) &&
							((r.width = parseInt(n[0])),
							(r.height = parseInt(n[1])),
							i.readTuple(n)),
					  (r.format = spine.Atlas.Format[n[0]]),
					  i.readTuple(n),
					  (r.minFilter = spine.Atlas.TextureFilter[n[0]]),
					  (r.magFilter = spine.Atlas.TextureFilter[n[1]]),
					  (l = i.readValue()),
					  (r.uWrap = spine.Atlas.TextureWrap.clampToEdge),
					  (r.vWrap = spine.Atlas.TextureWrap.clampToEdge),
					  'x' == l
							? (r.uWrap = spine.Atlas.TextureWrap.repeat)
							: 'y' == l
							? (r.vWrap = spine.Atlas.TextureWrap.repeat)
							: 'xy' == l &&
							  (r.uWrap = r.vWrap =
									spine.Atlas.TextureWrap.repeat),
					  e.load(r, h, this),
					  this.pages.push(r))
				: (r = null);
		}
	}),
	(spine.Atlas.prototype = {
		findRegion: function (t) {
			for (var e = this.regions, i = 0, n = e.length; i < n; i++)
				if (e[i].name == t) return e[i];
			return null;
		},
		dispose: function () {
			for (var t = this.pages, e = 0, i = t.length; e < i; e++)
				this.textureLoader.unload(t[e].rendererObject);
		},
		updateUVs: function (t) {
			for (var e = this.regions, i = 0, n = e.length; i < n; i++) {
				var r = e[i];
				r.page == t &&
					((r.u = r.x / t.width),
					(r.v = r.y / t.height),
					r.rotate
						? ((r.u2 = (r.x + r.height) / t.width),
						  (r.v2 = (r.y + r.width) / t.height))
						: ((r.u2 = (r.x + r.width) / t.width),
						  (r.v2 = (r.y + r.height) / t.height)));
			}
		},
	}),
	(spine.Atlas.Format = {
		alpha: 0,
		intensity: 1,
		luminanceAlpha: 2,
		rgb565: 3,
		rgba4444: 4,
		rgb888: 5,
		rgba8888: 6,
	}),
	(spine.Atlas.TextureFilter = {
		nearest: 0,
		linear: 1,
		mipMap: 2,
		mipMapNearestNearest: 3,
		mipMapLinearNearest: 4,
		mipMapNearestLinear: 5,
		mipMapLinearLinear: 6,
	}),
	(spine.Atlas.TextureWrap = {
		mirroredRepeat: 0,
		clampToEdge: 1,
		repeat: 2,
	}),
	(spine.AtlasPage = function () {
		this.width = this.height = 0;
	}),
	(spine.AtlasPage.prototype = {
		name: null,
		format: null,
		minFilter: null,
		magFilter: null,
		uWrap: null,
		vWrap: null,
		rendererObject: null,
		width: 0,
		height: 0,
	}),
	(spine.AtlasRegion = function () {
		(this.x =
			this.y =
			this.width =
			this.height =
			this.u =
			this.v =
			this.u2 =
			this.v2 =
			this.offsetX =
			this.offsetY =
			this.originalWidth =
			this.originalHeight =
				0),
			(this.index = 0);
	}),
	(spine.AtlasRegion.prototype = {
		page: null,
		name: null,
		x: 0,
		y: 0,
		width: 0,
		height: 0,
		u: 0,
		v: 0,
		u2: 0,
		v2: 0,
		offsetX: 0,
		offsetY: 0,
		originalWidth: 0,
		originalHeight: 0,
		index: 0,
		rotate: !1,
		splits: null,
		pads: null,
	}),
	(spine.AtlasReader = function (t) {
		(this.index = 0), (this.lines = t.split(/\r\n|\r|\n/));
	}),
	(spine.AtlasReader.prototype = {
		index: 0,
		trim: function (t) {
			return t.replace(/^\s+|\s+$/g, '');
		},
		readLine: function () {
			return this.index >= this.lines.length
				? null
				: this.lines[this.index++];
		},
		readValue: function () {
			var t = this.readLine(),
				e = t.indexOf(':');
			if (-1 == e) throw new Error('Invalid line: ' + t);
			return this.trim(t.substring(e + 1));
		},
		readTuple: function (t) {
			var e = this.readLine(),
				i = e.indexOf(':');
			if (-1 == i) throw new Error('Invalid line: ' + e);
			for (var n = 0, r = i + 1; n < 3; n++) {
				var o = e.indexOf(',', r);
				if (-1 == o) break;
				(t[n] = this.trim(e.substr(r, o - r))), (r = o + 1);
			}
			return (t[n] = this.trim(e.substring(r))), n + 1;
		},
	}),
	(spine.AtlasAttachmentLoader = function (t) {
		this.atlas = t;
	}),
	(spine.AtlasAttachmentLoader.prototype = {
		newRegionAttachment: function (t, e, i) {
			var n = this.atlas.findRegion(i);
			if (!n)
				throw new Error(
					'Region not found in atlas: ' +
						i +
						' (region attachment: ' +
						e +
						')'
				);
			e = new spine.RegionAttachment(e);
			return (
				(e.rendererObject = n),
				e.setUVs(n.u, n.v, n.u2, n.v2, n.rotate),
				(e.regionOffsetX = n.offsetX),
				(e.regionOffsetY = n.offsetY),
				(e.regionWidth = n.width),
				(e.regionHeight = n.height),
				(e.regionOriginalWidth = n.originalWidth),
				(e.regionOriginalHeight = n.originalHeight),
				e
			);
		},
		newMeshAttachment: function (t, e, i) {
			var n = this.atlas.findRegion(i);
			if (!n)
				throw new Error(
					'Region not found in atlas: ' +
						i +
						' (mesh attachment: ' +
						e +
						')'
				);
			e = new spine.MeshAttachment(e);
			return (
				(e.rendererObject = n),
				(e.regionU = n.u),
				(e.regionV = n.v),
				(e.regionU2 = n.u2),
				(e.regionV2 = n.v2),
				(e.regionRotate = n.rotate),
				(e.regionOffsetX = n.offsetX),
				(e.regionOffsetY = n.offsetY),
				(e.regionWidth = n.width),
				(e.regionHeight = n.height),
				(e.regionOriginalWidth = n.originalWidth),
				(e.regionOriginalHeight = n.originalHeight),
				e
			);
		},
		newSkinnedMeshAttachment: function (t, e, i) {
			var n = this.atlas.findRegion(i);
			if (!n)
				throw new Error(
					'Region not found in atlas: ' +
						i +
						' (skinned mesh attachment: ' +
						e +
						')'
				);
			e = new spine.SkinnedMeshAttachment(e);
			return (
				(e.rendererObject = n),
				(e.regionU = n.u),
				(e.regionV = n.v),
				(e.regionU2 = n.u2),
				(e.regionV2 = n.v2),
				(e.regionRotate = n.rotate),
				(e.regionOffsetX = n.offsetX),
				(e.regionOffsetY = n.offsetY),
				(e.regionWidth = n.width),
				(e.regionHeight = n.height),
				(e.regionOriginalWidth = n.originalWidth),
				(e.regionOriginalHeight = n.originalHeight),
				e
			);
		},
		newBoundingBoxAttachment: function (t, e) {
			return new spine.BoundingBoxAttachment(e);
		},
	}),
	(spine.SkeletonBounds = function () {
		(this.minX = this.minY = this.maxX = this.maxY = 0),
			(this.polygonPool = []),
			(this.polygons = []),
			(this.boundingBoxes = []);
	}),
	(spine.SkeletonBounds.prototype = {
		minX: 0,
		minY: 0,
		maxX: 0,
		maxY: 0,
		update: function (t, e) {
			for (
				var i = t.slots,
					n = i.length,
					r = t.x,
					o = t.y,
					s = this.boundingBoxes,
					c = this.polygonPool,
					a = this.polygons,
					l = (s.length = 0),
					h = a.length;
				l < h;
				l++
			)
				c.push(a[l]);
			for (l = a.length = 0; l < n; l++) {
				var u,
					_,
					d = i[l],
					p = d.attachment;
				p.type == spine.AttachmentType.boundingbox &&
					(s.push(p),
					0 < (u = c.length)
						? ((_ = c[u - 1]), c.splice(u - 1, 1))
						: (_ = []),
					a.push(_),
					(_.length = p.vertices.length),
					p.computeWorldVertices(r, o, d.bone, _));
			}
			e && this.aabbCompute();
		},
		aabbCompute: function () {
			for (
				var t = this.polygons,
					e = Number.MAX_VALUE,
					i = Number.MAX_VALUE,
					n = Number.MIN_VALUE,
					r = Number.MIN_VALUE,
					o = 0,
					s = t.length;
				o < s;
				o++
			)
				for (var c = t[o], a = 0, l = c.length; a < l; a += 2)
					var h = c[a],
						u = c[a + 1],
						e = Math.min(e, h),
						i = Math.min(i, u),
						n = Math.max(n, h),
						r = Math.max(r, u);
			(this.minX = e), (this.minY = i), (this.maxX = n), (this.maxY = r);
		},
		aabbContainsPoint: function (t, e) {
			return (
				t >= this.minX &&
				t <= this.maxX &&
				e >= this.minY &&
				e <= this.maxY
			);
		},
		aabbIntersectsSegment: function (t, e, i, n) {
			var r = this.minX,
				o = this.minY,
				s = this.maxX,
				c = this.maxY;
			if (
				(t <= r && i <= r) ||
				(e <= o && n <= o) ||
				(s <= t && s <= i) ||
				(c <= e && c <= n)
			)
				return !1;
			(n = (n - e) / (i - t)), (i = n * (r - t) + e);
			if (o < i && i < c) return !0;
			if (o < (i = n * (s - t) + e) && i < c) return !0;
			o = (o - e) / n + t;
			return (r < o && o < s) || (r < (o = (c - e) / n + t) && o < s);
		},
		aabbIntersectsSkeleton: function (t) {
			return (
				this.minX < t.maxX &&
				this.maxX > t.minX &&
				this.minY < t.maxY &&
				this.maxY > t.minY
			);
		},
		containsPoint: function (t, e) {
			for (var i = this.polygons, n = 0, r = i.length; n < r; n++)
				if (this.polygonContainsPoint(i[n], t, e))
					return this.boundingBoxes[n];
			return null;
		},
		intersectsSegment: function (t, e, i, n) {
			for (var r = this.polygons, o = 0, s = r.length; o < s; o++)
				if (r[o].intersectsSegment(t, e, i, n))
					return this.boundingBoxes[o];
			return null;
		},
		polygonContainsPoint: function (t, e, i) {
			for (var n = t.length, r = n - 2, o = !1, s = 0; s < n; s += 2) {
				var c,
					a = t[s + 1],
					l = t[r + 1];
				!((a < i && i <= l) || (l < i && i <= a)) ||
					((c = t[s]) + ((i - a) / (l - a)) * (t[r] - c) < e &&
						(o = !o)),
					(r = s);
			}
			return o;
		},
		polygonIntersectsSegment: function (t, e, i, n, r) {
			for (
				var o = t.length,
					s = e - n,
					c = i - r,
					a = e * r - i * n,
					l = t[o - 2],
					h = t[o - 1],
					u = 0;
				u < o;
				u += 2
			) {
				var _ = t[u],
					d = t[u + 1],
					p = l * d - h * _,
					f = l - _,
					m = h - d,
					g = s * m - c * f,
					f = (a * f - s * p) / g;
				if (
					((l <= f && f <= _) || (_ <= f && f <= l)) &&
					((e <= f && f <= n) || (n <= f && f <= e))
				) {
					g = (a * m - c * p) / g;
					if (
						((h <= g && g <= d) || (d <= g && g <= h)) &&
						((i <= g && g <= r) || (r <= g && g <= i))
					)
						return !0;
				}
				(l = _), (h = d);
			}
			return !1;
		},
		getPolygon: function (t) {
			t = this.boundingBoxes.indexOf(t);
			return -1 == t ? null : this.polygons[t];
		},
		getWidth: function () {
			return this.maxX - this.minX;
		},
		getHeight: function () {
			return this.maxY - this.minY;
		},
	}),
	(sp._atlasPage_createTexture_webGL = function (t, e) {
		e = cc.textureCache.addImage(e);
		(t.rendererObject = new cc.TextureAtlas(e, 128)),
			(t.width = e.getPixelsWide()),
			(t.height = e.getPixelsHigh());
	}),
	(sp._atlasPage_createTexture_canvas = function (t, e) {
		t._texture = cc.textureCache.addImage(e);
	}),
	(sp._atlasPage_disposeTexture = function (t) {
		t.rendererObject.release();
	}),
	(sp._atlasLoader = {
		spAtlasFile: null,
		setAtlasFile: function (t) {
			this.spAtlasFile = t;
		},
		load: function (t, e, i) {
			e = cc.path.join(cc.path.dirname(this.spAtlasFile), e);
			cc._renderType === cc.game.RENDER_TYPE_WEBGL
				? sp._atlasPage_createTexture_webGL(t, e)
				: sp._atlasPage_createTexture_canvas(t, e);
		},
		unload: function (t) {},
	}),
	(sp.ANIMATION_EVENT_TYPE = { START: 0, END: 1, COMPLETE: 2, EVENT: 3 }),
	(sp.TrackEntryListeners = function (t, e, i, n) {
		(this.startListener = t || null),
			(this.endListener = e || null),
			(this.completeListener = i || null),
			(this.eventListener = n || null);
	}),
	(sp.TrackEntryListeners.getListeners = function (t) {
		return (
			t.rendererObject ||
				((t.rendererObject = new sp.TrackEntryListeners()),
				(t.listener = sp.trackEntryCallback)),
			t.rendererObject
		);
	}),
	(sp.trackEntryCallback = function (t, e, i, n, r) {
		t.rendererObject.onTrackEntryEvent(e, i, n, r);
	}),
	(sp.SkeletonAnimation = sp.Skeleton.extend({
		_state: null,
		_target: null,
		_callback: null,
		_ownsAnimationStateData: !1,
		_startListener: null,
		_endListener: null,
		_completeListener: null,
		_eventListener: null,
		init: function () {
			sp.Skeleton.prototype.init.call(this),
				(this._ownsAnimationStateData = !0),
				this.setAnimationStateData(
					new spine.AnimationStateData(this._skeleton.data)
				);
		},
		setAnimationStateData: function (t) {
			t = new spine.AnimationState(t);
			(t.rendererObject = this),
				(t.onStart = this._onAnimationStateStart.bind(this)),
				(t.onComplete = this._onAnimationStateComplete.bind(this)),
				(t.onEnd = this._onAnimationStateEnd.bind(this)),
				(t.onEvent = this._onAnimationStateEvent.bind(this)),
				(this._state = t);
		},
		setMix: function (t, e, i) {
			this._state.data.setMixByName(t, e, i);
		},
		setAnimationListener: function (t, e) {
			(this._target = t), (this._callback = e);
		},
		setAnimation: function (t, e, i) {
			var n = this._skeleton.data.findAnimation(e);
			return n
				? this._state.setAnimation(t, n, i)
				: (cc.log('Spine: Animation not found: ' + e), null);
		},
		addAnimation: function (t, e, i, n) {
			n = null == n ? 0 : n;
			var r = this._skeleton.data.findAnimation(e);
			return r
				? this._state.addAnimation(t, r, i, n)
				: (cc.log('Spine: Animation not found:' + e), null);
		},
		getCurrent: function (t) {
			return this._state.getCurrent(t);
		},
		clearTracks: function () {
			this._state.clearTracks();
		},
		clearTrack: function (t) {
			this._state.clearTrack(t);
		},
		update: function (t) {
			this._super(t),
				(t *= this._timeScale),
				this._state.update(t),
				this._state.apply(this._skeleton),
				this._skeleton.updateWorldTransform(),
				this._renderCmd._updateChild();
		},
		setStartListener: function (t) {
			this._startListener = t;
		},
		setEndListener: function (t) {
			this._endListener = t;
		},
		setCompleteListener: function (t) {
			this._completeListener = t;
		},
		setEventListener: function (t) {
			this._eventListener = t;
		},
		setTrackStartListener: function (t, e) {
			sp.TrackEntryListeners.getListeners(t).startListener = e;
		},
		setTrackEndListener: function (t, e) {
			sp.TrackEntryListeners.getListeners(t).endListener = e;
		},
		setTrackCompleteListener: function (t, e) {
			sp.TrackEntryListeners.getListeners(t).completeListener = e;
		},
		setTrackEventListener: function (t, e) {
			sp.TrackEntryListeners.getListeners(t).eventListener = e;
		},
		onTrackEntryEvent: function (t, e, i, n) {
			var r = this._state.getCurrent(t);
			if (r.rendererObject) {
				var o = r.rendererObject;
				switch (e) {
					case sp.ANIMATION_EVENT_TYPE.START:
						o.startListener && o.startListener(t);
						break;
					case sp.ANIMATION_EVENT_TYPE.END:
						o.endListener && o.endListener(t);
						break;
					case sp.ANIMATION_EVENT_TYPE.COMPLETE:
						o.completeListener && o.completeListener(t, n);
						break;
					case sp.ANIMATION_EVENT_TYPE.EVENT:
						o.eventListener && o.eventListener(t, i);
				}
			}
		},
		onAnimationStateEvent: function (t, e, i, n) {
			switch (e) {
				case sp.ANIMATION_EVENT_TYPE.START:
					this._startListener && this._startListener(t);
					break;
				case sp.ANIMATION_EVENT_TYPE.END:
					this._endListener && this._endListener(t);
					break;
				case sp.ANIMATION_EVENT_TYPE.COMPLETE:
					this._completeListener && this._completeListener(t, n);
					break;
				case sp.ANIMATION_EVENT_TYPE.EVENT:
					this._eventListener && this._eventListener(t, i);
			}
		},
		getState: function () {
			return this._state;
		},
		_onAnimationStateStart: function (t) {
			this._animationStateCallback(
				t,
				sp.ANIMATION_EVENT_TYPE.START,
				null,
				0
			);
		},
		_onAnimationStateEnd: function (t) {
			this._animationStateCallback(
				t,
				sp.ANIMATION_EVENT_TYPE.END,
				null,
				0
			);
		},
		_onAnimationStateComplete: function (t, e) {
			this._animationStateCallback(
				t,
				sp.ANIMATION_EVENT_TYPE.COMPLETE,
				null,
				e
			);
		},
		_onAnimationStateEvent: function (t, e) {
			this._animationStateCallback(
				t,
				sp.ANIMATION_EVENT_TYPE.EVENT,
				e,
				0
			);
		},
		_animationStateCallback: function (t, e, i, n) {
			this.onAnimationStateEvent(t, e, i, n),
				this._target &&
					this._callback &&
					this._callback.call(this._target, this, t, e, i, n);
		},
	})),
	(sp.SkeletonAnimation.create = function (t, e, i) {
		return new sp.SkeletonAnimation(t, e, i);
	}),
	(function () {
		sp.Skeleton.CanvasRenderCmd = function (t) {
			cc.Node.CanvasRenderCmd.call(this, t), (this._needDraw = !0);
		};
		var t = (sp.Skeleton.CanvasRenderCmd.prototype = Object.create(
			cc.Node.CanvasRenderCmd.prototype
		));
		function o(t, e, i, n) {
			var r = new cc.Rect(i.x, i.y, i.width, i.height);
			t.initWithTexture(e, r, i.rotate, !1),
				(t._rect.width = n.width),
				(t._rect.height = n.height),
				t.setContentSize(n.width, n.height),
				t.setRotation(-n.rotation),
				t.setScale(
					(i.width / i.originalWidth) * n.scaleX,
					(i.height / i.originalHeight) * n.scaleY
				);
		}
		(t.constructor = sp.Skeleton.CanvasRenderCmd),
			(t.rendering = function (t, e, i) {
				var n,
					r,
					o = this._node;
				t = t || cc._renderContext;
				var s = o._skeleton,
					c = s.drawOrder;
				for (_ = 0, d = c.length; _ < d; _++)
					(r = (n = c[_])._slotNode)._visible &&
						r._renderCmd &&
						n.currentSprite &&
						(r._renderCmd.transform(this, !0),
						n.currentSprite._renderCmd.rendering(t, e, i),
						(r._renderCmd._dirtyFlag =
							n.currentSprite._renderCmd._dirtyFlag =
								0));
				if (o._debugSlots || o._debugBones) {
					t.setTransform(this._worldTransform, e, i),
						t.setGlobalAlpha(1);
					var a,
						l,
						h = cc._drawingUtil;
					if (o._debugSlots) {
						h.setDrawColor(0, 0, 255, 255), h.setLineWidth(1);
						for (var u = [], _ = 0, d = s.slots.length; _ < d; _++)
							(n = s.drawOrder[_]).attachment &&
								n.attachment.type ==
									sp.ATTACHMENT_TYPE.REGION &&
								((a = n.attachment),
								this._updateRegionAttachmentSlot(a, n, u),
								h.drawPoly(u, 4, !0));
					}
					if (o._debugBones) {
						for (
							h.setLineWidth(2),
								h.setDrawColor(255, 0, 0, 255),
								_ = 0,
								d = s.bones.length;
							_ < d;
							_++
						) {
							var p =
									(l = s.bones[_]).data.length * l.m00 +
									l.worldX,
								f = l.data.length * l.m10 + l.worldY;
							h.drawLine(
								{ x: l.worldX, y: l.worldY },
								{ x: p, y: f }
							);
						}
						for (
							h.setPointSize(4),
								h.setDrawColor(0, 0, 255, 255),
								_ = 0,
								d = s.bones.length;
							_ < d;
							_++
						)
							(l = s.bones[_]),
								h.drawPoint({ x: l.worldX, y: l.worldY }),
								0 === _ && h.setDrawColor(0, 255, 0, 255);
					}
				}
			}),
			(t._updateRegionAttachmentSlot = function (t, e, i) {
				var n, r;
				i &&
					((n = {}),
					(r = sp.VERTEX_INDEX),
					(e = e.bone),
					t.computeVertices(e.skeleton.x, e.skeleton.y, e, n),
					(i.length = 0),
					i.push(cc.p(n[r.X1], n[r.Y1])),
					i.push(cc.p(n[r.X4], n[r.Y4])),
					i.push(cc.p(n[r.X3], n[r.Y3])),
					i.push(cc.p(n[r.X2], n[r.Y2])));
			}),
			(t._createChildFormSkeletonData = function () {
				for (
					var t, e = this._node._skeleton, i = 0, n = e.slots.length;
					i < n;
					i++
				) {
					var r = e.slots[i],
						o = r.attachment,
						s = new cc.Node();
					(r._slotNode = s),
						o instanceof spine.RegionAttachment
							? ((t = o.rendererObject.name),
							  (o = this._createSprite(r, o)),
							  (r.currentSprite = o),
							  (r.currentSpriteName = t),
							  s.addChild(o))
							: spine.MeshAttachment;
				}
			}),
			(t._createSprite = function (t, e) {
				var i = e.rendererObject,
					n = i.page._texture,
					r = new cc.Sprite();
				return (
					n.isLoaded()
						? o(r, n, i, e)
						: n.addEventListener(
								'load',
								function () {
									o(r, n, i, e);
								},
								this
						  ),
					(t.sprites = t.sprites || {}),
					(t.sprites[i.name] = r)
				);
			}),
			(t._updateChild = function () {
				for (
					var t,
						e = this._node._skeleton,
						i = e.slots,
						n = 0,
						r = i.length;
					n < r;
					n++
				)
					if (((a = (l = i[n]).attachment), (t = l._slotNode), a)) {
						var o,
							s = a.type;
						if (s === spine.AttachmentType.region) {
							a.rendererObject &&
								((l.currentSpriteName &&
									l.currentSpriteName === a.name) ||
									((o = a.rendererObject.name),
									void 0 !== l.currentSprite &&
										l.currentSprite.setVisible(!1),
									(l.sprites = l.sprites || {}),
									void 0 !== l.sprites[o]
										? l.sprites[o].setVisible(!0)
										: ((c = this._createSprite(l, a)),
										  t.addChild(c)),
									(l.currentSprite = l.sprites[o]),
									(l.currentSpriteName = o)));
							var c = l.bone;
							t.setPosition(
								c.worldX + a.x * c.m00 + a.y * c.m01,
								c.worldY + a.x * c.m10 + a.y * c.m11
							),
								t.setScale(c.worldScaleX, c.worldScaleY),
								((o = l.currentSprite)._flippedX =
									c.worldFlipX),
								(o._flippedY = c.worldFlipY),
								o._flippedY || o._flippedX
									? (t.setRotation(c.worldRotation),
									  o.setRotation(a.rotation))
									: (t.setRotation(-c.worldRotation),
									  o.setRotation(-a.rotation)),
								(o._renderCmd._displayedOpacity =
									0 | (this._node.getOpacity() * e.a * l.a));
							var c = 0 | (e.r * l.r * 255),
								a = 0 | (e.g * l.g * 255),
								l = 0 | (e.b * l.b * 255);
							o.setColor(cc.color(c, a, l)),
								o._renderCmd._updateColor();
						} else if (s !== spine.AttachmentType.skinnedmesh) {
							t.setVisible(!1);
							continue;
						}
						t.setVisible(!0);
					} else t.setVisible(!1);
			});
	})(),
	(function () {
		sp.Skeleton.WebGLRenderCmd = function (t) {
			cc.Node.WebGLRenderCmd.call(this, t),
				(this._needDraw = !0),
				(this._matrix = new cc.math.Matrix4()),
				this._matrix.identity(),
				(this._tmpQuad = new cc.V3F_C4B_T2F_Quad()),
				this.setShaderProgram(
					cc.shaderCache.programForKey(
						cc.SHADER_POSITION_TEXTURECOLOR
					)
				);
		};
		var t = (sp.Skeleton.WebGLRenderCmd.prototype = Object.create(
			cc.Node.WebGLRenderCmd.prototype
		));
		(t.constructor = sp.Skeleton.WebGLRenderCmd),
			(t.rendering = function (t) {
				var e,
					i,
					n,
					r,
					o,
					s = this._node,
					c = this._tmpQuad,
					a = s.getColor(),
					l = s._skeleton,
					h = s._blendFunc,
					u = s._premultipliedAlpha,
					_ = this._worldTransform;
				for (
					this._matrix.mat[0] = _.a,
						this._matrix.mat[4] = _.c,
						this._matrix.mat[12] = _.tx,
						this._matrix.mat[1] = _.b,
						this._matrix.mat[5] = _.d,
						this._matrix.mat[13] = _.ty,
						this._shaderProgram.use(),
						this._shaderProgram._setUniformForMVPMatrixWithMat4(
							this._matrix
						),
						l.r = a.r / 255,
						l.g = a.g / 255,
						l.b = a.b / 255,
						l.a = s.getOpacity() / 255,
						u && ((l.r *= l.a), (l.g *= l.a), (l.b *= l.a)),
						r = 0,
						o = l.drawOrder.length;
					r < o;
					r++
				)
					if ((f = l.drawOrder[r]).attachment) {
						switch (((n = f.attachment), f.attachment.type)) {
							case sp.ATTACHMENT_TYPE.REGION:
								this._updateRegionAttachmentQuad(n, f, c, u);
								break;
							case sp.ATTACHMENT_TYPE.MESH:
								this._updateMeshAttachmentQuad(n, f, c, u);
								break;
							case sp.ATTACHMENT_TYPE.SKINNED_MESH:
								break;
							default:
								continue;
						}
						var d = s.getTextureAtlas(n);
						if (f.data.blendMode != e)
							switch (
								(i && (i.drawQuads(), i.removeAllQuads()),
								(e = f.data.blendMode))
							) {
								case spine.BlendMode.additive:
									cc.glBlendFunc(
										u ? cc.ONE : cc.SRC_ALPHA,
										cc.ONE
									);
									break;
								case spine.BlendMode.multiply:
									cc.glBlendFunc(
										cc.DST_COLOR,
										cc.ONE_MINUS_SRC_ALPHA
									);
									break;
								case spine.BlendMode.screen:
									cc.glBlendFunc(
										cc.ONE,
										cc.ONE_MINUS_SRC_COLOR
									);
									break;
								default:
									cc.glBlendFunc(h.src, h.dst);
							}
						else d != i && i && (i.drawQuads(), i.removeAllQuads());
						d = (i = d).getTotalQuads();
						if (
							i.getCapacity() == d &&
							(i.drawQuads(),
							i.removeAllQuads(),
							!i.resizeCapacity(2 * i.getCapacity()))
						)
							return;
						i.updateQuad(c, d);
					}
				if (
					(i && (i.drawQuads(), i.removeAllQuads()),
					s._debugBones || s._debugSlots)
				) {
					cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),
						cc.current_stack.stack.push(cc.current_stack.top),
						(cc.current_stack.top = this._matrix);
					var p,
						f,
						m,
						g = cc._drawingUtil;
					if (s._debugSlots)
						for (
							g.setDrawColor(0, 0, 255, 255),
								g.setLineWidth(1),
								r = 0,
								o = l.slots.length;
							r < o;
							r++
						)
							(f = l.drawOrder[r]).attachment &&
								f.attachment.type ==
									sp.ATTACHMENT_TYPE.REGION &&
								((n = f.attachment),
								this._updateRegionAttachmentQuad(n, f, c),
								(p = []).push(
									cc.p(c.bl.vertices.x, c.bl.vertices.y)
								),
								p.push(cc.p(c.br.vertices.x, c.br.vertices.y)),
								p.push(cc.p(c.tr.vertices.x, c.tr.vertices.y)),
								p.push(cc.p(c.tl.vertices.x, c.tl.vertices.y)),
								g.drawPoly(p, 4, !0));
					if (s._debugBones) {
						for (
							g.setLineWidth(2),
								g.setDrawColor(255, 0, 0, 255),
								r = 0,
								o = l.bones.length;
							r < o;
							r++
						) {
							var y =
									(m = l.bones[r]).data.length * m.m00 +
									m.worldX,
								T = m.data.length * m.m10 + m.worldY;
							g.drawLine(cc.p(m.worldX, m.worldY), cc.p(y, T));
						}
						for (
							g.setPointSize(4),
								g.setDrawColor(0, 0, 255, 255),
								r = 0,
								o = l.bones.length;
							r < o;
							r++
						)
							(m = l.bones[r]),
								g.drawPoint(cc.p(m.worldX, m.worldY)),
								0 == r && g.setDrawColor(0, 255, 0, 255);
					}
					cc.kmGLPopMatrix();
				}
			}),
			(t._createChildFormSkeletonData = function () {}),
			(t._updateChild = function () {}),
			(t._updateRegionAttachmentQuad = function (t, e, i, n) {
				var r = {};
				t.computeVertices(
					e.bone.skeleton.x,
					e.bone.skeleton.y,
					e.bone,
					r
				);
				var o = e.bone.skeleton.r * e.r * 255,
					s = e.bone.skeleton.g * e.g * 255,
					c = e.bone.skeleton.b * e.b * 255,
					e = e.bone.skeleton.a * e.a;
				n && ((o *= e), (s *= e), (c *= e));
				e *= 255;
				(i.bl.colors.r =
					i.tl.colors.r =
					i.tr.colors.r =
					i.br.colors.r =
						o),
					(i.bl.colors.g =
						i.tl.colors.g =
						i.tr.colors.g =
						i.br.colors.g =
							s),
					(i.bl.colors.b =
						i.tl.colors.b =
						i.tr.colors.b =
						i.br.colors.b =
							c),
					(i.bl.colors.a =
						i.tl.colors.a =
						i.tr.colors.a =
						i.br.colors.a =
							e);
				e = sp.VERTEX_INDEX;
				(i.bl.vertices.x = r[e.X1]),
					(i.bl.vertices.y = r[e.Y1]),
					(i.tl.vertices.x = r[e.X2]),
					(i.tl.vertices.y = r[e.Y2]),
					(i.tr.vertices.x = r[e.X3]),
					(i.tr.vertices.y = r[e.Y3]),
					(i.br.vertices.x = r[e.X4]),
					(i.br.vertices.y = r[e.Y4]),
					(i.bl.texCoords.u = t.uvs[e.X1]),
					(i.bl.texCoords.v = t.uvs[e.Y1]),
					(i.tl.texCoords.u = t.uvs[e.X2]),
					(i.tl.texCoords.v = t.uvs[e.Y2]),
					(i.tr.texCoords.u = t.uvs[e.X3]),
					(i.tr.texCoords.v = t.uvs[e.Y3]),
					(i.br.texCoords.u = t.uvs[e.X4]),
					(i.br.texCoords.v = t.uvs[e.Y4]);
			}),
			(t._updateMeshAttachmentQuad = function (t, e, i, n) {
				var r = {};
				t.computeWorldVertices(e.bone.x, e.bone.y, e, r);
				var o = e.bone.skeleton.r * e.r * 255,
					s = e.bone.skeleton.g * e.g * 255,
					c = e.bone.skeleton.b * e.b * 255,
					e = e.bone.skeleton.a * e.a;
				n && ((o *= e), (s *= e), (c *= e));
				e *= 255;
				(i.bl.colors.r =
					i.tl.colors.r =
					i.tr.colors.r =
					i.br.colors.r =
						o),
					(i.bl.colors.g =
						i.tl.colors.g =
						i.tr.colors.g =
						i.br.colors.g =
							s),
					(i.bl.colors.b =
						i.tl.colors.b =
						i.tr.colors.b =
						i.br.colors.b =
							c),
					(i.bl.colors.a =
						i.tl.colors.a =
						i.tr.colors.a =
						i.br.colors.a =
							e);
				e = sp.VERTEX_INDEX;
				(i.bl.vertices.x = r[e.X1]),
					(i.bl.vertices.y = r[e.Y1]),
					(i.tl.vertices.x = r[e.X2]),
					(i.tl.vertices.y = r[e.Y2]),
					(i.tr.vertices.x = r[e.X3]),
					(i.tr.vertices.y = r[e.Y3]),
					(i.br.vertices.x = r[e.X4]),
					(i.br.vertices.y = r[e.Y4]),
					(i.bl.texCoords.u = t.uvs[e.X1]),
					(i.bl.texCoords.v = t.uvs[e.Y1]),
					(i.tl.texCoords.u = t.uvs[e.X2]),
					(i.tl.texCoords.v = t.uvs[e.Y2]),
					(i.tr.texCoords.u = t.uvs[e.X3]),
					(i.tr.texCoords.v = t.uvs[e.Y3]),
					(i.br.texCoords.u = t.uvs[e.X4]),
					(i.br.texCoords.v = t.uvs[e.Y4]);
			});
	})(),
	(function () {
		gaf.Sprite.WebGLRenderCmd = function (t) {
			cc.Sprite.WebGLRenderCmd.call(this, t),
				(this._defualtShader = cc.shaderCache.programForKey(
					cc.SHADER_POSITION_TEXTURECOLOR
				)),
				(this._customShader = gaf._Shaders.Alpha),
				(this._tintMult = null),
				(this._tintOffset = null),
				(this._ctxMatrixBody = null),
				(this._ctxMatrixAppendix = null);
		};
		var t = (gaf.Sprite.WebGLRenderCmd.prototype = Object.create(
			cc.Sprite.WebGLRenderCmd.prototype
		));
		(t.constructor = gaf.Sprite.WebGLRenderCmd),
			(t._identityVec = [1, 1, 1, 1]),
			(t._zeroVec = [0, 0, 0, 0]),
			(t._identityMat = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]),
			(t._disableCtx = function () {
				this.setShaderProgram(this._defualtShader);
			}),
			(t._enableCtx = function () {
				this.setShaderProgram(this._customShader);
			}),
			(t._applyCtxState = function (t) {
				var e = t._cascadeColorMult;
				this._tintMult = [e.r / 255, e.g / 255, e.b / 255, e.a / 255];
				e = t._cascadeColorOffset;
				this._tintOffset = [e.r / 255, e.g / 255, e.b / 255, e.a / 255];
				t = t._filterStack;
				t && 0 < t.length && t[0].type === gaf.EFFECT_COLOR_MATRIX
					? ((t = t[0].colorMatrix),
					  (this._ctxMatrixBody = [
							t.rr,
							t.rg,
							t.rb,
							t.ra,
							t.gr,
							t.gg,
							t.gb,
							t.ga,
							t.br,
							t.bg,
							t.bb,
							t.ba,
							t.ar,
							t.ag,
							t.ab,
							t.aa,
					  ]),
					  (this._ctxMatrixAppendix = [
							t.r / 255,
							t.g / 255,
							t.b / 255,
							t.a / 255,
					  ]))
					: ((this._ctxMatrixBody = null),
					  (this._ctxMatrixAppendix = null));
			}),
			(t._setUniforms = function () {
				this._shaderProgram === this._customShader &&
					(this._shaderProgram.use(),
					this._shaderProgram.setUniformLocationWith4fv(
						gaf._Uniforms.ColorTransformMult,
						this._tintMult,
						1
					),
					this._shaderProgram.setUniformLocationWith4fv(
						gaf._Uniforms.ColorTransformOffset,
						this._tintOffset,
						1
					),
					this._ctxMatrixBody && this._ctxMatrixAppendix
						? (this._shaderProgram.setUniformLocationWithMatrix4fv(
								gaf._Uniforms.ColorMatrixBody,
								this._ctxMatrixBody,
								1
						  ),
						  this._shaderProgram.setUniformLocationWith4fv(
								gaf._Uniforms.ColorMatrixAppendix,
								this._ctxMatrixAppendix,
								1
						  ))
						: (this._shaderProgram.setUniformLocationWithMatrix4fv(
								gaf._Uniforms.ColorMatrixBody,
								this._identityMat,
								1
						  ),
						  this._shaderProgram.setUniformLocationWith4fv(
								gaf._Uniforms.ColorMatrixAppendix,
								this._zeroVec,
								1
						  )));
			}),
			(t.rendering = function (t) {
				this._setUniforms(),
					cc.Sprite.WebGLRenderCmd.prototype.rendering.call(this, t);
			});
	})();
var cc,
	ChooseScene = cc.Scene.extend({
		ctor: function () {
			this._super(), this.init();
		},
		init: function () {
			this._super(),
				(this.move_tool = null),
				(this.isTouchOn = !1),
				this.scheduleOnce(
					function () {
						this.setTouchEnable();
					},
					0.1,
					'setTouchEnable'
				),
				(isFirstSctory = !0),
				(this.Choose_Bg = cc.Sprite.create('RES/CS/CS_bg.png')),
				this.Choose_Bg.setPosition(
					comman.winSize().width / 2,
					comman.winSize().height / 2
				),
				this.Choose_Bg.setScale(1),
				this.addChild(this.Choose_Bg),
				(this.Level_ = []),
				(this.Level_pos = [
					cc.p(270.59, 363.54),
					cc.p(520.52, 362.51),
					cc.p(150.79, 135.3),
					cc.p(404.85, 127.03),
					cc.p(648.59, 150.79),
				]);
			for (var e = 0; e < 5; e++) {
				(this.Level_[e] = cc.MenuItemImage.create(
					'RES/CS/btn_' + (e + 1) + '.png',
					'RES/CS/btn_' + (e + 1) + '.png',
					'RES/CS/btn_' + (e + 1) + '_1.png',
					this.onBtnClick,
					this
				)),
					this.Level_[e].setScale(1),
					this.Level_[e].setTag(e + 1),
					this.Level_[e].setPosition(this.Level_pos[e]);
				var t = cc.Sprite.create('RES/CB/Watch_Reward.png');
				t.setScale(0.7),
					t.setName('rads'),
					t.setPosition(
						cc.p(
							0.8 * this.Level_[e].getContentSize().width,
							0.2 * this.Level_[e].getContentSize().height
						)
					),
					t.setVisible(!1),
					this.Level_[e].addChild(t),
					completedLevels.includes(e + 1) &&
						this.Level_[e].setEnabled(!1),
					1 == this.Level_[e].isEnabled() &&
						((1 != e && 4 != e) || t.setVisible(!0));
			}
			(this.Level_menu = cc.Menu.create(this.Level_)),
				this.Level_menu.setPosition(cc.p(0, 0)),
				this.addChild(this.Level_menu),
				(this.btn_bb_icon = cc.MenuItemImage.create(
					res_comman.bb_icon_3,
					res_comman.bb_icon_3,
					this.onMoreApp,
					this
				)),
				this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
				this.btn_bb_icon.setScale(1.1),
				this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
				(this.btn_next = cc.MenuItemImage.create(
					res_common_button.btn_done,
					res_common_button.btn_done,
					this.NextButtonClick,
					this
				)),
				this.btn_next.setScale(1),
				this.btn_next.setTag(101),
				this.btn_next.setPosition(
					cc.p(
						comman.winSize().width -
							-1.5 * this.btn_next.getContentSize().width,
						0.55 * this.btn_next.getContentSize().height
					)
				),
				5 <= completedLevels.length &&
					this.btn_next.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.25),
							cc.MoveTo.create(
								0.5,
								cc.p(
									comman.winSize().width -
										0.55 *
											this.btn_next.getContentSize()
												.width,
									0.55 * this.btn_next.getContentSize().height
								)
							)
						)
					),
				(this.btn_more = cc.MenuItemImage.create(
					res_common_button.btn_more,
					res_common_button.btn_more,
					this.onMoreApp,
					this
				)),
				this.btn_more.setScale(1),
				this.btn_more.setTag(101),
				this.btn_more.setPosition(
					cc.p(
						comman.winSize().width -
							1.6 * this.btn_more.getContentSize().width,
						comman.winSize().height +
							0.55 * this.btn_more.getContentSize().height
					)
				),
				this.btn_more.runAction(
					cc.Sequence.create(
						cc.DelayTime.create(0.25),
						cc.MoveTo.create(
							0.5,
							cc.p(
								this.btn_more.getPositionX(),
								comman.winSize().height -
									0.55 * this.btn_more.getContentSize().height
							)
						)
					)
				),
				(this.btn_music = cc.MenuItemImage.create(
					res_mainScene.btn_soundOn,
					res_mainScene.btn_soundOn,
					this.onMusicButton,
					this
				)),
				this.btn_music.setScale(1),
				this.btn_music.setPosition(
					cc.p(
						comman.winSize().width -
							0.55 * this.btn_music.getContentSize().width,
						comman.winSize().height -
							0.55 * this.btn_music.getContentSize().height
					)
				),
				comman.isMusicEnable
					? comman.isMusicEnable &&
					  (this.btn_music.setNormalSpriteFrame(
							res_mainScene.btn_soundOn
					  ),
					  this.btn_music.setSelectedSpriteFrame(
							res_mainScene.btn_soundOn
					  ))
					: (this.btn_music.setNormalSpriteFrame(
							res_mainScene.btn_soundOff
					  ),
					  this.btn_music.setSelectedSpriteFrame(
							res_mainScene.btn_soundOff
					  )),
				(this.MainMenu = cc.Menu.create(
					this.btn_bb_icon,
					this.btn_more,
					this.btn_music,
					this.btn_next
				)),
				this.MainMenu.setPosition(cc.p(0, 0)),
				this.addChild(this.MainMenu, 5),
				(this.prt_Sparkle = cc.ParticleSystem.create(
					res_comman.sparkle_1_plist
				)),
				this.prt_Sparkle.setScale(1),
				this.prt_Sparkle.stopSystem(),
				this.addChild(this.prt_Sparkle, 5);
		},
		updateRewardAds: function () {
			1 == comman.isRewardAdComplete
				? (this.rewardItem.getChildByName('rads').setVisible(!1),
				  this.onBtnClick(this.rewardItem),
				  (this.rewardItem = null),
				  (comman.isRewardAdComplete = !1),
				  (comman.isRewardAdFailed = !1),
				  this.unschedule(this.updateRewardAds))
				: 1 == comman.isRewardAdFailed &&
				  ((this.rewardItem = null),
				  (comman.isRewardAdComplete = !1),
				  (comman.isRewardAdFailed = !1),
				  this.unschedule(this.updateRewardAds));
		},
		onBtnClick: function (e) {
			0 != this.isTouchOn &&
				(0 == e.getChildByName('rads').isVisible()
					? (e.stopAllActions(),
					  e.runAction(
							cc.Sequence.create(
								cc.ScaleTo.create(0.2, 0.9),
								cc.ScaleTo.create(0.2, 1)
							)
					  ),
					  (this.isTouchOn = !1),
					  (selectedLevels = e.getTag()),
					  this.scheduleOnce(
							function () {
								this.onNextScene1();
							},
							0.1,
							'onNextScene1'
					  ))
					: 1 == comman.canShowReward()
					? ((this.rewardItem = e),
					  comman.showRewardad(),
					  this.unschedule(this.updateRewardAds),
					  this.schedule(this.updateRewardAds))
					: comman.showRewardFailedPopup(this));
		},
		NextButtonClick: function (e) {
			0 != this.isTouchOn &&
				101 == e.getTag() &&
				0 == e.getNumberOfRunningActions() &&
				((this.isTouchOn = !1),
				this.scheduleOnce(
					function () {
						this.onNextScene();
					},
					0.1,
					'onNextScene'
				));
		},
		setTouchEnable: function () {
			this.isTouchOn = !0;
		},
		onEnter: function () {
			this._super(),
				cc.eventManager.addListener(
					{
						event: cc.EventListener.TOUCH_ONE_BY_ONE,
						swallowTouches: !0,
						onTouchBegan: this.onTouchBegan,
						onTouchMoved: this.onTouchMoved,
						onTouchEnded: this.onTouchEnded,
					},
					this
				),
				'mouse' in cc.sys.capabilities &&
					cc.eventManager.addListener(
						{
							event: cc.EventListener.MOUSE,
							onMouseMove: this.onMouseMove,
						},
						this
					);
		},
		buttonSelectedAction: function (e) {
			var t = e.getScale();
			e.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1 * t),
						cc.ScaleTo.create(0.5, t)
					)
				)
			);
		},
		onMouseMove: function (e) {
			var t = e.getLocation(),
				c = e.getCurrentTarget();
			if (
				cc.rectContainsPoint(c.btn_more.getBoundingBox(), t) &&
				1 == c.btn_more.getScale() &&
				0 == c.btn_more.getNumberOfRunningActions()
			)
				c.prt_Sparkle.setPosition(c.btn_more.getPosition()),
					c.prt_Sparkle.resetSystem(),
					c.btn_more.setScale(1.1);
			else if (
				1.1 != c.btn_more.getScale() ||
				cc.rectContainsPoint(c.btn_more.getBoundingBox(), t) ||
				0 != c.btn_more.getNumberOfRunningActions()
			)
				if (
					cc.rectContainsPoint(c.btn_next.getBoundingBox(), t) &&
					1 == c.btn_next.getScale() &&
					0 == c.btn_next.getNumberOfRunningActions()
				)
					c.prt_Sparkle.setPosition(c.btn_next.getPosition()),
						c.prt_Sparkle.resetSystem(),
						c.btn_next.setScale(1.05);
				else if (
					1.05 != c.btn_next.getScale() ||
					cc.rectContainsPoint(c.btn_next.getBoundingBox(), t) ||
					0 != c.btn_next.getNumberOfRunningActions()
				) {
					if (c.Level_)
						for (var a = 0; a < c.Level_.length; a++)
							1 == c.Level_[a].isEnabled() &&
							cc.rectContainsPoint(
								c.Level_[a].getBoundingBox(),
								t
							) &&
							1 == c.Level_[a].getScale() &&
							0 == c.Level_[a].getNumberOfRunningActions()
								? (c.prt_Sparkle.setPosition(
										c.Level_[a].getPosition()
								  ),
								  c.prt_Sparkle.resetSystem(),
								  c.Level_[a].setScale(1.05))
								: 1 != c.Level_[a].isEnabled() ||
								  1.05 != c.Level_[a].getScale() ||
								  cc.rectContainsPoint(
										c.Level_[a].getBoundingBox(),
										t
								  ) ||
								  0 !=
										c.Level_[
											a
										].getNumberOfRunningActions() ||
								  c.Level_[a].setScale(1);
				} else c.btn_next.setScale(1);
			else c.btn_more.setScale(1);
		},
		onTouchBegan: function (e, t) {
			(e = e.getLocation()), (t = t.getCurrentTarget());
			if (((t.startLocation = e), 0 != t.isTouchOn)) return !0;
		},
		onTouchMoved: function (e, t) {
			(e = e.getLocation()), (t = t.getCurrentTarget());
			null != t.move_tool && t.move_tool.setPosition(e.x, e.y);
		},
		onTouchEnded: function (e, t) {
			e.getLocation(), t.getCurrentTarget();
		},
		onMoreApp: function (e) {
			101 == e.getTag()
				? CreateLinksInGame(comman.GameId, 'game', 'more')
				: CreateLinksInGame(comman.GameId, 'game', 'logo');
		},
		onPlayButton: function (e) {
			this.scheduleOnce(
				function () {
					this.onNextScene();
				},
				0.1,
				'onNextScene'
			);
		},
		onMusicButton: function (e) {
			0 == e.getNumberOfRunningActions() &&
				(e.stopAllActions(),
				e.runAction(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.ScaleTo.create(0.2, 0.9),
						cc.ScaleTo.create(0.2, 1)
					)
				),
				comman.isMusicEnable
					? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
					  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
					  comman.setSoundEnabled(!1))
					: comman.isMusicEnable ||
					  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
					  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
					  comman.setSoundEnabled(!0)));
		},
		onNextScene: function () {
			comman.stopAllEffect(),
				comman.showInterstitial(),
				cc.director.runScene(GameOverScene.scene());
		},
		onNextScene1: function () {
			switch (
				(comman.stopAllEffect(),
				comman.showInterstitial(),
				completedLevels.push(selectedLevels),
				selectedLevels)
			) {
				case 1:
					cc.director.runScene(PlayScene_1.scene());
					break;
				case 2:
					cc.director.runScene(PlayScene_2.scene());
					break;
				case 3:
					cc.director.runScene(PlayScene_3.scene());
					break;
				case 4:
					cc.director.runScene(PlayScene_4.scene());
					break;
				case 5:
					cc.director.runScene(PlayScene_5.scene());
			}
		},
	}),
	comman = {
		GameName: 'Baby Panda House Cleaning',
		GameId: 'Baby-Panda-House-Cleaning',
		isLoadFisrtTime: 0,
		isMusicEnable: !0,
		isMusicLevelEnable: !0,
		isGameRunningEnable: !0,
		_lastMusic: null,
		selectedLevel: 1,
		InterstitialTime: 0,
		isRewardAdComplete: !(ChooseScene.scene = function () {
			var e = new cc.Scene(),
				t = new ChooseScene();
			return e.addChild(t), e;
		}),
		isRewardAdFailed: !1,
		rewardFailedPopup: null,
	},
	safari_lbl_pos_diff = 0,
	selectedLevels = 1,
	selectedChar = 1,
	selectedSubLevels = 2,
	selectedSubSubLevels = 1,
	selectedItem = 1,
	createdItem = null,
	isSinkSoundOn = !1,
	isOnLevelScene = !1,
	currentCarColor = 1,
	outOfScreen = cc.p(1e4, 1e4),
	totalLevelsPlay = 0,
	completedLevels = [];
function eventInTransparentMask(e, t, c) {
	(c = c || 30),
		e.mask ||
			(e.mask = cc.render.util.getAlphaChannel(
				e._texture._htmlElementObj
			));
	var a = e.convertToNodeSpace(t),
		t = a.x >> 0,
		a = a.y >> 0,
		a = t + (e._texture.height - a) * e._texture.width;
	return e.mask[a] <= c;
}
function eventInTransparentMask1(e, t, c) {
	(c = c || 30),
		(e.mask = cc.render.util.getAlphaChannel(e._texture._htmlElementObj));
	var a = e.convertToNodeSpace(t),
		t = a.x >> 0,
		a = a.y >> 0,
		a = t + (e._texture.height - a) * e._texture.width;
	return e.mask[a] <= c;
}
(comman.preloadAllSound = function () {}),
	(comman.Hide_Sloat = function (e, t) {
		t = e._skeleton.findSlot(t);
		null != t && (t.a = 0);
	}),
	(comman.Show_Sloat = function (e, t) {
		t = e._skeleton.findSlot(t);
		null != t && (t.a = 1);
	}),
	(comman.GetAnimatonDuration = function (e, t) {
		return e._skeleton.data.findAnimation(t).duration;
	}),
	(comman.GetSloat = function (e, t) {
		return e._skeleton.findSlot(t);
	}),
	(comman.GelCurAnimationName = function (e, t) {
		return e.getState().getCurrent(t).animation.name;
	}),
	(comman.Sloat_opecity = function (e, t, c) {
		t = e._skeleton.findSlot(t);
		0 <= t.a ? (t.a = c) : (t.a = 0);
	}),
	(comman.Get_Sloat_opecity = function (e, t) {
		return e._skeleton.findSlot(t).a;
	}),
	(comman.downSloatOpacity = function (e, t, c) {
		t = e._skeleton.findSlot(t);
		(t.a = t.a + c), t.a < 0 && (t.a = 0);
	}),
	(comman.getRandomInt = function (e, t) {
		return Math.floor(Math.random() * (t - e + 1)) + e;
	}),
	(comman.getRandomFloat = function (e, t) {
		return Math.random() * (t - e) + e;
	}),
	(comman.ganerateUniqueSequence = function (e, t, c) {
		for (var a = [], o = 1; o <= c; o++)
			for (;;) {
				var n = comman.getRandomInt(e, t);
				if (!a.includes(n)) {
					a.push(n);
					break;
				}
			}
		return a;
	}),
	(comman.arrayRemoveValue = function (e, t) {
		return e.filter(function (e) {
			return e != t;
		});
	}),
	(comman.arrayRemoveIndex = function (e, t) {
		return e.splice(t, 1);
	}),
	(comman.winSize = function () {
		return cc.director.getWinSize();
	}),
	(comman.playMusic = function (e, t, c) {
		var a = cc.audioEngine;
		a.stopMusic(!0 === c),
			cc.audioEngine.setMusicVolume(0.1),
			comman.isMusicEnable ? a.playMusic(e, t) : (comman._lastMusic = e);
	}),
	(comman.stopAllEffect = function () {
		cc.audioEngine.stopAllEffects(),
			1 == isSinkSoundOn &&
				1 == isOnLevelScene &&
				comman.playEffect1(res_sound.Sink_Water);
	}),
	(comman.playEffect = function (e) {
		1 == comman.isMusicEnable && cc.audioEngine.playEffect(e, !1);
	}),
	(comman.playEffect1 = function (e) {
		1 == comman.isMusicEnable && cc.audioEngine.playEffect(e, !0);
	}),
	(comman.preloadEffect = function (e) {
		cc.audioEngine.preloadEffect(e);
	}),
	(comman.setSoundEnabled = function (e) {
		var t;
		comman.isMusicEnable != e &&
			((comman.isMusicEnable = e),
			(t = cc.audioEngine),
			1 == comman.isMusicLevelEnable &&
				(e
					? (t.resumeMusic(), t.setEffectsVolume(1))
					: (t.pauseMusic(), t.setEffectsVolume(0))));
	}),
	(comman.resetInterstitialTime = function () {
		comman.InterstitialTime = new Date().getTime();
	}),
	(comman.showInterstitial = function () {
    console.log("请求插屏广告");

    // 展示插屏广告
    HUHU_showInterstitialAd();

    // 继续游戏
    (comman.isMusicLevelEnable = !0),
    this.restoreSound(),
    this.resumeGame(),
    this.resetInterstitialTime();
		// YYGGames.showInterstitial({
		// 	beforeShowAd: () => {
		// 		(comman.isMusicLevelEnable = !1),
		// 			this.muteSound(),
		// 			this.pauseGame();
		// 	},
		// 	afterShowAd: () => {
		// 		(comman.isMusicLevelEnable = !0),
		// 			this.restoreSound(),
		// 			this.resumeGame(),
		// 			this.resetInterstitialTime();
		// 	},
		// });
	}),
	(comman.onInterstitialSuccessCallback = function () {
		(comman.isMusicLevelEnable = !0),
			this.restoreSound(),
			this.resetInterstitialTime(),
			this.resumeGame();
	}),
	(comman.onInterstitialFailCallback = function () {
		(comman.isMusicLevelEnable = !0),
			this.restoreSound(),
			this.resumeGame();
	}),
	(comman.showRewardad = function () {
		YYGGames.showReward({
			beforeShowAd: () => {
				(comman.isMusicLevelEnable = !1),
					this.muteSound(),
					this.pauseGame();
			},
			afterShowAd: () => {
				(comman.isMusicLevelEnable = !0),
					this.restoreSound(),
					this.resumeGame();
			},
			rewardComplete: () => {
				(comman.isMusicLevelEnable = !0),
					this.giveUserReward(),
					this.restoreSound(),
					this.resumeGame();
			},
			rewardDismissed: () => {
				(comman.isRewardAdFailed = !0),
					(comman.isMusicLevelEnable = !0),
					this.restoreSound(),
					this.resumeGame();
			},
		});
	}),
	(comman.showRewardFailedPopup = function (e) {
		(comman.rewardFailedPopup = cc.MenuItemImage.create(
			'RES/CB/PopupBG.png',
			'RES/CB/PopupBG.png'
		)),
			comman.rewardFailedPopup.setPosition(cc.p(400, 252)),
			comman.rewardFailedPopup.setLocalZOrder(1e3),
			comman.rewardFailedPopup.setScale(1);
		var t = cc.Menu.create(comman.rewardFailedPopup);
		t.setPosition(cc.p(0, 0)), e.addChild(t, 1e4);
		e = cc.Sprite.create('RES/CB/Popup.png');
		e.setPosition(cc.p(400, 252)),
			e.setScale(1),
			comman.rewardFailedPopup.addChild(e, 11);
		t = cc.MenuItemImage.create(
			'RES/CB/btn_close.png',
			'RES/CB/btn_close.png',
			function (e) {
				comman.rewardFailedPopup.removeFromParent(),
					(comman.rewardFailedPopup = null);
			},
			comman
		);
		t.setScale(1),
			t.setTag(101),
			t.setPosition(
				cc.p(
					0.95 * e.getContentSize().width,
					0.95 * e.getContentSize().height
				)
			);
		t = cc.Menu.create(t);
		t.setPosition(cc.p(0, 0)), e.addChild(t, 5);
	}),
	(comman.onRewardSuccessCallback = function () {
		(comman.isMusicLevelEnable = !0),
			this.giveUserReward(),
			this.restoreSound(),
			this.resumeGame();
	}),
	(comman.onRewardFailCallback = function () {
		(comman.isRewardAdFailed = !0),
			(comman.isMusicLevelEnable = !0),
			this.restoreSound(),
			this.resumeGame();
	}),
	(comman.canShowReward = function () {

		// return YYGGames.canShowReward();
	}),
	(comman.giveUserReward = function () {
		comman.isRewardAdComplete = !0;
	}),
	(comman.restoreSound = function () {
		1 == comman.isGameRunningEnable &&
			(1 == comman.isMusicEnable &&
				1 == comman.isMusicLevelEnable &&
				cc.audioEngine.resumeMusic(),
			cc.audioEngine.resumeAllEffects(),
			cc.audioEngine.setEffectsVolume(1));
	}),
	(comman.muteSound = function () {
		1 == comman.isGameRunningEnable &&
			(cc.audioEngine.pauseMusic(),
			cc.audioEngine.pauseAllEffects(),
			cc.audioEngine.setEffectsVolume(0));
	}),
	(comman.pauseGame = function () {
		1 == comman.isGameRunningEnable && cc.director.pause();
	}),
	(comman.resumeGame = function () {
		1 == comman.isGameRunningEnable &&
			1 == comman.isMusicLevelEnable &&
			cc.director.resume();
	}),
	(function (e) {
		function t(e, t) {
			var c = null,
				a = null;
			return (
				e instanceof HTMLCanvasElement
					? (a = (c = e).getContext('2d'))
					: (a = (c = o(e.width, e.height)).getContext(
							'2d'
					  )).drawImage(e, 0, 0),
				n(
					a.getImageData(0, 0, c.width, c.height).data,
					c.width,
					c.height,
					3
				)
			);
		}
		function o(e, t) {
			var c = document.createElement('canvas');
			return (c.width = e), (c.height = t), c;
		}
		function n(e, t, c, a) {
			for (
				var o = new (
						'undefined' != typeof Uint8Array ? Uint8Array : Array
					)(t * c),
					n = 0,
					i = 0;
				i < e.length;
				i += 4
			)
				o[n++] = e[i + a];
			return o;
		}
		((e =
			(e = e.render || (e.render = {})).util ||
			(e.util = {})).getAlphaChannel = function (e) {
			return t(e);
		}),
			(e.getRedChannel = function (e) {
				return t(e);
			}),
			(e.getGreenChannel = function (e) {
				return t(e);
			}),
			(e.getBlueChannel = function (e) {
				return t(e);
			}),
			(e.getChannel = t),
			(e.createCanvas = o),
			(e.extractChannel = n);
	})((cc = cc || {}));
var GameOverScene = cc.Scene.extend({
	ctor: function () {
		this._super(), this.init();
	},
	init: function () {
		this._super(),
			(this.move_tool = null),
			(this.lyl_bg = cc.Layer.create()),
			this.addChild(this.lyl_bg),
			(this.bg = cc.Sprite.create('RES/GA/GA_BG.png')),
			this.bg.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.bg.setScale(1),
			this.lyl_bg.addChild(this.bg),
			this.createMainMenu(),
			this.scheduleOnce(
				function () {
					this.onDoneScreen();
				},
				1.5,
				'onDoneScreen'
			),
			(this.prt_Sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_1_plist
			)),
			this.prt_Sparkle.setScale(1),
			this.prt_Sparkle.stopSystem(),
			this.addChild(this.prt_Sparkle, 11);
	},
	onDoneScreen: function () {
		this.btn_replay.stopAllActions(),
			this.btn_more.stopAllActions(),
			this.btn_relatedGames.stopAllActions(),
			this.btn_more.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackOut.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								0.75 * this.btn_more.getContentSize().width,
								55
							)
						)
					)
				)
			),
			this.btn_replay.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackOut.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								comman.winSize().width -
									0.75 *
										this.btn_replay.getContentSize().width,
								55
							)
						)
					)
				)
			),
			this.btn_relatedGames.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackOut.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								0.33 * comman.winSize().width,
								0.52 *
									this.btn_relatedGames.getContentSize()
										.height
							)
						)
					)
				)
			);
	},
	onTouchBegan: function (e, t) {
		e.getLocation(), t.getCurrentTarget();
		return !0;
	},
	onTouchMoved: function (e, t) {
		(e = e.getLocation()), (t = t.getCurrentTarget());
		null != t.move_tool && t.move_tool.setPosition(e);
	},
	onTouchEnded: function (e, t) {
		e.getLocation(), t.getCurrentTarget();
	},
	onNextScene: function () {
		comman.stopAllEffect(),
			comman.showInterstitial(),
			(completedLevels = []),
			(selectedLevels = 1),
			cc.director.runScene(ChooseScene.scene());
	},
	onEnter: function () {
		this._super(),
			cc.eventManager.addListener(
				{
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this.onTouchBegan,
					onTouchMoved: this.onTouchMoved,
					onTouchEnded: this.onTouchEnded,
				},
				this
			),
			'mouse' in cc.sys.capabilities &&
				cc.eventManager.addListener(
					{
						event: cc.EventListener.MOUSE,
						onMouseMove: this.onMouseMove,
					},
					this
				);
	},
	onMouseMove: function (e) {
		var t = e.getLocation(),
			e = e.getCurrentTarget();
		cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) &&
		1 == e.btn_more.getScale() &&
		0 == e.btn_more.getNumberOfRunningActions()
			? (e.prt_Sparkle.setPosition(e.btn_more.getPosition()),
			  e.prt_Sparkle.resetSystem(),
			  e.btn_more.setScale(1.05))
			: 1.05 != e.btn_more.getScale() ||
			  cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) ||
			  0 != e.btn_more.getNumberOfRunningActions()
			? cc.rectContainsPoint(e.btn_replay.getBoundingBox(), t) &&
			  1 == e.btn_replay.getScale() &&
			  0 == e.btn_replay.getNumberOfRunningActions()
				? (e.prt_Sparkle.setPosition(e.btn_replay.getPosition()),
				  e.prt_Sparkle.resetSystem(),
				  e.btn_replay.setScale(1.05))
				: 1.05 != e.btn_replay.getScale() ||
				  cc.rectContainsPoint(e.btn_replay.getBoundingBox(), t) ||
				  0 != e.btn_replay.getNumberOfRunningActions() ||
				  e.btn_replay.setScale(1)
			: e.btn_more.setScale(1);
	},
	onMoreApp: function (e) {
		101 == e.getTag()
			? CreateLinksInGame(comman.GameId, 'gameoverscene', 'more')
			: CreateLinksInGame(comman.GameId, 'gameoverscene', 'logo');
	},
	onRelatedGames: function (e) {
		CreateLinksInGame(
			comman.GameId,
			'gameoverscene',
			'relatedgames',
			RelatedGames[e.getTag()].id
		);
	},
	onReplayButton: function (e) {
		0 != this.isTouchOn &&
			0 == e.getNumberOfRunningActions() &&
			(e.setEnabled(!1),
			this.scheduleOnce(
				function () {
					this.onNextScene();
				},
				0.1,
				'onNextScene'
			));
	},
	onMusicButton: function (e) {
		0 == e.getNumberOfRunningActions() &&
			(e.stopAllActions(),
			e.runAction(
				cc.Sequence.create(
					cc.ScaleTo.create(0, 1),
					cc.ScaleTo.create(0.2, 0.9),
					cc.ScaleTo.create(0.2, 1)
				)
			),
			comman.isMusicEnable
				? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
				  comman.setSoundEnabled(!1))
				: comman.isMusicEnable ||
				  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
				  comman.setSoundEnabled(!0)));
	},
	createMainMenu: function () {
		(this.btn_bb_icon = cc.MenuItemImage.create(
			res_comman.bb_icon_3,
			res_comman.bb_icon_3,
			this.onMoreApp,
			this
		)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_more = cc.MenuItemImage.create(
				res_mainScene.btn_more,
				res_mainScene.btn_more,
				this.onMoreApp,
				this
			)),
			this.btn_more.setScale(1),
			this.btn_more.setTag(101),
			this.btn_more.setPosition(
				cc.p(
					0.75 * this.btn_more.getContentSize().width,
					-1 * this.btn_more.getContentSize().height
				)
			),
			(this.btn_replay = cc.MenuItemImage.create(
				res_mainScene.btn_replay,
				res_mainScene.btn_replay,
				this.onReplayButton,
				this
			)),
			this.btn_replay.setScale(1),
			this.btn_replay.setPosition(
				cc.p(
					comman.winSize().width -
						0.75 * this.btn_replay.getContentSize().width,
					-1 * this.btn_replay.getContentSize().height
				)
			),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.55 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.55 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  ));
		var e = this.getRandomInt(0, RelatedGames.length - 1);
		(this.btn_relatedGames = cc.MenuItemImage.create(
			res_comman.logo_bg,
			res_comman.logo_bg,
			this.onRelatedGames,
			this
		)),
			this.btn_relatedGames.setScale(1),
			this.btn_relatedGames.setTag(e),
			this.btn_relatedGames.setPosition(
				cc.p(
					0.33 * comman.winSize().width,
					-0.7 * comman.winSize().height
				)
			),
			(this.relatedGames_Img = cc.Sprite.create(
				res_resource[res_resource.length - RelatedGames.length + e]
			)),
			this.relatedGames_Img.setScaleX(
				(this.btn_relatedGames.getContentSize().width - 40) /
					this.relatedGames_Img.getContentSize().width
			),
			this.relatedGames_Img.setScaleY(
				(this.btn_relatedGames.getContentSize().height - 40) /
					this.relatedGames_Img.getContentSize().height
			),
			this.relatedGames_Img.setPosition(
				this.btn_relatedGames.getContentSize().width / 2,
				this.btn_relatedGames.getContentSize().height / 2
			),
			this.btn_relatedGames.addChild(this.relatedGames_Img, -1),
			(this.MainMenu = cc.Menu.create(
				this.btn_bb_icon,
				this.btn_more,
				this.btn_replay,
				this.btn_music,
				this.btn_relatedGames
			)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 10);
	},
	getRandomInt: function (e, t) {
		return Math.floor(Math.random() * (t - e + 1)) + e;
	},
});
GameOverScene.scene = function () {
	var e = new cc.Scene(),
		t = new GameOverScene();
	return e.addChild(t), e;
};
var i,
	res_resource = [],
	res_comman = {
		bb_icon_3: '',
		bg_sound: 'RES/CI/bg_sound.mp3',
		sparkle_1_plist: 'RES/CI/Sparkle_1.plist',
		sparkle_2_plist: 'RES/CI/Sparkle_2.plist',
		fallingConfeti_plist: 'RES/CI/fallingConfeti.plist',
		particle_star: 'RES/CI/particle_star.png',
		logo_bg: 'RES/COM/logo_bg.png',
		bg_white: 'RES/COM/bg_white.png',
	};
for (i in res_comman) res_resource.push(res_comman[i]);
var res_mainScene = {
	btn_more: 'RES/MS/main_btnMore.png',
	btn_soundOff: 'RES/MS/main_btnMusicOff.png',
	btn_soundOn: 'RES/MS/main_btnMusicOn.png',
	btn_play: 'RES/MS/main_btnPlay.png',
	btn_replay: 'RES/MS/main_btnReplay.png',
	main_BG: 'RES/MS/main_BG.png',
	Title: 'RES/MS/Title.png',
};
for (i in res_mainScene) res_resource.push(res_mainScene[i]);
var res_choosescene = { CS_bg: 'RES/CS/CS_bg.png' };
for (i in res_choosescene) res_resource.push(res_choosescene[i]);
for (var j = 1; j <= 5; j++)
	res_resource.push('RES/CS/btn_' + j + '.png'),
		res_resource.push('RES/CS/btn_' + j + '_1.png');
var res_playscene_anim = {
	Big_Panda_png: 'RES/PA/anim/Big_Panda.png',
	Big_Panda_json: 'RES/PA/anim/Big_Panda.json',
	Big_Panda_atlas: 'RES/PA/anim/Big_Panda.atlas',
	Cat_png: 'RES/PA/anim/Cat.png',
	Cat_json: 'RES/PA/anim/Cat.json',
	Cat_atlas: 'RES/PA/anim/Cat.atlas',
	Dog_png: 'RES/PA/anim/Dog.png',
	Dog_json: 'RES/PA/anim/Dog.json',
	Dog_atlas: 'RES/PA/anim/Dog.atlas',
	Panda_png: 'RES/PA/anim/Panda.png',
	Panda_json: 'RES/PA/anim/Panda.json',
	Panda_atlas: 'RES/PA/anim/Panda.atlas',
};
for (i in res_playscene_anim) res_resource.push(res_playscene_anim[i]);
var res_playscene1 = {
	Masin_Panda_png: 'RES/PA/1/Masin_Panda.png',
	Masin_Panda_json: 'RES/PA/1/Masin_Panda.json',
	Masin_Panda_atlas: 'RES/PA/1/Masin_Panda.atlas',
	pa2_Basket: 'RES/PA/1/pa2_Basket.png',
	pa2_Supdi: 'RES/PA/1/pa2_Supdi.png',
	pa2_Broom: 'RES/PA/1/pa2_Broom.png',
	pa2_Dhaglo: 'RES/PA/1/pa2_Dhaglo.png',
	pa2_Slove: 'RES/PA/1/pa2_Slove.png',
	pa2_Tree: 'RES/PA/1/pa2_Tree.png',
	pa2_Tree_Move: 'RES/PA/1/pa2_Tree_Move.png',
	pa2_Stand: 'RES/PA/1/pa2_Stand.png',
	pa2_Stand_Up: 'RES/PA/1/pa2_Stand_Up.png',
	pa2_Stand_Move: 'RES/PA/1/pa2_Stand_Move.png',
	pa3_Plant: 'RES/PA/1/pa3_Plant.png',
	pa3_Kunjo: 'RES/PA/1/pa3_Kunjo.png',
	pa3_Bottle: 'RES/PA/1/pa3_Bottle.png',
	pa3_Bottle_Up: 'RES/PA/1/pa3_Bottle_Up.png',
	pa3_Seed: 'RES/PA/1/pa3_Seed.png',
	pa3_Basket: 'RES/PA/1/pa3_Basket.png',
	pa3_Basket_Up: 'RES/PA/1/pa3_Basket_Up.png',
	pa3_Starw: 'RES/PA/1/pa3_Starw.png',
};
for (i in res_playscene1) res_resource.push(res_playscene1[i]);
for (j = 1; j <= 30; j++)
	j <= 2 &&
		(res_resource.push('RES/PA/1/Bg_' + j + '.png'),
		res_resource.push('RES/PA/1/pa3_Pakkad_1_' + j + '.png'),
		res_resource.push('RES/PA/1/pa3_Seed_Flow_' + j + '.png')),
		j <= 3 &&
			(res_resource.push('RES/PA/1/pa2_Stamb_' + j + '.png'),
			res_resource.push('RES/PA/1/pa2_Stamb_Move_' + j + '.png'),
			res_resource.push('RES/PA/1/pa3_Leaf_' + j + '.png'),
			res_resource.push('RES/PA/1/pa3_Leaf_1_Dirty_' + j + '.png'),
			res_resource.push('RES/PA/1/pa3_Leaf_2_Dirty_' + j + '.png'),
			res_resource.push('RES/PA/1/pa3_Leaf_3_Dirty_' + j + '.png')),
		j <= 4 &&
			(res_resource.push('RES/PA/1/pa2_Hole_' + j + '.png'),
			res_resource.push('RES/PA/1/pa2_Dhaglo_Done_' + j + '.png'),
			res_resource.push('RES/PA/1/pa3_Insect_' + j + '.png')),
		j <= 8 &&
			(res_resource.push('RES/PA/1/pa1_grass_' + j + '.png'),
			res_resource.push('RES/PA/1/pa2_dirt_' + j + '.png'));
var res_playscene2 = {
	pa1_Pillow_Messy: 'RES/PA/2/pa1_Pillow_Messy.png',
	pa1_Pillow_Done: 'RES/PA/2/pa1_Pillow_Done.png',
	pa1_House_Dirty: 'RES/PA/2/pa1_House_Dirty.png',
	pa1_Thinking_Popup: 'RES/PA/2/pa1_Thinking_Popup.png',
	pa2_Basket_Up: 'RES/PA/2/pa2_Basket_Up.png',
	pa2_Basket: 'RES/PA/2/pa2_Basket.png',
	pa2_Cotton: 'RES/PA/2/pa2_Cotton.png',
	pa2_Pillow_Done: 'RES/PA/2/pa2_Pillow_Done.png',
	pa2_Main: 'RES/PA/2/pa2_Main.png',
	pa2_Main_Up: 'RES/PA/2/pa2_Main_Up.png',
	pa2_Needle: 'RES/PA/2/pa2_Needle.png',
	pa2_doro_Needle: 'RES/PA/2/pa2_doro_Needle.png',
	pa3_House: 'RES/PA/2/pa3_House.png',
	pa3_Dirty_Roof: 'RES/PA/2/pa3_Dirty_Roof.png',
	pa3_Wood_Set: 'RES/PA/2/pa3_Wood_Set.png',
	pa3_Wood_Screw: 'RES/PA/2/pa3_Wood_Screw.png',
	pa3_Wood_Move: 'RES/PA/2/pa3_Wood_Move.png',
	pa3_Popup: 'RES/PA/2/pa3_Popup.png',
	pa3_Hummer: 'RES/PA/2/pa3_Hummer.png',
	pa3_Top: 'RES/PA/2/pa3_Top.png',
	pa3_Gun: 'RES/PA/2/pa3_Gun.png',
	pa3_Panel: 'RES/PA/2/pa3_Panel.png',
	pa3_Gun1: 'RES/PA/2/pa3_Gun1.png',
	pa3_Gun1_Done: 'RES/PA/2/pa3_Gun1_Done.png',
};
for (i in res_playscene2) res_resource.push(res_playscene2[i]);
for (j = 1; j <= 30; j++)
	j <= 3 &&
		(res_resource.push('RES/PA/2/Bg_' + j + '.png'),
		res_resource.push('RES/PA/2/pa1_House_' + j + '.png'),
		res_resource.push('RES/PA/2/pa2_Pillow_' + j + '.png'),
		res_resource.push('RES/PA/2/pa2_Pillow_' + j + '_Up.png'),
		res_resource.push('RES/PA/2/pa3_Screw_' + j + '.png'),
		res_resource.push('RES/PA/2/pa3_Bucket_' + j + '.png'),
		res_resource.push('RES/PA/2/pa3_Colour_' + j + '.png'),
		res_resource.push('RES/PA/2/pa3_Colour_' + j + '_Flow_1.png'),
		res_resource.push('RES/PA/2/pa3_Colour_' + j + '_Flow_2.png'),
		res_resource.push('RES/PA/2/pa3_Gun1_Colour_' + j + '.png'),
		res_resource.push('RES/PA/2/pa3_Roof_' + j + '.png'),
		res_resource.push('RES/PA/2/pa3_Gun1_Flow_' + j + '_1.png'),
		res_resource.push('RES/PA/2/pa3_Gun1_Flow_' + j + '_2.png'),
		res_resource.push('RES/PA/2/pa3_Gun1_Flow_' + j + '_3.png')),
		j <= 13 && res_resource.push('RES/PA/2/pa2_doro_' + j + '.png');
var res_playscene3 = {
	Bg_3_Up: 'RES/PA/3/Bg_3_Up.png',
	pa1_Water: 'RES/PA/3/pa1_Water.png',
	pa2_Broom: 'RES/PA/3/pa2_Broom.png',
	pa2_Insect_Remover: 'RES/PA/3/pa2_Insect_Remover.png',
	pa3_Brush: 'RES/PA/3/pa3_Brush.png',
	pa3_Bubble: 'RES/PA/3/pa3_Bubble.png',
	pa3_Dust: 'RES/PA/3/pa3_Dust.png',
	pa3_Flush: 'RES/PA/3/pa3_Flush.png',
	pa3_Popup: 'RES/PA/3/pa3_Popup.png',
	pa3_Spray: 'RES/PA/3/pa3_Spray.png',
	pa3_Spray1: 'RES/PA/3/pa3_Spray1.png',
	pa3_Water_D: 'RES/PA/3/pa3_Water_D.png',
	pa4_Popup: 'RES/PA/3/pa4_Popup.png',
	pa4_Wheel: 'RES/PA/3/pa4_Wheel.png',
	pa4_Panel: 'RES/PA/3/pa4_Panel.png',
};
for (i in res_playscene3) res_resource.push(res_playscene3[i]);
for (j = 1; j <= 30; j++)
	j <= 2 &&
		(res_resource.push('RES/PA/3/pa2_Insect_' + j + '_1.png'),
		res_resource.push('RES/PA/3/pa2_Insect_' + j + '_2.png'),
		res_resource.push('RES/PA/3/pa2_Insect_Remover_' + j + '.png'),
		res_resource.push('RES/PA/3/pa3_Insect_' + j + '_1.png'),
		res_resource.push('RES/PA/3/pa3_Insect_' + j + '_2.png')),
		j <= 3 &&
			(res_resource.push('RES/PA/3/pa2_Water_' + j + '.png'),
			res_resource.push('RES/PA/3/pa3_Spray_' + j + '.png')),
		j <= 4 && res_resource.push('RES/PA/3/pa4_Water_Ani_' + j + '.png'),
		j <= 5 &&
			(res_resource.push('RES/PA/3/Bg_' + j + '.png'),
			res_resource.push('RES/PA/3/pa4_albowo_' + j + '.png'),
			res_resource.push('RES/PA/3/pa4_albowo_th_' + j + '.png')),
		j <= 8 && res_resource.push('RES/PA/3/pa3_Water_Ani_' + j + '.png');
var res_playscene4 = {
	pa1_Wall_Dirty: 'RES/PA/4/pa1_Wall_Dirty.png',
	pa1_Picture: 'RES/PA/4/pa1_Picture.png',
	pa1_Picture_Crack: 'RES/PA/4/pa1_Picture_Crack.png',
	pa2_Wall: 'RES/PA/4/pa2_Wall.png',
	pa2_Scrap_Tool: 'RES/PA/4/pa2_Scrap_Tool.png',
	pa2_Siment: 'RES/PA/4/pa2_Siment.png',
	pa2_Cutter: 'RES/PA/4/pa2_Cutter.png',
	pa2_WallPart_Hint: 'RES/PA/4/pa2_WallPart_Hint.png',
	pa3_Frame_Done: 'RES/PA/4/pa3_Frame_Done.png',
	pa3_Frame: 'RES/PA/4/pa3_Frame.png',
	pa3_Main_Part: 'RES/PA/4/pa3_Main_Part.png',
	pa3_Dust: 'RES/PA/4/pa3_Dust.png',
	pa3_Brush: 'RES/PA/4/pa3_Brush.png',
	pa3_Picture_Done: 'RES/PA/4/pa3_Picture_Done.png',
	pa3_Glue_Bottle: 'RES/PA/4/pa3_Glue_Bottle.png',
	pa4_Hole: 'RES/PA/4/pa4_Hole.png',
	pa4_Hole1: 'RES/PA/4/pa4_Hole1.png',
	pa4_Frame_Done_Move: 'RES/PA/4/pa4_Frame_Done_Move.png',
	pa4_Panu: 'RES/PA/4/pa4_Panu.png',
};
for (i in res_playscene4) res_resource.push(res_playscene4[i]);
for (j = 1; j <= 30; j++)
	j <= 2 && res_resource.push('RES/PA/4/pa2_Roller_' + j + '.png'),
		j <= 3 &&
			(res_resource.push('RES/PA/4/pa2_WallCrack_1_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallCrack_2_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallCrack_3_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_Wall_Th_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_move_' + j + '.png'),
			res_resource.push('RES/PA/4/pa3_Part_' + j + '.png'),
			res_resource.push('RES/PA/4/pa3_Part_Th_' + j + '.png'),
			res_resource.push('RES/PA/4/pa3_Part_Hint_' + j + '.png'),
			res_resource.push('RES/PA/4/pa3_Glue_' + j + '.png'),
			res_resource.push('RES/PA/4/pa3_Glue_Part_' + j + '.png'),
			res_resource.push('RES/PA/4/pa3_Glue_Stock_' + j + '.png'),
			res_resource.push('RES/PA/4/pa4_Screw_' + j + '.png')),
		j <= 4 && res_resource.push('RES/PA/4/Bg_' + j + '.png'),
		j <= 5 &&
			(res_resource.push('RES/PA/4/pa2_WallCrackPart_' + j + '_1.png'),
			res_resource.push('RES/PA/4/pa2_WallCrackPart_' + j + '_2.png'),
			res_resource.push('RES/PA/4/pa2_WallCrackPart_' + j + '_3.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_1_1_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_1_2_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_1_3_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_2_1_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_2_2_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_2_3_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_3_1_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_3_2_' + j + '.png'),
			res_resource.push('RES/PA/4/pa2_WallPart_3_3_' + j + '.png')),
		j <= 8 && res_resource.push('RES/PA/4/pa4_Screw_Driver_' + j + '.png');
var res_playscene5 = {
	pa1_Mixer: 'RES/PA/5/pa1_Mixer.png',
	pa1_Mixer_Done: 'RES/PA/5/pa1_Mixer_Done.png',
	pa1_Frige_Done: 'RES/PA/5/pa1_Frige_Done.png',
	pa2_Glass_Up: 'RES/PA/5/pa2_Glass_Up.png',
	pa2_Dryer: 'RES/PA/5/pa2_Dryer.png',
	pa2_Towel: 'RES/PA/5/pa2_Towel.png',
	pa3_Screw: 'RES/PA/5/pa3_Screw.png',
	pa3_Panu: 'RES/PA/5/pa3_Panu.png',
	pa3_Door_Screw: 'RES/PA/5/pa3_Door_Screw.png',
	pa3_Bin: 'RES/PA/5/pa3_Bin.png',
	pa3_Door: 'RES/PA/5/pa3_Door.png',
	pa3_Oil_Bottle: 'RES/PA/5/pa3_Oil_Bottle.png',
	pa3_Door_Done: 'RES/PA/5/pa3_Door_Done.png',
};
for (i in res_playscene5) res_resource.push(res_playscene5[i]);
for (j = 1; j <= 30; j++)
	j <= 2 &&
		(res_resource.push('RES/PA/5/pa1_Frige_' + j + '.png'),
		res_resource.push('RES/PA/5/pa2_Fridge_' + j + '.png'),
		res_resource.push('RES/PA/5/pa2_Dryer_Flow_' + j + '.png')),
		j <= 3 &&
			(res_resource.push('RES/PA/5/pa2_Door_Closed_Ani_' + j + '.png'),
			res_resource.push('RES/PA/5/pa3_Wheel_Done_' + j + '_1.png'),
			res_resource.push('RES/PA/5/pa3_Wheel_Done_' + j + '_2.png')),
		j <= 4 &&
			(res_resource.push('RES/PA/5/Bg_' + j + '.png'),
			res_resource.push('RES/PA/5/pa3_Popup_' + j + '.png'),
			res_resource.push('RES/PA/5/pa3_Scraw_' + j + '.png'),
			res_resource.push('RES/PA/5/pa3_Scraw_Done_' + j + '.png')),
		j <= 5 &&
			(res_resource.push('RES/PA/5/pa2_Fridge_Item_' + j + '.png'),
			res_resource.push('RES/PA/5/pa2_Fridge_Move_Item_' + j + '.png')),
		j <= 6 &&
			(res_resource.push('RES/PA/5/pa2_Ice_' + j + '_1.png'),
			res_resource.push('RES/PA/5/pa2_Ice_' + j + '_2.png'),
			res_resource.push('RES/PA/5/pa2_Ice_' + j + '_3.png'),
			res_resource.push('RES/PA/5/pa2_Water_' + j + '.png'),
			res_resource.push('RES/PA/5/pa3_Wheel_' + j + '.png')),
		j <= 8 &&
			res_resource.push('RES/PA/5/pa2_Fridge_Set_Item_' + j + '.png');
var res_gameOverScene = { GA_BG: 'RES/GA/GA_BG.png' };
for (i in res_gameOverScene) res_resource.push(res_gameOverScene[i]);
var res_common_button = {
	btn_done: 'RES/CB/btn_done.png',
	btn_reset: 'RES/CB/btn_reset.png',
	btn_next: 'RES/CB/btn_next.png',
	btn_more: 'RES/CB/btn_more.png',
	Watch_Reward: 'RES/CB/Watch_Reward.png',
	Popup: 'RES/CB/Popup.png',
	PopupBG: 'RES/CB/PopupBG.png',
	btn_close: 'RES/CB/btn_close.png',
	dummy_img: 'RES/CB/dummy_img.png',
	indicator_img: 'RES/CB/ind.png',
	indicator1_img: 'RES/CB/ind1.png',
	arrow_ind_img: 'RES/CB/arrow_ind.png',
	arrow_ind_2_img: 'RES/CB/arrow_ind_2.png',
	arrow_ind_3_img: 'RES/CB/arrow_ind_3.png',
	arrow: 'RES/CB/arrow.png',
	brush: 'RES/CB/brush.png',
	font_game: 'RES/CB/gfont.ttf',
};
for (i in res_common_button) res_resource.push(res_common_button[i]);
// for (var k = 0; k < RelatedGames.length; k++)
// 	res_resource.push(RelatedGames[k].thumb);
window.onload = function () {
	(cc.game.onStart = function () {
		cc.director.setDisplayStats(!1),
			cc.view.adjustViewPort(!0),
			cc.view.setDesignResolutionSize(
				800,
				504,
				cc.ResolutionPolicy.SHOW_ALL
			),
			cc.view.resizeWithBrowserSize(!0),
			// YYGGames.startup({
			// 	appName: comman.GameId,
			// 	channel: 1,
			// 	debugOpen: 0,
			// 	complete: function () {},
			// }),
			Preloader.preload(
				res_resource,
				function () {
					cc.director.runScene(MainScene.scene()),
						comman.playMusic(res_comman.bg_sound, !0, !0);
				},
				this
			);
	}),
		cc.game.run('gameCanvas');
};
var MainScene = cc.Scene.extend({
	ctor: function () {
		this._super(), this.init();
	},
	init: function () {
		this._super(),
			cc.sys.browserType == cc.sys.BROWSER_TYPE_SAFARI &&
				(safari_lbl_pos_diff = 6),
			(this.move_tool = null),
			comman.preloadAllSound(),
			(this.bg = cc.Sprite.create('RES/MS/main_BG.png')),
			this.bg.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.bg.setScale(1),
			this.addChild(this.bg),
			(this.title = cc.Sprite.create('RES/MS/Title.png')),
			this.title.setPosition(
				0.5 * comman.winSize().width,
				1.5 * comman.winSize().height
			),
			this.title.setScale(1),
			this.addChild(this.title, 1),
			(this.btn_bb_icon = cc.MenuItemImage.create(
				res_comman.bb_icon_3,
				res_comman.bb_icon_3,
				this.onMoreApp,
				this
			)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_more = cc.MenuItemImage.create(
				res_mainScene.btn_more,
				res_mainScene.btn_more,
				this.onMoreApp,
				this
			)),
			this.btn_more.setScale(1),
			this.btn_more.setTag(101),
			this.btn_more.setPosition(
				cc.p(
					0.55 * this.btn_more.getContentSize().width,
					-1.5 * this.btn_more.getContentSize().height
				)
			),
			this.btn_more.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							0.55 * this.btn_more.getContentSize().width,
							0.55 * this.btn_more.getContentSize().height
						)
					)
				)
			),
			(this.btn_play = cc.MenuItemImage.create(
				res_mainScene.btn_play,
				res_mainScene.btn_play,
				this.onPlayButton,
				this
			)),
			this.btn_play.setScale(1),
			this.btn_play.setPosition(
				cc.p(
					comman.winSize().width -
						0.48 * this.btn_play.getContentSize().width,
					-1.5 * this.btn_play.getContentSize().height
				)
			),
			this.btn_play.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_play.getContentSize().width,
							0.55 * this.btn_play.getContentSize().height
						)
					)
				)
			),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.55 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.55 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.MainMenu = cc.Menu.create(
				this.btn_bb_icon,
				this.btn_more,
				this.btn_play,
				this.btn_music
			)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 5),
			(this.prt_Sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_1_plist
			)),
			this.prt_Sparkle.setScale(1),
			this.prt_Sparkle.stopSystem(),
			this.addChild(this.prt_Sparkle, 5);
	},
	onEnter: function () {
		this._super(),
			cc.eventManager.addListener(
				{
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this.onTouchBegan,
					onTouchMoved: this.onTouchMoved,
					onTouchEnded: this.onTouchEnded,
				},
				this
			),
			'mouse' in cc.sys.capabilities &&
				cc.eventManager.addListener(
					{
						event: cc.EventListener.MOUSE,
						onMouseMove: this.onMouseMove,
					},
					this
				);
	},
	onMouseMove: function (e) {
		var t = e.getLocation(),
			e = e.getCurrentTarget();
		cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) &&
		1 == e.btn_more.getScale() &&
		0 == e.btn_more.getNumberOfRunningActions()
			? (e.prt_Sparkle.setPosition(e.btn_more.getPosition()),
			  e.prt_Sparkle.resetSystem(),
			  e.btn_more.setScale(1.05))
			: 1.05 != e.btn_more.getScale() ||
			  cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) ||
			  0 != e.btn_more.getNumberOfRunningActions()
			? cc.rectContainsPoint(e.btn_play.getBoundingBox(), t) &&
			  1 == e.btn_play.getScale() &&
			  0 == e.btn_play.getNumberOfRunningActions()
				? (e.prt_Sparkle.setPosition(e.btn_play.getPosition()),
				  e.prt_Sparkle.resetSystem(),
				  e.btn_play.setScale(1.05))
				: 1.05 != e.btn_play.getScale() ||
				  cc.rectContainsPoint(e.btn_play.getBoundingBox(), t) ||
				  0 != e.btn_play.getNumberOfRunningActions() ||
				  e.btn_play.setScale(1)
			: e.btn_more.setScale(1);
	},
	onTouchBegan: function (e, t) {
		e = e.getLocation();
		return (t.getCurrentTarget().startLocation = e), !0;
	},
	onTouchMoved: function (e, t) {
		(e = e.getLocation()), (t = t.getCurrentTarget());
		null != t.move_tool && t.move_tool.setPosition(e);
	},
	onTouchEnded: function (e, t) {
		e.getLocation(), t.getCurrentTarget();
	},
	onMoreApp: function (e) {
		101 == e.getTag()
			? CreateLinksInGame(comman.GameId, 'mainscreen', 'more')
			: CreateLinksInGame(comman.GameId, 'mainscreen', 'logo');
	},
	onPlayButton: function (e) {
		this.scheduleOnce(
			function () {
				this.onNextScene();
			},
			0.1,
			'onNextScene'
		);
	},
	onMusicButton: function (e) {
		0 == e.getNumberOfRunningActions() &&
			(e.stopAllActions(),
			e.runAction(
				cc.Sequence.create(
					cc.ScaleTo.create(0, 1),
					cc.ScaleTo.create(0.2, 0.9),
					cc.ScaleTo.create(0.2, 1)
				)
			),
			comman.isMusicEnable
				? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
				  comman.setSoundEnabled(!1))
				: comman.isMusicEnable ||
				  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
				  comman.setSoundEnabled(!0)));
	},
	onNextScene: function () {
		comman.stopAllEffect(),
			comman.showInterstitial(),
			cc.director.runScene(ChooseScene.scene());
	},
});
MainScene.scene = function () {
	var e = new cc.Scene(),
		t = new MainScene();
	return e.addChild(t), e;
};
var PlayScene_1 = cc.Scene.extend({
	ctor: function () {
		this._super(), this.init();
	},
	onEnter: function () {
		this._super(),
			cc.eventManager.addListener(
				{
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this.onTouchBegan,
					onTouchMoved: this.onTouchMoved,
					onTouchEnded: this.onTouchEnded,
				},
				this
			),
			'mouse' in cc.sys.capabilities &&
				cc.eventManager.addListener(
					{
						event: cc.EventListener.MOUSE,
						onMouseMove: this.onMouseMove,
					},
					this
				);
	},
	init: function () {
		this._super(),
			(this.startPos = cc.p(0, 0)),
			(this.endPos = cc.p(0, 0)),
			(this.isDoneShow = !1),
			(this.isNextShow = !1),
			(this.lyl_puzzles = null),
			(this.move_tool = null),
			(this.move_tool_no = 0),
			(this.move_tool_rot = 0),
			(this.move_tool_s_pos = cc.p(1e4, 1e4)),
			(this.isTouchOn = !1),
			(this.current_part = 1),
			(this.current_sub_part = 1),
			(this.current_sub_sub_part = 1),
			(this.current_tool = 1),
			this.setTouchOff(0.1),
			(this.bg = cc.Sprite.create('RES/PA/1/Bg_1.png')),
			this.bg.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.bg.setScale(1),
			this.addChild(this.bg),
			(this.dummyPoints = []),
			this.createPlayarea(),
			this.createPanels(),
			(this.btn_bb_icon = cc.MenuItemImage.create(
				res_comman.bb_icon_3,
				res_comman.bb_icon_3,
				this.onMoreApp,
				this
			)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_more = cc.MenuItemImage.create(
				res_common_button.btn_more,
				res_common_button.btn_more,
				this.onMoreApp,
				this
			)),
			this.btn_more.setScale(1),
			this.btn_more.setTag(101),
			this.btn_more.setPosition(
				cc.p(
					comman.winSize().width -
						1.6 * this.btn_more.getContentSize().width,
					comman.winSize().height +
						0.55 * this.btn_more.getContentSize().height
				)
			),
			this.btn_more.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							this.btn_more.getPositionX(),
							comman.winSize().height -
								0.55 * this.btn_more.getContentSize().height
						)
					)
				)
			),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.55 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.55 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.btn_done = cc.MenuItemImage.create(
				res_common_button.btn_done,
				res_common_button.btn_done,
				this.onDoneClick,
				this
			)),
			this.btn_done.setScale(1),
			this.btn_done.setTag(101),
			this.btn_done.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_done.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_done.getContentSize().height
				)
			),
			(this.btn_next = cc.MenuItemImage.create(
				res_common_button.btn_next,
				res_common_button.btn_next,
				this.onNextClick,
				this
			)),
			this.btn_next.setScale(1),
			this.btn_next.setTag(101),
			this.btn_next.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_next.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_next.getContentSize().height
				)
			),
			(this.MainMenu = cc.Menu.create(
				this.btn_bb_icon,
				this.btn_done,
				this.btn_more,
				this.btn_music,
				this.btn_next
			)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 100),
			(this.prt_Sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_1_plist
			)),
			this.prt_Sparkle.setScale(1.5),
			this.prt_Sparkle.stopSystem(),
			this.addChild(this.prt_Sparkle),
			this.prt_Sparkle.setLocalZOrder(500),
			(this.prt_tool_sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_2_plist
			)),
			this.prt_tool_sparkle.setScale(1),
			this.prt_tool_sparkle.stopSystem(),
			this.addChild(this.prt_tool_sparkle),
			this.prt_tool_sparkle.setLocalZOrder(500),
			(this.CommonHandIndicator = cc.Sprite.create(
				res_common_button.arrow_ind_3_img
			)),
			this.CommonHandIndicator.setScale(0),
			this.CommonHandIndicator.setAnchorPoint(cc.p(0.55, 0.1)),
			this.addChild(this.CommonHandIndicator, 10),
			this.CommonHandIndicator.setPosition(cc.p(25e3, 25e3)),
			(this.CommonRoundIndicator = []);
		for (var e = 0; e < 15; e++)
			(this.CommonRoundIndicator[e] = cc.Sprite.create(
				res_common_button.indicator_img
			)),
				this.CommonRoundIndicator[e].setScale(0),
				this.CommonRoundIndicator[e].setAnchorPoint(cc.p(0.5, 0.5)),
				this.CommonRoundIndicator[e].setColor(cc.color(0, 255, 0)),
				this.addChild(this.CommonRoundIndicator[e], 10),
				this.CommonRoundIndicator[e].setPosition(cc.p(25e3, 25e3));
		this.CommonRoundIndicator1 = [];
		for (e = 0; e < 15; e++)
			(this.CommonRoundIndicator1[e] = cc.Sprite.create(
				res_common_button.arrow
			)),
				this.CommonRoundIndicator1[e].setScale(0),
				this.CommonRoundIndicator1[e].setAnchorPoint(cc.p(0.5, 0)),
				this.addChild(this.CommonRoundIndicator1[e], 10),
				this.CommonRoundIndicator1[e].setPosition(cc.p(25e3, 25e3));
		this.startNextPart();
	},
	RandomCommonHandInd: function () {
		var e, t;
		1 == this.current_part
			? 2 == this.current_sub_part
				? ((e = cc.p(639, 172)),
				  (t = cc.p(176, 167)),
				  this.RandomCommonHandIndOneWay(e, t))
				: 3 == this.current_sub_part &&
				  ((e = cc.p(212, 267)),
				  (t = cc.p(594, 263)),
				  this.RandomCommonHandIndOneWay(e, t))
			: 2 == this.current_part
			? 1 == this.current_sub_part
				? ((e = this.pa2_Broom_pos),
				  (t = this.pa2_dirt_pos[comman.getRandomInt(1, 7)]),
				  this.RandomCommonHandIndOneWay(e, t))
				: 4 == this.current_sub_part
				? ((e = this.pa2_Tree_Move_pos),
				  (t = cc.p(362, 254)),
				  this.RandomCommonHandIndOneWay(e, t))
				: 5 == this.current_sub_part
				? ((e = this.pa2_Slove.getPosition()),
				  (t = cc.p(362, 254)),
				  this.RandomCommonHandIndOneWay(e, t))
				: 6 == this.current_sub_part
				? ((e = this.pa2_Stand_Move_pos),
				  (t = this.pa2_Stand_Move_pos1),
				  this.RandomCommonHandIndOneWay(e, t))
				: 7 == this.current_sub_part &&
				  ((e = this.pa2_Stamb_Move_pos[1]),
				  (t = this.pa2_Stamb_Move_pos1[1]),
				  this.RandomCommonHandIndOneWay(e, t))
			: 3 == this.current_part &&
			  (1 == this.current_sub_part
					? ((e = this.pa3_Insect_pos[comman.getRandomInt(1, 4)]),
					  (t = cc.p(122, 150)),
					  this.RandomCommonHandIndOneWay(e, t))
					: 2 == this.current_sub_part
					? ((e = this.pa3_Pakkad_pos),
					  (t = cc.p(282, 380)),
					  this.RandomCommonHandIndOneWay(e, t))
					: 4 == this.current_sub_part &&
					  ((e = this.pa3_Starw_pos[comman.getRandomInt(1, 6)]),
					  (t = cc.p(141, 53)),
					  this.RandomCommonHandIndOneWay(e, t)));
	},
	RandomCommonHandInd1: function () {
		var e;
		2 == this.current_part
			? 3 == this.current_sub_part &&
			  ((e = this.pa2_Slove_pos), this.RandomCommonHandIndJump(e))
			: 3 == this.current_part &&
			  3 == this.current_sub_part &&
			  ((e = this.pa3_Seed_pos), this.RandomCommonHandIndJump(e));
	},
	RandomCommonHandIndOneWay: function (e, t) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(0.5, t),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(1)
					)
				)
			);
	},
	RandomCommonHandIndTwoWay: function (e, t, c) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, e),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, c),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay1: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(2, c),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndJump: function (e) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.JumpTo.create(1.5, e, 5, 2),
						cc.ScaleTo.create(0, 0),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonRoundInd: function (e) {},
	RandomCommonRoundInd1: function (e) {
		this.CommonRoundIndicator[1].setPosition(e),
			this.CommonRoundIndicator[1].stopAllActions(),
			this.CommonRoundIndicator[1].setScale(1),
			this.CommonRoundIndicator[1].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	RandomCommonRoundInd2: function (e, t) {
		this.CommonRoundIndicator[e].setPosition(t),
			this.CommonRoundIndicator[e].stopAllActions(),
			this.CommonRoundIndicator[e].setScale(1),
			this.CommonRoundIndicator[e].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	hideHint: function () {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setScale(0);
		for (var e = 0; e < 15; e++)
			this.CommonRoundIndicator[e].stopAllActions(),
				this.CommonRoundIndicator[e].setScale(0);
	},
	showToolCompleteParticle: function (e) {
		this.prt_tool_sparkle.setPosition(e),
			this.prt_tool_sparkle.resetSystem();
	},
	showDone: function () {
		0 == this.isDoneShow &&
			((this.isDoneShow = !0),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	showNext: function () {
		0 == this.isNextShow &&
			((this.isNextShow = !0),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	hideDone: function () {
		1 == this.isDoneShow &&
			((this.isDoneShow = !1),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	hideNext: function () {
		1 == this.isNextShow &&
			((this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	createPlayarea: function () {
		(this.dummyMoveDist = cc.p(0, 0)),
			(this.dummyBrush = cc.Sprite.create('RES/CB/brush.png')),
			this.dummyBrush.setPosition(cc.p(1e3, 1e3)),
			this.dummyBrush.setScale(0),
			this.dummyBrush.setOpacity(255),
			this.dummyBrush.setBlendFunc(cc.ZERO, cc.ONE_MINUS_SRC_ALPHA),
			this.addChild(this.dummyBrush, -100),
			(this.lyl_play = cc.Layer.create()),
			this.addChild(this.lyl_play),
			(this.lyl_part = []),
			(this.lyl_sub_part = []);
		var e = 0;
		(this.lyl_part[e] = cc.Layer.create()),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 1;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa1_grass = []),
			(this.pa1_grass_pos = [
				cc.p(0, 0),
				cc.p(343, 266),
				cc.p(590, 268),
				cc.p(328, 179),
				cc.p(642, 176),
				cc.p(222, 265),
				cc.p(481, 265),
				cc.p(178, 176),
				cc.p(501, 177),
			]);
		for (var t = 1; t < this.pa1_grass_pos.length; t++)
			(this.pa1_grass[t] = cc.Sprite.create(
				'RES/PA/1/pa1_grass_' + t + '.png'
			)),
				this.pa1_grass[t].setPosition(this.pa1_grass_pos[t]),
				this.pa1_grass[t].setScale(1),
				this.pa1_grass[t].setTag(1),
				this.lyl_part[e].addChild(this.pa1_grass[t]);
		(this.pa1_Big_Panda_pos1 = cc.p(666, -70)),
			(this.pa1_Big_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Big_Panda.json',
				'RES/PA/anim/Big_Panda.atlas',
				0.5
			)),
			this.pa1_Big_Panda.setPosition(
				cc.p(this.pa1_Big_Panda_pos1.x, this.pa1_Big_Panda_pos1.y)
			),
			this.pa1_Big_Panda.setScale(1, 1),
			this.pa1_Big_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Big_Panda),
			this.pa1_Big_Panda.setAnimation(1, 'Sad', !0),
			(this.pa1_Panda_pos1 = cc.p(133, -30)),
			(this.pa1_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Panda.json',
				'RES/PA/anim/Panda.atlas',
				0.5
			)),
			this.pa1_Panda.setPosition(
				cc.p(this.pa1_Panda_pos1.x, this.pa1_Panda_pos1.y - 400)
			),
			this.pa1_Panda.setScale(1, 1),
			this.pa1_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Panda),
			this.pa1_Panda.setAnimation(1, 'Idle', !0),
			(this.pa1_Masin_start = !1),
			(this.pa1_Masin_Panda_pos1 = cc.p(684, 139)),
			(this.pa1_Masin_Panda_pos2 = cc.p(184, 139)),
			(this.pa1_Masin_Panda_pos3 = cc.p(113, 223)),
			(this.pa1_Masin_Panda_pos4 = cc.p(613, 226)),
			(this.pa1_Masin_Panda = new sp.SkeletonAnimation(
				'RES/PA/1/Masin_Panda.json',
				'RES/PA/1/Masin_Panda.atlas',
				0.5
			)),
			this.pa1_Masin_Panda.setPosition(
				cc.p(
					this.pa1_Masin_Panda_pos1.x + 400,
					this.pa1_Masin_Panda_pos1.y
				)
			),
			this.pa1_Masin_Panda.setScale(1, 1),
			this.pa1_Masin_Panda.setTag(0),
			this.lyl_part[e].addChild(this.pa1_Masin_Panda);
		e = 2;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa2_Hole = cc.Sprite.create('RES/PA/1/pa2_Hole_1.png')),
			this.pa2_Hole.setPosition(cc.p(400, 252)),
			this.pa2_Hole.setScale(1),
			this.pa2_Hole.setTag(1),
			this.pa2_Hole.setVisible(!1),
			this.lyl_part[e].addChild(this.pa2_Hole),
			(this.pa2_Stand = cc.Sprite.create('RES/PA/1/pa2_Stand.png')),
			this.pa2_Stand.setPosition(cc.p(400, 252)),
			this.pa2_Stand.setScale(1),
			this.pa2_Stand.setTag(1),
			this.pa2_Stand.setVisible(!1),
			this.lyl_part[e].addChild(this.pa2_Stand),
			(this.pa2_Tree = cc.Sprite.create('RES/PA/1/pa2_Tree.png')),
			this.pa2_Tree.setPosition(cc.p(400, 252)),
			this.pa2_Tree.setScale(1),
			this.pa2_Tree.setTag(1),
			this.pa2_Tree.setVisible(!1),
			this.lyl_part[e].addChild(this.pa2_Tree),
			(this.pa2_Dhaglo_Done = cc.Sprite.create(
				'RES/PA/1/pa2_Dhaglo_Done_1.png'
			)),
			this.pa2_Dhaglo_Done.setPosition(cc.p(400, 252)),
			this.pa2_Dhaglo_Done.setScale(1),
			this.pa2_Dhaglo_Done.setTag(1),
			this.pa2_Dhaglo_Done.setVisible(!1),
			this.lyl_part[e].addChild(this.pa2_Dhaglo_Done),
			(this.pa2_Stamb = []);
		for (t = 1; t <= 3; t++)
			(this.pa2_Stamb[t] = cc.Sprite.create(
				'RES/PA/1/pa2_Stamb_' + t + '.png'
			)),
				this.pa2_Stamb[t].setPosition(cc.p(400, 252)),
				this.pa2_Stamb[t].setScale(1),
				this.pa2_Stamb[t].setTag(1),
				this.pa2_Stamb[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa2_Stamb[t]);
		(this.pa2_Stand_Up = cc.Sprite.create('RES/PA/1/pa2_Stand_Up.png')),
			this.pa2_Stand_Up.setPosition(cc.p(400, 252)),
			this.pa2_Stand_Up.setScale(1),
			this.pa2_Stand_Up.setTag(1),
			this.pa2_Stand_Up.setVisible(!1),
			this.lyl_part[e].addChild(this.pa2_Stand_Up),
			(this.pa2_Dhaglo = []),
			(this.pa2_Dhaglo_pos = [
				cc.p(0, 0),
				cc.p(535, 283),
				cc.p(636, 248),
				cc.p(666, 160),
				cc.p(533, 132),
			]);
		for (t = 1; t < this.pa2_Dhaglo_pos.length; t++)
			(this.pa2_Dhaglo[t] = cc.Sprite.create('RES/PA/1/pa2_Dhaglo.png')),
				this.pa2_Dhaglo[t].setPosition(this.pa2_Dhaglo_pos[t]),
				this.pa2_Dhaglo[t].setScale(1),
				this.pa2_Dhaglo[t].setTag(1),
				this.pa2_Dhaglo[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa2_Dhaglo[t]);
		(this.pa2_Supdi_pos = cc.p(163, 214)),
			(this.pa2_Supdi = cc.Sprite.create('RES/PA/1/pa2_Supdi.png')),
			this.pa2_Supdi.setPosition(
				cc.p(this.pa2_Supdi_pos.x - 500, this.pa2_Supdi_pos.y)
			),
			this.pa2_Supdi.setScale(1),
			this.pa2_Supdi.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Supdi),
			(this.pa2_dirt = []),
			(this.pa2_dirt_pos = [
				cc.p(0, 0),
				cc.p(347, 188),
				cc.p(411, 261),
				cc.p(514, 192),
				cc.p(536, 150),
				cc.p(434, 119),
				cc.p(596, 124),
				cc.p(474, 211),
				cc.p(569, 245),
			]),
			(this.pa2_dirt_pos1 = [
				cc.p(0, 0),
				cc.p(178, 223),
				cc.p(172, 235),
				cc.p(182, 228),
				cc.p(161, 216),
				cc.p(181, 215),
				cc.p(184, 222),
				cc.p(180, 225),
				cc.p(199, 236),
			]),
			(this.pa2_dirt_pos_part = [
				cc.p(0, 0),
				cc.p(178, 223),
				cc.p(172, 235),
				cc.p(182, 228),
				cc.p(161, 216),
				cc.p(181, 215),
				cc.p(184, 222),
				cc.p(180, 225),
				cc.p(199, 236),
			]);
		for (t = 1; t < this.pa2_dirt_pos.length; t++)
			(this.pa2_dirt[t] = cc.Sprite.create(
				'RES/PA/1/pa2_dirt_' + t + '.png'
			)),
				this.pa2_dirt[t].setPosition(this.pa2_dirt_pos[t]),
				this.pa2_dirt[t].setScale(1),
				this.pa2_dirt[t].setTag(1),
				this.lyl_part[e].addChild(this.pa2_dirt[t]),
				(this.pa2_dirt_pos_part[t].x =
					(this.pa2_dirt_pos[t].x - this.pa2_dirt_pos1[t].x) / 5),
				(this.pa2_dirt_pos_part[t].y =
					(this.pa2_dirt_pos[t].y - this.pa2_dirt_pos1[t].y) / 5);
		(this.pa2_Broom_pos = cc.p(697, 310)),
			(this.pa2_Broom = cc.Sprite.create('RES/PA/1/pa2_Broom.png')),
			this.pa2_Broom.setPosition(
				cc.p(this.pa2_Broom_pos.x + 500, this.pa2_Broom_pos.y)
			),
			this.pa2_Broom.setAnchorPoint(cc.p(0.58, 0.55)),
			this.pa2_Broom.setScale(1),
			this.pa2_Broom.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Broom),
			(this.pa2_Slove_pos = cc.p(405, 300)),
			(this.pa2_Slove_pos1 = cc.p(35, 120)),
			(this.pa2_Slove_pos2 = cc.p(-20, -80)),
			(this.pa2_Slove = cc.Sprite.create('RES/PA/1/pa2_Slove.png')),
			this.pa2_Slove.setPosition(
				cc.p(this.pa2_Slove_pos.x + 500, this.pa2_Slove_pos.y)
			),
			this.pa2_Slove.setAnchorPoint(cc.p(0.52, 0.55)),
			this.pa2_Slove.setScale(1),
			this.pa2_Slove.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Slove),
			(this.pa2_Slove_Dhaglo = cc.Sprite.create(
				'RES/PA/1/pa2_Dhaglo.png'
			)),
			this.pa2_Slove_Dhaglo.setPosition(cc.p(53, 51)),
			this.pa2_Slove_Dhaglo.setScale(1),
			this.pa2_Slove_Dhaglo.setTag(1),
			this.pa2_Slove_Dhaglo.setVisible(!1),
			this.pa2_Slove.addChild(this.pa2_Slove_Dhaglo),
			(this.pa2_Tree_Move_pos = cc.p(674, 171)),
			(this.pa2_Tree_Move_pos1 = cc.p(362, 332)),
			(this.pa2_Tree_Move = cc.Sprite.create(
				'RES/PA/1/pa2_Tree_Move.png'
			)),
			this.pa2_Tree_Move.setPosition(
				cc.p(this.pa2_Tree_Move_pos.x + 500, this.pa2_Tree_Move_pos.y)
			),
			this.pa2_Tree_Move.setScale(1),
			this.pa2_Tree_Move.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Tree_Move),
			(this.pa2_Stand_Move_pos = cc.p(672, 68)),
			(this.pa2_Stand_Move_pos1 = cc.p(369, 288)),
			(this.pa2_Stand_Move = cc.Sprite.create(
				'RES/PA/1/pa2_Stand_Move.png'
			)),
			this.pa2_Stand_Move.setPosition(
				cc.p(this.pa2_Stand_Move_pos.x + 500, this.pa2_Stand_Move_pos.y)
			),
			this.pa2_Stand_Move.setScale(0.8),
			this.pa2_Stand_Move.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Stand_Move),
			(this.pa2_Stamb_Curr = 1),
			(this.pa2_Stamb_Move = []),
			(this.pa2_Stamb_Move_pos = [
				cc.p(0, 0),
				cc.p(667, 68),
				cc.p(667, 68),
				cc.p(667, 68),
			]),
			(this.pa2_Stamb_Move_pos1 = [
				cc.p(0, 0),
				cc.p(301, 269),
				cc.p(362, 253),
				cc.p(425, 268),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa2_Stamb_Move[t] = cc.Sprite.create(
				'RES/PA/1/pa2_Stamb_Move_' + t + '.png'
			)),
				this.pa2_Stamb_Move[t].setPosition(
					cc.p(
						this.pa2_Stamb_Move_pos[t].x + 500,
						this.pa2_Stamb_Move_pos[t].y
					)
				),
				this.pa2_Stamb_Move[t].setScale(0.6),
				this.pa2_Stamb_Move[t].setTag(0),
				this.lyl_part[e].addChild(this.pa2_Stamb_Move[t]);
		(this.pa2_Basket_pos = cc.p(633, 279)),
			(this.pa2_Basket = cc.Sprite.create('RES/PA/1/pa2_Basket.png')),
			this.pa2_Basket.setPosition(
				cc.p(this.pa2_Basket_pos.x + 500, this.pa2_Basket_pos.y)
			),
			this.pa2_Basket.setScale(1),
			this.pa2_Basket.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Basket);
		e = 3;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa3_Kunjo = cc.Sprite.create('RES/PA/1/pa3_Kunjo.png')),
			this.pa3_Kunjo.setPosition(cc.p(400, 252)),
			this.pa3_Kunjo.setScale(1),
			this.pa3_Kunjo.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Kunjo),
			(this.pa3_Plant = cc.Sprite.create('RES/PA/1/pa3_Plant.png')),
			this.pa3_Plant.setPosition(cc.p(400, 252)),
			this.pa3_Plant.setScale(1),
			this.pa3_Plant.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Plant),
			(this.pa3_Bottle_pos = cc.p(127, 99)),
			(this.pa3_Bottle = cc.Sprite.create('RES/PA/1/pa3_Bottle.png')),
			this.pa3_Bottle.setPosition(
				cc.p(this.pa3_Bottle_pos.x - 300, this.pa3_Bottle_pos.y)
			),
			this.pa3_Bottle.setScale(1),
			this.pa3_Bottle.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Bottle),
			(this.pa3_Bottle_Up = cc.Sprite.create(
				'RES/PA/1/pa3_Bottle_Up.png'
			)),
			this.pa3_Bottle_Up.setPosition(
				cc.p(this.pa3_Bottle_pos.x - 300, this.pa3_Bottle_pos.y)
			),
			this.pa3_Bottle_Up.setScale(1),
			this.pa3_Bottle_Up.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Bottle_Up, 2),
			(this.pa3_Leaf = []);
		for (t = 1; t <= 3; t++)
			(this.pa3_Leaf[t] = cc.Sprite.create(
				'RES/PA/1/pa3_Leaf_' + t + '.png'
			)),
				this.pa3_Leaf[t].setPosition(cc.p(400, 252)),
				this.pa3_Leaf[t].setScale(1),
				this.pa3_Leaf[t].setTag(1),
				this.lyl_part[e].addChild(this.pa3_Leaf[t]);
		(this.pa3_Starw_como = 0),
			(this.pa3_Starw = []),
			(this.pa3_Starw_pos = [
				cc.p(0, 0),
				cc.p(368, 323),
				cc.p(332, 306),
				cc.p(517, 308),
				cc.p(483, 295),
				cc.p(432, 247),
				cc.p(398, 233),
			]),
			(this.pa3_Starw_pos1 = [
				cc.p(0, 0),
				cc.p(138, 38),
				cc.p(98, 38),
				cc.p(175, 39),
				cc.p(104, 75),
				cc.p(134, 74),
				cc.p(166, 74),
			]),
			(this.pa3_Starw_rot = [0, -40, 0, -40, 0, -40, 0]);
		for (t = 1; t <= 6; t++)
			(this.pa3_Starw[t] = cc.Sprite.create('RES/PA/1/pa3_Starw.png')),
				this.pa3_Starw[t].setPosition(this.pa3_Starw_pos[t]),
				this.pa3_Starw[t].setRotation(this.pa3_Starw_rot[t]),
				this.pa3_Starw[t].setScale(0),
				this.pa3_Starw[t].setTag(1),
				this.lyl_part[e].addChild(this.pa3_Starw[t]);
		(this.pa3_Insect_comp = 0),
			(this.pa3_Insect = []),
			(this.pa3_Insect_pos = [
				cc.p(0, 0),
				cc.p(286, 400),
				cc.p(531, 406),
				cc.p(478, 200),
				cc.p(382, 430),
			]),
			(this.pa3_Insect_pos1 = [
				cc.p(0, 0),
				cc.p(110, 80),
				cc.p(131, 70),
				cc.p(111, 60),
				cc.p(140, 60),
			]);
		for (t = 1; t <= 4; t++)
			(this.pa3_Insect[t] = cc.Sprite.create(
				'RES/PA/1/pa3_Insect_' + t + '.png'
			)),
				this.pa3_Insect[t].setPosition(this.pa3_Insect_pos[t]),
				this.pa3_Insect[t].setScale(1),
				this.pa3_Insect[t].setTag(1),
				this.lyl_part[e].addChild(this.pa3_Insect[t]);
		this.pa3_Insect[1].runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.ScaleTo.create(0.5, 1.1),
					cc.ScaleTo.create(0.5, 1),
					cc.MoveTo.create(0.8, cc.p(266, 400)),
					cc.DelayTime.create(0.2),
					cc.ScaleTo.create(0, -1, 1),
					cc.MoveTo.create(0.8, cc.p(286, 400)),
					cc.DelayTime.create(0.2),
					cc.ScaleTo.create(0, 1, 1)
				)
			)
		),
			this.pa3_Insect[2].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.MoveTo.create(1.5, cc.p(561, 406)),
						cc.DelayTime.create(0.2),
						cc.ScaleTo.create(0, -1, 1),
						cc.MoveTo.create(1.5, cc.p(531, 406)),
						cc.DelayTime.create(0.2),
						cc.ScaleTo.create(0, 1, 1),
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			),
			this.pa3_Insect[4].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.MoveTo.create(0.8, cc.p(372, 430)),
						cc.DelayTime.create(0.2),
						cc.ScaleTo.create(0, -1, 1),
						cc.MoveTo.create(0.8, cc.p(382, 430)),
						cc.DelayTime.create(0.2),
						cc.ScaleTo.create(0, 1, 1),
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			),
			this.pa3_Insect[3].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.MoveTo.create(1.5, cc.p(378, 200)),
						cc.DelayTime.create(0.2),
						cc.ScaleTo.create(0, -1, 1),
						cc.MoveTo.create(1.5, cc.p(478, 200)),
						cc.DelayTime.create(0.2),
						cc.ScaleTo.create(0, 1, 1),
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			),
			(this.pa3_Pakkad_pos = cc.p(678, 93)),
			(this.pa3_Pakkad = cc.Sprite.create('RES/PA/1/pa3_Pakkad_1_2.png')),
			this.pa3_Pakkad.setPosition(
				cc.p(this.pa3_Pakkad_pos.x + 500, this.pa3_Pakkad_pos.y)
			),
			this.pa3_Pakkad.setScale(1),
			this.pa3_Pakkad.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Pakkad),
			(this.pa3_Pakkad_anim = cc.Animation.create()),
			this.pa3_Pakkad_anim.setDelayPerUnit(0.1),
			this.pa3_Pakkad_anim.addSpriteFrameWithFile(
				'RES/PA/1/pa3_Pakkad_1_2.png'
			),
			this.pa3_Pakkad_anim.addSpriteFrameWithFile(
				'RES/PA/1/pa3_Pakkad_1_1.png'
			),
			(this.pa3_Seed_pos = cc.p(690, 103)),
			(this.pa3_Seed_pos1 = cc.p(480, 300)),
			(this.pa3_Seed = cc.Sprite.create('RES/PA/1/pa3_Seed.png')),
			this.pa3_Seed.setPosition(
				cc.p(this.pa3_Seed_pos.x + 500, this.pa3_Seed_pos.y)
			),
			this.pa3_Seed.setScale(1),
			this.pa3_Seed.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Seed),
			(this.pa3_Seed_Flow = cc.Sprite.create(
				'RES/PA/1/pa3_Seed_Flow_1.png'
			)),
			this.pa3_Seed_Flow.setPosition(cc.p(25, 102)),
			this.pa3_Seed_Flow.setAnchorPoint(cc.p(1, 1)),
			this.pa3_Seed_Flow.setScale(1),
			this.pa3_Seed_Flow.setRotation(60),
			this.pa3_Seed_Flow.setTag(0),
			this.pa3_Seed_Flow.setVisible(!1),
			this.pa3_Seed.addChild(this.pa3_Seed_Flow),
			(this.pa3_Seed_Flow_anim = cc.Animation.create()),
			this.pa3_Seed_Flow_anim.setDelayPerUnit(0.1),
			this.pa3_Seed_Flow_anim.addSpriteFrameWithFile(
				'RES/PA/1/pa3_Seed_Flow_2.png'
			),
			this.pa3_Seed_Flow_anim.addSpriteFrameWithFile(
				'RES/PA/1/pa3_Seed_Flow_1.png'
			),
			this.pa3_Seed_Flow.runAction(
				cc.RepeatForever.create(
					cc.Animate.create(this.pa3_Seed_Flow_anim.clone())
				)
			),
			(this.pa3_Basket_pos = cc.p(140, 44)),
			(this.pa3_Basket = cc.Sprite.create('RES/PA/1/pa3_Basket.png')),
			this.pa3_Basket.setPosition(
				cc.p(this.pa3_Basket_pos.x - 300, this.pa3_Basket_pos.y)
			),
			this.pa3_Basket.setScale(1),
			this.pa3_Basket.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Basket),
			(this.pa3_Basket_Up = cc.Sprite.create(
				'RES/PA/1/pa3_Basket_Up.png'
			)),
			this.pa3_Basket_Up.setPosition(
				cc.p(this.pa3_Basket_pos.x - 300, this.pa3_Basket_pos.y)
			),
			this.pa3_Basket_Up.setScale(1),
			this.pa3_Basket_Up.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Basket_Up, 2);
		e = 4;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 5;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 6;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.lyl_part[e].setScale(0),
			this.lyl_part[e].setPosition(cc.p(0, 0)),
			this.lyl_play.addChild(this.lyl_part[e]);
	},
	startNextPart: function () {
		if (0 == this.current_part)
			this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part &&
					(this.setTouchOff(0.1),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0));
		else if (1 == this.current_part)
			this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part
					? (this.pa1_Big_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(3),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Big_Panda_pos1.x,
										this.pa1_Big_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  this.pa1_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.5),
								cc.MoveTo.create(0.3, this.pa1_Panda_pos1),
								cc.DelayTime.create(2.2),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Panda_pos1.x,
										this.pa1_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  this.current_sub_part++,
					  this.setTouchOff(3.4),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 3.3))
					: 2 == this.current_sub_part
					? (this.pa1_Big_Panda.setScale(0),
					  this.pa1_Panda.setScale(0),
					  (c = comman.GetAnimatonDuration(
							this.pa1_Masin_Panda,
							'animation'
					  )),
					  this.pa1_Masin_Panda.setTag(1),
					  this.pa1_Masin_Panda.runAction(
							cc.MoveTo.create(c, this.pa1_Masin_Panda_pos1)
					  ),
					  this.pa1_Masin_Panda.setAnimation(1, 'animation', !1),
					  this.setTouchOff(c + 0.1),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, c))
					: 3 == this.current_sub_part &&
					  ((c = comman.GetAnimatonDuration(
							this.pa1_Masin_Panda,
							'animation'
					  )),
					  this.pa1_Masin_Panda.setTag(1),
					  this.pa1_Masin_Panda.setPosition(
							cc.p(
								this.pa1_Masin_Panda_pos3.x - 400,
								this.pa1_Masin_Panda_pos3.y
							)
					  ),
					  this.pa1_Masin_Panda.setScaleX(-1),
					  this.pa1_Masin_Panda.runAction(
							cc.MoveTo.create(c, this.pa1_Masin_Panda_pos3)
					  ),
					  this.pa1_Masin_Panda.setAnimation(1, 'animation', !1),
					  this.setTouchOff(c + 0.1),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, c));
		else if (2 == this.current_part)
			if (
				(this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				this.pa2_Supdi.runAction(
					cc.MoveTo.create(0.2, this.pa2_Supdi_pos)
				),
					this.pa2_Broom.runAction(
						cc.MoveTo.create(0.2, this.pa2_Broom_pos)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (2 == this.current_sub_part) {
				this.pa2_Supdi.runAction(cc.MoveBy.create(0.3, cc.p(-500, 0))),
					this.pa2_Broom.runAction(
						cc.MoveBy.create(0.3, cc.p(-500, 0))
					);
				for (var e = 1; e < this.pa2_dirt_pos.length; e++)
					this.pa2_dirt[e].runAction(
						cc.MoveBy.create(0.3, cc.p(-500, 0))
					);
				this.setTouchOff(0.4),
					this.current_sub_part++,
					this.unschedule(this.startNextPart_call),
					this.scheduleOnce(this.startNextPart_call, 0.3);
			} else if (3 == this.current_sub_part) {
				for (e = 1; e < this.pa2_dirt_pos.length; e++)
					this.pa2_dirt[e].setScale(0);
				this.pa2_Slove.runAction(
					cc.MoveTo.create(0.2, this.pa2_Slove_pos)
				),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd1),
					this.scheduleOnce(this.RandomCommonHandInd1, 0.2);
			} else {
				var t, c;
				4 == this.current_sub_part
					? (this.pa2_Tree_Move.setTag(1),
					  this.pa2_Tree_Move.runAction(
							cc.MoveTo.create(0.2, this.pa2_Tree_Move_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 5 == this.current_sub_part
					? (this.pa2_Slove.setTag(1),
					  (t = this.pa2_Slove.getTag()),
					  (c = cc.p(
							this.pa2_Slove_pos1.x + this.pa2_Dhaglo_pos[t].x,
							this.pa2_Slove_pos1.y +
								this.pa2_Dhaglo_pos[t].y -
								30
					  )),
					  this.pa2_Slove.setPosition(cc.p(c.x + 500, c.y)),
					  this.pa2_Slove.runAction(
							cc.Sequence.create(
								cc.MoveTo.create(0.2, c),
								cc.RotateTo.create(0.1, -20),
								cc.RotateTo.create(0.1, 0)
							)
					  ),
					  this.pa2_Dhaglo[t].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.3),
								cc.Hide.create()
							)
					  ),
					  this.pa2_Slove_Dhaglo.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.3),
								cc.Show.create()
							)
					  ),
					  this.setTouchOff(0.5),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.4))
					: 6 == this.current_sub_part
					? (this.pa2_Tree.setVisible(!0),
					  this.pa2_Stand_Move.setTag(1),
					  this.pa2_Stand_Move.runAction(
							cc.MoveTo.create(0.2, this.pa2_Stand_Move_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 7 == this.current_sub_part
					? (this.pa2_Stamb_Move[this.pa2_Stamb_Curr].setTag(1),
					  this.pa2_Stamb_Move[this.pa2_Stamb_Curr].runAction(
							cc.MoveTo.create(
								0.2,
								this.pa2_Stamb_Move_pos[this.pa2_Stamb_Curr]
							)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 8 == this.current_sub_part &&
					  (this.lyl_part[3].setScale(0),
					  this.bg.setTexture('RES/PA/1/Bg_1.png'),
					  this.pa2_Basket.runAction(
							cc.MoveTo.create(0.2, this.pa2_Basket_pos)
					  ),
					  this.showDone());
			}
		else if (3 == this.current_part)
			if (
				(this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				this.bg.setTexture('RES/PA/1/Bg_2.png'),
					this.pa3_Bottle.runAction(
						cc.MoveTo.create(0.2, this.pa3_Bottle_pos)
					),
					this.pa3_Bottle_Up.runAction(
						cc.MoveTo.create(0.2, this.pa3_Bottle_pos)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (2 == this.current_sub_part) {
				this.pa3_Bottle.runAction(cc.MoveBy.create(0.2, cc.p(-300, 0))),
					this.pa3_Bottle_Up.runAction(
						cc.MoveBy.create(0.2, cc.p(-300, 0))
					);
				for (e = 1; e <= 4; e++)
					this.pa3_Insect[e].stopAllActions(),
						this.pa3_Insect[e].runAction(
							cc.Sequence.create(
								cc.MoveBy.create(0.2, cc.p(-300, 0)),
								cc.ScaleTo.create(0, 0)
							)
						);
				for (e = 1; e <= 3; e++)
					this.pa3_Leaf[e].setTexture(
						'RES/PA/1/pa3_Leaf_' + e + '_Dirty_1.png'
					);
				this.pa3_Pakkad.setTag(1),
					this.pa3_Pakkad.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.2),
							cc.MoveTo.create(0.2, this.pa3_Pakkad_pos)
						)
					),
					this.setTouchOff(0.5),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.4);
			} else if (3 == this.current_sub_part) {
				for (e = 1; e <= 3; e++)
					this.pa3_Leaf[e].setTexture(
						'RES/PA/1/pa3_Leaf_' + e + '.png'
					);
				this.pa3_Seed.setTag(1),
					this.pa3_Seed.runAction(
						cc.Sequence.create(
							cc.MoveTo.create(0.2, this.pa3_Seed_pos)
						)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd1),
					this.scheduleOnce(this.RandomCommonHandInd1, 0.2);
			} else
				4 == this.current_sub_part &&
					(this.pa3_Basket.setTag(1),
					this.pa3_Basket.runAction(
						cc.Sequence.create(
							cc.MoveTo.create(0.2, this.pa3_Basket_pos)
						)
					),
					this.pa3_Basket_Up.runAction(
						cc.Sequence.create(
							cc.MoveTo.create(0.2, this.pa3_Basket_pos)
						)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2));
		else
			4 == this.current_part &&
				(this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part &&
					(this.setTouchOff(3),
					this.current_sub_part++,
					this.unschedule(this.startNextPart_call),
					this.scheduleOnce(this.startNextPart_call, 3)));
	},
	createPanels: function () {},
	updateRewardAds: function () {
		1 == comman.isRewardAdComplete
			? (this.rewardItem.getChildByName('rads').setVisible(!1),
			  (this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds))
			: 1 == comman.isRewardAdFailed &&
			  ((this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds));
	},
	startNextPart_call: function () {
		this.startNextPart();
	},
	startNextPart_call1: function () {
		this.startNextPart();
	},
	startNextPart_call2: function () {
		this.startNextPart();
	},
	checkLevelComplete: function () {
		this.showDone();
	},
	addDummyPoints: function () {
		this.dummyPoints = [cc.p(1562, 308)];
	},
	changeZorder: function (e, t, c) {
		e.setLocalZOrder(t);
	},
	changeTag: function (e, t) {
		e.setTag(t);
	},
	changeTexture: function (e, t) {
		e.setTexture(t);
	},
	buttonClickAction1: function (e) {
		var t = e.getScale();
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, t + 0.1),
				cc.ScaleTo.create(0.2, t)
			)
		);
	},
	buttonClickAction: function (e) {
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, 1.1),
				cc.ScaleTo.create(0.2, 1)
			)
		);
	},
	buttonSelectedAction: function (e) {
		e.runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.ScaleTo.create(0.5, 1.1),
					cc.ScaleTo.create(0.5, 1)
				)
			)
		);
	},
	onDoneClick: function (e) {
		0 != this.isTouchOn &&
			(this.hideDone(),
			this.setTouchOff(2.5),
			this.scheduleOnce(
				function () {
					this.onNextScene();
				},
				1,
				'onNextScene'
			));
	},
	onNextClick: function (e) {
		0 == this.isTouchOn ||
			0 < e.getNumberOfRunningActions() ||
			(comman.stopAllEffect(),
			comman.showInterstitial(),
			(this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackIn.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								comman.winSize().width +
									1.5 * this.btn_next.getContentSize().width,
								this.btn_next.getPositionY()
							)
						)
					)
				)
			),
			1 == this.current_part && 1 == this.current_sub_part
				? ((this.current_sub_sub_part = 1), (this.current_sub_part = 3))
				: 3 == this.current_part && 4 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 8),
				  (this.current_part = 2))
				: ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 1),
				  this.current_part++),
			this.startNextPart());
	},
	checkIsLevelDone: function () {
		this.isDoneShow;
	},
	update: function (e) {},
	onNextScene1: function (e) {
		(this.isNextShow = !1),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							0.55 * this.btn_next.getContentSize().height
						)
					)
				)
			),
			comman.stopAllEffect(),
			comman.showInterstitial(),
			cc.director.runScene(ChooseScene.scene());
	},
	onNextScene: function (e) {
		comman.stopAllEffect(),
			comman.showInterstitial(),
			selectedLevels++,
			cc.director.runScene(ChooseScene.scene());
	},
	setTouchOff: function (e) {
		(this.isTouchOn = !1),
			this.unschedule(this.setTouchEnable),
			this.scheduleOnce(this.setTouchEnable, e);
	},
	setTouchEnable: function () {
		this.isTouchOn = !0;
	},
	checkFullTouchObject: function (e, t) {
		return (
			!eventInTransparentMask(e, e.getParent().convertToWorldSpace(t)) &&
			1 == this.checkTouchObject(e, t)
		);
	},
	checkFullTouchObject1: function (e, t) {
		return (
			!eventInTransparentMask1(e, t) && 1 == this.checkTouchObject(e, t)
		);
	},
	checkTouchObject: function (e, t) {
		return cc.rectContainsPoint(
			e.getBoundingBox(),
			e.getParent().convertToNodeSpace(t)
		);
	},
	onTouchBegan: function (e, t) {
		var c = e.getLocation(),
			a = t.getCurrentTarget();
		a.startPos = c;
		a.startLocation = c;
		if (0 != a.isTouchOn) {
			if (1 == a.current_part)
				2 == a.current_sub_part
					? a.checkTouchObject(a.pa1_Masin_Panda, c) &&
					  0 == a.pa1_Masin_Panda.getNumberOfRunningActions() &&
					  (a.hideHint(),
					  (a.pa1_Masin_start = !0),
					  a.pa1_Masin_Panda.setAnimation(1, 'animation', !0),
					  a.dummyBrush.setScale(1.5, 1.5),
					  (a.dummyMoveDist = cc.p(-50, 45)))
					: 3 == a.current_sub_part &&
					  a.checkTouchObject(a.pa1_Masin_Panda, c) &&
					  0 == a.pa1_Masin_Panda.getNumberOfRunningActions() &&
					  (a.hideHint(),
					  (a.pa1_Masin_start = !0),
					  a.pa1_Masin_Panda.setAnimation(1, 'animation', !0),
					  a.dummyBrush.setScale(1.5, 1.5),
					  (a.dummyMoveDist = cc.p(50, 45)));
			else if (2 == a.current_part)
				1 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Broom, c) &&
					  0 == a.pa2_Broom.getNumberOfRunningActions() &&
					  1 == a.pa2_Broom.getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Broom),
					  (a.move_tool_pos = a.pa2_Broom.getPosition()),
					  (a.move_tool_rot = a.pa2_Broom.getRotation()),
					  (a.move_tool_scale = a.pa2_Broom.getScale()),
					  (a.move_tool_zorder = a.pa2_Broom.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(1.5),
					  (a.dummyMoveDist = cc.p(-10, -65)))
					: 3 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Slove, c) &&
					  a.pa2_Slove.getTag() < 5 &&
					  0 == a.pa2_Slove.getNumberOfRunningActions() &&
					  (a.hideHint(),
					  (e = a.pa2_Slove.getTag()),
					  (t = cc.p(
							a.pa2_Slove_pos1.x + a.pa2_Dhaglo_pos[e].x,
							a.pa2_Slove_pos1.y + a.pa2_Dhaglo_pos[e].y
					  )),
					  e <= 3
							? a.pa2_Slove.runAction(
									cc.Sequence.create(
										cc.RotateTo.create(0.1, -10),
										cc.RotateTo.create(0.1, 0),
										cc.MoveTo.create(0.2, t),
										cc.DelayTime.create(0.3),
										cc.MoveTo.create(0.2, a.pa2_Slove_pos)
									)
							  )
							: a.pa2_Slove.runAction(
									cc.Sequence.create(
										cc.RotateTo.create(0.1, -10),
										cc.RotateTo.create(0.1, 0),
										cc.MoveTo.create(0.2, t),
										cc.DelayTime.create(0.3),
										cc.MoveBy.create(0.2, cc.p(500, 0))
									)
							  ),
					  a.pa2_Slove_Dhaglo.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.1),
								cc.Show.create(),
								cc.DelayTime.create(0.3),
								cc.MoveBy.create(0.2, a.pa2_Slove_pos2),
								cc.Hide.create(),
								cc.MoveTo.create(0, cc.p(53, 51))
							)
					  ),
					  a.pa2_Dhaglo[e].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.6),
								cc.Show.create()
							)
					  ),
					  a.pa2_Hole.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.1),
								cc.callFunc(
									a.changeTexture,
									a.pa2_Hole,
									'RES/PA/1/pa2_Hole_' + e + '.png'
								),
								cc.Show.create()
							)
					  ),
					  a.pa2_Slove.setTag(a.pa2_Slove.getTag() + 1),
					  a.setTouchOff(1),
					  4 == e &&
							(a.current_sub_part++,
							a.unschedule(a.startNextPart),
							a.scheduleOnce(a.startNextPart, 1)))
					: 4 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Tree_Move, c) &&
					  0 == a.pa2_Tree_Move.getNumberOfRunningActions() &&
					  1 == a.pa2_Tree_Move.getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Tree_Move),
					  (a.move_tool_pos = a.pa2_Tree_Move.getPosition()),
					  (a.move_tool_rot = a.pa2_Tree_Move.getRotation()),
					  (a.move_tool_scale = a.pa2_Tree_Move.getScale()),
					  (a.move_tool_zorder = a.pa2_Tree_Move.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(0),
					  (a.dummyMoveDist = cc.p(0, 0)))
					: 5 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Slove, c) &&
					  0 == a.pa2_Slove.getNumberOfRunningActions() &&
					  a.pa2_Slove.getTag() <= 4 &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Slove),
					  (a.move_tool_pos = a.pa2_Slove.getPosition()),
					  (a.move_tool_rot = a.pa2_Slove.getRotation()),
					  (a.move_tool_scale = a.pa2_Slove.getScale()),
					  (a.move_tool_zorder = a.pa2_Slove.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(0),
					  (a.dummyMoveDist = cc.p(0, 0)))
					: 6 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Stand_Move, c) &&
					  0 == a.pa2_Stand_Move.getNumberOfRunningActions() &&
					  1 == a.pa2_Stand_Move.getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Stand_Move),
					  (a.move_tool_pos = a.pa2_Stand_Move.getPosition()),
					  (a.move_tool_rot = a.pa2_Stand_Move.getRotation()),
					  (a.move_tool_scale = a.pa2_Stand_Move.getScale()),
					  (a.move_tool_zorder = a.pa2_Stand_Move.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(0),
					  (a.dummyMoveDist = cc.p(0, 0)),
					  a.RandomCommonRoundInd2(1, a.pa2_Stand_Move_pos1))
					: 7 == a.current_sub_part &&
					  a.pa2_Stamb_Curr <= 3 &&
					  a.checkTouchObject(
							a.pa2_Stamb_Move[a.pa2_Stamb_Curr],
							c
					  ) &&
					  0 ==
							a.pa2_Stamb_Move[
								a.pa2_Stamb_Curr
							].getNumberOfRunningActions() &&
					  1 == a.pa2_Stamb_Move[a.pa2_Stamb_Curr].getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Stamb_Move[a.pa2_Stamb_Curr]),
					  (a.move_tool_pos =
							a.pa2_Stamb_Move[a.pa2_Stamb_Curr].getPosition()),
					  (a.move_tool_rot =
							a.pa2_Stamb_Move[a.pa2_Stamb_Curr].getRotation()),
					  (a.move_tool_scale =
							a.pa2_Stamb_Move[a.pa2_Stamb_Curr].getScale()),
					  (a.move_tool_zorder =
							a.pa2_Stamb_Move[
								a.pa2_Stamb_Curr
							].getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(0),
					  (a.dummyMoveDist = cc.p(0, 0)),
					  a.RandomCommonRoundInd2(
							1,
							a.pa2_Stamb_Move_pos1[a.pa2_Stamb_Curr]
					  ));
			else if (3 == a.current_part)
				if (1 == a.current_sub_part) {
					for (var o = 1; o <= 4; o++)
						if (
							a.checkTouchObject(a.pa3_Insect[o], c) &&
							1 == a.pa3_Insect[o].getNumberOfRunningActions() &&
							1 == a.pa3_Insect[o].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa3_Insect[o]),
								(a.move_tool_pos =
									a.pa3_Insect[o].getPosition()),
								(a.move_tool_rot =
									a.pa3_Insect[o].getRotation()),
								(a.move_tool_scale =
									a.pa3_Insect[o].getScale()),
								(a.move_tool_zorder =
									a.pa3_Insect[o].getLocalZOrder()),
								(a.move_tool_no = 1),
								a.move_tool.pause(),
								a.move_tool.setLocalZOrder(10),
								a.dummyBrush.setScale(0),
								(a.dummyMoveDist = cc.p(0, 0)),
								a.RandomCommonRoundInd2(1, cc.p(126, 154));
							break;
						}
				} else if (2 == a.current_sub_part)
					a.checkTouchObject(a.pa3_Pakkad, c) &&
						0 == a.pa3_Pakkad.getNumberOfRunningActions() &&
						1 == a.pa3_Pakkad.getTag() &&
						(a.hideHint(),
						(a.move_tool = a.pa3_Pakkad),
						(a.move_tool_pos = a.pa3_Pakkad.getPosition()),
						(a.move_tool_rot = a.pa3_Pakkad.getRotation()),
						(a.move_tool_scale = a.pa3_Pakkad.getScale()),
						(a.move_tool_zorder = a.pa3_Pakkad.getLocalZOrder()),
						(a.move_tool_no = 1),
						a.pa3_Pakkad.runAction(
							cc.RepeatForever.create(
								cc.Animate.create(a.pa3_Pakkad_anim.clone())
							)
						),
						a.move_tool.setLocalZOrder(10),
						a.dummyBrush.setScale(0.5),
						(a.dummyMoveDist = cc.p(-50, -10)));
				else if (3 == a.current_sub_part) {
					if (
						a.checkTouchObject(a.pa3_Seed, c) &&
						0 == a.pa3_Seed.getNumberOfRunningActions() &&
						1 == a.pa3_Seed.getTag()
					) {
						a.hideHint(),
							a.pa3_Seed.runAction(
								cc.Sequence.create(
									cc.MoveTo.create(0.2, a.pa3_Seed_pos1),
									cc.RotateTo.create(0.1, -90),
									cc.DelayTime.create(1),
									cc.RotateTo.create(0.1, 0),
									cc.MoveBy.create(0.3, cc.p(800, 0))
								)
							),
							a.pa3_Seed_Flow.runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.3),
									cc.Show.create(),
									cc.DelayTime.create(1),
									cc.Hide.create()
								)
							);
						for (o = 1; o <= 6; o++)
							a.pa3_Starw[o].runAction(
								cc.Sequence.create(
									cc.DelayTime.create(1.2),
									cc.ScaleTo.create(0.2, 1.1),
									cc.ScaleTo.create(0.1, 1)
								)
							),
								o <= 3 &&
									a.pa3_Leaf[o].runAction(
										cc.Sequence.create(
											cc.DelayTime.create(1),
											cc.Show.create()
										)
									);
						a.setTouchOff(1.8),
							a.current_sub_part++,
							a.unschedule(a.startNextPart),
							a.scheduleOnce(a.startNextPart, 1.7);
					}
				} else if (4 == a.current_sub_part)
					for (o = 1; o <= 6; o++)
						if (
							a.checkFullTouchObject(a.pa3_Starw[o], c) &&
							0 == a.pa3_Starw[o].getNumberOfRunningActions() &&
							1 == a.pa3_Starw[o].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa3_Starw[o]),
								(a.move_tool_pos =
									a.pa3_Starw[o].getPosition()),
								(a.move_tool_rot =
									a.pa3_Starw[o].getRotation()),
								(a.move_tool_scale = a.pa3_Starw[o].getScale()),
								(a.move_tool_zorder =
									a.pa3_Starw[o].getLocalZOrder()),
								(a.move_tool_no = 1),
								a.move_tool.setLocalZOrder(10),
								a.dummyBrush.setScale(0),
								(a.dummyMoveDist = cc.p(0, 0)),
								a.RandomCommonRoundInd2(1, cc.p(138, 55));
							break;
						}
			return !0;
		}
	},
	onTouchMoved: function (e, t) {
		var c = e.getLocation(),
			a = t.getCurrentTarget();
		a.endPos = c;
		var o, n, i, s, _, r;
		a.endLocation = c;
		0 != a.isTouchOn &&
			(null != a.move_tool
				? ((e = cc.p(c.x + a.dummyMoveDist.x, c.y + a.dummyMoveDist.y)),
				  (e = cc.p(c.x + a.dummyMoveDist.x, c.y + a.dummyMoveDist.y)),
				  a.move_tool.setPosition(
						a.move_tool.getParent().convertToNodeSpace(c)
				  ),
				  a.dummyBrush.setPosition(e),
				  2 == a.current_part
						? 1 == a.current_sub_part
							? ((_ = 1),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))),
							  (_ = 2),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))),
							  (_ = 3),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))),
							  (_ = 4),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))),
							  (_ = 5),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))),
							  (_ = 6),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))),
							  (_ = 7),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))),
							  (_ = 8),
							  a.checkTouchObject(
									a.dummyBrush,
									a.pa2_dirt[_].getPosition()
							  ) &&
									0 ==
										a.pa2_dirt[
											_
										].getNumberOfRunningActions() &&
									a.pa2_dirt[_].getTag() <= 5 &&
									((o = cc.p(
										a.pa2_dirt[_].getPositionX() -
											a.pa2_dirt_pos_part[_].x,
										a.pa2_dirt[_].getPositionY() -
											a.pa2_dirt_pos_part[_].y
									)),
									a.pa2_dirt[_].runAction(
										cc.MoveTo.create(0.2, o)
									),
									a.pa2_dirt[_].setTag(
										a.pa2_dirt[_].getTag() + 1
									),
									a.move_tool.runAction(
										cc.Sequence.create(
											cc.RotateTo.create(0.05, -5),
											cc.RotateTo.create(0.05, 0)
										)
									),
									6 == a.pa2_dirt[1].getTag() &&
										6 == a.pa2_dirt[2].getTag() &&
										6 == a.pa2_dirt[3].getTag() &&
										6 == a.pa2_dirt[4].getTag() &&
										6 == a.pa2_dirt[5].getTag() &&
										6 == a.pa2_dirt[6].getTag() &&
										6 == a.pa2_dirt[7].getTag() &&
										6 == a.pa2_dirt[8].getTag() &&
										(a.move_tool.setTag(2),
										(a.move_tool = null),
										(a.move_tool_no = 0),
										(a.move_tool_pos = cc.p(0, 0)),
										(a.move_tool_rot = 0),
										a.hideHint(),
										a.setTouchOff(0.4),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.4))))
							: 4 == a.current_sub_part
							? a.checkTouchObject(
									a.move_tool,
									a.pa2_Tree_Move_pos1
							  ) &&
							  0 ==
									a.pa2_Tree_Move.getNumberOfRunningActions() &&
							  1 == a.pa2_Tree_Move.getTag() &&
							  (a.pa2_Tree_Move.setTag(2),
							  a.pa2_Tree_Move.runAction(
									cc.Sequence.create(
										cc.JumpTo.create(
											0.2,
											a.pa2_Tree_Move_pos1,
											100,
											1
										),
										cc.Hide.create(),
										cc.ScaleTo.create(0, 0)
									)
							  ),
							  a.pa2_Tree.runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.2),
										cc.Show.create()
									)
							  ),
							  (a.move_tool = null),
							  (a.move_tool_no = 0),
							  (a.move_tool_pos = cc.p(0, 0)),
							  (a.move_tool_rot = 0),
							  a.hideHint(),
							  a.setTouchOff(0.2),
							  a.current_sub_part++,
							  a.unschedule(a.startNextPart),
							  a.scheduleOnce(a.startNextPart, 0.2))
							: 5 == a.current_sub_part
							? a.checkTouchObject(
									a.move_tool,
									a.pa2_Slove_pos
							  ) &&
							  0 == a.pa2_Slove.getNumberOfRunningActions() &&
							  a.pa2_Slove.getTag() <= 4 &&
							  ((t = a.pa2_Slove.getTag()) <= 3
									? ((o = cc.p(
											a.pa2_Slove_pos1.x +
												a.pa2_Dhaglo_pos[t + 1].x,
											a.pa2_Slove_pos1.y +
												a.pa2_Dhaglo_pos[t + 1].y -
												30
									  )),
									  a.pa2_Slove.runAction(
											cc.Sequence.create(
												cc.MoveTo.create(
													0.1,
													cc.p(
														a.pa2_Slove_pos.x,
														a.pa2_Slove_pos.y + 50
													)
												),
												cc.RotateTo.create(0.1, -10),
												cc.RotateTo.create(0.1, 0),
												cc.MoveTo.create(0.2, o),
												cc.RotateTo.create(0.1, -20),
												cc.RotateTo.create(0.1, 0)
											)
									  ),
									  a.pa2_Slove_Dhaglo.runAction(
											cc.Sequence.create(
												cc.DelayTime.create(0.1),
												cc.MoveBy.create(
													0.2,
													a.pa2_Slove_pos2
												),
												cc.Hide.create(),
												cc.MoveTo.create(
													0,
													cc.p(53, 51)
												),
												cc.DelayTime.create(0.2),
												cc.Show.create()
											)
									  ),
									  a.pa2_Dhaglo[t + 1].runAction(
											cc.Sequence.create(
												cc.DelayTime.create(0.5),
												cc.Hide.create()
											)
									  ))
									: a.pa2_Slove.runAction(
											cc.Sequence.create(
												cc.MoveTo.create(
													0.1,
													cc.p(
														a.pa2_Slove_pos.x,
														a.pa2_Slove_pos.y + 50
													)
												),
												cc.RotateTo.create(0.1, -10),
												cc.RotateTo.create(0.1, 0),
												cc.MoveBy.create(
													0.2,
													cc.p(800, 0)
												)
											)
									  ),
							  a.pa2_Dhaglo_Done.runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.3),
										cc.callFunc(
											a.changeTexture,
											a.pa2_Dhaglo_Done,
											'RES/PA/1/pa2_Dhaglo_Done_' +
												t +
												'.png'
										),
										cc.Show.create()
									)
							  ),
							  a.pa2_Slove.setTag(a.pa2_Slove.getTag() + 1),
							  a.setTouchOff(0.7),
							  4 == t &&
									(a.current_sub_part++,
									a.unschedule(a.startNextPart),
									a.scheduleOnce(a.startNextPart, 0.7)),
							  (a.move_tool = null),
							  (a.move_tool_no = 0),
							  (a.move_tool_pos = cc.p(0, 0)),
							  (a.move_tool_rot = 0),
							  a.hideHint())
							: 6 == a.current_sub_part
							? a.checkTouchObject(
									a.move_tool,
									a.pa2_Stand_Move_pos1
							  ) &&
							  0 ==
									a.pa2_Stand_Move.getNumberOfRunningActions() &&
							  1 == a.pa2_Stand_Move.getTag() &&
							  (a.pa2_Stand_Move.setTag(2),
							  a.pa2_Stand_Move.runAction(
									cc.Sequence.create(
										cc.MoveTo.create(
											0.2,
											a.pa2_Stand_Move_pos1
										),
										cc.Hide.create(),
										cc.ScaleTo.create(0, 0)
									)
							  ),
							  a.pa2_Stand.runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.2),
										cc.Show.create()
									)
							  ),
							  a.pa2_Stand_Up.runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.2),
										cc.Show.create()
									)
							  ),
							  (a.move_tool = null),
							  (a.move_tool_no = 0),
							  (a.move_tool_pos = cc.p(0, 0)),
							  (a.move_tool_rot = 0),
							  a.hideHint(),
							  a.setTouchOff(0.2),
							  a.current_sub_part++,
							  a.unschedule(a.startNextPart),
							  a.scheduleOnce(a.startNextPart, 0.2))
							: 7 == a.current_sub_part &&
							  a.checkTouchObject(
									a.move_tool,
									a.pa2_Stamb_Move_pos1[a.pa2_Stamb_Curr]
							  ) &&
							  0 ==
									a.pa2_Stamb_Move[
										a.pa2_Stamb_Curr
									].getNumberOfRunningActions() &&
							  1 ==
									a.pa2_Stamb_Move[
										a.pa2_Stamb_Curr
									].getTag() &&
							  (a.pa2_Stamb_Move[a.pa2_Stamb_Curr].setTag(2),
							  a.pa2_Stamb_Move[a.pa2_Stamb_Curr].runAction(
									cc.Sequence.create(
										cc.MoveTo.create(
											0.2,
											a.pa2_Stamb_Move_pos1[
												a.pa2_Stamb_Curr
											]
										),
										cc.Hide.create(),
										cc.ScaleTo.create(0, 0)
									)
							  ),
							  a.pa2_Stamb[a.pa2_Stamb_Curr].runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.2),
										cc.Show.create()
									)
							  ),
							  (a.move_tool = null),
							  (a.move_tool_no = 0),
							  (a.move_tool_pos = cc.p(0, 0)),
							  (a.move_tool_rot = 0),
							  a.hideHint(),
							  a.pa2_Stamb_Curr++,
							  a.pa2_Stamb_Curr <= 3
									? (a.setTouchOff(0.4),
									  a.pa2_Stamb_Move[a.pa2_Stamb_Curr].setTag(
											1
									  ),
									  a.pa2_Stamb_Move[
											a.pa2_Stamb_Curr
									  ].runAction(
											cc.Sequence.create(
												cc.DelayTime.create(0.2),
												cc.MoveTo.create(
													0.2,
													a.pa2_Stamb_Move_pos[
														a.pa2_Stamb_Curr
													]
												)
											)
									  ))
									: (a.setTouchOff(0.2),
									  a.unschedule(a.showNext),
									  a.scheduleOnce(a.showNext, 0.2)))
						: 3 == a.current_part &&
						  (1 == a.current_sub_part
								? a.checkTouchObject(a.pa3_Bottle, c) &&
								  1 == a.move_tool.getTag() &&
								  (a.pa3_Insect_comp++,
								  a.move_tool.setTag(2),
								  a.move_tool.stopAllActions(),
								  a.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveTo.create(
												0.2,
												cc.p(125, 160)
											),
											cc.callFunc(
												a.changeZorder,
												a.move_tool,
												0
											),
											cc.Spawn.create(
												cc.MoveTo.create(
													0.2,
													a.pa3_Insect_pos1[
														a.pa3_Insect_comp
													]
												)
											)
										)
								  ),
								  (a.move_tool = null),
								  (a.move_tool_no = 0),
								  (a.move_tool_pos = cc.p(0, 0)),
								  (a.move_tool_rot = 0),
								  a.hideHint(),
								  a.setTouchOff(0.4),
								  4 == a.pa3_Insect_comp &&
										(a.setTouchOff(0.7),
										a.current_sub_part++,
										a.unschedule(a.startNextPart),
										a.scheduleOnce(a.startNextPart, 0.6)))
								: 2 == a.current_sub_part
								? ((_ = 1),
								  a.checkFullTouchObject(a.pa3_Leaf[_], e) &&
										a.pa3_Leaf[_].getTag() <= 3 &&
										0 ==
											a.pa3_Leaf[
												_
											].getNumberOfRunningActions() &&
										(a.pa3_Leaf[_].setTag(
											a.pa3_Leaf[_].getTag() + 1
										),
										a.pa3_Leaf[_].runAction(
											cc.DelayTime.create(0.2)
										),
										a.pa3_Leaf[_].getTag() <= 3
											? a.pa3_Leaf[_].setTexture(
													'RES/PA/1/pa3_Leaf_' +
														_ +
														'_Dirty_' +
														a.pa3_Leaf[_].getTag() +
														'.png'
											  )
											: a.pa3_Leaf[_].setVisible(!1),
										4 == a.pa3_Leaf[1].getTag() &&
											4 == a.pa3_Leaf[2].getTag() &&
											4 == a.pa3_Leaf[3].getTag() &&
											(a.move_tool.stopAllActions(),
											a.move_tool.runAction(
												cc.MoveBy.create(
													0.3,
													cc.p(1e3, 0)
												)
											),
											(a.move_tool = null),
											(a.move_tool_no = 0),
											(a.move_tool_pos = cc.p(0, 0)),
											(a.move_tool_rot = 0),
											a.hideHint(),
											a.setTouchOff(0.4),
											a.current_sub_part++,
											a.unschedule(a.startNextPart),
											a.scheduleOnce(
												a.startNextPart,
												0.3
											))),
								  (_ = 2),
								  a.checkFullTouchObject(a.pa3_Leaf[_], e) &&
										a.pa3_Leaf[_].getTag() <= 3 &&
										0 ==
											a.pa3_Leaf[
												_
											].getNumberOfRunningActions() &&
										(a.pa3_Leaf[_].setTag(
											a.pa3_Leaf[_].getTag() + 1
										),
										a.pa3_Leaf[_].runAction(
											cc.DelayTime.create(0.2)
										),
										a.pa3_Leaf[_].getTag() <= 3
											? a.pa3_Leaf[_].setTexture(
													'RES/PA/1/pa3_Leaf_' +
														_ +
														'_Dirty_' +
														a.pa3_Leaf[_].getTag() +
														'.png'
											  )
											: a.pa3_Leaf[_].setVisible(!1),
										4 == a.pa3_Leaf[1].getTag() &&
											4 == a.pa3_Leaf[2].getTag() &&
											4 == a.pa3_Leaf[3].getTag() &&
											(a.move_tool.stopAllActions(),
											a.move_tool.runAction(
												cc.MoveBy.create(
													0.3,
													cc.p(1e3, 0)
												)
											),
											(a.move_tool = null),
											(a.move_tool_no = 0),
											(a.move_tool_pos = cc.p(0, 0)),
											(a.move_tool_rot = 0),
											a.hideHint(),
											a.setTouchOff(0.4),
											a.current_sub_part++,
											a.unschedule(a.startNextPart),
											a.scheduleOnce(
												a.startNextPart,
												0.3
											))),
								  (_ = 3),
								  a.checkFullTouchObject(a.pa3_Leaf[_], e) &&
										a.pa3_Leaf[_].getTag() <= 3 &&
										0 ==
											a.pa3_Leaf[
												_
											].getNumberOfRunningActions() &&
										(a.pa3_Leaf[_].setTag(
											a.pa3_Leaf[_].getTag() + 1
										),
										a.pa3_Leaf[_].runAction(
											cc.DelayTime.create(0.2)
										),
										a.pa3_Leaf[_].getTag() <= 3
											? a.pa3_Leaf[_].setTexture(
													'RES/PA/1/pa3_Leaf_' +
														_ +
														'_Dirty_' +
														a.pa3_Leaf[_].getTag() +
														'.png'
											  )
											: a.pa3_Leaf[_].setVisible(!1),
										4 == a.pa3_Leaf[1].getTag() &&
											4 == a.pa3_Leaf[2].getTag() &&
											4 == a.pa3_Leaf[3].getTag() &&
											(a.move_tool.stopAllActions(),
											a.move_tool.runAction(
												cc.MoveBy.create(
													0.3,
													cc.p(1e3, 0)
												)
											),
											(a.move_tool = null),
											(a.move_tool_no = 0),
											(a.move_tool_pos = cc.p(0, 0)),
											(a.move_tool_rot = 0),
											a.hideHint(),
											a.setTouchOff(0.4),
											a.current_sub_part++,
											a.unschedule(a.startNextPart),
											a.scheduleOnce(
												a.startNextPart,
												0.3
											))))
								: 4 == a.current_sub_part &&
								  a.checkTouchObject(a.pa3_Basket, c) &&
								  1 == a.move_tool.getTag() &&
								  (a.pa3_Starw_como++,
								  a.move_tool.setLocalZOrder(0),
								  a.move_tool.setTag(2),
								  a.move_tool.stopAllActions(),
								  a.move_tool.runAction(
										cc.Sequence.create(
											cc.JumpTo.create(
												0.2,
												a.pa3_Starw_pos1[
													a.pa3_Starw_como
												],
												50,
												1
											)
										)
								  ),
								  (a.move_tool = null),
								  (a.move_tool_no = 0),
								  (a.move_tool_pos = cc.p(0, 0)),
								  (a.move_tool_rot = 0),
								  a.hideHint(),
								  a.setTouchOff(0.2),
								  6 == a.pa3_Starw_como &&
										(a.setTouchOff(0.5),
										a.unschedule(a.showNext),
										a.scheduleOnce(a.showNext, 0.4)))))
				: 1 == a.current_part &&
				  (2 == a.current_sub_part
						? 1 == a.pa1_Masin_start &&
						  1 == a.pa1_Masin_Panda.getTag() &&
						  ((n = a.startLocation.x - a.endLocation.x),
						  (i = a.pa1_Masin_Panda.getPositionX() - n) <
								a.pa1_Masin_Panda.getPositionX() &&
								c.x < a.pa1_Masin_Panda.getPositionX() &&
								(a.pa1_Masin_Panda.setPositionX(i),
								(s = cc.p(
									a.pa1_Masin_Panda.getPositionX() +
										a.dummyMoveDist.x,
									a.pa1_Masin_Panda.getPositionY() +
										a.dummyMoveDist.y
								)),
								a.dummyBrush.setPosition(s)),
						  (a.startLocation = a.endLocation),
						  (_ = 1),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 2),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 3),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 4),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 5),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 6),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 7),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 8),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  a.pa1_Masin_Panda.getPositionX() <
								a.pa1_Masin_Panda_pos2.x &&
								((r = comman.GetAnimatonDuration(
									a.pa1_Masin_Panda,
									'animation'
								)),
								a.pa1_Masin_Panda.setTag(1),
								a.pa1_Masin_Panda.runAction(
									cc.MoveTo.create(
										r,
										cc.p(
											a.pa1_Masin_Panda_pos2.x - 400,
											a.pa1_Masin_Panda_pos2.y
										)
									)
								),
								a.pa1_Masin_Panda.setAnimation(
									1,
									'animation',
									!1
								),
								a.current_sub_part++,
								a.setTouchOff(r + 0.1),
								a.unschedule(a.startNextPart),
								a.scheduleOnce(a.startNextPart, r)))
						: 3 == a.current_sub_part &&
						  1 == a.pa1_Masin_start &&
						  1 == a.pa1_Masin_Panda.getTag() &&
						  ((n = a.startLocation.x - a.endLocation.x),
						  (i = a.pa1_Masin_Panda.getPositionX() - n) >
								a.pa1_Masin_Panda.getPositionX() &&
								c.x > a.pa1_Masin_Panda.getPositionX() &&
								(a.pa1_Masin_Panda.setPositionX(i),
								(s = cc.p(
									a.pa1_Masin_Panda.getPositionX() +
										a.dummyMoveDist.x,
									a.pa1_Masin_Panda.getPositionY() +
										a.dummyMoveDist.y
								)),
								a.dummyBrush.setPosition(s)),
						  (a.startLocation = a.endLocation),
						  (_ = 1),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 2),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 3),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 4),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 5),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 6),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 7),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  (_ = 8),
						  a.checkTouchObject(
								a.dummyBrush,
								a.pa1_grass_pos[_]
						  ) &&
								1 == a.pa1_grass[_].getTag() &&
								(a.pa1_grass[_].setTag(2),
								a.pa1_grass[_].runAction(
									cc.ScaleTo.create(0.1, 0)
								)),
						  a.pa1_Masin_Panda.getPositionX() >
								a.pa1_Masin_Panda_pos4.x &&
								((r = comman.GetAnimatonDuration(
									a.pa1_Masin_Panda,
									'animation'
								)),
								a.pa1_Masin_Panda.setTag(1),
								a.pa1_Masin_Panda.runAction(
									cc.MoveTo.create(
										r,
										cc.p(
											a.pa1_Masin_Panda_pos4.x + 400,
											a.pa1_Masin_Panda_pos4.y
										)
									)
								),
								a.pa1_Masin_Panda.setAnimation(
									1,
									'animation',
									!1
								),
								a.current_part++,
								(a.current_sub_part = 1),
								a.setTouchOff(r + 0.1),
								a.unschedule(a.startNextPart),
								a.scheduleOnce(a.startNextPart, r)))));
	},
	onTouchEnded: function (e, t) {
		(e = e.getLocation()), (t = t.getCurrentTarget());
		0 != t.isTouchOn &&
			(1 == t.current_part &&
				((2 != t.current_sub_part && 3 != t.current_sub_part) ||
					(1 == t.pa1_Masin_start &&
						(t.pa1_Masin_Panda.clearTracks(),
						(t.pa1_Masin_start = !1)))),
			null != t.move_tool &&
				(3 == t.current_part &&
					2 == t.current_sub_part &&
					(t.pa3_Pakkad.stopAllActions(),
					t.pa3_Pakkad.setTexture('RES/PA/1/pa3_Pakkad_1_2.png')),
				3 == t.current_part && 1 == t.current_sub_part
					? (t.move_tool.resume(),
					  t.move_tool.runAction(
							cc.Sequence.create(
								cc.Spawn.create(
									cc.MoveTo.create(0.2, t.move_tool_pos)
								),
								cc.callFunc(
									t.changeZorder,
									t.move_tool,
									t.move_tool_zorder
								)
							)
					  ))
					: t.move_tool.runAction(
							cc.Sequence.create(
								cc.Spawn.create(
									cc.MoveTo.create(0.2, t.move_tool_pos),
									cc.ScaleTo.create(0.2, t.move_tool_scale),
									cc.RotateTo.create(0.2, t.move_tool_rot)
								),
								cc.callFunc(
									t.changeZorder,
									t.move_tool,
									t.move_tool_zorder
								)
							)
					  ),
				t.move_tool.getParent().convertToNodeSpace(e),
				(t.move_tool = null),
				(t.move_tool_no = 0),
				(t.move_tool_pos = cc.p(0, 0)),
				(t.move_tool_rot = 0),
				t.hideHint(),
				t.setTouchOff(0.2)));
	},
	onMouseMove: function (e) {
		var t = e.getLocation(),
			e = e.getCurrentTarget();
		cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) &&
		1 == e.btn_more.getScale() &&
		0 == e.btn_more.getNumberOfRunningActions() &&
		255 == e.btn_more.getOpacity()
			? (e.prt_Sparkle.setPosition(e.btn_more.getPosition()),
			  e.prt_Sparkle.resetSystem(),
			  e.btn_more.setScale(1.03))
			: 1.03 != e.btn_more.getScale() ||
			  cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) ||
			  0 != e.btn_more.getNumberOfRunningActions() ||
			  255 != e.btn_more.getOpacity()
			? cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) &&
			  1 == e.btn_done.getScale() &&
			  0 == e.btn_done.getNumberOfRunningActions() &&
			  255 == e.btn_done.getOpacity()
				? (e.prt_Sparkle.setPosition(e.btn_done.getPosition()),
				  e.prt_Sparkle.resetSystem(),
				  e.btn_done.setScale(1.03))
				: 1.03 != e.btn_done.getScale() ||
				  cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) ||
				  0 != e.btn_done.getNumberOfRunningActions() ||
				  255 != e.btn_done.getOpacity() ||
				  e.btn_done.setScale(1)
			: e.btn_more.setScale(1);
	},
	onMoreApp: function (e) {
		101 == e.getTag()
			? CreateLinksInGame(comman.GameId, 'game', 'more')
			: CreateLinksInGame(comman.GameId, 'game', 'logo');
	},
	onMusicButton: function (e) {
		0 == e.getNumberOfRunningActions() &&
			(e.stopAllActions(),
			e.runAction(
				cc.Sequence.create(
					cc.ScaleTo.create(0, 1),
					cc.ScaleTo.create(0.2, 0.9),
					cc.ScaleTo.create(0.2, 1)
				)
			),
			comman.isMusicEnable
				? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
				  comman.setSoundEnabled(!1))
				: comman.isMusicEnable ||
				  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
				  comman.setSoundEnabled(!0)));
	},
	createMainMenu: function () {
		(this.btn_bb_icon = cc.MenuItemImage.create(
			res_comman.bb_icon_3,
			res_comman.bb_icon_3,
			this.onMoreApp,
			this
		)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.5 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.5 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.MainMenu = cc.Menu.create(this.btn_bb_icon, this.btn_music)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 200);
	},
});
PlayScene_1.scene = function () {
	var e = new cc.Scene(),
		t = new PlayScene_1();
	return e.addChild(t), e;
};
var PlayScene_2 = cc.Scene.extend({
	ctor: function () {
		this._super(), this.init();
	},
	onEnter: function () {
		this._super(),
			cc.eventManager.addListener(
				{
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this.onTouchBegan,
					onTouchMoved: this.onTouchMoved,
					onTouchEnded: this.onTouchEnded,
				},
				this
			),
			'mouse' in cc.sys.capabilities &&
				cc.eventManager.addListener(
					{
						event: cc.EventListener.MOUSE,
						onMouseMove: this.onMouseMove,
					},
					this
				);
	},
	init: function () {
		this._super(),
			(this.startPos = cc.p(0, 0)),
			(this.endPos = cc.p(0, 0)),
			(this.isDoneShow = !1),
			(this.isNextShow = !1),
			(this.lyl_puzzles = null),
			(this.move_tool = null),
			(this.move_tool_no = 0),
			(this.move_tool_rot = 0),
			(this.move_tool_s_pos = cc.p(1e4, 1e4)),
			(this.isTouchOn = !1),
			(this.current_part = 1),
			(this.current_sub_part = 1),
			(this.current_sub_sub_part = 1),
			(this.current_tool = 1),
			this.setTouchOff(0.1),
			(this.bg = cc.Sprite.create('RES/PA/2/Bg_1.png')),
			this.bg.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.bg.setScale(1),
			this.addChild(this.bg),
			(this.dummyPoints = []),
			this.createPlayarea(),
			this.createPanels(),
			(this.btn_bb_icon = cc.MenuItemImage.create(
				res_comman.bb_icon_3,
				res_comman.bb_icon_3,
				this.onMoreApp,
				this
			)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_more = cc.MenuItemImage.create(
				res_common_button.btn_more,
				res_common_button.btn_more,
				this.onMoreApp,
				this
			)),
			this.btn_more.setScale(1),
			this.btn_more.setTag(101),
			this.btn_more.setPosition(
				cc.p(
					comman.winSize().width -
						1.6 * this.btn_more.getContentSize().width,
					comman.winSize().height +
						0.55 * this.btn_more.getContentSize().height
				)
			),
			this.btn_more.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							this.btn_more.getPositionX(),
							comman.winSize().height -
								0.55 * this.btn_more.getContentSize().height
						)
					)
				)
			),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.55 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.55 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.btn_done = cc.MenuItemImage.create(
				res_common_button.btn_done,
				res_common_button.btn_done,
				this.onDoneClick,
				this
			)),
			this.btn_done.setScale(1),
			this.btn_done.setTag(101),
			this.btn_done.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_done.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_done.getContentSize().height
				)
			),
			(this.btn_next = cc.MenuItemImage.create(
				res_common_button.btn_next,
				res_common_button.btn_next,
				this.onNextClick,
				this
			)),
			this.btn_next.setScale(1),
			this.btn_next.setTag(101),
			this.btn_next.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_next.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_next.getContentSize().height
				)
			),
			(this.MainMenu = cc.Menu.create(
				this.btn_bb_icon,
				this.btn_done,
				this.btn_more,
				this.btn_music,
				this.btn_next
			)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 100),
			(this.prt_Sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_1_plist
			)),
			this.prt_Sparkle.setScale(1.5),
			this.prt_Sparkle.stopSystem(),
			this.addChild(this.prt_Sparkle),
			this.prt_Sparkle.setLocalZOrder(500),
			(this.prt_tool_sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_2_plist
			)),
			this.prt_tool_sparkle.setScale(1),
			this.prt_tool_sparkle.stopSystem(),
			this.addChild(this.prt_tool_sparkle),
			this.prt_tool_sparkle.setLocalZOrder(500),
			(this.CommonHandIndicator = cc.Sprite.create(
				res_common_button.arrow_ind_3_img
			)),
			this.CommonHandIndicator.setScale(0),
			this.CommonHandIndicator.setAnchorPoint(cc.p(0.55, 0.1)),
			this.addChild(this.CommonHandIndicator, 10),
			this.CommonHandIndicator.setPosition(cc.p(25e3, 25e3)),
			(this.CommonRoundIndicator = []);
		for (var e = 0; e < 15; e++)
			(this.CommonRoundIndicator[e] = cc.Sprite.create(
				res_common_button.indicator_img
			)),
				this.CommonRoundIndicator[e].setScale(0),
				this.CommonRoundIndicator[e].setAnchorPoint(cc.p(0.5, 0.5)),
				this.CommonRoundIndicator[e].setColor(cc.color(0, 255, 0)),
				this.addChild(this.CommonRoundIndicator[e], 10),
				this.CommonRoundIndicator[e].setPosition(cc.p(25e3, 25e3));
		this.CommonRoundIndicator1 = [];
		for (e = 0; e < 15; e++)
			(this.CommonRoundIndicator1[e] = cc.Sprite.create(
				res_common_button.arrow
			)),
				this.CommonRoundIndicator1[e].setScale(0),
				this.CommonRoundIndicator1[e].setAnchorPoint(cc.p(0.5, 0)),
				this.addChild(this.CommonRoundIndicator1[e], 10),
				this.CommonRoundIndicator1[e].setPosition(cc.p(25e3, 25e3));
		this.startNextPart();
	},
	RandomCommonHandInd: function () {
		var e, t;
		2 == this.current_part
			? 1 == this.current_sub_part &&
			  ((e = cc.p(664, 143)),
			  (t = cc.p(291, 217)),
			  this.RandomCommonHandIndOneWay(e, t))
			: 3 == this.current_part &&
			  (1 == this.current_sub_part
					? ((e = this.pa3_Wood_Move_pos),
					  (t = this.pa3_Wood_Move_pos1),
					  this.RandomCommonHandIndOneWay(e, t))
					: 3 == this.current_sub_part
					? ((e = this.pa3_Bucket_pos[comman.getRandomInt(1, 3)]),
					  (t = cc.p(391, 160)),
					  this.RandomCommonHandIndOneWay(e, t))
					: 4 == this.current_sub_part &&
					  ((e = this.pa3_Gun1_pos),
					  (t = cc.p(395, 328)),
					  this.RandomCommonHandIndOneWay(e, t)));
	},
	RandomCommonHandInd1: function () {
		var e;
		2 == this.current_part
			? 2 == this.current_sub_part &&
			  ((e = cc.p(142, 248)), this.RandomCommonHandIndJump(e))
			: 3 == this.current_part &&
			  2 == this.current_sub_part &&
			  ((e = this.pa3_Hummer_pos[this.pa3_Screw_comm]),
			  this.RandomCommonHandIndJump(e));
	},
	RandomCommonHandIndOneWay: function (e, t) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(0.5, t),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(1)
					)
				)
			);
	},
	RandomCommonHandIndTwoWay: function (e, t, c) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, e),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, c),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay1: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(2, c),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndJump: function (e) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.JumpTo.create(1.5, e, 5, 2),
						cc.ScaleTo.create(0, 0),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonRoundInd: function (e) {},
	RandomCommonRoundInd1: function (e) {
		this.CommonRoundIndicator[1].setPosition(e),
			this.CommonRoundIndicator[1].stopAllActions(),
			this.CommonRoundIndicator[1].setScale(1),
			this.CommonRoundIndicator[1].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	RandomCommonRoundInd2: function (e, t) {
		this.CommonRoundIndicator[e].setPosition(t),
			this.CommonRoundIndicator[e].stopAllActions(),
			this.CommonRoundIndicator[e].setScale(1),
			this.CommonRoundIndicator[e].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	hideHint: function () {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setScale(0);
		for (var e = 0; e < 15; e++)
			this.CommonRoundIndicator[e].stopAllActions(),
				this.CommonRoundIndicator[e].setScale(0);
	},
	showToolCompleteParticle: function (e) {
		this.prt_tool_sparkle.setPosition(e),
			this.prt_tool_sparkle.resetSystem();
	},
	showDone: function () {
		0 == this.isDoneShow &&
			((this.isDoneShow = !0),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	showNext: function () {
		0 == this.isNextShow &&
			((this.isNextShow = !0),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	hideDone: function () {
		1 == this.isDoneShow &&
			((this.isDoneShow = !1),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	hideNext: function () {
		1 == this.isNextShow &&
			((this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	createPlayarea: function () {
		(this.dummyMoveDist = cc.p(0, 0)),
			(this.dummyBrush = cc.Sprite.create('RES/CB/brush.png')),
			this.dummyBrush.setPosition(cc.p(1e3, 1e3)),
			this.dummyBrush.setScale(0),
			this.dummyBrush.setOpacity(255),
			this.dummyBrush.setBlendFunc(cc.ZERO, cc.ONE_MINUS_SRC_ALPHA),
			this.addChild(this.dummyBrush, -100),
			(this.lyl_play = cc.Layer.create()),
			this.addChild(this.lyl_play),
			(this.lyl_part = []),
			(this.lyl_sub_part = []);
		var e = 0;
		(this.lyl_part[e] = cc.Layer.create()),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 1;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa1_Pillow = cc.Sprite.create(
				'RES/PA/2/pa1_Pillow_Messy.png'
			)),
			this.pa1_Pillow.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.pa1_Pillow.setScale(1),
			this.pa1_Pillow.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Pillow),
			(this.pa1_House = cc.Sprite.create('RES/PA/2/pa1_House_Dirty.png')),
			this.pa1_House.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.pa1_House.setScale(1),
			this.pa1_House.setTag(1),
			this.lyl_part[e].addChild(this.pa1_House),
			(this.pa1_Big_Panda_pos1 = cc.p(666, -70)),
			(this.pa1_Big_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Big_Panda.json',
				'RES/PA/anim/Big_Panda.atlas',
				0.5
			)),
			this.pa1_Big_Panda.setPosition(
				cc.p(this.pa1_Big_Panda_pos1.x, this.pa1_Big_Panda_pos1.y)
			),
			this.pa1_Big_Panda.setScale(1, 1),
			this.pa1_Big_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Big_Panda),
			this.pa1_Big_Panda.setAnimation(1, 'Sad', !0),
			(this.pa1_Panda_pos1 = cc.p(133, -30)),
			(this.pa1_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Panda.json',
				'RES/PA/anim/Panda.atlas',
				0.5
			)),
			this.pa1_Panda.setPosition(
				cc.p(this.pa1_Panda_pos1.x, this.pa1_Panda_pos1.y - 400)
			),
			this.pa1_Panda.setScale(1, 1),
			this.pa1_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Panda),
			this.pa1_Panda.setAnimation(1, 'Idle', !0),
			(this.pa1_Dog_pos1 = cc.p(724, 12)),
			(this.pa1_Dog_pos2 = cc.p(571, 38)),
			(this.pa1_Dog = new sp.SkeletonAnimation(
				'RES/PA/anim/Dog.json',
				'RES/PA/anim/Dog.atlas',
				0.5
			)),
			this.pa1_Dog.setPosition(
				cc.p(this.pa1_Dog_pos1.x + 200, this.pa1_Dog_pos1.y)
			),
			this.pa1_Dog.setScale(1, 1),
			this.pa1_Dog.setTag(0),
			this.lyl_part[e].addChild(this.pa1_Dog),
			this.pa1_Dog.setAnimation(1, 'Idle', !0),
			(this.pa1_Dog_Think = cc.Sprite.create(
				'RES/PA/2/pa1_Thinking_Popup.png'
			)),
			this.pa1_Dog_Think.setPosition(cc.p(0, 200)),
			this.pa1_Dog_Think.setAnchorPoint(cc.p(0.5, 0)),
			this.pa1_Dog_Think.setScale(1),
			this.pa1_Dog_Think.setTag(1),
			this.pa1_Dog.addChild(this.pa1_Dog_Think),
			(this.pa1_Dog_Think_img = cc.Sprite.create(
				'RES/PA/2/pa1_House_1.png'
			)),
			this.pa1_Dog_Think_img.setPosition(cc.p(27, 98)),
			this.pa1_Dog_Think_img.setScale(0.28),
			this.pa1_Dog_Think_img.setTag(1),
			this.pa1_Dog_Think.addChild(this.pa1_Dog_Think_img),
			(this.pa1_Cat_pos1 = cc.p(719, 19)),
			(this.pa1_Cat_pos2 = cc.p(212, 114)),
			(this.pa1_Cat = new sp.SkeletonAnimation(
				'RES/PA/anim/Cat.json',
				'RES/PA/anim/Cat.atlas',
				0.5
			)),
			this.pa1_Cat.setPosition(
				cc.p(this.pa1_Cat_pos1.x + 200, this.pa1_Cat_pos1.y)
			),
			this.pa1_Cat.setScale(1, 1),
			this.pa1_Cat.setTag(0),
			this.lyl_part[e].addChild(this.pa1_Cat),
			this.pa1_Cat.setAnimation(1, 'Idle', !0),
			(this.pa1_Cat_Think = cc.Sprite.create(
				'RES/PA/2/pa1_Thinking_Popup.png'
			)),
			this.pa1_Cat_Think.setPosition(cc.p(0, 180)),
			this.pa1_Cat_Think.setAnchorPoint(cc.p(0.5, 0)),
			this.pa1_Cat_Think.setScale(1),
			this.pa1_Cat_Think.setTag(1),
			this.pa1_Cat.addChild(this.pa1_Cat_Think),
			(this.pa1_Cat_Think_img = cc.Sprite.create(
				'RES/PA/2/pa1_Pillow_Done.png'
			)),
			this.pa1_Cat_Think_img.setPosition(cc.p(145, 130)),
			this.pa1_Cat_Think_img.setScale(0.38),
			this.pa1_Cat_Think_img.setTag(1),
			this.pa1_Cat_Think.addChild(this.pa1_Cat_Think_img);
		e = 2;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa2_Main = cc.Sprite.create('RES/PA/2/pa2_Main.png')),
			this.pa2_Main.setPosition(cc.p(400, 252)),
			this.pa2_Main.setScale(1),
			this.pa2_Main.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Main),
			(this.pa2_Pillow = cc.Sprite.create('RES/PA/2/pa2_Pillow_1.png')),
			this.pa2_Pillow.setPosition(cc.p(400, 252)),
			this.pa2_Pillow.setScale(1),
			this.pa2_Pillow.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Pillow),
			(this.pa2_Pillow_Up = cc.Sprite.create(
				'RES/PA/2/pa2_Pillow_1_Up.png'
			)),
			this.pa2_Pillow_Up.setPosition(cc.p(400, 252)),
			this.pa2_Pillow_Up.setScale(1),
			this.pa2_Pillow_Up.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Pillow_Up, 1),
			(this.pa2_doro_cur = 0),
			(this.pa2_doro = []),
			(this.pa2_doro_pos = [
				cc.p(140, 279),
				cc.p(142, 251),
				cc.p(195, 283),
				cc.p(195, 239),
				cc.p(249, 286),
				cc.p(249, 237),
				cc.p(302, 285),
				cc.p(304, 234),
				cc.p(351, 285),
				cc.p(352, 236),
				cc.p(394, 280),
				cc.p(395, 241),
				cc.p(432, 276),
				cc.p(432, 247),
				cc.p(482, 247),
			]);
		for (var t = 1; t <= 13; t++)
			(this.pa2_doro[t] = cc.Sprite.create(
				'RES/PA/2/pa2_doro_' + t + '.png'
			)),
				this.pa2_doro[t].setPosition(cc.p(400, 252)),
				this.pa2_doro[t].setScale(1),
				this.pa2_doro[t].setTag(1),
				this.pa2_doro[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa2_doro[t], 1);
		(this.pa2_Pillow_Done = cc.Sprite.create(
			'RES/PA/2/pa2_Pillow_Done.png'
		)),
			this.pa2_Pillow_Done.setPosition(cc.p(400, 252)),
			this.pa2_Pillow_Done.setScale(1),
			this.pa2_Pillow_Done.setTag(1),
			this.pa2_Pillow_Done.setVisible(!1),
			this.lyl_part[e].addChild(this.pa2_Pillow_Done, 2),
			(this.pa2_Main_Up = cc.Sprite.create('RES/PA/2/pa2_Main_Up.png')),
			this.pa2_Main_Up.setPosition(cc.p(400, 252)),
			this.pa2_Main_Up.setScale(1),
			this.pa2_Main_Up.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Main_Up, 2),
			(this.pa2_Basket_pos = cc.p(665, 128)),
			(this.pa2_Basket = cc.Sprite.create('RES/PA/2/pa2_Basket.png')),
			this.pa2_Basket.setPosition(
				cc.p(this.pa2_Basket_pos.x + 500, this.pa2_Basket_pos.y)
			),
			this.pa2_Basket.setScale(1),
			this.pa2_Basket.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Basket),
			(this.pa2_Basket_Up = cc.Sprite.create(
				'RES/PA/2/pa2_Basket_Up.png'
			)),
			this.pa2_Basket_Up.setPosition(
				cc.p(this.pa2_Basket_pos.x + 500, this.pa2_Basket_pos.y)
			),
			this.pa2_Basket_Up.setScale(1),
			this.pa2_Basket_Up.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Basket_Up, 2),
			(this.pa2_Cotton_comm = 1),
			(this.pa2_Cotton = []),
			(this.pa2_Cotton_pos = [
				cc.p(0, 0),
				cc.p(687, 161),
				cc.p(643, 161),
				cc.p(719, 144),
				cc.p(659, 146),
				cc.p(612, 140),
				cc.p(711, 110),
				cc.p(669, 108),
				cc.p(622, 113),
			]),
			(this.pa2_Cotton_pos1 = [
				cc.p(0, 0),
				cc.p(259, 199),
				cc.p(302, 195),
				cc.p(342, 197),
				cc.p(236, 204),
				cc.p(283, 199),
				cc.p(329, 198),
				cc.p(279, 202),
				cc.p(310, 200),
			]);
		for (t = this.pa2_Cotton_pos.length - 1; 1 <= t; t--)
			(this.pa2_Cotton[t] = cc.Sprite.create('RES/PA/2/pa2_Cotton.png')),
				this.pa2_Cotton[t].setPosition(
					cc.p(
						this.pa2_Cotton_pos[t].x + 500,
						this.pa2_Cotton_pos[t].y
					)
				),
				this.pa2_Cotton[t].setScale(1),
				this.pa2_Cotton[t].setTag(1),
				this.lyl_part[e].addChild(this.pa2_Cotton[t]);
		(this.pa2_Needle_pos = this.pa2_doro_pos[this.pa2_doro_cur]),
			(this.pa2_Needle = cc.Sprite.create('RES/PA/2/pa2_Needle.png')),
			this.pa2_Needle.setPosition(
				cc.p(this.pa2_Needle_pos.x - 500, this.pa2_Needle_pos.y)
			),
			this.pa2_Needle.setAnchorPoint(cc.p(0.5, 0.15)),
			this.pa2_Needle.setScale(1),
			this.pa2_Needle.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Needle, 3),
			(this.pa2_doro_Needle = cc.Sprite.create(
				'RES/PA/2/pa2_doro_Needle.png'
			)),
			this.pa2_doro_Needle.setPosition(cc.p(10, 20)),
			this.pa2_doro_Needle.setAnchorPoint(cc.p(0.5, 1)),
			this.pa2_doro_Needle.setScale(1),
			this.pa2_doro_Needle.setTag(1),
			this.pa2_Needle.addChild(this.pa2_doro_Needle, -1);
		e = 3;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa3_House = cc.Sprite.create('RES/PA/2/pa3_House.png')),
			this.pa3_House.setPosition(cc.p(400, 252)),
			this.pa3_House.setScale(1),
			this.pa3_House.setTag(1),
			this.lyl_part[e].addChild(this.pa3_House),
			(this.pa3_Roof = cc.Sprite.create('RES/PA/2/pa3_Roof_1.png')),
			this.pa3_Roof.setPosition(cc.p(400, 252)),
			this.pa3_Roof.setScale(1),
			this.pa3_Roof.setTag(1),
			this.pa3_Roof.setVisible(!1),
			this.lyl_part[e].addChild(this.pa3_Roof),
			(this.pa3_Dirty_Roof = cc.Sprite.create(
				'RES/PA/2/pa3_Dirty_Roof.png'
			)),
			this.pa3_Dirty_Roof.setPosition(cc.p(400, 252)),
			this.pa3_Dirty_Roof.setScale(1),
			this.pa3_Dirty_Roof.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Dirty_Roof),
			(this.pa3_Wood_Set = cc.Sprite.create('RES/PA/2/pa3_Wood_Set.png')),
			this.pa3_Wood_Set.setPosition(cc.p(400, 252)),
			this.pa3_Wood_Set.setScale(1),
			this.pa3_Wood_Set.setTag(1),
			this.pa3_Wood_Set.setVisible(!1),
			this.pa3_Dirty_Roof.addChild(this.pa3_Wood_Set),
			(this.pa3_rt_up = new cc.RenderTexture(800, 504)),
			this.pa3_rt_up.setPosition(cc.p(400, 252)),
			this.pa3_rt_up.setScale(1),
			this.lyl_part[e].addChild(this.pa3_rt_up),
			(this.pa3_Wood_Move_pos = cc.p(700, 100)),
			(this.pa3_Wood_Move_pos1 = cc.p(498, 283)),
			(this.pa3_Wood_Move = cc.Sprite.create(
				'RES/PA/2/pa3_Wood_Move.png'
			)),
			this.pa3_Wood_Move.setPosition(
				cc.p(this.pa3_Wood_Move_pos.x + 500, this.pa3_Wood_Move_pos.y)
			),
			this.pa3_Wood_Move.setScale(1),
			this.pa3_Wood_Move.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Wood_Move),
			(this.pa3_Gun1_pos = cc.p(636, 128)),
			(this.pa3_Gun1 = cc.Sprite.create('RES/PA/2/pa3_Gun1_Done.png')),
			this.pa3_Gun1.setPosition(
				cc.p(this.pa3_Gun1_pos.x + 500, this.pa3_Gun1_pos.y)
			),
			this.pa3_Gun1.setScale(0.8),
			this.pa3_Gun1.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Gun1),
			(this.pa3_Gun1_Colour = cc.Sprite.create(
				'RES/PA/2/pa3_Gun1_Colour_1.png'
			)),
			this.pa3_Gun1_Colour.setPosition(cc.p(170, 131)),
			this.pa3_Gun1_Colour.setScale(1),
			this.pa3_Gun1_Colour.setTag(0),
			this.pa3_Gun1_Colour.setVisible(!1),
			this.pa3_Gun1.addChild(this.pa3_Gun1_Colour, -1),
			(this.pa3_Gun1_Flow = cc.Sprite.create(
				'RES/PA/2/pa3_Gun1_Flow_1_1.png'
			)),
			this.pa3_Gun1_Flow.setPosition(cc.p(21, 120)),
			this.pa3_Gun1_Flow.setAnchorPoint(cc.p(1, 0.43)),
			this.pa3_Gun1_Flow.setScale(1),
			this.pa3_Gun1_Flow.setTag(0),
			this.pa3_Gun1_Flow.setVisible(!1),
			this.pa3_Gun1.addChild(this.pa3_Gun1_Flow, -1),
			(this.pa3_lyl_popup = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.pa3_lyl_popup.setScale(0),
			this.lyl_part[e].addChild(this.pa3_lyl_popup, 5),
			(this.pa3_Popup = cc.Sprite.create('RES/PA/2/pa3_Popup.png')),
			this.pa3_Popup.setPosition(cc.p(400, 252)),
			this.pa3_Popup.setScale(1),
			this.pa3_Popup.setTag(1),
			this.pa3_lyl_popup.addChild(this.pa3_Popup),
			(this.pa3_Screw_comm = 1),
			(this.pa3_Screw_pos = [
				cc.p(0, 0),
				cc.p(242, 360),
				cc.p(572, 360),
				cc.p(242, 140),
				cc.p(572, 140),
			]),
			(this.pa3_Screw = []);
		for (t = 1; t <= 4; t++)
			(this.pa3_Screw[t] = cc.Sprite.create('RES/PA/2/pa3_Screw_1.png')),
				this.pa3_Screw[t].setPosition(
					cc.p(this.pa3_Screw_pos[t].x - 800, this.pa3_Screw_pos[t].y)
				),
				this.pa3_Screw[t].setScale(1),
				this.pa3_Screw[t].setTag(1),
				this.pa3_lyl_popup.addChild(this.pa3_Screw[t]);
		(this.pa3_Screw_anim = cc.Animation.create()),
			this.pa3_Screw_anim.setDelayPerUnit(0.05),
			this.pa3_Screw_anim.addSpriteFrameWithFile(
				'RES/PA/2/pa3_Screw_1.png'
			),
			this.pa3_Screw_anim.addSpriteFrameWithFile(
				'RES/PA/2/pa3_Screw_2.png'
			),
			this.pa3_Screw_anim.addSpriteFrameWithFile(
				'RES/PA/2/pa3_Screw_3.png'
			),
			(this.pa3_Hummer_pos = [
				cc.p(0, 0),
				cc.p(362, 360),
				cc.p(692, 360),
				cc.p(362, 140),
				cc.p(692, 140),
			]),
			(this.pa3_Hummer_rot1 = -60),
			(this.pa3_Hummer_rot2 = -95),
			(this.pa3_Hummer = cc.Sprite.create('RES/PA/2/pa3_Hummer.png')),
			this.pa3_Hummer.setPosition(
				cc.p(
					this.pa3_Hummer_pos[this.pa3_Screw_comm].x + 600,
					this.pa3_Hummer_pos[this.pa3_Screw_comm].y
				)
			),
			this.pa3_Hummer.setAnchorPoint(cc.p(0.3, 0.3)),
			this.pa3_Hummer.setScale(1),
			this.pa3_Hummer.setRotation(this.pa3_Hummer_rot1),
			this.pa3_Hummer.setTag(1),
			this.pa3_lyl_popup.addChild(this.pa3_Hummer),
			(this.pa3_lyl_popup1 = cc.LayerColor.create(
				cc.color(0, 0, 0, 150)
			)),
			this.pa3_lyl_popup1.setScale(0),
			this.lyl_part[e].addChild(this.pa3_lyl_popup1, 5),
			(this.pa3_Selected_Col = 1),
			(this.pa3_Gun_Col = cc.Sprite.create('RES/PA/2/pa3_Colour_1.png')),
			this.pa3_Gun_Col.setPosition(cc.p(371, 78)),
			this.pa3_Gun_Col.setScale(1),
			this.pa3_Gun_Col.setTag(1),
			this.pa3_Gun_Col.setOpacity(0),
			this.pa3_lyl_popup1.addChild(this.pa3_Gun_Col),
			(this.pa3_Gun = cc.Sprite.create('RES/PA/2/pa3_Gun.png')),
			this.pa3_Gun.setPosition(cc.p(350, 80)),
			this.pa3_Gun.setScale(1),
			this.pa3_Gun.setTag(1),
			this.pa3_lyl_popup1.addChild(this.pa3_Gun, 2),
			(this.pa3_Panel = cc.Sprite.create('RES/PA/2/pa3_Panel.png')),
			this.pa3_Panel.setPosition(cc.p(700, 230)),
			this.pa3_Panel.setScale(1),
			this.pa3_Panel.setTag(1),
			this.pa3_lyl_popup1.addChild(this.pa3_Panel),
			(this.pa3_Bucket_rot = -90),
			(this.pa3_Bucket = []),
			(this.pa3_Bucket_Flow = []),
			(this.pa3_Bucket_Flow_anim = []),
			(this.pa3_Bucket_pos = [
				cc.p(467, 266),
				cc.p(700, 325),
				cc.p(700, 220),
				cc.p(700, 113),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa3_Bucket[t] = cc.Sprite.create(
				'RES/PA/2/pa3_Bucket_' + t + '.png'
			)),
				this.pa3_Bucket[t].setPosition(this.pa3_Bucket_pos[t]),
				this.pa3_Bucket[t].setScale(0.5),
				this.pa3_Bucket[t].setTag(1),
				this.pa3_lyl_popup1.addChild(this.pa3_Bucket[t]),
				(this.pa3_Bucket_Flow[t] = cc.Sprite.create(
					'RES/PA/2/pa3_Colour_' + t + '_Flow_1.png'
				)),
				this.pa3_Bucket_Flow[t].setPosition(cc.p(45, 113)),
				this.pa3_Bucket_Flow[t].setAnchorPoint(cc.p(0.95, 0.95)),
				this.pa3_Bucket_Flow[t].setRotation(90),
				this.pa3_Bucket_Flow[t].setScale(0.5),
				this.pa3_Bucket_Flow[t].setTag(1),
				this.pa3_Bucket_Flow[t].setVisible(!1),
				this.pa3_Bucket[t].addChild(this.pa3_Bucket_Flow[t]),
				(this.pa3_Bucket_Flow_anim[t] = cc.Animation.create()),
				this.pa3_Bucket_Flow_anim[t].setDelayPerUnit(0.1),
				this.pa3_Bucket_Flow_anim[t].addSpriteFrameWithFile(
					'RES/PA/2/pa3_Colour_' + t + '_Flow_1.png'
				),
				this.pa3_Bucket_Flow_anim[t].addSpriteFrameWithFile(
					'RES/PA/2/pa3_Colour_' + t + '_Flow_2.png'
				),
				this.pa3_Bucket_Flow[t].runAction(
					cc.RepeatForever.create(
						cc.Animate.create(this.pa3_Bucket_Flow_anim[t].clone())
					)
				);
		e = 4;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 5;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 6;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.lyl_part[e].setScale(0),
			this.lyl_part[e].setPosition(cc.p(0, 0)),
			this.lyl_play.addChild(this.lyl_part[e]);
	},
	startNextPart: function () {
		if (0 == this.current_part)
			this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part &&
					(this.setTouchOff(0.1),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0));
		else if (1 == this.current_part)
			this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part
					? (this.pa1_Big_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(3),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Big_Panda_pos1.x,
										this.pa1_Big_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  this.pa1_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.5),
								cc.MoveTo.create(0.3, this.pa1_Panda_pos1),
								cc.DelayTime.create(2.2),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Panda_pos1.x,
										this.pa1_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  (this.current_part = 2),
					  (this.current_sub_part = 1),
					  this.setTouchOff(3.4),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 3.3))
					: 2 == this.current_sub_part
					? (this.bg.setTexture('RES/PA/2/Bg_1.png'),
					  this.lyl_part[2].setScale(0),
					  this.pa1_Pillow.setTexture(
							'RES/PA/2/pa1_Pillow_Done.png'
					  ),
					  (this.current_part = 3),
					  (this.current_sub_part = 1),
					  this.setTouchOff(2.1),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 2))
					: 3 == this.current_sub_part
					? (this.bg.setTexture('RES/PA/2/Bg_1.png'),
					  this.lyl_part[3].setScale(0),
					  this.pa1_Pillow.setTexture(
							'RES/PA/2/pa1_Pillow_Done.png'
					  ),
					  this.pa1_Big_Panda.setScale(0),
					  (t = comman.GetAnimatonDuration(this.pa1_Dog, 'Jump')),
					  this.pa1_Dog.setTag(1),
					  this.pa1_Dog.runAction(
							cc.MoveTo.create(t, this.pa1_Dog_pos1)
					  ),
					  this.pa1_Dog.setAnimation(1, 'Jump', !1),
					  this.pa1_Dog.addAnimation(1, 'Idle', !0),
					  this.setTouchOff(t + 0.1),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, t))
					: 4 == this.current_sub_part &&
					  ((t = comman.GetAnimatonDuration(this.pa1_Cat, 'Jump')),
					  this.pa1_Cat.setTag(1),
					  this.pa1_Cat.runAction(
							cc.MoveTo.create(t, this.pa1_Cat_pos1)
					  ),
					  this.pa1_Cat.setAnimation(1, 'Jump', !1),
					  this.pa1_Cat.addAnimation(1, 'Idle', !0),
					  this.setTouchOff(t + 0.1),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, t));
		else if (2 == this.current_part)
			if (
				(this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			) {
				this.bg.setTexture('RES/PA/2/Bg_2.png'),
					this.pa2_Basket.runAction(
						cc.MoveTo.create(0.2, this.pa2_Basket_pos)
					),
					this.pa2_Basket_Up.runAction(
						cc.MoveTo.create(0.2, this.pa2_Basket_pos)
					);
				for (var e = this.pa2_Cotton_pos.length - 1; 1 <= e; e--)
					this.pa2_Cotton[e].runAction(
						cc.MoveTo.create(0.2, this.pa2_Cotton_pos[e])
					);
				this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			} else {
				var t;
				2 == this.current_sub_part &&
					((t = this.angleBetweenPoints(
						this.pa2_doro_pos[this.pa2_doro_cur],
						this.pa2_doro_pos[this.pa2_doro_cur + 1]
					)),
					this.pa2_Needle.setTag(1),
					this.pa2_Needle.runAction(
						cc.Sequence.create(
							cc.MoveTo.create(0.2, this.pa2_Needle_pos),
							cc.RotateTo.create(0.1, t)
						)
					),
					this.setTouchOff(0.4),
					this.unschedule(this.RandomCommonHandInd1),
					this.scheduleOnce(this.RandomCommonHandInd1, 0.3));
			}
		else
			3 == this.current_part
				? (this.lyl_part[1].setScale(0),
				  this.lyl_part[this.current_part - 1].setScale(0),
				  this.lyl_part[this.current_part].setScale(1),
				  1 == this.current_sub_part
						? (this.bg.setTexture('RES/PA/2/Bg_3.png'),
						  this.pa3_Wood_Move.setTag(1),
						  this.pa3_Wood_Move.runAction(
								cc.MoveTo.create(0.2, this.pa3_Wood_Move_pos)
						  ),
						  this.setTouchOff(0.3),
						  this.unschedule(this.RandomCommonHandInd),
						  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
						: 2 == this.current_sub_part
						? (this.pa3_lyl_popup.setScale(1),
						  this.pa3_Screw_comm < 5
								? (this.pa3_Screw[
										this.pa3_Screw_comm
								  ].runAction(
										cc.MoveTo.create(
											0.2,
											this.pa3_Screw_pos[
												this.pa3_Screw_comm
											]
										)
								  ),
								  this.pa3_Hummer.setTag(1),
								  this.pa3_Hummer.runAction(
										cc.MoveTo.create(
											0.2,
											this.pa3_Hummer_pos[
												this.pa3_Screw_comm
											]
										)
								  ),
								  this.setTouchOff(0.3),
								  this.unschedule(this.RandomCommonHandInd1),
								  this.scheduleOnce(
										this.RandomCommonHandInd1,
										0.2
								  ))
								: (this.pa3_Wood_Set.setTexture(
										'RES/PA/2/pa3_Wood_Screw.png'
								  ),
								  this.pa3_Wood_Set.setVisible(!0),
								  this.pa3_Hummer.runAction(
										cc.MoveBy.create(0.2, cc.p(800, 0))
								  ),
								  this.pa3_lyl_popup.runAction(
										cc.Sequence.create(
											cc.DelayTime.create(1),
											cc.ScaleTo.create(0, 0)
										)
								  ),
								  this.pa3_Gun1.runAction(
										cc.Sequence.create(
											cc.DelayTime.create(1.5),
											cc.MoveTo.create(
												0.2,
												this.pa3_Gun1_pos
											)
										)
								  ),
								  this.current_sub_part++,
								  this.setTouchOff(2.3),
								  this.unschedule(this.startNextPart_call),
								  this.scheduleOnce(
										this.startNextPart_call,
										2.2
								  )))
						: 3 == this.current_sub_part
						? (this.pa3_lyl_popup1.setScale(1),
						  this.setTouchOff(0.3),
						  this.unschedule(this.RandomCommonHandInd),
						  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
						: 4 == this.current_sub_part &&
						  (this.pa3_Wood_Set.setTexture(
								'RES/PA/2/pa3_Wood_Screw.png'
						  ),
						  this.pa3_Wood_Set.setVisible(!0),
						  this.pa3_lyl_popup1.setScale(0),
						  this.pa1_Dog_Think_img.setTexture(
								'RES/PA/2/pa1_House_' +
									this.pa3_Selected_Col +
									'.png'
						  ),
						  this.pa1_House.setTexture(
								'RES/PA/2/pa1_House_' +
									this.pa3_Selected_Col +
									'.png'
						  ),
						  this.pa3_Roof.setTexture(
								'RES/PA/2/pa3_Roof_' +
									this.pa3_Selected_Col +
									'.png'
						  ),
						  this.pa3_Roof.setVisible(!0),
						  this.pa3_Gun1_Colour.setTexture(
								'RES/PA/2/pa3_Gun1_Colour_' +
									this.pa3_Selected_Col +
									'.png'
						  ),
						  this.pa3_Gun1_Flow.setTexture(
								'RES/PA/2/pa3_Gun1_Flow_' +
									this.pa3_Selected_Col +
									'_1.png'
						  ),
						  (this.pa3_Gun1_Flow_anim = cc.Animation.create()),
						  this.pa3_Gun1_Flow_anim.setDelayPerUnit(0.1),
						  this.pa3_Gun1_Flow_anim.addSpriteFrameWithFile(
								'RES/PA/2/pa3_Gun1_Flow_' +
									this.pa3_Selected_Col +
									'_1.png'
						  ),
						  this.pa3_Gun1_Flow_anim.addSpriteFrameWithFile(
								'RES/PA/2/pa3_Gun1_Flow_' +
									this.pa3_Selected_Col +
									'_2.png'
						  ),
						  this.pa3_Gun1_Flow_anim.addSpriteFrameWithFile(
								'RES/PA/2/pa3_Gun1_Flow_' +
									this.pa3_Selected_Col +
									'_3.png'
						  ),
						  this.pa3_Gun1_Flow.runAction(
								cc.RepeatForever.create(
									cc.Animate.create(
										this.pa3_Gun1_Flow_anim.clone()
									)
								)
						  ),
						  this.pa3_Gun1.setTag(1),
						  this.pa3_Gun1.runAction(
								cc.MoveTo.create(0.2, this.pa3_Gun1_pos)
						  ),
						  this.pa3_Gun1_Colour.setVisible(!0),
						  this.pa3_rt_up.begin(),
						  this.pa3_Dirty_Roof.visit(),
						  this.pa3_rt_up.end(),
						  this.pa3_Dirty_Roof.setVisible(!1),
						  this.addDummyPoints(),
						  this.setTouchOff(0.3),
						  this.unschedule(this.RandomCommonHandInd),
						  this.scheduleOnce(this.RandomCommonHandInd, 0.2)))
				: 4 == this.current_part &&
				  (this.lyl_part[this.current_part - 1].setScale(0),
				  this.lyl_part[this.current_part].setScale(1),
				  1 == this.current_sub_part &&
						(this.setTouchOff(3),
						this.current_sub_part++,
						this.unschedule(this.startNextPart_call),
						this.scheduleOnce(this.startNextPart_call, 3)));
	},
	angleBetweenPoints: function (e, t) {
		var c = e.y - t.y,
			e = t.x - e.x,
			e = Math.atan2(c, e),
			e = cc.radiansToDegrees(e);
		return 180 < e && (e -= 180), e + 90;
	},
	createPanels: function () {},
	updateRewardAds: function () {
		1 == comman.isRewardAdComplete
			? (this.rewardItem.getChildByName('rads').setVisible(!1),
			  (this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds))
			: 1 == comman.isRewardAdFailed &&
			  ((this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds));
	},
	startNextPart_call: function () {
		this.startNextPart();
	},
	startNextPart_call1: function () {
		this.startNextPart();
	},
	startNextPart_call2: function () {
		this.startNextPart();
	},
	checkLevelComplete: function () {
		this.showDone();
	},
	addDummyPoints: function () {
		(this.dummyPoints = [cc.p(1562, 308)]),
			3 == this.current_part &&
				4 == this.current_sub_part &&
				(this.dummyPoints = [
					cc.p(249, 229),
					cc.p(259, 230),
					cc.p(274, 231),
					cc.p(286, 230),
					cc.p(302, 228),
					cc.p(322, 227),
					cc.p(336, 229),
					cc.p(352, 229),
					cc.p(375, 229),
					cc.p(388, 229),
					cc.p(404, 230),
					cc.p(417, 229),
					cc.p(434, 228),
					cc.p(446, 228),
					cc.p(460, 228),
					cc.p(478, 228),
					cc.p(498, 228),
					cc.p(517, 228),
					cc.p(539, 227),
					cc.p(543, 245),
					cc.p(530, 246),
					cc.p(521, 248),
					cc.p(511, 248),
					cc.p(501, 248),
					cc.p(486, 250),
					cc.p(470, 250),
					cc.p(457, 249),
					cc.p(436, 248),
					cc.p(425, 248),
					cc.p(410, 248),
					cc.p(378, 248),
					cc.p(362, 248),
					cc.p(347, 246),
					cc.p(334, 248),
					cc.p(326, 248),
					cc.p(310, 250),
					cc.p(297, 248),
					cc.p(283, 250),
					cc.p(261, 246),
					cc.p(250, 247),
					cc.p(245, 250),
					cc.p(245, 267),
					cc.p(258, 267),
					cc.p(273, 266),
					cc.p(296, 263),
					cc.p(312, 263),
					cc.p(329, 265),
					cc.p(346, 266),
					cc.p(368, 265),
					cc.p(386, 266),
					cc.p(402, 266),
					cc.p(415, 267),
					cc.p(425, 267),
					cc.p(437, 269),
					cc.p(451, 269),
					cc.p(475, 269),
					cc.p(501, 270),
					cc.p(515, 270),
					cc.p(542, 271),
					cc.p(537, 291),
					cc.p(523, 291),
					cc.p(509, 293),
					cc.p(501, 291),
					cc.p(490, 289),
					cc.p(471, 289),
					cc.p(456, 289),
					cc.p(445, 291),
					cc.p(421, 292),
					cc.p(394, 291),
					cc.p(382, 291),
					cc.p(371, 293),
					cc.p(362, 291),
					cc.p(347, 292),
					cc.p(332, 292),
					cc.p(319, 294),
					cc.p(307, 296),
					cc.p(283, 293),
					cc.p(257, 296),
					cc.p(264, 314),
					cc.p(273, 316),
					cc.p(286, 316),
					cc.p(310, 317),
					cc.p(340, 320),
					cc.p(357, 319),
					cc.p(375, 319),
					cc.p(409, 319),
					cc.p(430, 319),
					cc.p(461, 319),
					cc.p(480, 322),
					cc.p(508, 326),
					cc.p(527, 328),
					cc.p(520, 344),
					cc.p(508, 346),
					cc.p(488, 349),
					cc.p(466, 349),
					cc.p(448, 352),
					cc.p(434, 352),
					cc.p(421, 352),
					cc.p(406, 351),
					cc.p(393, 350),
					cc.p(379, 350),
					cc.p(364, 348),
					cc.p(334, 348),
					cc.p(315, 347),
					cc.p(294, 351),
					cc.p(278, 353),
					cc.p(283, 372),
					cc.p(299, 374),
					cc.p(316, 372),
					cc.p(339, 372),
					cc.p(362, 368),
					cc.p(386, 369),
					cc.p(408, 369),
					cc.p(429, 369),
					cc.p(454, 371),
					cc.p(477, 371),
					cc.p(498, 372),
					cc.p(509, 373),
					cc.p(502, 390),
					cc.p(481, 392),
					cc.p(465, 391),
					cc.p(450, 390),
					cc.p(432, 390),
					cc.p(421, 391),
					cc.p(405, 392),
					cc.p(390, 392),
					cc.p(362, 392),
					cc.p(342, 392),
					cc.p(316, 392),
					cc.p(302, 392),
					cc.p(291, 392),
				]);
	},
	changeZorder: function (e, t, c) {
		e.setLocalZOrder(t);
	},
	changeTag: function (e, t) {
		e.setTag(t);
	},
	changeTexture: function (e, t) {
		e.setTexture(t);
	},
	buttonClickAction1: function (e) {
		var t = e.getScale();
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, t + 0.1),
				cc.ScaleTo.create(0.2, t)
			)
		);
	},
	buttonClickAction: function (e) {
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, 1.1),
				cc.ScaleTo.create(0.2, 1)
			)
		);
	},
	buttonSelectedAction: function (e) {
		e.runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.ScaleTo.create(0.5, 1.1),
					cc.ScaleTo.create(0.5, 1)
				)
			)
		);
	},
	onDoneClick: function (e) {
		0 != this.isTouchOn &&
			(this.hideDone(),
			this.setTouchOff(2.5),
			this.scheduleOnce(
				function () {
					this.onNextScene();
				},
				1,
				'onNextScene'
			));
	},
	onNextClick: function (e) {
		0 == this.isTouchOn ||
			0 < e.getNumberOfRunningActions() ||
			(comman.stopAllEffect(),
			comman.showInterstitial(),
			(this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackIn.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								comman.winSize().width +
									1.5 * this.btn_next.getContentSize().width,
								this.btn_next.getPositionY()
							)
						)
					)
				)
			),
			1 == this.current_part && 1 == this.current_sub_part
				? ((this.current_sub_sub_part = 1), (this.current_sub_part = 3))
				: 2 == this.current_part && 2 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 2),
				  (this.current_part = 1))
				: 3 == this.current_part && 4 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 3),
				  (this.current_part = 1))
				: ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 1),
				  this.current_part++),
			this.startNextPart());
	},
	checkIsLevelDone: function () {
		this.isDoneShow;
	},
	update: function (e) {},
	onNextScene1: function (e) {
		(this.isNextShow = !1),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							0.55 * this.btn_next.getContentSize().height
						)
					)
				)
			),
			comman.stopAllEffect(),
			comman.showInterstitial(),
			cc.director.runScene(ChooseScene.scene());
	},
	onNextScene: function (e) {
		comman.stopAllEffect(),
			comman.showInterstitial(),
			selectedLevels++,
			cc.director.runScene(ChooseScene.scene());
	},
	setTouchOff: function (e) {
		(this.isTouchOn = !1),
			this.unschedule(this.setTouchEnable),
			this.scheduleOnce(this.setTouchEnable, e);
	},
	setTouchEnable: function () {
		this.isTouchOn = !0;
	},
	checkFullTouchObject: function (e, t) {
		return (
			!eventInTransparentMask(e, e.getParent().convertToWorldSpace(t)) &&
			1 == this.checkTouchObject(e, t)
		);
	},
	checkFullTouchObject1: function (e, t) {
		return (
			!eventInTransparentMask1(e, t) && 1 == this.checkTouchObject(e, t)
		);
	},
	checkTouchObject: function (e, t) {
		return cc.rectContainsPoint(
			e.getBoundingBox(),
			e.getParent().convertToNodeSpace(t)
		);
	},
	onTouchBegan: function (e, t) {
		var c = e.getLocation(),
			a = t.getCurrentTarget();
		a.startPos = c;
		var o;
		a.startLocation = c;
		if (0 != a.isTouchOn) {
			if (1 == a.current_part)
				3 == a.current_sub_part
					? a.checkTouchObject(a.pa1_Dog, c) &&
					  1 == a.pa1_Dog.getTag() &&
					  0 == a.pa1_Dog.getNumberOfRunningActions() &&
					  ((o = comman.GetAnimatonDuration(a.pa1_Dog, 'Jump')),
					  a.pa1_Dog.setTag(1),
					  a.pa1_Dog.runAction(cc.MoveTo.create(o, a.pa1_Dog_pos2)),
					  a.pa1_Dog.setAnimation(1, 'Jump', !1),
					  a.pa1_Dog.addAnimation(1, 'Idle', !0),
					  a.pa1_Dog_Think.setScale(0),
					  a.setTouchOff(o + 0.1),
					  a.current_sub_part++,
					  a.unschedule(a.startNextPart),
					  a.scheduleOnce(a.startNextPart, o))
					: 4 == a.current_sub_part &&
					  a.checkTouchObject(a.pa1_Cat, c) &&
					  1 == a.pa1_Cat.getTag() &&
					  0 == a.pa1_Cat.getNumberOfRunningActions() &&
					  ((o = comman.GetAnimatonDuration(a.pa1_Cat, 'Jump')),
					  a.pa1_Cat.setTag(1),
					  a.pa1_Cat.runAction(cc.MoveTo.create(+o, a.pa1_Cat_pos2)),
					  a.pa1_Cat.setAnimation(1, 'Jump', !1),
					  a.pa1_Cat.addAnimation(1, 'Idle', !0),
					  a.pa1_Cat_Think.setScale(0),
					  a.setTouchOff(+o + 0.1),
					  a.unschedule(a.showDone),
					  a.scheduleOnce(a.showDone, +o));
			else if (2 == a.current_part)
				if (1 == a.current_sub_part) {
					for (var n = 1; n < a.pa2_Cotton_pos.length; n++)
						if (
							a.checkTouchObject(a.pa2_Cotton[n], c) &&
							0 == a.pa2_Cotton[n].getNumberOfRunningActions() &&
							1 == a.pa2_Cotton[n].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa2_Cotton[n]),
								(a.move_tool_pos =
									a.pa2_Cotton[n].getPosition()),
								(a.move_tool_rot =
									a.pa2_Cotton[n].getRotation()),
								(a.move_tool_scale =
									a.pa2_Cotton[n].getScale()),
								(a.move_tool_zorder =
									a.pa2_Cotton[n].getLocalZOrder()),
								(a.move_tool_no = 1),
								a.move_tool.setLocalZOrder(10),
								a.dummyBrush.setScale(0),
								(a.dummyMoveDist = cc.p(0, 0)),
								a.RandomCommonRoundInd2(1, cc.p(291, 213));
							break;
						}
				} else
					2 == a.current_sub_part &&
						a.checkTouchObject(a.pa2_Needle, c) &&
						0 == a.pa2_Needle.getNumberOfRunningActions() &&
						1 == a.pa2_Needle.getTag() &&
						(a.hideHint(),
						a.pa2_doro_cur++,
						(o = a.angleBetweenPoints(
							a.pa2_doro_pos[a.pa2_doro_cur],
							a.pa2_doro_pos[a.pa2_doro_cur + 1]
						)),
						a.pa2_doro[a.pa2_doro_cur].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.Show.create()
							)
						),
						13 == a.pa2_doro_cur
							? (a.pa2_Needle.runAction(
									cc.Sequence.create(
										cc.MoveTo.create(
											0.2,
											a.pa2_doro_pos[a.pa2_doro_cur]
										),
										cc.RotateTo.create(0.1, o),
										cc.MoveBy.create(0.3, cc.p(800, 0))
									)
							  ),
							  a.setTouchOff(1),
							  a.pa2_Pillow_Done.setOpacity(0),
							  a.pa2_Pillow_Done.setVisible(!0),
							  a.pa2_Pillow_Done.runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.6),
										cc.FadeIn.create(0.2)
									)
							  ),
							  a.unschedule(a.showNext),
							  a.scheduleOnce(a.showNext, 1))
							: (a.pa2_Needle.runAction(
									cc.Sequence.create(
										cc.MoveTo.create(
											0.2,
											a.pa2_doro_pos[a.pa2_doro_cur]
										),
										cc.RotateTo.create(0.1, o)
									)
							  ),
							  a.setTouchOff(0.3)));
			else if (3 == a.current_part)
				if (1 == a.current_sub_part)
					a.checkTouchObject(a.pa3_Wood_Move, c) &&
						0 == a.pa3_Wood_Move.getNumberOfRunningActions() &&
						1 == a.pa3_Wood_Move.getTag() &&
						(a.hideHint(),
						(a.move_tool = a.pa3_Wood_Move),
						(a.move_tool_pos = a.pa3_Wood_Move.getPosition()),
						(a.move_tool_rot = a.pa3_Wood_Move.getRotation()),
						(a.move_tool_scale = a.pa3_Wood_Move.getScale()),
						(a.move_tool_zorder = a.pa3_Wood_Move.getLocalZOrder()),
						(a.move_tool_no = 1),
						a.move_tool.setLocalZOrder(10),
						a.dummyBrush.setScale(0),
						(a.dummyMoveDist = cc.p(0, 0)),
						a.RandomCommonRoundInd2(1, a.pa3_Wood_Move_pos1));
				else if (2 == a.current_sub_part)
					a.checkTouchObject(a.pa3_Hummer, c) &&
						0 == a.pa3_Hummer.getNumberOfRunningActions() &&
						1 == a.pa3_Hummer.getTag() &&
						(a.hideHint(),
						a.pa3_Hummer.setTag(2),
						a.pa3_Hummer.runAction(
							cc.Sequence.create(
								cc.RotateTo.create(0.15, a.pa3_Hummer_rot2),
								cc.RotateTo.create(0.1, a.pa3_Hummer_rot1)
							)
						),
						a.pa3_Screw[a.pa3_Screw_comm].runAction(
							cc.Animate.create(a.pa3_Screw_anim.clone())
						),
						a.setTouchOff(0.6),
						a.pa3_Screw_comm++,
						a.unschedule(a.startNextPart),
						a.scheduleOnce(a.startNextPart, 0.6));
				else if (3 == a.current_sub_part) {
					for (n = 1; n <= 3; n++)
						if (
							a.checkTouchObject(a.pa3_Bucket[n], c) &&
							0 == a.pa3_Bucket[n].getNumberOfRunningActions() &&
							1 == a.pa3_Bucket[n].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa3_Bucket[n]),
								(a.move_tool_pos =
									a.pa3_Bucket[n].getPosition()),
								(a.move_tool_rot =
									a.pa3_Bucket[n].getRotation()),
								(a.move_tool_scale =
									a.pa3_Bucket[n].getScale()),
								(a.move_tool_zorder =
									a.pa3_Bucket[n].getLocalZOrder()),
								(a.move_tool_no = n),
								a.move_tool.setLocalZOrder(10),
								a.move_tool.setScale(1),
								a.dummyBrush.setScale(0),
								(a.dummyMoveDist = cc.p(0, 0)),
								a.RandomCommonRoundInd2(1, cc.p(392, 162));
							break;
						}
				} else
					4 == a.current_sub_part &&
						a.checkTouchObject(a.pa3_Gun1, c) &&
						0 == a.pa3_Gun1.getNumberOfRunningActions() &&
						1 == a.pa3_Gun1.getTag() &&
						(a.hideHint(),
						(a.move_tool = a.pa3_Gun1),
						(a.move_tool_pos = a.pa3_Gun1.getPosition()),
						(a.move_tool_rot = a.pa3_Gun1.getRotation()),
						(a.move_tool_scale = a.pa3_Gun1.getScale()),
						(a.move_tool_zorder = a.pa3_Gun1.getLocalZOrder()),
						(a.move_tool_no = 1),
						a.pa3_Gun1_Flow.setVisible(!0),
						a.move_tool.setLocalZOrder(10),
						a.dummyBrush.setScale(1.7, 1.2),
						(a.dummyMoveDist = cc.p(-150, 20)));
			return !0;
		}
	},
	onTouchMoved: function (e, t) {
		var e = e.getLocation(),
			c = t.getCurrentTarget();
		c.endPos = e;
		c.endLocation = e;
		if (0 != c.isTouchOn && null != c.move_tool) {
			(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y)),
				(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y));
			if (
				(c.move_tool.setPosition(
					c.move_tool.getParent().convertToNodeSpace(e)
				),
				c.dummyBrush.setPosition(t),
				2 == c.current_part)
			)
				1 == c.current_sub_part &&
					c.checkFullTouchObject(c.pa2_Pillow, e) &&
					0 == c.move_tool.getNumberOfRunningActions() &&
					1 == c.move_tool.getTag() &&
					(c.hideHint(),
					c.move_tool.runAction(
						cc.Sequence.create(
							cc.MoveTo.create(
								0.1,
								cc.p(
									c.pa2_Cotton_pos1[c.pa2_Cotton_comm].x,
									276
								)
							),
							cc.callFunc(c.changeZorder, c.move_tool, 0),
							cc.MoveTo.create(
								0.1,
								c.pa2_Cotton_pos1[c.pa2_Cotton_comm]
							)
						)
					),
					c.move_tool.setTag(2),
					(c.move_tool = null),
					(c.move_tool_no = 0),
					(c.move_tool_pos = cc.p(0, 0)),
					(c.move_tool_rot = 0),
					8 == c.pa2_Cotton_comm &&
						(c.pa2_Pillow.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.callFunc(
									c.changeTexture,
									c.pa2_Pillow,
									'RES/PA/2/pa2_Pillow_3.png'
								)
							)
						),
						c.pa2_Pillow_Up.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.callFunc(
									c.changeTexture,
									c.pa2_Pillow_Up,
									'RES/PA/2/pa2_Pillow_3_Up.png'
								)
							)
						)),
					c.pa2_Cotton_comm++,
					9 == c.pa2_Cotton_comm &&
						(c.pa2_Basket.runAction(
							cc.MoveBy.create(0.3, cc.p(500, 0))
						),
						c.pa2_Basket_Up.runAction(
							cc.MoveBy.create(0.3, cc.p(500, 0))
						),
						c.setTouchOff(0.4),
						c.current_sub_part++,
						c.unschedule(c.startNextPart),
						c.scheduleOnce(c.startNextPart, 0.4)));
			else if (3 == c.current_part)
				if (1 == c.current_sub_part)
					c.checkTouchObject(c.pa3_Wood_Move, c.pa3_Wood_Move_pos1) &&
						1 == c.move_tool.getTag() &&
						(c.move_tool.setTag(2),
						c.move_tool.stopAllActions(),
						c.move_tool.runAction(
							cc.Sequence.create(
								cc.MoveTo.create(0.2, c.pa3_Wood_Move_pos1),
								cc.Hide.create()
							)
						),
						c.pa3_Wood_Set.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.Show.create()
							)
						),
						(c.move_tool = null),
						(c.move_tool_no = 0),
						(c.move_tool_pos = cc.p(0, 0)),
						(c.move_tool_rot = 0),
						c.hideHint(),
						c.setTouchOff(0.5),
						c.current_sub_part++,
						c.unschedule(c.startNextPart),
						c.scheduleOnce(c.startNextPart, 0.4));
				else if (3 == c.current_sub_part) {
					if (
						c.checkTouchObject(c.move_tool, cc.p(392, 162)) &&
						1 == c.move_tool.getTag()
					) {
						c.pa3_Panel.runAction(
							cc.MoveBy.create(0.2, cc.p(500, 0))
						);
						for (var a = 1; a <= 3; a++)
							a != c.move_tool_no &&
								c.pa3_Bucket[a].runAction(
									cc.MoveBy.create(0.2, cc.p(500, 0))
								);
						c.move_tool.setTag(2),
							c.move_tool.stopAllActions(),
							c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveTo.create(0.1, c.pa3_Bucket_pos[0]),
									cc.callFunc(c.changeZorder, c.move_tool, 0),
									cc.RotateTo.create(0.1, c.pa3_Bucket_rot),
									cc.DelayTime.create(1),
									cc.Spawn.create(
										cc.MoveBy.create(0.2, cc.p(800, 0)),
										cc.ScaleTo.create(
											0.2,
											c.move_tool_scale
										),
										cc.RotateTo.create(0.2, c.move_tool_rot)
									)
								)
							),
							(c.pa3_Selected_Col = c.move_tool_no),
							c.pa3_Gun_Col.setTexture(
								'RES/PA/2/pa3_Colour_' +
									c.pa3_Selected_Col +
									'.png'
							),
							c.pa3_Gun_Col.runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.2),
									cc.FadeIn.create(1)
								)
							),
							c.pa3_Bucket_Flow[c.move_tool_no].runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.2),
									cc.Show.create(),
									cc.DelayTime.create(1),
									cc.Hide.create()
								)
							),
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.hideHint(),
							c.setTouchOff(1.7),
							c.current_sub_part++,
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 1.6);
					}
				} else if (
					4 == c.current_sub_part &&
					0 < c.dummyPoints.length
				) {
					c.pa3_rt_up.begin(),
						c.dummyBrush.visit(),
						c.pa3_rt_up.end();
					for (a = 0; a < c.dummyPoints.length; a++)
						c.checkTouchObject(c.dummyBrush, c.dummyPoints[a]) &&
							comman.arrayRemoveIndex(c.dummyPoints, a);
					0 == c.dummyPoints.length &&
						(c.pa3_rt_up.clear(),
						c.move_tool.setTag(2),
						c.move_tool.runAction(
							cc.Sequence.create(
								cc.MoveBy.create(0.2, cc.p(800, 0))
							)
						),
						(c.move_tool = null),
						(c.move_tool_no = 0),
						(c.move_tool_pos = cc.p(0, 0)),
						(c.move_tool_rot = 0),
						c.hideHint(),
						c.setTouchOff(0.3),
						c.unschedule(c.showNext),
						c.scheduleOnce(c.showNext, 0.2));
				}
		}
	},
	onTouchEnded: function (e, t) {
		(e = e.getLocation()), (t = t.getCurrentTarget());
		0 != t.isTouchOn &&
			null != t.move_tool &&
			(3 == t.current_part &&
				4 == t.current_sub_part &&
				t.pa3_Gun1_Flow.setVisible(!1),
			t.move_tool.runAction(
				cc.Sequence.create(
					cc.Spawn.create(
						cc.MoveTo.create(0.2, t.move_tool_pos),
						cc.ScaleTo.create(0.2, t.move_tool_scale),
						cc.RotateTo.create(0.2, t.move_tool_rot)
					),
					cc.callFunc(t.changeZorder, t.move_tool, t.move_tool_zorder)
				)
			),
			t.move_tool.getParent().convertToNodeSpace(e),
			(t.move_tool = null),
			(t.move_tool_no = 0),
			(t.move_tool_pos = cc.p(0, 0)),
			(t.move_tool_rot = 0),
			t.hideHint(),
			t.setTouchOff(0.2));
	},
	onMouseMove: function (e) {
		var t = e.getLocation(),
			e = e.getCurrentTarget();
		cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) &&
		1 == e.btn_more.getScale() &&
		0 == e.btn_more.getNumberOfRunningActions() &&
		255 == e.btn_more.getOpacity()
			? (e.prt_Sparkle.setPosition(e.btn_more.getPosition()),
			  e.prt_Sparkle.resetSystem(),
			  e.btn_more.setScale(1.03))
			: 1.03 != e.btn_more.getScale() ||
			  cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) ||
			  0 != e.btn_more.getNumberOfRunningActions() ||
			  255 != e.btn_more.getOpacity()
			? cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) &&
			  1 == e.btn_done.getScale() &&
			  0 == e.btn_done.getNumberOfRunningActions() &&
			  255 == e.btn_done.getOpacity()
				? (e.prt_Sparkle.setPosition(e.btn_done.getPosition()),
				  e.prt_Sparkle.resetSystem(),
				  e.btn_done.setScale(1.03))
				: 1.03 != e.btn_done.getScale() ||
				  cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) ||
				  0 != e.btn_done.getNumberOfRunningActions() ||
				  255 != e.btn_done.getOpacity() ||
				  e.btn_done.setScale(1)
			: e.btn_more.setScale(1);
	},
	onMoreApp: function (e) {
		101 == e.getTag()
			? CreateLinksInGame(comman.GameId, 'game', 'more')
			: CreateLinksInGame(comman.GameId, 'game', 'logo');
	},
	onMusicButton: function (e) {
		0 == e.getNumberOfRunningActions() &&
			(e.stopAllActions(),
			e.runAction(
				cc.Sequence.create(
					cc.ScaleTo.create(0, 1),
					cc.ScaleTo.create(0.2, 0.9),
					cc.ScaleTo.create(0.2, 1)
				)
			),
			comman.isMusicEnable
				? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
				  comman.setSoundEnabled(!1))
				: comman.isMusicEnable ||
				  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
				  comman.setSoundEnabled(!0)));
	},
	createMainMenu: function () {
		(this.btn_bb_icon = cc.MenuItemImage.create(
			res_comman.bb_icon_3,
			res_comman.bb_icon_3,
			this.onMoreApp,
			this
		)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.5 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.5 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.MainMenu = cc.Menu.create(this.btn_bb_icon, this.btn_music)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 200);
	},
});
PlayScene_2.scene = function () {
	var e = new cc.Scene(),
		t = new PlayScene_2();
	return e.addChild(t), e;
};
var PlayScene_3 = cc.Scene.extend({
	ctor: function () {
		this._super(), this.init();
	},
	onEnter: function () {
		this._super(),
			cc.eventManager.addListener(
				{
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this.onTouchBegan,
					onTouchMoved: this.onTouchMoved,
					onTouchEnded: this.onTouchEnded,
				},
				this
			),
			'mouse' in cc.sys.capabilities &&
				cc.eventManager.addListener(
					{
						event: cc.EventListener.MOUSE,
						onMouseMove: this.onMouseMove,
					},
					this
				);
	},
	init: function () {
		this._super(),
			(this.startPos = cc.p(0, 0)),
			(this.endPos = cc.p(0, 0)),
			(this.isDoneShow = !1),
			(this.isNextShow = !1),
			(this.lyl_puzzles = null),
			(this.move_tool = null),
			(this.move_tool_no = 0),
			(this.move_tool_rot = 0),
			(this.move_tool_s_pos = cc.p(1e4, 1e4)),
			(this.isTouchOn = !1),
			(this.current_part = 1),
			(this.current_sub_part = 1),
			(this.current_sub_sub_part = 1),
			(this.current_tool = 1),
			this.setTouchOff(0.1),
			(this.bg = cc.Sprite.create('RES/PA/3/Bg_1.png')),
			this.bg.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.bg.setScale(1),
			this.addChild(this.bg),
			(this.dummyPoints = []),
			this.createPlayarea(),
			this.createPanels(),
			(this.btn_bb_icon = cc.MenuItemImage.create(
				res_comman.bb_icon_3,
				res_comman.bb_icon_3,
				this.onMoreApp,
				this
			)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_more = cc.MenuItemImage.create(
				res_common_button.btn_more,
				res_common_button.btn_more,
				this.onMoreApp,
				this
			)),
			this.btn_more.setScale(1),
			this.btn_more.setTag(101),
			this.btn_more.setPosition(
				cc.p(
					comman.winSize().width -
						1.6 * this.btn_more.getContentSize().width,
					comman.winSize().height +
						0.55 * this.btn_more.getContentSize().height
				)
			),
			this.btn_more.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							this.btn_more.getPositionX(),
							comman.winSize().height -
								0.55 * this.btn_more.getContentSize().height
						)
					)
				)
			),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.55 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.55 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.btn_done = cc.MenuItemImage.create(
				res_common_button.btn_done,
				res_common_button.btn_done,
				this.onDoneClick,
				this
			)),
			this.btn_done.setScale(1),
			this.btn_done.setTag(101),
			this.btn_done.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_done.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_done.getContentSize().height
				)
			),
			(this.btn_next = cc.MenuItemImage.create(
				res_common_button.btn_next,
				res_common_button.btn_next,
				this.onNextClick,
				this
			)),
			this.btn_next.setScale(1),
			this.btn_next.setTag(101),
			this.btn_next.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_next.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_next.getContentSize().height
				)
			),
			(this.MainMenu = cc.Menu.create(
				this.btn_bb_icon,
				this.btn_done,
				this.btn_more,
				this.btn_music,
				this.btn_next
			)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 100),
			(this.prt_Sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_1_plist
			)),
			this.prt_Sparkle.setScale(1.5),
			this.prt_Sparkle.stopSystem(),
			this.addChild(this.prt_Sparkle),
			this.prt_Sparkle.setLocalZOrder(500),
			(this.prt_tool_sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_2_plist
			)),
			this.prt_tool_sparkle.setScale(1),
			this.prt_tool_sparkle.stopSystem(),
			this.addChild(this.prt_tool_sparkle),
			this.prt_tool_sparkle.setLocalZOrder(500),
			(this.CommonHandIndicator = cc.Sprite.create(
				res_common_button.arrow_ind_3_img
			)),
			this.CommonHandIndicator.setScale(0),
			this.CommonHandIndicator.setAnchorPoint(cc.p(0.55, 0.1)),
			this.addChild(this.CommonHandIndicator, 10),
			this.CommonHandIndicator.setPosition(cc.p(25e3, 25e3)),
			(this.CommonRoundIndicator = []);
		for (var e = 0; e < 15; e++)
			(this.CommonRoundIndicator[e] = cc.Sprite.create(
				res_common_button.indicator_img
			)),
				this.CommonRoundIndicator[e].setScale(0),
				this.CommonRoundIndicator[e].setAnchorPoint(cc.p(0.5, 0.5)),
				this.CommonRoundIndicator[e].setColor(cc.color(0, 255, 0)),
				this.addChild(this.CommonRoundIndicator[e], 10),
				this.CommonRoundIndicator[e].setPosition(cc.p(25e3, 25e3));
		this.CommonRoundIndicator1 = [];
		for (e = 0; e < 15; e++)
			(this.CommonRoundIndicator1[e] = cc.Sprite.create(
				res_common_button.arrow
			)),
				this.CommonRoundIndicator1[e].setScale(0),
				this.CommonRoundIndicator1[e].setAnchorPoint(cc.p(0.5, 0)),
				this.addChild(this.CommonRoundIndicator1[e], 10),
				this.CommonRoundIndicator1[e].setPosition(cc.p(25e3, 25e3));
		this.startNextPart();
	},
	RandomCommonHandInd: function () {
		var e, t, c, a;
		2 == this.current_part
			? 1 == this.current_sub_part
				? ((c = this.pa2_Insect_Remover_pos),
				  (a = this.pa2_Insect_pos[comman.getRandomInt(1, 4)]),
				  this.RandomCommonHandIndOneWay(c, a))
				: 2 == this.current_sub_part &&
				  ((c = this.pa2_Broom_pos),
				  (a = cc.p(198, 125)),
				  this.RandomCommonHandIndOneWay(c, a))
			: 3 == this.current_part
			? 2 == this.current_sub_part
				? ((c = this.pa3_Spray_pos),
				  (a = cc.p(563, 363)),
				  (e = cc.p(267, 346)),
				  (t = cc.p(143, 227)),
				  this.RandomCommonHandIndThreeWay1(c, a, e, t))
				: 3 == this.current_sub_part
				? ((c = this.pa3_Brush_pos),
				  (a = cc.p(563, 363)),
				  (e = cc.p(267, 346)),
				  (t = cc.p(143, 227)),
				  this.RandomCommonHandIndThreeWay1(c, a, e, t))
				: 4 == this.current_sub_part &&
				  ((c = this.pa3_Spray1_pos),
				  (a = this.pa3_Gem_pos[comman.getRandomInt(1, 5)]),
				  this.RandomCommonHandIndOneWay(c, a))
			: 4 == this.current_part &&
			  1 == this.current_sub_part &&
			  ((t = comman.getRandomInt(1, 5)),
			  (c = this.pa4_albowo_th_pos[t]),
			  (a = this.pa4_albowo_th_pos1[t]),
			  this.RandomCommonHandIndOneWay(c, a));
	},
	RandomCommonHandInd1: function () {
		var e;
		3 == this.current_part
			? 1 == this.current_sub_part
				? ((e = this.pa3_Insect_pos[comman.getRandomInt(1, 5)]),
				  this.RandomCommonHandIndJump(e))
				: 5 == this.current_sub_part &&
				  ((e = cc.p(434, 231)), this.RandomCommonHandIndJump(e))
			: 4 == this.current_part &&
			  2 == this.current_sub_part &&
			  ((e = cc.p(409, 235)), this.RandomCommonHandIndJump(e));
	},
	RandomCommonHandIndOneWay: function (e, t) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(0.5, t),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(1)
					)
				)
			);
	},
	RandomCommonHandIndTwoWay: function (e, t, c) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, e),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, c),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay1: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(2, c),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndJump: function (e) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.JumpTo.create(1.5, e, 5, 2),
						cc.ScaleTo.create(0, 0),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonRoundInd: function (e) {},
	RandomCommonRoundInd1: function (e) {
		this.CommonRoundIndicator[1].setPosition(e),
			this.CommonRoundIndicator[1].stopAllActions(),
			this.CommonRoundIndicator[1].setScale(1),
			this.CommonRoundIndicator[1].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	RandomCommonRoundInd2: function (e, t) {
		this.CommonRoundIndicator[e].setPosition(t),
			this.CommonRoundIndicator[e].stopAllActions(),
			this.CommonRoundIndicator[e].setScale(1),
			this.CommonRoundIndicator[e].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	hideHint: function () {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setScale(0);
		for (var e = 0; e < 15; e++)
			this.CommonRoundIndicator[e].stopAllActions(),
				this.CommonRoundIndicator[e].setScale(0);
	},
	showToolCompleteParticle: function (e) {
		this.prt_tool_sparkle.setPosition(e),
			this.prt_tool_sparkle.resetSystem();
	},
	showDone: function () {
		0 == this.isDoneShow &&
			((this.isDoneShow = !0),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	showNext: function () {
		0 == this.isNextShow &&
			((this.isNextShow = !0),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	hideDone: function () {
		1 == this.isDoneShow &&
			((this.isDoneShow = !1),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	hideNext: function () {
		1 == this.isNextShow &&
			((this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	createPlayarea: function () {
		(this.dummyMoveDist = cc.p(0, 0)),
			(this.dummyBrush = cc.Sprite.create('RES/CB/brush.png')),
			this.dummyBrush.setPosition(cc.p(1e3, 1e3)),
			this.dummyBrush.setScale(0),
			this.dummyBrush.setOpacity(255),
			this.dummyBrush.setBlendFunc(cc.ZERO, cc.ONE_MINUS_SRC_ALPHA),
			this.addChild(this.dummyBrush, -100),
			(this.lyl_play = cc.Layer.create()),
			this.addChild(this.lyl_play),
			(this.lyl_part = []),
			(this.lyl_sub_part = []);
		var e = 0;
		(this.lyl_part[e] = cc.Layer.create()),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 1;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.lyl_pa2_dirt = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_pa2_dirt.setScale(1),
			this.lyl_part[e].addChild(this.lyl_pa2_dirt),
			(this.pa1_Water = cc.Sprite.create('RES/PA/3/pa1_Water.png')),
			this.pa1_Water.setPosition(cc.p(400, 252)),
			this.pa1_Water.setScale(1),
			this.pa1_Water.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Water),
			(this.pa1_Insect_1 = []),
			(this.pa1_Insect_1_pos = [
				cc.p(0, 0),
				cc.p(339, 85),
				cc.p(272, 68),
				cc.p(424, 39),
			]),
			(this.pa1_Insect_1_anim = []),
			(this.pa1_Insect_1_anim[1] = cc.Animation.create()),
			this.pa1_Insect_1_anim[1].setDelayPerUnit(0.15),
			this.pa1_Insect_1_anim[1].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_1_1.png'
			),
			this.pa1_Insect_1_anim[1].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_1_2.png'
			),
			(this.pa1_Insect_1_anim[2] = cc.Animation.create()),
			this.pa1_Insect_1_anim[2].setDelayPerUnit(0.15),
			this.pa1_Insect_1_anim[2].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_2_1.png'
			),
			this.pa1_Insect_1_anim[2].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_2_2.png'
			);
		for (var t = 1; t <= 3; t++) {
			var c = comman.getRandomInt(1, 2);
			(this.pa1_Insect_1[t] = cc.Sprite.create(
				'RES/PA/3/pa2_Insect_' + c + '_1.png'
			)),
				this.pa1_Insect_1[t].setPosition(this.pa1_Insect_1_pos[t]),
				this.pa1_Insect_1[t].setScale(0.5),
				this.pa1_Insect_1[t].setTag(1),
				this.lyl_part[e].addChild(this.pa1_Insect_1[t]),
				this.pa1_Insect_1[t].runAction(
					cc.RepeatForever.create(
						cc.Animate.create(this.pa1_Insect_1_anim[c])
					)
				);
		}
		this.pa1_Insect_1[1].runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.FlipX.create(!0),
					cc.MoveTo.create(
						2,
						cc.p(
							this.pa1_Insect_1_pos[1].x + 20,
							this.pa1_Insect_1_pos[1].y
						)
					),
					cc.FlipX.create(!1),
					cc.MoveTo.create(2, this.pa1_Insect_1_pos[1])
				)
			)
		),
			this.pa1_Insect_1[2].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa1_Insect_1_pos[2].x - 20,
								this.pa1_Insect_1_pos[2].y
							)
						),
						cc.FlipX.create(!0),
						cc.MoveTo.create(2, this.pa1_Insect_1_pos[2])
					)
				)
			),
			this.pa1_Insect_1[3].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa1_Insect_1_pos[3].x - 20,
								this.pa1_Insect_1_pos[3].y
							)
						),
						cc.FlipX.create(!0),
						cc.MoveTo.create(2, this.pa1_Insect_1_pos[3])
					)
				)
			),
			(this.pa1_Insect_2 = []),
			(this.pa1_Insect_2_pos = [
				cc.p(0, 0),
				cc.p(365, 294),
				cc.p(431, 292),
				cc.p(368, 241),
				cc.p(435, 244),
			]),
			(this.pa1_Insect_2_anim = cc.Animation.create()),
			this.pa1_Insect_2_anim.setDelayPerUnit(0.15),
			this.pa1_Insect_2_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Insect_1_1.png'
			),
			this.pa1_Insect_2_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Insect_1_2.png'
			);
		for (t = 1; t <= 4; t++) {
			c = 1;
			(this.pa1_Insect_2[t] = cc.Sprite.create(
				'RES/PA/3/pa3_Insect_' + c + '_1.png'
			)),
				this.pa1_Insect_2[t].setPosition(this.pa1_Insect_2_pos[t]),
				this.pa1_Insect_2[t].setScale(0.3),
				this.pa1_Insect_2[t].setTag(1),
				this.lyl_part[e].addChild(this.pa1_Insect_2[t]),
				this.pa1_Insect_2[t].runAction(
					cc.RepeatForever.create(
						cc.Animate.create(this.pa1_Insect_2_anim)
					)
				);
		}
		this.pa1_Insect_2[1].runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.FlipX.create(!0),
					cc.JumpTo.create(
						2,
						cc.p(
							this.pa1_Insect_2_pos[1].x + 20,
							this.pa1_Insect_2_pos[1].y
						),
						10,
						1
					),
					cc.FlipX.create(!1),
					cc.JumpTo.create(2, this.pa1_Insect_2_pos[1], 10, 1)
				)
			)
		),
			this.pa1_Insect_2[2].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa1_Insect_2_pos[2].x - 20,
								this.pa1_Insect_2_pos[2].y
							),
							5,
							1
						),
						cc.FlipX.create(!0),
						cc.JumpTo.create(2, this.pa1_Insect_2_pos[2], 5, 1)
					)
				)
			),
			this.pa1_Insect_2[3].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!0),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa1_Insect_2_pos[3].x + 20,
								this.pa1_Insect_2_pos[3].y
							),
							5,
							1
						),
						cc.FlipX.create(!1),
						cc.JumpTo.create(2, this.pa1_Insect_2_pos[3], 5, 1)
					)
				)
			),
			this.pa1_Insect_2[4].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa1_Insect_2_pos[4].x - 15,
								this.pa1_Insect_2_pos[4].y
							),
							5,
							1
						),
						cc.FlipX.create(!0),
						cc.JumpTo.create(2, this.pa1_Insect_2_pos[4], 5, 1)
					)
				)
			),
			(this.pa1_Big_Panda_pos1 = cc.p(666, -70)),
			(this.pa1_Big_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Big_Panda.json',
				'RES/PA/anim/Big_Panda.atlas',
				0.5
			)),
			this.pa1_Big_Panda.setPosition(
				cc.p(this.pa1_Big_Panda_pos1.x, this.pa1_Big_Panda_pos1.y)
			),
			this.pa1_Big_Panda.setScale(1, 1),
			this.pa1_Big_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Big_Panda),
			this.pa1_Big_Panda.setAnimation(1, 'Sad', !0),
			(this.pa1_Panda_pos1 = cc.p(133, -30)),
			(this.pa1_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Panda.json',
				'RES/PA/anim/Panda.atlas',
				0.5
			)),
			this.pa1_Panda.setPosition(
				cc.p(this.pa1_Panda_pos1.x, this.pa1_Panda_pos1.y - 400)
			),
			this.pa1_Panda.setScale(1, 1),
			this.pa1_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Panda),
			this.pa1_Panda.setAnimation(1, 'Idle', !0);
		e = 2;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa2_Water = []);
		for (t = 1; t <= 3; t++)
			(this.pa2_Water[t] = cc.Sprite.create(
				'RES/PA/3/pa2_Water_' + t + '.png'
			)),
				this.pa2_Water[t].setPosition(cc.p(400, 252)),
				this.pa2_Water[t].setScale(1),
				this.pa2_Water[t].setTag(1),
				this.lyl_part[e].addChild(this.pa2_Water[t]);
		(this.pa2_rt_up = new cc.RenderTexture(800, 504)),
			this.pa2_rt_up.setPosition(cc.p(400, 252)),
			this.pa2_rt_up.setScale(1),
			this.lyl_part[e].addChild(this.pa2_rt_up),
			this.pa2_rt_up.begin();
		for (t = 1; t <= 3; t++)
			this.pa2_Water[t].visit(), this.pa2_Water[t].setVisible(!1);
		this.pa2_rt_up.end(),
			this.pa2_rt_up.setScale(0),
			(this.pa2_Insect_Com = 0),
			(this.pa2_Insect = []),
			(this.pa2_Insect_pos = [
				cc.p(0, 0),
				cc.p(194, 374),
				cc.p(549, 386),
				cc.p(180, 187),
				cc.p(416, 76),
			]),
			(this.pa2_Insect_pos1 = [
				cc.p(0, 0),
				cc.p(-6, 574),
				cc.p(1049, 586),
				cc.p(-70, -63),
				cc.p(441, -174),
			]),
			(this.pa2_Insect_flipdX = [!1, !0, !1, !0, !1]),
			(this.pa2_Insect_anim = []),
			(this.pa2_Insect_anim[1] = cc.Animation.create()),
			this.pa2_Insect_anim[1].setDelayPerUnit(0.15),
			this.pa2_Insect_anim[1].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_1_1.png'
			),
			this.pa2_Insect_anim[1].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_1_2.png'
			),
			(this.pa2_Insect_anim[2] = cc.Animation.create()),
			this.pa2_Insect_anim[2].setDelayPerUnit(0.15),
			this.pa2_Insect_anim[2].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_2_1.png'
			),
			this.pa2_Insect_anim[2].addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_2_2.png'
			);
		for (t = 1; t <= 4; t++) {
			c = comman.getRandomInt(1, 2);
			(this.pa2_Insect[t] = cc.Sprite.create(
				'RES/PA/3/pa2_Insect_' + c + '_1.png'
			)),
				this.pa2_Insect[t].setPosition(this.pa2_Insect_pos[t]),
				this.pa2_Insect[t].setScale(1),
				this.pa2_Insect[t].setTag(1),
				this.lyl_part[e].addChild(this.pa2_Insect[t]),
				this.pa2_Insect[t].runAction(
					cc.RepeatForever.create(
						cc.Animate.create(this.pa2_Insect_anim[c])
					)
				);
		}
		this.pa2_Insect[1].runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.FlipX.create(!0),
					cc.MoveTo.create(
						2,
						cc.p(
							this.pa2_Insect_pos[1].x + 80,
							this.pa2_Insect_pos[1].y - 10
						)
					),
					cc.FlipX.create(!1),
					cc.MoveTo.create(
						2,
						cc.p(
							this.pa2_Insect_pos[1].x - 30,
							this.pa2_Insect_pos[1].y - 50
						)
					),
					cc.FlipX.create(!0),
					cc.MoveTo.create(2, this.pa2_Insect_pos[1])
				)
			)
		),
			this.pa2_Insect[2].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa2_Insect_pos[2].x - 80,
								this.pa2_Insect_pos[2].y - 30
							)
						),
						cc.FlipX.create(!0),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa2_Insect_pos[2].x + 50,
								this.pa2_Insect_pos[2].y - 50
							)
						),
						cc.FlipX.create(!1),
						cc.MoveTo.create(2, this.pa2_Insect_pos[2])
					)
				)
			),
			this.pa2_Insect[3].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa2_Insect_pos[3].x - 80,
								this.pa2_Insect_pos[3].y - 30
							)
						),
						cc.FlipX.create(!0),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa2_Insect_pos[3].x + 50,
								this.pa2_Insect_pos[3].y - 50
							)
						),
						cc.FlipX.create(!1),
						cc.MoveTo.create(2, this.pa2_Insect_pos[3])
					)
				)
			),
			this.pa2_Insect[4].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!0),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa2_Insect_pos[4].x + 80,
								this.pa2_Insect_pos[4].y + 20
							)
						),
						cc.FlipX.create(!1),
						cc.MoveTo.create(
							2,
							cc.p(
								this.pa2_Insect_pos[4].x - 30,
								this.pa2_Insect_pos[4].y + 50
							)
						),
						cc.FlipX.create(!0),
						cc.MoveTo.create(2, this.pa2_Insect_pos[4])
					)
				)
			),
			(this.pa2_Insect_Remover_pos = cc.p(631, 216)),
			(this.pa2_Insect_Remover = cc.Sprite.create(
				'RES/PA/3/pa2_Insect_Remover.png'
			)),
			this.pa2_Insect_Remover.setPosition(
				cc.p(
					this.pa2_Insect_Remover_pos.x + 500,
					this.pa2_Insect_Remover_pos.y
				)
			),
			this.pa2_Insect_Remover.setAnchorPoint(cc.p(0.35, 0.35)),
			this.pa2_Insect_Remover.setScale(0.8),
			this.pa2_Insect_Remover.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Insect_Remover),
			(this.pa2_Insect_Remover_anim = cc.Animation.create()),
			this.pa2_Insect_Remover_anim.setDelayPerUnit(0.1),
			this.pa2_Insect_Remover_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_Remover_1.png'
			),
			this.pa2_Insect_Remover_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa2_Insect_Remover_2.png'
			),
			(this.pa2_Broom_pos = cc.p(684, 254)),
			(this.pa2_Broom = cc.Sprite.create('RES/PA/3/pa2_Broom.png')),
			this.pa2_Broom.setPosition(
				cc.p(this.pa2_Broom_pos.x + 500, this.pa2_Broom_pos.y)
			),
			this.pa2_Broom.setAnchorPoint(cc.p(0.5, 0.5)),
			this.pa2_Broom.setScale(1),
			this.pa2_Broom.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Broom);
		e = 3;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa3_Water_D = cc.Sprite.create('RES/PA/3/pa3_Water_D.png')),
			this.pa3_Water_D.setPosition(cc.p(400, 249)),
			this.pa3_Water_D.setScale(1),
			this.pa3_Water_D.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Water_D),
			(this.pa3_Water_anim = cc.Animation.create()),
			this.pa3_Water_anim.setDelayPerUnit(0.15),
			this.pa3_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_1.png'
			),
			this.pa3_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_2.png'
			),
			this.pa3_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_3.png'
			),
			this.pa3_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_4.png'
			),
			this.pa3_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_5.png'
			),
			this.pa3_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_6.png'
			),
			this.pa3_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_7.png'
			),
			(this.pa3_Water_anim1 = cc.Animation.create()),
			this.pa3_Water_anim1.setDelayPerUnit(0.1),
			this.pa3_Water_anim1.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_8.png'
			),
			this.pa3_Water_anim1.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Water_Ani_7.png'
			),
			(this.pa3_Dust = cc.Sprite.create('RES/PA/3/pa3_Dust.png')),
			this.pa3_Dust.setPosition(cc.p(400, 252)),
			this.pa3_Dust.setScale(1),
			this.pa3_Dust.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Dust),
			(this.pa3_Bubble = []),
			(this.pa3_Bubble_pos = [
				cc.p(135, 187),
				cc.p(183, 267),
				cc.p(221, 344),
				cc.p(296, 310),
				cc.p(314, 374),
				cc.p(403, 345),
				cc.p(483, 350),
				cc.p(577, 331),
				cc.p(629, 271),
				cc.p(644, 239),
				cc.p(534, 288),
				cc.p(365, 284),
				cc.p(446, 293),
			]);
		for (t = 0; t < this.pa3_Bubble_pos.length; t++)
			(this.pa3_Bubble[t] = cc.Sprite.create('RES/PA/3/pa3_Bubble.png')),
				this.pa3_Bubble[t].setPosition(this.pa3_Bubble_pos[t]),
				this.pa3_Bubble[t].setScale(1),
				this.pa3_Bubble[t].setTag(1),
				this.pa3_Bubble[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa3_Bubble[t]),
				this.buttonSelectedAction(this.pa3_Bubble[t]);
		(this.pa3_Bg_Up = cc.Sprite.create('RES/PA/3/Bg_3_Up.png')),
			this.pa3_Bg_Up.setPosition(cc.p(400, 252)),
			this.pa3_Bg_Up.setScale(1),
			this.pa3_Bg_Up.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Bg_Up),
			(this.pa3_Insect = []),
			(this.pa3_Insect_pos = [
				cc.p(0, 0),
				cc.p(181, 300),
				cc.p(385, 349),
				cc.p(597, 306),
				cc.p(251, 167),
				cc.p(520, 154),
			]),
			(this.pa3_Insect_anim = cc.Animation.create()),
			this.pa3_Insect_anim.setDelayPerUnit(0.15),
			this.pa3_Insect_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Insect_1_1.png'
			),
			this.pa3_Insect_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Insect_1_2.png'
			);
		for (t = 1; t <= 5; t++) {
			c = 1;
			(this.pa3_Insect[t] = cc.Sprite.create(
				'RES/PA/3/pa3_Insect_' + c + '_1.png'
			)),
				this.pa3_Insect[t].setPosition(this.pa3_Insect_pos[t]),
				this.pa3_Insect[t].setScale(1),
				this.pa3_Insect[t].setTag(1),
				this.lyl_part[e].addChild(this.pa3_Insect[t]),
				this.pa3_Insect[t].runAction(
					cc.RepeatForever.create(
						cc.Animate.create(this.pa3_Insect_anim)
					)
				);
		}
		this.pa3_Insect[1].runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.FlipX.create(!0),
					cc.JumpTo.create(
						2,
						cc.p(
							this.pa3_Insect_pos[1].x + 20,
							this.pa3_Insect_pos[1].y
						),
						10,
						1
					),
					cc.FlipX.create(!1),
					cc.JumpTo.create(2, this.pa3_Insect_pos[1], 10, 1)
				)
			)
		),
			this.pa3_Insect[2].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa3_Insect_pos[2].x - 20,
								this.pa3_Insect_pos[2].y
							),
							5,
							1
						),
						cc.FlipX.create(!0),
						cc.JumpTo.create(2, this.pa3_Insect_pos[2], 5, 1),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa3_Insect_pos[2].x + 20,
								this.pa3_Insect_pos[2].y
							),
							5,
							1
						),
						cc.FlipX.create(!1),
						cc.JumpTo.create(2, this.pa3_Insect_pos[2], 5, 1)
					)
				)
			),
			this.pa3_Insect[3].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa3_Insect_pos[3].x - 20,
								this.pa3_Insect_pos[3].y
							),
							5,
							1
						),
						cc.FlipX.create(!0),
						cc.JumpTo.create(2, this.pa3_Insect_pos[3], 5, 1)
					)
				)
			),
			this.pa3_Insect[4].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!0),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa3_Insect_pos[4].x + 20,
								this.pa3_Insect_pos[4].y
							),
							5,
							1
						),
						cc.FlipX.create(!1),
						cc.JumpTo.create(2, this.pa3_Insect_pos[4], 5, 1)
					)
				)
			),
			this.pa3_Insect[5].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.FlipX.create(!1),
						cc.JumpTo.create(
							2,
							cc.p(
								this.pa3_Insect_pos[5].x - 15,
								this.pa3_Insect_pos[5].y
							),
							5,
							1
						),
						cc.FlipX.create(!0),
						cc.JumpTo.create(2, this.pa3_Insect_pos[5], 5, 1)
					)
				)
			),
			(this.pa3_Gem = []),
			(this.pa3_Gem_pos = [
				cc.p(0, 0),
				cc.p(299, 321),
				cc.p(488, 320),
				cc.p(559, 180),
				cc.p(213, 185),
				cc.p(391, 226),
			]),
			(this.pa3_Gem_seq = comman.gen);
		for (t = 1; t <= 5; t++) {
			c = comman.getRandomInt(1, 3);
			(this.pa3_Gem[t] = cc.Sprite.create(
				'RES/PA/3/pa3_Gem_' + c + '.png'
			)),
				this.pa3_Gem[t].setPosition(this.pa3_Gem_pos[t]),
				this.pa3_Gem[t].setScale(1),
				this.pa3_Gem[t].setTag(1),
				this.pa3_Gem[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa3_Gem[t]),
				this.pa3_Gem[t].runAction(
					cc.RepeatForever.create(
						cc.Sequence.create(
							cc.ScaleTo.create(1, 0.9),
							cc.ScaleTo.create(1, 1),
							cc.DelayTime.create(comman.getRandomFloat(0.1, 0.5))
						)
					)
				);
		}
		(this.pa3_Brush_pos = cc.p(708, 265)),
			(this.pa3_Brush = cc.Sprite.create('RES/PA/3/pa3_Brush.png')),
			this.pa3_Brush.setPosition(
				cc.p(this.pa3_Brush_pos.x + 500, this.pa3_Brush_pos.y)
			),
			this.pa3_Brush.setAnchorPoint(cc.p(0.6, 0.6)),
			this.pa3_Brush.setScale(1),
			this.pa3_Brush.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Brush),
			(this.pa3_Spray_pos = cc.p(636, 128)),
			(this.pa3_Spray = cc.Sprite.create('RES/PA/3/pa3_Spray.png')),
			this.pa3_Spray.setPosition(
				cc.p(this.pa3_Spray_pos.x + 500, this.pa3_Spray_pos.y)
			),
			this.pa3_Spray.setScale(1),
			this.pa3_Spray.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Spray),
			(this.pa3_Spray_Flow = cc.Sprite.create(
				'RES/PA/3/pa3_Spray_3.png'
			)),
			this.pa3_Spray_Flow.setPosition(cc.p(30, 166)),
			this.pa3_Spray_Flow.setAnchorPoint(cc.p(1, 0.43)),
			this.pa3_Spray_Flow.setScale(1),
			this.pa3_Spray_Flow.setTag(0),
			this.pa3_Spray_Flow.setVisible(!1),
			this.pa3_Spray.addChild(this.pa3_Spray_Flow, -1),
			(this.pa3_Spray_Flow_anim = cc.Animation.create()),
			this.pa3_Spray_Flow_anim.setDelayPerUnit(0.1),
			this.pa3_Spray_Flow_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Spray_3.png'
			),
			this.pa3_Spray_Flow_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Spray_2.png'
			),
			this.pa3_Spray_Flow_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa3_Spray_1.png'
			),
			this.pa3_Spray_Flow.runAction(
				cc.RepeatForever.create(
					cc.Animate.create(this.pa3_Spray_Flow_anim.clone())
				)
			),
			(this.pa3_Spray1_pos = cc.p(731, 265)),
			(this.pa3_Spray1 = cc.Sprite.create('RES/PA/3/pa3_Spray1.png')),
			this.pa3_Spray1.setPosition(
				cc.p(this.pa3_Spray1_pos.x + 500, this.pa3_Spray1_pos.y)
			),
			this.pa3_Spray1.setScale(1),
			this.pa3_Spray1.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Spray1),
			(this.pa3_Spray1_Flow = cc.Sprite.create(
				'RES/PA/3/pa3_Spray_3.png'
			)),
			this.pa3_Spray1_Flow.setPosition(cc.p(20, 137)),
			this.pa3_Spray1_Flow.setAnchorPoint(cc.p(1, 0.43)),
			this.pa3_Spray1_Flow.setScale(1),
			this.pa3_Spray1_Flow.setTag(0),
			this.pa3_Spray1_Flow.setVisible(!1),
			this.pa3_Spray1.addChild(this.pa3_Spray1_Flow, -1),
			this.pa3_Spray1_Flow.runAction(
				cc.RepeatForever.create(
					cc.Animate.create(this.pa3_Spray_Flow_anim.clone())
				)
			),
			(this.pa3_lyl_popup = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.pa3_lyl_popup.setScale(0),
			this.lyl_part[e].addChild(this.pa3_lyl_popup, 5),
			(this.pa3_Popup = cc.Sprite.create('RES/PA/3/pa3_Popup.png')),
			this.pa3_Popup.setPosition(cc.p(400, 252)),
			this.pa3_Popup.setScale(1),
			this.pa3_Popup.setTag(1),
			this.pa3_lyl_popup.addChild(this.pa3_Popup),
			(this.pa3_Flush = cc.Sprite.create('RES/PA/3/pa3_Flush.png')),
			this.pa3_Flush.setPosition(cc.p(376, 194)),
			this.pa3_Flush.setAnchorPoint(cc.p(0.15, 0.2)),
			this.pa3_Flush.setScale(1),
			this.pa3_Flush.setTag(0),
			this.pa3_Popup.addChild(this.pa3_Flush);
		e = 4;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa4_bg = cc.Sprite.create('RES/PA/3/Bg_5.png')),
			this.pa4_bg.setPosition(cc.p(400, 252)),
			this.pa4_bg.setScale(1),
			this.pa4_bg.setTag(1),
			this.pa4_bg.setOpacity(0),
			this.lyl_part[e].addChild(this.pa4_bg),
			(this.pa4_Water = cc.Sprite.create('RES/PA/3/pa4_Water_Ani_1.png')),
			this.pa4_Water.setPosition(cc.p(400, 252)),
			this.pa4_Water.setScale(1),
			this.pa4_Water.setTag(1),
			this.pa4_Water.setVisible(!1),
			this.pa4_bg.addChild(this.pa4_Water),
			(this.pa4_Water_anim = cc.Animation.create()),
			this.pa4_Water_anim.setDelayPerUnit(0.2),
			this.pa4_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa4_Water_Ani_1.png'
			),
			this.pa4_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa4_Water_Ani_2.png'
			),
			this.pa4_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa4_Water_Ani_3.png'
			),
			this.pa4_Water_anim.addSpriteFrameWithFile(
				'RES/PA/3/pa4_Water_Ani_4.png'
			),
			(this.pa4_albowo = []);
		for (t = 1; t <= 5; t++)
			(this.pa4_albowo[t] = cc.Sprite.create(
				'RES/PA/3/pa4_albowo_' + t + '.png'
			)),
				this.pa4_albowo[t].setPosition(cc.p(400, 252)),
				this.pa4_albowo[t].setScale(1),
				this.pa4_albowo[t].setTag(1),
				this.pa4_albowo[t].setColor(cc.color(70, 50, 50, 100)),
				this.lyl_part[e].addChild(this.pa4_albowo[t]);
		(this.pa4_lyl_panel = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.pa4_lyl_panel.setScale(1),
			this.pa4_lyl_panel.setPosition(cc.p(500, 0)),
			this.lyl_part[e].addChild(this.pa4_lyl_panel),
			(this.pa4_Panel = cc.Sprite.create('RES/PA/3/pa4_Panel.png')),
			this.pa4_Panel.setPosition(cc.p(700, 228)),
			this.pa4_Panel.setScale(1, 1.18),
			this.pa4_Panel.setTag(1),
			this.pa4_lyl_panel.addChild(this.pa4_Panel),
			(this.pa4_albowo_th = []),
			(this.pa4_albowo_th_pos = [
				cc.p(0, 0),
				cc.p(697, 370),
				cc.p(697, 293),
				cc.p(697, 222),
				cc.p(697, 153),
				cc.p(697, 84),
			]),
			(this.pa4_albowo_th_pos1 = [
				cc.p(0, 0),
				cc.p(385, 263),
				cc.p(266, 248),
				cc.p(96, 249),
				cc.p(527, 248),
				cc.p(526, 146),
			]);
		for (t = 1; t <= 5; t++)
			(this.pa4_albowo_th[t] = cc.Sprite.create(
				'RES/PA/3/pa4_albowo_th_' + t + '.png'
			)),
				this.pa4_albowo_th[t].setPosition(this.pa4_albowo_th_pos[t]),
				this.pa4_albowo_th[t].setScale(0.5),
				this.pa4_albowo_th[t].setTag(1),
				this.pa4_lyl_panel.addChild(this.pa4_albowo_th[t]);
		(this.pa4_lyl_popup = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.pa4_lyl_popup.setScale(0),
			this.lyl_part[e].addChild(this.pa4_lyl_popup, 5),
			(this.pa4_Popup = cc.Sprite.create('RES/PA/3/pa4_Popup.png')),
			this.pa4_Popup.setPosition(cc.p(400, 252)),
			this.pa4_Popup.setScale(1),
			this.pa4_Popup.setTag(1),
			this.pa4_lyl_popup.addChild(this.pa4_Popup),
			(this.pa4_Flush = cc.Sprite.create('RES/PA/3/pa4_Wheel.png')),
			this.pa4_Flush.setPosition(cc.p(405, 235)),
			this.pa4_Flush.setScale(1),
			this.pa4_Flush.setTag(0),
			this.pa4_lyl_popup.addChild(this.pa4_Flush);
		e = 5;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 6;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.lyl_part[e].setScale(0),
			this.lyl_part[e].setPosition(cc.p(0, 0)),
			this.lyl_play.addChild(this.lyl_part[e]);
	},
	startNextPart: function () {
		if (0 == this.current_part)
			this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part &&
					(this.setTouchOff(0.1),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0));
		else if (1 == this.current_part)
			if (
				(this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				this.pa1_Big_Panda.runAction(
					cc.Sequence.create(
						cc.DelayTime.create(3),
						cc.MoveTo.create(
							0.3,
							cc.p(
								this.pa1_Big_Panda_pos1.x,
								this.pa1_Big_Panda_pos1.y - 400
							)
						)
					)
				),
					this.pa1_Panda.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.5),
							cc.MoveTo.create(0.3, this.pa1_Panda_pos1),
							cc.DelayTime.create(2.2),
							cc.MoveTo.create(
								0.3,
								cc.p(
									this.pa1_Panda_pos1.x,
									this.pa1_Panda_pos1.y - 400
								)
							)
						)
					),
					(this.current_part = 2),
					(this.current_sub_part = 1),
					this.setTouchOff(3.4),
					this.unschedule(this.startNextPart_call),
					this.scheduleOnce(this.startNextPart_call, 3.3);
			else if (2 == this.current_sub_part) {
				this.pa1_Water.setScale(0);
				for (var e = 1; e <= 3; e++)
					this.pa1_Insect_1[e].stopAllActions(),
						this.pa1_Insect_1[e].setScale(0);
				this.bg.setTexture('RES/PA/3/Bg_1.png'),
					this.lyl_part[2].setScale(0),
					(this.current_part = 3),
					(this.current_sub_part = 1),
					this.setTouchOff(2.1),
					this.unschedule(this.startNextPart_call),
					this.scheduleOnce(this.startNextPart_call, 2);
			} else if (3 == this.current_sub_part) {
				for (e = 1; e < this.pa1_Insect_2.length; e++)
					this.pa1_Insect_2[e].stopAllActions(),
						this.pa1_Insect_2[e].setScale(0);
				this.bg.setTexture('RES/PA/3/Bg_1.png'),
					this.lyl_part[3].setScale(0),
					(this.current_part = 4),
					(this.current_sub_part = 1),
					this.setTouchOff(2.1),
					this.unschedule(this.startNextPart_call),
					this.scheduleOnce(this.startNextPart_call, 2);
			} else {
				var t;
				4 == this.current_sub_part &&
					((t = comman.GetAnimatonDuration(this.pa1_Cat, 'Jump')),
					this.pa1_Cat.setTag(1),
					this.pa1_Cat.runAction(
						cc.MoveTo.create(t, this.pa1_Cat_pos1)
					),
					this.pa1_Cat.setAnimation(1, 'Jump', !1),
					this.pa1_Cat.addAnimation(1, 'Idle', !0),
					this.setTouchOff(t + 0.1),
					this.unschedule(this.RandomCommonHandInd1),
					this.scheduleOnce(this.RandomCommonHandInd1, t));
			}
		else if (2 == this.current_part)
			this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part
					? (this.bg.setTexture('RES/PA/3/Bg_2.png'),
					  this.pa2_Insect_Remover.setTag(1),
					  this.pa2_Insect_Remover.runAction(
							cc.MoveTo.create(0.2, this.pa2_Insect_Remover_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 2 == this.current_sub_part &&
					  (this.pa2_rt_up.setScale(1),
					  this.pa2_Broom.setTag(1),
					  this.pa2_Broom.runAction(
							cc.MoveTo.create(0.2, this.pa2_Broom_pos)
					  ),
					  this.addDummyPoints(),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2));
		else if (3 == this.current_part)
			if (
				(this.lyl_part[1].setScale(0),
				this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				this.bg.setTexture('RES/PA/3/Bg_3.png'),
					this.setTouchOff(0.1),
					this.unschedule(this.RandomCommonHandInd1),
					this.scheduleOnce(this.RandomCommonHandInd1, 0);
			else if (2 == this.current_sub_part)
				this.pa3_Spray.setTag(1),
					this.pa3_Spray.runAction(
						cc.MoveTo.create(0.2, this.pa3_Spray_pos)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (3 == this.current_sub_part)
				this.pa3_Dust.setVisible(!1),
					this.pa3_Brush.setTag(1),
					this.pa3_Brush.runAction(
						cc.MoveTo.create(0.2, this.pa3_Brush_pos)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (4 == this.current_sub_part) {
				for (e = 1; e <= 5; e++)
					this.pa3_Gem[e].setVisible(!0), this.pa3_Gem[e].setTag(1);
				this.pa3_Spray1.setTag(1),
					this.pa3_Spray1.runAction(
						cc.MoveTo.create(0.2, this.pa3_Spray1_pos)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			} else
				5 == this.current_sub_part
					? (this.pa3_lyl_popup.setScale(1),
					  this.pa3_Flush.setTag(1),
					  this.setTouchOff(0.1),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, 0))
					: 6 == this.current_sub_part &&
					  (this.pa3_lyl_popup.setScale(0),
					  this.pa3_Water_D.runAction(
							cc.Sequence.create(
								cc.Animate.create(this.pa3_Water_anim.clone()),
								cc.Repeat.create(
									cc.Animate.create(
										this.pa3_Water_anim1.clone()
									),
									50
								)
							)
					  ),
					  this.setTouchOff(0.6),
					  this.unschedule(this.showNext),
					  this.scheduleOnce(this.showNext, 0.5));
		else if (4 == this.current_part)
			if (
				(this.lyl_part[1].setScale(0),
				this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				this.bg.setTexture('RES/PA/3/Bg_4.png'),
					this.pa4_lyl_panel.runAction(
						cc.MoveTo.create(0.2, cc.p(0, 0))
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (2 == this.current_sub_part) {
				this.pa4_lyl_panel.runAction(
					cc.MoveTo.create(0.2, cc.p(500, 0))
				);
				for (e = 1; e <= 5; e++)
					this.pa4_albowo[e].runAction(cc.FadeOut.create(0.2));
				this.pa4_bg.runAction(cc.FadeIn.create(0.2)),
					this.pa4_Flush.setTag(1),
					this.pa4_lyl_popup.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.4),
							cc.ScaleTo.create(0, 1)
						)
					),
					this.setTouchOff(0.5),
					this.unschedule(this.RandomCommonHandInd1),
					this.scheduleOnce(this.RandomCommonHandInd1, 0.4);
			} else
				3 == this.current_sub_part &&
					(this.pa4_lyl_popup.setScale(0),
					this.pa4_Water.runAction(
						cc.Sequence.create(
							cc.Show.create(),
							cc.Animate.create(this.pa4_Water_anim.clone())
						)
					),
					this.setTouchOff(0.5),
					this.unschedule(this.showDone),
					this.scheduleOnce(this.showDone, 0.4));
	},
	removeInsectPa2: function (e, t) {
		this.pa2_Insect[e].stopAllActions(),
			this.pa2_Insect[e].runAction(cc.ScaleTo.create(0.05, 0)),
			this.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.1),
					cc.callFunc(this.replayInsectPa2, this, e)
				)
			);
	},
	replayInsectPa2: function (e, t) {
		var c;
		this.pa2_Insect[t].stopAllActions(),
			this.pa2_Insect[t].setPosition(this.pa2_Insect_pos1[t]),
			this.pa2_Insect_Com++,
			this.pa2_Insect_Com < 7
				? ((c = comman.getRandomInt(1, 2)),
				  this.pa2_Insect[t].setTexture(
						'RES/PA/3/pa2_Insect_' + c + '_1.png'
				  ),
				  this.pa2_Insect[t].setScale(1),
				  this.pa2_Insect[t].setFlippedX(this.pa2_Insect_flipdX[t]),
				  this.pa2_Insect[t].runAction(
						cc.RepeatForever.create(
							cc.Animate.create(this.pa2_Insect_anim[c])
						)
				  ),
				  this.pa2_Insect[t].runAction(
						cc.Sequence.create(
							cc.MoveTo.create(3, this.pa2_Insect_pos[t]),
							cc.callFunc(this.replayInsectPa2_1, this, t)
						)
				  ))
				: 10 == this.pa2_Insect_Com &&
				  (this.move_tool.stopAllActions(),
				  this.move_tool.runAction(
						cc.Sequence.create(cc.MoveBy.create(0.2, cc.p(1200, 0)))
				  ),
				  (this.move_tool = null),
				  (this.move_tool_no = 0),
				  (this.move_tool_pos = cc.p(0, 0)),
				  (this.move_tool_rot = 0),
				  this.hideHint(),
				  this.setTouchOff(0.5),
				  this.current_sub_part++,
				  this.unschedule(this.startNextPart),
				  this.scheduleOnce(this.startNextPart, 0.4));
	},
	replayInsectPa2_1: function (e, t) {
		switch (t) {
			case 1:
				this.pa2_Insect[1].runAction(
					cc.RepeatForever.create(
						cc.Sequence.create(
							cc.FlipX.create(!0),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[1].x + 80,
									this.pa2_Insect_pos[1].y - 10
								)
							),
							cc.FlipX.create(!1),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[1].x - 30,
									this.pa2_Insect_pos[1].y - 50
								)
							),
							cc.FlipX.create(!0),
							cc.MoveTo.create(2, this.pa2_Insect_pos[1])
						)
					)
				);
				break;
			case 2:
				this.pa2_Insect[2].runAction(
					cc.RepeatForever.create(
						cc.Sequence.create(
							cc.FlipX.create(!1),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[2].x - 80,
									this.pa2_Insect_pos[2].y - 30
								)
							),
							cc.FlipX.create(!0),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[2].x + 50,
									this.pa2_Insect_pos[2].y - 50
								)
							),
							cc.FlipX.create(!1),
							cc.MoveTo.create(2, this.pa2_Insect_pos[2])
						)
					)
				);
				break;
			case 3:
				this.pa2_Insect[3].runAction(
					cc.RepeatForever.create(
						cc.Sequence.create(
							cc.FlipX.create(!1),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[3].x - 80,
									this.pa2_Insect_pos[3].y - 30
								)
							),
							cc.FlipX.create(!0),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[3].x + 50,
									this.pa2_Insect_pos[3].y - 50
								)
							),
							cc.FlipX.create(!1),
							cc.MoveTo.create(2, this.pa2_Insect_pos[3])
						)
					)
				);
				break;
			case 4:
				this.pa2_Insect[4].runAction(
					cc.RepeatForever.create(
						cc.Sequence.create(
							cc.FlipX.create(!0),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[4].x + 80,
									this.pa2_Insect_pos[4].y + 20
								)
							),
							cc.FlipX.create(!1),
							cc.MoveTo.create(
								2,
								cc.p(
									this.pa2_Insect_pos[4].x - 30,
									this.pa2_Insect_pos[4].y + 50
								)
							),
							cc.FlipX.create(!0),
							cc.MoveTo.create(2, this.pa2_Insect_pos[4])
						)
					)
				);
		}
	},
	angleBetweenPoints: function (e, t) {
		var c = e.y - t.y,
			e = t.x - e.x,
			e = Math.atan2(c, e),
			e = cc.radiansToDegrees(e);
		return 180 < e && (e -= 180), e + 90;
	},
	createPanels: function () {},
	updateRewardAds: function () {
		1 == comman.isRewardAdComplete
			? (this.rewardItem.getChildByName('rads').setVisible(!1),
			  (this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds))
			: 1 == comman.isRewardAdFailed &&
			  ((this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds));
	},
	startNextPart_call: function () {
		this.startNextPart();
	},
	startNextPart_call1: function () {
		this.startNextPart();
	},
	startNextPart_call2: function () {
		this.startNextPart();
	},
	checkLevelComplete: function () {
		this.showDone();
	},
	addDummyPoints: function () {
		(this.dummyPoints = [cc.p(1562, 308)]),
			2 == this.current_part &&
				2 == this.current_sub_part &&
				(this.dummyPoints = [
					cc.p(71, 285),
					cc.p(71, 281),
					cc.p(72, 275),
					cc.p(71, 266),
					cc.p(71, 259),
					cc.p(83, 253),
					cc.p(85, 259),
					cc.p(86, 274),
					cc.p(83, 286),
					cc.p(84, 297),
					cc.p(105, 303),
					cc.p(105, 294),
					cc.p(105, 284),
					cc.p(105, 276),
					cc.p(105, 266),
					cc.p(105, 253),
					cc.p(105, 243),
					cc.p(122, 237),
					cc.p(124, 246),
					cc.p(125, 258),
					cc.p(125, 275),
					cc.p(126, 287),
					cc.p(129, 302),
					cc.p(131, 311),
					cc.p(151, 305),
					cc.p(152, 293),
					cc.p(155, 280),
					cc.p(155, 263),
					cc.p(155, 249),
					cc.p(156, 242),
					cc.p(171, 242),
					cc.p(175, 250),
					cc.p(175, 262),
					cc.p(177, 277),
					cc.p(180, 289),
					cc.p(180, 307),
					cc.p(193, 302),
					cc.p(199, 296),
					cc.p(202, 278),
					cc.p(202, 270),
					cc.p(202, 260),
					cc.p(205, 247),
					cc.p(217, 251),
					cc.p(222, 262),
					cc.p(220, 278),
					cc.p(220, 289),
					cc.p(222, 301),
					cc.p(239, 306),
					cc.p(243, 294),
					cc.p(240, 283),
					cc.p(240, 270),
					cc.p(239, 260),
					cc.p(238, 245),
					cc.p(255, 247),
					cc.p(260, 256),
					cc.p(261, 271),
					cc.p(262, 285),
					cc.p(264, 297),
					cc.p(264, 304),
					cc.p(283, 300),
					cc.p(283, 285),
					cc.p(281, 267),
					cc.p(281, 259),
					cc.p(293, 282),
					cc.p(297, 293),
					cc.p(302, 290),
					cc.p(79, 127),
					cc.p(78, 118),
					cc.p(78, 105),
					cc.p(83, 91),
					cc.p(100, 83),
					cc.p(100, 99),
					cc.p(104, 116),
					cc.p(105, 129),
					cc.p(108, 142),
					cc.p(125, 145),
					cc.p(130, 134),
					cc.p(130, 117),
					cc.p(130, 103),
					cc.p(133, 82),
					cc.p(149, 78),
					cc.p(152, 97),
					cc.p(151, 129),
					cc.p(150, 147),
					cc.p(166, 167),
					cc.p(171, 149),
					cc.p(170, 127),
					cc.p(166, 104),
					cc.p(168, 79),
					cc.p(173, 59),
					cc.p(187, 57),
					cc.p(188, 80),
					cc.p(191, 104),
					cc.p(191, 130),
					cc.p(191, 160),
					cc.p(191, 176),
					cc.p(203, 214),
					cc.p(204, 193),
					cc.p(204, 165),
					cc.p(205, 144),
					cc.p(207, 115),
					cc.p(210, 89),
					cc.p(212, 65),
					cc.p(241, 49),
					cc.p(240, 65),
					cc.p(236, 94),
					cc.p(236, 115),
					cc.p(236, 142),
					cc.p(235, 167),
					cc.p(232, 184),
					cc.p(234, 205),
					cc.p(235, 221),
					cc.p(253, 225),
					cc.p(256, 205),
					cc.p(262, 181),
					cc.p(265, 145),
					cc.p(269, 118),
					cc.p(272, 92),
					cc.p(279, 62),
					cc.p(292, 69),
					cc.p(299, 94),
					cc.p(297, 124),
					cc.p(297, 155),
					cc.p(297, 185),
					cc.p(300, 218),
					cc.p(317, 215),
					cc.p(324, 201),
					cc.p(324, 179),
					cc.p(325, 146),
					cc.p(325, 121),
					cc.p(325, 99),
					cc.p(325, 76),
					cc.p(343, 55),
					cc.p(355, 91),
					cc.p(351, 109),
					cc.p(351, 136),
					cc.p(351, 155),
					cc.p(353, 183),
					cc.p(377, 186),
					cc.p(378, 169),
					cc.p(378, 147),
					cc.p(378, 136),
					cc.p(382, 117),
					cc.p(385, 94),
					cc.p(392, 56),
					cc.p(393, 86),
					cc.p(425, 57),
					cc.p(420, 80),
					cc.p(417, 102),
					cc.p(418, 128),
					cc.p(418, 149),
					cc.p(418, 170),
					cc.p(435, 168),
					cc.p(440, 156),
					cc.p(445, 135),
					cc.p(447, 115),
					cc.p(451, 103),
					cc.p(454, 82),
					cc.p(480, 87),
					cc.p(473, 106),
					cc.p(470, 124),
					cc.p(470, 152),
					cc.p(484, 151),
					cc.p(491, 136),
					cc.p(505, 109),
					cc.p(508, 92),
					cc.p(530, 99),
					cc.p(528, 113),
					cc.p(524, 135),
					cc.p(550, 129),
					cc.p(551, 115),
					cc.p(554, 173),
					cc.p(562, 171),
					cc.p(573, 171),
					cc.p(505, 176),
					cc.p(489, 179),
					cc.p(475, 178),
					cc.p(455, 223),
					cc.p(455, 231),
					cc.p(467, 242),
					cc.p(473, 226),
					cc.p(473, 208),
					cc.p(485, 205),
					cc.p(485, 215),
					cc.p(485, 227),
					cc.p(485, 238),
					cc.p(507, 239),
					cc.p(509, 223),
					cc.p(508, 208),
					cc.p(523, 215),
					cc.p(522, 227),
					cc.p(522, 237),
					cc.p(537, 231),
					cc.p(536, 215),
					cc.p(543, 224),
				]);
	},
	changeZorder: function (e, t, c) {
		e.setLocalZOrder(t);
	},
	changeTag: function (e, t) {
		e.setTag(t);
	},
	changeTexture: function (e, t) {
		e.setTexture(t);
	},
	buttonClickAction1: function (e) {
		var t = e.getScale();
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, t + 0.1),
				cc.ScaleTo.create(0.2, t)
			)
		);
	},
	buttonClickAction: function (e) {
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, 1.1),
				cc.ScaleTo.create(0.2, 1)
			)
		);
	},
	buttonSelectedAction: function (e) {
		e.runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.ScaleTo.create(0.5, 1.1),
					cc.ScaleTo.create(0.5, 1)
				)
			)
		);
	},
	onDoneClick: function (e) {
		0 != this.isTouchOn &&
			(this.hideDone(),
			this.setTouchOff(2.5),
			this.scheduleOnce(
				function () {
					this.onNextScene();
				},
				1,
				'onNextScene'
			));
	},
	onNextClick: function (e) {
		0 == this.isTouchOn ||
			0 < e.getNumberOfRunningActions() ||
			(comman.stopAllEffect(),
			comman.showInterstitial(),
			(this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackIn.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								comman.winSize().width +
									1.5 * this.btn_next.getContentSize().width,
								this.btn_next.getPositionY()
							)
						)
					)
				)
			),
			1 == this.current_part && 1 == this.current_sub_part
				? ((this.current_sub_sub_part = 1), (this.current_sub_part = 3))
				: 2 == this.current_part && 2 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 2),
				  (this.current_part = 1))
				: 3 == this.current_part && 6 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 3),
				  (this.current_part = 1))
				: ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 1),
				  this.current_part++),
			this.startNextPart());
	},
	checkIsLevelDone: function () {
		this.isDoneShow;
	},
	update: function (e) {},
	onNextScene1: function (e) {
		(this.isNextShow = !1),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							0.55 * this.btn_next.getContentSize().height
						)
					)
				)
			),
			comman.stopAllEffect(),
			comman.showInterstitial(),
			cc.director.runScene(ChooseScene.scene());
	},
	onNextScene: function (e) {
		comman.stopAllEffect(),
			comman.showInterstitial(),
			selectedLevels++,
			cc.director.runScene(ChooseScene.scene());
	},
	setTouchOff: function (e) {
		(this.isTouchOn = !1),
			this.unschedule(this.setTouchEnable),
			this.scheduleOnce(this.setTouchEnable, e);
	},
	setTouchEnable: function () {
		this.isTouchOn = !0;
	},
	checkFullTouchObject: function (e, t) {
		return (
			!eventInTransparentMask(e, e.getParent().convertToWorldSpace(t)) &&
			1 == this.checkTouchObject(e, t)
		);
	},
	checkFullTouchObject1: function (e, t) {
		return (
			!eventInTransparentMask1(e, t) && 1 == this.checkTouchObject(e, t)
		);
	},
	checkTouchObject: function (e, t) {
		return cc.rectContainsPoint(
			e.getBoundingBox(),
			e.getParent().convertToNodeSpace(t)
		);
	},
	onTouchBegan: function (e, t) {
		var c = e.getLocation(),
			a = t.getCurrentTarget();
		a.startPos = c;
		a.startLocation = c;
		if (0 != a.isTouchOn) {
			if (2 == a.current_part)
				1 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Insect_Remover, c) &&
					  0 == a.pa2_Insect_Remover.getNumberOfRunningActions() &&
					  1 == a.pa2_Insect_Remover.getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Insect_Remover),
					  (a.move_tool_pos = a.pa2_Insect_Remover.getPosition()),
					  (a.move_tool_rot = a.pa2_Insect_Remover.getRotation()),
					  (a.move_tool_scale = a.pa2_Insect_Remover.getScale()),
					  (a.move_tool_zorder =
							a.pa2_Insect_Remover.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.pa2_Insect_Remover.runAction(
							cc.RepeatForever.create(
								cc.Animate.create(
									a.pa2_Insect_Remover_anim.clone()
								)
							)
					  ),
					  a.dummyBrush.setScale(1.6),
					  (a.dummyMoveDist = cc.p(-20, -32)))
					: 2 == a.current_sub_part &&
					  a.checkTouchObject(a.pa2_Broom, c) &&
					  0 == a.pa2_Broom.getNumberOfRunningActions() &&
					  1 == a.pa2_Broom.getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Broom),
					  (a.move_tool_pos = a.pa2_Broom.getPosition()),
					  (a.move_tool_rot = a.pa2_Broom.getRotation()),
					  (a.move_tool_scale = a.pa2_Broom.getScale()),
					  (a.move_tool_zorder = a.pa2_Broom.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(1.6, 2.3),
					  (a.dummyMoveDist = cc.p(-55, -50)));
			else if (3 == a.current_part)
				if (1 == a.current_sub_part) {
					for (var o = 1; o <= 5; o++)
						if (
							a.checkTouchObject(a.pa3_Insect[o], c) &&
							2 == a.pa3_Insect[o].getNumberOfRunningActions() &&
							1 == a.pa3_Insect[o].getTag()
						) {
							a.hideHint(),
								a.pa3_Insect[o].setTag(2),
								a.pa3_Insect[o].stopAllActions(),
								a.pa3_Insect[o].setFlippedY(!0),
								a.pa3_Insect[o].runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.5, cc.p(0, -550)),
										cc.ScaleTo.create(0, 0)
									)
								),
								2 == a.pa3_Insect[1].getTag() &&
									2 == a.pa3_Insect[2].getTag() &&
									2 == a.pa3_Insect[3].getTag() &&
									2 == a.pa3_Insect[4].getTag() &&
									2 == a.pa3_Insect[5].getTag() &&
									(a.setTouchOff(0.6),
									a.current_sub_part++,
									a.unschedule(a.startNextPart),
									a.scheduleOnce(a.startNextPart, 0.6));
							break;
						}
				} else
					2 == a.current_sub_part
						? a.checkTouchObject(a.pa3_Spray, c) &&
						  0 == a.pa3_Spray.getNumberOfRunningActions() &&
						  1 == a.pa3_Spray.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa3_Spray),
						  (a.move_tool_pos = a.pa3_Spray.getPosition()),
						  (a.move_tool_rot = a.pa3_Spray.getRotation()),
						  (a.move_tool_scale = a.pa3_Spray.getScale()),
						  (a.move_tool_zorder = a.pa3_Spray.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.pa3_Spray_Flow.setVisible(!0),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setScale(0.5, 0.5),
						  (a.dummyMoveDist = cc.p(-80, 80)))
						: 3 == a.current_sub_part
						? a.checkTouchObject(a.pa3_Brush, c) &&
						  0 == a.pa3_Brush.getNumberOfRunningActions() &&
						  1 == a.pa3_Brush.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa3_Brush),
						  (a.move_tool_pos = a.pa3_Brush.getPosition()),
						  (a.move_tool_rot = a.pa3_Brush.getRotation()),
						  (a.move_tool_scale = a.pa3_Brush.getScale()),
						  (a.move_tool_zorder = a.pa3_Brush.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setScale(0.5, 0.5),
						  (a.dummyMoveDist = cc.p(-50, -70)))
						: 4 == a.current_sub_part
						? a.checkTouchObject(a.pa3_Spray1, c) &&
						  0 == a.pa3_Spray1.getNumberOfRunningActions() &&
						  1 == a.pa3_Spray1.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa3_Spray1),
						  (a.move_tool_pos = a.pa3_Spray1.getPosition()),
						  (a.move_tool_rot = a.pa3_Spray1.getRotation()),
						  (a.move_tool_scale = a.pa3_Spray1.getScale()),
						  (a.move_tool_zorder = a.pa3_Spray1.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.pa3_Spray1_Flow.setVisible(!0),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setScale(0.5, 0.5),
						  (a.dummyMoveDist = cc.p(-100, 60)))
						: 5 == a.current_sub_part &&
						  a.checkTouchObject(a.pa3_Flush, c) &&
						  0 == a.pa3_Flush.getNumberOfRunningActions() &&
						  1 == a.pa3_Flush.getTag() &&
						  (a.hideHint(),
						  a.pa3_Flush.runAction(cc.RotateTo.create(0.3, 45)),
						  a.setTouchOff(0.4),
						  a.current_sub_part++,
						  a.unschedule(a.startNextPart),
						  a.scheduleOnce(a.startNextPart, 0.3));
			else if (4 == a.current_part)
				if (1 == a.current_sub_part) {
					for (o = 1; o <= 5; o++)
						if (
							a.checkTouchObject(a.pa4_albowo_th[o], c) &&
							0 ==
								a.pa4_albowo_th[
									o
								].getNumberOfRunningActions() &&
							1 == a.pa4_albowo_th[o].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa4_albowo_th[o]),
								(a.move_tool_pos =
									a.pa4_albowo_th[o].getPosition()),
								(a.move_tool_rot =
									a.pa4_albowo_th[o].getRotation()),
								(a.move_tool_scale =
									a.pa4_albowo_th[o].getScale()),
								(a.move_tool_zorder =
									a.pa4_albowo_th[o].getLocalZOrder()),
								(a.move_tool_no = o),
								a.move_tool.setLocalZOrder(10),
								a.move_tool.setScale(1),
								a.dummyBrush.setScale(0),
								(a.dummyMoveDist = cc.p(0, 0)),
								a.RandomCommonRoundInd2(
									1,
									a.pa4_albowo_th_pos1[o]
								);
							break;
						}
				} else
					2 == a.current_sub_part &&
						a.checkTouchObject(a.pa4_Flush, c) &&
						0 == a.pa4_Flush.getNumberOfRunningActions() &&
						1 == a.pa4_Flush.getTag() &&
						(a.hideHint(),
						a.pa4_Flush.runAction(cc.RotateBy.create(0.3, 180)),
						a.setTouchOff(0.4),
						a.current_sub_part++,
						a.unschedule(a.startNextPart),
						a.scheduleOnce(a.startNextPart, 0.3));
			return !0;
		}
	},
	onTouchMoved: function (e, t) {
		var e = e.getLocation(),
			c = t.getCurrentTarget();
		c.endPos = e;
		c.endLocation = e;
		if (0 != c.isTouchOn && null != c.move_tool) {
			(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y)),
				(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y));
			if (
				(c.move_tool.setPosition(
					c.move_tool.getParent().convertToNodeSpace(e)
				),
				c.dummyBrush.setPosition(t),
				2 == c.current_part)
			) {
				if (1 == c.current_sub_part) {
					var a = 1;
					c.checkTouchObject(
						c.dummyBrush,
						c.pa2_Insect[a].getPosition()
					) &&
						2 == c.pa2_Insect[a].getNumberOfRunningActions() &&
						1 == c.move_tool.getNumberOfRunningActions() &&
						1 == c.move_tool.getTag() &&
						(c.hideHint(), c.removeInsectPa2(a, t)),
						(a = 2),
						c.checkTouchObject(
							c.dummyBrush,
							c.pa2_Insect[a].getPosition()
						) &&
							2 == c.pa2_Insect[a].getNumberOfRunningActions() &&
							1 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(), c.removeInsectPa2(a, t)),
						(a = 3),
						c.checkTouchObject(
							c.dummyBrush,
							c.pa2_Insect[a].getPosition()
						) &&
							2 == c.pa2_Insect[a].getNumberOfRunningActions() &&
							1 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(), c.removeInsectPa2(a, t)),
						(a = 4),
						c.checkTouchObject(
							c.dummyBrush,
							c.pa2_Insect[a].getPosition()
						) &&
							2 == c.pa2_Insect[a].getNumberOfRunningActions() &&
							1 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(), c.removeInsectPa2(a, t));
				} else if (
					2 == c.current_sub_part &&
					0 < c.dummyPoints.length
				) {
					c.pa2_rt_up.begin(),
						c.dummyBrush.visit(),
						c.pa2_rt_up.end();
					for (var o = 0; o < c.dummyPoints.length; o++)
						c.checkTouchObject(c.dummyBrush, c.dummyPoints[o]) &&
							comman.arrayRemoveIndex(c.dummyPoints, o);
					0 == c.dummyPoints.length &&
						(c.pa2_rt_up.clear(),
						c.move_tool.setTag(2),
						c.move_tool.runAction(
							cc.Sequence.create(
								cc.MoveBy.create(0.2, cc.p(800, 0))
							)
						),
						(c.move_tool = null),
						(c.move_tool_no = 0),
						(c.move_tool_pos = cc.p(0, 0)),
						(c.move_tool_rot = 0),
						c.hideHint(),
						c.setTouchOff(0.3),
						c.unschedule(c.showNext),
						c.scheduleOnce(c.showNext, 0.2));
				}
			} else
				3 == c.current_part
					? 2 == c.current_sub_part
						? ((a = 0),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 1),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 2),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 3),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 4),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 5),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 6),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 7),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 8),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 9),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 10),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 11),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 12),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								1 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(2),
								c.pa3_Bubble[a].setVisible(!0),
								2 == c.pa3_Bubble[0].getTag() &&
									2 == c.pa3_Bubble[1].getTag() &&
									2 == c.pa3_Bubble[2].getTag() &&
									2 == c.pa3_Bubble[3].getTag() &&
									2 == c.pa3_Bubble[4].getTag() &&
									2 == c.pa3_Bubble[5].getTag() &&
									2 == c.pa3_Bubble[6].getTag() &&
									2 == c.pa3_Bubble[7].getTag() &&
									2 == c.pa3_Bubble[8].getTag() &&
									2 == c.pa3_Bubble[9].getTag() &&
									2 == c.pa3_Bubble[10].getTag() &&
									2 == c.pa3_Bubble[11].getTag() &&
									2 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))))
						: 3 == c.current_sub_part
						? ((a = 0),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 1),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 2),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 3),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 4),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 5),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 6),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 7),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 8),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 9),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 10),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 11),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 12),
						  c.checkTouchObject(c.pa3_Bubble[a], t) &&
								2 == c.pa3_Bubble[a].getTag() &&
								(c.pa3_Bubble[a].setTag(3),
								c.pa3_Bubble[a].stopAllActions(),
								c.pa3_Bubble[a].runAction(
									cc.ScaleTo.create(0.05, 0)
								),
								3 == c.pa3_Bubble[0].getTag() &&
									3 == c.pa3_Bubble[1].getTag() &&
									3 == c.pa3_Bubble[2].getTag() &&
									3 == c.pa3_Bubble[3].getTag() &&
									3 == c.pa3_Bubble[4].getTag() &&
									3 == c.pa3_Bubble[5].getTag() &&
									3 == c.pa3_Bubble[6].getTag() &&
									3 == c.pa3_Bubble[7].getTag() &&
									3 == c.pa3_Bubble[8].getTag() &&
									3 == c.pa3_Bubble[9].getTag() &&
									3 == c.pa3_Bubble[10].getTag() &&
									3 == c.pa3_Bubble[11].getTag() &&
									3 == c.pa3_Bubble[12].getTag() &&
									(c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(1200, 0))
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.3),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))))
						: 4 == c.current_sub_part &&
						  ((a = 1),
						  c.checkTouchObject(c.pa3_Gem[a], t) &&
								1 == c.pa3_Gem[a].getTag() &&
								1 == c.pa3_Gem[a].getNumberOfRunningActions() &&
								(c.pa3_Gem[a].setOpacity(
									c.pa3_Gem[a].getOpacity() - 85
								),
								c.pa3_Gem[a].runAction(
									cc.DelayTime.create(0.1)
								),
								0 == c.pa3_Gem[a].getOpacity() &&
									(c.pa3_Gem[a].setTag(2),
									c.pa3_Gem[a].setVisible(!1),
									2 == c.pa3_Gem[1].getTag() &&
										2 == c.pa3_Gem[2].getTag() &&
										2 == c.pa3_Gem[3].getTag() &&
										2 == c.pa3_Gem[4].getTag() &&
										2 == c.pa3_Gem[5].getTag() &&
										(c.move_tool.runAction(
											cc.Sequence.create(
												cc.MoveBy.create(
													0.2,
													cc.p(1200, 0)
												)
											)
										),
										(c.move_tool = null),
										(c.move_tool_no = 0),
										(c.move_tool_pos = cc.p(0, 0)),
										(c.move_tool_rot = 0),
										c.hideHint(),
										c.setTouchOff(0.3),
										c.current_sub_part++,
										c.unschedule(c.startNextPart),
										c.scheduleOnce(c.startNextPart, 0.2)))),
						  (a = 2),
						  c.checkTouchObject(c.pa3_Gem[a], t) &&
								1 == c.pa3_Gem[a].getTag() &&
								1 == c.pa3_Gem[a].getNumberOfRunningActions() &&
								(c.pa3_Gem[a].setOpacity(
									c.pa3_Gem[a].getOpacity() - 85
								),
								c.pa3_Gem[a].runAction(
									cc.DelayTime.create(0.1)
								),
								0 == c.pa3_Gem[a].getOpacity() &&
									(c.pa3_Gem[a].setTag(2),
									c.pa3_Gem[a].setVisible(!1),
									2 == c.pa3_Gem[1].getTag() &&
										2 == c.pa3_Gem[2].getTag() &&
										2 == c.pa3_Gem[3].getTag() &&
										2 == c.pa3_Gem[4].getTag() &&
										2 == c.pa3_Gem[5].getTag() &&
										(c.move_tool.runAction(
											cc.Sequence.create(
												cc.MoveBy.create(
													0.2,
													cc.p(1200, 0)
												)
											)
										),
										(c.move_tool = null),
										(c.move_tool_no = 0),
										(c.move_tool_pos = cc.p(0, 0)),
										(c.move_tool_rot = 0),
										c.hideHint(),
										c.setTouchOff(0.3),
										c.current_sub_part++,
										c.unschedule(c.startNextPart),
										c.scheduleOnce(c.startNextPart, 0.2)))),
						  (a = 3),
						  c.checkTouchObject(c.pa3_Gem[a], t) &&
								1 == c.pa3_Gem[a].getTag() &&
								1 == c.pa3_Gem[a].getNumberOfRunningActions() &&
								(c.pa3_Gem[a].setOpacity(
									c.pa3_Gem[a].getOpacity() - 85
								),
								c.pa3_Gem[a].runAction(
									cc.DelayTime.create(0.1)
								),
								0 == c.pa3_Gem[a].getOpacity() &&
									(c.pa3_Gem[a].setTag(2),
									c.pa3_Gem[a].setVisible(!1),
									2 == c.pa3_Gem[1].getTag() &&
										2 == c.pa3_Gem[2].getTag() &&
										2 == c.pa3_Gem[3].getTag() &&
										2 == c.pa3_Gem[4].getTag() &&
										2 == c.pa3_Gem[5].getTag() &&
										(c.move_tool.runAction(
											cc.Sequence.create(
												cc.MoveBy.create(
													0.2,
													cc.p(1200, 0)
												)
											)
										),
										(c.move_tool = null),
										(c.move_tool_no = 0),
										(c.move_tool_pos = cc.p(0, 0)),
										(c.move_tool_rot = 0),
										c.hideHint(),
										c.setTouchOff(0.3),
										c.current_sub_part++,
										c.unschedule(c.startNextPart),
										c.scheduleOnce(c.startNextPart, 0.2)))),
						  (a = 4),
						  c.checkTouchObject(c.pa3_Gem[a], t) &&
								1 == c.pa3_Gem[a].getTag() &&
								1 == c.pa3_Gem[a].getNumberOfRunningActions() &&
								(c.pa3_Gem[a].setOpacity(
									c.pa3_Gem[a].getOpacity() - 85
								),
								c.pa3_Gem[a].runAction(
									cc.DelayTime.create(0.1)
								),
								0 == c.pa3_Gem[a].getOpacity() &&
									(c.pa3_Gem[a].setTag(2),
									c.pa3_Gem[a].setVisible(!1),
									2 == c.pa3_Gem[1].getTag() &&
										2 == c.pa3_Gem[2].getTag() &&
										2 == c.pa3_Gem[3].getTag() &&
										2 == c.pa3_Gem[4].getTag() &&
										2 == c.pa3_Gem[5].getTag() &&
										(c.move_tool.runAction(
											cc.Sequence.create(
												cc.MoveBy.create(
													0.2,
													cc.p(1200, 0)
												)
											)
										),
										(c.move_tool = null),
										(c.move_tool_no = 0),
										(c.move_tool_pos = cc.p(0, 0)),
										(c.move_tool_rot = 0),
										c.hideHint(),
										c.setTouchOff(0.3),
										c.current_sub_part++,
										c.unschedule(c.startNextPart),
										c.scheduleOnce(c.startNextPart, 0.2)))),
						  (a = 5),
						  c.checkTouchObject(c.pa3_Gem[a], t) &&
								1 == c.pa3_Gem[a].getTag() &&
								1 == c.pa3_Gem[a].getNumberOfRunningActions() &&
								(c.pa3_Gem[a].setOpacity(
									c.pa3_Gem[a].getOpacity() - 85
								),
								c.pa3_Gem[a].runAction(
									cc.DelayTime.create(0.1)
								),
								0 == c.pa3_Gem[a].getOpacity() &&
									(c.pa3_Gem[a].setTag(2),
									c.pa3_Gem[a].setVisible(!1),
									2 == c.pa3_Gem[1].getTag() &&
										2 == c.pa3_Gem[2].getTag() &&
										2 == c.pa3_Gem[3].getTag() &&
										2 == c.pa3_Gem[4].getTag() &&
										2 == c.pa3_Gem[5].getTag() &&
										(c.move_tool.runAction(
											cc.Sequence.create(
												cc.MoveBy.create(
													0.2,
													cc.p(1200, 0)
												)
											)
										),
										(c.move_tool = null),
										(c.move_tool_no = 0),
										(c.move_tool_pos = cc.p(0, 0)),
										(c.move_tool_rot = 0),
										c.hideHint(),
										c.setTouchOff(0.3),
										c.current_sub_part++,
										c.unschedule(c.startNextPart),
										c.scheduleOnce(c.startNextPart, 0.2)))))
					: 4 == c.current_part &&
					  1 == c.current_sub_part &&
					  c.checkTouchObject(
							c.move_tool,
							c.pa4_albowo_th_pos1[c.move_tool_no]
					  ) &&
					  0 == c.move_tool.getNumberOfRunningActions() &&
					  1 == c.move_tool.getTag() &&
					  (c.pa4_albowo[c.move_tool_no].setTag(2),
					  c.move_tool.setTag(2),
					  c.move_tool.runAction(
							cc.Sequence.create(
								cc.MoveTo.create(
									0.1,
									c.pa4_albowo_th_pos1[c.move_tool_no]
								),
								cc.ScaleTo.create(0, 0)
							)
					  ),
					  c.pa4_albowo[c.move_tool_no].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.1),
								cc.TintTo.create(0, 255, 255, 255, 255)
							)
					  ),
					  (c.move_tool = null),
					  (c.move_tool_no = 0),
					  (c.move_tool_pos = cc.p(0, 0)),
					  (c.move_tool_rot = 0),
					  c.hideHint(),
					  c.setTouchOff(0.1),
					  2 == c.pa4_albowo[1].getTag() &&
							2 == c.pa4_albowo[2].getTag() &&
							2 == c.pa4_albowo[3].getTag() &&
							2 == c.pa4_albowo[4].getTag() &&
							2 == c.pa4_albowo[5].getTag() &&
							(c.setTouchOff(0.2),
							c.current_sub_part++,
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2)));
		}
	},
	onTouchEnded: function (e, t) {
		(e = e.getLocation()), (t = t.getCurrentTarget());
		0 != t.isTouchOn &&
			null != t.move_tool &&
			(2 == t.current_part && 1 == t.current_sub_part
				? (t.pa2_Insect_Remover.stopAllActions(),
				  t.pa2_Insect_Remover.setTexture(
						'RES/PA/3/pa2_Insect_Remover.png'
				  ))
				: 3 == t.current_part && 2 == t.current_sub_part
				? t.pa3_Spray_Flow.setVisible(!1)
				: 3 == t.current_part &&
				  4 == t.current_sub_part &&
				  t.pa3_Spray1_Flow.setVisible(!1),
			t.move_tool.runAction(
				cc.Sequence.create(
					cc.Spawn.create(
						cc.MoveTo.create(0.2, t.move_tool_pos),
						cc.ScaleTo.create(0.2, t.move_tool_scale),
						cc.RotateTo.create(0.2, t.move_tool_rot)
					),
					cc.callFunc(t.changeZorder, t.move_tool, t.move_tool_zorder)
				)
			),
			t.move_tool.getParent().convertToNodeSpace(e),
			(t.move_tool = null),
			(t.move_tool_no = 0),
			(t.move_tool_pos = cc.p(0, 0)),
			(t.move_tool_rot = 0),
			t.hideHint(),
			t.setTouchOff(0.2));
	},
	onMouseMove: function (e) {
		var t = e.getLocation(),
			e = e.getCurrentTarget();
		cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) &&
		1 == e.btn_more.getScale() &&
		0 == e.btn_more.getNumberOfRunningActions() &&
		255 == e.btn_more.getOpacity()
			? (e.prt_Sparkle.setPosition(e.btn_more.getPosition()),
			  e.prt_Sparkle.resetSystem(),
			  e.btn_more.setScale(1.03))
			: 1.03 != e.btn_more.getScale() ||
			  cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) ||
			  0 != e.btn_more.getNumberOfRunningActions() ||
			  255 != e.btn_more.getOpacity()
			? cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) &&
			  1 == e.btn_done.getScale() &&
			  0 == e.btn_done.getNumberOfRunningActions() &&
			  255 == e.btn_done.getOpacity()
				? (e.prt_Sparkle.setPosition(e.btn_done.getPosition()),
				  e.prt_Sparkle.resetSystem(),
				  e.btn_done.setScale(1.03))
				: 1.03 != e.btn_done.getScale() ||
				  cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) ||
				  0 != e.btn_done.getNumberOfRunningActions() ||
				  255 != e.btn_done.getOpacity() ||
				  e.btn_done.setScale(1)
			: e.btn_more.setScale(1);
	},
	onMoreApp: function (e) {
		101 == e.getTag()
			? CreateLinksInGame(comman.GameId, 'game', 'more')
			: CreateLinksInGame(comman.GameId, 'game', 'logo');
	},
	onMusicButton: function (e) {
		0 == e.getNumberOfRunningActions() &&
			(e.stopAllActions(),
			e.runAction(
				cc.Sequence.create(
					cc.ScaleTo.create(0, 1),
					cc.ScaleTo.create(0.2, 0.9),
					cc.ScaleTo.create(0.2, 1)
				)
			),
			comman.isMusicEnable
				? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
				  comman.setSoundEnabled(!1))
				: comman.isMusicEnable ||
				  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
				  comman.setSoundEnabled(!0)));
	},
	createMainMenu: function () {
		(this.btn_bb_icon = cc.MenuItemImage.create(
			res_comman.bb_icon_3,
			res_comman.bb_icon_3,
			this.onMoreApp,
			this
		)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.5 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.5 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.MainMenu = cc.Menu.create(this.btn_bb_icon, this.btn_music)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 200);
	},
});
PlayScene_3.scene = function () {
	var e = new cc.Scene(),
		t = new PlayScene_3();
	return e.addChild(t), e;
};
var PlayScene_4 = cc.Scene.extend({
	ctor: function () {
		this._super(), this.init();
	},
	onEnter: function () {
		this._super(),
			cc.eventManager.addListener(
				{
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this.onTouchBegan,
					onTouchMoved: this.onTouchMoved,
					onTouchEnded: this.onTouchEnded,
				},
				this
			),
			'mouse' in cc.sys.capabilities &&
				cc.eventManager.addListener(
					{
						event: cc.EventListener.MOUSE,
						onMouseMove: this.onMouseMove,
					},
					this
				);
	},
	init: function () {
		this._super(),
			(this.startPos = cc.p(0, 0)),
			(this.endPos = cc.p(0, 0)),
			(this.isDoneShow = !1),
			(this.isNextShow = !1),
			(this.lyl_puzzles = null),
			(this.move_tool = null),
			(this.move_tool_no = 0),
			(this.move_tool_rot = 0),
			(this.move_tool_s_pos = cc.p(1e4, 1e4)),
			(this.isTouchOn = !1),
			(this.current_part = 1),
			(this.current_sub_part = 1),
			(this.current_sub_sub_part = 1),
			(this.current_tool = 1),
			this.setTouchOff(0.1),
			(this.bg = cc.Sprite.create('RES/PA/4/Bg_1.png')),
			this.bg.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.bg.setScale(1),
			this.addChild(this.bg),
			(this.dummyPoints = []),
			this.createPlayarea(),
			this.createPanels(),
			(this.btn_bb_icon = cc.MenuItemImage.create(
				res_comman.bb_icon_3,
				res_comman.bb_icon_3,
				this.onMoreApp,
				this
			)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_more = cc.MenuItemImage.create(
				res_common_button.btn_more,
				res_common_button.btn_more,
				this.onMoreApp,
				this
			)),
			this.btn_more.setScale(1),
			this.btn_more.setTag(101),
			this.btn_more.setPosition(
				cc.p(
					comman.winSize().width -
						1.6 * this.btn_more.getContentSize().width,
					comman.winSize().height +
						0.55 * this.btn_more.getContentSize().height
				)
			),
			this.btn_more.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							this.btn_more.getPositionX(),
							comman.winSize().height -
								0.55 * this.btn_more.getContentSize().height
						)
					)
				)
			),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.55 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.55 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.btn_done = cc.MenuItemImage.create(
				res_common_button.btn_done,
				res_common_button.btn_done,
				this.onDoneClick,
				this
			)),
			this.btn_done.setScale(1),
			this.btn_done.setTag(101),
			this.btn_done.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_done.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_done.getContentSize().height
				)
			),
			(this.btn_next = cc.MenuItemImage.create(
				res_common_button.btn_next,
				res_common_button.btn_next,
				this.onNextClick,
				this
			)),
			this.btn_next.setScale(1),
			this.btn_next.setTag(101),
			this.btn_next.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_next.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_next.getContentSize().height
				)
			),
			(this.MainMenu = cc.Menu.create(
				this.btn_bb_icon,
				this.btn_done,
				this.btn_more,
				this.btn_music,
				this.btn_next
			)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 100),
			(this.prt_Sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_1_plist
			)),
			this.prt_Sparkle.setScale(1.5),
			this.prt_Sparkle.stopSystem(),
			this.addChild(this.prt_Sparkle),
			this.prt_Sparkle.setLocalZOrder(500),
			(this.prt_tool_sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_2_plist
			)),
			this.prt_tool_sparkle.setScale(1),
			this.prt_tool_sparkle.stopSystem(),
			this.addChild(this.prt_tool_sparkle),
			this.prt_tool_sparkle.setLocalZOrder(500),
			(this.CommonHandIndicator = cc.Sprite.create(
				res_common_button.arrow_ind_3_img
			)),
			this.CommonHandIndicator.setScale(0),
			this.CommonHandIndicator.setAnchorPoint(cc.p(0.55, 0.1)),
			this.addChild(this.CommonHandIndicator, 10),
			this.CommonHandIndicator.setPosition(cc.p(25e3, 25e3)),
			(this.CommonRoundIndicator = []);
		for (var e = 0; e < 15; e++)
			(this.CommonRoundIndicator[e] = cc.Sprite.create(
				res_common_button.indicator_img
			)),
				this.CommonRoundIndicator[e].setScale(0),
				this.CommonRoundIndicator[e].setAnchorPoint(cc.p(0.5, 0.5)),
				this.CommonRoundIndicator[e].setColor(cc.color(0, 255, 0)),
				this.addChild(this.CommonRoundIndicator[e], 10),
				this.CommonRoundIndicator[e].setPosition(cc.p(25e3, 25e3));
		this.CommonRoundIndicator1 = [];
		for (e = 0; e < 15; e++)
			(this.CommonRoundIndicator1[e] = cc.Sprite.create(
				res_common_button.arrow
			)),
				this.CommonRoundIndicator1[e].setScale(0),
				this.CommonRoundIndicator1[e].setAnchorPoint(cc.p(0.5, 0)),
				this.addChild(this.CommonRoundIndicator1[e], 10),
				this.CommonRoundIndicator1[e].setPosition(cc.p(25e3, 25e3));
		this.startNextPart();
	},
	RandomCommonHandInd: function () {
		var e, t, c, a;
		2 == this.current_part
			? 2 == this.current_sub_part
				? ((c = this.pa2_Scrap_Tool_pos),
				  (a = this.pa2_WallCrackPart_pos[comman.getRandomInt(1, 5)]),
				  this.RandomCommonHandIndOneWay(c, a))
				: 3 == this.current_sub_part
				? ((c = this.pa2_Roller_pos),
				  (a = this.pa2_WallCrackPart_pos[comman.getRandomInt(1, 5)]),
				  this.RandomCommonHandIndOneWay(c, a))
				: 4 == this.current_sub_part &&
				  ((c = this.pa2_Wall_Th_pos[comman.getRandomInt(1, 3)]),
				  (a = cc.p(368, 254)),
				  this.RandomCommonHandIndOneWay(c, a))
			: 3 == this.current_part
			? 1 == this.current_sub_part
				? ((t = comman.getRandomInt(1, 3)),
				  (c = this.pa3_Part_Th_pos[t]),
				  (a = this.pa3_Part_pos[t]),
				  this.RandomCommonHandIndOneWay(c, a))
				: 2 == this.current_sub_part
				? ((c = this.pa3_Brush_pos),
				  (a = cc.p(337, 147)),
				  this.RandomCommonHandIndOneWay(c, a))
				: 3 == this.current_sub_part &&
				  ((c = this.pa3_Glue_Bottle_pos),
				  (a = cc.p(464, 275)),
				  (e = cc.p(396, 325)),
				  (t = cc.p(375, 408)),
				  this.RandomCommonHandIndThreeWay1(c, a, e, t))
			: 4 == this.current_part &&
			  (2 == this.current_sub_part
					? ((c = this.pa4_Screw_pos),
					  (a = this.pa4_Screw_pos1),
					  this.RandomCommonHandIndOneWay(c, a))
					: 4 == this.current_sub_part &&
					  ((c = this.pa4_Frame_Done_Move_pos),
					  (a = this.pa4_Frame_Done_Move_pos1),
					  this.RandomCommonHandIndOneWay(c, a)));
	},
	RandomCommonHandInd1: function () {
		var e;
		2 == this.current_part
			? 1 == this.current_sub_part &&
			  ((e = cc.p(383, 160)), this.RandomCommonHandIndJump(e))
			: 3 == this.current_part
			? 1 == this.current_sub_part
				? ((e = this.pa3_Insect_pos[comman.getRandomInt(1, 5)]),
				  this.RandomCommonHandIndJump(e))
				: 5 == this.current_sub_part &&
				  ((e = cc.p(434, 231)), this.RandomCommonHandIndJump(e))
			: 4 == this.current_part &&
			  (1 == this.current_sub_part
					? ((e = cc.p(407, 198)), this.RandomCommonHandIndJump(e))
					: 3 == this.current_sub_part &&
					  ((e = cc.p(555, 282)), this.RandomCommonHandIndJump(e)));
	},
	RandomCommonHandIndOneWay: function (e, t) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(0.5, t),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(1)
					)
				)
			);
	},
	RandomCommonHandIndTwoWay: function (e, t, c) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, e),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, c),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay1: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(2, c),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndJump: function (e) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.JumpTo.create(1.5, e, 5, 2),
						cc.ScaleTo.create(0, 0),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonRoundInd: function (e) {},
	RandomCommonRoundInd1: function (e) {
		this.CommonRoundIndicator[1].setPosition(e),
			this.CommonRoundIndicator[1].stopAllActions(),
			this.CommonRoundIndicator[1].setScale(1),
			this.CommonRoundIndicator[1].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	RandomCommonRoundInd2: function (e, t) {
		this.CommonRoundIndicator[e].setPosition(t),
			this.CommonRoundIndicator[e].stopAllActions(),
			this.CommonRoundIndicator[e].setScale(1),
			this.CommonRoundIndicator[e].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	hideHint: function () {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setScale(0);
		for (var e = 0; e < 15; e++)
			this.CommonRoundIndicator[e].stopAllActions(),
				this.CommonRoundIndicator[e].setScale(0);
	},
	showToolCompleteParticle: function (e) {
		this.prt_tool_sparkle.setPosition(e),
			this.prt_tool_sparkle.resetSystem();
	},
	showDone: function () {
		0 == this.isDoneShow &&
			((this.isDoneShow = !0),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	showNext: function () {
		0 == this.isNextShow &&
			((this.isNextShow = !0),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	hideDone: function () {
		1 == this.isDoneShow &&
			((this.isDoneShow = !1),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	hideNext: function () {
		1 == this.isNextShow &&
			((this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	createPlayarea: function () {
		(this.dummyMoveDist = cc.p(0, 0)),
			(this.dummyBrush = cc.Sprite.create('RES/CB/brush.png')),
			this.dummyBrush.setPosition(cc.p(1e3, 1e3)),
			this.dummyBrush.setScale(0),
			this.dummyBrush.setOpacity(255),
			this.dummyBrush.setBlendFunc(cc.ZERO, cc.ONE_MINUS_SRC_ALPHA),
			this.addChild(this.dummyBrush, -100),
			(this.lyl_play = cc.Layer.create()),
			this.addChild(this.lyl_play),
			(this.lyl_part = []),
			(this.lyl_sub_part = []);
		var e = 0;
		(this.lyl_part[e] = cc.Layer.create()),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 1;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa1_Wall_Dirty = cc.Sprite.create(
				'RES/PA/4/pa1_Wall_Dirty.png'
			)),
			this.pa1_Wall_Dirty.setPosition(cc.p(400, 252)),
			this.pa1_Wall_Dirty.setScale(1),
			this.pa1_Wall_Dirty.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Wall_Dirty),
			(this.pa1_Picture = cc.Sprite.create(
				'RES/PA/4/pa1_Picture_Crack.png'
			)),
			this.pa1_Picture.setPosition(cc.p(400, 252)),
			this.pa1_Picture.setScale(1),
			this.pa1_Picture.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Picture),
			(this.pa1_Big_Panda_pos1 = cc.p(666, -70)),
			(this.pa1_Big_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Big_Panda.json',
				'RES/PA/anim/Big_Panda.atlas',
				0.5
			)),
			this.pa1_Big_Panda.setPosition(
				cc.p(this.pa1_Big_Panda_pos1.x, this.pa1_Big_Panda_pos1.y)
			),
			this.pa1_Big_Panda.setScale(1, 1),
			this.pa1_Big_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Big_Panda),
			this.pa1_Big_Panda.setAnimation(1, 'Sad', !0),
			(this.pa1_Panda_pos1 = cc.p(133, -30)),
			(this.pa1_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Panda.json',
				'RES/PA/anim/Panda.atlas',
				0.5
			)),
			this.pa1_Panda.setPosition(
				cc.p(this.pa1_Panda_pos1.x, this.pa1_Panda_pos1.y - 400)
			),
			this.pa1_Panda.setScale(1, 1),
			this.pa1_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Panda),
			this.pa1_Panda.setAnimation(1, 'Idle', !0);
		e = 2;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa2_Wall = cc.Sprite.create('RES/PA/4/pa2_Wall.png')),
			this.pa2_Wall.setPosition(cc.p(400, 252)),
			this.pa2_Wall.setScale(1),
			this.pa2_Wall.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Wall),
			(this.pa2_rt_up = new cc.RenderTexture(800, 504)),
			this.pa2_rt_up.setPosition(cc.p(400, 252)),
			this.pa2_rt_up.setScale(1),
			this.lyl_part[e].addChild(this.pa2_rt_up),
			this.pa2_rt_up.begin(),
			this.pa2_Wall.visit(),
			this.pa2_rt_up.end(),
			this.pa2_Wall.setTexture('RES/PA/4/pa2_Siment.png'),
			(this.pa2_WallCrackPart = []),
			(this.pa2_WallCrackPart_pos = [
				cc.p(0, 0),
				cc.p(197, 310),
				cc.p(348, 289),
				cc.p(493, 336),
				cc.p(347, 173),
				cc.p(518, 157),
			]);
		for (var t = 1; t <= 5; t++)
			(this.pa2_WallCrackPart[t] = cc.Sprite.create(
				'RES/PA/4/pa2_WallCrackPart_' + t + '_1.png'
			)),
				this.pa2_WallCrackPart[t].setPosition(cc.p(400, 252)),
				this.pa2_WallCrackPart[t].setScale(1),
				this.pa2_WallCrackPart[t].setTag(1),
				this.lyl_part[e].addChild(this.pa2_WallCrackPart[t]);
		(this.pa2_WallCrack = []), (this.pa2_WallCrack_anim = []);
		for (t = 1; t <= 3; t++)
			(this.pa2_WallCrack[t] = cc.Sprite.create(
				'RES/PA/4/pa2_WallCrack_' + t + '_1.png'
			)),
				this.pa2_WallCrack[t].setPosition(cc.p(400, 252)),
				this.pa2_WallCrack[t].setScale(1),
				this.pa2_WallCrack[t].setTag(1),
				this.lyl_part[e].addChild(this.pa2_WallCrack[t]),
				(this.pa2_WallCrack_anim[t] = cc.Animation.create()),
				this.pa2_WallCrack_anim[t].setDelayPerUnit(0.1),
				this.pa2_WallCrack_anim[t].addSpriteFrameWithFile(
					'RES/PA/4/pa2_WallCrack_' + t + '_1.png'
				),
				this.pa2_WallCrack_anim[t].addSpriteFrameWithFile(
					'RES/PA/4/pa2_WallCrack_' + t + '_2.png'
				),
				this.pa2_WallCrack_anim[t].addSpriteFrameWithFile(
					'RES/PA/4/pa2_WallCrack_' + t + '_3.png'
				);
		(this.pa2_WallPart = []),
			(this.pa2_WallPart_pos = [
				cc.p(0, 0),
				cc.p(210, 375),
				cc.p(364, 376),
				cc.p(520, 376),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa2_WallPart[t] = cc.Sprite.create(
				'RES/PA/4/pa2_WallPart_' + t + '_1_1.png'
			)),
				this.pa2_WallPart[t].setPosition(cc.p(400, 252)),
				this.pa2_WallPart[t].setScale(1),
				this.pa2_WallPart[t].setTag(1),
				this.pa2_WallPart[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa2_WallPart[t]);
		(this.pa2_WallPart_Hint = []),
			(this.pa2_WallPart_Hint_pos = [
				cc.p(0, 0),
				cc.p(219, 253),
				cc.p(374, 253),
				cc.p(526, 253),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa2_WallPart_Hint[t] = cc.Sprite.create(
				'RES/PA/4/pa2_WallPart_Hint.png'
			)),
				this.pa2_WallPart_Hint[t].setPosition(
					this.pa2_WallPart_Hint_pos[t]
				),
				this.pa2_WallPart_Hint[t].setScale(1),
				this.pa2_WallPart_Hint[t].setTag(1),
				this.pa2_WallPart_Hint[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa2_WallPart_Hint[t]),
				this.pa2_WallPart_Hint[t].runAction(
					cc.RepeatForever.create(
						cc.Sequence.create(
							cc.FadeTo.create(0.5, 150),
							cc.FadeTo.create(0.5, 255)
						)
					)
				);
		(this.pa2_Scrap_Tool_pos = cc.p(710, 125)),
			(this.pa2_Scrap_Tool = cc.Sprite.create(
				'RES/PA/4/pa2_Scrap_Tool.png'
			)),
			this.pa2_Scrap_Tool.setPosition(
				cc.p(this.pa2_Scrap_Tool_pos.x + 500, this.pa2_Scrap_Tool_pos.y)
			),
			this.pa2_Scrap_Tool.setAnchorPoint(cc.p(0.57, 0.36)),
			this.pa2_Scrap_Tool.setScale(1),
			this.pa2_Scrap_Tool.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Scrap_Tool),
			(this.pa2_Roller_pos = cc.p(720, 106)),
			(this.pa2_Roller = cc.Sprite.create('RES/PA/4/pa2_Roller_1.png')),
			this.pa2_Roller.setPosition(
				cc.p(this.pa2_Roller_pos.x + 500, this.pa2_Roller_pos.y)
			),
			this.pa2_Roller.setAnchorPoint(cc.p(0.6, 0.42)),
			this.pa2_Roller.setScale(1),
			this.pa2_Roller.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Roller),
			(this.pa2_Roller_anim = cc.Animation.create()),
			this.pa2_Roller_anim.setDelayPerUnit(0.1),
			this.pa2_Roller_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa2_Roller_1.png'
			),
			this.pa2_Roller_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa2_Roller_2.png'
			),
			(this.pa2_lyl_panel = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.pa2_lyl_panel.setScale(1),
			this.pa2_lyl_panel.setPosition(cc.p(500, 0)),
			this.lyl_part[e].addChild(this.pa2_lyl_panel),
			(this.pa2_Panel = cc.Sprite.create('RES/PA/2/pa3_Panel.png')),
			this.pa2_Panel.setPosition(cc.p(700, 228)),
			this.pa2_Panel.setScale(1),
			this.pa2_Panel.setTag(1),
			this.pa2_lyl_panel.addChild(this.pa2_Panel),
			(this.pa2_Wall_Th = []),
			(this.pa2_Wall_Th_pos = [
				cc.p(0, 0),
				cc.p(700, 331),
				cc.p(700, 226),
				cc.p(700, 118),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa2_Wall_Th[t] = cc.Sprite.create(
				'RES/PA/4/pa2_Wall_Th_' + t + '.png'
			)),
				this.pa2_Wall_Th[t].setPosition(this.pa2_Wall_Th_pos[t]),
				this.pa2_Wall_Th[t].setScale(1),
				this.pa2_Wall_Th[t].setTag(1),
				this.pa2_lyl_panel.addChild(this.pa2_Wall_Th[t]);
		e = 3;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa3_Frame = cc.Sprite.create('RES/PA/4/pa3_Frame.png')),
			this.pa3_Frame.setPosition(cc.p(400, 252)),
			this.pa3_Frame.setScale(1),
			this.pa3_Frame.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Frame),
			(this.pa3_Main_Part = cc.Sprite.create(
				'RES/PA/4/pa3_Main_Part.png'
			)),
			this.pa3_Main_Part.setPosition(cc.p(400, 252)),
			this.pa3_Main_Part.setScale(1),
			this.pa3_Main_Part.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Main_Part),
			(this.pa3_Part = []),
			(this.pa3_Part_pos = [
				cc.p(0, 0),
				cc.p(461, 330),
				cc.p(428, 119),
				cc.p(254, 243),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa3_Part[t] = cc.Sprite.create(
				'RES/PA/4/pa3_Part_' + t + '.png'
			)),
				this.pa3_Part[t].setPosition(cc.p(400, 252)),
				this.pa3_Part[t].setScale(1),
				this.pa3_Part[t].setTag(1),
				this.pa3_Part[t].setVisible(!1),
				this.pa3_Main_Part.addChild(this.pa3_Part[t]);
		(this.pa3_Part_Hint = cc.Sprite.create('RES/PA/4/pa3_Part_Hint_1.png')),
			this.pa3_Part_Hint.setPosition(cc.p(400, 252)),
			this.pa3_Part_Hint.setScale(1),
			this.pa3_Part_Hint.setTag(1),
			this.pa3_Part_Hint.setVisible(!1),
			this.pa3_Main_Part.addChild(this.pa3_Part_Hint),
			(this.pa3_Dust = cc.Sprite.create('RES/PA/4/pa3_Dust.png')),
			this.pa3_Dust.setPosition(cc.p(400, 252)),
			this.pa3_Dust.setScale(1),
			this.pa3_Dust.setTag(1),
			this.pa3_Dust.setVisible(!1),
			this.lyl_part[e].addChild(this.pa3_Dust),
			(this.pa3_Glue_Part = []),
			(this.pa3_Glue_Stock = []),
			(this.pa3_Glue = []);
		for (t = 1; t <= 3; t++)
			(this.pa3_Glue_Part[t] = cc.Sprite.create(
				'RES/PA/4/pa3_Glue_Part_' + t + '.png'
			)),
				this.pa3_Glue_Part[t].setPosition(cc.p(400, 252)),
				this.pa3_Glue_Part[t].setScale(1),
				this.pa3_Glue_Part[t].setTag(1),
				this.pa3_Glue_Part[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa3_Glue_Part[t]),
				(this.pa3_Glue[t] = cc.Sprite.create(
					'RES/PA/4/pa3_Glue_' + t + '.png'
				)),
				this.pa3_Glue[t].setPosition(cc.p(400, 252)),
				this.pa3_Glue[t].setScale(1),
				this.pa3_Glue[t].setTag(1),
				this.pa3_Glue[t].setVisible(!1),
				this.pa3_Glue_Part[t].addChild(this.pa3_Glue[t]),
				(this.pa3_Glue_Stock[t] = cc.Sprite.create(
					'RES/PA/4/pa3_Glue_Stock_' + t + '.png'
				)),
				this.pa3_Glue_Stock[t].setPosition(cc.p(400, 252)),
				this.pa3_Glue_Stock[t].setScale(1),
				this.pa3_Glue_Stock[t].setTag(1),
				this.pa3_Glue_Stock[t].setVisible(!1),
				this.pa3_Glue_Part[t].addChild(this.pa3_Glue_Stock[t]);
		(this.pa3_rt_up = new cc.RenderTexture(800, 504)),
			this.pa3_rt_up.setPosition(cc.p(400, 252)),
			this.pa3_rt_up.setScale(1),
			this.lyl_part[e].addChild(this.pa3_rt_up),
			(this.pa3_lyl_panel = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.pa3_lyl_panel.setScale(1),
			this.pa3_lyl_panel.setPosition(cc.p(500, 0)),
			this.lyl_part[e].addChild(this.pa3_lyl_panel),
			(this.pa3_Panel = cc.Sprite.create('RES/PA/2/pa3_Panel.png')),
			this.pa3_Panel.setPosition(cc.p(700, 228)),
			this.pa3_Panel.setScale(1),
			this.pa3_Panel.setTag(1),
			this.pa3_lyl_panel.addChild(this.pa3_Panel),
			(this.pa3_Part_Th = []),
			(this.pa3_Part_Th_pos = [
				cc.p(0, 0),
				cc.p(700, 331),
				cc.p(700, 226),
				cc.p(700, 118),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa3_Part_Th[t] = cc.Sprite.create(
				'RES/PA/4/pa3_Part_Th_' + t + '.png'
			)),
				this.pa3_Part_Th[t].setPosition(this.pa3_Part_Th_pos[t]),
				this.pa3_Part_Th[t].setScale(0.45),
				this.pa3_Part_Th[t].setTag(1),
				this.pa3_lyl_panel.addChild(this.pa3_Part_Th[t]);
		(this.pa3_Brush_pos = cc.p(723, 214)),
			(this.pa3_Brush = cc.Sprite.create('RES/PA/4/pa3_Brush.png')),
			this.pa3_Brush.setPosition(
				cc.p(this.pa3_Brush_pos.x + 500, this.pa3_Brush_pos.y)
			),
			this.pa3_Brush.setAnchorPoint(cc.p(0.6, 0.42)),
			this.pa3_Brush.setScale(0.7),
			this.pa3_Brush.setTag(0),
			this.pa3_Brush.setRotation(-140),
			this.lyl_part[e].addChild(this.pa3_Brush),
			(this.pa3_Glue_Bottle_pos = cc.p(723, 214)),
			(this.pa3_Glue_Bottle = cc.Sprite.create(
				'RES/PA/4/pa3_Glue_Bottle.png'
			)),
			this.pa3_Glue_Bottle.setPosition(
				cc.p(
					this.pa3_Glue_Bottle_pos.x + 500,
					this.pa3_Glue_Bottle_pos.y
				)
			),
			this.pa3_Glue_Bottle.setAnchorPoint(cc.p(0.6, 0.42)),
			this.pa3_Glue_Bottle.setScale(0.7),
			this.pa3_Glue_Bottle.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Glue_Bottle);
		e = 4;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa4_Hole = cc.Sprite.create('RES/PA/4/pa4_Hole.png')),
			this.pa4_Hole.setPosition(cc.p(400, 252)),
			this.pa4_Hole.setScale(1),
			this.pa4_Hole.setTag(1),
			this.lyl_part[e].addChild(this.pa4_Hole),
			(this.pa4_Hole1 = cc.Sprite.create('RES/PA/4/pa4_Hole1.png')),
			this.pa4_Hole1.setPosition(cc.p(407, 359)),
			this.pa4_Hole1.setScale(0),
			this.pa4_Hole1.setTag(1),
			this.lyl_part[e].addChild(this.pa4_Hole1),
			(this.pa4_Screw_Driver = cc.Sprite.create(
				'RES/PA/4/pa4_Screw_Driver_1.png'
			)),
			this.pa4_Screw_Driver.setPosition(cc.p(406, 219)),
			this.pa4_Screw_Driver.setScale(1),
			this.pa4_Screw_Driver.setTag(1),
			this.lyl_part[e].addChild(this.pa4_Screw_Driver),
			(this.pa4_Screw_Driver_anim = cc.Animation.create()),
			this.pa4_Screw_Driver_anim.setDelayPerUnit(0.1),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_1.png'
			),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_2.png'
			),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_3.png'
			),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_4.png'
			),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_5.png'
			),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_6.png'
			),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_7.png'
			),
			this.pa4_Screw_Driver_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_Driver_8.png'
			),
			(this.pa4_Screw_pos = cc.p(704, 173)),
			(this.pa4_Screw_pos1 = cc.p(407, 324)),
			(this.pa4_Screw = cc.Sprite.create('RES/PA/4/pa4_Screw_1.png')),
			this.pa4_Screw.setPosition(
				cc.p(this.pa4_Screw_pos.x + 500, this.pa4_Screw_pos.y)
			),
			this.pa4_Screw.setScale(1),
			this.pa4_Screw.setTag(0),
			this.lyl_part[e].addChild(this.pa4_Screw),
			(this.pa4_Screw_anim = cc.Animation.create()),
			this.pa4_Screw_anim.setDelayPerUnit(0.1),
			this.pa4_Screw_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_1.png'
			),
			this.pa4_Screw_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_2.png'
			),
			this.pa4_Screw_anim.addSpriteFrameWithFile(
				'RES/PA/4/pa4_Screw_3.png'
			),
			(this.pa4_Panu_pos = cc.p(410, 285)),
			(this.pa4_Panu_pos1 = cc.p(405, 359)),
			(this.pa4_Panu = cc.Sprite.create('RES/PA/4/pa4_Panu.png')),
			this.pa4_Panu.setPosition(
				cc.p(this.pa4_Panu_pos.x + 500, this.pa4_Panu_pos.y)
			),
			this.pa4_Panu.setAnchorPoint(cc.p(0.1, 0.5)),
			this.pa4_Panu.setScale(1),
			this.pa4_Panu.setTag(0),
			this.lyl_part[e].addChild(this.pa4_Panu),
			(this.pa4_Frame_Done_Move_pos = cc.p(690, 152)),
			(this.pa4_Frame_Done_Move_pos1 = cc.p(409, 236)),
			(this.pa4_Frame_Done_Move = cc.Sprite.create(
				'RES/PA/4/pa4_Frame_Done_Move.png'
			)),
			this.pa4_Frame_Done_Move.setPosition(
				cc.p(
					this.pa4_Frame_Done_Move_pos.x + 500,
					this.pa4_Frame_Done_Move_pos.y
				)
			),
			this.pa4_Frame_Done_Move.setScale(1),
			this.pa4_Frame_Done_Move.setTag(0),
			this.lyl_part[e].addChild(this.pa4_Frame_Done_Move);
		e = 5;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 6;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.lyl_part[e].setScale(0),
			this.lyl_part[e].setPosition(cc.p(0, 0)),
			this.lyl_play.addChild(this.lyl_part[e]);
	},
	startNextPart: function () {
		if (0 == this.current_part)
			this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part &&
					(this.setTouchOff(0.1),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0));
		else if (1 == this.current_part)
			this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part
					? (this.pa1_Big_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(3),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Big_Panda_pos1.x,
										this.pa1_Big_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  this.pa1_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.5),
								cc.MoveTo.create(0.3, this.pa1_Panda_pos1),
								cc.DelayTime.create(2.2),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Panda_pos1.x,
										this.pa1_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  (this.current_part = 2),
					  (this.current_sub_part = 1),
					  this.setTouchOff(3.4),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 3.3))
					: 2 == this.current_sub_part
					? (this.pa1_Wall_Dirty.setScale(0),
					  this.bg.setTexture('RES/PA/4/Bg_1.png'),
					  this.lyl_part[2].setScale(0),
					  (this.current_part = 3),
					  (this.current_sub_part = 1),
					  this.setTouchOff(2.1),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 2))
					: 3 == this.current_sub_part &&
					  (this.pa1_Picture.setTexture('RES/PA/4/pa1_Picture.png'),
					  this.bg.setTexture('RES/PA/4/Bg_1.png'),
					  this.lyl_part[3].setScale(0),
					  this.lyl_part[4].setScale(0),
					  this.setTouchOff(0.5),
					  this.unschedule(this.showDone),
					  this.scheduleOnce(this.showDone, 0.2));
		else if (2 == this.current_part)
			this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part
					? (this.bg.setTexture('RES/PA/4/Bg_2.png'),
					  this.setTouchOff(0.1),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, 0))
					: 2 == this.current_sub_part
					? (this.pa2_Scrap_Tool.setTag(1),
					  this.pa2_Scrap_Tool.runAction(
							cc.MoveTo.create(0.2, this.pa2_Scrap_Tool_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 3 == this.current_sub_part
					? (this.pa2_Roller.setTag(1),
					  this.pa2_Roller.runAction(
							cc.MoveTo.create(0.2, this.pa2_Roller_pos)
					  ),
					  this.addDummyPoints(),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 4 == this.current_sub_part &&
					  (this.pa2_lyl_panel.runAction(
							cc.MoveTo.create(0.2, cc.p(0, 0))
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2));
		else if (3 == this.current_part) {
			if (
				(this.lyl_part[1].setScale(0),
				this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				this.bg.setTexture('RES/PA/4/Bg_3.png'),
					this.pa3_lyl_panel.runAction(
						cc.MoveTo.create(0.2, cc.p(0, 0))
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (2 == this.current_sub_part)
				this.pa3_Dust.setVisible(!0),
					this.pa3_rt_up.begin(),
					this.pa3_Dust.visit(),
					this.pa3_rt_up.end(),
					this.pa3_Dust.setVisible(!1),
					this.pa3_Brush.setTag(1),
					this.pa3_Brush.runAction(
						cc.MoveTo.create(0.2, this.pa3_Brush_pos)
					),
					this.addDummyPoints(),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (3 == this.current_sub_part) {
				for (var e = 1; e <= 3; e++)
					this.pa3_Part[e].setVisible(!0),
						this.pa3_Glue_Part[e].setVisible(!0),
						this.pa3_Glue_Stock[e].setVisible(!0);
				this.pa3_rt_up.begin(),
					this.pa3_Main_Part.visit(),
					this.pa3_Part[1].visit(),
					this.pa3_Part[2].visit(),
					this.pa3_Part[3].visit();
				for (e = 1; e <= 3; e++) this.pa3_Glue_Part[e].visit();
				this.pa3_rt_up.end();
				for (e = 1; e <= 3; e++) this.pa3_Glue[e].setVisible(!0);
				this.pa3_Glue_Bottle.setTag(1),
					this.pa3_Glue_Bottle.runAction(
						cc.MoveTo.create(0.2, this.pa3_Glue_Bottle_pos)
					),
					this.addDummyPoints(),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			} else if (4 == this.current_sub_part) {
				this.pa3_Main_Part.setTexture('RES/PA/4/pa3_Picture_Done.png');
				for (e = 1; e <= 3; e++)
					this.pa3_Part[e].setVisible(!1),
						this.pa3_Glue_Part[e].runAction(cc.FadeOut.create(0.2)),
						this.pa3_Glue_Stock[e].runAction(
							cc.FadeOut.create(0.2)
						),
						this.pa3_Glue[e].runAction(cc.FadeOut.create(0.2));
				this.setTouchOff(0.3),
					this.unschedule(this.showNext),
					this.scheduleOnce(this.showNext, 0.2);
			}
		} else
			4 == this.current_part &&
				(this.lyl_part[1].setScale(0),
				this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part
					? (this.bg.setTexture('RES/PA/4/Bg_4.png'),
					  this.pa4_Screw_Driver.setTag(1),
					  this.setTouchOff(0.1),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, 0.1))
					: 2 == this.current_sub_part
					? (this.pa4_Screw.setTag(1),
					  this.pa4_Screw.runAction(
							cc.MoveTo.create(0.2, this.pa4_Screw_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 3 == this.current_sub_part
					? (this.pa4_Screw.setLocalZOrder(0),
					  this.pa4_Panu.setLocalZOrder(0),
					  this.pa4_Panu.setTag(1),
					  this.pa4_Panu.runAction(
							cc.MoveTo.create(0.2, this.pa4_Panu_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, 0.2))
					: 4 == this.current_sub_part &&
					  (this.pa4_Hole.setVisible(!1),
					  this.pa4_Hole1.setVisible(!1),
					  this.pa4_Screw.setScale(0.5),
					  this.pa4_Frame_Done_Move.setTag(1),
					  this.pa4_Frame_Done_Move.runAction(
							cc.MoveTo.create(0.2, this.pa4_Frame_Done_Move_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2)));
	},
	angleBetweenPoints: function (e, t) {
		var c = e.y - t.y,
			e = t.x - e.x,
			e = Math.atan2(c, e),
			e = cc.radiansToDegrees(e);
		return 180 < e && (e -= 180), e + 90;
	},
	createPanels: function () {},
	updateRewardAds: function () {
		1 == comman.isRewardAdComplete
			? (this.rewardItem.getChildByName('rads').setVisible(!1),
			  (this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds))
			: 1 == comman.isRewardAdFailed &&
			  ((this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds));
	},
	startNextPart_call: function () {
		this.startNextPart();
	},
	startNextPart_call1: function () {
		this.startNextPart();
	},
	startNextPart_call2: function () {
		this.startNextPart();
	},
	checkLevelComplete: function () {
		this.showDone();
	},
	addDummyPoints: function () {
		(this.dummyPoints = [cc.p(1562, 308)]),
			2 == this.current_part && 3 == this.current_sub_part
				? (this.dummyPoints = [
						cc.p(157, 422),
						cc.p(171, 422),
						cc.p(190, 417),
						cc.p(205, 417),
						cc.p(229, 417),
						cc.p(257, 417),
						cc.p(278, 417),
						cc.p(306, 417),
						cc.p(350, 417),
						cc.p(396, 418),
						cc.p(419, 417),
						cc.p(435, 416),
						cc.p(455, 416),
						cc.p(492, 417),
						cc.p(514, 416),
						cc.p(553, 417),
						cc.p(574, 417),
						cc.p(586, 417),
						cc.p(589, 390),
						cc.p(575, 389),
						cc.p(561, 388),
						cc.p(547, 384),
						cc.p(538, 384),
						cc.p(528, 384),
						cc.p(517, 385),
						cc.p(497, 390),
						cc.p(469, 387),
						cc.p(433, 387),
						cc.p(382, 389),
						cc.p(357, 389),
						cc.p(324, 387),
						cc.p(299, 391),
						cc.p(286, 391),
						cc.p(267, 389),
						cc.p(239, 389),
						cc.p(211, 389),
						cc.p(183, 390),
						cc.p(165, 390),
						cc.p(163, 365),
						cc.p(181, 365),
						cc.p(200, 360),
						cc.p(222, 357),
						cc.p(256, 357),
						cc.p(283, 350),
						cc.p(307, 350),
						cc.p(352, 350),
						cc.p(406, 354),
						cc.p(440, 354),
						cc.p(488, 350),
						cc.p(545, 350),
						cc.p(573, 350),
						cc.p(580, 316),
						cc.p(566, 314),
						cc.p(548, 309),
						cc.p(522, 303),
						cc.p(494, 306),
						cc.p(469, 308),
						cc.p(440, 308),
						cc.p(383, 312),
						cc.p(352, 314),
						cc.p(305, 319),
						cc.p(264, 320),
						cc.p(241, 320),
						cc.p(215, 321),
						cc.p(168, 322),
						cc.p(156, 319),
						cc.p(157, 288),
						cc.p(181, 282),
						cc.p(202, 282),
						cc.p(236, 279),
						cc.p(265, 275),
						cc.p(297, 275),
						cc.p(350, 272),
						cc.p(391, 272),
						cc.p(442, 272),
						cc.p(477, 273),
						cc.p(511, 275),
						cc.p(549, 276),
						cc.p(572, 277),
						cc.p(586, 279),
						cc.p(593, 247),
						cc.p(569, 245),
						cc.p(548, 245),
						cc.p(529, 244),
						cc.p(510, 244),
						cc.p(491, 245),
						cc.p(466, 242),
						cc.p(411, 240),
						cc.p(354, 234),
						cc.p(324, 242),
						cc.p(292, 246),
						cc.p(263, 246),
						cc.p(239, 247),
						cc.p(187, 250),
						cc.p(169, 252),
						cc.p(156, 253),
						cc.p(162, 218),
						cc.p(181, 216),
						cc.p(206, 214),
						cc.p(231, 214),
						cc.p(256, 214),
						cc.p(280, 217),
						cc.p(326, 214),
						cc.p(348, 214),
						cc.p(424, 214),
						cc.p(467, 217),
						cc.p(499, 217),
						cc.p(518, 219),
						cc.p(536, 220),
						cc.p(564, 220),
						cc.p(586, 220),
						cc.p(595, 194),
						cc.p(575, 191),
						cc.p(528, 190),
						cc.p(486, 190),
						cc.p(457, 191),
						cc.p(430, 191),
						cc.p(394, 192),
						cc.p(360, 192),
						cc.p(326, 195),
						cc.p(269, 201),
						cc.p(235, 207),
						cc.p(217, 208),
						cc.p(175, 209),
						cc.p(155, 209),
						cc.p(156, 171),
						cc.p(178, 171),
						cc.p(217, 170),
						cc.p(262, 170),
						cc.p(305, 168),
						cc.p(354, 161),
						cc.p(394, 160),
						cc.p(421, 159),
						cc.p(477, 155),
						cc.p(515, 155),
						cc.p(534, 159),
						cc.p(557, 161),
						cc.p(581, 162),
						cc.p(589, 135),
						cc.p(577, 130),
						cc.p(565, 127),
						cc.p(551, 128),
						cc.p(527, 130),
						cc.p(503, 129),
						cc.p(427, 130),
						cc.p(380, 133),
						cc.p(326, 134),
						cc.p(297, 136),
						cc.p(254, 136),
						cc.p(215, 135),
						cc.p(198, 135),
						cc.p(171, 136),
						cc.p(159, 140),
						cc.p(159, 112),
						cc.p(193, 112),
						cc.p(222, 112),
						cc.p(259, 108),
						cc.p(284, 108),
						cc.p(298, 108),
						cc.p(339, 109),
						cc.p(371, 109),
						cc.p(415, 108),
						cc.p(442, 108),
						cc.p(486, 109),
						cc.p(535, 110),
						cc.p(568, 111),
						cc.p(588, 111),
						cc.p(590, 88),
						cc.p(574, 84),
						cc.p(557, 84),
						cc.p(536, 83),
						cc.p(507, 83),
						cc.p(472, 86),
						cc.p(444, 85),
						cc.p(411, 86),
						cc.p(381, 83),
						cc.p(352, 83),
						cc.p(331, 85),
						cc.p(286, 85),
						cc.p(262, 84),
						cc.p(247, 83),
						cc.p(221, 86),
						cc.p(197, 85),
						cc.p(175, 86),
						cc.p(151, 89),
				  ])
				: 3 == this.current_part && 2 == this.current_sub_part
				? (this.dummyPoints = [
						cc.p(317, 110),
						cc.p(324, 113),
						cc.p(342, 118),
						cc.p(351, 116),
						cc.p(368, 111),
						cc.p(399, 103),
						cc.p(413, 105),
						cc.p(430, 105),
						cc.p(431, 98),
						cc.p(412, 97),
						cc.p(395, 99),
						cc.p(481, 102),
						cc.p(495, 104),
						cc.p(511, 106),
						cc.p(495, 111),
						cc.p(491, 116),
						cc.p(486, 130),
						cc.p(486, 137),
						cc.p(494, 142),
						cc.p(500, 143),
						cc.p(505, 149),
						cc.p(472, 137),
						cc.p(470, 146),
						cc.p(481, 151),
						cc.p(488, 154),
						cc.p(470, 157),
						cc.p(460, 150),
						cc.p(464, 160),
						cc.p(459, 163),
						cc.p(457, 151),
						cc.p(442, 125),
						cc.p(426, 125),
						cc.p(415, 125),
						cc.p(393, 128),
						cc.p(385, 127),
						cc.p(378, 126),
						cc.p(369, 126),
						cc.p(358, 128),
						cc.p(351, 128),
						cc.p(341, 130),
						cc.p(334, 130),
						cc.p(315, 131),
						cc.p(308, 131),
						cc.p(287, 140),
						cc.p(298, 142),
						cc.p(311, 142),
						cc.p(325, 142),
						cc.p(335, 142),
						cc.p(334, 155),
						cc.p(328, 153),
						cc.p(323, 155),
						cc.p(292, 152),
						cc.p(293, 162),
						cc.p(297, 168),
						cc.p(294, 174),
						cc.p(291, 179),
						cc.p(300, 176),
						cc.p(309, 176),
						cc.p(316, 176),
						cc.p(312, 169),
						cc.p(305, 176),
						cc.p(298, 190),
						cc.p(304, 198),
						cc.p(305, 208),
						cc.p(309, 196),
						cc.p(316, 191),
						cc.p(308, 185),
						cc.p(305, 194),
						cc.p(290, 179),
						cc.p(351, 166),
						cc.p(366, 159),
						cc.p(378, 174),
						cc.p(376, 168),
						cc.p(384, 163),
						cc.p(360, 150),
						cc.p(352, 153),
						cc.p(338, 154),
						cc.p(337, 142),
						cc.p(379, 125),
						cc.p(420, 127),
						cc.p(429, 142),
						cc.p(417, 141),
						cc.p(441, 147),
						cc.p(448, 151),
						cc.p(460, 151),
						cc.p(471, 153),
						cc.p(486, 154),
						cc.p(472, 157),
						cc.p(454, 157),
						cc.p(440, 162),
						cc.p(452, 167),
						cc.p(436, 170),
						cc.p(422, 176),
						cc.p(409, 178),
						cc.p(397, 186),
						cc.p(409, 186),
						cc.p(422, 185),
						cc.p(437, 183),
						cc.p(451, 183),
						cc.p(469, 179),
						cc.p(466, 188),
						cc.p(452, 192),
						cc.p(444, 194),
						cc.p(428, 202),
						cc.p(414, 205),
						cc.p(412, 211),
						cc.p(429, 212),
						cc.p(439, 211),
						cc.p(460, 205),
						cc.p(479, 193),
						cc.p(493, 185),
						cc.p(503, 185),
						cc.p(503, 191),
						cc.p(492, 194),
						cc.p(482, 200),
						cc.p(471, 210),
						cc.p(506, 199),
						cc.p(508, 202),
						cc.p(498, 209),
						cc.p(493, 218),
						cc.p(486, 231),
						cc.p(485, 218),
						cc.p(474, 211),
						cc.p(458, 215),
						cc.p(458, 216),
						cc.p(449, 219),
						cc.p(443, 219),
						cc.p(435, 223),
						cc.p(434, 234),
						cc.p(444, 238),
						cc.p(453, 237),
						cc.p(460, 238),
						cc.p(467, 240),
						cc.p(472, 241),
						cc.p(474, 253),
						cc.p(465, 247),
						cc.p(455, 247),
						cc.p(446, 247),
						cc.p(440, 247),
						cc.p(433, 246),
						cc.p(426, 254),
						cc.p(435, 253),
						cc.p(446, 254),
						cc.p(458, 256),
						cc.p(466, 257),
						cc.p(455, 258),
						cc.p(445, 261),
						cc.p(435, 261),
						cc.p(427, 261),
						cc.p(417, 262),
						cc.p(410, 261),
						cc.p(413, 254),
						cc.p(409, 252),
						cc.p(400, 255),
						cc.p(443, 262),
						cc.p(442, 268),
						cc.p(444, 270),
						cc.p(452, 265),
						cc.p(448, 262),
						cc.p(352, 256),
						cc.p(360, 257),
						cc.p(369, 259),
						cc.p(382, 260),
						cc.p(388, 262),
						cc.p(370, 254),
						cc.p(366, 264),
						cc.p(371, 266),
						cc.p(378, 266),
						cc.p(383, 266),
						cc.p(368, 276),
						cc.p(377, 276),
						cc.p(385, 276),
						cc.p(391, 276),
						cc.p(401, 286),
						cc.p(396, 286),
						cc.p(387, 285),
						cc.p(380, 284),
						cc.p(372, 284),
						cc.p(360, 283),
						cc.p(353, 283),
						cc.p(358, 279),
						cc.p(367, 278),
						cc.p(378, 280),
						cc.p(384, 280),
						cc.p(388, 287),
						cc.p(391, 291),
						cc.p(396, 291),
						cc.p(400, 288),
						cc.p(400, 284),
						cc.p(380, 292),
						cc.p(374, 292),
						cc.p(367, 292),
						cc.p(357, 292),
						cc.p(352, 293),
						cc.p(339, 297),
						cc.p(348, 297),
						cc.p(357, 297),
						cc.p(369, 299),
						cc.p(377, 301),
						cc.p(374, 307),
						cc.p(370, 305),
						cc.p(378, 308),
						cc.p(385, 310),
						cc.p(388, 318),
						cc.p(396, 314),
						cc.p(400, 311),
						cc.p(391, 321),
						cc.p(392, 326),
						cc.p(396, 332),
						cc.p(400, 332),
						cc.p(389, 334),
						cc.p(383, 329),
						cc.p(382, 327),
						cc.p(374, 329),
						cc.p(366, 331),
						cc.p(366, 323),
						cc.p(370, 311),
						cc.p(368, 305),
						cc.p(354, 298),
						cc.p(348, 293),
						cc.p(345, 296),
						cc.p(340, 297),
						cc.p(332, 301),
						cc.p(327, 305),
						cc.p(318, 311),
						cc.p(312, 311),
						cc.p(320, 311),
						cc.p(331, 312),
						cc.p(321, 314),
						cc.p(313, 314),
						cc.p(303, 317),
						cc.p(309, 322),
						cc.p(318, 322),
						cc.p(323, 322),
						cc.p(333, 322),
						cc.p(341, 322),
						cc.p(348, 322),
						cc.p(357, 322),
						cc.p(364, 323),
						cc.p(370, 323),
						cc.p(375, 330),
						cc.p(367, 333),
						cc.p(361, 332),
						cc.p(352, 331),
						cc.p(347, 331),
						cc.p(334, 331),
						cc.p(342, 333),
						cc.p(347, 335),
						cc.p(355, 336),
						cc.p(361, 336),
						cc.p(366, 335),
						cc.p(321, 328),
						cc.p(315, 327),
						cc.p(306, 331),
						cc.p(294, 311),
						cc.p(300, 301),
						cc.p(305, 296),
						cc.p(302, 288),
						cc.p(298, 293),
						cc.p(303, 288),
				  ])
				: 3 == this.current_part &&
				  3 == this.current_sub_part &&
				  (this.dummyPoints = [
						cc.p(225, 338),
						cc.p(229, 338),
						cc.p(236, 335),
						cc.p(240, 334),
						cc.p(246, 331),
						cc.p(252, 329),
						cc.p(258, 326),
						cc.p(262, 325),
						cc.p(263, 322),
						cc.p(266, 318),
						cc.p(268, 313),
						cc.p(269, 307),
						cc.p(273, 303),
						cc.p(274, 297),
						cc.p(276, 293),
						cc.p(279, 288),
						cc.p(280, 284),
						cc.p(280, 277),
						cc.p(280, 270),
						cc.p(277, 262),
						cc.p(274, 259),
						cc.p(274, 250),
						cc.p(272, 241),
						cc.p(271, 237),
						cc.p(275, 229),
						cc.p(278, 226),
						cc.p(279, 220),
						cc.p(281, 218),
						cc.p(285, 211),
						cc.p(288, 203),
						cc.p(286, 197),
						cc.p(284, 194),
						cc.p(282, 191),
						cc.p(280, 187),
						cc.p(278, 183),
						cc.p(275, 177),
						cc.p(272, 172),
						cc.p(270, 168),
						cc.p(270, 164),
						cc.p(268, 161),
						cc.p(262, 159),
						cc.p(254, 157),
						cc.p(250, 155),
						cc.p(245, 151),
						cc.p(240, 151),
						cc.p(237, 148),
						cc.p(230, 145),
						cc.p(226, 142),
						cc.p(323, 74),
						cc.p(324, 79),
						cc.p(324, 87),
						cc.p(325, 93),
						cc.p(325, 100),
						cc.p(326, 108),
						cc.p(326, 116),
						cc.p(328, 127),
						cc.p(329, 136),
						cc.p(330, 142),
						cc.p(331, 147),
						cc.p(336, 147),
						cc.p(340, 147),
						cc.p(345, 147),
						cc.p(351, 148),
						cc.p(357, 148),
						cc.p(358, 148),
						cc.p(366, 148),
						cc.p(373, 148),
						cc.p(376, 150),
						cc.p(382, 151),
						cc.p(386, 153),
						cc.p(391, 157),
						cc.p(398, 160),
						cc.p(402, 162),
						cc.p(407, 162),
						cc.p(413, 159),
						cc.p(419, 156),
						cc.p(423, 153),
						cc.p(430, 151),
						cc.p(433, 146),
						cc.p(437, 142),
						cc.p(444, 140),
						cc.p(450, 137),
						cc.p(455, 133),
						cc.p(463, 133),
						cc.p(469, 131),
						cc.p(478, 128),
						cc.p(486, 128),
						cc.p(492, 131),
						cc.p(496, 135),
						cc.p(502, 141),
						cc.p(505, 144),
						cc.p(509, 144),
						cc.p(512, 142),
						cc.p(517, 140),
						cc.p(521, 139),
						cc.p(528, 136),
						cc.p(531, 135),
						cc.p(539, 247),
						cc.p(535, 251),
						cc.p(532, 254),
						cc.p(527, 255),
						cc.p(523, 259),
						cc.p(519, 263),
						cc.p(512, 267),
						cc.p(502, 272),
						cc.p(495, 272),
						cc.p(487, 273),
						cc.p(476, 273),
						cc.p(469, 274),
						cc.p(466, 274),
						cc.p(461, 278),
						cc.p(454, 283),
						cc.p(449, 287),
						cc.p(443, 290),
						cc.p(436, 294),
						cc.p(431, 300),
						cc.p(426, 304),
						cc.p(418, 308),
						cc.p(411, 314),
						cc.p(406, 319),
						cc.p(399, 323),
						cc.p(395, 329),
						cc.p(395, 335),
						cc.p(394, 342),
						cc.p(391, 350),
						cc.p(388, 361),
						cc.p(387, 369),
						cc.p(384, 375),
						cc.p(382, 383),
						cc.p(381, 391),
						cc.p(380, 399),
						cc.p(378, 403),
						cc.p(376, 409),
				  ]);
	},
	changeZorder: function (e, t, c) {
		e.setLocalZOrder(t);
	},
	changeTag: function (e, t) {
		e.setTag(t);
	},
	changeTexture: function (e, t) {
		e.setTexture(t);
	},
	buttonClickAction1: function (e) {
		var t = e.getScale();
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, t + 0.1),
				cc.ScaleTo.create(0.2, t)
			)
		);
	},
	buttonClickAction: function (e) {
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, 1.1),
				cc.ScaleTo.create(0.2, 1)
			)
		);
	},
	buttonSelectedAction: function (e) {
		e.runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.ScaleTo.create(0.5, 1.1),
					cc.ScaleTo.create(0.5, 1)
				)
			)
		);
	},
	onDoneClick: function (e) {
		0 != this.isTouchOn &&
			(this.hideDone(),
			this.setTouchOff(2.5),
			this.scheduleOnce(
				function () {
					this.onNextScene();
				},
				1,
				'onNextScene'
			));
	},
	onNextClick: function (e) {
		0 == this.isTouchOn ||
			0 < e.getNumberOfRunningActions() ||
			(comman.stopAllEffect(),
			comman.showInterstitial(),
			(this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackIn.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								comman.winSize().width +
									1.5 * this.btn_next.getContentSize().width,
								this.btn_next.getPositionY()
							)
						)
					)
				)
			),
			1 == this.current_part && 1 == this.current_sub_part
				? ((this.current_sub_sub_part = 1), (this.current_sub_part = 3))
				: 2 == this.current_part && 4 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 2),
				  (this.current_part = 1))
				: 3 == this.current_part && 4 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 1),
				  (this.current_part = 4))
				: 4 == this.current_part && 4 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 3),
				  (this.current_part = 1))
				: ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 1),
				  this.current_part++),
			this.startNextPart());
	},
	checkIsLevelDone: function () {
		this.isDoneShow;
	},
	update: function (e) {},
	onNextScene1: function (e) {
		(this.isNextShow = !1),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							0.55 * this.btn_next.getContentSize().height
						)
					)
				)
			),
			comman.stopAllEffect(),
			comman.showInterstitial(),
			cc.director.runScene(ChooseScene.scene());
	},
	onNextScene: function (e) {
		comman.stopAllEffect(),
			comman.showInterstitial(),
			selectedLevels++,
			cc.director.runScene(ChooseScene.scene());
	},
	setTouchOff: function (e) {
		(this.isTouchOn = !1),
			this.unschedule(this.setTouchEnable),
			this.scheduleOnce(this.setTouchEnable, e);
	},
	setTouchEnable: function () {
		this.isTouchOn = !0;
	},
	checkFullTouchObject: function (e, t) {
		return (
			!eventInTransparentMask(e, e.getParent().convertToWorldSpace(t)) &&
			1 == this.checkTouchObject(e, t)
		);
	},
	checkFullTouchObject1: function (e, t) {
		return (
			!eventInTransparentMask1(e, t) && 1 == this.checkTouchObject(e, t)
		);
	},
	checkTouchObject: function (e, t) {
		return cc.rectContainsPoint(
			e.getBoundingBox(),
			e.getParent().convertToNodeSpace(t)
		);
	},
	onTouchBegan: function (e, t) {
		var c = e.getLocation(),
			a = t.getCurrentTarget();
		a.startPos = c;
		a.startLocation = c;
		if (0 != a.isTouchOn) {
			if (2 == a.current_part) {
				if (1 == a.current_sub_part) {
					for (var o = 1; o <= 3; o++)
						if (
							a.checkFullTouchObject(a.pa2_WallCrack[o], c) &&
							0 ==
								a.pa2_WallCrack[
									o
								].getNumberOfRunningActions() &&
							1 == a.pa2_WallCrack[o].getTag()
						) {
							a.hideHint(),
								a.pa2_WallCrack[o].runAction(
									cc.Sequence.create(
										cc.Animate.create(
											a.pa2_WallCrack_anim[o].clone()
										),
										cc.DelayTime.create(0.1),
										cc.Hide.create()
									)
								),
								a.pa2_WallCrack[o].setTag(2),
								2 == a.pa2_WallCrack[1].getTag() &&
									2 == a.pa2_WallCrack[2].getTag() &&
									2 == a.pa2_WallCrack[3].getTag() &&
									(a.setTouchOff(0.7),
									a.current_sub_part++,
									a.unschedule(a.startNextPart),
									a.scheduleOnce(a.startNextPart, 0.6));
							break;
						}
				} else if (2 == a.current_sub_part)
					a.checkTouchObject(a.pa2_Scrap_Tool, c) &&
						0 == a.pa2_Scrap_Tool.getNumberOfRunningActions() &&
						1 == a.pa2_Scrap_Tool.getTag() &&
						(a.hideHint(),
						(a.move_tool = a.pa2_Scrap_Tool),
						(a.move_tool_pos = a.pa2_Scrap_Tool.getPosition()),
						(a.move_tool_rot = a.pa2_Scrap_Tool.getRotation()),
						(a.move_tool_scale = a.pa2_Scrap_Tool.getScale()),
						(a.move_tool_zorder =
							a.pa2_Scrap_Tool.getLocalZOrder()),
						(a.move_tool_no = 1),
						a.move_tool.setLocalZOrder(10),
						a.dummyBrush.setScale(1.4, 2.5),
						(a.dummyMoveDist = cc.p(-35, 20)));
				else if (3 == a.current_sub_part)
					a.checkTouchObject(a.pa2_Roller, c) &&
						0 == a.pa2_Roller.getNumberOfRunningActions() &&
						1 == a.pa2_Roller.getTag() &&
						(a.hideHint(),
						(a.move_tool = a.pa2_Roller),
						(a.move_tool_pos = a.pa2_Roller.getPosition()),
						(a.move_tool_rot = a.pa2_Roller.getRotation()),
						(a.move_tool_scale = a.pa2_Roller.getScale()),
						(a.move_tool_zorder = a.pa2_Roller.getLocalZOrder()),
						(a.move_tool_no = 1),
						a.move_tool.setLocalZOrder(10),
						a.pa2_Roller.runAction(
							cc.RepeatForever.create(
								cc.Animate.create(a.pa2_Roller_anim.clone())
							)
						),
						a.dummyBrush.setRotation(30),
						a.dummyBrush.setScale(1.4, 2.5),
						(a.dummyMoveDist = cc.p(-50, 12)));
				else if (4 == a.current_sub_part)
					for (o = 1; o <= 3; o++)
						if (
							a.checkTouchObject(a.pa2_Wall_Th[o], c) &&
							0 == a.pa2_Wall_Th[o].getNumberOfRunningActions() &&
							1 == a.pa2_Wall_Th[o].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa2_Wall_Th[o]),
								(a.move_tool_pos =
									a.pa2_Wall_Th[o].getPosition()),
								(a.move_tool_rot =
									a.pa2_Wall_Th[o].getRotation()),
								(a.move_tool_scale =
									a.pa2_Wall_Th[o].getScale()),
								(a.move_tool_zorder =
									a.pa2_Wall_Th[o].getLocalZOrder()),
								(a.move_tool_no = o),
								a.move_tool.setLocalZOrder(10),
								a.pa2_Wall_Th[o].setTexture(
									'RES/PA/4/pa2_WallPart_move_' +
										a.move_tool_no +
										'.png'
								),
								a.dummyBrush.setRotation(0),
								a.dummyBrush.setScale(0, 0),
								(a.dummyMoveDist = cc.p(0, 0));
							for (var n = 1; n <= 3; n++)
								1 == a.pa2_WallPart_Hint[n].getTag() &&
									a.pa2_WallPart_Hint[n].setVisible(!0);
							break;
						}
			} else if (3 == a.current_part)
				if (1 == a.current_sub_part) {
					for (o = 1; o <= 3; o++)
						if (
							a.checkTouchObject(a.pa3_Part_Th[o], c) &&
							0 == a.pa3_Part_Th[o].getNumberOfRunningActions() &&
							1 == a.pa3_Part_Th[o].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa3_Part_Th[o]),
								(a.move_tool_pos =
									a.pa3_Part_Th[o].getPosition()),
								(a.move_tool_rot =
									a.pa3_Part_Th[o].getRotation()),
								(a.move_tool_scale =
									a.pa3_Part_Th[o].getScale()),
								(a.move_tool_zorder =
									a.pa3_Part_Th[o].getLocalZOrder()),
								(a.move_tool_no = o),
								a.move_tool.setLocalZOrder(10),
								a.move_tool.setScale(1),
								a.dummyBrush.setRotation(0),
								a.dummyBrush.setScale(0, 0),
								(a.dummyMoveDist = cc.p(0, 0)),
								a.pa3_Part_Hint.setTexture(
									'RES/PA/4/pa3_Part_Hint_' +
										a.move_tool_no +
										'.png'
								),
								a.pa3_Part_Hint.setVisible(!0);
							break;
						}
				} else
					2 == a.current_sub_part
						? a.checkTouchObject(a.pa3_Brush, c) &&
						  0 == a.pa3_Brush.getNumberOfRunningActions() &&
						  1 == a.pa3_Brush.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa3_Brush),
						  (a.move_tool_pos = a.pa3_Brush.getPosition()),
						  (a.move_tool_rot = a.pa3_Brush.getRotation()),
						  (a.move_tool_scale = a.pa3_Brush.getScale()),
						  (a.move_tool_zorder = a.pa3_Brush.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setRotation(12),
						  a.dummyBrush.setScale(1.8, 0.6),
						  (a.dummyMoveDist = cc.p(-28, -65)))
						: 3 == a.current_sub_part &&
						  a.checkTouchObject(a.pa3_Glue_Bottle, c) &&
						  0 == a.pa3_Glue_Bottle.getNumberOfRunningActions() &&
						  1 == a.pa3_Glue_Bottle.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa3_Glue_Bottle),
						  (a.move_tool_pos = a.pa3_Glue_Bottle.getPosition()),
						  (a.move_tool_rot = a.pa3_Glue_Bottle.getRotation()),
						  (a.move_tool_scale = a.pa3_Glue_Bottle.getScale()),
						  (a.move_tool_zorder =
								a.pa3_Glue_Bottle.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.move_tool.setRotation(-140),
						  a.dummyBrush.setScale(0.5, 0.5),
						  (a.dummyMoveDist = cc.p(-50, -70)));
			else
				4 == a.current_part &&
					(1 == a.current_sub_part
						? a.checkTouchObject(a.pa4_Screw_Driver, c) &&
						  0 == a.pa4_Screw_Driver.getNumberOfRunningActions() &&
						  1 == a.pa4_Screw_Driver.getTag() &&
						  (a.hideHint(),
						  a.pa4_Screw_Driver.runAction(
								cc.Sequence.create(
									cc.Animate.create(
										a.pa4_Screw_Driver_anim.clone()
									),
									cc.Animate.create(
										a.pa4_Screw_Driver_anim.clone()
									).reverse(),
									cc.MoveBy.create(0.2, cc.p(-800, 0))
								)
						  ),
						  a.pa4_Hole1.runAction(cc.ScaleTo.create(0.8, 1)),
						  a.setTouchOff(2),
						  a.current_sub_part++,
						  a.unschedule(a.startNextPart),
						  a.scheduleOnce(a.startNextPart, 1.9))
						: 2 == a.current_sub_part
						? a.checkTouchObject(a.pa4_Screw, c) &&
						  0 == a.pa4_Screw.getNumberOfRunningActions() &&
						  1 == a.pa4_Screw.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa4_Screw),
						  (a.move_tool_pos = a.pa4_Screw.getPosition()),
						  (a.move_tool_rot = a.pa4_Screw.getRotation()),
						  (a.move_tool_scale = a.pa4_Screw.getScale()),
						  (a.move_tool_zorder = a.pa4_Screw.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setRotation(0),
						  a.dummyBrush.setScale(0, 0),
						  (a.dummyMoveDist = cc.p(0, 0)))
						: 3 == a.current_sub_part
						? a.checkTouchObject(a.pa4_Panu, c) &&
						  0 == a.pa4_Panu.getNumberOfRunningActions() &&
						  1 == a.pa4_Panu.getTag() &&
						  (a.hideHint(),
						  a.pa4_Screw.runAction(
								cc.Sequence.create(
									cc.Animate.create(a.pa4_Screw_anim.clone())
								)
						  ),
						  a.pa4_Panu.runAction(
								cc.Sequence.create(
									cc.Spawn.create(
										cc.MoveTo.create(0.3, a.pa4_Panu_pos1),
										cc.RotateTo.create(0.3, 180)
									),
									cc.MoveBy.create(0.3, cc.p(-800, 0))
								)
						  ),
						  a.setTouchOff(0.8),
						  a.current_sub_part++,
						  a.unschedule(a.startNextPart),
						  a.scheduleOnce(a.startNextPart, 0.7))
						: 4 == a.current_sub_part &&
						  a.checkTouchObject(a.pa4_Frame_Done_Move, c) &&
						  0 ==
								a.pa4_Frame_Done_Move.getNumberOfRunningActions() &&
						  1 == a.pa4_Frame_Done_Move.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa4_Frame_Done_Move),
						  (a.move_tool_pos =
								a.pa4_Frame_Done_Move.getPosition()),
						  (a.move_tool_rot =
								a.pa4_Frame_Done_Move.getRotation()),
						  (a.move_tool_scale =
								a.pa4_Frame_Done_Move.getScale()),
						  (a.move_tool_zorder =
								a.pa4_Frame_Done_Move.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setRotation(0),
						  a.dummyBrush.setScale(0, 0),
						  (a.dummyMoveDist = cc.p(0, 0))));
			return !0;
		}
	},
	onTouchMoved: function (e, t) {
		var e = e.getLocation(),
			c = t.getCurrentTarget();
		c.endPos = e;
		c.endLocation = e;
		if (0 != c.isTouchOn && null != c.move_tool) {
			(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y)),
				(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y));
			if (
				(c.move_tool.setPosition(
					c.move_tool.getParent().convertToNodeSpace(e)
				),
				c.dummyBrush.setPosition(t),
				2 == c.current_part)
			) {
				if (2 == c.current_sub_part) {
					t = 1;
					c.checkTouchObject(
						c.dummyBrush,
						c.pa2_WallCrackPart_pos[t]
					) &&
						c.pa2_WallCrackPart[t].getTag() <= 3 &&
						0 ==
							c.pa2_WallCrackPart[
								t
							].getNumberOfRunningActions() &&
						0 == c.move_tool.getNumberOfRunningActions() &&
						1 == c.move_tool.getTag() &&
						(c.hideHint(),
						c.pa2_WallCrackPart[t].setTag(
							c.pa2_WallCrackPart[t].getTag() + 1
						),
						c.pa2_WallCrackPart[t].runAction(
							cc.DelayTime.create(0.1)
						),
						c.pa2_WallCrackPart[t].getTag() <= 3
							? c.pa2_WallCrackPart[t].setTexture(
									'RES/PA/4/pa2_WallCrackPart_' +
										t +
										'_' +
										c.pa2_WallCrackPart[t].getTag() +
										'.png'
							  )
							: c.pa2_WallCrackPart[t].runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.1, cc.p(0, -500)),
										cc.ScaleTo.create(0, 0)
									)
							  ),
						4 == c.pa2_WallCrackPart[1].getTag() &&
							4 == c.pa2_WallCrackPart[2].getTag() &&
							4 == c.pa2_WallCrackPart[3].getTag() &&
							4 == c.pa2_WallCrackPart[4].getTag() &&
							4 == c.pa2_WallCrackPart[5].getTag() &&
							(c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveBy.create(0.2, cc.p(1200, 0))
								)
							),
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.hideHint(),
							c.setTouchOff(0.3),
							c.current_sub_part++,
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2))),
						(t = 2),
						c.checkTouchObject(
							c.dummyBrush,
							c.pa2_WallCrackPart_pos[t]
						) &&
							c.pa2_WallCrackPart[t].getTag() <= 3 &&
							0 ==
								c.pa2_WallCrackPart[
									t
								].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_WallCrackPart[t].setTag(
								c.pa2_WallCrackPart[t].getTag() + 1
							),
							c.pa2_WallCrackPart[t].runAction(
								cc.DelayTime.create(0.1)
							),
							c.pa2_WallCrackPart[t].getTag() <= 3
								? c.pa2_WallCrackPart[t].setTexture(
										'RES/PA/4/pa2_WallCrackPart_' +
											t +
											'_' +
											c.pa2_WallCrackPart[t].getTag() +
											'.png'
								  )
								: c.pa2_WallCrackPart[t].runAction(
										cc.Sequence.create(
											cc.MoveBy.create(
												0.1,
												cc.p(0, -500)
											),
											cc.ScaleTo.create(0, 0)
										)
								  ),
							4 == c.pa2_WallCrackPart[1].getTag() &&
								4 == c.pa2_WallCrackPart[2].getTag() &&
								4 == c.pa2_WallCrackPart[3].getTag() &&
								4 == c.pa2_WallCrackPart[4].getTag() &&
								4 == c.pa2_WallCrackPart[5].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(t = 3),
						c.checkTouchObject(
							c.dummyBrush,
							c.pa2_WallCrackPart_pos[t]
						) &&
							c.pa2_WallCrackPart[t].getTag() <= 3 &&
							0 ==
								c.pa2_WallCrackPart[
									t
								].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_WallCrackPart[t].setTag(
								c.pa2_WallCrackPart[t].getTag() + 1
							),
							c.pa2_WallCrackPart[t].runAction(
								cc.DelayTime.create(0.1)
							),
							c.pa2_WallCrackPart[t].getTag() <= 3
								? c.pa2_WallCrackPart[t].setTexture(
										'RES/PA/4/pa2_WallCrackPart_' +
											t +
											'_' +
											c.pa2_WallCrackPart[t].getTag() +
											'.png'
								  )
								: c.pa2_WallCrackPart[t].runAction(
										cc.Sequence.create(
											cc.MoveBy.create(
												0.1,
												cc.p(0, -500)
											),
											cc.ScaleTo.create(0, 0)
										)
								  ),
							4 == c.pa2_WallCrackPart[1].getTag() &&
								4 == c.pa2_WallCrackPart[2].getTag() &&
								4 == c.pa2_WallCrackPart[3].getTag() &&
								4 == c.pa2_WallCrackPart[4].getTag() &&
								4 == c.pa2_WallCrackPart[5].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(t = 4),
						c.checkTouchObject(
							c.dummyBrush,
							c.pa2_WallCrackPart_pos[t]
						) &&
							c.pa2_WallCrackPart[t].getTag() <= 3 &&
							0 ==
								c.pa2_WallCrackPart[
									t
								].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_WallCrackPart[t].setTag(
								c.pa2_WallCrackPart[t].getTag() + 1
							),
							c.pa2_WallCrackPart[t].runAction(
								cc.DelayTime.create(0.1)
							),
							c.pa2_WallCrackPart[t].getTag() <= 3
								? c.pa2_WallCrackPart[t].setTexture(
										'RES/PA/4/pa2_WallCrackPart_' +
											t +
											'_' +
											c.pa2_WallCrackPart[t].getTag() +
											'.png'
								  )
								: c.pa2_WallCrackPart[t].runAction(
										cc.Sequence.create(
											cc.MoveBy.create(
												0.1,
												cc.p(0, -500)
											),
											cc.ScaleTo.create(0, 0)
										)
								  ),
							4 == c.pa2_WallCrackPart[1].getTag() &&
								4 == c.pa2_WallCrackPart[2].getTag() &&
								4 == c.pa2_WallCrackPart[3].getTag() &&
								4 == c.pa2_WallCrackPart[4].getTag() &&
								4 == c.pa2_WallCrackPart[5].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(t = 5),
						c.checkTouchObject(
							c.dummyBrush,
							c.pa2_WallCrackPart_pos[t]
						) &&
							c.pa2_WallCrackPart[t].getTag() <= 3 &&
							0 ==
								c.pa2_WallCrackPart[
									t
								].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_WallCrackPart[t].setTag(
								c.pa2_WallCrackPart[t].getTag() + 1
							),
							c.pa2_WallCrackPart[t].runAction(
								cc.DelayTime.create(0.1)
							),
							c.pa2_WallCrackPart[t].getTag() <= 3
								? c.pa2_WallCrackPart[t].setTexture(
										'RES/PA/4/pa2_WallCrackPart_' +
											t +
											'_' +
											c.pa2_WallCrackPart[t].getTag() +
											'.png'
								  )
								: c.pa2_WallCrackPart[t].runAction(
										cc.Sequence.create(
											cc.MoveBy.create(
												0.1,
												cc.p(0, -500)
											),
											cc.ScaleTo.create(0, 0)
										)
								  ),
							4 == c.pa2_WallCrackPart[1].getTag() &&
								4 == c.pa2_WallCrackPart[2].getTag() &&
								4 == c.pa2_WallCrackPart[3].getTag() &&
								4 == c.pa2_WallCrackPart[4].getTag() &&
								4 == c.pa2_WallCrackPart[5].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2)));
				} else if (
					3 == c.current_sub_part &&
					0 < c.dummyPoints.length
				) {
					c.pa2_rt_up.begin(),
						c.dummyBrush.visit(),
						c.pa2_rt_up.end();
					for (var a = 0; a < c.dummyPoints.length; a++)
						c.checkTouchObject(c.dummyBrush, c.dummyPoints[a]) &&
							comman.arrayRemoveIndex(c.dummyPoints, a);
					0 == c.dummyPoints.length &&
						(c.pa2_rt_up.clear(),
						c.move_tool.setTag(2),
						c.move_tool.runAction(
							cc.Sequence.create(
								cc.MoveBy.create(0.2, cc.p(800, 0))
							)
						),
						(c.move_tool = null),
						(c.move_tool_no = 0),
						(c.move_tool_pos = cc.p(0, 0)),
						(c.move_tool_rot = 0),
						c.hideHint(),
						c.setTouchOff(0.3),
						c.current_sub_part++,
						c.unschedule(c.startNextPart),
						c.scheduleOnce(c.startNextPart, 0.2));
				}
			} else if (3 == c.current_part) {
				if (1 == c.current_sub_part)
					c.checkTouchObject(
						c.move_tool,
						c.pa3_Part_pos[c.move_tool_no]
					) &&
						0 == c.move_tool.getNumberOfRunningActions() &&
						1 == c.move_tool.getTag() &&
						(c.pa3_Part[c.move_tool_no].setTag(2),
						c.move_tool.setTag(2),
						c.move_tool.runAction(
							cc.Sequence.create(
								cc.MoveTo.create(
									0.1,
									c.pa3_Part_pos[c.move_tool_no]
								),
								cc.ScaleTo.create(0, 0)
							)
						),
						c.pa3_Part[c.move_tool_no].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.1),
								cc.Show.create()
							)
						),
						c.pa3_Part_Hint.setVisible(!1),
						(c.move_tool = null),
						(c.move_tool_no = 0),
						(c.move_tool_pos = cc.p(0, 0)),
						(c.move_tool_rot = 0),
						c.hideHint(),
						c.setTouchOff(0.1),
						2 == c.pa3_Part[1].getTag() &&
							2 == c.pa3_Part[2].getTag() &&
							2 == c.pa3_Part[3].getTag() &&
							(c.pa3_lyl_panel.runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.1),
									cc.MoveTo.create(0.2, cc.p(500, 0))
								)
							),
							c.setTouchOff(0.4),
							c.current_sub_part++,
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.3)));
				else if (2 == c.current_sub_part) {
					if (0 < c.dummyPoints.length) {
						c.pa3_rt_up.begin(),
							c.dummyBrush.visit(),
							c.pa3_rt_up.end();
						for (a = 0; a < c.dummyPoints.length; a++)
							c.checkTouchObject(
								c.dummyBrush,
								c.dummyPoints[a]
							) && comman.arrayRemoveIndex(c.dummyPoints, a);
						0 == c.dummyPoints.length &&
							(c.pa3_rt_up.clear(),
							c.move_tool.setTag(2),
							c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveBy.create(0.2, cc.p(800, 0))
								)
							),
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.hideHint(),
							c.setTouchOff(0.3),
							c.current_sub_part++,
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2));
					}
				} else if (
					3 == c.current_sub_part &&
					0 < c.dummyPoints.length
				) {
					c.pa3_rt_up.begin(),
						c.dummyBrush.visit(),
						c.pa3_rt_up.end();
					for (a = 0; a < c.dummyPoints.length; a++)
						c.checkTouchObject(c.dummyBrush, c.dummyPoints[a]) &&
							comman.arrayRemoveIndex(c.dummyPoints, a);
					0 == c.dummyPoints.length &&
						(c.pa3_rt_up.clear(),
						c.move_tool.setTag(2),
						c.move_tool.runAction(
							cc.Sequence.create(
								cc.MoveBy.create(0.2, cc.p(800, 0))
							)
						),
						(c.move_tool = null),
						(c.move_tool_no = 0),
						(c.move_tool_pos = cc.p(0, 0)),
						(c.move_tool_rot = 0),
						c.hideHint(),
						c.setTouchOff(0.3),
						c.current_sub_part++,
						c.unschedule(c.startNextPart),
						c.scheduleOnce(c.startNextPart, 0.2));
				}
			} else
				4 == c.current_part &&
					(2 == c.current_sub_part
						? c.checkTouchObject(c.move_tool, c.pa4_Screw_pos1) &&
						  0 == c.move_tool.getNumberOfRunningActions() &&
						  1 == c.move_tool.getTag() &&
						  (c.move_tool.setTag(2),
						  c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveTo.create(0.1, c.pa4_Screw_pos1)
								)
						  ),
						  (c.move_tool = null),
						  (c.move_tool_no = 0),
						  (c.move_tool_pos = cc.p(0, 0)),
						  (c.move_tool_rot = 0),
						  c.hideHint(),
						  c.setTouchOff(0.1),
						  c.setTouchOff(0.3),
						  c.current_sub_part++,
						  c.unschedule(c.startNextPart),
						  c.scheduleOnce(c.startNextPart, 0.2))
						: 4 == c.current_sub_part &&
						  c.checkTouchObject(
								c.move_tool,
								c.pa4_Frame_Done_Move_pos1
						  ) &&
						  0 == c.move_tool.getNumberOfRunningActions() &&
						  1 == c.move_tool.getTag() &&
						  (c.move_tool.setTag(2),
						  c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveTo.create(
										0.1,
										c.pa4_Frame_Done_Move_pos1
									),
									cc.callFunc(c.changeZorder, c.move_tool, 0)
								)
						  ),
						  c.pa4_Screw.runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.1),
									cc.callFunc(c.changeZorder, c.pa4_Screw, 1)
								)
						  ),
						  (c.move_tool = null),
						  (c.move_tool_no = 0),
						  (c.move_tool_pos = cc.p(0, 0)),
						  (c.move_tool_rot = 0),
						  c.hideHint(),
						  c.setTouchOff(0.1),
						  c.setTouchOff(0.3),
						  c.unschedule(c.showNext),
						  c.scheduleOnce(c.showNext, 0.2)));
		}
	},
	onTouchEnded: function (e, t) {
		var c = e.getLocation(),
			a = t.getCurrentTarget();
		if (0 != a.isTouchOn) {
			if (
				2 == a.current_part &&
				4 == a.current_sub_part &&
				null != a.move_tool
			)
				for (var o = 1; o <= 3; o++)
					if (
						1 == a.pa2_WallPart_Hint[o].getTag() &&
						a.checkTouchObject(a.pa2_WallPart_Hint[o], c)
					) {
						a.pa2_WallPart_Hint[o].setTag(2),
							a.pa2_WallPart_Hint[1].setVisible(!1),
							a.pa2_WallPart_Hint[2].setVisible(!1),
							a.pa2_WallPart_Hint[3].setVisible(!1),
							a.pa2_Wall_Th[a.move_tool_no].runAction(
								cc.Sequence.create(
									cc.MoveTo.create(
										0.1,
										a.pa2_WallPart_pos[o]
									),
									cc.Hide.create(),
									cc.callFunc(
										a.changeTexture,
										a.move_tool,
										'RES/PA/4/pa2_Wall_Th_' +
											a.move_tool_no +
											'.png'
									),
									cc.MoveTo.create(0, a.move_tool_pos),
									cc.Show.create()
								)
							),
							a.pa2_WallPart[o].setTexture(
								'RES/PA/4/pa2_WallPart_' +
									o +
									'_' +
									a.move_tool_no +
									'_1.png'
							);
						var n = cc.Animation.create();
						n.setDelayPerUnit(0.1),
							n.addSpriteFrameWithFile(
								'RES/PA/4/pa2_WallPart_' +
									o +
									'_' +
									a.move_tool_no +
									'_1.png'
							),
							n.addSpriteFrameWithFile(
								'RES/PA/4/pa2_WallPart_' +
									o +
									'_' +
									a.move_tool_no +
									'_2.png'
							),
							n.addSpriteFrameWithFile(
								'RES/PA/4/pa2_WallPart_' +
									o +
									'_' +
									a.move_tool_no +
									'_3.png'
							),
							n.addSpriteFrameWithFile(
								'RES/PA/4/pa2_WallPart_' +
									o +
									'_' +
									a.move_tool_no +
									'_4.png'
							),
							n.addSpriteFrameWithFile(
								'RES/PA/4/pa2_WallPart_' +
									o +
									'_' +
									a.move_tool_no +
									'_5.png'
							),
							a.pa2_WallPart[o].runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.1),
									cc.Show.create(),
									cc.Animate.create(n.clone())
								)
							),
							(a.move_tool = null),
							(a.move_tool_no = 0),
							(a.move_tool_pos = cc.p(0, 0)),
							(a.move_tool_rot = 0),
							a.hideHint(),
							a.setTouchOff(0.7),
							2 == a.pa2_WallPart_Hint[1].getTag() &&
								2 == a.pa2_WallPart_Hint[2].getTag() &&
								2 == a.pa2_WallPart_Hint[3].getTag() &&
								(a.pa2_lyl_panel.runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.3),
										cc.MoveTo.create(0.2, cc.p(500, 0))
									)
								),
								a.setTouchOff(0.8),
								a.unschedule(a.showNext),
								a.scheduleOnce(a.showNext, 0.7));
						break;
					}
			if (null != a.move_tool) {
				if (2 == a.current_part && 3 == a.current_sub_part)
					a.pa2_Roller.stopAllActions(),
						a.pa2_Roller.setTexture('RES/PA/4/pa2_Roller_1.png');
				else if (2 == a.current_part && 4 == a.current_sub_part) {
					a.pa2_Wall_Th[a.move_tool_no].setTexture(
						'RES/PA/4/pa2_Wall_Th_' + a.move_tool_no + '.png'
					);
					for (o = 1; o <= 3; o++)
						1 == a.pa2_WallPart_Hint[o].getTag() &&
							a.pa2_WallPart_Hint[o].setVisible(!0);
				} else
					3 == a.current_part &&
						1 == a.current_sub_part &&
						a.pa3_Part_Hint.setVisible(!1);
				a.move_tool.runAction(
					cc.Sequence.create(
						cc.Spawn.create(
							cc.MoveTo.create(0.2, a.move_tool_pos),
							cc.ScaleTo.create(0.2, a.move_tool_scale),
							cc.RotateTo.create(0.2, a.move_tool_rot)
						),
						cc.callFunc(
							a.changeZorder,
							a.move_tool,
							a.move_tool_zorder
						)
					)
				),
					a.move_tool.getParent().convertToNodeSpace(c),
					(a.move_tool = null),
					(a.move_tool_no = 0),
					(a.move_tool_pos = cc.p(0, 0)),
					(a.move_tool_rot = 0),
					a.hideHint(),
					a.setTouchOff(0.2);
			}
		}
	},
	onMouseMove: function (e) {
		var t = e.getLocation(),
			e = e.getCurrentTarget();
		cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) &&
		1 == e.btn_more.getScale() &&
		0 == e.btn_more.getNumberOfRunningActions() &&
		255 == e.btn_more.getOpacity()
			? (e.prt_Sparkle.setPosition(e.btn_more.getPosition()),
			  e.prt_Sparkle.resetSystem(),
			  e.btn_more.setScale(1.03))
			: 1.03 != e.btn_more.getScale() ||
			  cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) ||
			  0 != e.btn_more.getNumberOfRunningActions() ||
			  255 != e.btn_more.getOpacity()
			? cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) &&
			  1 == e.btn_done.getScale() &&
			  0 == e.btn_done.getNumberOfRunningActions() &&
			  255 == e.btn_done.getOpacity()
				? (e.prt_Sparkle.setPosition(e.btn_done.getPosition()),
				  e.prt_Sparkle.resetSystem(),
				  e.btn_done.setScale(1.03))
				: 1.03 != e.btn_done.getScale() ||
				  cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) ||
				  0 != e.btn_done.getNumberOfRunningActions() ||
				  255 != e.btn_done.getOpacity() ||
				  e.btn_done.setScale(1)
			: e.btn_more.setScale(1);
	},
	onMoreApp: function (e) {
		101 == e.getTag()
			? CreateLinksInGame(comman.GameId, 'game', 'more')
			: CreateLinksInGame(comman.GameId, 'game', 'logo');
	},
	onMusicButton: function (e) {
		0 == e.getNumberOfRunningActions() &&
			(e.stopAllActions(),
			e.runAction(
				cc.Sequence.create(
					cc.ScaleTo.create(0, 1),
					cc.ScaleTo.create(0.2, 0.9),
					cc.ScaleTo.create(0.2, 1)
				)
			),
			comman.isMusicEnable
				? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
				  comman.setSoundEnabled(!1))
				: comman.isMusicEnable ||
				  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
				  comman.setSoundEnabled(!0)));
	},
	createMainMenu: function () {
		(this.btn_bb_icon = cc.MenuItemImage.create(
			res_comman.bb_icon_3,
			res_comman.bb_icon_3,
			this.onMoreApp,
			this
		)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.5 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.5 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.MainMenu = cc.Menu.create(this.btn_bb_icon, this.btn_music)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 200);
	},
});
PlayScene_4.scene = function () {
	var e = new cc.Scene(),
		t = new PlayScene_4();
	return e.addChild(t), e;
};
var PlayScene_5 = cc.Scene.extend({
	ctor: function () {
		this._super(), this.init();
	},
	onEnter: function () {
		this._super(),
			cc.eventManager.addListener(
				{
					event: cc.EventListener.TOUCH_ONE_BY_ONE,
					swallowTouches: !0,
					onTouchBegan: this.onTouchBegan,
					onTouchMoved: this.onTouchMoved,
					onTouchEnded: this.onTouchEnded,
				},
				this
			),
			'mouse' in cc.sys.capabilities &&
				cc.eventManager.addListener(
					{
						event: cc.EventListener.MOUSE,
						onMouseMove: this.onMouseMove,
					},
					this
				);
	},
	init: function () {
		this._super(),
			(this.startPos = cc.p(0, 0)),
			(this.endPos = cc.p(0, 0)),
			(this.isDoneShow = !1),
			(this.isNextShow = !1),
			(this.lyl_puzzles = null),
			(this.move_tool = null),
			(this.move_tool_no = 0),
			(this.move_tool_rot = 0),
			(this.move_tool_s_pos = cc.p(1e4, 1e4)),
			(this.isTouchOn = !1),
			(this.current_part = 1),
			(this.current_sub_part = 1),
			(this.current_sub_sub_part = 1),
			(this.current_tool = 1),
			this.setTouchOff(0.1),
			(this.bg = cc.Sprite.create('RES/PA/5/Bg_1.png')),
			this.bg.setPosition(
				comman.winSize().width / 2,
				comman.winSize().height / 2
			),
			this.bg.setScale(1),
			this.addChild(this.bg),
			(this.dummyPoints = []),
			this.createPlayarea(),
			this.createPanels(),
			(this.btn_bb_icon = cc.MenuItemImage.create(
				res_comman.bb_icon_3,
				res_comman.bb_icon_3,
				this.onMoreApp,
				this
			)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_more = cc.MenuItemImage.create(
				res_common_button.btn_more,
				res_common_button.btn_more,
				this.onMoreApp,
				this
			)),
			this.btn_more.setScale(1),
			this.btn_more.setTag(101),
			this.btn_more.setPosition(
				cc.p(
					comman.winSize().width -
						1.6 * this.btn_more.getContentSize().width,
					comman.winSize().height +
						0.55 * this.btn_more.getContentSize().height
				)
			),
			this.btn_more.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							this.btn_more.getPositionX(),
							comman.winSize().height -
								0.55 * this.btn_more.getContentSize().height
						)
					)
				)
			),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.55 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.55 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.btn_done = cc.MenuItemImage.create(
				res_common_button.btn_done,
				res_common_button.btn_done,
				this.onDoneClick,
				this
			)),
			this.btn_done.setScale(1),
			this.btn_done.setTag(101),
			this.btn_done.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_done.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_done.getContentSize().height
				)
			),
			(this.btn_next = cc.MenuItemImage.create(
				res_common_button.btn_next,
				res_common_button.btn_next,
				this.onNextClick,
				this
			)),
			this.btn_next.setScale(1),
			this.btn_next.setTag(101),
			this.btn_next.setPosition(
				cc.p(
					comman.winSize().width +
						0.55 * this.btn_next.getContentSize().width,
					comman.winSize().height -
						1.6 * this.btn_next.getContentSize().height
				)
			),
			(this.MainMenu = cc.Menu.create(
				this.btn_bb_icon,
				this.btn_done,
				this.btn_more,
				this.btn_music,
				this.btn_next
			)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 100),
			(this.prt_Sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_1_plist
			)),
			this.prt_Sparkle.setScale(1.5),
			this.prt_Sparkle.stopSystem(),
			this.addChild(this.prt_Sparkle),
			this.prt_Sparkle.setLocalZOrder(500),
			(this.prt_tool_sparkle = cc.ParticleSystem.create(
				res_comman.sparkle_2_plist
			)),
			this.prt_tool_sparkle.setScale(1),
			this.prt_tool_sparkle.stopSystem(),
			this.addChild(this.prt_tool_sparkle),
			this.prt_tool_sparkle.setLocalZOrder(500),
			(this.CommonHandIndicator = cc.Sprite.create(
				res_common_button.arrow_ind_3_img
			)),
			this.CommonHandIndicator.setScale(0),
			this.CommonHandIndicator.setAnchorPoint(cc.p(0.55, 0.1)),
			this.addChild(this.CommonHandIndicator, 10),
			this.CommonHandIndicator.setPosition(cc.p(25e3, 25e3)),
			(this.CommonRoundIndicator = []);
		for (var e = 0; e < 15; e++)
			(this.CommonRoundIndicator[e] = cc.Sprite.create(
				res_common_button.indicator_img
			)),
				this.CommonRoundIndicator[e].setScale(0),
				this.CommonRoundIndicator[e].setAnchorPoint(cc.p(0.5, 0.5)),
				this.CommonRoundIndicator[e].setColor(cc.color(0, 255, 0)),
				this.addChild(this.CommonRoundIndicator[e], 10),
				this.CommonRoundIndicator[e].setPosition(cc.p(25e3, 25e3));
		this.CommonRoundIndicator1 = [];
		for (e = 0; e < 15; e++)
			(this.CommonRoundIndicator1[e] = cc.Sprite.create(
				res_common_button.arrow
			)),
				this.CommonRoundIndicator1[e].setScale(0),
				this.CommonRoundIndicator1[e].setAnchorPoint(cc.p(0.5, 0)),
				this.addChild(this.CommonRoundIndicator1[e], 10),
				this.CommonRoundIndicator1[e].setPosition(cc.p(25e3, 25e3));
		this.startNextPart();
	},
	RandomCommonHandInd: function () {
		var e, t, c, a;
		2 == this.current_part
			? 1 == this.current_sub_part
				? ((c = this.pa2_Dryer_pos),
				  (a = cc.p(598, 402)),
				  (e = cc.p(134, 405)),
				  (t = cc.p(421, 82)),
				  this.RandomCommonHandIndThreeWay1(c, a, e, t))
				: 2 == this.current_sub_part
				? ((c = this.pa2_Towel_pos),
				  (a = cc.p(527, 336)),
				  (e = cc.p(278, 333)),
				  (t = cc.p(197, 227)),
				  this.RandomCommonHandIndThreeWay1(c, a, e, t))
				: 3 == this.current_sub_part &&
				  ((c = this.pa2_F_Item_Move_pos),
				  (a =
						this.pa2_F_Part_Dummy_pos[
							this.pa2_F_Item_Move[
								this.pa2_F_Item_Move_cur
							].getName()
						]),
				  this.RandomCommonHandIndOneWay(c, a))
			: 3 == this.current_part &&
			  (2 == this.current_sub_part
					? ((c = this.pa3_Wheel_pos[comman.getRandomInt(4, 6)]),
					  (a = cc.p(144, 148)),
					  this.RandomCommonHandIndOneWay(c, a))
					: 3 == this.current_sub_part
					? ((c = this.pa3_Wheel_Move_pos),
					  (a = this.pa3_Wheel_Done_pos[this.pa3_Wheel_Move_curr]),
					  this.RandomCommonHandIndOneWay(c, a))
					: 4 == this.current_sub_part
					? ((c = this.pa3_Oil_Bottle_pos),
					  (a = this.pa3_Wheel_Done_pos[comman.getRandomInt(1, 3)]),
					  this.RandomCommonHandIndOneWay(c, a))
					: 6 == this.current_sub_part &&
					  ((c = this.pa3_Scraw_pos),
					  (a = this.pa3_Scraw_Done_pos[this.pa3_Scraw_curr]),
					  this.RandomCommonHandIndOneWay(c, a)));
	},
	RandomCommonHandInd1: function () {
		var e;
		3 == this.current_part &&
			(1 == this.current_sub_part
				? ((e = cc.p(546, 241)), this.RandomCommonHandIndJump(e))
				: 5 == this.current_sub_part &&
				  ((e = cc.p(434, 231)), this.RandomCommonHandIndJump(e)));
	},
	RandomCommonHandIndOneWay: function (e, t) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(0.5, t),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(1)
					)
				)
			);
	},
	RandomCommonHandIndTwoWay: function (e, t, c) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, e),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, c),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndThreeWay1: function (e, t, c, a) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.MoveTo.create(1, t),
						cc.MoveTo.create(2, c),
						cc.MoveTo.create(1, a),
						cc.ScaleTo.create(0, 0),
						cc.MoveTo.create(0, e),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonHandIndJump: function (e) {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setRotation(150),
			this.CommonHandIndicator.setPosition(e),
			this.CommonHandIndicator.runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0, 1),
						cc.JumpTo.create(1.5, e, 5, 2),
						cc.ScaleTo.create(0, 0),
						cc.DelayTime.create(2)
					)
				)
			);
	},
	RandomCommonRoundInd: function (e) {},
	RandomCommonRoundInd1: function (e) {
		this.CommonRoundIndicator[1].setPosition(e),
			this.CommonRoundIndicator[1].stopAllActions(),
			this.CommonRoundIndicator[1].setScale(1),
			this.CommonRoundIndicator[1].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	RandomCommonRoundInd2: function (e, t) {
		this.CommonRoundIndicator[e].setPosition(t),
			this.CommonRoundIndicator[e].stopAllActions(),
			this.CommonRoundIndicator[e].setScale(1),
			this.CommonRoundIndicator[e].runAction(
				cc.RepeatForever.create(
					cc.Sequence.create(
						cc.ScaleTo.create(0.5, 1.1),
						cc.ScaleTo.create(0.5, 1)
					)
				)
			);
	},
	hideHint: function () {
		this.CommonHandIndicator.stopAllActions(),
			this.CommonHandIndicator.setScale(0);
		for (var e = 0; e < 15; e++)
			this.CommonRoundIndicator[e].stopAllActions(),
				this.CommonRoundIndicator[e].setScale(0);
	},
	showToolCompleteParticle: function (e) {
		this.prt_tool_sparkle.setPosition(e),
			this.prt_tool_sparkle.resetSystem();
	},
	showDone: function () {
		0 == this.isDoneShow &&
			((this.isDoneShow = !0),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	showNext: function () {
		0 == this.isNextShow &&
			((this.isNextShow = !0),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width -
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	hideDone: function () {
		1 == this.isDoneShow &&
			((this.isDoneShow = !1),
			this.btn_done.stopAllActions(),
			this.btn_done.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_done.getContentSize().width,
							this.btn_done.getPositionY()
						)
					)
				)
			));
	},
	hideNext: function () {
		1 == this.isNextShow &&
			((this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							this.btn_next.getPositionY()
						)
					)
				)
			));
	},
	createPlayarea: function () {
		(this.dummyMoveDist = cc.p(0, 0)),
			(this.dummyBrush = cc.Sprite.create('RES/CB/brush.png')),
			this.dummyBrush.setPosition(cc.p(1e3, 1e3)),
			this.dummyBrush.setScale(0),
			this.dummyBrush.setOpacity(255),
			this.dummyBrush.setBlendFunc(cc.ZERO, cc.ONE_MINUS_SRC_ALPHA),
			this.addChild(this.dummyBrush, -100),
			(this.lyl_play = cc.Layer.create()),
			this.addChild(this.lyl_play),
			(this.lyl_part = []),
			(this.lyl_sub_part = []);
		var e = 0;
		(this.lyl_part[e] = cc.Layer.create()),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 1;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa1_Frige = cc.Sprite.create('RES/PA/5/pa1_Frige_1.png')),
			this.pa1_Frige.setPosition(cc.p(400, 252)),
			this.pa1_Frige.setScale(1),
			this.pa1_Frige.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Frige),
			(this.pa1_Frige_anim = cc.Animation.create()),
			this.pa1_Frige_anim.setDelayPerUnit(0.5),
			this.pa1_Frige_anim.addSpriteFrameWithFile(
				'RES/PA/5/pa1_Frige_2.png'
			),
			this.pa1_Frige_anim.addSpriteFrameWithFile(
				'RES/PA/5/pa1_Frige_1.png'
			),
			this.pa1_Frige.runAction(
				cc.RepeatForever.create(
					cc.Animate.create(this.pa1_Frige_anim.clone())
				)
			),
			(this.pa1_Mixer = cc.Sprite.create('RES/PA/5/pa1_Mixer.png')),
			this.pa1_Mixer.setPosition(cc.p(400, 252)),
			this.pa1_Mixer.setScale(1),
			this.pa1_Mixer.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Mixer),
			(this.pa1_Big_Panda_pos1 = cc.p(666, -70)),
			(this.pa1_Big_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Big_Panda.json',
				'RES/PA/anim/Big_Panda.atlas',
				0.5
			)),
			this.pa1_Big_Panda.setPosition(
				cc.p(this.pa1_Big_Panda_pos1.x, this.pa1_Big_Panda_pos1.y)
			),
			this.pa1_Big_Panda.setScale(1, 1),
			this.pa1_Big_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Big_Panda),
			this.pa1_Big_Panda.setAnimation(1, 'Sad', !0),
			(this.pa1_Panda_pos1 = cc.p(133, -30)),
			(this.pa1_Panda = new sp.SkeletonAnimation(
				'RES/PA/anim/Panda.json',
				'RES/PA/anim/Panda.atlas',
				0.5
			)),
			this.pa1_Panda.setPosition(
				cc.p(this.pa1_Panda_pos1.x, this.pa1_Panda_pos1.y - 400)
			),
			this.pa1_Panda.setScale(1, 1),
			this.pa1_Panda.setTag(1),
			this.lyl_part[e].addChild(this.pa1_Panda),
			this.pa1_Panda.setAnimation(1, 'Idle', !0);
		e = 2;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa2_Fridge_1 = cc.Sprite.create('RES/PA/5/pa2_Fridge_1.png')),
			this.pa2_Fridge_1.setPosition(cc.p(400, 252)),
			this.pa2_Fridge_1.setScale(1),
			this.pa2_Fridge_1.setTag(1),
			this.lyl_part[e].addChild(this.pa2_Fridge_1),
			(this.pa2_Fridge_2 = cc.Sprite.create('RES/PA/5/pa2_Fridge_2.png')),
			this.pa2_Fridge_2.setPosition(cc.p(400, 252)),
			this.pa2_Fridge_2.setScale(1),
			this.pa2_Fridge_2.setTag(1),
			this.pa2_Fridge_2.setVisible(!1),
			this.pa2_Fridge_1.addChild(this.pa2_Fridge_2, -1),
			(this.pa2_Fridge_Item = []);
		for (var t = 1; t <= 5; t++)
			(this.pa2_Fridge_Item[t] = cc.Sprite.create(
				'RES/PA/5/pa2_Fridge_Item_' + t + '.png'
			)),
				this.pa2_Fridge_Item[t].setPosition(cc.p(400, 252)),
				this.pa2_Fridge_Item[t].setScale(1),
				this.pa2_Fridge_Item[t].setTag(1),
				this.pa2_Fridge_Item[t].setVisible(!1),
				this.pa2_Fridge_1.addChild(this.pa2_Fridge_Item[t]);
		(this.pa2_Fridge_Item_Set = []),
			(this.pa2_F_Item_Seq_no = [1, 1, 2, 3, 3, 4, 5, 5]),
			(this.pa2_Fridge_Item_Set_pos = [
				cc.p(0, 0),
				cc.p(170, 371),
				cc.p(228, 370),
				cc.p(276, 243),
				cc.p(516, 351),
				cc.p(586, 350),
				cc.p(579, 228),
				cc.p(445, 100),
				cc.p(510, 100),
			]);
		for (t = 1; t <= 8; t++)
			(this.pa2_Fridge_Item_Set[t] = cc.Sprite.create(
				'RES/PA/5/pa2_Fridge_Set_Item_' + t + '.png'
			)),
				this.pa2_Fridge_Item_Set[t].setPosition(cc.p(400, 252)),
				this.pa2_Fridge_Item_Set[t].setScale(1),
				this.pa2_Fridge_Item_Set[t].setTag(1),
				this.pa2_Fridge_Item_Set[t].setVisible(!1),
				this.pa2_Fridge_Item_Set[t].setName(
					this.pa2_F_Item_Seq_no[t - 1] + ''
				),
				this.pa2_Fridge_1.addChild(this.pa2_Fridge_Item_Set[t]);
		(this.pa2_Glass_Up = cc.Sprite.create('RES/PA/5/pa2_Glass_Up.png')),
			this.pa2_Glass_Up.setPosition(cc.p(400, 252)),
			this.pa2_Glass_Up.setScale(1),
			this.pa2_Glass_Up.setTag(1),
			this.pa2_Fridge_1.addChild(this.pa2_Glass_Up),
			(this.pa2_Ice = []);
		for (t = 1; t <= 6; t++)
			(this.pa2_Ice[t] = cc.Sprite.create(
				'RES/PA/5/pa2_Ice_' + t + '_1.png'
			)),
				this.pa2_Ice[t].setPosition(cc.p(400, 252)),
				this.pa2_Ice[t].setScale(1),
				this.pa2_Ice[t].setTag(1),
				(t <= 3 ? this.pa2_Fridge_2 : this.pa2_Fridge_1).addChild(
					this.pa2_Ice[t]
				);
		(this.pa2_Water = []),
			(this.pa2_Water_pos = [
				cc.p(0, 0),
				cc.p(280, 332),
				cc.p(196, 228),
				cc.p(244, 67),
				cc.p(527, 339),
				cc.p(482, 223),
				cc.p(473, 70),
			]);
		for (t = 1; t <= 6; t++)
			(this.pa2_Water[t] = cc.Sprite.create(
				'RES/PA/5/pa2_Water_' + t + '.png'
			)),
				this.pa2_Water[t].setPosition(cc.p(400, 252)),
				this.pa2_Water[t].setScale(1),
				this.pa2_Water[t].setTag(1),
				this.pa2_Water[t].setOpacity(0),
				this.pa2_Fridge_1.addChild(this.pa2_Water[t]);
		(this.pa2_F_Part_Dummy = []),
			(this.pa2_F_Part_Dummy_pos = [
				cc.p(0, 0),
				cc.p(224, 371),
				cc.p(228, 260),
				cc.p(519, 354),
				cc.p(518, 239),
				cc.p(516, 104),
			]);
		for (t = 1; t <= 5; t++)
			(this.pa2_F_Part_Dummy[t] = cc.Sprite.create('RES/CB/brush.png')),
				this.pa2_F_Part_Dummy[t].setPosition(
					this.pa2_F_Part_Dummy_pos[t]
				),
				this.pa2_F_Part_Dummy[t].setScale(4, 1.7),
				this.pa2_F_Part_Dummy[t].setTag(1),
				this.pa2_F_Part_Dummy[t].setVisible(!1),
				this.pa2_F_Part_Dummy[t].setName(t + ''),
				this.pa2_Fridge_1.addChild(this.pa2_F_Part_Dummy[t]);
		(this.pa2_Fridge_Door = cc.Sprite.create(
			'RES/PA/5/pa2_Door_Closed_Ani_3.png'
		)),
			this.pa2_Fridge_Door.setPosition(cc.p(400, 252)),
			this.pa2_Fridge_Door.setScale(1),
			this.pa2_Fridge_Door.setTag(1),
			this.pa2_Fridge_1.addChild(this.pa2_Fridge_Door),
			(this.pa2_Fridge_2_anim = cc.Animation.create()),
			this.pa2_Fridge_2_anim.setDelayPerUnit(0.1),
			this.pa2_Fridge_2_anim.addSpriteFrameWithFile(
				'RES/PA/5/pa2_Door_Closed_Ani_3.png'
			),
			this.pa2_Fridge_2_anim.addSpriteFrameWithFile(
				'RES/PA/5/pa2_Door_Closed_Ani_2.png'
			),
			this.pa2_Fridge_2_anim.addSpriteFrameWithFile(
				'RES/PA/5/pa2_Door_Closed_Ani_1.png'
			),
			(this.pa2_Dryer_pos = cc.p(744, 77)),
			(this.pa2_Dryer = cc.Sprite.create('RES/PA/5/pa2_Dryer.png')),
			this.pa2_Dryer.setPosition(
				cc.p(this.pa2_Dryer_pos.x + 500, this.pa2_Dryer_pos.y)
			),
			this.pa2_Dryer.setAnchorPoint(cc.p(0.7, 0.3)),
			this.pa2_Dryer.setScale(0.7),
			this.pa2_Dryer.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Dryer),
			(this.pa2_Dryer_Flow = cc.Sprite.create(
				'RES/PA/5/pa2_Dryer_Flow_1.png'
			)),
			this.pa2_Dryer_Flow.setPosition(cc.p(60, 108)),
			this.pa2_Dryer_Flow.setAnchorPoint(cc.p(1, 0.5)),
			this.pa2_Dryer_Flow.setScale(1.3),
			this.pa2_Dryer_Flow.setTag(0),
			this.pa2_Dryer_Flow.setRotation(-10),
			this.pa2_Dryer_Flow.setVisible(!1),
			this.pa2_Dryer.addChild(this.pa2_Dryer_Flow, -1),
			(this.pa2_Dryer_Flow_anim = cc.Animation.create()),
			this.pa2_Dryer_Flow_anim.setDelayPerUnit(0.1),
			this.pa2_Dryer_Flow_anim.addSpriteFrameWithFile(
				'RES/PA/5/pa2_Dryer_Flow_2.png'
			),
			this.pa2_Dryer_Flow_anim.addSpriteFrameWithFile(
				'RES/PA/5/pa2_Dryer_Flow_1.png'
			),
			this.pa2_Dryer_Flow.runAction(
				cc.RepeatForever.create(
					cc.Animate.create(this.pa2_Dryer_Flow_anim.clone())
				)
			),
			(this.pa2_Towel_pos = cc.p(720, 107)),
			(this.pa2_Towel = cc.Sprite.create('RES/PA/5/pa2_Towel.png')),
			this.pa2_Towel.setPosition(
				cc.p(this.pa2_Towel_pos.x + 500, this.pa2_Towel_pos.y)
			),
			this.pa2_Towel.setScale(1),
			this.pa2_Towel.setTag(0),
			this.lyl_part[e].addChild(this.pa2_Towel),
			(this.pa2_F_Item_Seq_line = comman.ganerateUniqueSequence(0, 7, 8)),
			(this.pa2_F_Item_Seq = []);
		for (t = 0; t < this.pa2_F_Item_Seq_line.length; t++)
			this.pa2_F_Item_Seq[t] =
				this.pa2_F_Item_Seq_no[this.pa2_F_Item_Seq_line[t]];
		(this.pa2_F_Item_Move_cur = 0),
			(this.pa2_F_Item_Move = []),
			(this.pa2_F_Item_Move_pos = cc.p(720, 75));
		for (t = 0; t < this.pa2_F_Item_Seq.length; t++)
			(this.pa2_F_Item_Move[t] = cc.Sprite.create(
				'RES/PA/5/pa2_Fridge_Move_Item_' +
					this.pa2_F_Item_Seq[t] +
					'.png'
			)),
				this.pa2_F_Item_Move[t].setPosition(
					cc.p(
						this.pa2_F_Item_Move_pos.x + 500,
						this.pa2_F_Item_Move_pos.y
					)
				),
				this.pa2_F_Item_Move[t].setScale(1),
				this.pa2_F_Item_Move[t].setTag(0),
				this.pa2_F_Item_Move[t].setName(this.pa2_F_Item_Seq[t] + ''),
				this.lyl_part[e].addChild(this.pa2_F_Item_Move[t]);
		e = 3;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]),
			(this.pa3_Bg = cc.Sprite.create('RES/PA/5/Bg_4.png')),
			this.pa3_Bg.setPosition(cc.p(400, 252)),
			this.pa3_Bg.setScale(1),
			this.pa3_Bg.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Bg),
			(this.pa3_Wheel = []),
			(this.pa3_Wheel_pos = [
				cc.p(0, 0),
				cc.p(329, 331),
				cc.p(294, 195),
				cc.p(512, 257),
				cc.p(224, 320),
				cc.p(469, 323),
				cc.p(352, 228),
			]);
		for (t = 1; t <= 6; t++)
			(this.pa3_Wheel[t] = cc.Sprite.create(
				'RES/PA/5/pa3_Wheel_' + t + '.png'
			)),
				this.pa3_Wheel[t].setPosition(this.pa3_Wheel_pos[t]),
				this.pa3_Wheel[t].setScale(1),
				this.pa3_Wheel[t].setTag(0),
				this.lyl_part[e].addChild(this.pa3_Wheel[t]);
		(this.pa3_Wheel_Done = []),
			(this.pa3_Wheel_Done1 = []),
			(this.pa3_Wheel_Done_pos = [
				cc.p(0, 0),
				cc.p(224, 320),
				cc.p(469, 323),
				cc.p(352, 228),
			]);
		for (t = 1; t <= 3; t++)
			(this.pa3_Wheel_Done[t] = cc.Sprite.create(
				'RES/PA/5/pa3_Wheel_Done_' + t + '_1.png'
			)),
				this.pa3_Wheel_Done[t].setPosition(this.pa3_Wheel_Done_pos[t]),
				this.pa3_Wheel_Done[t].setScale(1),
				this.pa3_Wheel_Done[t].setTag(0),
				this.pa3_Wheel_Done[t].setOpacity(100),
				this.pa3_Wheel_Done[t].setVisible(!1),
				this.lyl_part[e].addChild(this.pa3_Wheel_Done[t]),
				(this.pa3_Wheel_Done1[t] = cc.Sprite.create(
					'RES/PA/5/pa3_Wheel_Done_' + t + '_2.png'
				)),
				this.pa3_Wheel_Done1[t].setPosition(cc.p(0, 0)),
				this.pa3_Wheel_Done1[t].setAnchorPoint(cc.p(0, 0)),
				this.pa3_Wheel_Done1[t].setScale(1),
				this.pa3_Wheel_Done1[t].setTag(0),
				this.pa3_Wheel_Done1[t].setOpacity(0),
				this.pa3_Wheel_Done[t].addChild(this.pa3_Wheel_Done1[t]);
		(this.pa3_Door_Screw = cc.Sprite.create('RES/PA/5/pa3_Door_Screw.png')),
			this.pa3_Door_Screw.setPosition(cc.p(400, 252)),
			this.pa3_Door_Screw.setScale(1),
			this.pa3_Door_Screw.setTag(1),
			this.lyl_part[e].addChild(this.pa3_Door_Screw),
			(this.pa3_Scraw_Done = []),
			(this.pa3_Scraw_Done_pos = [
				cc.p(0, 0),
				cc.p(216, 341),
				cc.p(216, 210),
				cc.p(622, 346),
				cc.p(622, 211),
			]);
		for (t = 1; t <= 4; t++)
			(this.pa3_Scraw_Done[t] = cc.Sprite.create(
				'RES/PA/5/pa3_Scraw_Done_' + t + '.png'
			)),
				this.pa3_Scraw_Done[t].setPosition(cc.p(400, 252)),
				this.pa3_Scraw_Done[t].setScale(1),
				this.pa3_Scraw_Done[t].setTag(0),
				this.pa3_Scraw_Done[t].setVisible(!1),
				this.pa3_Door_Screw.addChild(this.pa3_Scraw_Done[t]);
		(this.pa3_lyl_popup = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.pa3_lyl_popup.setScale(0),
			this.lyl_part[e].addChild(this.pa3_lyl_popup, 5),
			(this.pa3_Popup_Cur = 1),
			(this.pa3_Popup = cc.Sprite.create('RES/PA/5/pa3_Popup_1.png')),
			this.pa3_Popup.setPosition(cc.p(400, 252)),
			this.pa3_Popup.setScale(1),
			this.pa3_Popup.setTag(1),
			this.pa3_lyl_popup.addChild(this.pa3_Popup),
			(this.pa3_Screw_pos = cc.p(397, 247)),
			(this.pa3_Screw = cc.Sprite.create('RES/PA/5/pa3_Screw.png')),
			this.pa3_Screw.setPosition(this.pa3_Screw_pos),
			this.pa3_Screw.setAnchorPoint(cc.p(0.5, 0.5)),
			this.pa3_Screw.setScale(1),
			this.pa3_Screw.setTag(0),
			this.pa3_Popup.addChild(this.pa3_Screw),
			(this.pa3_Panu_pos = cc.p(397, 247)),
			(this.pa3_Panu_pos1 = cc.p(1197, 247)),
			(this.pa3_Panu = cc.Sprite.create('RES/PA/5/pa3_Panu.png')),
			this.pa3_Panu.setPosition(this.pa3_Panu_pos1),
			this.pa3_Panu.setAnchorPoint(cc.p(0.1, 0.5)),
			this.pa3_Panu.setScale(1),
			this.pa3_Panu.setTag(0),
			this.pa3_Popup.addChild(this.pa3_Panu),
			(this.pa3_Bin_pos = cc.p(140, 93)),
			(this.pa3_Bin = cc.Sprite.create('RES/PA/5/pa3_Bin.png')),
			this.pa3_Bin.setPosition(
				cc.p(this.pa3_Bin_pos.x - 400, this.pa3_Bin_pos.y)
			),
			this.pa3_Bin.setScale(1),
			this.pa3_Bin.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Bin),
			(this.pa3_Wheel_Move_curr = 1),
			(this.pa3_Wheel_Move = []),
			(this.pa3_Wheel_Move_pos = cc.p(657, 177));
		for (t = 1; t <= 3; t++)
			(this.pa3_Wheel_Move[t] = cc.Sprite.create(
				'RES/PA/5/pa3_Wheel_Done_' + t + '_1.png'
			)),
				this.pa3_Wheel_Move[t].setPosition(
					cc.p(
						this.pa3_Wheel_Move_pos.x + 700,
						this.pa3_Wheel_Move_pos.y
					)
				),
				this.pa3_Wheel_Move[t].setScale(1),
				this.pa3_Wheel_Move[t].setTag(0),
				this.lyl_part[e].addChild(this.pa3_Wheel_Move[t]);
		(this.pa3_Oil_Bottle_pos = cc.p(698, 126)),
			(this.pa3_Oil_Bottle = cc.Sprite.create(
				'RES/PA/5/pa3_Oil_Bottle.png'
			)),
			this.pa3_Oil_Bottle.setPosition(
				cc.p(this.pa3_Oil_Bottle_pos.x + 700, this.pa3_Oil_Bottle_pos.y)
			),
			this.pa3_Oil_Bottle.setScale(1),
			this.pa3_Oil_Bottle.setTag(0),
			this.lyl_part[e].addChild(this.pa3_Oil_Bottle),
			(this.pa3_Scraw_curr = 1),
			(this.pa3_Scraw = []),
			(this.pa3_Scraw_pos = cc.p(740, 100));
		for (t = 1; t <= 4; t++)
			(this.pa3_Scraw[t] = cc.Sprite.create(
				'RES/PA/5/pa3_Scraw_' + t + '.png'
			)),
				this.pa3_Scraw[t].setPosition(
					cc.p(this.pa3_Scraw_pos.x + 700, this.pa3_Scraw_pos.y)
				),
				this.pa3_Scraw[t].setScale(1),
				this.pa3_Scraw[t].setTag(0),
				this.lyl_part[e].addChild(this.pa3_Scraw[t]);
		e = 4;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 5;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 0))),
			this.lyl_part[e].setScale(0),
			this.lyl_play.addChild(this.lyl_part[e]);
		e = 6;
		(this.lyl_part[e] = cc.LayerColor.create(cc.color(0, 0, 0, 150))),
			this.lyl_part[e].setScale(0),
			this.lyl_part[e].setPosition(cc.p(0, 0)),
			this.lyl_play.addChild(this.lyl_part[e]);
	},
	startNextPart: function () {
		if (0 == this.current_part)
			this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part &&
					(this.setTouchOff(0.1),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0));
		else if (1 == this.current_part)
			this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part
					? (this.pa1_Big_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(3),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Big_Panda_pos1.x,
										this.pa1_Big_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  this.pa1_Panda.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.5),
								cc.MoveTo.create(0.3, this.pa1_Panda_pos1),
								cc.DelayTime.create(2.2),
								cc.MoveTo.create(
									0.3,
									cc.p(
										this.pa1_Panda_pos1.x,
										this.pa1_Panda_pos1.y - 400
									)
								)
							)
					  ),
					  (this.current_part = 2),
					  (this.current_sub_part = 1),
					  this.setTouchOff(3.4),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 3.3))
					: 2 == this.current_sub_part
					? (this.pa1_Frige.stopAllActions(),
					  this.pa1_Frige.setTexture('RES/PA/5/pa1_Frige_Done.png'),
					  this.bg.setTexture('RES/PA/5/Bg_1.png'),
					  this.lyl_part[2].setScale(0),
					  this.lyl_part[3].setScale(0),
					  this.lyl_part[4].setScale(0),
					  (this.current_part = 3),
					  (this.current_sub_part = 1),
					  this.setTouchOff(2.1),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 2))
					: 3 == this.current_sub_part &&
					  (this.pa1_Mixer.setTexture('RES/PA/5/pa1_Mixer_Done.png'),
					  this.bg.setTexture('RES/PA/5/Bg_1.png'),
					  this.lyl_part[2].setScale(0),
					  this.lyl_part[3].setScale(0),
					  this.lyl_part[4].setScale(0),
					  this.setTouchOff(0.5),
					  this.unschedule(this.showDone),
					  this.scheduleOnce(this.showDone, 0.2));
		else if (2 == this.current_part) {
			if (
				(this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				this.bg.setTexture('RES/PA/5/Bg_2.png'),
					this.pa2_Fridge_Door.runAction(
						cc.Sequence.create(
							cc.Animate.create(this.pa2_Fridge_2_anim.clone()),
							cc.callFunc(
								function () {
									this.pa2_Fridge_Door.setVisible(!1),
										this.pa2_Fridge_2.setVisible(!0);
								}.bind(this)
							)
						)
					),
					this.pa2_Dryer.setTag(1),
					this.pa2_Dryer.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.4),
							cc.MoveTo.create(0.2, this.pa2_Dryer_pos)
						)
					),
					this.setTouchOff(0.7),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.6);
			else if (2 == this.current_sub_part)
				this.pa2_Towel.setTag(1),
					this.pa2_Towel.runAction(
						cc.MoveTo.create(0.2, this.pa2_Towel_pos)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			else if (3 == this.current_sub_part) {
				for (var e = 1; e <= 5; e++)
					this.pa2_Fridge_Item[e].setVisible(!0);
				this.pa2_F_Item_Move_cur < 8
					? (this.pa2_F_Item_Move[this.pa2_F_Item_Move_cur].setTag(1),
					  this.pa2_F_Item_Move[this.pa2_F_Item_Move_cur].runAction(
							cc.MoveTo.create(0.2, this.pa2_F_Item_Move_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: this.showNext();
			}
		} else if (3 == this.current_part)
			if (
				(this.lyl_part[1].setScale(0),
				this.lyl_part[this.current_part - 1].setScale(0),
				this.lyl_part[this.current_part].setScale(1),
				1 == this.current_sub_part)
			)
				1 == this.pa3_Popup_Cur
					? (this.bg.setTexture('RES/PA/5/Bg_3.png'),
					  this.pa3_lyl_popup.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.5),
								cc.ScaleTo.create(0, 1)
							)
					  ),
					  this.pa3_Popup.setTexture(
							'RES/PA/5/pa3_Popup_' + this.pa3_Popup_Cur + '.png'
					  ),
					  this.pa3_Screw.setPosition(this.pa3_Screw_pos),
					  this.pa3_Screw.setRotation(0),
					  this.pa3_Panu.setPosition(this.pa3_Panu_pos1),
					  this.pa3_Panu.setTag(1),
					  this.pa3_Panu.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.5),
								cc.MoveTo.create(0.2, this.pa3_Panu_pos)
							)
					  ),
					  this.setTouchOff(0.8),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, 0.7))
					: 5 == this.pa3_Popup_Cur
					? this.showNext()
					: (this.pa3_Popup.setTexture(
							'RES/PA/5/pa3_Popup_' + this.pa3_Popup_Cur + '.png'
					  ),
					  this.pa3_Screw.setPosition(this.pa3_Screw_pos),
					  this.pa3_Screw.setRotation(0),
					  this.pa3_Panu.setPosition(this.pa3_Panu_pos1),
					  this.pa3_Panu.setTag(1),
					  this.pa3_Panu.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0),
								cc.MoveTo.create(0.2, this.pa3_Panu_pos)
							)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd1),
					  this.scheduleOnce(this.RandomCommonHandInd1, 0.2));
			else if (2 == this.current_sub_part) {
				for (e = 4; e <= 6; e++) this.pa3_Wheel[e].setTag(1);
				this.pa3_Door_Screw.setTexture('RES/PA/5/pa3_Door.png'),
					this.pa3_lyl_popup.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.5),
							cc.ScaleTo.create(0, 0)
						)
					),
					this.pa3_Door_Screw.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.7),
							cc.JumpTo.create(0.2, cc.p(400, -252), 300, 1),
							cc.Hide.create(),
							cc.MoveTo.create(0, cc.p(400, 252))
						)
					),
					this.pa3_Bin.runAction(
						cc.Sequence.create(
							cc.DelayTime.create(0.9),
							cc.MoveTo.create(0.2, this.pa3_Bin_pos)
						)
					),
					this.setTouchOff(1.2),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 1.1);
			} else if (3 == this.current_sub_part) {
				for (e = 1; e <= 3; e++) this.pa3_Wheel_Done[e].setVisible(!0);
				this.pa3_Wheel_Move[this.pa3_Wheel_Move_curr].setTag(1),
					this.pa3_Wheel_Move[this.pa3_Wheel_Move_curr].runAction(
						cc.MoveTo.create(0.2, this.pa3_Wheel_Move_pos)
					),
					this.setTouchOff(0.3),
					this.unschedule(this.RandomCommonHandInd),
					this.scheduleOnce(this.RandomCommonHandInd, 0.2);
			} else
				4 == this.current_sub_part
					? (this.pa3_Oil_Bottle.setTag(1),
					  this.pa3_Oil_Bottle.runAction(
							cc.MoveTo.create(0.2, this.pa3_Oil_Bottle_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 5 == this.current_sub_part
					? (this.pa3_Door_Screw.setTexture(
							'RES/PA/5/pa3_Door_Done.png'
					  ),
					  this.pa3_Door_Screw.setPosition(cc.p(400, -252)),
					  this.pa3_Door_Screw.setVisible(!0),
					  this.pa3_Door_Screw.runAction(
							cc.Sequence.create(
								cc.DelayTime.create(1),
								cc.JumpTo.create(0.3, cc.p(400, 252), 200, 1)
							)
					  ),
					  this.current_sub_part++,
					  this.setTouchOff(1.3),
					  this.unschedule(this.startNextPart_call),
					  this.scheduleOnce(this.startNextPart_call, 1.3))
					: 6 == this.current_sub_part
					? (this.pa3_Scraw[this.pa3_Scraw_curr].setTag(1),
					  this.pa3_Scraw[this.pa3_Scraw_curr].runAction(
							cc.MoveTo.create(0.2, this.pa3_Scraw_pos)
					  ),
					  this.setTouchOff(0.3),
					  this.unschedule(this.RandomCommonHandInd),
					  this.scheduleOnce(this.RandomCommonHandInd, 0.2))
					: 7 == this.current_sub_part && this.showNext();
	},
	angleBetweenPoints: function (e, t) {
		var c = e.y - t.y,
			e = t.x - e.x,
			e = Math.atan2(c, e),
			e = cc.radiansToDegrees(e);
		return 180 < e && (e -= 180), e + 90;
	},
	createPanels: function () {},
	updateRewardAds: function () {
		1 == comman.isRewardAdComplete
			? (this.rewardItem.getChildByName('rads').setVisible(!1),
			  (this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds))
			: 1 == comman.isRewardAdFailed &&
			  ((this.rewardItem = null),
			  (comman.isRewardAdComplete = !1),
			  (comman.isRewardAdFailed = !1),
			  this.unschedule(this.updateRewardAds));
	},
	startNextPart_call: function () {
		this.startNextPart();
	},
	startNextPart_call1: function () {
		this.startNextPart();
	},
	startNextPart_call2: function () {
		this.startNextPart();
	},
	checkLevelComplete: function () {
		this.showDone();
	},
	addDummyPoints: function () {
		(this.dummyPoints = [cc.p(1562, 308)]),
			2 == this.current_part && this.current_sub_part;
	},
	changeZorder: function (e, t, c) {
		e.setLocalZOrder(t);
	},
	changeTag: function (e, t) {
		e.setTag(t);
	},
	changeTexture: function (e, t) {
		e.setTexture(t);
	},
	buttonClickAction1: function (e) {
		var t = e.getScale();
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, t + 0.1),
				cc.ScaleTo.create(0.2, t)
			)
		);
	},
	buttonClickAction: function (e) {
		e.runAction(
			cc.Sequence.create(
				cc.ScaleTo.create(0.2, 1.1),
				cc.ScaleTo.create(0.2, 1)
			)
		);
	},
	buttonSelectedAction: function (e) {
		e.runAction(
			cc.RepeatForever.create(
				cc.Sequence.create(
					cc.ScaleTo.create(0.5, 1.1),
					cc.ScaleTo.create(0.5, 1)
				)
			)
		);
	},
	onDoneClick: function (e) {
		0 != this.isTouchOn &&
			(this.hideDone(),
			this.setTouchOff(2.5),
			this.scheduleOnce(
				function () {
					this.onNextScene();
				},
				1,
				'onNextScene'
			));
	},
	onNextClick: function (e) {
		0 == this.isTouchOn ||
			0 < e.getNumberOfRunningActions() ||
			(comman.stopAllEffect(),
			comman.showInterstitial(),
			(this.isNextShow = !1),
			this.btn_next.stopAllActions(),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0),
					cc.EaseBackIn.create(
						cc.MoveTo.create(
							0.5,
							cc.p(
								comman.winSize().width +
									1.5 * this.btn_next.getContentSize().width,
								this.btn_next.getPositionY()
							)
						)
					)
				)
			),
			1 == this.current_part && 1 == this.current_sub_part
				? ((this.current_sub_sub_part = 1), (this.current_sub_part = 3))
				: 2 == this.current_part && 3 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 2),
				  (this.current_part = 1))
				: 3 == this.current_part && 7 == this.current_sub_part
				? ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 3),
				  (this.current_part = 1))
				: ((this.current_sub_sub_part = 1),
				  (this.current_sub_part = 1),
				  this.current_part++),
			this.startNextPart());
	},
	checkIsLevelDone: function () {
		this.isDoneShow;
	},
	update: function (e) {},
	onNextScene1: function (e) {
		(this.isNextShow = !1),
			this.btn_next.runAction(
				cc.Sequence.create(
					cc.DelayTime.create(0.25),
					cc.MoveTo.create(
						0.5,
						cc.p(
							comman.winSize().width +
								0.55 * this.btn_next.getContentSize().width,
							0.55 * this.btn_next.getContentSize().height
						)
					)
				)
			),
			comman.stopAllEffect(),
			comman.showInterstitial(),
			cc.director.runScene(ChooseScene.scene());
	},
	onNextScene: function (e) {
		comman.stopAllEffect(),
			comman.showInterstitial(),
			selectedLevels++,
			cc.director.runScene(ChooseScene.scene());
	},
	setTouchOff: function (e) {
		(this.isTouchOn = !1),
			this.unschedule(this.setTouchEnable),
			this.scheduleOnce(this.setTouchEnable, e);
	},
	setTouchEnable: function () {
		this.isTouchOn = !0;
	},
	checkFullTouchObject: function (e, t) {
		return (
			!eventInTransparentMask(e, e.getParent().convertToWorldSpace(t)) &&
			1 == this.checkTouchObject(e, t)
		);
	},
	checkFullTouchObject1: function (e, t) {
		return (
			!eventInTransparentMask1(e, t) && 1 == this.checkTouchObject(e, t)
		);
	},
	checkTouchObject: function (e, t) {
		return cc.rectContainsPoint(
			e.getBoundingBox(),
			e.getParent().convertToNodeSpace(t)
		);
	},
	onTouchBegan: function (e, t) {
		var c = e.getLocation(),
			a = t.getCurrentTarget();
		a.startPos = c;
		a.startLocation = c;
		if (0 != a.isTouchOn) {
			if (2 == a.current_part)
				1 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Dryer, c) &&
					  0 == a.pa2_Dryer.getNumberOfRunningActions() &&
					  1 == a.pa2_Dryer.getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Dryer),
					  (a.move_tool_pos = a.pa2_Dryer.getPosition()),
					  (a.move_tool_rot = a.pa2_Dryer.getRotation()),
					  (a.move_tool_scale = a.pa2_Dryer.getScale()),
					  (a.move_tool_zorder = a.pa2_Dryer.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.pa2_Dryer_Flow.setVisible(!0),
					  a.dummyBrush.setScale(0.4, 0.4),
					  (a.dummyMoveDist = cc.p(-150, 25)))
					: 2 == a.current_sub_part
					? a.checkTouchObject(a.pa2_Towel, c) &&
					  0 == a.pa2_Towel.getNumberOfRunningActions() &&
					  1 == a.pa2_Towel.getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_Towel),
					  (a.move_tool_pos = a.pa2_Towel.getPosition()),
					  (a.move_tool_rot = a.pa2_Towel.getRotation()),
					  (a.move_tool_scale = a.pa2_Towel.getScale()),
					  (a.move_tool_zorder = a.pa2_Towel.getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(0, 0),
					  (a.dummyMoveDist = cc.p(0, 0)))
					: 3 == a.current_sub_part &&
					  a.pa2_F_Item_Move_cur < 8 &&
					  a.checkTouchObject(
							a.pa2_F_Item_Move[a.pa2_F_Item_Move_cur],
							c
					  ) &&
					  0 ==
							a.pa2_F_Item_Move[
								a.pa2_F_Item_Move_cur
							].getNumberOfRunningActions() &&
					  1 == a.pa2_F_Item_Move[a.pa2_F_Item_Move_cur].getTag() &&
					  (a.hideHint(),
					  (a.move_tool = a.pa2_F_Item_Move[a.pa2_F_Item_Move_cur]),
					  (a.move_tool_pos =
							a.pa2_F_Item_Move[
								a.pa2_F_Item_Move_cur
							].getPosition()),
					  (a.move_tool_rot =
							a.pa2_F_Item_Move[
								a.pa2_F_Item_Move_cur
							].getRotation()),
					  (a.move_tool_scale =
							a.pa2_F_Item_Move[
								a.pa2_F_Item_Move_cur
							].getScale()),
					  (a.move_tool_zorder =
							a.pa2_F_Item_Move[
								a.pa2_F_Item_Move_cur
							].getLocalZOrder()),
					  (a.move_tool_no = 1),
					  a.move_tool.setLocalZOrder(10),
					  a.dummyBrush.setScale(0, 0),
					  (a.dummyMoveDist = cc.p(0, 0)));
			else if (3 == a.current_part)
				if (1 == a.current_sub_part)
					a.checkTouchObject(a.pa3_Panu, c) &&
						1 == a.pa3_Panu.getTag() &&
						0 == a.pa3_Panu.getNumberOfRunningActions() &&
						(a.hideHint(),
						a.pa3_Panu.setTag(2),
						a.pa3_Panu.runAction(
							cc.Sequence.create(
								cc.RotateBy.create(0.5, 360),
								cc.MoveBy.create(0.2, cc.p(800, 0))
							)
						),
						a.pa3_Screw.runAction(
							cc.Sequence.create(
								cc.RotateBy.create(0.5, 360),
								cc.JumpBy.create(0.3, cc.p(0, -500), 50, 1)
							)
						),
						a.pa3_Popup_Cur++,
						a.setTouchOff(1),
						5 == a.pa3_Popup_Cur && a.current_sub_part++,
						a.unschedule(a.startNextPart),
						a.scheduleOnce(a.startNextPart, 1));
				else if (2 == a.current_sub_part) {
					for (var o = 4; o <= 6; o++)
						if (
							a.checkTouchObject(a.pa3_Wheel[o], c) &&
							0 == a.pa3_Wheel[o].getNumberOfRunningActions() &&
							1 == a.pa3_Wheel[o].getTag()
						) {
							a.hideHint(),
								(a.move_tool = a.pa3_Wheel[o]),
								(a.move_tool_pos =
									a.pa3_Wheel[o].getPosition()),
								(a.move_tool_rot =
									a.pa3_Wheel[o].getRotation()),
								(a.move_tool_scale = a.pa3_Wheel[o].getScale()),
								(a.move_tool_zorder =
									a.pa3_Wheel[o].getLocalZOrder()),
								(a.move_tool_no = 1),
								a.move_tool.setLocalZOrder(10),
								a.dummyBrush.setRotation(0),
								a.dummyBrush.setScale(0, 0),
								(a.dummyMoveDist = cc.p(0, 0));
							break;
						}
				} else
					3 == a.current_sub_part
						? a.checkTouchObject(
								a.pa3_Wheel_Move[a.pa3_Wheel_Move_curr],
								c
						  ) &&
						  0 ==
								a.pa3_Wheel_Move[
									a.pa3_Wheel_Move_curr
								].getNumberOfRunningActions() &&
						  1 ==
								a.pa3_Wheel_Move[
									a.pa3_Wheel_Move_curr
								].getTag() &&
						  (a.hideHint(),
						  (a.move_tool =
								a.pa3_Wheel_Move[a.pa3_Wheel_Move_curr]),
						  (a.move_tool_pos =
								a.pa3_Wheel_Move[
									a.pa3_Wheel_Move_curr
								].getPosition()),
						  (a.move_tool_rot =
								a.pa3_Wheel_Move[
									a.pa3_Wheel_Move_curr
								].getRotation()),
						  (a.move_tool_scale =
								a.pa3_Wheel_Move[
									a.pa3_Wheel_Move_curr
								].getScale()),
						  (a.move_tool_zorder =
								a.pa3_Wheel_Move[
									a.pa3_Wheel_Move_curr
								].getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setRotation(0),
						  a.dummyBrush.setScale(0, 0),
						  (a.dummyMoveDist = cc.p(0, 0)))
						: 4 == a.current_sub_part
						? a.checkTouchObject(a.pa3_Oil_Bottle, c) &&
						  0 == a.pa3_Oil_Bottle.getNumberOfRunningActions() &&
						  1 == a.pa3_Oil_Bottle.getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa3_Oil_Bottle),
						  (a.move_tool_pos = a.pa3_Oil_Bottle.getPosition()),
						  (a.move_tool_rot = a.pa3_Oil_Bottle.getRotation()),
						  (a.move_tool_scale = a.pa3_Oil_Bottle.getScale()),
						  (a.move_tool_zorder =
								a.pa3_Oil_Bottle.getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.pa3_Oil_Bottle.setRotation(-25),
						  a.dummyBrush.setRotation(0),
						  a.dummyBrush.setScale(0.5, 0.5),
						  (a.dummyMoveDist = cc.p(-110, 60)))
						: 6 == a.current_sub_part &&
						  a.checkTouchObject(
								a.pa3_Scraw[a.pa3_Scraw_curr],
								c
						  ) &&
						  0 ==
								a.pa3_Scraw[
									a.pa3_Scraw_curr
								].getNumberOfRunningActions() &&
						  1 == a.pa3_Scraw[a.pa3_Scraw_curr].getTag() &&
						  (a.hideHint(),
						  (a.move_tool = a.pa3_Scraw[a.pa3_Scraw_curr]),
						  (a.move_tool_pos =
								a.pa3_Scraw[a.pa3_Scraw_curr].getPosition()),
						  (a.move_tool_rot =
								a.pa3_Scraw[a.pa3_Scraw_curr].getRotation()),
						  (a.move_tool_scale =
								a.pa3_Scraw[a.pa3_Scraw_curr].getScale()),
						  (a.move_tool_zorder =
								a.pa3_Scraw[a.pa3_Scraw_curr].getLocalZOrder()),
						  (a.move_tool_no = 1),
						  a.move_tool.setLocalZOrder(10),
						  a.dummyBrush.setRotation(0),
						  a.dummyBrush.setScale(0, 0),
						  (a.dummyMoveDist = cc.p(0, 0)));
			return !0;
		}
	},
	onTouchMoved: function (e, t) {
		var e = e.getLocation(),
			c = t.getCurrentTarget();
		c.endPos = e;
		c.endLocation = e;
		if (0 != c.isTouchOn && null != c.move_tool) {
			(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y)),
				(t = cc.p(e.x + c.dummyMoveDist.x, e.y + c.dummyMoveDist.y));
			if (
				(c.move_tool.setPosition(
					c.move_tool.getParent().convertToNodeSpace(e)
				),
				c.dummyBrush.setPosition(t),
				2 == c.current_part)
			) {
				if (1 == c.current_sub_part) {
					var a = 1;
					c.checkFullTouchObject(c.pa2_Ice[a], t) &&
						c.pa2_Ice[a].getTag() <= 3 &&
						0 == c.pa2_Ice[a].getNumberOfRunningActions() &&
						0 == c.move_tool.getNumberOfRunningActions() &&
						1 == c.move_tool.getTag() &&
						(c.hideHint(),
						c.pa2_Ice[a].setTag(c.pa2_Ice[a].getTag() + 1),
						c.pa2_Ice[a].runAction(cc.DelayTime.create(0.1)),
						c.pa2_Ice[a].getTag() <= 3
							? c.pa2_Ice[a].setTexture(
									'RES/PA/5/pa2_Ice_' +
										a +
										'_' +
										c.pa2_Ice[a].getTag() +
										'.png'
							  )
							: (c.pa2_Ice[a].runAction(
									cc.Sequence.create(
										cc.FadeOut.create(0.1),
										cc.ScaleTo.create(0, 0)
									)
							  ),
							  c.pa2_Water[a].runAction(
									cc.Sequence.create(cc.FadeIn.create(0.1))
							  )),
						4 == c.pa2_Ice[1].getTag() &&
							4 == c.pa2_Ice[2].getTag() &&
							4 == c.pa2_Ice[3].getTag() &&
							4 == c.pa2_Ice[4].getTag() &&
							4 == c.pa2_Ice[5].getTag() &&
							4 == c.pa2_Ice[6].getTag() &&
							(c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveBy.create(0.2, cc.p(1200, 0))
								)
							),
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.hideHint(),
							c.setTouchOff(0.3),
							c.current_sub_part++,
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 2),
						c.checkFullTouchObject(c.pa2_Ice[a], t) &&
							c.pa2_Ice[a].getTag() <= 3 &&
							0 == c.pa2_Ice[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Ice[a].setTag(c.pa2_Ice[a].getTag() + 1),
							c.pa2_Ice[a].runAction(cc.DelayTime.create(0.1)),
							c.pa2_Ice[a].getTag() <= 3
								? c.pa2_Ice[a].setTexture(
										'RES/PA/5/pa2_Ice_' +
											a +
											'_' +
											c.pa2_Ice[a].getTag() +
											'.png'
								  )
								: (c.pa2_Ice[a].runAction(
										cc.Sequence.create(
											cc.FadeOut.create(0.1),
											cc.ScaleTo.create(0, 0)
										)
								  ),
								  c.pa2_Water[a].runAction(
										cc.Sequence.create(
											cc.FadeIn.create(0.1)
										)
								  )),
							4 == c.pa2_Ice[1].getTag() &&
								4 == c.pa2_Ice[2].getTag() &&
								4 == c.pa2_Ice[3].getTag() &&
								4 == c.pa2_Ice[4].getTag() &&
								4 == c.pa2_Ice[5].getTag() &&
								4 == c.pa2_Ice[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 3),
						c.checkFullTouchObject(c.pa2_Ice[a], t) &&
							c.pa2_Ice[a].getTag() <= 3 &&
							0 == c.pa2_Ice[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Ice[a].setTag(c.pa2_Ice[a].getTag() + 1),
							c.pa2_Ice[a].runAction(cc.DelayTime.create(0.1)),
							c.pa2_Ice[a].getTag() <= 3
								? c.pa2_Ice[a].setTexture(
										'RES/PA/5/pa2_Ice_' +
											a +
											'_' +
											c.pa2_Ice[a].getTag() +
											'.png'
								  )
								: (c.pa2_Ice[a].runAction(
										cc.Sequence.create(
											cc.FadeOut.create(0.1),
											cc.ScaleTo.create(0, 0)
										)
								  ),
								  c.pa2_Water[a].runAction(
										cc.Sequence.create(
											cc.FadeIn.create(0.1)
										)
								  )),
							4 == c.pa2_Ice[1].getTag() &&
								4 == c.pa2_Ice[2].getTag() &&
								4 == c.pa2_Ice[3].getTag() &&
								4 == c.pa2_Ice[4].getTag() &&
								4 == c.pa2_Ice[5].getTag() &&
								4 == c.pa2_Ice[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 4),
						c.checkFullTouchObject(c.pa2_Ice[a], t) &&
							c.pa2_Ice[a].getTag() <= 3 &&
							0 == c.pa2_Ice[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Ice[a].setTag(c.pa2_Ice[a].getTag() + 1),
							c.pa2_Ice[a].runAction(cc.DelayTime.create(0.1)),
							c.pa2_Ice[a].getTag() <= 3
								? c.pa2_Ice[a].setTexture(
										'RES/PA/5/pa2_Ice_' +
											a +
											'_' +
											c.pa2_Ice[a].getTag() +
											'.png'
								  )
								: (c.pa2_Ice[a].runAction(
										cc.Sequence.create(
											cc.FadeOut.create(0.1),
											cc.ScaleTo.create(0, 0)
										)
								  ),
								  c.pa2_Water[a].runAction(
										cc.Sequence.create(
											cc.FadeIn.create(0.1)
										)
								  )),
							4 == c.pa2_Ice[1].getTag() &&
								4 == c.pa2_Ice[2].getTag() &&
								4 == c.pa2_Ice[3].getTag() &&
								4 == c.pa2_Ice[4].getTag() &&
								4 == c.pa2_Ice[5].getTag() &&
								4 == c.pa2_Ice[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 5),
						c.checkFullTouchObject(c.pa2_Ice[a], t) &&
							c.pa2_Ice[a].getTag() <= 3 &&
							0 == c.pa2_Ice[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Ice[a].setTag(c.pa2_Ice[a].getTag() + 1),
							c.pa2_Ice[a].runAction(cc.DelayTime.create(0.1)),
							c.pa2_Ice[a].getTag() <= 3
								? c.pa2_Ice[a].setTexture(
										'RES/PA/5/pa2_Ice_' +
											a +
											'_' +
											c.pa2_Ice[a].getTag() +
											'.png'
								  )
								: (c.pa2_Ice[a].runAction(
										cc.Sequence.create(
											cc.FadeOut.create(0.1),
											cc.ScaleTo.create(0, 0)
										)
								  ),
								  c.pa2_Water[a].runAction(
										cc.Sequence.create(
											cc.FadeIn.create(0.1)
										)
								  )),
							4 == c.pa2_Ice[1].getTag() &&
								4 == c.pa2_Ice[2].getTag() &&
								4 == c.pa2_Ice[3].getTag() &&
								4 == c.pa2_Ice[4].getTag() &&
								4 == c.pa2_Ice[5].getTag() &&
								4 == c.pa2_Ice[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 6),
						c.checkFullTouchObject(c.pa2_Ice[a], t) &&
							c.pa2_Ice[a].getTag() <= 3 &&
							0 == c.pa2_Ice[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Ice[a].setTag(c.pa2_Ice[a].getTag() + 1),
							c.pa2_Ice[a].runAction(cc.DelayTime.create(0.1)),
							c.pa2_Ice[a].getTag() <= 3
								? c.pa2_Ice[a].setTexture(
										'RES/PA/5/pa2_Ice_' +
											a +
											'_' +
											c.pa2_Ice[a].getTag() +
											'.png'
								  )
								: (c.pa2_Ice[a].runAction(
										cc.Sequence.create(
											cc.FadeOut.create(0.1),
											cc.ScaleTo.create(0, 0)
										)
								  ),
								  c.pa2_Water[a].runAction(
										cc.Sequence.create(
											cc.FadeIn.create(0.1)
										)
								  )),
							4 == c.pa2_Ice[1].getTag() &&
								4 == c.pa2_Ice[2].getTag() &&
								4 == c.pa2_Ice[3].getTag() &&
								4 == c.pa2_Ice[4].getTag() &&
								4 == c.pa2_Ice[5].getTag() &&
								4 == c.pa2_Ice[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2)));
				} else if (2 == c.current_sub_part) {
					var a = 1;
					null != c.move_tool &&
						c.checkTouchObject(c.move_tool, c.pa2_Water_pos[a]) &&
						0 < c.pa2_Water[a].getOpacity() &&
						0 == c.pa2_Water[a].getNumberOfRunningActions() &&
						0 == c.move_tool.getNumberOfRunningActions() &&
						1 == c.move_tool.getTag() &&
						(c.hideHint(),
						c.pa2_Water[a].setOpacity(
							c.pa2_Water[a].getOpacity() - 5
						),
						0 == c.pa2_Water[a].getOpacity() &&
							c.pa2_Water[a].setTag(4),
						4 == c.pa2_Water[1].getTag() &&
							4 == c.pa2_Water[2].getTag() &&
							4 == c.pa2_Water[3].getTag() &&
							4 == c.pa2_Water[4].getTag() &&
							4 == c.pa2_Water[5].getTag() &&
							4 == c.pa2_Water[6].getTag() &&
							(c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveBy.create(0.2, cc.p(1200, 0))
								)
							),
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.hideHint(),
							c.setTouchOff(0.3),
							c.current_sub_part++,
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 2),
						null != c.move_tool &&
							c.checkTouchObject(
								c.move_tool,
								c.pa2_Water_pos[a]
							) &&
							0 < c.pa2_Water[a].getOpacity() &&
							0 == c.pa2_Water[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Water[a].setOpacity(
								c.pa2_Water[a].getOpacity() - 5
							),
							0 == c.pa2_Water[a].getOpacity() &&
								c.pa2_Water[a].setTag(4),
							4 == c.pa2_Water[1].getTag() &&
								4 == c.pa2_Water[2].getTag() &&
								4 == c.pa2_Water[3].getTag() &&
								4 == c.pa2_Water[4].getTag() &&
								4 == c.pa2_Water[5].getTag() &&
								4 == c.pa2_Water[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 3),
						null != c.move_tool &&
							c.checkTouchObject(
								c.move_tool,
								c.pa2_Water_pos[a]
							) &&
							0 < c.pa2_Water[a].getOpacity() &&
							0 == c.pa2_Water[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Water[a].setOpacity(
								c.pa2_Water[a].getOpacity() - 5
							),
							0 == c.pa2_Water[a].getOpacity() &&
								c.pa2_Water[a].setTag(4),
							4 == c.pa2_Water[1].getTag() &&
								4 == c.pa2_Water[2].getTag() &&
								4 == c.pa2_Water[3].getTag() &&
								4 == c.pa2_Water[4].getTag() &&
								4 == c.pa2_Water[5].getTag() &&
								4 == c.pa2_Water[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 4),
						null != c.move_tool &&
							c.checkTouchObject(
								c.move_tool,
								c.pa2_Water_pos[a]
							) &&
							0 < c.pa2_Water[a].getOpacity() &&
							0 == c.pa2_Water[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Water[a].setOpacity(
								c.pa2_Water[a].getOpacity() - 5
							),
							0 == c.pa2_Water[a].getOpacity() &&
								c.pa2_Water[a].setTag(4),
							4 == c.pa2_Water[1].getTag() &&
								4 == c.pa2_Water[2].getTag() &&
								4 == c.pa2_Water[3].getTag() &&
								4 == c.pa2_Water[4].getTag() &&
								4 == c.pa2_Water[5].getTag() &&
								4 == c.pa2_Water[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 5),
						null != c.move_tool &&
							c.checkTouchObject(
								c.move_tool,
								c.pa2_Water_pos[a]
							) &&
							0 < c.pa2_Water[a].getOpacity() &&
							0 == c.pa2_Water[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Water[a].setOpacity(
								c.pa2_Water[a].getOpacity() - 5
							),
							0 == c.pa2_Water[a].getOpacity() &&
								c.pa2_Water[a].setTag(4),
							4 == c.pa2_Water[1].getTag() &&
								4 == c.pa2_Water[2].getTag() &&
								4 == c.pa2_Water[3].getTag() &&
								4 == c.pa2_Water[4].getTag() &&
								4 == c.pa2_Water[5].getTag() &&
								4 == c.pa2_Water[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2))),
						(a = 6),
						null != c.move_tool &&
							c.checkTouchObject(
								c.move_tool,
								c.pa2_Water_pos[a]
							) &&
							0 < c.pa2_Water[a].getOpacity() &&
							0 == c.pa2_Water[a].getNumberOfRunningActions() &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag() &&
							(c.hideHint(),
							c.pa2_Water[a].setOpacity(
								c.pa2_Water[a].getOpacity() - 5
							),
							0 == c.pa2_Water[a].getOpacity() &&
								c.pa2_Water[a].setTag(4),
							4 == c.pa2_Water[1].getTag() &&
								4 == c.pa2_Water[2].getTag() &&
								4 == c.pa2_Water[3].getTag() &&
								4 == c.pa2_Water[4].getTag() &&
								4 == c.pa2_Water[5].getTag() &&
								4 == c.pa2_Water[6].getTag() &&
								(c.move_tool.runAction(
									cc.Sequence.create(
										cc.MoveBy.create(0.2, cc.p(1200, 0))
									)
								),
								(c.move_tool = null),
								(c.move_tool_no = 0),
								(c.move_tool_pos = cc.p(0, 0)),
								(c.move_tool_rot = 0),
								c.hideHint(),
								c.setTouchOff(0.3),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.2)));
				} else if (3 == c.current_sub_part) {
					a = 1;
					if (
						null != c.move_tool &&
						c.move_tool.getName() ==
							c.pa2_F_Part_Dummy[a].getName() &&
						c.checkTouchObject(c.pa2_F_Part_Dummy[a], t) &&
						0 == c.move_tool.getNumberOfRunningActions() &&
						1 == c.move_tool.getTag()
					) {
						c.hideHint();
						for (var o = 1, n = 1; n <= 2; n++)
							if (0 == c.pa2_Fridge_Item_Set[n].isVisible()) {
								o = n;
								break;
							}
						c.pa2_Fridge_Item_Set[o].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.Show.create()
							)
						),
							c.move_tool.runAction(
								cc.Sequence.create(
									cc.JumpTo.create(
										0.2,
										c.pa2_Fridge_Item_Set_pos[o],
										50,
										1
									),
									cc.Hide.create(),
									cc.ScaleTo.create(0, 0)
								)
							),
							c.pa2_F_Item_Move_cur++,
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.setTouchOff(0.3),
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2);
					}
					if (
						((a = 2),
						null != c.move_tool &&
							c.move_tool.getName() ==
								c.pa2_F_Part_Dummy[a].getName() &&
							c.checkTouchObject(c.pa2_F_Part_Dummy[a], t) &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag())
					) {
						c.hideHint();
						for (o = 3, n = 3; n <= 3; n++)
							if (0 == c.pa2_Fridge_Item_Set[n].isVisible()) {
								o = n;
								break;
							}
						c.pa2_Fridge_Item_Set[o].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.Show.create()
							)
						),
							c.move_tool.runAction(
								cc.Sequence.create(
									cc.JumpTo.create(
										0.2,
										c.pa2_Fridge_Item_Set_pos[o],
										50,
										1
									),
									cc.Hide.create(),
									cc.ScaleTo.create(0, 0)
								)
							),
							c.pa2_F_Item_Move_cur++,
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.setTouchOff(0.3),
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2);
					}
					if (
						((a = 3),
						null != c.move_tool &&
							c.move_tool.getName() ==
								c.pa2_F_Part_Dummy[a].getName() &&
							c.checkTouchObject(c.pa2_F_Part_Dummy[a], t) &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag())
					) {
						c.hideHint();
						for (o = 4, n = 4; n <= 5; n++)
							if (0 == c.pa2_Fridge_Item_Set[n].isVisible()) {
								o = n;
								break;
							}
						c.pa2_Fridge_Item_Set[o].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.Show.create()
							)
						),
							c.move_tool.runAction(
								cc.Sequence.create(
									cc.JumpTo.create(
										0.2,
										c.pa2_Fridge_Item_Set_pos[o],
										50,
										1
									),
									cc.Hide.create(),
									cc.ScaleTo.create(0, 0)
								)
							),
							c.pa2_F_Item_Move_cur++,
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.setTouchOff(0.3),
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2);
					}
					if (
						((a = 4),
						null != c.move_tool &&
							c.move_tool.getName() ==
								c.pa2_F_Part_Dummy[a].getName() &&
							c.checkTouchObject(c.pa2_F_Part_Dummy[a], t) &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag())
					) {
						c.hideHint();
						for (o = 6, n = 6; n <= 6; n++)
							if (0 == c.pa2_Fridge_Item_Set[n].isVisible()) {
								o = n;
								break;
							}
						c.pa2_Fridge_Item_Set[o].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.Show.create()
							)
						),
							c.move_tool.runAction(
								cc.Sequence.create(
									cc.JumpTo.create(
										0.2,
										c.pa2_Fridge_Item_Set_pos[o],
										50,
										1
									),
									cc.Hide.create(),
									cc.ScaleTo.create(0, 0)
								)
							),
							c.pa2_F_Item_Move_cur++,
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.setTouchOff(0.3),
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2);
					}
					if (
						((a = 5),
						null != c.move_tool &&
							c.move_tool.getName() ==
								c.pa2_F_Part_Dummy[a].getName() &&
							c.checkTouchObject(c.pa2_F_Part_Dummy[a], t) &&
							0 == c.move_tool.getNumberOfRunningActions() &&
							1 == c.move_tool.getTag())
					) {
						c.hideHint();
						for (o = 7, n = 7; n <= 8; n++)
							if (0 == c.pa2_Fridge_Item_Set[n].isVisible()) {
								o = n;
								break;
							}
						c.pa2_Fridge_Item_Set[o].runAction(
							cc.Sequence.create(
								cc.DelayTime.create(0.2),
								cc.Show.create()
							)
						),
							c.move_tool.runAction(
								cc.Sequence.create(
									cc.JumpTo.create(
										0.2,
										c.pa2_Fridge_Item_Set_pos[o],
										50,
										1
									),
									cc.Hide.create(),
									cc.ScaleTo.create(0, 0)
								)
							),
							c.pa2_F_Item_Move_cur++,
							(c.move_tool = null),
							(c.move_tool_no = 0),
							(c.move_tool_pos = cc.p(0, 0)),
							(c.move_tool_rot = 0),
							c.setTouchOff(0.3),
							c.unschedule(c.startNextPart),
							c.scheduleOnce(c.startNextPart, 0.2);
					}
				}
			} else
				3 == c.current_part &&
					(2 == c.current_sub_part
						? c.checkTouchObject(c.pa3_Bin, t) &&
						  0 == c.move_tool.getNumberOfRunningActions() &&
						  1 == c.move_tool.getTag() &&
						  (c.move_tool.setTag(2),
						  c.move_tool.runAction(
								cc.Spawn.create(
									cc.JumpTo.create(
										0.2,
										cc.p(140, 130),
										70,
										1
									),
									cc.ScaleTo.create(0.2, 0)
								)
						  ),
						  (c.move_tool = null),
						  (c.move_tool_no = 0),
						  (c.move_tool_pos = cc.p(0, 0)),
						  (c.move_tool_rot = 0),
						  c.hideHint(),
						  c.setTouchOff(0.2),
						  2 == c.pa3_Wheel[4].getTag() &&
								2 == c.pa3_Wheel[5].getTag() &&
								2 == c.pa3_Wheel[6].getTag() &&
								(c.setTouchOff(0.6),
								c.pa3_Bin.runAction(
									cc.Sequence.create(
										cc.DelayTime.create(0.3),
										cc.MoveTo.create(
											0.2,
											cc.p(
												c.pa3_Bin_pos.x - 500,
												c.pa3_Bin_pos.y
											)
										)
									)
								),
								c.current_sub_part++,
								c.unschedule(c.startNextPart),
								c.scheduleOnce(c.startNextPart, 0.5)))
						: 3 == c.current_sub_part
						? c.checkTouchObject(
								c.move_tool,
								c.pa3_Wheel_Done_pos[c.pa3_Wheel_Move_curr]
						  ) &&
						  0 == c.move_tool.getNumberOfRunningActions() &&
						  1 == c.move_tool.getTag() &&
						  (c.move_tool.setTag(2),
						  c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveTo.create(
										0.2,
										c.pa3_Wheel_Done_pos[
											c.pa3_Wheel_Move_curr
										]
									),
									cc.Hide.create(),
									cc.ScaleTo.create(0, 0)
								)
						  ),
						  c.pa3_Wheel_Done[c.pa3_Wheel_Move_curr].runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.2),
									cc.FadeIn.create(0)
								)
						  ),
						  c.pa3_Wheel_Move_curr++,
						  (c.move_tool = null),
						  (c.move_tool_no = 0),
						  (c.move_tool_pos = cc.p(0, 0)),
						  (c.move_tool_rot = 0),
						  c.hideHint(),
						  c.setTouchOff(0.2),
						  2 == c.pa3_Wheel_Move[1].getTag() &&
								2 == c.pa3_Wheel_Move[2].getTag() &&
								2 == c.pa3_Wheel_Move[3].getTag() &&
								c.current_sub_part++,
						  c.unschedule(c.startNextPart),
						  c.scheduleOnce(c.startNextPart, 0.2))
						: 4 == c.current_sub_part
						? ((a = 1),
						  c.checkTouchObject(c.pa3_Wheel_Done1[a], t) &&
								c.pa3_Wheel_Done1[a].getOpacity() < 255 &&
								0 == c.move_tool.getNumberOfRunningActions() &&
								1 == c.move_tool.getTag() &&
								(c.pa3_Wheel_Done1[a].setOpacity(
									c.pa3_Wheel_Done1[a].getOpacity() + 5
								),
								255 == c.pa3_Wheel_Done1[1].getOpacity() &&
									(c.pa3_Wheel_Done[1].runAction(
										cc.RepeatForever.create(
											cc.RotateBy.create(2, 360)
										)
									),
									c.pa3_Wheel[1].runAction(
										cc.RepeatForever.create(
											cc.RotateBy.create(2, -360)
										)
									)),
								255 == c.pa3_Wheel_Done1[1].getOpacity() &&
									255 == c.pa3_Wheel_Done1[2].getOpacity() &&
									255 == c.pa3_Wheel_Done1[3].getOpacity() &&
									(c.move_tool.setTag(2),
									c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(800, 0)),
											cc.Hide.create(),
											cc.ScaleTo.create(0, 0)
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.2),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 2),
						  c.checkTouchObject(c.pa3_Wheel_Done1[a], t) &&
								c.pa3_Wheel_Done1[a].getOpacity() < 255 &&
								0 == c.move_tool.getNumberOfRunningActions() &&
								1 == c.move_tool.getTag() &&
								(c.pa3_Wheel_Done1[a].setOpacity(
									c.pa3_Wheel_Done1[a].getOpacity() + 5
								),
								255 == c.pa3_Wheel_Done1[2].getOpacity() &&
									(c.pa3_Wheel_Done[2].runAction(
										cc.RepeatForever.create(
											cc.RotateBy.create(2, -360)
										)
									),
									c.pa3_Wheel[3].runAction(
										cc.RepeatForever.create(
											cc.RotateBy.create(2, 360)
										)
									)),
								255 == c.pa3_Wheel_Done1[1].getOpacity() &&
									255 == c.pa3_Wheel_Done1[2].getOpacity() &&
									255 == c.pa3_Wheel_Done1[3].getOpacity() &&
									(c.move_tool.setTag(2),
									c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(800, 0)),
											cc.Hide.create(),
											cc.ScaleTo.create(0, 0)
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.2),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))),
						  (a = 3),
						  c.checkTouchObject(c.pa3_Wheel_Done1[a], t) &&
								c.pa3_Wheel_Done1[a].getOpacity() < 255 &&
								0 == c.move_tool.getNumberOfRunningActions() &&
								1 == c.move_tool.getTag() &&
								(c.pa3_Wheel_Done1[a].setOpacity(
									c.pa3_Wheel_Done1[a].getOpacity() + 5
								),
								255 == c.pa3_Wheel_Done1[3].getOpacity() &&
									(c.pa3_Wheel_Done[3].runAction(
										cc.RepeatForever.create(
											cc.RotateBy.create(2, 360)
										)
									),
									c.pa3_Wheel[2].runAction(
										cc.RepeatForever.create(
											cc.RotateBy.create(2, -360)
										)
									)),
								255 == c.pa3_Wheel_Done1[1].getOpacity() &&
									255 == c.pa3_Wheel_Done1[2].getOpacity() &&
									255 == c.pa3_Wheel_Done1[3].getOpacity() &&
									(c.move_tool.setTag(2),
									c.move_tool.runAction(
										cc.Sequence.create(
											cc.MoveBy.create(0.2, cc.p(800, 0)),
											cc.Hide.create(),
											cc.ScaleTo.create(0, 0)
										)
									),
									(c.move_tool = null),
									(c.move_tool_no = 0),
									(c.move_tool_pos = cc.p(0, 0)),
									(c.move_tool_rot = 0),
									c.hideHint(),
									c.setTouchOff(0.2),
									c.current_sub_part++,
									c.unschedule(c.startNextPart),
									c.scheduleOnce(c.startNextPart, 0.2))))
						: 6 == c.current_sub_part &&
						  c.checkTouchObject(
								c.move_tool,
								c.pa3_Scraw_Done_pos[c.pa3_Scraw_curr]
						  ) &&
						  0 == c.move_tool.getNumberOfRunningActions() &&
						  1 == c.move_tool.getTag() &&
						  (c.move_tool.setTag(2),
						  c.move_tool.runAction(
								cc.Sequence.create(
									cc.MoveTo.create(
										0.2,
										c.pa3_Scraw_Done_pos[c.pa3_Scraw_curr]
									),
									cc.Hide.create(),
									cc.ScaleTo.create(0, 0)
								)
						  ),
						  c.pa3_Scraw_Done[c.pa3_Scraw_curr].runAction(
								cc.Sequence.create(
									cc.DelayTime.create(0.2),
									cc.Show.create()
								)
						  ),
						  c.pa3_Scraw_curr++,
						  (c.move_tool = null),
						  (c.move_tool_no = 0),
						  (c.move_tool_pos = cc.p(0, 0)),
						  (c.move_tool_rot = 0),
						  c.hideHint(),
						  c.setTouchOff(0.2),
						  2 == c.pa3_Scraw[1].getTag() &&
								2 == c.pa3_Scraw[2].getTag() &&
								2 == c.pa3_Scraw[3].getTag() &&
								2 == c.pa3_Scraw[4].getTag() &&
								c.current_sub_part++,
						  c.unschedule(c.startNextPart),
						  c.scheduleOnce(c.startNextPart, 0.2)));
		}
	},
	onTouchEnded: function (e, t) {
		(e = e.getLocation()), (t = t.getCurrentTarget());
		0 != t.isTouchOn &&
			null != t.move_tool &&
			(1 == t.current_part &&
				1 == t.current_sub_part &&
				t.pa2_Dryer_Flow.setVisible(!1),
			t.move_tool.runAction(
				cc.Sequence.create(
					cc.Spawn.create(
						cc.MoveTo.create(0.2, t.move_tool_pos),
						cc.ScaleTo.create(0.2, t.move_tool_scale),
						cc.RotateTo.create(0.2, t.move_tool_rot)
					),
					cc.callFunc(t.changeZorder, t.move_tool, t.move_tool_zorder)
				)
			),
			t.move_tool.getParent().convertToNodeSpace(e),
			(t.move_tool = null),
			(t.move_tool_no = 0),
			(t.move_tool_pos = cc.p(0, 0)),
			(t.move_tool_rot = 0),
			t.hideHint(),
			t.setTouchOff(0.2));
	},
	onMouseMove: function (e) {
		var t = e.getLocation(),
			e = e.getCurrentTarget();
		cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) &&
		1 == e.btn_more.getScale() &&
		0 == e.btn_more.getNumberOfRunningActions() &&
		255 == e.btn_more.getOpacity()
			? (e.prt_Sparkle.setPosition(e.btn_more.getPosition()),
			  e.prt_Sparkle.resetSystem(),
			  e.btn_more.setScale(1.03))
			: 1.03 != e.btn_more.getScale() ||
			  cc.rectContainsPoint(e.btn_more.getBoundingBox(), t) ||
			  0 != e.btn_more.getNumberOfRunningActions() ||
			  255 != e.btn_more.getOpacity()
			? cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) &&
			  1 == e.btn_done.getScale() &&
			  0 == e.btn_done.getNumberOfRunningActions() &&
			  255 == e.btn_done.getOpacity()
				? (e.prt_Sparkle.setPosition(e.btn_done.getPosition()),
				  e.prt_Sparkle.resetSystem(),
				  e.btn_done.setScale(1.03))
				: 1.03 != e.btn_done.getScale() ||
				  cc.rectContainsPoint(e.btn_done.getBoundingBox(), t) ||
				  0 != e.btn_done.getNumberOfRunningActions() ||
				  255 != e.btn_done.getOpacity() ||
				  e.btn_done.setScale(1)
			: e.btn_more.setScale(1);
	},
	onMoreApp: function (e) {
		101 == e.getTag()
			? CreateLinksInGame(comman.GameId, 'game', 'more')
			: CreateLinksInGame(comman.GameId, 'game', 'logo');
	},
	onMusicButton: function (e) {
		0 == e.getNumberOfRunningActions() &&
			(e.stopAllActions(),
			e.runAction(
				cc.Sequence.create(
					cc.ScaleTo.create(0, 1),
					cc.ScaleTo.create(0.2, 0.9),
					cc.ScaleTo.create(0.2, 1)
				)
			),
			comman.isMusicEnable
				? (e.setNormalSpriteFrame(res_mainScene.btn_soundOff),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOff),
				  comman.setSoundEnabled(!1))
				: comman.isMusicEnable ||
				  (e.setNormalSpriteFrame(res_mainScene.btn_soundOn),
				  e.setSelectedSpriteFrame(res_mainScene.btn_soundOn),
				  comman.setSoundEnabled(!0)));
	},
	createMainMenu: function () {
		(this.btn_bb_icon = cc.MenuItemImage.create(
			res_comman.bb_icon_3,
			res_comman.bb_icon_3,
			this.onMoreApp,
			this
		)),
			this.btn_bb_icon.setAnchorPoint(cc.p(0, 1)),
			this.btn_bb_icon.setScale(1.1),
			this.btn_bb_icon.setPosition(cc.p(0, comman.winSize().height)),
			(this.btn_music = cc.MenuItemImage.create(
				res_mainScene.btn_soundOn,
				res_mainScene.btn_soundOn,
				this.onMusicButton,
				this
			)),
			this.btn_music.setScale(1),
			this.btn_music.setPosition(
				cc.p(
					comman.winSize().width -
						0.5 * this.btn_music.getContentSize().width,
					comman.winSize().height -
						0.5 * this.btn_music.getContentSize().height
				)
			),
			comman.isMusicEnable
				? comman.isMusicEnable &&
				  (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOn
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOn
				  ))
				: (this.btn_music.setNormalSpriteFrame(
						res_mainScene.btn_soundOff
				  ),
				  this.btn_music.setSelectedSpriteFrame(
						res_mainScene.btn_soundOff
				  )),
			(this.MainMenu = cc.Menu.create(this.btn_bb_icon, this.btn_music)),
			this.MainMenu.setPosition(cc.p(0, 0)),
			this.addChild(this.MainMenu, 200);
	},
});
(PlayScene_5.scene = function () {
	var e = new cc.Scene(),
		t = new PlayScene_5();
	return e.addChild(t), e;
}),
	(Preloader = cc.Scene.extend({
		init: function () {
			var e = this,
				t = (e._bgLayer = new cc.LayerColor(cc.color(0, 84, 124, 255)));
			return (
				e.addChild(t, 0),
				cc.loader.load(
					[
						'RES/COM/play.png',
						'RES/COM/bb_icon_200x150.png',
						'RES/COM/bg_white.png',
					],
					function (e, t, c) {},
					function () {
						e._initStage(cc.p(400, 315));
					}
				),
				!0
			);
		},
		_initStage: function (e) {
			var t = this;
			(t.isPortrait = !1), (t.updateCount = 0);
			var c = (t._label = new cc.LabelTTF(
				'LOADING : 0%',
				'Arial Black',
				25
			));
			c.setPosition(cc.p(400, 210)),
				c.setColor(cc.color(255, 255, 255)),
				c.setScale(0.7),
				t._bgLayer.addChild(t._label, 10);
			var a = (t._logo = cc.MenuItemImage.create(
				'RES/COM/bb_icon_200x150.png',
				'RES/COM/bb_icon_200x150.png',
				this.onLogoClick,
				this
			));
			a.setScale(0.85 * cc.contentScaleFactor()),
				(a.x = e.x),
				(a.y = e.y),
				1 == cc.sys.isMobile &&
				90 != window.orientation &&
				-90 != window.orientation
					? ((t.isPortrait = !0),
					  a.setScale(1.4 * cc.contentScaleFactor()),
					  c.setScale(1.2),
					  c.setPosition(cc.p(400, 160)))
					: 1 == cc.sys.isMobile &&
					  (c.setScale(0.7),
					  a.setScale(0.85 * cc.contentScaleFactor()),
					  c.setPosition(cc.p(400, 210))),
				(t._logoMenu = cc.Menu.create(t._logo)),
				t._logoMenu.setPosition(cc.p(0, 0)),
				t._bgLayer.addChild(t._logoMenu, 10);
			c = t._play = cc.MenuItemImage.create(
				'RES/COM/play.png',
				'RES/COM/play.png',
				this.onPlayClick,
				this
			);
			c.setScale(cc.contentScaleFactor()),
				(c.x = 400),
				(c.y = 200),
				(c.scale = 0);
			c = cc.Menu.create(t._play);
			c.setPosition(cc.p(0, 0)),
				t._bgLayer.addChild(c, 10),
				this.scheduleUpdate();
		},
		onLogoClick: function (e) {
			CreateLinksInGame(comman.GameId, 'loadingscreen', 'logo');
		},
		onPlayClick: function (e) {
			this.cb && this.cb.call(this.target);
		},
		onEnter: function () {
			cc.Node.prototype.onEnter.call(this),
				this.schedule(this._startLoading, 0.3);
		},
		onExit: function () {
			cc.Node.prototype.onExit.call(this);
			this._label.setString('Loading... 0%');
		},
		initWithResources: function (e, t, c) {
			cc.isString(e) && (e = [e]),
				(this.resources = e || []),
				(this.cb = t),
				(this.target = c);
		},
		_startLoading: function () {
			var a = this;
			a.unschedule(a._startLoading);
			var e = a.resources;
			cc.loader.load(
				e,
				function (e, t, c) {
					(t = ((c / t) * 100) | 0), (t = Math.min(t, 100));
					a._label && a._label.setString('LOADING : ' + t + '%');
				},
				function () {
					var e;
					1 == cc.sys.isMobile &&
					90 != window.orientation &&
					-90 != window.orientation
						? (a._play
								? (a._play.setScale(1.2),
								  a._play.setPosition(cc.p(400, 120)))
								: ((a._play = cc.MenuItemImage.create(
										'RES/COM/play.png',
										'RES/COM/play.png',
										this.onPlayClick,
										this
								  )),
								  a._play.setScale(
										1.2 * cc.contentScaleFactor()
								  ),
								  a._play.setPosition(cc.p(400, 120)),
								  (a._play.scale = 0),
								  (e = cc.Menu.create(a._play)).setPosition(
										cc.p(0, 0)
								  ),
								  a._bgLayer.addChild(e, 10)),
						  a._label.setString(''),
						  a._play.runAction(
								cc.RepeatForever.create(
									cc.Sequence.create(
										cc.DelayTime.create(0.25),
										cc.ScaleTo.create(0.3, 1.25),
										cc.DelayTime.create(0.2),
										cc.ScaleTo.create(0.3, 1.2)
									)
								)
						  ))
						: (cc.sys.isMobile,
						  a._play
								? a._play.setScale(0.7)
								: ((a._play = cc.MenuItemImage.create(
										'RES/COM/play.png',
										'RES/COM/play.png',
										this.onPlayClick,
										this
								  )),
								  a._play.setScale(
										0.7 * cc.contentScaleFactor()
								  ),
								  a._play.setPosition(cc.p(400, 200)),
								  (a._play.scale = 0),
								  (e = cc.Menu.create(a._play)).setPosition(
										cc.p(0, 0)
								  ),
								  a._bgLayer.addChild(e, 10)),
						  a._label.setString(''),
						  a._play.runAction(
								cc.RepeatForever.create(
									cc.Sequence.create(
										cc.DelayTime.create(0.25),
										cc.ScaleTo.create(0.3, 0.75),
										cc.DelayTime.create(0.2),
										cc.ScaleTo.create(0.3, 0.7)
									)
								)
						  ));
				}
			);
		},
		_updateTransform: function () {
			this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),
				this._bgLayer._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				),
				this._label._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				),
				this._logo._renderCmd.setDirtyFlag(
					cc.Node._dirtyFlags.transformDirty
				);
		},
		update: function () {
			var e = this;
			1 == cc.sys.isMobile &&
			90 != window.orientation &&
			-90 != window.orientation
				? (e._logo.setScale(1.4 * cc.contentScaleFactor()),
				  e._label.setScale(1.2),
				  e._label.setPosition(cc.p(400, 160)),
				  e._play.setPosition(cc.p(400, 120)),
				  0 == e.isPortrait &&
						((e.isPortrait = !0),
						'' == e._label.getString() &&
							(e._play.stopAllActions(),
							e._play.setScale(1.2),
							e._play.runAction(
								cc.RepeatForever.create(
									cc.Sequence.create(
										cc.DelayTime.create(0.25),
										cc.ScaleTo.create(0.3, 1.25),
										cc.DelayTime.create(0.2),
										cc.ScaleTo.create(0.3, 1.2)
									)
								)
							))))
				: (90 != window.orientation && -90 != window.orientation) ||
				  (cc.sys.isMobile,
				  e._logo.setScale(0.85 * cc.contentScaleFactor()),
				  e._label.setPosition(cc.p(400, 210)),
				  e._label.setScale(0.7),
				  e._play.setPosition(cc.p(400, 200)),
				  1 == e.isPortrait &&
						((e.isPortrait = !1),
						'' == e._label.getString() &&
							(e._play.stopAllActions(),
							e._play.setPosition(cc.p(400, 200)),
							e._play.setScale(0.7),
							e._play.runAction(
								cc.RepeatForever.create(
									cc.Sequence.create(
										cc.DelayTime.create(0.25),
										cc.ScaleTo.create(0.3, 0.75),
										cc.DelayTime.create(0.2),
										cc.ScaleTo.create(0.3, 0.7)
									)
								)
							))));
		},
	})),
	(Preloader.preload = function (e, t, c) {
		return (
			this._miaPreloader ||
				((this._miaPreloader = new Preloader()),
				this._miaPreloader.init()),
			this._miaPreloader.initWithResources(e, t),
			cc.director.runScene(this._miaPreloader),
			this._miaPreloader
		);
	});
